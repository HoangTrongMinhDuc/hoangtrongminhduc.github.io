<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<link rel="stylesheet" href="base.min.css"/>
<link rel="stylesheet" href="fancy.min.css"/>
<link rel="stylesheet" href="main.css"/>
<script src="compatibility.min.js"></script>
<script src="theViewer.min.js"></script>
<script>
try{
theViewer.defaultViewer = new theViewer.Viewer({});
}catch(e){}
</script>
<title></title>
</head>
<body>
<div id="sidebar">
<div id="outline">
</div>
</div>
<div id="page-container">
<div id="pf1" class="pf w0 h0" data-page-no="1"><div class="pc pc1 w0 h0"><img class="bi x0 y0 w0 h1" alt="" src="bg1.png"/></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
<div id="pf2" class="pf w1 h2" data-page-no="2"><div class="pc pc2 w1 h2"><div class="t m0 x1 h3 y1 ff1 fs0 fc0 sc0 ls0 ws0">Clean Code</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3" class="pf w1 h2" data-page-no="3"><div class="pc pc3 w1 h2"><div class="t m0 x2 h4 y2 ff2 fs1 fc1 sc0 ls0 ws0">Robert C. Martin Series</div><div class="t m0 x2 h5 y3 ff3 fs2 fc1 sc0 ls0 ws1">The mission of this series is to improve the state of the art of software craftsmanship. </div><div class="t m0 x2 h5 y4 ff3 fs2 fc1 sc0 ls0 ws2">The books in this series are technical, pragmatic, and substantial. The authors are </div><div class="t m0 x2 h5 y5 ff3 fs2 fc1 sc0 ls0 ws3">highly experienced craftsmen and professionals dedicated to writing about what </div><div class="t m0 x2 h5 y6 ff3 fs2 fc1 sc0 ls0 ws4">actually works in practice, as opposed to what might work in theory<span class="_ _0"></span>. Y<span class="_ _0"></span>ou will read </div><div class="t m0 x2 h5 y7 ff3 fs2 fc1 sc0 ls0 ws5">about what the author has done, not what he thinks you should do. If the book is </div><div class="t m0 x2 h5 y8 ff3 fs2 fc1 sc0 ls0 ws6">about programming, there will be lots of code. If the book is about managing, there </div><div class="t m0 x2 h5 y9 ff3 fs2 fc1 sc0 ls0 ws0">will be lots of case studies from real projects. </div><div class="t m0 x2 h5 ya ff3 fs2 fc1 sc0 ls0 ws7">These are the books that all serious practitioners will have on their bookshelves. </div><div class="t m0 x2 h5 yb ff3 fs2 fc1 sc0 ls0 ws8">These are the books that will be remembered for making a difference and for guiding </div><div class="t m0 x2 h5 yc ff3 fs2 fc1 sc0 ls0 ws0">professionals to become true craftsman. </div><div class="t m0 x2 h6 yd ff4 fs2 fc1 sc0 ls0 ws0">Managing Agile Projects</div><div class="t m0 x2 h5 ye ff3 fs2 fc1 sc0 ls0 ws0">Sanjiv Augustine</div><div class="t m0 x2 h6 yf ff4 fs2 fc1 sc0 ls0 ws0">Agile Estimating and Planning</div><div class="t m0 x2 h5 y10 ff3 fs2 fc1 sc0 ls0 ws0">Mike Cohn</div><div class="t m0 x2 h6 y11 ff4 fs2 fc1 sc0 ls0 ws0">W<span class="_ _1"></span>orking Effectively with Legacy Code</div><div class="t m0 x2 h5 y12 ff3 fs2 fc1 sc0 ls0 ws0">Michael C. Feathers</div><div class="t m0 x2 h6 y13 ff4 fs2 fc1 sc0 ls0 ws0">Agile Java™: Crafting Code with T<span class="_ _0"></span>est-Driven Development</div><div class="t m0 x2 h5 y14 ff3 fs2 fc1 sc0 ls0 ws0">Jeff Langr</div><div class="t m0 x2 h6 y15 ff4 fs2 fc1 sc0 ls0 ws0">Agile Principles, Patterns, and Practices in C#</div><div class="t m0 x2 h5 y16 ff3 fs2 fc1 sc0 ls0 ws0">Robert C. Martin and Micah Martin</div><div class="t m0 x2 h6 y17 ff4 fs2 fc1 sc0 ls0 ws0">Agile Software Development: Principles, Patterns, and Practices</div><div class="t m0 x2 h5 y18 ff3 fs2 fc1 sc0 ls0 ws0">Robert C. Martin </div><div class="t m0 x2 h6 y19 ff4 fs2 fc1 sc0 ls0 ws0">Clean Code: A Handbook of Agile Software Craftsmanship</div><div class="t m0 x2 h5 y1a ff3 fs2 fc1 sc0 ls0 ws0">Robert C. Martin</div><div class="t m0 x2 h6 y1b ff4 fs2 fc1 sc0 ls0 ws0">UML For Java™ Programmers</div><div class="t m0 x2 h5 y1c ff3 fs2 fc1 sc0 ls0 ws0">Robert C. Martin</div><div class="t m0 x2 h6 y1d ff4 fs2 fc1 sc0 ls0 ws0">Fit for Developing Software: Framework for Integrated T<span class="_ _0"></span>ests</div><div class="t m0 x2 h5 y1e ff3 fs2 fc1 sc0 ls0 ws0">Rick Mugridge and W<span class="_ _0"></span>ard Cunningham</div><div class="t m0 x2 h6 y1f ff4 fs2 fc1 sc0 ls0 ws0">Agile Software Development with SCRUM</div><div class="t m0 x2 h5 y20 ff3 fs2 fc1 sc0 ls0 ws0">Ken Schwaber and Mike Beedle</div><div class="t m0 x2 h6 y21 ff4 fs2 fc1 sc0 ls0 ws0">Extreme Software Engineering: A Hands on Approach</div><div class="t m0 x2 h5 y22 ff3 fs2 fc1 sc0 ls0 ws0">Daniel H. Steinberg and Daniel W<span class="_ _2"></span>. Palmer</div><div class="t m0 x2 h7 y23 ff2 fs3 fc1 sc0 ls0 ws0">For more information, visit informit.com/martinseries</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4" class="pf w1 h2" data-page-no="4"><div class="pc pc4 w1 h2"><img class="bi x3 y24 w2 h8" alt="" src="bg4.png"/><div class="t m0 x4 h9 y25 ff1 fs4 fc0 sc0 ls0 ws0">Clean Code</div><div class="t m0 x5 ha y26 ff5 fs5 fc0 sc0 ls0 ws0">A Handbook of <span class="_ _3"></span>Agile </div><div class="t m0 x6 ha y27 ff5 fs5 fc0 sc0 ls0 ws0">Softw<span class="_ _4"></span>ar<span class="_ _4"></span>e Craftsmanship</div><div class="t m0 x7 hb y28 ff6 fs6 fc0 sc0 ls0 ws0">T<span class="_ _4"></span>he Object Mentors: </div><div class="t m0 x8 hc y29 ff6 fs7 fc0 sc0 ls0 ws0">Rober<span class="_ _5"></span>t C<span class="_ _0"></span>. Mar<span class="_ _6"></span>tin</div><div class="t m0 x9 hd y2a ff6 fs3 fc0 sc0 ls0 ws0">Michael C<span class="_ _1"></span>. F<span class="_ _1"></span>eather<span class="_ _5"></span>s   Timothy R. Otting<span class="_ _4"></span>er </div><div class="t m0 xa hd y2b ff6 fs3 fc0 sc0 ls0 ws0">J<span class="_ _4"></span>effrey J<span class="_ _1"></span>. Langr   Brett L. Schucher<span class="_ _6"></span>t </div><div class="t m0 xb hd y2c ff6 fs3 fc0 sc0 ls0 ws0">J<span class="_ _4"></span>ames W<span class="_ _0"></span>. Grenning   Kevin Dean W<span class="_ _4"></span>ampler </div><div class="t m0 xc hd y2d ff6 fs3 fc0 sc0 ls0 ws0">Object Mentor Inc<span class="_ _4"></span>. </div><div class="t m0 xd h6 y2e ff7 fs2 fc0 sc0 ls1 ws9">W<span class="_ _4"></span>riting clean code is what you must do in order to call yourself a professional.</div><div class="t m0 xd h6 y2f ff7 fs2 fc0 sc0 ls0 ws0">There is no reasonable excuse for doing anything less than your best.</div><div class="t m0 xe he y30 ff8 fs2 fc0 sc0 ls0 ws0">Upper Saddle Ri<span class="_ _4"></span>ver<span class="_ _4"></span>, NJ • Boston • Indianapolis • San Francisco</div><div class="t m0 xe he y31 ff8 fs2 fc0 sc0 ls0 ws0">Ne<span class="_ _4"></span>w <span class="_ _0"></span>Y<span class="_ _3"></span>ork • <span class="_ _4"></span>T<span class="_ _0"></span>oronto • Montreal • London • Munich • Paris • Madrid</div><div class="t m0 xe he y32 ff8 fs2 fc0 sc0 ls2 wsa">Capeto<span class="_ _4"></span>wn • Sydney • <span class="_ _1"></span>T<span class="_ _0"></span>okyo • Singapore • Me<span class="_ _4"></span>xico City</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5" class="pf w1 h2" data-page-no="5"><div class="pc pc5 w1 h2"><img class="bi xf y33 w3 hf" alt="" src="bg5.png"/><div class="t m0 xf h10 y34 ff8 fs8 fc0 sc0 ls0 ws0">Many of the designations used by manufacturers and sellers to distinguish their products are claimed <span class="_ _5"></span>a<span class="_ _4"></span>s </div><div class="t m0 xf h10 y35 ff8 fs8 fc0 sc0 ls3 wsb">trademarks. Where those designations appear in this book, and the publisher was a<span class="_ _4"></span>ware of a trademark <span class="ls0 ws0">claim,</span></div><div class="t m0 xf h10 y36 ff8 fs8 fc0 sc0 ls0 ws0">the designations hav<span class="_ _4"></span>e been printed with initial capital letters or in all capitals.</div><div class="t m0 xf h10 y37 ff8 fs8 fc0 sc0 ls4 wsc">The authors and publisher hav<span class="_ _4"></span>e taken care in the preparation of this book, b<span class="_ _5"></span>ut make no expressed or </div><div class="t m0 xf h10 y38 ff8 fs8 fc0 sc0 ls0 wsd">implied warranty of any kind and assume no responsibility for er<span class="_ _5"></span>rors or omissions. No liability is assumed </div><div class="t m0 xf h10 y39 ff8 fs8 fc0 sc0 ls0 ws0">for incidental or consequential damages in connection with or arising out of the use of the infor<span class="_ _6"></span>mation or </div><div class="t m0 xf h10 y3a ff8 fs8 fc0 sc0 ls0 ws0">programs contained herein.</div><div class="t m0 xf h10 y3b ff8 fs8 fc0 sc0 ls0 ws0">The publisher of<span class="_ _4"></span>fers excellent discounts on this book when ordered in quantity for b<span class="_ _5"></span>ulk purchases or </div><div class="t m0 xf h10 y3c ff8 fs8 fc0 sc0 ls0 ws0">special sales, which ma<span class="_ _4"></span>y include electronic versions and/or custom covers and content particular to your </div><div class="t m0 xf h10 y3d ff8 fs8 fc0 sc0 ls0 ws0">business, training goals, marketing focus, and branding interests. For more infor<span class="_ _5"></span>mation, please contact:</div><div class="t m0 x10 h10 y3e ff8 fs8 fc0 sc0 ls0 ws0">U<span class="_ _1"></span>.S. Cor<span class="_ _5"></span>porate and Go<span class="_ _4"></span>vernment Sales</div><div class="t m0 x10 h10 y3f ff8 fs8 fc0 sc0 ls0 ws0">(800) 382-3419</div><div class="t m0 x10 h10 y40 ff8 fs8 fc0 sc0 ls0 ws0">cor<span class="_ _5"></span>psales@pearsontechgroup.com</div><div class="t m0 xf h10 y41 ff8 fs8 fc0 sc0 ls0 ws0">F<span class="_ _4"></span>or sales outside the United States please contact:</div><div class="t m0 x10 h10 y42 ff8 fs8 fc0 sc0 ls0 ws0">International Sales</div><div class="t m0 x10 h10 y43 ff8 fs8 fc0 sc0 ls0 ws0">international@pearsoned.com</div><div class="t m0 xf h10 y44 ff8 fs8 fc0 sc0 ls0 ws0">  Includes bib</div><div class="t m0 x11 h10 y45 ff8 fs8 fc0 sc0 ls0 ws0">liographical references and index.</div><div class="t m0 xf h10 y46 ff8 fs8 fc0 sc0 ls0 ws0">  ISBN 0-13-235088-2 (pbk. : alk. paper)</div><div class="t m0 xf h10 y47 ff8 fs8 fc0 sc0 ls0 wsc">  1.  <span class="_ _4"></span>Agile software de<span class="_ _4"></span>velopment. 2.  Computer software—Reliability<span class="_ _1"></span>.  I. <span class="_ _4"></span>Title.</div><div class="t m0 xf h10 y48 ff8 fs8 fc0 sc0 ls0 ws0">  QA76.76.D47M3652 2008</div><div class="t m0 xf h10 y49 ff8 fs8 fc0 sc0 ls0 ws0">  005.1—dc22<span class="_ _7"> </span>2008024750</div><div class="t m0 xf h10 y4a ff8 fs8 fc0 sc0 ls0 ws0">Cop</div><div class="t m0 x12 h10 y4b ff8 fs8 fc0 sc0 ls0 ws0">yright © 2009 Pearson Education, Inc.</div><div class="t m0 xf h10 y4c ff8 fs8 fc0 sc0 ls0 ws0">All rights reser<span class="_ _5"></span>v<span class="_ _4"></span>ed. Printed in the United States of America. <span class="_ _1"></span>This publication is protected by copyright, </div><div class="t m0 xf h10 y4d ff8 fs8 fc0 sc0 ls0 ws0">and permission must be obtained from the pub<span class="_ _5"></span>lisher prior to an<span class="_ _4"></span>y prohibited reproduction, storage in a </div><div class="t m0 xf h10 y4e ff8 fs8 fc0 sc0 ls0 ws0">retriev<span class="_ _4"></span>al system, or transmission in any for<span class="_ _8"></span>m or by an<span class="_ _4"></span>y means, electronic, mechanical, photocopying, </div><div class="t m0 xf h10 y4f ff8 fs8 fc0 sc0 ls0 ws0">recording, or likewise. F<span class="_ _1"></span>or infor<span class="_ _8"></span>mation regarding per<span class="_ _8"></span>missions, write to:</div><div class="t m0 x13 h10 y50 ff8 fs8 fc0 sc0 ls0 ws0">P<span class="_ _4"></span>earson Education, Inc</div><div class="t m0 x13 h10 y51 ff8 fs8 fc0 sc0 ls0 ws0">Rights and Contracts Depar<span class="_ _8"></span>tment</div><div class="t m0 x13 h10 y52 ff8 fs8 fc0 sc0 ls0 ws0">501 Bo<span class="_ _4"></span>ylston Street, Suite 900</div><div class="t m0 x13 h10 y53 ff8 fs8 fc0 sc0 ls0 ws0">Boston, MA 02116</div><div class="t m0 x13 h10 y54 ff8 fs8 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>ax: (617) 671-3447</div><div class="t m0 xf h10 y55 ff8 fs8 fc0 sc0 ls0 ws0">ISBN-13:<span class="_ _9"> </span>978-0-13-235088-4</div><div class="t m0 xf h10 y56 ff8 fs8 fc0 sc0 ls5 wse">ISBN-10:<span class="_ _9"> </span>       <span class="_ _5"></span>0-13-235088-2</div><div class="t m0 xf h10 y57 ff8 fs8 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>ext printed in the United States on recycled paper at Courier in Stoughton, Massachusetts.</div><div class="t m0 xf h10 y58 ff8 fs8 fc0 sc0 ls0 ws0">First printing Jul<span class="_ _4"></span>y<span class="_ _1"></span>, 2008</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6" class="pf w1 h2" data-page-no="6"><div class="pc pc6 w1 h2"><div class="t m0 x14 h11 y59 ff5 fs7 fc0 sc0 ls6 wsf">F<span class="_ _2"></span>or <span class="_ _0"></span>Ann Marie:<span class="_ _4"></span> <span class="_ _4"></span>The ever enduring lo<span class="_ _4"></span>ve of m<span class="_ _4"></span>y life.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7" class="pf w1 h2" data-page-no="7"><div class="pc pc7 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8" class="pf w1 h2" data-page-no="8"><div class="pc pc8 w1 h2"><img class="bi xd y5b w4 h13" alt="" src="bg8.png"/><div class="t m0 x16 h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">vii</div><div class="t m0 x17 h9 y5d ff1 fs4 fc0 sc0 ls0 ws0">Contents</div><div class="t m0 xd h15 y5e ff8 fs9 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>ore<span class="_ _4"></span>w<span class="_ _4"></span>ord<span class="_ _6"></span><span class="fs7">................................................................................................ xix</span></div><div class="t m0 xd h15 y5f ff8 fs9 fc0 sc0 ls0 ws0">Introduction<span class="_ _a"> </span><span class="fs7">..........................................................................................<span class="_ _8"></span>xxv</span></div><div class="t m0 xd h15 y60 ff8 fs9 fc0 sc0 ls0 ws0">On the Co<span class="_ _1"></span>ver</div><div class="t m0 x18 h16 y61 ff8 fs7 fc0 sc0 ls0 ws0">....................................................................................... xxix</div><div class="t m0 xd h17 y62 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 1:<span class="_ _4"></span> Clean Code<span class="_ _8"></span><span class="ff8 fs7">........................................................................<span class="_ _8"></span>1</span></div><div class="t m0 x19 h16 y63 ff1 fs7 fc0 sc0 ls0 ws0">Ther<span class="_ _4"></span>e <span class="_ _1"></span>Will Be Code<span class="_ _b"> </span><span class="ff8">...............................................................................<span class="_ _8"></span>2</span></div><div class="t m0 x19 h16 y64 ff1 fs7 fc0 sc0 ls0 ws0">Bad Code<span class="_ _6"></span><span class="ff8">................................................................................................<span class="_ _5"></span>3</span></div><div class="t m0 x19 h16 y65 ff1 fs7 fc0 sc0 ls0 ws0">The <span class="_ _1"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess<span class="_ _b"> </span><span class="ff8">........................................................4</span></div><div class="t m0 x1a h16 y66 ff8 fs7 fc0 sc0 ls0 ws0">The Grand Redesign in the Sky..........................................................<span class="_ _8"></span>5</div><div class="t m0 x1a h16 y67 ff8 fs7 fc0 sc0 ls0 ws0">Attitude<span class="_ _6"></span>...............................................................................................5</div><div class="t m0 x1a h16 y68 ff8 fs7 fc0 sc0 ls0 ws0">The Primal Conundrum<span class="_ _6"></span>......................................................................<span class="_ _8"></span>6</div><div class="t m0 x1a h16 y69 ff8 fs7 fc0 sc0 ls0 ws0">The <span class="_ _1"></span>Ar<span class="_ _8"></span>t of Clean Code?<span class="_ _8"></span>......................................................................<span class="_ _8"></span>6</div><div class="t m0 x1a h16 y6a ff8 fs7 fc0 sc0 ls0 ws0">What Is Clean Code?<span class="_ _6"></span>..........................................................................7</div><div class="t m0 x19 h16 y6b ff1 fs7 fc0 sc0 ls0 ws0">Schools of <span class="_ _1"></span>Thought<span class="_ _c"> </span><span class="ff8">..............................................................................<span class="_ _8"></span>12</span></div><div class="t m0 x19 h16 y6c ff1 fs7 fc0 sc0 ls0 ws11">W<span class="_ _2"></span>e Are A<span class="_ _1"></span>uthors<span class="_ _6"></span><span class="ff8 ws0">....................................................................................<span class="_ _8"></span>13</span></div><div class="t m0 x19 h16 y6d ff1 fs7 fc0 sc0 ls0 ws0">The Bo<span class="_ _4"></span>y Scout Rule<span class="_ _d"></span><span class="ff8">.............................................................................<span class="_ _8"></span>14</span></div><div class="t m0 x19 h16 y6e ff1 fs7 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>equel and Principles<span class="_ _d"></span><span class="ff8">........................................................................<span class="_ _8"></span>15</span></div><div class="t m0 x19 h16 y6f ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">............................................................................................<span class="_ _8"></span>15</span></div><div class="t m0 x19 h16 y70 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.........................................................................................<span class="_ _8"></span>15</span></div><div class="t m0 xd h17 y71 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 2:<span class="_ _4"></span> Meaningful Names</div><div class="t m0 x1b h16 y72 ff8 fs7 fc0 sc0 ls0 ws0">.......................................................<span class="_ _8"></span>17</div><div class="t m0 x19 h16 y73 ff1 fs7 fc0 sc0 ls0 ws0">Intr<span class="_ _4"></span>oduction<span class="_ _c"> </span><span class="ff8">.........................................................................................<span class="_ _8"></span>17</span></div><div class="t m0 x19 h16 y74 ff1 fs7 fc0 sc0 ls0 ws0">Use Intention-Rev<span class="_ _1"></span>ealing Names<span class="_ _b"> </span><span class="ff8">.........................................................18</span></div><div class="t m0 x19 h16 y75 ff1 fs7 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>void Disinf<span class="_ _4"></span>ormation<span class="_ _c"> </span><span class="ff8">..........................................................................<span class="_ _8"></span>19</span></div><div class="t m0 x19 h16 y76 ff1 fs7 fc0 sc0 ls0 ws0">Make Meaningful Distinctions<span class="_ _6"></span><span class="ff8">...........................................................<span class="_ _8"></span>20</span></div><div class="t m0 x19 h16 y77 ff1 fs7 fc0 sc0 ls0 ws0">Use Pr<span class="_ _4"></span>onounceab<span class="_ _4"></span>le Names<span class="_ _8"></span><span class="ff8">..................................................................<span class="_ _8"></span>21</span></div><div class="t m0 x19 h16 y78 ff1 fs7 fc0 sc0 ls0 ws0">Use Sear<span class="_ _4"></span>chab<span class="_ _4"></span>le Names<span class="_ _e"> </span><span class="ff8">........................................................................<span class="_ _8"></span>22</span></div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:473.127010px;width:360.200000px;height:15.316000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1a" data-dest-detail='[26,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:445.127010px;width:360.186000px;height:15.316000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1e" data-dest-detail='[30,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:417.127010px;width:360.185000px;height:15.316000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf20" data-dest-detail='[32,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:389.001010px;width:360.145000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf21" data-dest-detail='[33,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:373.785010px;width:345.758400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf22" data-dest-detail='[34,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:359.785010px;width:345.790400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf23" data-dest-detail='[35,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:345.786010px;width:345.712400px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf24" data-dest-detail='[36,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:331.893010px;width:331.437000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf24" data-dest-detail='[36,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:317.893010px;width:331.425000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:303.892010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:289.892010px;width:331.436000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:275.891010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2b" data-dest-detail='[43,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:261.784010px;width:345.759400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2c" data-dest-detail='[44,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:247.784010px;width:345.772400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2d" data-dest-detail='[45,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227000px;bottom:233.783010px;width:345.757000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227000px;bottom:219.784010px;width:345.746000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227000px;bottom:205.784010px;width:345.786000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227000px;bottom:191.783010px;width:345.780000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf30" data-dest-detail='[48,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:165.001010px;width:360.116000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf30" data-dest-detail='[48,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:149.784010px;width:345.781300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:135.785010px;width:345.718300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf32" data-dest-detail='[50,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:121.785010px;width:345.752300px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf33" data-dest-detail='[51,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:107.783010px;width:345.722300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf34" data-dest-detail='[52,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:93.783910px;width:345.735300px;height:13.368100px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:79.783510px;width:345.747300px;height:13.367800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9" class="pf w1 h2" data-page-no="9"><div class="pc pc9 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">viii<span class="_ _f"> </span><span class="ff1">Contents</span></div><div class="t m0 x19 h16 y7a ff1 fs7 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>void Encodings<span class="_ _b"> </span><span class="ff8">..................................................................................23</span></div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls8 ws12">Hungarian Notation<span class="_ _c"> </span>..........................................................................<span class="_ _8"></span>23</div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Member Preﬁx<span class="_ _4"></span>es<span class="_ _8"></span>...............................................................................<span class="_ _8"></span>24</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">Interfaces and Implementations .......................................................24</div><div class="t m0 x19 h16 y7e ff1 fs7 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>void Mental Mapping<span class="_ _b"> </span><span class="ff8">.......................................................................25</span></div><div class="t m0 x19 h16 y7f ff1 fs7 fc0 sc0 ls0 ws0">Class Names<span class="_ _c"> </span><span class="ff8">.........................................................................................<span class="_ _8"></span>25</span></div><div class="t m0 x19 h16 y80 ff1 fs7 fc0 sc0 ls0 ws0">Method Names<span class="_ _6"></span><span class="ff8">.....................................................................................25</span></div><div class="t m0 x19 h16 y81 ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Be Cute<span class="_ _e"> </span><span class="ff8">......................................................................................<span class="_ _5"></span>26</span></div><div class="t m0 x19 h16 y82 ff1 fs7 fc0 sc0 ls0 ws0">Pick One <span class="_ _0"></span>W<span class="_ _0"></span>ord per Concept<span class="_ _8"></span><span class="ff8">...............................................................<span class="_ _8"></span>26</span></div><div class="t m0 x19 h16 y83 ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Pun<span class="_ _b"> </span><span class="ff8">.............................................................................................26</span></div><div class="t m0 x19 h16 y84 ff1 fs7 fc0 sc0 ls0 ws0">Use Solution Domain Names<span class="_ _c"> </span><span class="ff8">..............................................................<span class="_ _5"></span>27</span></div><div class="t m0 x19 h16 y85 ff1 fs7 fc0 sc0 ls0 ws0">Use Pr<span class="_ _4"></span>oblem Domain Names<span class="_ _6"></span><span class="ff8">..............................................................<span class="_ _8"></span>27</span></div><div class="t m0 x19 h16 y86 ff1 fs7 fc0 sc0 ls0 ws0">Add Meaningful Conte<span class="_ _4"></span>xt<span class="_ _b"> </span><span class="ff8">....................................................................27</span></div><div class="t m0 x19 h16 y87 ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t <span class="_ _0"></span>Add Gratuitous Conte<span class="_ _4"></span>xt<span class="_ _d"> </span><span class="ff8">...........................................................<span class="_ _8"></span>29</span></div><div class="t m0 x19 h16 y88 ff1 fs7 fc0 sc0 ls0 ws13">Final W<span class="_ _2"></span>ords<span class="_ _d"> </span><span class="ff8 ws0">..........................................................................................<span class="_ _8"></span>30</span></div><div class="t m0 xd h17 y89 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 3:<span class="_ _4"></span> Functions</div><div class="t m0 x1c h16 y8a ff8 fs7 fc0 sc0 ls0 ws0">.........................................................................<span class="_ _8"></span>31</div><div class="t m0 x19 h16 y8b ff1 fs7 fc0 sc0 ls0 ws0">Small!<span class="ff8">....................................................................................................<span class="_ _8"></span>34</span></div><div class="t m0 x1a h16 y8c ff8 fs7 fc0 sc0 ls0 ws0">Blocks and Indenting<span class="_ _8"></span>........................................................................<span class="_ _8"></span>35</div><div class="t m0 x19 h16 y8d ff1 fs7 fc0 sc0 ls0 ws0">Do One <span class="_ _1"></span>Thing<span class="_ _5"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>35</span></div><div class="t m0 x1a h16 y8e ff8 fs7 fc0 sc0 ls0 ws0">Sections within Functions<span class="_ _e"> </span>................................................................<span class="_ _8"></span>36</div><div class="t m0 x19 h16 y8f ff1 fs7 fc0 sc0 ls0 ws0">One Lev<span class="_ _1"></span>el of <span class="_ _0"></span>Abstraction per Function<span class="_ _b"> </span><span class="ff8">.............................................36</span></div><div class="t m0 x1a h16 y90 ff8 fs7 fc0 sc0 ls0 ws0">Reading Code from <span class="_ _1"></span>T<span class="_ _0"></span>op to Bottom: <span class="_ _1"></span><span class="ffa">The Stepdown Rule<span class="ff8">..................<span class="_ _8"></span>37</span></span></div><div class="t m0 x19 h16 y91 ff1 fs7 fc0 sc0 ls0 ws0">Switch Statements<span class="_ _b"> </span><span class="ff8">...............................................................................<span class="_ _8"></span>37</span></div><div class="t m0 x19 h16 y92 ff1 fs7 fc0 sc0 ls0 ws0">Use Descriptiv<span class="_ _4"></span>e Names<span class="_ _5"></span><span class="ff8">........................................................................<span class="_ _8"></span>39</span></div><div class="t m0 x19 h16 y93 ff1 fs7 fc0 sc0 ls0 ws11">Function Arguments<span class="ff8 ws0">............................................................................<span class="_ _8"></span>40</span></div><div class="t m0 x1a h16 y94 ff8 fs7 fc0 sc0 ls0 ws0">Common Monadic F<span class="_ _1"></span>or<span class="_ _8"></span>ms<span class="_ _5"></span>.................................................................<span class="_ _8"></span>41</div><div class="t m0 x1a h16 y95 ff8 fs7 fc0 sc0 ls0 ws14">Flag Arguments ................................................................................41</div><div class="t m0 x1a h16 y96 ff8 fs7 fc0 sc0 ls0 ws0">Dyadic Functions..............................................................................<span class="_ _8"></span>42</div><div class="t m0 x1a h16 y97 ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _4"></span>riads<span class="_ _6"></span>................................................................................................<span class="_ _8"></span>42</div><div class="t m0 x1a h16 y98 ff8 fs7 fc0 sc0 ls0 ws0">Argument Objects.............................................................................43</div><div class="t m0 x1a h16 y99 ff8 fs7 fc0 sc0 ls0 ws0">Argument Lists<span class="_ _6"></span>.................................................................................<span class="_ _8"></span>43</div><div class="t m0 x1a h16 y9a ff8 fs7 fc0 sc0 ls0 ws0">V<span class="_ _2"></span>erbs and Ke<span class="_ _4"></span>yw<span class="_ _4"></span>ords<span class="_ _6"></span>.........................................................................<span class="_ _8"></span>43</div><div class="t m0 x19 h16 y9b ff1 fs7 fc0 sc0 ls0 ws0">Ha<span class="_ _1"></span>ve No Side Effects<span class="_ _c"> </span><span class="ff8">...........................................................................<span class="_ _8"></span>44</span></div><div class="t m0 x1a h16 y9c ff8 fs7 fc0 sc0 ls0 ws14">Output Arguments ............................................................................45</div><div class="t m0 x19 h16 y9d ff1 fs7 fc0 sc0 ls0 ws0">Command Query Separation<span class="_ _c"> </span><span class="ff8">.............................................................<span class="_ _5"></span>45</span></div><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:582.728010px;width:345.768000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.375000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.835010px;width:331.455000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf38" data-dest-detail='[56,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:526.728010px;width:345.745000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf38" data-dest-detail='[56,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:512.727010px;width:345.781000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf38" data-dest-detail='[56,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:498.726010px;width:345.774000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:484.727010px;width:345.776000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:470.726010px;width:345.731000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:456.725010px;width:345.788000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3a" data-dest-detail='[58,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:442.726010px;width:345.728000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3a" data-dest-detail='[58,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:428.725010px;width:345.728000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3a" data-dest-detail='[58,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:414.725010px;width:345.740000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3c" data-dest-detail='[60,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:400.726010px;width:345.722000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3d" data-dest-detail='[61,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:386.725010px;width:345.782000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3e" data-dest-detail='[62,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:359.946010px;width:360.150000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf41" data-dest-detail='[65,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:344.728010px;width:345.803100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf42" data-dest-detail='[66,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:330.835010px;width:331.431000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf42" data-dest-detail='[66,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:316.727010px;width:345.776100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf43" data-dest-detail='[67,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:302.835010px;width:331.438000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf43" data-dest-detail='[67,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:288.726010px;width:345.694800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:274.834010px;width:331.243000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:260.725010px;width:345.761800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf46" data-dest-detail='[70,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:246.725010px;width:345.748800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf47" data-dest-detail='[71,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:232.724010px;width:345.755800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf48" data-dest-detail='[72,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:218.832010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf48" data-dest-detail='[72,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:204.832010px;width:331.430000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:190.831010px;width:331.430000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:176.831010px;width:331.425000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:162.830010px;width:331.386000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:148.830010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:134.829010px;width:331.431000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4b" data-dest-detail='[75,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:120.721010px;width:345.754800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.627000px;bottom:106.829010px;width:331.430000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227400px;bottom:92.720210px;width:345.727600px;height:13.367800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa" class="pf w1 h2" data-page-no="a"><div class="pc pca w1 h2"><div class="t m0 x1d h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">ix<span class="_ _10"></span><span class="ff1">Contents</span></div><div class="t m0 x19 h16 y7a ff1 fs7 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>efer Exceptions to Returning Err<span class="_ _4"></span>or Codes<span class="_ _c"> </span><span class="ff8">...................................<span class="_ _8"></span>46</span></div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws15">Extract T<span class="_ _4"></span>r<span class="_ _8"></span>y/Catch <span class="_ _5"></span>Blocks .................................................................46</div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Er<span class="_ _8"></span>ror Handling Is One <span class="_ _1"></span>Thing<span class="_ _8"></span>............................................................<span class="_ _8"></span>47</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">The</div><div class="t m2 x1e h18 y9e ffb fs7 fc0 sc0 ls0 ws0">Error.java</div><div class="t m0 x1f h16 y9e ff8 fs7 fc0 sc0 ls0 ws0"> Dependency Magnet<span class="_ _b"> </span>.............................................<span class="_ _8"></span>47</div><div class="t m0 x19 h16 y9f ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Repeat <span class="_ _0"></span>Y<span class="_ _3"></span>ourself<span class="_ _e"> </span><span class="ff8">.........................................................................<span class="_ _8"></span>48</span></div><div class="t m0 x19 h16 ya0 ff1 fs7 fc0 sc0 ls0 ws0">Structur<span class="_ _4"></span>ed Pr<span class="_ _4"></span>ogramming<span class="_ _e"> </span><span class="ff8">...................................................................<span class="_ _8"></span>48</span></div><div class="t m0 x19 h16 ya1 ff1 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _1"></span>w Do <span class="_ _0"></span>Y<span class="_ _3"></span>ou <span class="_ _0"></span>Write Functions Like <span class="_ _1"></span>This?<span class="_ _b"> </span><span class="ff8">..........................................<span class="_ _8"></span>49</span></div><div class="t m0 x19 h16 ya2 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">............................................................................................<span class="_ _8"></span>49</span></div><div class="t m2 x19 h19 ya3 ffc fs7 fc0 sc0 ls0 ws0">SetupTeardownIncluder</div><div class="t m0 x20 h16 ya3 ff8 fs7 fc0 sc0 ls0 ws0">.....................................................................<span class="_ _8"></span>50</div><div class="t m0 x19 h16 ya4 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.........................................................................................<span class="_ _8"></span>52</span></div><div class="t m0 xd h17 ya5 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 4:<span class="_ _4"></span> Comments</div><div class="t m0 x8 h16 ya6 ff8 fs7 fc0 sc0 ls0 ws0">.......................................................................<span class="_ _8"></span>53</div><div class="t m0 x19 h16 ya7 ff1 fs7 fc0 sc0 ls0 ws0">Comments Do Not Make Up f<span class="_ _4"></span>or Bad Code<span class="ff8">.......................................55</span></div><div class="t m0 x19 h16 ya8 ff1 fs7 fc0 sc0 ls0 ws0">Explain <span class="_ _2"></span>Y<span class="_ _2"></span>ourself in Code<span class="_ _e"> </span><span class="ff8">....................................................................<span class="_ _5"></span>55</span></div><div class="t m0 x19 h16 ya9 ff1 fs7 fc0 sc0 ls0 ws0">Good Comments<span class="_ _6"></span><span class="ff8">..................................................................................<span class="_ _5"></span>55</span></div><div class="t m0 x1a h16 yaa ff8 fs7 fc0 sc0 ls0 ws0">Legal Comments...............................................................................55</div><div class="t m0 x1a h16 yab ff8 fs7 fc0 sc0 ls0 ws0">Informative Comments<span class="_ _8"></span>.....................................................................<span class="_ _5"></span>56</div><div class="t m0 x1a h16 yac ff8 fs7 fc0 sc0 ls0 ws0">Explanation of Intent<span class="_ _6"></span>........................................................................<span class="_ _5"></span>56</div><div class="t m0 x1a h16 yad ff8 fs7 fc0 sc0 ls0 ws0">Clariﬁcation<span class="_ _6"></span>......................................................................................<span class="_ _8"></span>57</div><div class="t m0 x1a h16 yae ff8 fs7 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>ar<span class="_ _8"></span>ning of Consequences<span class="_ _d"></span>................................................................<span class="_ _8"></span>58</div><div class="t m0 x1a h16 yaf ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _4"></span>ODO Comments.............................................................................<span class="_ _5"></span>58</div><div class="t m0 x1a h16 yb0 ff8 fs7 fc0 sc0 ls0 ws0">Ampliﬁcation<span class="_ _8"></span>....................................................................................<span class="_ _8"></span>59</div><div class="t m0 x1a h16 yb1 ff8 fs7 fc0 sc0 ls0 ws0">Ja<span class="_ _4"></span>v<span class="_ _4"></span>adocs in Public <span class="_ _1"></span>APIs<span class="_ _8"></span>....................................................................<span class="_ _8"></span>59</div><div class="t m0 x19 h16 yb2 ff1 fs7 fc0 sc0 ls0 ws0">Bad Comments<span class="_ _e"> </span><span class="ff8">....................................................................................<span class="_ _8"></span>59</span></div><div class="t m0 x1a h16 yb3 ff8 fs7 fc0 sc0 ls0 ws0">Mumbling<span class="_ _d"> </span>.........................................................................................<span class="_ _8"></span>59</div><div class="t m0 x1a h16 yb4 ff8 fs7 fc0 sc0 ls0 ws0">Redundant Comments<span class="_ _b"> </span>......................................................................<span class="_ _8"></span>60</div><div class="t m0 x1a h16 yb5 ff8 fs7 fc0 sc0 ls0 ws0">Misleading Comments......................................................................<span class="_ _8"></span>63</div><div class="t m0 x1a h16 yb6 ff8 fs7 fc0 sc0 ls0 ws0">Mandated Comments........................................................................<span class="_ _8"></span>63</div><div class="t m0 x1a h16 yb7 ff8 fs7 fc0 sc0 ls0 ws0">Journal Comments<span class="_ _6"></span>............................................................................63</div><div class="t m0 x1a h16 yb8 ff8 fs7 fc0 sc0 ls0 ws0">Noise Comments<span class="_ _b"> </span>..............................................................................<span class="_ _8"></span>64</div><div class="t m0 x1a h16 yb9 ff8 fs7 fc0 sc0 ls0 ws0">Scary Noise ......................................................................................66</div><div class="t m0 x1a h16 yba ff8 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _1"></span>t Use a Comment When <span class="_ _2"></span>Y<span class="_ _3"></span>ou Can Use a </div><div class="t m0 x1a h16 ybb ff8 fs7 fc0 sc0 ls0 ws0">Function or a <span class="_ _1"></span>V<span class="_ _2"></span>ariable.......................................................................<span class="_ _8"></span>67</div><div class="t m0 x1a h16 ybc ff8 fs7 fc0 sc0 ls0 ws0">P<span class="_ _4"></span>osition Markers<span class="_ _8"></span>...............................................................................<span class="_ _8"></span>67</div><div class="t m0 x1a h16 ybd ff8 fs7 fc0 sc0 ls0 ws0">Closing Brace Comments<span class="_ _6"></span>.................................................................67</div><div class="t m0 x1a h16 ybe ff8 fs7 fc0 sc0 ls9 ws16">Attributions and Bylines...................................................................<span class="_ _8"></span>68</div><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:582.728010px;width:345.676000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.443000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.442000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.428010px;width:331.376000px;height:13.536000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4f" data-dest-detail='[79,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:526.728010px;width:345.750100px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4f" data-dest-detail='[79,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:512.727010px;width:345.738100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf50" data-dest-detail='[80,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:498.727010px;width:345.690100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf50" data-dest-detail='[80,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:484.726010px;width:345.787100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:470.428010px;width:345.742000px;height:13.536000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf53" data-dest-detail='[83,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225100px;bottom:456.728010px;width:345.780900px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf54" data-dest-detail='[84,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:429.946010px;width:360.146000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:414.728010px;width:345.684400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:400.727010px;width:345.740400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:386.727010px;width:345.768400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf56" data-dest-detail='[86,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:372.835010px;width:331.433000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf57" data-dest-detail='[87,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:358.834010px;width:331.442000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf57" data-dest-detail='[87,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:344.834010px;width:331.436000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf58" data-dest-detail='[88,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:330.833010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf59" data-dest-detail='[89,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:316.833010px;width:331.436000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf59" data-dest-detail='[89,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:302.832010px;width:331.428000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5a" data-dest-detail='[90,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:288.832010px;width:331.431000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5a" data-dest-detail='[90,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:274.832010px;width:331.438000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5a" data-dest-detail='[90,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:260.723010px;width:345.771400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5a" data-dest-detail='[90,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:246.831010px;width:331.423000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5b" data-dest-detail='[91,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:232.830010px;width:331.428000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5e" data-dest-detail='[94,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:218.830010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5e" data-dest-detail='[94,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:204.829010px;width:331.431000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5e" data-dest-detail='[94,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:190.829010px;width:331.430000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5f" data-dest-detail='[95,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:176.829010px;width:331.428000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf61" data-dest-detail='[97,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:162.828010px;width:331.427000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf62" data-dest-detail='[98,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:134.827010px;width:331.428000px;height:27.129000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf62" data-dest-detail='[98,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:120.827010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf62" data-dest-detail='[98,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:106.827010px;width:331.436000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf63" data-dest-detail='[99,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:92.826110px;width:331.492000px;height:13.127900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb" class="pf w1 h2" data-page-no="b"><div class="pc pcb w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">x<span class="_ _11"> </span><span class="ff1">Contents</span></div><div class="t m0 x1a h16 y7a ff8 fs7 fc0 sc0 ls0 ws0">Commented-Out Code......................................................................<span class="_ _8"></span>68</div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws0">HTML Comments<span class="_ _b"> </span>............................................................................<span class="_ _8"></span>69</div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Nonlocal Information<span class="_ _b"> </span>.......................................................................69</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>oo Much Infor<span class="_ _8"></span>mation<span class="_ _e"> </span>.....................................................................70</div><div class="t m0 x1a h16 y7e ff8 fs7 fc0 sc0 ls0 ws0">Inob<span class="_ _4"></span>vious Connection.......................................................................<span class="_ _5"></span>70</div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">Function Headers..............................................................................<span class="_ _8"></span>70</div><div class="t m0 x1a h16 y80 ff8 fs7 fc0 sc0 ls0 ws0">Ja<span class="_ _4"></span>v<span class="_ _4"></span>adocs in Nonpublic Code<span class="_ _e"> </span>............................................................<span class="_ _8"></span>71</div><div class="t m0 x1a h16 y81 ff8 fs7 fc0 sc0 ls0 ws0">Example<span class="_ _8"></span>............................................................................................<span class="_ _8"></span>71</div><div class="t m0 x19 h16 y82 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.........................................................................................<span class="_ _8"></span>74</span></div><div class="t m0 xd h17 ybf ff1 fs9 fc0 sc0 ls0 ws0">Chapter 5:<span class="_ _4"></span> F<span class="_ _0"></span>ormatting</div><div class="t m0 xc h16 yc0 ff8 fs7 fc0 sc0 ls0 ws0">......................................................................<span class="_ _8"></span>75</div><div class="t m0 x19 h16 yc1 ff1 fs7 fc0 sc0 ls0 ws0">The Purpose of F<span class="_ _0"></span>ormatting <span class="ff8">................................................................76</span></div><div class="t m0 x19 h16 yc2 ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>er<span class="_ _8"></span>tical F<span class="_ _1"></span>ormatting<span class="_ _c"> </span><span class="ff8">.............................................................................<span class="_ _8"></span>76</span></div><div class="t m0 x1a h16 yc3 ff8 fs7 fc0 sc0 ls0 ws0">The Ne<span class="_ _4"></span>wspaper Metaphor<span class="_ _e"> </span>................................................................77</div><div class="t m0 x1a h16 yc4 ff8 fs7 fc0 sc0 ls0 ws0">V<span class="_ _2"></span>er<span class="_ _8"></span>tical Openness Betw<span class="_ _4"></span>een Concepts<span class="_ _b"> </span>..............................................78</div><div class="t m0 x1a h16 yc5 ff8 fs7 fc0 sc0 ls0 ws0">V<span class="_ _2"></span>er<span class="_ _8"></span>tical Density<span class="_ _d"></span>................................................................................<span class="_ _8"></span>79</div><div class="t m0 x1a h16 yc6 ff8 fs7 fc0 sc0 ls0 ws0">V<span class="_ _2"></span>er<span class="_ _8"></span>tical Distance<span class="_ _a"> </span>..............................................................................<span class="_ _8"></span>80</div><div class="t m0 x1a h16 yc7 ff8 fs7 fc0 sc0 ls0 ws0">V<span class="_ _2"></span>er<span class="_ _8"></span>tical Ordering<span class="_ _d"></span>..............................................................................<span class="_ _8"></span>84</div><div class="t m0 x19 h16 yc8 ff1 fs7 fc0 sc0 ls0 ws0">Horizontal F<span class="_ _1"></span>ormatting<span class="_ _d"></span><span class="ff8">........................................................................85</span></div><div class="t m0 x1a h16 yc9 ff8 fs7 fc0 sc0 ls0 ws0">Horizontal Openness and Density<span class="_ _c"> </span>....................................................<span class="_ _8"></span>86</div><div class="t m0 x1a h16 yca ff8 fs7 fc0 sc0 ls0 ws14">Horizontal Alignment<span class="_ _6"></span>.......................................................................<span class="_ _8"></span>87</div><div class="t m0 x1a h16 ycb ff8 fs7 fc0 sc0 ls0 ws0">Indentation<span class="_ _8"></span>........................................................................................<span class="_ _8"></span>88</div><div class="t m0 x1a h16 ycc ff8 fs7 fc0 sc0 ls0 ws0">Dumm<span class="_ _4"></span>y Scopes.................................................................................<span class="_ _5"></span>90</div><div class="t m0 x19 h16 ycd ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>eam Rules<span class="_ _5"></span><span class="ff8">...........................................................................................<span class="_ _8"></span>90</span></div><div class="t m0 x19 h16 yce ff1 fs7 fc0 sc0 ls0 ws0">Uncle Bob’<span class="_ _0"></span>s F<span class="_ _1"></span>ormatting Rules<span class="ff8">............................................................<span class="_ _8"></span>90</span></div><div class="t m0 xd h17 ycf ff1 fs9 fc0 sc0 ls0 ws0">Chapter 6:<span class="_ _4"></span> Objects and Data Structur<span class="_ _4"></span>es</div><div class="t m0 x21 h16 yd0 ff8 fs7 fc0 sc0 ls0 ws0">....................................<span class="_ _8"></span>93</div><div class="t m0 x19 h16 yd1 ff1 fs7 fc0 sc0 ls0 ws11">Data Abstraction<span class="ff8 ws0">..................................................................................<span class="_ _8"></span>93</span></div><div class="t m0 x19 h16 yd2 ff1 fs7 fc0 sc0 ls0 ws11">Data/Object Anti-Symmetry<span class="_ _a"> </span><span class="ff8 ws0">..............................................................<span class="_ _8"></span>95</span></div><div class="t m0 x19 h16 yd3 ff1 fs7 fc0 sc0 ls0 ws0">The La<span class="_ _1"></span>w of Demeter<span class="_ _5"></span><span class="ff8">............................................................................<span class="_ _8"></span>97</span></div><div class="t m0 x1a h16 yd4 ff8 fs7 fc0 sc0 ls0 ws17">T<span class="_ _4"></span>rain Wrecks<span class="_ _e"> </span>....................................................................................98</div><div class="t m0 x1a h16 yd5 ff8 fs7 fc0 sc0 ls0 ws0">Hybrids<span class="_ _d"> </span>.............................................................................................<span class="_ _8"></span>99</div><div class="t m0 x1a h16 yd6 ff8 fs7 fc0 sc0 ls0 ws0">Hiding Structure<span class="_ _b"> </span>...............................................................................99</div><div class="t m0 x19 h16 yd7 ff1 fs7 fc0 sc0 ls0 ws18">Data T<span class="_ _0"></span>ransfer <span class="_ _5"></span>Objects<span class="_ _6"></span><span class="ff8 ws0">.......................................................................<span class="_ _8"></span>100</span></div><div class="t m0 x1a h16 yd8 ff8 fs7 fc0 sc0 ls0 ws0">Acti<span class="_ _4"></span>ve Record<span class="_ _6"></span>.................................................................................<span class="_ _8"></span>101</div><div class="t m0 x19 h16 yd9 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>101</span></div><div class="t m0 x19 h16 yda ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>101</span></div><a class="l" href="#pf63" data-dest-detail='[99,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:582.836010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf64" data-dest-detail='[100,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.428000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf64" data-dest-detail='[100,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.439000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.835010px;width:331.436000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:526.834010px;width:331.430000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf65" data-dest-detail='[101,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:512.834010px;width:331.432000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf66" data-dest-detail='[102,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:498.834010px;width:331.433000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf66" data-dest-detail='[102,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:484.833010px;width:331.425000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf69" data-dest-detail='[105,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:470.724010px;width:345.781000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6a" data-dest-detail='[106,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:443.946010px;width:360.145000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6b" data-dest-detail='[107,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:428.728010px;width:345.733400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6b" data-dest-detail='[107,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:414.727010px;width:345.758400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6c" data-dest-detail='[108,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:400.834010px;width:331.436000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6d" data-dest-detail='[109,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:386.832010px;width:331.450000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6e" data-dest-detail='[110,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:372.831010px;width:331.437000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf6f" data-dest-detail='[111,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:358.829010px;width:331.440000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf73" data-dest-detail='[115,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:344.828010px;width:331.441000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf74" data-dest-detail='[116,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:330.719010px;width:345.747400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf75" data-dest-detail='[117,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:316.827010px;width:331.441000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf76" data-dest-detail='[118,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:302.827010px;width:331.439000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf77" data-dest-detail='[119,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:288.826010px;width:331.427000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf79" data-dest-detail='[121,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:274.826010px;width:331.426000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf79" data-dest-detail='[121,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:260.717010px;width:345.785400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf79" data-dest-detail='[121,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:246.717010px;width:345.724400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7c" data-dest-detail='[124,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:219.946010px;width:360.078000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7c" data-dest-detail='[124,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:204.728010px;width:345.768200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf7e" data-dest-detail='[126,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:190.727010px;width:345.728200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf80" data-dest-detail='[128,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:176.727010px;width:345.756200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf81" data-dest-detail='[129,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:162.835010px;width:331.433000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf82" data-dest-detail='[130,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:148.834010px;width:331.420000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf82" data-dest-detail='[130,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:134.834010px;width:331.433000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf83" data-dest-detail='[131,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:120.725010px;width:345.750200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf84" data-dest-detail='[132,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:106.833010px;width:331.429000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf84" data-dest-detail='[132,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:92.724510px;width:345.787200px;height:13.367500px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf84" data-dest-detail='[132,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:78.722910px;width:345.781200px;height:13.367800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc" class="pf w1 h2" data-page-no="c"><div class="pc pcc w1 h2"><div class="t m0 x1d h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xi<span class="_ _10"></span><span class="ff1">Contents</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Chapter 7:<span class="_ _4"></span> Err<span class="_ _4"></span>or Handling</div><div class="t m0 x22 h16 ydc ff8 fs7 fc0 sc0 ls0 ws0">...........................................................<span class="_ _8"></span>103</div><div class="t m0 x19 h16 ydd ff1 fs7 fc0 sc0 ls0 ws0">Use Exceptions Rather <span class="_ _1"></span>Than Return Codes<span class="_ _b"> </span><span class="ff8">...................................<span class="_ _8"></span>104</span></div><div class="t m0 x19 h11 yde ff1 fs7 fc0 sc0 ls0 ws19">Write Y<span class="_ _3"></span>our </div><div class="t m3 x18 h1a ydf ffc fsa fc0 sc0 ls0 ws0">Try-Catch-Finally</div><div class="t m0 x23 h16 ydf ff1 fs7 fc0 sc0 ls0 ws0"> Statement First<span class="_ _c"> </span><span class="ff8">.......................<span class="_ _8"></span>105</span></div><div class="t m0 x19 h16 ye0 ff1 fs7 fc0 sc0 ls0 ws0">Use Unchecked Exceptions<span class="_ _6"></span><span class="ff8">...............................................................<span class="_ _8"></span>106</span></div><div class="t m0 x19 h16 ye1 ff1 fs7 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>o<span class="_ _4"></span>vide Context with Exceptions<span class="_ _6"></span><span class="ff8">.....................................................<span class="_ _8"></span>107</span></div><div class="t m0 x19 h16 ye2 ff1 fs7 fc0 sc0 ls0 ws0">Deﬁne Exception Classes in <span class="_ _1"></span>T<span class="_ _0"></span>erms of a Caller’<span class="_ _0"></span>s Needs<span class="ff8">..................<span class="_ _8"></span>107</span></div><div class="t m0 x19 h16 ye3 ff1 fs7 fc0 sc0 ls0 ws0">Deﬁne the Normal Flo<span class="_ _1"></span>w<span class="_ _b"> </span><span class="ff8">....................................................................109</span></div><div class="t m0 x19 h16 ye4 ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Return Null<span class="ff8">..............................................................................110</span></div><div class="t m0 x19 h16 ye5 ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t P<span class="_ _4"></span>ass Null<span class="_ _e"> </span><span class="ff8">..................................................................................<span class="_ _8"></span>111</span></div><div class="t m0 x19 h16 ye6 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>112</span></div><div class="t m0 x19 h16 ye7 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>112</span></div><div class="t m0 xd h17 ye8 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 8:<span class="_ _4"></span> Boundaries<span class="_ _d"></span><span class="ff8 fs7">....................................................................<span class="_ _8"></span>113</span></div><div class="t m0 x19 h16 ye9 ff1 fs7 fc0 sc0 ls0 ws18">Using Third-P<span class="_ _1"></span>ar<span class="_ _8"></span>ty <span class="_ _5"></span>Code<span class="ff8 ws0">....................................................................<span class="_ _8"></span>114</span></div><div class="t m0 x19 h16 yea ff1 fs7 fc0 sc0 ls0 ws0">Exploring and Learning Boundaries<span class="_ _5"></span><span class="ff8">...............................................<span class="_ _8"></span>116</span></div><div class="t m0 x19 h11 yeb ff1 fs7 fc0 sc0 ls0 ws0">Learning </div><div class="t m3 x24 h1a yec ffc fsa fc0 sc0 ls0 ws0">log4j</div><div class="t m0 xa h16 yec ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................<span class="_ _8"></span>116</div><div class="t m0 x19 h16 yed ff1 fs7 fc0 sc0 ls0 ws18">Learning T<span class="_ _2"></span>ests Ar<span class="_ _1"></span>e <span class="_ _6"></span>Better Than <span class="_ _5"></span>F<span class="_ _4"></span>ree<span class="ff8 ws0">...............................................<span class="_ _8"></span>118</span></div><div class="t m0 x19 h16 yee ff1 fs7 fc0 sc0 ls0 ws0">Using Code <span class="_ _1"></span>That Does Not <span class="_ _2"></span>Y<span class="_ _2"></span>et Exist<span class="_ _6"></span><span class="ff8">................................................<span class="_ _8"></span>118</span></div><div class="t m0 x19 h16 yef ff1 fs7 fc0 sc0 ls0 ws0">Clean Boundaries<span class="_ _b"> </span><span class="ff8">..............................................................................120</span></div><div class="t m0 x19 h16 yf0 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>120</span></div><div class="t m0 xd h17 yf1 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _0"></span>T<span class="_ _0"></span>ests<span class="_ _b"> </span><span class="ff8 fs7">.......................................................................121</span></div><div class="t m0 x19 h16 yf2 ff1 fs7 fc0 sc0 ls0 ws0">The <span class="_ _1"></span>Thr<span class="_ _4"></span>ee La<span class="_ _1"></span>ws of <span class="_ _d"></span>TDD<span class="_ _b"> </span><span class="ff8">...................................................................122</span></div><div class="t m0 x19 h16 yf3 ff1 fs7 fc0 sc0 ls0 ws18">K<span class="_ _4"></span>eeping T<span class="_ _0"></span>ests <span class="_ _6"></span>Clean <span class="ff8 ws0">..........................................................................123</span></div><div class="t m0 x1a h16 yf4 ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _2"></span>ests Enable the -ilities<span class="_ _5"></span>...................................................................<span class="_ _8"></span>124</div><div class="t m0 x19 h16 yf5 ff1 fs7 fc0 sc0 ls0 ws18">Clean T<span class="_ _0"></span>ests<span class="_ _e"> </span><span class="ff8 ws0">.........................................................................................<span class="_ _8"></span>124</span></div><div class="t m0 x1a h16 yf6 ff8 fs7 fc0 sc0 ls0 ws15">Domain-Speciﬁc T<span class="_ _2"></span>esting <span class="_ _6"></span>Language................................................<span class="_ _8"></span>127</div><div class="t m0 x1a h16 yf7 ff8 fs7 fc0 sc0 ls0 ws0">A Dual Standard<span class="_ _c"> </span>.............................................................................127</div><div class="t m0 x19 h16 yf8 ff1 fs7 fc0 sc0 ls0 ws11">One Assert <span class="_ _6"></span>per <span class="_ _5"></span>T<span class="_ _0"></span>est<span class="_ _a"> </span><span class="ff8 ws0">...........................................................................<span class="_ _8"></span>130</span></div><div class="t m0 x1a h16 yf9 ff8 fs7 fc0 sc0 ls0 ws0">Single Concept per <span class="_ _1"></span>T<span class="_ _0"></span>est<span class="_ _d"></span>..................................................................<span class="_ _8"></span>131</div><div class="t m0 x19 h16 yfa ff1 fs7 fc0 sc0 ls0 ws0">F<span class="_ _2"></span>.I.R.S.T<span class="_ _1"></span>.<span class="_ _8"></span><span class="ff8">.............................................................................................<span class="_ _8"></span>132</span></div><div class="t m0 x19 h16 yfb ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>133</span></div><div class="t m0 x19 h16 yfc ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>133</span></div><div class="t m0 xd h17 yfd ff1 fs9 fc0 sc0 ls0 ws0">Chapter 10:<span class="_ _4"></span> Classes<span class="_ _d"></span><span class="ff8 fs7">..........................................................................<span class="_ _8"></span>135</span></div><div class="t m0 x19 h16 yfe ff1 fs7 fc0 sc0 ls0 ws0">Class Org<span class="_ _4"></span>anization<span class="_ _c"> </span><span class="ff8">............................................................................<span class="_ _8"></span>136</span></div><div class="t m0 x1a h16 yff ff8 fs7 fc0 sc0 ls0 ws0">Encapsulation<span class="_ _b"> </span>.................................................................................<span class="_ _8"></span>136</div><a class="l" href="#pf86" data-dest-detail='[134,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:360.127000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf87" data-dest-detail='[135,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:565.728010px;width:345.680400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf88" data-dest-detail='[136,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:550.927010px;width:345.656400px;height:14.717000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf89" data-dest-detail='[137,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:537.728010px;width:345.734500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8a" data-dest-detail='[138,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:523.727010px;width:345.715500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8a" data-dest-detail='[138,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:509.727010px;width:345.646500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8c" data-dest-detail='[140,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:495.726010px;width:345.742500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8d" data-dest-detail='[141,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:481.726010px;width:345.764500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8e" data-dest-detail='[142,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:467.726010px;width:345.771500px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8f" data-dest-detail='[143,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:453.725010px;width:345.788500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8f" data-dest-detail='[143,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225500px;bottom:439.725010px;width:345.782500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf90" data-dest-detail='[144,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:412.945010px;width:360.144000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf91" data-dest-detail='[145,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:397.728010px;width:345.744300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf93" data-dest-detail='[147,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224700px;bottom:383.726010px;width:345.703300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf93" data-dest-detail='[147,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:368.927010px;width:345.770200px;height:14.717000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf95" data-dest-detail='[149,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:355.728010px;width:345.703600px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf95" data-dest-detail='[149,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:341.726010px;width:345.704600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf97" data-dest-detail='[151,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:327.726010px;width:345.763600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf97" data-dest-detail='[151,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:313.724010px;width:345.781600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf98" data-dest-detail='[152,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:286.945010px;width:360.150000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf99" data-dest-detail='[153,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:271.728010px;width:345.742100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9a" data-dest-detail='[154,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:257.727010px;width:345.756100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9b" data-dest-detail='[155,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:243.835010px;width:331.452000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9b" data-dest-detail='[155,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224900px;bottom:229.727010px;width:345.785100px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9e" data-dest-detail='[158,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:215.833010px;width:331.451000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9e" data-dest-detail='[158,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:201.832010px;width:331.429000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa1" data-dest-detail='[161,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225100px;bottom:187.723010px;width:345.757900px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa2" data-dest-detail='[162,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:173.831010px;width:331.440000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa3" data-dest-detail='[163,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:159.722010px;width:345.792800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa4" data-dest-detail='[164,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:145.722010px;width:345.786800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa4" data-dest-detail='[164,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.226200px;bottom:131.721010px;width:345.780800px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa6" data-dest-detail='[166,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:104.945010px;width:360.156000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa7" data-dest-detail='[167,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224800px;bottom:89.728010px;width:345.759200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa7" data-dest-detail='[167,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:75.834510px;width:331.427000px;height:13.127700px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd" class="pf w1 h2" data-page-no="d"><div class="pc pcd w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xii<span class="_ _12"> </span><span class="ff1">Contents</span></div><div class="t m0 x19 h16 y7a ff1 fs7 fc0 sc0 ls0 ws0">Classes Should Be Small!<span class="_ _8"></span><span class="ff8">..................................................................<span class="_ _8"></span>136</span></div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws0">The Single Responsibility Principle<span class="_ _6"></span>...............................................<span class="_ _5"></span>138</div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Cohesion<span class="_ _6"></span>.........................................................................................140</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">Maintaining Cohesion Results in Man<span class="_ _4"></span>y Small Classes<span class="_ _6"></span>..................<span class="_ _8"></span>141</div><div class="t m0 x19 h16 y7e ff1 fs7 fc0 sc0 ls0 ws0">Org<span class="_ _4"></span>anizing for Chang<span class="_ _4"></span>e<span class="_ _a"> </span><span class="ff8">.....................................................................<span class="_ _8"></span>147</span></div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">Isolating from Change<span class="_ _6"></span>....................................................................<span class="_ _5"></span>149</div><div class="t m0 x19 h16 y80 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>151</span></div><div class="t m0 xd h17 y100 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 11:<span class="_ _4"></span> Systems<span class="_ _a"> </span><span class="ff8 fs7">........................................................................153</span></div><div class="t m0 x19 h16 y101 ff1 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _1"></span>w <span class="_ _1"></span>W<span class="_ _0"></span>ould <span class="_ _2"></span>Y<span class="_ _3"></span>ou Build a City?<span class="_ _b"> </span><span class="ff8">..........................................................<span class="_ _8"></span>154</span></div><div class="t m0 x19 h16 y102 ff1 fs7 fc0 sc0 ls0 ws0">Separate Constructing a System fr<span class="_ _4"></span>om Using It<span class="_ _d"></span><span class="ff8">..............................154</span></div><div class="t m0 x1a h16 y103 ff8 fs7 fc0 sc0 ls0 ws0">Separation of Main<span class="_ _c"> </span>.........................................................................155</div><div class="t m0 x1a h16 y104 ff8 fs7 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>actories .........................................................................................155</div><div class="t m0 x1a h16 y105 ff8 fs7 fc0 sc0 ls0 ws0">Dependency Injection<span class="_ _5"></span>.....................................................................<span class="_ _8"></span>157</div><div class="t m0 x19 h16 y106 ff1 fs7 fc0 sc0 ls0 ws0">Scaling Up<span class="_ _b"> </span><span class="ff8">..........................................................................................157</span></div><div class="t m0 x1a h16 y107 ff8 fs7 fc0 sc0 ls0 ws0">Cross-Cutting Concerns<span class="_ _e"> </span>.................................................................<span class="_ _8"></span>160</div><div class="t m0 x19 h16 y108 ff1 fs7 fc0 sc0 ls0 ws0">Ja<span class="_ _0"></span>va Pr<span class="_ _1"></span>o<span class="_ _4"></span>xies<span class="_ _5"></span><span class="ff8">........................................................................................<span class="_ _8"></span>161</span></div><div class="t m0 x19 h16 y109 ff1 fs7 fc0 sc0 ls0 ws0">Pur<span class="_ _4"></span>e Ja<span class="_ _1"></span>v<span class="_ _4"></span>a <span class="_ _0"></span>A<span class="_ _4"></span>OP F<span class="_ _4"></span>rame<span class="_ _4"></span>w<span class="_ _4"></span>orks<span class="_ _5"></span><span class="ff8">.............................................................<span class="_ _8"></span>163</span></div><div class="t m0 x19 h16 y10a ff1 fs7 fc0 sc0 ls0 ws11">AspectJ Aspects<span class="_ _e"> </span><span class="ff8 ws0">.................................................................................<span class="_ _8"></span>166</span></div><div class="t m0 x19 h16 y10b ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>est Driv<span class="_ _1"></span>e the System <span class="_ _0"></span>Architectur<span class="_ _1"></span>e<span class="_ _8"></span><span class="ff8">..................................................<span class="_ _8"></span>166</span></div><div class="t m0 x19 h16 y10c ff1 fs7 fc0 sc0 ls0 ws0">Optimize Decision Making<span class="_ _b"> </span><span class="ff8">...............................................................167</span></div><div class="t m0 x19 h16 y10d ff1 fs7 fc0 sc0 ls0 ws13">Use <span class="_ _6"></span>Standar<span class="_ _4"></span>ds Wisel<span class="_ _4"></span>y<span class="_ _0"></span>, When The<span class="_ _4"></span>y Add <span class="_ _8"></span><span class="ff5 ws0">Demonstrable<span class="_ _b"> </span><span class="ff1">V<span class="_ _3"></span>alue<span class="_ _d"></span><span class="ff8">.........<span class="_ _8"></span>168</span></span></span></div><div class="t m0 x19 h16 y10e ff1 fs7 fc0 sc0 ls0 ws0">Systems Need Domain-Speciﬁc Languages<span class="_ _5"></span><span class="ff8">.....................................<span class="_ _8"></span>168</span></div><div class="t m0 x19 h16 y10f ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>169</span></div><div class="t m0 x19 h16 y110 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>169</span></div><div class="t m0 xd h17 yd0 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 12:<span class="_ _4"></span> Emerg<span class="_ _4"></span>ence<span class="_ _e"> </span><span class="ff8 fs7">..................................................................<span class="_ _8"></span>171</span></div><div class="t m0 x19 h16 yd1 ff1 fs7 fc0 sc0 ls0 ws0">Getting Clean via Emerg<span class="_ _4"></span>ent Design<span class="_ _e"> </span><span class="ff8">................................................<span class="_ _8"></span>171</span></div><div class="t m0 x19 h16 yd2 ff1 fs7 fc0 sc0 ls0 ws0">Simple Design Rule 1:<span class="_ _4"></span> Runs <span class="_ _0"></span>All the <span class="_ _1"></span>T<span class="_ _0"></span>ests<span class="_ _6"></span><span class="ff8">........................................<span class="_ _8"></span>172</span></div><div class="t m0 x19 h16 yd3 ff1 fs7 fc0 sc0 ls0 ws0">Simple Design Rules 2–4:<span class="_ _4"></span> Refactoring<span class="_ _e"> </span><span class="ff8">............................................<span class="_ _8"></span>172</span></div><div class="t m0 x19 h16 yd4 ff1 fs7 fc0 sc0 ls0 ws0">No Duplication<span class="_ _6"></span><span class="ff8">...................................................................................173</span></div><div class="t m0 x19 h16 yd5 ff1 fs7 fc0 sc0 ls0 ws0">Expr<span class="_ _4"></span>essiv<span class="_ _4"></span>e<span class="ff8">...........................................................................................<span class="_ _8"></span>175</span></div><div class="t m0 x19 h16 yd6 ff1 fs7 fc0 sc0 ls0 ws0">Minimal Classes and Methods<span class="_ _b"> </span><span class="ff8">.........................................................<span class="_ _8"></span>176</span></div><div class="t m0 x19 h16 yd7 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>176</span></div><div class="t m0 x19 h16 yd8 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>176</span></div><div class="t m0 xd h17 y111 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 13:<span class="_ _4"></span> Concurr<span class="_ _4"></span>ency<span class="_ _a"> </span><span class="ff8 fs7">..............................................................<span class="_ _8"></span>177</span></div><div class="t m0 x19 h16 y112 ff1 fs7 fc0 sc0 ls0 ws0">Wh<span class="_ _1"></span>y Concurrency?<span class="_ _b"> </span><span class="ff8">...........................................................................<span class="_ _8"></span>178</span></div><div class="t m0 x1a h16 y113 ff8 fs7 fc0 sc0 ls0 ws0">Myths and Misconceptions.............................................................<span class="_ _8"></span>179</div><a class="l" href="#pfa7" data-dest-detail='[167,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:582.728010px;width:345.740000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa9" data-dest-detail='[169,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.452000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfab" data-dest-detail='[171,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.419000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfac" data-dest-detail='[172,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.835010px;width:331.460000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb2" data-dest-detail='[178,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:526.725010px;width:345.745000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb4" data-dest-detail='[180,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:512.833010px;width:331.437000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb6" data-dest-detail='[182,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:498.724010px;width:345.781000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb8" data-dest-detail='[184,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:471.945010px;width:360.152000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb9" data-dest-detail='[185,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225600px;bottom:456.728010px;width:345.724400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb9" data-dest-detail='[185,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225600px;bottom:442.728010px;width:345.668400px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfba" data-dest-detail='[186,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:428.835010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfba" data-dest-detail='[186,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:414.835010px;width:331.427000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfbc" data-dest-detail='[188,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:400.834010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfbc" data-dest-detail='[188,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225600px;bottom:386.726010px;width:345.787400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfbf" data-dest-detail='[191,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:372.833010px;width:331.434000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc0" data-dest-detail='[192,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:358.725010px;width:345.781200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc2" data-dest-detail='[194,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:344.725010px;width:345.731200px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc5" data-dest-detail='[197,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:330.724010px;width:345.769200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc5" data-dest-detail='[197,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:316.724010px;width:345.709200px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc6" data-dest-detail='[198,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:302.723010px;width:345.734200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc7" data-dest-detail='[199,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225800px;bottom:288.723010px;width:345.630200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc7" data-dest-detail='[199,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227100px;bottom:274.722010px;width:345.683900px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc8" data-dest-detail='[200,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227100px;bottom:260.722010px;width:345.786900px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc8" data-dest-detail='[200,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.227100px;bottom:246.722010px;width:345.780900px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfca" data-dest-detail='[202,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:219.945010px;width:360.140000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfca" data-dest-detail='[202,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:204.728010px;width:345.704600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcb" data-dest-detail='[203,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:190.727010px;width:345.691600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcb" data-dest-detail='[203,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:176.727010px;width:345.697600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcc" data-dest-detail='[204,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:162.727010px;width:345.775600px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfce" data-dest-detail='[206,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:148.726010px;width:345.788600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcf" data-dest-detail='[207,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:134.726010px;width:345.722600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcf" data-dest-detail='[207,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:120.725010px;width:345.788600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfcf" data-dest-detail='[207,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:106.725010px;width:345.781600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd0" data-dest-detail='[208,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:79.945210px;width:360.133000px;height:15.595800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd1" data-dest-detail='[209,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224500px;bottom:64.728010px;width:345.758500px;height:13.367800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd2" data-dest-detail='[210,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:50.835610px;width:331.435000px;height:13.127700px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe" class="pf w1 h2" data-page-no="e"><div class="pc pce w1 h2"><div class="t m0 x25 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xiii<span class="_ _10"></span><span class="ff1">Contents</span></div><div class="t m0 x19 h16 y7a ff1 fs7 fc0 sc0 ls0 ws0">Challenges<span class="_ _c"> </span><span class="ff8">..........................................................................................180</span></div><div class="t m0 x19 h16 y7b ff1 fs7 fc0 sc0 ls0 ws0">Concurr<span class="_ _4"></span>ency Defense Principles<span class="_ _d"></span><span class="ff8">......................................................<span class="_ _8"></span>180</span></div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Single Responsibility Principle<span class="_ _b"> </span>......................................................181</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">Corollary: Limit the Scope of Data<span class="_ _c"> </span>................................................<span class="_ _8"></span>181</div><div class="t m0 x1a h16 y7e ff8 fs7 fc0 sc0 ls0 ws0">Corollary: Use Copies of Data<span class="_ _b"> </span>.......................................................<span class="_ _8"></span>181</div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">Corollary: <span class="_ _4"></span>Threads Should Be as Independent as P<span class="_ _4"></span>ossible<span class="_ _e"> </span>............<span class="_ _8"></span>182</div><div class="t m0 x19 h16 y80 ff1 fs7 fc0 sc0 ls0 ws19">Kno<span class="_ _1"></span>w Y<span class="_ _3"></span>our <span class="_ _d"> </span>Library<span class="_ _b"> </span><span class="ff8 ws0">...........................................................................<span class="_ _8"></span>182</span></div><div class="t m0 x1a h16 y81 ff8 fs7 fc0 sc0 ls0 ws0">Thread-Safe Collections<span class="_ _d"></span>.................................................................182</div><div class="t m0 x19 h16 y82 ff1 fs7 fc0 sc0 ls0 ws0">Kno<span class="_ _1"></span>w <span class="_ _0"></span>Y<span class="_ _3"></span>our Execution Models<span class="_ _b"> </span><span class="ff8">..........................................................183</span></div><div class="t m0 x1a h16 y83 ff8 fs7 fc0 sc0 ls0 ws0">Producer-Consumer<span class="_ _8"></span>........................................................................<span class="_ _5"></span>184</div><div class="t m0 x1a h16 y84 ff8 fs7 fc0 sc0 ls0 ws0">Readers-Writers<span class="_ _5"></span>..............................................................................<span class="_ _8"></span>184</div><div class="t m0 x1a h16 y85 ff8 fs7 fc0 sc0 ls0 ws0">Dining Philosophers<span class="_ _b"> </span>.......................................................................184</div><div class="t m0 x19 h16 y86 ff1 fs7 fc0 sc0 ls0 ws0">Be<span class="_ _4"></span>war<span class="_ _1"></span>e Dependencies Between Synchr<span class="_ _4"></span>onized Methods<span class="_ _e"> </span><span class="ff8">................185</span></div><div class="t m0 x19 h16 y87 ff1 fs7 fc0 sc0 ls0 ws0">K<span class="_ _4"></span>eep Synchronized Sections Small<span class="_ _6"></span><span class="ff8">..................................................185</span></div><div class="t m0 x19 h16 y88 ff1 fs7 fc0 sc0 ls0 ws0">Writing Corr<span class="_ _4"></span>ect Shut-Do<span class="_ _1"></span>wn Code Is Hard<span class="_ _5"></span><span class="ff8">.....................................<span class="_ _8"></span>186</span></div><div class="t m0 x19 h16 y114 ff1 fs7 fc0 sc0 ls0 ws18">T<span class="_ _0"></span>esting Thr<span class="_ _4"></span>eaded <span class="_ _5"></span>Code <span class="ff8 ws0">.....................................................................186</span></div><div class="t m0 x1a h16 y115 ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _4"></span>reat Spurious F<span class="_ _1"></span>ailures as Candidate <span class="_ _1"></span>Threading Issues<span class="_ _b"> </span>.................<span class="_ _8"></span>187</div><div class="t m0 x1a h16 y116 ff8 fs7 fc0 sc0 ls0 ws0">Get <span class="_ _0"></span>Y<span class="_ _3"></span>our Nonthreaded Code <span class="_ _1"></span>W<span class="_ _0"></span>orking F<span class="_ _4"></span>irst<span class="_ _6"></span>....................................<span class="_ _8"></span>187</div><div class="t m0 x1a h16 y117 ff8 fs7 fc0 sc0 ls8 ws12">Make <span class="_ _2"></span>Y<span class="_ _3"></span>our <span class="_ _1"></span>Threaded Code Pluggable<span class="_ _e"> </span>............................................<span class="_ _8"></span>187</div><div class="t m0 x1a h16 y118 ff8 fs7 fc0 sc0 ls0 ws15">Make <span class="_ _1"></span>Y<span class="_ _3"></span>our Threaded <span class="_ _5"></span>Code T<span class="_ _0"></span>unable<span class="_ _5"></span>................................................<span class="_ _8"></span>187</div><div class="t m0 x1a h16 y119 ff8 fs7 fc0 sc0 ls0 ws0">Run with More <span class="_ _1"></span>Threads <span class="_ _4"></span>Than Processors<span class="_ _8"></span>.......................................<span class="_ _8"></span>188</div><div class="t m0 x1a h16 y11a ff8 fs7 fc0 sc0 ls0 ws0">Run on Dif<span class="_ _4"></span>ferent Platfor<span class="_ _8"></span>ms<span class="_ _c"> </span>............................................................<span class="_ _8"></span>188</div><div class="t m0 x1a h16 y11b ff8 fs7 fc0 sc0 ls0 ws0">Instrument <span class="_ _0"></span>Y<span class="_ _3"></span>our Code to <span class="_ _1"></span>T<span class="_ _4"></span>r<span class="_ _8"></span>y and F<span class="_ _4"></span>orce F<span class="_ _1"></span>ailures<span class="_ _6"></span>............................<span class="_ _8"></span>188</div><div class="t m0 x1a h16 y11c ff8 fs7 fc0 sc0 ls0 ws0">Hand-Coded ...................................................................................189</div><div class="t m0 x1a h16 y11d ff8 fs7 fc0 sc0 ls0 ws0">Automated<span class="_ _b"> </span>......................................................................................189</div><div class="t m0 x19 h16 y11e ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>190</span></div><div class="t m0 x19 h16 y11f ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>191</span></div><div class="t m0 xd h17 y120 ff1 fs9 fc0 sc0 ls0 ws0">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _1"></span>e Reﬁnement<span class="_ _d"></span><span class="ff8 fs7">............................................<span class="_ _8"></span>193</span></div><div class="t m0 x19 h16 y121 ff1 fs7 fc0 sc0 ls0 ws0">Args Implementation<span class="_ _b"> </span><span class="ff8">........................................................................194</span></div><div class="t m0 x1a h16 y122 ff8 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _4"></span>w Did I Do <span class="_ _1"></span>This?<span class="_ _a"> </span>.......................................................................<span class="_ _8"></span>200</div><div class="t m0 x19 h16 y123 ff1 fs7 fc0 sc0 ls0 ws0">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft<span class="_ _b"> </span><span class="ff8">.....................................................................<span class="_ _8"></span>201</span></div><div class="t m0 x1a h16 y124 ff8 fs7 fc0 sc0 ls0 ws0">So I Stopped<span class="_ _b"> </span>...................................................................................<span class="_ _8"></span>212</div><div class="t m0 x1a h16 y125 ff8 fs7 fc0 sc0 ls0 ws0">On Incrementalism<span class="_ _b"> </span>.........................................................................212</div><div class="t m0 x19 h16 y126 ff1 fs7 fc0 sc0 ls0 ws11">String Arguments <span class="ff8 ws0">..............................................................................<span class="_ _8"></span>214</span></div><div class="t m0 x19 h16 y127 ff1 fs7 fc0 sc0 ls0 ws0"> Conclusion<span class="ff8">.........................................................................................<span class="_ _8"></span>250</span></div><a class="l" href="#pfd3" data-dest-detail='[211,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:582.728010px;width:345.787000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd3" data-dest-detail='[211,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:568.728010px;width:345.716000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd4" data-dest-detail='[212,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.448000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd4" data-dest-detail='[212,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.835010px;width:331.455000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd4" data-dest-detail='[212,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:526.834010px;width:331.445000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd5" data-dest-detail='[213,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:512.834010px;width:331.466000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd5" data-dest-detail='[213,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:498.726010px;width:345.758000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd5" data-dest-detail='[213,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:484.833010px;width:331.444000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd6" data-dest-detail='[214,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:470.725010px;width:345.725000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd7" data-dest-detail='[215,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:456.831010px;width:331.435000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd7" data-dest-detail='[215,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:442.830010px;width:331.441000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd7" data-dest-detail='[215,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:428.828010px;width:331.431000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd8" data-dest-detail='[216,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:414.720010px;width:345.643000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd8" data-dest-detail='[216,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:400.719010px;width:345.708000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd9" data-dest-detail='[217,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223700px;bottom:386.719010px;width:345.684300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd9" data-dest-detail='[217,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223700px;bottom:372.718010px;width:345.745300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfda" data-dest-detail='[218,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:358.826010px;width:331.474000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfda" data-dest-detail='[218,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:344.826010px;width:331.456000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfda" data-dest-detail='[218,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:330.825010px;width:331.415000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfda" data-dest-detail='[218,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:316.825010px;width:331.446000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdb" data-dest-detail='[219,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:302.824010px;width:331.452000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdb" data-dest-detail='[219,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:288.824010px;width:331.447000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdb" data-dest-detail='[219,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:274.823010px;width:331.466000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdc" data-dest-detail='[220,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:260.823010px;width:331.420000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdc" data-dest-detail='[220,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.624000px;bottom:246.823010px;width:331.425000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfdd" data-dest-detail='[221,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223700px;bottom:232.714010px;width:345.787300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfde" data-dest-detail='[222,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223700px;bottom:218.714010px;width:345.781300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe0" data-dest-detail='[224,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:191.945010px;width:360.097000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe1" data-dest-detail='[225,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224600px;bottom:176.728010px;width:345.751400px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe7" data-dest-detail='[231,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.623000px;bottom:162.834010px;width:331.430000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe8" data-dest-detail='[232,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223500px;bottom:148.726010px;width:345.746500px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff3" data-dest-detail='[243,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.623000px;bottom:134.834010px;width:331.423000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff3" data-dest-detail='[243,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.623000px;bottom:120.833010px;width:331.438000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff5" data-dest-detail='[245,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.223500px;bottom:106.725010px;width:345.764500px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf119" data-dest-detail='[281,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:96.223500px;bottom:92.723110px;width:342.784500px;height:13.367900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff" class="pf w1 h2" data-page-no="f"><div class="pc pcf w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xi<span class="_ _4"></span>v<span class="_ _13"> </span><span class="ff1">Contents</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Chapter 15:<span class="_ _4"></span> JUnit Internals<span class="_ _d"></span><span class="ff8 fs7">..........................................................<span class="_ _8"></span>251</span></div><div class="t m0 x19 h16 y128 ff1 fs7 fc0 sc0 ls0 ws0">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>w<span class="_ _4"></span>ork<span class="_ _8"></span><span class="ff8">.......................................................................<span class="_ _8"></span>252</span></div><div class="t m0 x19 h16 y129 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>265</span></div><div class="t m0 xd h17 y12a ff1 fs9 fc0 sc0 ls0 ws0">Chapter 16:<span class="_ _4"></span> Refactoring </div><div class="t m3 x26 h1a y12a ffc fsa fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x27 h16 y12a ff8 fs7 fc0 sc0 ls0 ws0">.........................................<span class="_ _8"></span>267</div><div class="t m0 x19 h16 y12b ff1 fs7 fc0 sc0 ls0 ws0">First,<span class="_ _4"></span> Make It <span class="_ _0"></span>W<span class="_ _2"></span>ork<span class="_ _5"></span><span class="ff8">...........................................................................<span class="_ _8"></span>268</span></div><div class="t m0 x19 h16 y12c ff1 fs7 fc0 sc0 ls0 ws0">Then Make It Right<span class="ff8">...........................................................................<span class="_ _8"></span>270</span></div><div class="t m0 x19 h16 y12d ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>284</span></div><div class="t m0 x19 h16 y12e ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>284</span></div><div class="t m0 xd h17 y12f ff1 fs9 fc0 sc0 ls0 ws0">Chapter 17:<span class="_ _4"></span> Smells and Heuristics<span class="_ _a"> </span><span class="ff8 fs7">.............................................<span class="_ _8"></span>285</span></div><div class="t m0 x19 h16 y130 ff1 fs7 fc0 sc0 ls0 ws0">Comments<span class="_ _b"> </span><span class="ff8">..........................................................................................<span class="_ _8"></span>286</span></div><div class="t m0 x1a h16 y131 ff8 fs7 fc0 sc0 ls0 ws0">C1: <span class="ffa">Inappr<span class="_ _1"></span>opriate Information<span class="_ _6"></span><span class="ff8">.......................................................286</span></span></div><div class="t m0 x1a h16 y132 ff8 fs7 fc0 sc0 ls0 ws0">C2: <span class="ffa">Obsolete Comment</span>...................................................................<span class="_ _8"></span>286</div><div class="t m0 x1a h16 y133 ff8 fs7 fc0 sc0 ls0 ws0">C3: <span class="ffa">Redundant Comment<span class="_ _a"> </span></span>...............................................................<span class="_ _8"></span>286</div><div class="t m0 x1a h16 y134 ff8 fs7 fc0 sc0 ls0 ws0">C4: <span class="ffa ws18">P<span class="_ _0"></span>oor<span class="_ _4"></span>ly Written <span class="_ _5"></span>Comment<span class="_ _8"></span><span class="ff8 ws0">..........................................................<span class="_ _8"></span>287</span></span></div><div class="t m0 x1a h16 y135 ff8 fs7 fc0 sc0 ls0 ws0">C5: <span class="ffa">Commented-Out Code<span class="_ _b"> </span></span>.............................................................<span class="_ _8"></span>287</div><div class="t m0 x19 h16 y136 ff1 fs7 fc0 sc0 ls0 ws0">En<span class="_ _1"></span>vironment<span class="_ _b"> </span><span class="ff8">......................................................................................<span class="_ _8"></span>287</span></div><div class="t m0 x1a h16 y137 ff8 fs7 fc0 sc0 ls0 ws0">E1: <span class="ffa">Build Requir<span class="_ _4"></span>es Mor<span class="_ _4"></span>e <span class="_ _1"></span>Than One Step<span class="ff8">........................................<span class="_ _8"></span>287</span></span></div><div class="t m0 x1a h16 y138 ff8 fs7 fc0 sc0 ls0 ws0">E2:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>ests Require Mor<span class="_ _1"></span>e <span class="_ _1"></span>Than One Step<span class="_ _b"> </span><span class="ff8">..........................................287</span></span></div><div class="t m0 x19 h16 y139 ff1 fs7 fc0 sc0 ls0 ws0">Functions<span class="_ _6"></span><span class="ff8">............................................................................................288</span></div><div class="t m0 x1a h16 y13a ff8 fs7 fc0 sc0 ls0 ws0">F1:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>oo Many <span class="_ _1"></span>Arguments<span class="_ _6"></span><span class="ff8">................................................................288</span></span></div><div class="t m0 x1a h16 y13b ff8 fs7 fc0 sc0 ls0 ws0">F2: <span class="ffa ws18">Output Ar<span class="_ _4"></span>guments<span class="_ _a"> </span><span class="ff8 ws0">....................................................................<span class="_ _8"></span>288</span></span></div><div class="t m0 x1a h16 y13c ff8 fs7 fc0 sc0 ls0 ws0">F3: <span class="ffa ws18">Fla<span class="_ _4"></span>g Arguments<span class="_ _c"> </span><span class="ff8 ws0">........................................................................<span class="_ _8"></span>288</span></span></div><div class="t m0 x1a h16 y13d ff8 fs7 fc0 sc0 ls0 ws0">F4: <span class="ffa">Dead Function<span class="_ _a"> </span></span>.........................................................................<span class="_ _8"></span>288</div><div class="t m0 x19 h16 y13e ff1 fs7 fc0 sc0 ls0 ws0">General<span class="_ _d"></span><span class="ff8">...............................................................................................288</span></div><div class="t m0 x1a h16 y13f ff8 fs7 fc0 sc0 ls0 ws0">G1: <span class="ffa">Multiple Langua<span class="_ _4"></span>ges in One Sour<span class="_ _4"></span>ce F<span class="_ _4"></span>ile<span class="_ _6"></span><span class="ff8">..................................<span class="_ _8"></span>288</span></span></div><div class="t m0 x1a h16 y140 ff8 fs7 fc0 sc0 ls0 ws0">G2: <span class="ffa">Obvious Behavior Is Unimplemented<span class="_ _8"></span></span>......................................<span class="_ _8"></span>288</div><div class="t m0 x1a h16 y141 ff8 fs7 fc0 sc0 ls0 ws0">G3: <span class="ffa">Incorr<span class="_ _4"></span>ect Behavior at the Boundaries<span class="_ _d"> </span><span class="ff8">.....................................<span class="_ _8"></span>289</span></span></div><div class="t m0 x1a h16 y142 ff8 fs7 fc0 sc0 ls0 ws0">G4: <span class="ffa">Overridden Saf<span class="_ _4"></span>eties<span class="_ _b"> </span><span class="ff8">.................................................................289</span></span></div><div class="t m0 x1a h16 y143 ff8 fs7 fc0 sc0 ls0 ws0">G5: <span class="ffa">Duplication<span class="_ _5"></span></span>..............................................................................<span class="_ _5"></span>289</div><div class="t m0 x1a h16 y144 ff8 fs7 fc0 sc0 ls0 ws0">G6: <span class="ffa">Code at <span class="_ _1"></span>Wr<span class="_ _1"></span>ong Level of <span class="_ _1"></span>Abstr<span class="_ _1"></span>action<span class="_ _d"></span><span class="ff8">........................................<span class="_ _8"></span>290</span></span></div><div class="t m0 x1a h16 y145 ff8 fs7 fc0 sc0 ls0 ws0">G7: <span class="ffa">Base Classes Depending on <span class="_ _1"></span>Their Derivatives<span class="_ _a"> </span><span class="ff8">.......................<span class="_ _8"></span>291</span></span></div><div class="t m0 x1a h16 y146 ff8 fs7 fc0 sc0 ls0 ws0">G8:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>oo Much Information<span class="_ _c"> </span><span class="ff8">.............................................................<span class="_ _5"></span>291</span></span></div><div class="t m0 x1a h16 y147 ff8 fs7 fc0 sc0 ls0 ws0">G9: <span class="ffa">Dead Code<span class="_ _6"></span></span>...............................................................................292</div><div class="t m0 x1a h16 y148 ff8 fs7 fc0 sc0 ls0 ws0">G10:<span class="_ _b"> </span><span class="ffa">V<span class="_ _3"></span>ertical Separ<span class="_ _4"></span>ation <span class="ff8">................................................................292</span></span></div><div class="t m0 x1a h16 y149 ff8 fs7 fc0 sc0 ls0 ws0">G11: <span class="ffa">Inconsistency<span class="_ _c"> </span></span>.........................................................................<span class="_ _8"></span>292</div><div class="t m0 x1a h16 y14a ff8 fs7 fc0 sc0 ls0 ws0">G12: <span class="ffa">Clutter</span>....................................................................................<span class="_ _8"></span>293</div><a class="l" href="#pf11a" data-dest-detail='[282,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:360.125000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11b" data-dest-detail='[283,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:565.728010px;width:345.750000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf128" data-dest-detail='[296,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:551.727010px;width:345.787000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12a" data-dest-detail='[298,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:524.594010px;width:360.092000px;height:15.947000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12b" data-dest-detail='[299,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:509.728010px;width:345.758600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12d" data-dest-detail='[301,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:495.727010px;width:345.758600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13b" data-dest-detail='[315,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:481.727010px;width:345.788600px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13b" data-dest-detail='[315,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.224400px;bottom:467.727010px;width:345.781600px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13c" data-dest-detail='[316,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:440.945010px;width:360.099000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13d" data-dest-detail='[317,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:425.728010px;width:345.788700px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13d" data-dest-detail='[317,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.627000px;bottom:411.835010px;width:331.320000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13d" data-dest-detail='[317,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.628000px;bottom:397.835010px;width:331.343000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13d" data-dest-detail='[317,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:383.835010px;width:331.337000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13e" data-dest-detail='[318,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.632000px;bottom:369.834010px;width:331.324000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13e" data-dest-detail='[318,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.632000px;bottom:355.834010px;width:331.332000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13e" data-dest-detail='[318,"XYZ",-48,518,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.232700px;bottom:341.725010px;width:345.779300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13e" data-dest-detail='[318,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:327.833010px;width:331.290000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13e" data-dest-detail='[318,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:313.832010px;width:331.294000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.233900px;bottom:299.724010px;width:345.791100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:285.832010px;width:331.336000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,607,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:271.831010px;width:331.345000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,575,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:257.831010px;width:331.354000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,543,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.635000px;bottom:243.830010px;width:331.356000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,518,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.238700px;bottom:229.722010px;width:345.796300px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.639000px;bottom:215.829010px;width:331.278000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13f" data-dest-detail='[319,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.639000px;bottom:201.829010px;width:331.286000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf140" data-dest-detail='[320,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.640000px;bottom:187.829010px;width:331.284000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf140" data-dest-detail='[320,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.640000px;bottom:173.828010px;width:331.338000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf140" data-dest-detail='[320,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.640000px;bottom:159.828010px;width:331.364000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf141" data-dest-detail='[321,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.641000px;bottom:145.827010px;width:331.290000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf142" data-dest-detail='[322,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.641000px;bottom:131.827010px;width:331.256000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf142" data-dest-detail='[322,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.642000px;bottom:117.827010px;width:331.331000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf143" data-dest-detail='[323,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.642000px;bottom:103.826010px;width:331.365000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf143" data-dest-detail='[323,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.642000px;bottom:89.825710px;width:331.335000px;height:13.127300px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf143" data-dest-detail='[323,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.642000px;bottom:75.825210px;width:331.355000px;height:13.127800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf144" data-dest-detail='[324,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.643000px;bottom:61.823710px;width:331.377000px;height:13.127800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10" class="pf w1 h2" data-page-no="10"><div class="pc pc10 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xv<span class="_ _10"></span><span class="ff1">Contents</span></div><div class="t m0 x1a h16 y7a ff8 fs7 fc0 sc0 ls0 ws0">G13:<span class="_ _e"> </span><span class="ffa">Artiﬁcial Coupling<span class="_ _d"></span></span>.................................................................<span class="_ _8"></span>293</div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws0">G14: <span class="ffa">F<span class="_ _0"></span>eatur<span class="_ _4"></span>e En<span class="_ _4"></span>vy<span class="_ _6"></span><span class="ff8">..........................................................................<span class="_ _8"></span>293</span></span></div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">G15: <span class="ffa ws18">Selector Ar<span class="_ _4"></span>guments<span class="_ _6"></span><span class="ff8 ws0">................................................................294</span></span></div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">G16: <span class="ffa">Obscur<span class="_ _4"></span>ed Intent<span class="_ _b"> </span><span class="ff8">.....................................................................295</span></span></div><div class="t m0 x1a h16 y7e ff8 fs7 fc0 sc0 ls0 ws0">G17: <span class="ffa">Misplaced Responsibility</span>.......................................................<span class="_ _8"></span>295</div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">G18: <span class="ffa">Inappr<span class="_ _1"></span>opriate Static<span class="ff8">...............................................................<span class="_ _8"></span>296</span></span></div><div class="t m0 x1a h16 y80 ff8 fs7 fc0 sc0 ls0 ws0">G19: <span class="ffa">Use Explanatory <span class="_ _0"></span>V<span class="_ _3"></span>ariab<span class="_ _4"></span>les<span class="_ _e"> </span><span class="ff8">....................................................<span class="_ _8"></span>296</span></span></div><div class="t m0 x1a h16 y81 ff8 fs7 fc0 sc0 ls0 ws0">G20: <span class="ffa">Function Names Should Say <span class="_ _1"></span>What <span class="_ _1"></span>They Do<span class="_ _d"> </span><span class="ff8">..........................<span class="_ _8"></span>297</span></span></div><div class="t m0 x1a h16 y82 ff8 fs7 fc0 sc0 ls0 ws0">G21: <span class="ffa">Understand the <span class="_ _0"></span>Algorithm<span class="_ _b"> </span><span class="ff8">.....................................................<span class="_ _8"></span>297</span></span></div><div class="t m0 x1a h16 y83 ff8 fs7 fc0 sc0 ls0 ws0">G22: <span class="ffa">Make Lo<span class="_ _4"></span>gical Dependencies Physical<span class="_ _8"></span><span class="ff8">...................................<span class="_ _8"></span>298</span></span></div><div class="t m0 x1a h16 y84 ff8 fs7 fc0 sc0 ls0 ws0">G23: <span class="ffa">Pr<span class="_ _4"></span>ef<span class="_ _4"></span>er P<span class="_ _0"></span>olymorphism to If/Else or Switch/Case<span class="_ _c"> </span><span class="ff8">....................<span class="_ _8"></span>299</span></span></div><div class="t m0 x1a h16 y85 ff8 fs7 fc0 sc0 ls0 ws0">G24: <span class="ffa">F<span class="_ _2"></span>ollow Standar<span class="_ _1"></span>d Con<span class="_ _4"></span>ventions<span class="_ _5"></span><span class="ff8">................................................<span class="_ _8"></span>299</span></span></div><div class="t m0 x1a h16 y86 ff8 fs7 fc0 sc0 ls0 ws0">G25: <span class="ffa">Replace Ma<span class="_ _4"></span>gic Numbers with Named Constants<span class="_ _b"> </span><span class="ff8">..................<span class="_ _8"></span>300</span></span></div><div class="t m0 x1a h16 y87 ff8 fs7 fc0 sc0 ls0 ws0">G26: <span class="ffa">Be Pr<span class="_ _4"></span>ecise<span class="_ _6"></span><span class="ff8">..............................................................................301</span></span></div><div class="t m0 x1a h16 y88 ff8 fs7 fc0 sc0 ls0 ws0">G27: <span class="ffa">Structur<span class="_ _4"></span>e o<span class="_ _4"></span>ver Con<span class="_ _4"></span>vention<span class="_ _6"></span><span class="ff8">.....................................................<span class="_ _8"></span>301</span></span></div><div class="t m0 x1a h16 y114 ff8 fs7 fc0 sc0 ls0 ws0">G28: <span class="ffa">Encapsulate Conditionals<span class="_ _a"> </span></span>.....................................................<span class="_ _8"></span>301</div><div class="t m0 x1a h16 y115 ff8 fs7 fc0 sc0 ls0 ws0">G29:<span class="_ _e"> </span><span class="ffa">A<span class="_ _1"></span>void Ne<span class="_ _4"></span>gative Conditionals<span class="_ _b"> </span><span class="ff8">.................................................<span class="_ _8"></span>302</span></span></div><div class="t m0 x1a h16 y116 ff8 fs7 fc0 sc0 ls0 ws0">G30: <span class="ffa">Functions Should Do One <span class="_ _1"></span>Thing<span class="_ _c"> </span><span class="ff8">...........................................<span class="_ _8"></span>302</span></span></div><div class="t m0 x1a h16 y117 ff8 fs7 fc0 sc0 ls0 ws0">G31: <span class="ffa ws18">Hidden T<span class="_ _0"></span>empor<span class="_ _1"></span>al <span class="_ _6"></span>Couplings<span class="_ _6"></span><span class="ff8 ws0">..................................................<span class="_ _8"></span>302</span></span></div><div class="t m0 x1a h16 y118 ff8 fs7 fc0 sc0 ls0 ws0">G32: <span class="ffa">Don’<span class="_ _0"></span>t Be <span class="_ _1"></span>Arbitr<span class="_ _1"></span>ary<span class="_ _c"> </span><span class="ff8">.................................................................<span class="_ _8"></span>303</span></span></div><div class="t m0 x1a h16 y119 ff8 fs7 fc0 sc0 ls0 ws0">G33: <span class="ffa">Encapsulate Boundary Conditions<span class="_ _5"></span></span>........................................<span class="_ _8"></span>304</div><div class="t m0 x1a h16 y11a ff8 fs7 fc0 sc0 ls0 ws0">G34: <span class="ffa">Functions Should Descend Only </span></div><div class="t m0 x1a h16 y11b ffa fs7 fc0 sc0 ls0 ws0">One Level of <span class="_ _0"></span>Abstr<span class="_ _4"></span>action<span class="_ _b"> </span><span class="ff8">................................................................<span class="_ _8"></span>304</span></div><div class="t m0 x1a h16 y11c ff8 fs7 fc0 sc0 ls0 ws0">G35: <span class="ffa">K<span class="_ _4"></span>eep Conﬁgur<span class="_ _1"></span>ab<span class="_ _4"></span>le Data at High Levels<span class="_ _5"></span><span class="ff8">................................<span class="_ _8"></span>306</span></span></div><div class="t m0 x1a h16 y11d ff8 fs7 fc0 sc0 ls0 ws0">G36:<span class="_ _e"> </span><span class="ffa ws18">A<span class="_ _1"></span>void T<span class="_ _1"></span>r<span class="_ _4"></span>ansitive <span class="_ _5"></span>Navigation<span class="_ _8"></span><span class="ff8 ws0">...................................................<span class="_ _8"></span>306</span></span></div><div class="t m0 x19 h16 y11e ff1 fs7 fc0 sc0 lsa ws0">Ja<span class="_ _4"></span>va<span class="_ _c"> </span><span class="ff8 ls0">.....................................................................................................<span class="_ _8"></span>307</span></div><div class="t m0 x1a h16 y11f ff8 fs7 fc0 sc0 ls0 ws0">J1:<span class="_ _e"> </span><span class="ffa">A<span class="_ _1"></span>void Long Import Lists by Using <span class="_ _1"></span>W<span class="_ _1"></span>ildcar<span class="_ _4"></span>ds<span class="ff8">............................307</span></span></div><div class="t m0 x1a h16 y14b ff8 fs7 fc0 sc0 ls0 ws0">J2: <span class="ffa">Don’<span class="_ _0"></span>t Inherit Constants<span class="_ _e"> </span><span class="ff8">............................................................<span class="_ _8"></span>307</span></span></div><div class="t m0 x1a h16 y14c ff8 fs7 fc0 sc0 ls0 ws0">J3: <span class="ffa">Constants versus Enums<span class="_ _c"> </span></span>...........................................................<span class="_ _8"></span>308</div><div class="t m0 x19 h16 y14d ff1 fs7 fc0 sc0 ls0 ws0">Names<span class="_ _b"> </span><span class="ff8">.................................................................................................309</span></div><div class="t m0 x1a h16 y14e ff8 fs7 fc0 sc0 ls0 ws0">N1: <span class="ffa">Choose Descriptive Names</span>......................................................<span class="_ _8"></span>309</div><div class="t m0 x1a h16 y14f ff8 fs7 fc0 sc0 ls0 ws0">N2: <span class="ffa">Choose Names at the <span class="_ _1"></span>Appr<span class="_ _1"></span>opriate Level of <span class="_ _1"></span>Abstr<span class="_ _1"></span>action<span class="_ _d"></span><span class="ff8">..........<span class="_ _8"></span>311</span></span></div><div class="t m0 x1a h16 y150 ff8 fs7 fc0 sc0 ls0 ws0">N3: <span class="ffa">Use Standar<span class="_ _4"></span>d Nomenc<span class="_ _4"></span>latur<span class="_ _4"></span>e <span class="_ _1"></span>Where P<span class="_ _2"></span>ossible<span class="ff8">...........................311</span></span></div><div class="t m0 x1a h16 y151 ff8 fs7 fc0 sc0 ls0 ws0">N4: <span class="ffa">Unambiguous Names</span>...............................................................<span class="_ _8"></span>312</div><div class="t m0 x1a h16 y152 ff8 fs7 fc0 sc0 ls0 ws0">N5: <span class="ffa">Use Long Names f<span class="_ _4"></span>or Long Scopes<span class="_ _8"></span><span class="ff8">...........................................<span class="_ _8"></span>312</span></span></div><div class="t m0 x1a h16 y153 ff8 fs7 fc0 sc0 ls0 ws0">N6:<span class="_ _e"> </span><span class="ffa">A</span></div><div class="t m0 x28 h16 y154 ffa fs7 fc0 sc0 ls0 ws0">void Encodings<span class="_ _b"> </span><span class="ff8">......................................................................312</span></div><div class="t m0 x1a h16 y155 ff8 fs7 fc0 sc0 ls0 ws0">N7: <span class="ffa">Names Should Describe Side-Eff<span class="_ _4"></span>ects. <span class="ff8">.....................................313</span></span></div><a class="l" href="#pf144" data-dest-detail='[324,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:582.836010px;width:331.338000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf144" data-dest-detail='[324,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.356000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf145" data-dest-detail='[325,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.337000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf146" data-dest-detail='[326,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:540.835010px;width:331.347000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf146" data-dest-detail='[326,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:526.833010px;width:331.320000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf147" data-dest-detail='[327,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.628000px;bottom:512.833010px;width:331.335000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf147" data-dest-detail='[327,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:498.832010px;width:331.314000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf148" data-dest-detail='[328,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.630000px;bottom:484.832010px;width:331.263000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf148" data-dest-detail='[328,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.631000px;bottom:470.832010px;width:331.316000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf149" data-dest-detail='[329,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.632000px;bottom:456.830010px;width:331.280000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14a" data-dest-detail='[330,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.632000px;bottom:442.830010px;width:331.253000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14a" data-dest-detail='[330,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:428.828010px;width:331.305000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14b" data-dest-detail='[331,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.635000px;bottom:414.828010px;width:331.246000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14c" data-dest-detail='[332,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.635000px;bottom:400.827010px;width:331.364000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14c" data-dest-detail='[332,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.635000px;bottom:386.827010px;width:331.314000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14c" data-dest-detail='[332,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:372.826010px;width:331.314000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14d" data-dest-detail='[333,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.632000px;bottom:358.826010px;width:331.307000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14d" data-dest-detail='[333,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:344.826010px;width:331.294000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14d" data-dest-detail='[333,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:330.825010px;width:331.309000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14e" data-dest-detail='[334,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:316.825010px;width:331.338000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14f" data-dest-detail='[335,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:302.824010px;width:331.290000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14f" data-dest-detail='[335,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:274.823010px;width:331.335000px;height:27.129000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf151" data-dest-detail='[337,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:260.823010px;width:331.274000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf151" data-dest-detail='[337,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:246.822010px;width:331.310000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf152" data-dest-detail='[338,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.234000px;bottom:232.713010px;width:345.809000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf152" data-dest-detail='[338,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:218.821010px;width:331.266000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf152" data-dest-detail='[338,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:204.820010px;width:331.328000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf153" data-dest-detail='[339,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:190.820010px;width:331.326000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf154" data-dest-detail='[340,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.232900px;bottom:176.711010px;width:345.800100px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf154" data-dest-detail='[340,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.633000px;bottom:162.819010px;width:331.316000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf156" data-dest-detail='[342,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:148.819010px;width:331.231000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf156" data-dest-detail='[342,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:134.818010px;width:331.264000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf157" data-dest-detail='[343,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:120.818010px;width:331.335000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf157" data-dest-detail='[343,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.634000px;bottom:106.816010px;width:331.295000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf157" data-dest-detail='[343,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.630000px;bottom:92.822110px;width:331.349000px;height:13.127900px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.631000px;bottom:78.821710px;width:331.284000px;height:13.127800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11" class="pf w1 h2" data-page-no="11"><div class="pc pc11 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xvi<span class="_ _14"> </span><span class="ff1">Contents</span></div><div class="t m0 x19 h16 y7a ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>ests<span class="_ _b"> </span><span class="ff8">....................................................................................................313</span></div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws0">T1: <span class="ffa ws18">Insufﬁcient T<span class="_ _2"></span>ests<span class="_ _c"> </span><span class="ff8 ws0">.......................................................................<span class="_ _8"></span>313</span></span></div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">T2: <span class="ffa">Use a Co<span class="_ _4"></span>ver<span class="_ _4"></span>a<span class="_ _4"></span>ge <span class="_ _1"></span>T<span class="_ _0"></span>ool!<span class="_ _6"></span><span class="ff8">...............................................................<span class="_ _8"></span>313</span></span></div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">T3: <span class="ffa ws18">Don’<span class="_ _0"></span>t <span class="_ _5"></span>Skip T<span class="_ _4"></span>rivial T<span class="_ _0"></span>ests <span class="ff8 ws0">............................................................<span class="_ _8"></span>313</span></span></div><div class="t m0 x1a h16 y7e ff8 fs7 fc0 sc0 ls0 ws0">T4:<span class="_ _e"> </span><span class="ffa">An Ignor<span class="_ _1"></span>ed <span class="_ _1"></span>T<span class="_ _0"></span>est Is a Question about an <span class="_ _0"></span>Ambiguity<span class="_ _d"> </span><span class="ff8">..................<span class="_ _8"></span>313</span></span></div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">T5:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>est Boundary Conditions<span class="_ _d"> </span><span class="ff8">........................................................<span class="_ _8"></span>314</span></span></div><div class="t m0 x1a h16 y80 ff8 fs7 fc0 sc0 ls0 ws0">T6: <span class="ffa">Exhaustively <span class="_ _0"></span>T<span class="_ _0"></span>est Near Bugs<span class="_ _6"></span><span class="ff8">....................................................<span class="_ _8"></span>314</span></span></div><div class="t m0 x1a h16 y81 ff8 fs7 fc0 sc0 ls0 ws0">T7: <span class="ffa">P<span class="_ _0"></span>atterns of F<span class="_ _0"></span>ailur<span class="_ _4"></span>e <span class="_ _1"></span>Ar<span class="_ _4"></span>e Revealing<span class="_ _c"> </span><span class="ff8">............................................<span class="_ _8"></span>314</span></span></div><div class="t m0 x1a h16 y82 ff8 fs7 fc0 sc0 ls0 ws0">T8:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>est Cover<span class="_ _1"></span>ag<span class="_ _4"></span>e P<span class="_ _0"></span>atterns Can Be Revealing<span class="_ _c"> </span><span class="ff8">...............................<span class="_ _8"></span>314</span></span></div><div class="t m0 x1a h16 y83 ff8 fs7 fc0 sc0 ls0 ws0">T9:<span class="_ _e"> </span><span class="ffa">T<span class="_ _2"></span>ests Should Be F<span class="_ _1"></span>ast<span class="ff8">.................................................................<span class="_ _8"></span>314</span></span></div><div class="t m0 x19 h16 y84 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>314</span></div><div class="t m0 x19 h16 y85 ff1 fs7 fc0 sc0 ls0 ws0">Biblio<span class="_ _4"></span>graph<span class="_ _1"></span>y<span class="_ _8"></span><span class="ff8">.......................................................................................<span class="_ _8"></span>315</span></div><div class="t m0 xd h17 y156 ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _4"></span>ppendix <span class="_ _0"></span>A:<span class="_ _1"></span> Concurrency II<span class="ff8 fs7">.........................................................<span class="_ _8"></span>317</span></div><div class="t m0 x19 h16 y157 ff1 fs7 fc0 sc0 ls0 ws0">Client/Serv<span class="_ _4"></span>er Example<span class="_ _6"></span><span class="ff8">......................................................................<span class="_ _8"></span>317</span></div><div class="t m0 x1a h16 y158 ff8 fs7 fc0 sc0 ls0 ws0">The Server<span class="_ _b"> </span>......................................................................................<span class="_ _8"></span>317</div><div class="t m0 x1a h16 y159 ff8 fs7 fc0 sc0 ls0 ws15">Adding Threading<span class="_ _8"></span>...........................................................................<span class="_ _8"></span>319</div><div class="t m0 x1a h16 y15a ff8 fs7 fc0 sc0 ls0 ws0">Server Obser<span class="_ _8"></span>v<span class="_ _4"></span>ations<span class="_ _a"> </span>.......................................................................<span class="_ _8"></span>319</div><div class="t m0 x1a h16 y15b ff8 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="_ _8"></span>......................................................................................<span class="_ _8"></span>321</div><div class="t m0 x19 h16 y15c ff1 fs7 fc0 sc0 ls0 ws0">P<span class="_ _1"></span>ossible P<span class="_ _1"></span>aths of Execution<span class="_ _e"> </span><span class="ff8">..............................................................<span class="_ _8"></span>321</span></div><div class="t m0 x1a h16 y15d ff8 fs7 fc0 sc0 ls0 ws0">Number of Paths<span class="_ _6"></span>.............................................................................322</div><div class="t m0 x1a h16 y15e ff8 fs7 fc0 sc0 ls0 ws0">Digging Deeper<span class="_ _b"> </span>..............................................................................<span class="_ _8"></span>323</div><div class="t m0 x1a h16 y15f ff8 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="_ _8"></span>......................................................................................<span class="_ _8"></span>326</div><div class="t m0 x19 h16 y160 ff1 fs7 fc0 sc0 ls0 ws19">Kno<span class="_ _1"></span>wing Y<span class="_ _3"></span>our <span class="_ _d"> </span>Library<span class="_ _6"></span><span class="ff8 ws0">......................................................................<span class="_ _8"></span>326</span></div><div class="t m0 x1a h16 y161 ff8 fs7 fc0 sc0 ls0 ws0">Ex<span class="_ _4"></span>ecutor Frame<span class="_ _4"></span>w<span class="_ _1"></span>ork ......................................................................<span class="_ _8"></span>326</div><div class="t m0 x1a h16 y162 ff8 fs7 fc0 sc0 ls0 ws0">Nonblocking Solutions<span class="_ _6"></span>...................................................................<span class="_ _8"></span>327</div><div class="t m0 x1a h16 y163 ff8 fs7 fc0 sc0 ls0 ws0">Nonthread-Safe Classes..................................................................<span class="_ _8"></span>328</div><div class="t m0 x19 h11 y164 ff1 fs7 fc0 sc0 ls0 ws0">Dependencies Betw<span class="_ _4"></span>een Methods </div><div class="t m0 x19 h16 y165 ff1 fs7 fc0 sc0 ls0 ws0">Can Br<span class="_ _4"></span>eak Concurr<span class="_ _4"></span>ent Code <span class="ff8">...........................................................<span class="_ _8"></span>329</span></div><div class="t m0 x1a h16 y166 ff8 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>olerate the F<span class="_ _1"></span>ailure<span class="_ _d"></span>.........................................................................<span class="_ _8"></span>330</div><div class="t m0 x1a h16 y167 ff8 fs7 fc0 sc0 ls0 ws0">Client-Based Locking<span class="_ _8"></span>.....................................................................<span class="_ _8"></span>330</div><div class="t m0 x1a h16 y168 ff8 fs7 fc0 sc0 ls0 ws0">Server-Based Locking<span class="_ _c"> </span>....................................................................<span class="_ _8"></span>332</div><div class="t m0 x19 h16 y169 ff1 fs7 fc0 sc0 ls0 ws18">Incr<span class="_ _4"></span>easing Thr<span class="_ _4"></span>oughput <span class="ff8 ws0">.....................................................................<span class="_ _8"></span>333</span></div><div class="t m0 x1a h16 y16a ff8 fs7 fc0 sc0 ls0 ws0">Single-Thread Calculation of <span class="_ _1"></span>Throughput<span class="_ _8"></span>......................................<span class="_ _8"></span>334</div><div class="t m0 x1a h16 y16b ff8 fs7 fc0 sc0 ls0 ws0">Multithread Calculation of <span class="_ _1"></span>Throughput<span class="_ _8"></span>..........................................<span class="_ _8"></span>335</div><div class="t m0 x19 h16 y16c ff1 fs7 fc0 sc0 ls0 ws0">Deadlock<span class="_ _5"></span><span class="ff8">.............................................................................................<span class="_ _8"></span>335</span></div><div class="t m0 x1a h16 y16d ff8 fs7 fc0 sc0 ls0 ws0">Mutual Exclusion<span class="_ _e"> </span>...........................................................................<span class="_ _8"></span>336</div><div class="t m0 x1a h16 y16e ff8 fs7 fc0 sc0 ls0 ws0">Lock &amp; <span class="_ _4"></span>W<span class="_ _0"></span>ait<span class="_ _e"> </span>...................................................................................337</div><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:582.728010px;width:345.802000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,607,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.345000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,575,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.331000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.626000px;bottom:540.835010px;width:331.325000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf158" data-dest-detail='[344,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.628000px;bottom:526.833010px;width:331.243000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:512.833010px;width:331.316000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:498.832010px;width:331.308000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,607,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:484.832010px;width:331.293000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,518,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.630000px;bottom:470.832010px;width:331.267000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.629000px;bottom:456.830010px;width:331.333000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf159" data-dest-detail='[345,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.228800px;bottom:442.722010px;width:345.782200px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15a" data-dest-detail='[346,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.228800px;bottom:428.720010px;width:345.776200px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15c" data-dest-detail='[348,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:401.945010px;width:360.118000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15c" data-dest-detail='[348,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:386.728010px;width:345.742700px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15c" data-dest-detail='[348,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:372.834010px;width:331.428000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15e" data-dest-detail='[350,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:358.833010px;width:331.418000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15e" data-dest-detail='[350,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:344.831010px;width:331.439000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf160" data-dest-detail='[352,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:330.830010px;width:331.416000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf160" data-dest-detail='[352,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:316.721010px;width:345.729700px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf161" data-dest-detail='[353,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:302.829010px;width:331.427000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf162" data-dest-detail='[354,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:288.829010px;width:331.427000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf165" data-dest-detail='[357,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:274.828010px;width:331.416000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf165" data-dest-detail='[357,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:260.720010px;width:345.742700px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf165" data-dest-detail='[357,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:246.827010px;width:331.427000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf166" data-dest-detail='[358,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:232.827010px;width:331.416000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf167" data-dest-detail='[359,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:218.826010px;width:331.438000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf168" data-dest-detail='[360,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:190.717010px;width:345.723700px;height:27.369000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf169" data-dest-detail='[361,"XYZ",-48,486,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:176.825010px;width:331.441000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf169" data-dest-detail='[361,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:162.825010px;width:331.427000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16b" data-dest-detail='[363,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:148.824010px;width:331.427000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16c" data-dest-detail='[364,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:134.716010px;width:345.740700px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16d" data-dest-detail='[365,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:120.823010px;width:331.451000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16e" data-dest-detail='[366,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:106.823010px;width:331.451000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16e" data-dest-detail='[366,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225300px;bottom:92.713410px;width:345.789700px;height:13.367600px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16f" data-dest-detail='[367,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:78.821010px;width:331.428000px;height:13.127800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf170" data-dest-detail='[368,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:64.820610px;width:331.416000px;height:13.127700px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12" class="pf w1 h2" data-page-no="12"><div class="pc pc12 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xvii<span class="_ _10"></span><span class="ff1">Contents</span></div><div class="t m0 x1a h16 y7a ff8 fs7 fc0 sc0 ls0 ws0">No Preemption................................................................................<span class="_ _8"></span>337</div><div class="t m0 x1a h16 y7b ff8 fs7 fc0 sc0 ls0 ws17">Circular W<span class="_ _0"></span>ait ..................................................................................<span class="_ _8"></span>337</div><div class="t m0 x1a h16 y7c ff8 fs7 fc0 sc0 ls0 ws0">Breaking Mutual Exclusion<span class="_ _8"></span>............................................................<span class="_ _8"></span>337</div><div class="t m0 x1a h16 y7d ff8 fs7 fc0 sc0 ls0 ws0">Breaking Lock &amp; <span class="_ _4"></span>W<span class="_ _0"></span>ait<span class="_ _8"></span>....................................................................<span class="_ _8"></span>338</div><div class="t m0 x1a h16 y7e ff8 fs7 fc0 sc0 ls0 ws0">Breaking Preemption<span class="_ _6"></span>......................................................................338</div><div class="t m0 x1a h16 y7f ff8 fs7 fc0 sc0 ls0 ws0">Breaking Circular <span class="_ _4"></span>W<span class="_ _0"></span>ait<span class="_ _6"></span>...................................................................<span class="_ _8"></span>338</div><div class="t m0 x19 h16 y80 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>esting Multithr<span class="_ _4"></span>eaded Code<span class="_ _5"></span><span class="ff8">.............................................................<span class="_ _8"></span>339</span></div><div class="t m0 x19 h16 y81 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>ool Support f<span class="_ _4"></span>or <span class="_ _1"></span>T<span class="_ _0"></span>esting <span class="_ _1"></span>Thr<span class="_ _4"></span>ead-Based Code <span class="ff8">................................342</span></div><div class="t m0 x19 h16 y82 ff1 fs7 fc0 sc0 ls0 ws0">Conclusion<span class="ff8">..........................................................................................<span class="_ _8"></span>342</span></div><div class="t m0 x19 h16 y83 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>utorial:<span class="_ _4"></span> Full Code Examples<span class="_ _b"> </span><span class="ff8">..........................................................343</span></div><div class="t m0 x1a h16 y84 ff8 fs7 fc0 sc0 ls0 ws0">Client/Server Nonthreaded<span class="_ _d"></span>.............................................................343</div><div class="t m0 x1a h16 y85 ff8 fs7 fc0 sc0 ls0 ws0">Client/Server Using <span class="_ _1"></span>Threads<span class="_ _e"> </span>..........................................................<span class="_ _8"></span>346</div><div class="t m0 xd h17 y156 ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _4"></span>ppendix B:<span class="_ _4"></span> org.jfr<span class="_ _1"></span>ee<span class="_ _8"></span>.date<span class="_ _8"></span>.SerialDate<span class="_ _b"> </span><span class="ff8 fs7">......................................<span class="_ _8"></span>349</span></div><div class="t m0 xd h17 y16f ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _4"></span>ppendix C:<span class="_ _4"></span> Cr<span class="_ _4"></span>oss Refer<span class="_ _4"></span>ences of Heuristics<span class="ff8 fs7">...........................<span class="_ _8"></span>409</span></div><div class="t m0 xd h17 y170 ff1 fs9 fc0 sc0 ls0 ws0">Epilogue<span class="_ _6"></span><span class="ff8 fs7">................................................................................................<span class="_ _8"></span>411</span></div><div class="t m0 xd h17 y171 ff1 fs9 fc0 sc0 ls0 ws0">Inde<span class="_ _4"></span>x<span class="_ _b"> </span><span class="ff8 fs7">......................................................................................................<span class="_ _8"></span>413</span></div><a class="l" href="#pf170" data-dest-detail='[368,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:582.836010px;width:331.430000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf170" data-dest-detail='[368,"XYZ",-48,607,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:568.836010px;width:331.435000px;height:13.127000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf170" data-dest-detail='[368,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:554.835010px;width:331.438000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf171" data-dest-detail='[369,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:540.835010px;width:331.439000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf171" data-dest-detail='[369,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:526.834010px;width:331.437000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf171" data-dest-detail='[369,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:512.834010px;width:331.446000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf172" data-dest-detail='[370,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:498.726010px;width:345.731000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf175" data-dest-detail='[373,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:484.725010px;width:345.673000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf175" data-dest-detail='[373,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:470.725010px;width:345.787000px;height:13.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf176" data-dest-detail='[374,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:93.225000px;bottom:456.723010px;width:345.725000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf176" data-dest-detail='[374,"XYZ",-48,639,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:442.831010px;width:331.446000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf179" data-dest-detail='[377,"XYZ",-48,454,1]'><div class="d m1" style="border-style:none;position:absolute;left:107.625000px;bottom:428.830010px;width:331.447000px;height:13.128000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf17c" data-dest-detail='[380,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:401.945010px;width:360.086000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1b8" data-dest-detail='[440,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:373.945010px;width:360.064000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1ba" data-dest-detail='[442,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:345.945010px;width:360.199000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1bc" data-dest-detail='[444,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:317.945010px;width:360.211000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13" class="pf w1 h2" data-page-no="13"><div class="pc pc13 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14" class="pf w1 h2" data-page-no="14"><div class="pc pc14 w1 h2"><img class="bi xd y5b w5 h13" alt="" src="bg14.png"/><div class="t m0 x25 h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">xix</div><div class="t m0 x2a h9 y172 ff1 fs4 fc0 sc0 lsb ws0">F<span class="_ _0"></span>o<span class="_ _6"></span>rewo<span class="_ _6"></span>r<span class="_ _5"></span>d</div><div class="t m0 xd h14 y173 ff8 fs3 fc0 sc0 ls0 ws1a">One of our fa<span class="_ _4"></span>vorite candies here in Denmark is Ga-Jol, whose strong licorice v<span class="_ _4"></span>apors are a</div><div class="t m0 xd h14 y174 ff8 fs3 fc0 sc0 ls0 ws1b">perfect complement to our damp and often chilly w<span class="_ _1"></span>eather<span class="_ _4"></span>. Part of the char<span class="_ _8"></span>m of Ga-Jol to</div><div class="t m0 xd h14 y175 ff8 fs3 fc0 sc0 ls0 ws1c">us Danes is the wise or witty sa<span class="_ _4"></span>yings printed on the ﬂap of ev<span class="_ _4"></span>er<span class="_ _8"></span>y box top. I bought a tw<span class="_ _1"></span>o-</div><div class="t m0 xd h14 y176 ff8 fs3 fc0 sc0 ls0 ws0">pack of the delicacy this morning and found that it bore this old Danish sa<span class="_ _4"></span>w:</div><div class="t m0 x2b h14 y177 ffa fs3 fc0 sc0 ls0 ws0">Ær<span class="_ _4"></span>lighed i små ting er ikke nog<span class="_ _4"></span>en lille ting<span class="ff8">.</span></div><div class="t m0 xd h14 y178 ff8 fs3 fc0 sc0 ls0 ws1d">“Honesty in small things is not a small thing.<span class="_ _1"></span>” It was a good omen consistent with w<span class="_ _4"></span>hat I</div><div class="t m0 xd h14 y179 ff8 fs3 fc0 sc0 ls0 ws1e">already wanted to sa<span class="_ _1"></span>y here. Small things matter<span class="_ _4"></span>. <span class="_ _4"></span>This is a book about humble concerns</div><div class="t m0 xd h14 y17a ff8 fs3 fc0 sc0 ls0 ws0">whose v<span class="_ _4"></span>alue is nonetheless far from small.</div><div class="t m0 x2b h14 y17b ffa fs3 fc0 sc0 ls0 ws1f">God is in the details<span class="ff8">, said the architect Ludwig mies v<span class="_ _4"></span>an der Rohe. <span class="_ _4"></span>This quote recalls</span></div><div class="t m0 xd h14 y17c ff8 fs3 fc0 sc0 ls0 ws20">contemporary arguments about the role of architecture in software de<span class="_ _4"></span>velopment, and par<span class="_ _4"></span>-</div><div class="t m0 xd h14 y17d ff8 fs3 fc0 sc0 lsc ws21">ticularly in the <span class="_ _0"></span>Agile world. Bob and I occasionall<span class="_ _4"></span>y ﬁnd ourselves passionatel<span class="_ _4"></span>y engaged in</div><div class="t m0 xd h14 y17e ff8 fs3 fc0 sc0 ls0 ws22">this dialogue. <span class="_ _0"></span>And yes, mies van der Rohe w<span class="_ _1"></span>as attentive to utility and to the timeless forms</div><div class="t m0 xd h14 y17f ff8 fs3 fc0 sc0 lsd ws23">of building that underlie great architecture. On the other hand<span class="_ _4"></span>, he also personally selected</div><div class="t m0 xd h14 y180 ff8 fs3 fc0 sc0 ls0 ws0">e<span class="_ _4"></span>very doorknob for every house he designed. <span class="_ _4"></span>Why? Because small things matter<span class="_ _1"></span>.</div><div class="t m0 x2b h14 y181 ff8 fs3 fc0 sc0 ls0 ws24">In our ongoing “debate” on <span class="_ _1"></span>TDD<span class="_ _4"></span>, Bob and I ha<span class="_ _4"></span>ve disco<span class="_ _4"></span>vered that w<span class="_ _1"></span>e ag<span class="_ _8"></span>ree that soft-</div><div class="t m0 xd h14 y182 ff8 fs3 fc0 sc0 ls0 ws25">w<span class="_ _4"></span>are architecture has an impor<span class="_ _8"></span>tant place in dev<span class="_ _4"></span>elopment, though we lik<span class="_ _4"></span>ely ha<span class="_ _4"></span>ve dif<span class="_ _4"></span>ferent</div><div class="t m0 xd h14 y183 ff8 fs3 fc0 sc0 ls0 ws26">visions of exactl<span class="_ _4"></span>y what that means. Such quibb<span class="_ _4"></span>les are relativ<span class="_ _4"></span>ely unimportant, ho<span class="_ _4"></span>we<span class="_ _1"></span>ver<span class="_ _4"></span>,</div><div class="t m0 xd h14 y184 ff8 fs3 fc0 sc0 ls0 ws27">because w<span class="_ _4"></span>e can accept for g<span class="_ _8"></span>ranted that responsible professionals gi<span class="_ _4"></span>ve <span class="ffa ws0">some </span>time to think-</div><div class="t m0 xd h14 y185 ff8 fs3 fc0 sc0 ls0 ws28">ing and planning at the outset of a project. <span class="_ _1"></span>The late-1990s notions of design driven <span class="ffa ws0">onl<span class="_ _4"></span>y <span class="ff8 lse">by</span></span></div><div class="t m0 xd h14 y186 ff8 fs3 fc0 sc0 ls0 ws29">the tests and the code are long gone. <span class="_ _0"></span>Y<span class="_ _2"></span>et attenti<span class="_ _4"></span>veness to detail is an e<span class="_ _4"></span>ven more critical</div><div class="t m0 xd h14 y187 ff8 fs3 fc0 sc0 ls0 ws2a">foundation of professionalism than is any grand vision. First, it is through practice in the</div><div class="t m0 xd h14 y188 ff8 fs3 fc0 sc0 lsc ws2b">small that professionals gain proﬁciency and trust for practice in the large. Second<span class="_ _1"></span>, the</div><div class="t m0 xd h14 y189 ff8 fs3 fc0 sc0 ls0 ws2c">smallest bit of slopp<span class="_ _4"></span>y constr<span class="_ _8"></span>uction, of the door that does not close tightly or the slightl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y18a ff8 fs3 fc0 sc0 ls0 ws2d">crooked tile on the ﬂoor<span class="_ _1"></span>, or even the messy desk, completel<span class="_ _4"></span>y dispels the charm of the</div><div class="t m0 xd h14 y18b ff8 fs3 fc0 sc0 ls0 ws0">larger w<span class="_ _4"></span>hole. <span class="_ _4"></span>That is what clean code is about.</div><div class="t m0 x2b h14 y18c ff8 fs3 fc0 sc0 ls0 ws0">Still, architecture is just one metaphor for software de<span class="_ _1"></span>velopment, and in par<span class="_ _8"></span>ticular for</div><div class="t m0 xd h14 y18d ff8 fs3 fc0 sc0 ls0 ws2e">that part of software that deli<span class="_ _4"></span>vers the initial <span class="ffa ws0">pr<span class="_ _1"></span>oduct<span class="_ _15"> </span><span class="ff8 ws2e">in the same sense that an architect</span></span></div><div class="t m0 xd h14 y18e ff8 fs3 fc0 sc0 lsd ws2f">deliv<span class="_ _4"></span>ers a pristine building. In these da<span class="_ _4"></span>ys of Scr<span class="_ _8"></span>um and <span class="_ _4"></span>Agile, the focus is on quickl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y18f ff8 fs3 fc0 sc0 ls0 ws0">bringing <span class="ffa">pr<span class="_ _1"></span>oduct <span class="ff8 ws30">to market. <span class="_ _4"></span>W<span class="_ _0"></span>e want the factory r<span class="_ _8"></span>unning at top speed to produce software.</span></span></div><div class="t m0 xd h14 y190 ff8 fs3 fc0 sc0 ls0 ws31">These are human factories: thinking, feeling coders who are w<span class="_ _1"></span>orking from a product back-</div><div class="t m0 xd h14 y191 ff8 fs3 fc0 sc0 ls0 ws32">lo<span class="_ _4"></span>g or user stor<span class="_ _8"></span>y to create <span class="ffa ws0">pr<span class="_ _4"></span>oduct<span class="ff8 ws32">. <span class="_ _4"></span>The manufacturing metaphor looms ev<span class="_ _4"></span>er strong in such</span></span></div><div class="t m0 xd h14 y192 ff8 fs3 fc0 sc0 ls0 ws33">thinking. <span class="_ _1"></span>The production aspects of Japanese auto manuf<span class="_ _8"></span>acturing, of an assembl<span class="_ _4"></span>y-line</div><div class="t m0 xd h14 y193 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>orld<span class="_ _1"></span>, inspire much of Scr<span class="_ _8"></span>um.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:292.437000px;bottom:527.328010px;width:146.177000px;height:40.104000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15" class="pf w1 h2" data-page-no="15"><div class="pc pc15 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xx<span class="_ _13"> </span><span class="ff1 lsf">F<span class="_ _4"></span>o<span class="_ _8"></span>rewo<span class="_ _8"></span>r<span class="_ _8"></span>d</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 lsd ws34">Y<span class="_ _3"></span>et even in the auto industry<span class="_ _0"></span>, the bulk of the w<span class="_ _4"></span>ork lies not in manuf<span class="_ _8"></span>acturing but in</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws35">maintenance—or its a<span class="_ _4"></span>voidance. In softw<span class="_ _4"></span>are, 80% or more of what w<span class="_ _4"></span>e do is quaintl<span class="_ _4"></span>y called</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws36">“maintenance”: the act of repair<span class="_ _1"></span>. Rather than embracing the typical W<span class="_ _0"></span>estern focus on <span class="ffa ws0">pr<span class="_ _4"></span>o-</span></div><div class="t m0 xd h14 y197 ffa fs3 fc0 sc0 ls0 ws0">ducing<span class="_ _16"> </span><span class="ff8 lsd ws37">good softw<span class="_ _4"></span>are, we should be thinking more lik<span class="_ _4"></span>e home repair<span class="_ _8"></span>men in the building</span></div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws38">industry<span class="_ _1"></span>, or auto mechanics in the automotiv<span class="_ _4"></span>e ﬁeld. What does Japanese management ha<span class="_ _1"></span>ve</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">to sa<span class="_ _4"></span>y about <span class="ffa">that</span>?</div><div class="t m0 x2b h14 y19a ff8 fs3 fc0 sc0 ls0 ws39">In about 1951, a quality approach called <span class="_ _1"></span>T<span class="_ _1"></span>otal Productive Maintenance (TPM) came</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws3a">on the Japanese scene. Its focus is on maintenance rather than on production. One of the</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws3b">major pillars of <span class="_ _1"></span>TPM is the set of so-called 5S principles. 5S is a set of disciplines—and</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">here I use the term “discipline” instr<span class="_ _8"></span>uctiv<span class="_ _4"></span>ely<span class="_ _0"></span>. <span class="_ _4"></span>These 5S principles are in fact at the founda-</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 lsd ws3c">tions of Lean—another buzzw<span class="_ _4"></span>ord on the <span class="_ _4"></span>W<span class="_ _0"></span>ester<span class="_ _8"></span>n scene, and an increasingly prominent</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 lsd ws3d">buzzw<span class="_ _4"></span>ord in software circles. <span class="_ _1"></span>These principles are not an option. <span class="_ _1"></span>As Uncle Bob relates in</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws1d">his front matter<span class="_ _4"></span>, good software practice requires such discipline: focus, presence of mind<span class="_ _0"></span>,</div><div class="t m0 xd h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws3e">and thinking. It is not al<span class="_ _4"></span>wa<span class="_ _1"></span>ys just about doing, about pushing the f<span class="_ _8"></span>actor<span class="_ _8"></span>y equipment to pro-</div><div class="t m0 xd h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws0">duce at the optimal velocity<span class="_ _0"></span>. <span class="_ _1"></span>The 5S philosophy comprises these concepts:</div><div class="t m0 x2c h1b y1a3 ff1 fs2 fc0 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ffa fs3">Seiri<span class="ff8 lsc ws3f">, or organization (think “sort” in English). Kno<span class="_ _4"></span>wing where things are—using </span></span></div><div class="t m0 x2b h14 y1a4 ff8 fs3 fc0 sc0 ls0 ws0">approaches such as suitable naming—is crucial. <span class="_ _0"></span>Y<span class="_ _2"></span>ou think naming identiﬁers isn’<span class="_ _1"></span>t </div><div class="t m0 x2b h14 y1a5 ff8 fs3 fc0 sc0 ls0 ws0">important? Read on in the following chapters.</div><div class="t m0 x2c h1b y1a6 ff1 fs2 fc0 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ffa fs3">Seiton<span class="ff8">, or tidiness (think “systematize” in English). <span class="_ _1"></span>There is an old <span class="_ _4"></span>American saying: </span></span></div><div class="t m0 x2b h14 y1a7 ffa fs3 fc0 sc0 ls0 ws0">A place for e<span class="_ _4"></span>verything, and everything in its place<span class="ff8">. <span class="_ _1"></span>A piece of code should be where </span></div><div class="t m0 x2b h14 y1a8 ff8 fs3 fc0 sc0 ls0 ws0">you e<span class="_ _4"></span>xpect to ﬁnd it—and<span class="_ _1"></span>, if not, you should re-factor to get it there.</div><div class="t m0 x2c h1b y1a9 ff1 fs2 fc0 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ffa fs3">Seiso<span class="ff8">, or cleaning (think “shine” in English): Keep the w<span class="_ _1"></span>orkplace free of hanging </span></span></div><div class="t m0 x2b h14 y1aa ff8 fs3 fc0 sc0 ls0 ws0">wires, grease, scraps, and waste. <span class="_ _4"></span>What do the authors here sa<span class="_ _4"></span>y about littering your </div><div class="t m0 x2b h14 y1ab ff8 fs3 fc0 sc0 ls0 ws40">code with comments and commented-out code lines that capture history or wishes for </div><div class="t m0 x2b h14 y1ac ff8 fs3 fc0 sc0 ls0 ws0">the future? Get rid of them.</div><div class="t m0 x2c h1b y1ad ff1 fs2 fc0 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ffa fs3">Seiketsu<span class="ff8 ws41">, or standardization: <span class="_ _1"></span>The g<span class="_ _8"></span>roup ag<span class="_ _8"></span>rees about ho<span class="_ _4"></span>w to keep the w<span class="_ _4"></span>orkplace clean. </span></span></div><div class="t m0 x2b h14 y1ae ff8 fs3 fc0 sc0 ls0 ws42">Do you think this book sa<span class="_ _1"></span>ys anything about ha<span class="_ _4"></span>ving a consistent coding style and set of </div><div class="t m0 x2b h14 y1af ff8 fs3 fc0 sc0 ls0 ws0">practices within the group? Where do those standards come from? Read on.</div><div class="t m0 x2c h1b y1b0 ff1 fs2 fc0 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ffa fs3">Shutsuke<span class="ff8 ws43">, or discipline (</span>self<span class="ff8 ws43">-discipline). <span class="_ _1"></span>This means having the discipline to follo<span class="_ _1"></span>w the </span></span></div><div class="t m0 x2b h14 y1b1 ff8 fs3 fc0 sc0 ls0 ws0">practices and to frequentl<span class="_ _4"></span>y reﬂect on one’<span class="_ _2"></span>s work and be willing to change.</div><div class="t m0 x2b h14 y1b2 ff8 fs3 fc0 sc0 ls0 ws44">If you tak<span class="_ _4"></span>e up the challenge—yes, the challenge—of reading and appl<span class="_ _4"></span>ying this book,</div><div class="t m0 xd h14 y1b3 ff8 fs3 fc0 sc0 ls0 ws45">you’<span class="_ _1"></span>ll come to understand and appreciate the last point. Here, we are ﬁnall<span class="_ _4"></span>y dri<span class="_ _4"></span>ving to the</div><div class="t m0 xd h14 y1b4 ff8 fs3 fc0 sc0 ls0 ws46">roots of responsible professionalism in a profession that should be concerned with the life</div><div class="t m0 xd h14 y1b5 ff8 fs3 fc0 sc0 ls0 ws47">cycle of a product. <span class="_ _1"></span>As w<span class="_ _4"></span>e maintain automobiles and other machines under <span class="_ _4"></span>TPM, break-</div><div class="t m0 xd h14 y1b6 ff8 fs3 fc0 sc0 lsd ws48">do<span class="_ _4"></span>wn maintenance—waiting for bugs to surface—is the e<span class="_ _4"></span>xception. Instead<span class="_ _4"></span>, w<span class="_ _4"></span>e go up a</div><div class="t m0 xd h14 y1b7 ff8 fs3 fc0 sc0 ls0 ws49">lev<span class="_ _4"></span>el: inspect the machines ev<span class="_ _4"></span>er<span class="_ _8"></span>y da<span class="_ _4"></span>y and ﬁx wearing parts before they break, or do the</div><div class="t m0 xd h14 y1b8 ff8 fs3 fc0 sc0 ls0 ws4a">equiv<span class="_ _1"></span>alent of the prov<span class="_ _4"></span>erbial 10,000-mile oil change to forestall w<span class="_ _4"></span>ear and tear<span class="_ _4"></span>. In code,</div><div class="t m0 xd h14 y1b9 ff8 fs3 fc0 sc0 ls0 ws4b">refactor mercilessly<span class="_ _0"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can impro<span class="_ _1"></span>ve yet one le<span class="_ _4"></span>vel further<span class="_ _4"></span>, as the <span class="_ _4"></span>TPM mo<span class="_ _4"></span>vement inno-</div><div class="t m0 xd h14 y1ba ff8 fs3 fc0 sc0 lsd ws4c">vated o<span class="_ _1"></span>ver 50 y<span class="_ _4"></span>ears ago: build machines that are more maintainable in the ﬁrst place. Mak-</div><div class="t m0 xd h14 y1bb ff8 fs3 fc0 sc0 ls0 ws4d">ing your code readab<span class="_ _4"></span>le is as important as making it executab<span class="_ _4"></span>le. <span class="_ _4"></span>The ultimate practice,</div><div class="t m0 xd h14 y1bc ff8 fs3 fc0 sc0 ls0 ws4e">introduced in <span class="_ _1"></span>TPM circles around 1960, is to focus on introducing entire new machines or</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16" class="pf w1 h2" data-page-no="16"><div class="pc pc16 w1 h2"><div class="t m0 x25 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xxi<span class="_ _10"></span><span class="ff1 lsf">F<span class="_ _4"></span>o<span class="_ _8"></span>rewo<span class="_ _8"></span>r<span class="_ _8"></span>d</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws4f">replacing old ones. <span class="_ _1"></span>As Fred Brooks admonishes us, w<span class="_ _4"></span>e should probabl<span class="_ _4"></span>y re-do major soft-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws39">ware chunks from scratch e<span class="_ _1"></span>ver<span class="_ _8"></span>y sev<span class="_ _4"></span>en years or so to s<span class="_ _4"></span>weep a<span class="_ _1"></span>wa<span class="_ _1"></span>y creeping cr<span class="_ _8"></span>uft. Perhaps</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws2b">w<span class="_ _4"></span>e should update Brooks’<span class="_ _1"></span> time constant to an order of w<span class="_ _4"></span>eeks, days or hours instead of</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">years. <span class="_ _1"></span>That’<span class="_ _2"></span>s where detail lies.</div><div class="t m0 x2b h14 y1bd ff8 fs3 fc0 sc0 ls0 ws50">There is great pow<span class="_ _1"></span>er in detail, yet there is something humble and profound about this</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws51">approach to life, as w<span class="_ _4"></span>e might stereotypically e<span class="_ _4"></span>xpect from any approach that claims Japa-</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws52">nese roots. But this is not only an Eastern outlook on life; English and <span class="_ _1"></span>American folk wis-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws53">dom are full of such admonishments. <span class="_ _1"></span>The Seiton quote from abov<span class="_ _4"></span>e ﬂo<span class="_ _4"></span>wed from the pen of</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws54">an Ohio minister who literall<span class="_ _4"></span>y vie<span class="_ _4"></span>wed neatness “as a remedy for e<span class="_ _4"></span>very degree of evil.<span class="_ _0"></span>”</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws55">Ho<span class="_ _4"></span>w about Seiso? <span class="ffa">Cleanliness is next to godliness</span>. <span class="_ _0"></span>As beautiful as a house is, a messy</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws56">desk robs it of its splendor<span class="_ _1"></span>. How about Shutsuk<span class="_ _4"></span>e in these small matters? <span class="ffa">He who is faithful</span></div><div class="t m0 xd h14 y19f ffa fs3 fc0 sc0 ls0 ws57">in little is faithful in much<span class="ff8">. Ho<span class="_ _1"></span>w about being eager to re-f<span class="_ _8"></span>actor at the responsible time,</span></div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws58">strengthening one’<span class="_ _2"></span>s position for subsequent “big” decisions, rather than putting it off? <span class="_ _0"></span><span class="ffa ws0">A</span></div><div class="t m0 xd h14 y1a1 ffa fs3 fc0 sc0 ls0 ws59">stitch in time saves nine<span class="ff8 ws0">. </span>The earl<span class="_ _4"></span>y bird catc<span class="_ _4"></span>hes the worm. Don’<span class="_ _0"></span>t put off until tomorr<span class="_ _4"></span>ow</div><div class="t m0 xd h14 y1a2 ffa fs3 fc0 sc0 ls0 ws5a">what you can do today<span class="_ _1"></span>. <span class="ff8">(Such w<span class="_ _4"></span>as the original sense of the phrase “the last responsible</span></div><div class="t m0 xd h14 y1bf ff8 fs3 fc0 sc0 ls0 ws5b">moment” in Lean until it fell into the hands of softw<span class="_ _4"></span>are consultants<span class="ffa ws0">.</span>) Ho<span class="_ _4"></span>w about calibrat-</div><div class="t m0 xd h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws5c">ing the place of small, individual ef<span class="_ _1"></span>for<span class="_ _8"></span>ts in a g<span class="_ _8"></span>rand whole? <span class="ffa">Mighty oaks fr<span class="_ _1"></span>om little acorns</span></div><div class="t m0 xd h14 y1c1 ffa fs3 fc0 sc0 ls0 ws0">gr<span class="_ _4"></span>ow<span class="_ _0"></span>. <span class="_ _6"></span><span class="ff8 ws5d">Or ho<span class="_ _4"></span>w about integrating simple preventi<span class="_ _4"></span>ve w<span class="_ _1"></span>ork into everyda<span class="_ _4"></span>y life?<span class="_ _18"> </span><span class="ffa">An ounce of</span></span></div><div class="t m0 xd h14 y1c2 ffa fs3 fc0 sc0 ls0 ws5e">pr<span class="_ _4"></span>evention is worth a pound of cur<span class="_ _1"></span>e. <span class="_ _1"></span>An apple a day keeps the doctor away<span class="_ _1"></span>. <span class="ff8">Clean code</span></div><div class="t m0 xd h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws5f">honors the deep roots of wisdom beneath our broader culture, or our culture as it once was,</div><div class="t m0 xd h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws0">or should be, and <span class="ffa">can</span> be with attenti<span class="_ _4"></span>veness to detail. </div><div class="t m0 x2b h14 y1c5 ff8 fs3 fc0 sc0 ls0 ws60">Even in the grand architectural literature w<span class="_ _4"></span>e ﬁnd sa<span class="_ _4"></span>ws that hark back to these sup-</div><div class="t m0 xd h14 y1c6 ff8 fs3 fc0 sc0 ls0 ws61">posed details. <span class="_ _1"></span>Think of mies van der Rohe’<span class="_ _2"></span>s doorknobs. <span class="_ _1"></span>That’<span class="_ _0"></span>s <span class="ffa ws0">seiri</span>. <span class="_ _1"></span>That’<span class="_ _2"></span>s being attentiv<span class="_ _4"></span>e</div><div class="t m0 xd h14 y1c7 ff8 fs3 fc0 sc0 ls0 ws62">to ev<span class="_ _4"></span>ery variable name. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should name a variab<span class="_ _4"></span>le using the same care with which y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y1c8 ff8 fs3 fc0 sc0 ls0 ws0">name a ﬁrst-born child.</div><div class="t m0 x2b h14 y1c9 ff8 fs3 fc0 sc0 ls0 ws63">As ev<span class="_ _4"></span>ery homeowner kno<span class="_ _1"></span>ws, such care and ongoing reﬁnement never come to an end.</div><div class="t m0 xd h14 y1ca ff8 fs3 fc0 sc0 ls0 ws64">The architect Christopher <span class="_ _1"></span>Alexander—father of patter<span class="_ _8"></span>ns and patter<span class="_ _8"></span>n languages—views</div><div class="t m0 xd h14 y1cb ff8 fs3 fc0 sc0 ls0 ws65">ev<span class="_ _4"></span>ery act of design itself as a small, local act of repair<span class="_ _4"></span>. <span class="_ _4"></span>And he views the craftsmanship of</div><div class="t m0 xd h14 y1cc ff8 fs3 fc0 sc0 ls0 ws66">ﬁne structure to be the sole pur<span class="_ _8"></span>view of the architect; the lar<span class="_ _4"></span>ger for<span class="_ _8"></span>ms can be left to patter<span class="_ _8"></span>ns</div><div class="t m0 xd h14 y1cd ff8 fs3 fc0 sc0 ls0 ws67">and their application by the inhabitants. Design is e<span class="_ _1"></span>ver ongoing not only as w<span class="_ _1"></span>e add a new</div><div class="t m0 xd h14 y1ce ff8 fs3 fc0 sc0 lsd ws68">room to a house, but as w<span class="_ _4"></span>e are attentiv<span class="_ _4"></span>e to repainting, replacing w<span class="_ _4"></span>or<span class="_ _8"></span>n car<span class="_ _8"></span>pets, or upg<span class="_ _8"></span>rad-</div><div class="t m0 xd h14 y1cf ff8 fs3 fc0 sc0 ls0 ws69">ing the kitchen sink. Most arts echo analogous sentiments. In our search for others who</div><div class="t m0 xd h14 y1d0 ff8 fs3 fc0 sc0 ls0 ws6a">ascribe God’<span class="_ _2"></span>s home as being in the details, w<span class="_ _4"></span>e ﬁnd ourselves in the good compan<span class="_ _4"></span>y of the</div><div class="t m0 xd h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws6b">19th century French author Gusta<span class="_ _4"></span>v Flauber<span class="_ _8"></span>t. <span class="_ _4"></span>The French poet P<span class="_ _4"></span>aul <span class="_ _4"></span>V<span class="_ _0"></span>alery advises us that a</div><div class="t m0 xd h14 y1d2 ff8 fs3 fc0 sc0 ls0 ws6c">poem is nev<span class="_ _4"></span>er done and bears continual rew<span class="_ _1"></span>ork, and to stop w<span class="_ _4"></span>orking on it is abandonment.</div><div class="t m0 xd h14 y1d3 ff8 fs3 fc0 sc0 ls0 ws6d">Such preoccupation with detail is common to all endea<span class="_ _4"></span>vors of e<span class="_ _4"></span>xcellence. So maybe there</div><div class="t m0 xd h14 y1d4 ff8 fs3 fc0 sc0 lsd ws6e">is little new here, but in reading this book y<span class="_ _4"></span>ou will be challenged to take up good disci-</div><div class="t m0 xd h14 y1d5 ff8 fs3 fc0 sc0 ls0 ws6f">plines that you long ago surrendered to apathy or a desire for spontaneity and just</div><div class="t m0 xd h14 y1d6 ff8 fs3 fc0 sc0 ls0 ws0">“responding to change.<span class="_ _1"></span>” </div><div class="t m0 x2b h14 y1d7 ff8 fs3 fc0 sc0 ls0 ws70">Unfortunately<span class="_ _0"></span>, we usuall<span class="_ _1"></span>y don’<span class="_ _4"></span>t view such concerns as key cornerstones of the ar<span class="_ _8"></span>t of</div><div class="t m0 xd h14 y1d8 ff8 fs3 fc0 sc0 lsd ws71">programming. <span class="_ _4"></span>W<span class="_ _0"></span>e abandon our code early<span class="_ _0"></span>, not because it is done, but because our value</div><div class="t m0 xd h14 y1d9 ff8 fs3 fc0 sc0 ls0 ws72">system focuses more on outward appearance than on the substance of w<span class="_ _4"></span>hat w<span class="_ _4"></span>e deliv<span class="_ _4"></span>er<span class="_ _4"></span>.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17" class="pf w1 h2" data-page-no="17"><div class="pc pc17 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xxii<span class="_ _19"> </span><span class="ff1 lsf">F<span class="_ _4"></span>o<span class="_ _8"></span>rewo<span class="_ _8"></span>r<span class="_ _8"></span>d</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws73">This inattenti<span class="_ _4"></span>veness costs us in the end: <span class="_ _1"></span><span class="ffa">A bad penny always sho<span class="_ _4"></span>ws up<span class="ff8">. Research, neither in</span></span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws74">industry nor in academia, humbles itself to the lo<span class="_ _4"></span>wly station of k<span class="_ _4"></span>eeping code clean. Back</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 lsc ws75">in m<span class="_ _4"></span>y da<span class="_ _4"></span>ys w<span class="_ _4"></span>orking in the Bell Labs Software Production Research or<span class="_ _4"></span>ganization (<span class="ffa ls0 ws0">Pr<span class="_ _4"></span>oduc-</span></div><div class="t m0 xd h14 y197 ffa fs3 fc0 sc0 ls0 ws0">tion<span class="ff8 ws76">, indeed!) w<span class="_ _4"></span>e had some back-of-the-en<span class="_ _4"></span>velope ﬁndings that suggested that consistent</span></div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 lsd ws6b">indentation style w<span class="_ _4"></span>as one of the most statistically signiﬁcant indicators of lo<span class="_ _4"></span>w bug density<span class="_ _0"></span>.</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws77">W<span class="_ _0"></span>e want it to be that architecture or pro<span class="_ _1"></span>g<span class="_ _8"></span>ramming language or some other high notion</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws26">should be the cause of quality; as people whose supposed professionalism o<span class="_ _1"></span>wes to the</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws78">mastery of tools and lofty design methods, we feel insulted b<span class="_ _4"></span>y the value that those factory-</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws79">ﬂoor machines, the coders, add through the simple consistent application of an indentation</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws7a">style. <span class="_ _1"></span>T<span class="_ _1"></span>o quote my o<span class="_ _1"></span>wn book of 17 years ago, such style distinguishes excellence from</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws7b">mere competence. <span class="_ _1"></span>The Japanese worldvie<span class="_ _4"></span>w understands the crucial value of the e<span class="_ _4"></span>veryday</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws7c">w<span class="_ _4"></span>orker and<span class="_ _1"></span>, more so, of the systems of dev<span class="_ _4"></span>elopment that o<span class="_ _4"></span>we to the simple, e<span class="_ _4"></span>veryda<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws7d">actions of those w<span class="_ _4"></span>orkers. Quality is the result of a million selﬂess acts of care—not just of</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws7e">an<span class="_ _4"></span>y g<span class="_ _8"></span>reat method that descends from the heav<span class="_ _4"></span>ens. <span class="_ _4"></span>That these acts are simple doesn’<span class="_ _1"></span>t mean</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws7f">that they are simplistic, and it hardl<span class="_ _4"></span>y means that they are easy<span class="_ _0"></span>. <span class="_ _4"></span>They are nonetheless the</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws80">fabric of g<span class="_ _8"></span>reatness and<span class="_ _1"></span>, more so, of beauty<span class="_ _1"></span>, in any human endea<span class="_ _1"></span>vor<span class="_ _1"></span>. <span class="_ _4"></span>T<span class="_ _1"></span>o ignore them is not</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">yet to be full<span class="_ _4"></span>y human.</div><div class="t m0 x2b h14 y1c1 ff8 fs3 fc0 sc0 ls0 ws81">Of course, I am still an advocate of thinking at broader scope, and particularly of the</div><div class="t m0 xd h14 y1c2 ff8 fs3 fc0 sc0 ls0 ws82">v<span class="_ _4"></span>alue of architectural approaches rooted in deep domain knowledge and softw<span class="_ _4"></span>are usability<span class="_ _0"></span>.</div><div class="t m0 xd h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws83">The book isn’<span class="_ _1"></span>t about that—or, at least, it isn’<span class="_ _1"></span>t obviousl<span class="_ _4"></span>y about that. <span class="_ _1"></span>This book has a subtler</div><div class="t m0 xd h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws84">message whose profoundness should not be underappreciated. It ﬁts with the current sa<span class="_ _4"></span>w</div><div class="t m0 xd h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws85">of the reall<span class="_ _4"></span>y code-based people like P<span class="_ _4"></span>eter Sommerlad<span class="_ _4"></span>, K<span class="_ _4"></span>evlin Henney and Gio<span class="_ _1"></span>vanni</div><div class="t m0 xd h14 y1e6 ff8 fs3 fc0 sc0 ls0 ws86">Asproni. “The code is the design” and “Simple code” are their mantras. <span class="_ _4"></span>While we must</div><div class="t m0 xd h14 y1e7 ff8 fs3 fc0 sc0 ls0 ws87">take care to remember that the interface is the program, and that its structures hav<span class="_ _4"></span>e much</div><div class="t m0 xd h14 y1e8 ff8 fs3 fc0 sc0 ls0 ws88">to sa<span class="_ _4"></span>y about our program structure, it is cr<span class="_ _8"></span>ucial to continuously adopt the humb<span class="_ _4"></span>le stance</div><div class="t m0 xd h14 y1e9 ff8 fs3 fc0 sc0 ls0 ws89">that the design li<span class="_ _4"></span>ves in the code. <span class="_ _1"></span>And while rew<span class="_ _1"></span>ork in the manufacturing metaphor leads to</div><div class="t m0 xd h14 y1ea ff8 fs3 fc0 sc0 ls0 ws8a">cost, rew<span class="_ _1"></span>ork in design leads to value. <span class="_ _4"></span>W<span class="_ _0"></span>e should vie<span class="_ _4"></span>w our code as the beautiful ar<span class="_ _8"></span>ticulation</div><div class="t m0 xd h14 y1eb ff8 fs3 fc0 sc0 ls0 ws8b">of noble ef<span class="_ _4"></span>forts of design—design as a process, not a static endpoint. It’<span class="_ _2"></span>s in the code that</div><div class="t m0 xd h14 y1ec ff8 fs3 fc0 sc0 ls0 ws8c">the architectural metrics of coupling and cohesion pla<span class="_ _4"></span>y out. If you listen to Larr<span class="_ _8"></span>y Constan-</div><div class="t m0 xd h14 y1ed ff8 fs3 fc0 sc0 ls0 ws8d">tine describe coupling and cohesion, he speaks in terms of code—not lofty abstract con-</div><div class="t m0 xd h14 y1ee ff8 fs3 fc0 sc0 ls0 ws8e">cepts that one might ﬁnd in UML. Richard Gabriel advises us in his essa<span class="_ _4"></span>y<span class="_ _1"></span>, “<span class="_ _0"></span>Abstraction</div><div class="t m0 xd h14 y1ef ff8 fs3 fc0 sc0 ls0 ws0">Descant” that abstraction is e<span class="_ _4"></span>vil. Code is anti-evil, and clean code is perhaps di<span class="_ _4"></span>vine.</div><div class="t m0 x2b h14 y1f0 ff8 fs3 fc0 sc0 ls0 ws8f">Going back to m<span class="_ _4"></span>y little box of Ga-Jol, I think it’<span class="_ _3"></span>s impor<span class="_ _8"></span>tant to note that the Danish</div><div class="t m0 xd h14 y1f1 ff8 fs3 fc0 sc0 lsd ws90">wisdom advises us not just to pa<span class="_ _4"></span>y attention to small things, but also to be <span class="ffa ls0 ws0">honest<span class="_ _a"> </span><span class="ff8 ws91">in small</span></span></div><div class="t m0 xd h14 y1f2 ff8 fs3 fc0 sc0 ls0 ws92">things. <span class="_ _1"></span>This means being honest to the code, honest to our colleagues about the state of our</div><div class="t m0 xd h14 y1f3 ff8 fs3 fc0 sc0 ls0 ws93">code and<span class="_ _1"></span>, most of all, being honest with ourselves about our code. Did w<span class="_ _4"></span>e Do our Best to</div><div class="t m0 xd h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws94">“lea<span class="_ _4"></span>ve the campground cleaner than we found it”? Did w<span class="_ _1"></span>e re-f<span class="_ _8"></span>actor our code before check-</div><div class="t m0 xd h14 y1f5 ff8 fs3 fc0 sc0 lsd ws95">ing in? <span class="_ _1"></span>These are not peripheral concer<span class="_ _8"></span>ns but concer<span class="_ _8"></span>ns that lie squarely in the center of</div><div class="t m0 xd h14 y1f6 ff8 fs3 fc0 sc0 ls0 ws96">Agile values. It is a recommended practice in Scrum that re-factoring be par<span class="_ _8"></span>t of the con-</div><div class="t m0 xd h14 y1f7 ff8 fs3 fc0 sc0 ls0 ws97">cept of “Done.<span class="_ _1"></span>” Neither architecture nor clean code insist on perfection, only on honesty</div><div class="t m0 xd h14 y1f8 ff8 fs3 fc0 sc0 ls0 ws98">and doing the best w<span class="_ _4"></span>e can. <span class="_ _1"></span><span class="ffa">T<span class="_ _1"></span>o err is human; to for<span class="_ _4"></span>give, divine. <span class="ff8">In Scrum, w<span class="_ _4"></span>e make e<span class="_ _4"></span>very-</span></span></div><div class="t m0 xd h14 y1f9 ff8 fs3 fc0 sc0 ls0 ws99">thing visible. <span class="_ _1"></span>W<span class="_ _0"></span>e air our dir<span class="_ _8"></span>ty laundr<span class="_ _8"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>e are honest about the state of our code because</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18" class="pf w1 h2" data-page-no="18"><div class="pc pc18 w1 h2"><div class="t m0 x2d h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xxiii<span class="_ _10"></span><span class="ff1 lsf">F<span class="_ _4"></span>o<span class="_ _8"></span>rewo<span class="_ _8"></span>r<span class="_ _8"></span>d</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws9a">code is nev<span class="_ _4"></span>er perfect. <span class="_ _4"></span>W<span class="_ _0"></span>e become more fully human, more w<span class="_ _4"></span>orthy of the di<span class="_ _4"></span>vine, and closer</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">to that greatness in the details.</div><div class="t m0 x2b h14 y1fa ff8 fs3 fc0 sc0 ls0 ws9b">In our profession, w<span class="_ _4"></span>e desperately need all the help w<span class="_ _1"></span>e can get. If a clean shop ﬂoor</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 lsc ws9c">reduces accidents, and w<span class="_ _4"></span>ell-organized shop tools increase producti<span class="_ _4"></span>vity<span class="_ _1"></span>, then I’m all for</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws9d">them. <span class="_ _1"></span>As for this book, it is the best pragmatic application of Lean principles to software I</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws9e">ha<span class="_ _4"></span>ve e<span class="_ _4"></span>ver seen in print. I expected no less from this practical little group of thinking indi-</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 lsd ws9f">viduals that has been striving to<span class="_ _1"></span>gether for years not only to become better<span class="_ _1"></span>, but also to gift</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 wsa0">their kno<span class="_ _4"></span>wledge to the industry in works such as y<span class="_ _4"></span>ou no<span class="_ _4"></span>w ﬁnd in your hands. It lea<span class="_ _4"></span>ves the</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>orld a little better than I found it before Uncle Bob sent me the manuscript.</div><div class="t m0 x2b h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0">Ha<span class="_ _4"></span>ving completed this ex<span class="_ _4"></span>ercise in lofty insights, I am off to clean m<span class="_ _1"></span>y desk.</div><div class="t m0 xd h1c y1df ff1 fs3 fc0 sc0 ls0 ws0">James O.<span class="_ _4"></span> Coplien</div><div class="t m0 xd h1d y1e0 ffd fs3 fc0 sc0 ls0 ws0">Mørdrup, Denmark</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19" class="pf w1 h2" data-page-no="19"><div class="pc pc19 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a" class="pf w1 h2" data-page-no="1a"><div class="pc pc1a w1 h2"><img class="bi xd y1fd w5 h1e" alt="" src="bg1a.png"/><div class="t m0 x29 h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">xxv</div><div class="t m0 x22 h9 y172 ff1 fs4 fc0 sc0 ls0 ws0">Intr<span class="_ _0"></span>oduction</div><div class="t m0 xd h1d y1fe ffd fs3 fc0 sc0 ls0 wsa1">Which door represents your code? <span class="_ _4"></span>Which door represents your team or your company?</div><div class="t m0 xd h1d y1ff ffd fs3 fc0 sc0 lsc wsa2">Why are we in that room? Is this just a normal code revie<span class="_ _1"></span>w or have we found a stream of</div><div class="t m0 xd h1d y200 ffd fs3 fc0 sc0 ls0 wsa3">horrible problems shortly after going li<span class="_ _4"></span>ve? <span class="_ _1"></span>Are we debugging in a panic, poring ov<span class="_ _4"></span>er code</div><div class="t m0 xd h1d y201 ffd fs3 fc0 sc0 ls0 wsa4">that we thought worked? <span class="_ _1"></span>Are customers leaving in dro<span class="_ _4"></span>ves and managers breathing do<span class="_ _4"></span>wn</div><div class="t m0 x2e h1f y202 ff8 fsb fc0 sc0 ls0 ws0">Reproduced with the kind permission of Thom Hol<span class="_ _1"></span>werda. </div><div class="t m0 x2f h1f y203 ff8 fsb fc0 sc0 ls0 ws0">http://www<span class="_ _1"></span>.osnews.com/story/19266/WTFs_m</div><div class="t m4 x30 h1f y204 ff8 fsb fc0 sc0 ls0 ws0">(c) 2008 F<span class="_ _4"></span>ocus Shift</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:243.467000px;bottom:527.328010px;width:194.945000px;height:40.104000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.osnews.com/story/19266/WTFs_m"><div class="d m1" style="border-style:none;position:absolute;left:189.622000px;bottom:143.366010px;width:149.910000px;height:8.752000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b" class="pf w1 h2" data-page-no="1b"><div class="pc pc1b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xxvi<span class="_ _1a"> </span><span class="ff1">Intr<span class="_ _4"></span>oduction</span></div><div class="t m0 xd h1d y194 ffd fs3 fc0 sc0 ls0 wsa5">our necks? Ho<span class="_ _4"></span>w can we make sure we wind up behind the <span class="ffa ws0">right </span>door when the going gets</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws0">tough? The answer is: <span class="ffa">cr<span class="_ _1"></span>aftsmanship<span class="ffd">.</span></span></div><div class="t m0 x2b h14 y1fa ff8 fs3 fc0 sc0 lsc wsa6">There are tw<span class="_ _4"></span>o parts to lear<span class="_ _8"></span>ning craftsmanship: knowledge and w<span class="_ _1"></span>ork. <span class="_ _0"></span>Y<span class="_ _2"></span>ou must gain</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws40">the kno<span class="_ _4"></span>wledge of principles, patterns, practices, and heuristics that a craftsman knows, and</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 wsa7">you must also grind that kno<span class="_ _4"></span>wledge into your ﬁngers, e<span class="_ _4"></span>yes, and gut b<span class="_ _4"></span>y w<span class="_ _4"></span>orking hard and</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">practicing.</div><div class="t m0 x2b h14 y205 ff8 fs3 fc0 sc0 ls0 wsa8">I can teach you the ph<span class="_ _1"></span>ysics of riding a bicycle. Indeed<span class="_ _1"></span>, the classical mathematics is</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 wsa9">relativ<span class="_ _4"></span>ely straightforw<span class="_ _4"></span>ard. Gra<span class="_ _4"></span>vity<span class="_ _0"></span>, friction, angular momentum, center of mass, and so</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 wsaa">forth, can be demonstrated with less than a page full of equations. Given those formulae I</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 wsab">could pro<span class="_ _4"></span>ve to y<span class="_ _4"></span>ou that bicycle riding is practical and gi<span class="_ _4"></span>ve you all the kno<span class="_ _1"></span>wledge you</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws0">needed to make it w<span class="_ _1"></span>ork. <span class="_ _4"></span>And you’<span class="_ _3"></span>d still f<span class="_ _8"></span>all do<span class="_ _4"></span>wn the ﬁrst time you climbed on that bike.</div><div class="t m0 x2b h14 y209 ff8 fs3 fc0 sc0 ls0 wsac">Coding is no dif<span class="_ _4"></span>ferent. W<span class="_ _0"></span>e could write do<span class="_ _1"></span>wn all the “feel good” principles of clean</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 wsad">code and then trust you to do the w<span class="_ _4"></span>ork (in other w<span class="_ _4"></span>ords, let you fall do<span class="_ _4"></span>wn when y<span class="_ _4"></span>ou get on</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 lsd wsae">the bike), but then w<span class="_ _4"></span>hat kind of teachers w<span class="_ _4"></span>ould that make us, and what kind of student</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ould that make y<span class="_ _4"></span>ou?</div><div class="t m0 x2b h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">No. <span class="_ _1"></span>That’<span class="_ _0"></span>s not the w<span class="_ _4"></span>a<span class="_ _4"></span>y this book is going to w<span class="_ _4"></span>ork.</div><div class="t m0 x2b h14 y1c1 ff8 fs3 fc0 sc0 ls0 wsaf">Learning to write clean code is <span class="ffa">hard w<span class="_ _4"></span>ork<span class="ff8">. It requires more than just the kno<span class="_ _1"></span>wledge of</span></span></div><div class="t m0 xd h14 y1c2 ff8 fs3 fc0 sc0 ls0 ws71">principles and patterns. <span class="_ _1"></span>Y<span class="_ _3"></span>ou must <span class="ffa ws0">sweat<span class="_ _16"> </span></span>o<span class="_ _1"></span>ver it. <span class="_ _0"></span>Y<span class="_ _2"></span>ou must practice it yourself, and w<span class="_ _4"></span>atch</div><div class="t m0 xd h14 y1c3 ff8 fs3 fc0 sc0 ls0 wsb0">yourself fail. <span class="_ _0"></span>Y<span class="_ _3"></span>ou must watch others practice it and fail. <span class="_ _0"></span>Y<span class="_ _2"></span>ou must see them stumble and</div><div class="t m0 xd h14 y1c4 ff8 fs3 fc0 sc0 ls0 wsb1">retrace their steps. <span class="_ _0"></span>Y<span class="_ _2"></span>ou must see them agonize o<span class="_ _1"></span>ver decisions and see the price they pa<span class="_ _4"></span>y for</div><div class="t m0 xd h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws0">making those decisions the wrong w<span class="_ _4"></span>ay<span class="_ _0"></span>. </div><div class="t m0 x2b h14 y1c6 ff8 fs3 fc0 sc0 ls0 wsb2">Be prepared to w<span class="_ _4"></span>ork hard while reading this book. <span class="_ _1"></span>This is not a “feel good” book that</div><div class="t m0 xd h14 y1c7 ff8 fs3 fc0 sc0 ls0 wsb3">you can read on an airplane and ﬁnish before you land. <span class="_ _1"></span>This book will make you w<span class="_ _1"></span>ork, <span class="ffa ws0">and</span></div><div class="t m0 xd h14 y1c8 ffa fs3 fc0 sc0 ls0 wsb4">wor<span class="_ _4"></span>k har<span class="_ _4"></span>d<span class="ff8">. What kind of w<span class="_ _1"></span>ork will you be doing? <span class="_ _0"></span>Y<span class="_ _3"></span>ou’ll be reading code—lots of code.</span></div><div class="t m0 xd h14 y20d ff8 fs3 fc0 sc0 ls0 wsb5">And you will be challenged to think about w<span class="_ _4"></span>hat’<span class="_ _2"></span>s right about that code and what’<span class="_ _3"></span>s wrong</div><div class="t m0 xd h14 y20e ff8 fs3 fc0 sc0 ls0 wsb6">with it. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll be asked to follo<span class="_ _1"></span>w along as we take modules apart and put them back</div><div class="t m0 xd h14 y20f ff8 fs3 fc0 sc0 ls0 ws0">to<span class="_ _4"></span>gether again. <span class="_ _4"></span>This will take time and effort; but w<span class="_ _4"></span>e think it will be w<span class="_ _4"></span>or<span class="_ _8"></span>th it.</div><div class="t m0 x2b h14 y1cc ff8 fs3 fc0 sc0 ls0 wsb7">W<span class="_ _0"></span>e ha<span class="_ _4"></span>ve di<span class="_ _4"></span>vided this book into three par<span class="_ _8"></span>ts. <span class="_ _4"></span>The ﬁrst sev<span class="_ _4"></span>eral chapters describe the prin-</div><div class="t m0 xd h14 y1cd ff8 fs3 fc0 sc0 ls0 wsb8">ciples, patterns, and practices of writing clean code. <span class="_ _4"></span>There is quite a bit of code in these</div><div class="t m0 xd h14 y1ce ff8 fs3 fc0 sc0 ls0 wsb9">chapters, and they will be challenging to read. <span class="_ _1"></span>They’<span class="_ _4"></span>ll prepare you for the second section</div><div class="t m0 xd h14 y1cf ff8 fs3 fc0 sc0 ls0 ws0">to come. If you put the book do<span class="_ _1"></span>wn after reading the ﬁrst section, good luck to you!</div><div class="t m0 x2b h14 y210 ff8 fs3 fc0 sc0 ls0 wsba">The second part of the book is the harder work. It consists of se<span class="_ _4"></span>veral case studies of</div><div class="t m0 xd h14 y211 ff8 fs3 fc0 sc0 ls0 wsbb">e<span class="_ _4"></span>ver-increasing comple<span class="_ _4"></span>xity<span class="_ _1"></span>. Each case study is an ex<span class="_ _4"></span>ercise in cleaning up some code—of</div><div class="t m0 xd h14 y212 ff8 fs3 fc0 sc0 ls0 wsbc">transforming code that has some problems into code that has few<span class="_ _1"></span>er problems. <span class="_ _1"></span>The detail in</div><div class="t m0 xd h14 y213 ff8 fs3 fc0 sc0 ls0 wsbd">this section is <span class="ffa ws0">intense</span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou will ha<span class="_ _4"></span>ve to ﬂip back and forth betw<span class="_ _4"></span>een the nar<span class="_ _8"></span>rative and the</div><div class="t m0 xd h14 y214 ff8 fs3 fc0 sc0 ls0 wsbe">code listings. <span class="_ _0"></span>Y<span class="_ _2"></span>ou will ha<span class="_ _4"></span>ve to anal<span class="_ _4"></span>yze and understand the code w<span class="_ _4"></span>e are working with and</div><div class="t m0 xd h14 y215 ff8 fs3 fc0 sc0 ls0 wsbf">w<span class="_ _4"></span>alk through our reasoning for making each change we mak<span class="_ _4"></span>e. Set aside some time</div><div class="t m0 xd h14 y216 ff8 fs3 fc0 sc0 ls0 ws0">because <span class="ffa">this should take you days</span>.</div><div class="t m0 x2b h14 y217 ff8 fs3 fc0 sc0 ls0 wsc0">The third part of this book is the pay<span class="_ _4"></span>off. It is a single chapter containing a list of heu-</div><div class="t m0 xd h14 y218 ff8 fs3 fc0 sc0 lsc wsc1">ristics and smells gathered while creating the case studies. <span class="_ _1"></span>As w<span class="_ _4"></span>e walk<span class="_ _4"></span>ed through and</div><div class="t m0 xd h14 y219 ff8 fs3 fc0 sc0 ls0 wsc2">cleaned up the code in the case studies, w<span class="_ _4"></span>e documented ev<span class="_ _4"></span>er<span class="_ _8"></span>y reason for our actions as a</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1c" class="pf w1 h2" data-page-no="1c"><div class="pc pc1c w1 h2"><div class="t m0 x30 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">xxvii<span class="_ _10"></span><span class="ff1">Intr<span class="_ _4"></span>oduction</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 wsc3">heuristic or smell. <span class="_ _4"></span>W<span class="_ _0"></span>e tried to understand our own reactions to the code w<span class="_ _1"></span>e were reading</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws70">and changing, and w<span class="_ _4"></span>orked hard to capture w<span class="_ _4"></span>hy w<span class="_ _4"></span>e felt what w<span class="_ _1"></span>e felt and did what w<span class="_ _4"></span>e did.</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 wsc4">The result is a kno<span class="_ _4"></span>wledge base that desribes the wa<span class="_ _1"></span>y we think w<span class="_ _4"></span>hen w<span class="_ _4"></span>e write, read<span class="_ _4"></span>, and</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">clean code. </div><div class="t m0 x2b h14 y1bd ff8 fs3 fc0 sc0 ls0 wsc5">This kno<span class="_ _4"></span>wledge base is of limited value if y<span class="_ _4"></span>ou don’<span class="_ _4"></span>t do the w<span class="_ _4"></span>ork of carefully reading</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws40">through the case studies in the second part of this book. In those case studies we ha<span class="_ _1"></span>ve care-</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 wsc6">fully annotated each change w<span class="_ _1"></span>e made with forward references to the heuristics. <span class="_ _1"></span>These for-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 wsc7">ward references appear in square brack<span class="_ _4"></span>ets like this: [H22]. <span class="_ _1"></span>This lets you see the <span class="ffa ws0">context <span class="ff8">in</span></span></div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 wsc8">which those heuristics w<span class="_ _1"></span>ere applied and written! It is not the heuristics themselves that are</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 wsc9">so valuab<span class="_ _4"></span>le, it is the <span class="ffa">r<span class="_ _4"></span>elationship between those heuristics and the discr<span class="_ _4"></span>ete decisions we</span></div><div class="t m0 xd h14 y19e ffa fs3 fc0 sc0 ls0 ws0">made while c<span class="_ _4"></span>leaning up the code in the case studies<span class="ff8">.</span></div><div class="t m0 x2b h14 y21a ff8 fs3 fc0 sc0 ls10 wsca">T<span class="_ _0"></span>o fur<span class="_ _8"></span>ther help you with those relationships, w<span class="_ _4"></span>e<span class="wscb"> ha<span class="_ _4"></span>ve placed <span class="wscc">a cross-reference <span class="ls0 wscd">at the end</span></span></span></div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 wsce">of the book that sho<span class="_ _4"></span>ws the page number for ev<span class="_ _4"></span>er<span class="_ _8"></span>y forward reference. <span class="_ _0"></span>Y<span class="_ _3"></span>ou can use it to look</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">up each place where a certain heuristic was applied.</div><div class="t m0 x2b h14 y20c ff8 fs3 fc0 sc0 ls0 wscf">If you read the ﬁrst and third sections and skip o<span class="_ _1"></span>ver the case studies, then y<span class="_ _4"></span>ou will</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 ls0 wsbd">ha<span class="_ _4"></span>ve read y<span class="_ _4"></span>et another “feel good” book about writing good software. But if y<span class="_ _4"></span>ou take the</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 wsd0">time to w<span class="_ _4"></span>ork through the case studies, follo<span class="_ _4"></span>wing ev<span class="_ _4"></span>er<span class="_ _8"></span>y tiny step, e<span class="_ _4"></span>very minute decision—if</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 wsd1">you put y<span class="_ _4"></span>ourself in our place, and force yourself to think along the same paths that w<span class="_ _1"></span>e</div><div class="t m0 xd h14 y220 ff8 fs3 fc0 sc0 lsc wsd2">thought, then you will gain a much richer understanding of those principles, patterns, prac-</div><div class="t m0 xd h14 y221 ff8 fs3 fc0 sc0 ls0 wsd3">tices, and heuristics. <span class="_ _1"></span>They w<span class="_ _4"></span>on’<span class="_ _4"></span>t be “feel good” kno<span class="_ _4"></span>wledge any more. <span class="_ _1"></span>They’<span class="_ _4"></span>ll ha<span class="_ _4"></span>ve been</div><div class="t m0 xd h14 y222 ff8 fs3 fc0 sc0 ls0 ws1f">ground into your gut, ﬁngers, and heart. <span class="_ _4"></span>They’<span class="_ _4"></span>ll ha<span class="_ _4"></span>ve become part of you in the same w<span class="_ _4"></span>ay</div><div class="t m0 xd h14 y223 ff8 fs3 fc0 sc0 ls0 ws0">that a bicycle becomes an e<span class="_ _4"></span>xtension of your will w<span class="_ _4"></span>hen you ha<span class="_ _4"></span>ve mastered ho<span class="_ _4"></span>w to ride it.</div><div class="t m0 xd h17 y224 ff1 fs9 fc0 sc0 ls0 ws0">Ackno<span class="_ _1"></span>wledgments</div><div class="t m0 xd h11 y225 ff1 fs7 fc0 sc0 ls0 ws0">Artwor<span class="_ _4"></span>k</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 wsd4">Thank you to m<span class="_ _1"></span>y tw<span class="_ _4"></span>o ar<span class="_ _8"></span>tists, Jeniffer K<span class="_ _4"></span>ohnke and <span class="_ _1"></span>Angela Brooks. Jennifer is responsible</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 wsd5">for the stunning and creati<span class="_ _4"></span>ve pictures at the start of each chapter and also for the por<span class="_ _8"></span>traits</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 wsd6">of Kent Beck, <span class="_ _1"></span>W<span class="_ _1"></span>ard Cunningham, Bjar<span class="_ _8"></span>ne Stroustr<span class="_ _8"></span>up, Ron Jeffries, Grady Booch, Da<span class="_ _1"></span>ve</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws0">Thomas, Michael F<span class="_ _1"></span>eathers, and myself. </div><div class="t m0 x2b h14 y22a ff8 fs3 fc0 sc0 ls0 wsd7">Angela is responsible for the cle<span class="_ _4"></span>ver pictures that adorn the innards of each chapter<span class="_ _1"></span>.</div><div class="t m0 xd h14 y22b ff8 fs3 fc0 sc0 ls0 wsd8">She has done quite a fe<span class="_ _4"></span>w pictures for me o<span class="_ _4"></span>ver the years, including man<span class="_ _4"></span>y of the inside pic-</div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 wsd9">tures in <span class="_ _1"></span><span class="ffa">Agile Softwar<span class="_ _4"></span>e Develpment: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>actices<span class="ff8">. She is also m<span class="_ _4"></span>y</span></span></div><div class="t m0 xd h14 y22d ff8 fs3 fc0 sc0 ls0 ws0">ﬁrstborn in whom I am w<span class="_ _4"></span>ell pleased.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1d" class="pf w1 h2" data-page-no="1d"><div class="pc pc1d w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1e" class="pf w1 h2" data-page-no="1e"><div class="pc pc1e w1 h2"><img class="bi xd y22e w5 h20" alt="" src="bg1e.png"/><div class="t m0 x2d h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">xxix</div><div class="t m0 x31 h9 y5d ff1 fs4 fc0 sc0 ls0 ws0">On the Co<span class="_ _2"></span>v<span class="_ _0"></span>er</div><div class="t m0 xd h14 y173 ff8 fs3 fc0 sc0 ls0 wsda">The image on the co<span class="_ _4"></span>ver is M104: <span class="_ _1"></span>The Sombrero Galaxy<span class="_ _0"></span>. M104 is located in <span class="_ _4"></span>Vir<span class="_ _4"></span>go and is</div><div class="t m0 xd h14 y174 ff8 fs3 fc0 sc0 ls0 wsdb">just under 30 million light-years from us. <span class="_ _1"></span>At it’<span class="_ _2"></span>s core is a supermassive b<span class="_ _4"></span>lack hole w<span class="_ _4"></span>eigh-</div><div class="t m0 xd h14 y175 ff8 fs3 fc0 sc0 ls0 ws0">ing in at about a billion solar masses.</div><div class="t m0 x2b h14 y22f ff8 fs3 fc0 sc0 ls0 wsdc">Does the image remind you of the e<span class="_ _4"></span>xplosion of the Klingon po<span class="_ _4"></span>wer moon <span class="_ _4"></span><span class="ffa ws0">Pr<span class="_ _4"></span>axis<span class="ff8 wsdc">? I</span></span></div><div class="t m0 xd h14 y177 ff8 fs3 fc0 sc0 ls0 wsdd">vi<span class="_ _4"></span>vidly remember the scene in <span class="ffa wsde">Star T<span class="_ _1"></span>r<span class="_ _4"></span>ek VI<span class="_ _a"> </span><span class="ff8 wsdd">that sho<span class="_ _4"></span>w<span class="_ _4"></span>ed an equatorial ring of debris ﬂying</span></span></div><div class="t m0 xd h14 y230 ff8 fs3 fc0 sc0 ls0 wsdf">a<span class="_ _4"></span>wa<span class="_ _1"></span>y from that explosion. Since that scene, the equatorial ring has been a common artif<span class="_ _8"></span>act</div><div class="t m0 xd h14 y231 ff8 fs3 fc0 sc0 ls0 wse0">in sci-ﬁ mo<span class="_ _4"></span>vie explosions. It w<span class="_ _4"></span>as ev<span class="_ _4"></span>en added to the explosion of <span class="_ _1"></span>Alderaan in later editions</div><div class="t m0 xd h14 y232 ff8 fs3 fc0 sc0 ls0 ws0">of the ﬁrst <span class="ffa wse1">Star W<span class="_ _2"></span>ars<span class="ff8 ws0"> mo<span class="_ _4"></span>vie.</span></span></div><div class="t m0 x2b h14 y233 ff8 fs3 fc0 sc0 ls0 wse2">What caused this ring to form around M104? Wh<span class="_ _4"></span>y does it ha<span class="_ _4"></span>ve such a huge central</div><div class="t m0 xd h14 y234 ff8 fs3 fc0 sc0 lsd wse3">bulge and such a bright and tin<span class="_ _4"></span>y nucleus? It looks to me as though the central black hole</div><div class="t m0 xd h14 y235 ff8 fs3 fc0 sc0 lsc wse4">lost its cool and ble<span class="_ _4"></span>w a 30,000 light-year hole in the middle of the galaxy<span class="_ _0"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>oe befell any</div><div class="t m0 xd h14 y236 ff8 fs3 fc0 sc0 ls0 ws0">ci<span class="_ _4"></span>vilizations that might hav<span class="_ _4"></span>e been in the path of that cosmic disr<span class="_ _8"></span>uption.</div><div class="t m0 x2b h14 y17f ff8 fs3 fc0 sc0 ls0 ws62">Supermassive b<span class="_ _4"></span>lack holes sw<span class="_ _4"></span>allo<span class="_ _4"></span>w whole stars for lunch, con<span class="_ _1"></span>ver<span class="_ _8"></span>ting a sizeable frac-</div><div class="t m0 xd h14 y180 ff8 fs3 fc0 sc0 ls0 ws6e">tion of their mass to energy<span class="_ _0"></span>. <span class="ffa">E = MC</span></div><div class="t m0 x32 h21 y237 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x33 h14 y238 ff8 fs3 fc0 sc0 ls11 wse5">is lev<span class="_ _4"></span>erage enough, but when <span class="ffa ls0 ws0">M<span class="_ _18"> </span><span class="ff8 ws6e">is a stellar mass:</span></span></div><div class="t m0 xd h14 y239 ff8 fs3 fc0 sc0 ls0 wse6">Look out! Ho<span class="_ _4"></span>w many stars fell headlong into that ma<span class="_ _1"></span>w before the monster was satiated?</div><div class="t m0 xd h14 y23a ff8 fs3 fc0 sc0 ls0 ws0">Could the size of the central void be a hint? </div><div class="t m0 x2b h14 y23b ff8 fs3 fc0 sc0 ls0 wse7">The image of M104 on the co<span class="_ _4"></span>ver is a</div><div class="t m0 xd h14 y23c ff8 fs3 fc0 sc0 ls0 wse8">combination of the famous visible light pho-</div><div class="t m0 xd h14 y23d ff8 fs3 fc0 sc0 ls0 wse9">to<span class="_ _4"></span>g<span class="_ _8"></span>raph from Hubble (right), and the recent</div><div class="t m0 xd h14 y23e ff8 fs3 fc0 sc0 ls0 wsea">infrared image from the Spitzer orbiting</div><div class="t m0 xd h14 y23f ff8 fs3 fc0 sc0 ls0 wseb">observatory (belo<span class="_ _4"></span>w<span class="_ _1"></span>, right). It’<span class="_ _2"></span>s the infrared</div><div class="t m0 xd h14 y240 ff8 fs3 fc0 sc0 ls0 wsec">image that clearl<span class="_ _4"></span>y shows us the ring nature</div><div class="t m0 xd h14 y241 ff8 fs3 fc0 sc0 lsc wsed">of <span class="_ _4"></span>the galaxy<span class="_ _0"></span>. In visible light w<span class="_ _4"></span>e only see the</div><div class="t m0 xd h14 y242 ff8 fs3 fc0 sc0 ls0 wsee">front edge of the ring in silhouette. The cen-</div><div class="t m0 xd h14 y243 ff8 fs3 fc0 sc0 lsd wsef">tral bulge obscures the rest of the ring.</div><div class="t m0 x2b h14 y244 ff8 fs3 fc0 sc0 ls0 wsf0">But in the infrared<span class="_ _1"></span>, the hot par<span class="_ _8"></span>ticles in</div><div class="t m0 xd h14 y245 ff8 fs3 fc0 sc0 lsd wsf1">the ring shine through the central bulge. <span class="_ _1"></span>The</div><div class="t m0 xd h14 y246 ff8 fs3 fc0 sc0 ls0 wsf2">tw<span class="_ _4"></span>o images combined giv<span class="_ _4"></span>e us a view w<span class="_ _1"></span>e’<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y247 ff8 fs3 fc0 sc0 ls0 wsf3">not seen before and impl<span class="_ _4"></span>y that long ago it</div><div class="t m0 xd h14 y248 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>as a raging infer<span class="_ _8"></span>no of activity<span class="_ _0"></span>. </div><div class="t m0 x34 h1f y249 ff8 fsb fc0 sc0 ls0 ws0">Co<span class="_ _4"></span>ver image: © Spitzer Space <span class="_ _4"></span>T<span class="_ _0"></span>elescope</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:233.184000px;bottom:527.330010px;width:205.450000px;height:40.104000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1f" class="pf w1 h2" data-page-no="1f"><div class="pc pc1f w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf20" class="pf w1 h2" data-page-no="20"><div class="pc pc20 w1 h2"><img class="bi xd y24a w4 h22" alt="" src="bg20.png"/><div class="t m0 x35 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">1</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">1</div><div class="t m0 x21 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Clean Code</div><div class="t m0 xd h14 y24e ff8 fs3 fc0 sc0 ls0 wsf4">Y<span class="_ _3"></span>ou are reading this book for two reasons. F<span class="_ _4"></span>irst, you are a pro<span class="_ _4"></span>grammer<span class="_ _4"></span>. Second<span class="_ _1"></span>, you want</div><div class="t m0 xd h14 y24f ff8 fs3 fc0 sc0 ls0 ws0">to be a better pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer<span class="_ _4"></span>. Good. <span class="_ _4"></span>W<span class="_ _0"></span>e need better programmers.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:319.595000px;bottom:440.027010px;width:119.327000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf21" class="pf w1 h2" data-page-no="21"><div class="pc pc21 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">2<span class="_ _1b"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 wsf6">This is a book about good pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming. It is ﬁlled with code. W<span class="_ _2"></span>e are going to look at</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 wsf7">code from e<span class="_ _4"></span>very different direction. <span class="_ _4"></span>W<span class="_ _0"></span>e’<span class="_ _4"></span>ll look down at it from the top, up at it from the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 wsf8">bottom, and through it from the inside out. By the time w<span class="_ _4"></span>e are done, w<span class="_ _4"></span>e’<span class="_ _1"></span>re going to kno<span class="_ _4"></span>w a</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 wsf9">lot about code. <span class="_ _4"></span>What’<span class="_ _2"></span>s more, we’<span class="_ _1"></span>ll be able to tell the dif<span class="_ _4"></span>ference between good code and bad</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 wsfa">code. <span class="_ _4"></span>W<span class="_ _0"></span>e’ll kno<span class="_ _1"></span>w ho<span class="_ _4"></span>w to write good code. <span class="_ _4"></span>And w<span class="_ _4"></span>e’<span class="_ _4"></span>ll kno<span class="_ _4"></span>w how to transform bad code into</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">good code. </div><div class="t m0 xd h17 y250 ff1 fs9 fc0 sc0 ls0 ws0">Ther<span class="_ _4"></span>e <span class="_ _0"></span>Will Be Code</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws34">One might argue that a book about code is someho<span class="_ _1"></span>w behind the times—that code is no</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 wsfb">longer the issue; that w<span class="_ _4"></span>e should be concer<span class="_ _8"></span>ned about models and requirements instead.</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 wsfc">Indeed some ha<span class="_ _4"></span>ve suggested that w<span class="_ _4"></span>e are close to the end of code. <span class="_ _4"></span>That soon all code will</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 lsd wsfd">be generated instead of written. <span class="_ _1"></span>That programmers simply w<span class="_ _4"></span>on’<span class="_ _1"></span>t be needed because busi-</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">ness people will generate pro<span class="_ _4"></span>g<span class="_ _8"></span>rams from speciﬁcations.</div><div class="t m0 x2b h14 y256 ff8 fs3 fc0 sc0 ls0 wsfe">Nonsense! <span class="_ _4"></span>W<span class="_ _0"></span>e will never be rid of code, because code represents the details of the</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 wsff">requirements. <span class="_ _1"></span>At some level those details cannot be ignored or abstracted; the<span class="_ _4"></span>y ha<span class="_ _4"></span>ve to be</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws100">speciﬁed. <span class="_ _1"></span>And specifying requirements in such detail that a machine can ex<span class="_ _4"></span>ecute them <span class="ffa ws0">is</span></div><div class="t m0 xd h14 y259 ffa fs3 fc0 sc0 ls0 ws0">pr<span class="_ _4"></span>o<span class="_ _4"></span>gr<span class="_ _4"></span>amming<span class="ff8">. Such a speciﬁcation </span>is code<span class="ff8">.</span></div><div class="t m0 x2b h14 y25a ff8 fs3 fc0 sc0 ls12 ws101">I expect that the le<span class="_ _4"></span>vel of abstraction of our languages will continue to increase. I</div><div class="t m0 xd h14 y25b ff8 fs3 fc0 sc0 ls12 ws102">also expect that the number of domain-speciﬁc languages will continue to gro<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>This</div><div class="t m0 xd h14 y25c ff8 fs3 fc0 sc0 ls12 ws103">will be a good thing. But it will not eliminate code. Indeed<span class="_ _1"></span>, all the speciﬁcations written</div><div class="t m0 xd h14 y25d ff8 fs3 fc0 sc0 ls12 ws104">in these higher le<span class="_ _4"></span>vel and domain-speciﬁc language will <span class="ffa ws0">be<span class="_ _15"> </span></span>code! It will still need to</div><div class="t m0 xd h14 y25e ff8 fs3 fc0 sc0 ls12 ws105">be <span class="_ _2"></span>rigorous, accurate, and so formal and detailed that a machine can understand and</div><div class="t m0 xd h14 y25f ff8 fs3 fc0 sc0 ls12 ws0">ex<span class="_ _4"></span>ecute it.</div><div class="t m0 x2b h14 y260 ff8 fs3 fc0 sc0 ls0 ws106">The folks who think that code will one da<span class="_ _1"></span>y disappear are like mathematicians who</div><div class="t m0 xd h14 y261 ff8 fs3 fc0 sc0 ls0 ws107">hope one da<span class="_ _4"></span>y to disco<span class="_ _4"></span>ver a mathematics that does not ha<span class="_ _4"></span>ve to be formal. <span class="_ _4"></span>They are hoping</div><div class="t m0 xd h14 y262 ff8 fs3 fc0 sc0 ls0 ws108">that one da<span class="_ _4"></span>y w<span class="_ _4"></span>e will disco<span class="_ _4"></span>ver a wa<span class="_ _1"></span>y to create machines that can do what w<span class="_ _4"></span>e want rather</div><div class="t m0 xd h14 y263 ff8 fs3 fc0 sc0 ls0 ws109">than what w<span class="_ _1"></span>e say<span class="_ _0"></span>. <span class="_ _1"></span>These machines will hav<span class="_ _4"></span>e to be able to understand us so w<span class="_ _4"></span>ell that they</div><div class="t m0 xd h14 y264 ff8 fs3 fc0 sc0 ls0 ws10a">can translate v<span class="_ _4"></span>aguely speciﬁed needs into perfectl<span class="_ _4"></span>y ex<span class="_ _4"></span>ecuting programs that precisely meet</div><div class="t m0 xd h14 y265 ff8 fs3 fc0 sc0 ls0 ws0">those needs. </div><div class="t m0 x2b h14 y266 ff8 fs3 fc0 sc0 ls12 ws10b">This will ne<span class="_ _4"></span>ver happen. Not ev<span class="_ _4"></span>en humans, with all their intuition and creativity<span class="_ _0"></span>,</div><div class="t m0 xd h14 y267 ff8 fs3 fc0 sc0 ls12 ws91">ha<span class="_ _4"></span>ve been ab<span class="_ _4"></span>le to create successful systems from the vague feelings of their customers.</div><div class="t m0 xd h14 y268 ff8 fs3 fc0 sc0 ls12 ws10c">Indeed<span class="_ _1"></span>, if the discipline of requirements speciﬁcation has taught us anything, it is that</div><div class="t m0 xd h14 y269 ff8 fs3 fc0 sc0 ls12 ws10d">w<span class="_ _4"></span>ell-speciﬁed requirements are as for<span class="_ _8"></span>mal as code and can act as ex<span class="_ _4"></span>ecutable tests of that</div><div class="t m0 xd h14 y26a ff8 fs3 fc0 sc0 ls12 ws0">code!</div><div class="t m0 x2b h14 y26b ff8 fs3 fc0 sc0 ls0 ws10e">Remember that code is reall<span class="_ _4"></span>y the language in which w<span class="_ _4"></span>e ultimately e<span class="_ _4"></span>xpress the require-</div><div class="t m0 xd h14 y26c ff8 fs3 fc0 sc0 ls0 ws10f">ments. <span class="_ _4"></span>W<span class="_ _0"></span>e may create languages that are closer to the requirements. <span class="_ _1"></span>W<span class="_ _1"></span>e ma<span class="_ _4"></span>y create tools</div><div class="t m0 xd h14 y26d ff8 fs3 fc0 sc0 ls0 ws110">that help us parse and assemble those requirements into formal structures. But we will</div><div class="t m0 xd h14 y26e ff8 fs3 fc0 sc0 ls0 ws0">ne<span class="_ _4"></span>ver eliminate necessary precision—so there will alw<span class="_ _4"></span>a<span class="_ _4"></span>ys be code. </div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:490.945010px;width:116.962000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf22" class="pf w1 h2" data-page-no="22"><div class="pc pc22 w1 h2"><img class="bi x37 y26f w6 h24" alt="" src="bg22.png"/><div class="t m0 x35 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">3<span class="_ _10"></span><span class="ff1">Bad Code</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Bad Code</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws111">I was recentl<span class="_ _1"></span>y reading the pref<span class="_ _8"></span>ace to Kent Beck’<span class="_ _3"></span>s</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws0">book <span class="ffa ws112">Implementation P<span class="_ _0"></span>atterns.</span></div><div class="t m0 x38 h21 y272 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x1c h14 y271 ff8 fs3 fc0 sc0 ls0 ws0">He sa<span class="_ _4"></span>ys, “. . . this</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws113">book is based on a rather fragile premise: that</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 lsd ws114">good <span class="_ _5"></span>code <span class="_ _5"></span>matters. . . .<span class="_ _1"></span>” A <span class="_ _5"></span><span class="ffa ls0 ws0">fr<span class="_ _4"></span>agile<span class="_ _18"> </span><span class="ff8 ws115">premise? I dis-</span></span></div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws116">agree! I think that premise is one of the most</div><div class="t m0 xd h14 y276 ff8 fs3 fc0 sc0 lsd ws117">robust, supported<span class="_ _4"></span>, and o<span class="_ _4"></span>verloaded of all the pre-</div><div class="t m0 xd h14 y277 ff8 fs3 fc0 sc0 ls0 ws118">mises in our craft (and I think Kent kno<span class="_ _1"></span>ws it). W<span class="_ _2"></span>e</div><div class="t m0 xd h14 y278 ff8 fs3 fc0 sc0 ls0 ws119">kno<span class="_ _4"></span>w good code matters because w<span class="_ _4"></span>e’<span class="_ _4"></span>ve had to</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws0">deal for so long with its lack.</div><div class="t m0 x2b h14 y27a ff8 fs3 fc0 sc0 ls0 ws11a">I kno<span class="_ _4"></span>w of one company that, in the late 80s,</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws11b">wrote a <span class="ffa ws0">killer </span>app. It w<span class="_ _4"></span>as very popular<span class="_ _4"></span>, and lots of</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws11c">professionals bought and used it. But then the</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 lsc ws11d">release cycles be<span class="_ _4"></span>gan to stretch. Bugs were not</div><div class="t m0 xd h14 y27e ff8 fs3 fc0 sc0 ls0 ws11e">repaired from one release to the next. Load times</div><div class="t m0 xd h14 y27f ff8 fs3 fc0 sc0 ls0 ws11f">grew and crashes increased. I remember the da<span class="_ _4"></span>y I</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls0 ws120">shut the product do<span class="_ _4"></span>wn in frustration and never</div><div class="t m0 xd h14 y281 ff8 fs3 fc0 sc0 ls0 ws121">used it again. <span class="_ _1"></span>The company w<span class="_ _4"></span>ent out of business</div><div class="t m0 xd h14 y2a ff8 fs3 fc0 sc0 ls0 ws0">a short time after that.</div><div class="t m0 x2b h14 y282 ff8 fs3 fc0 sc0 ls0 ws122">T<span class="_ _2"></span>wo decades later I met one of the earl<span class="_ _4"></span>y emplo<span class="_ _4"></span>yees of that compan<span class="_ _4"></span>y and asked him</div><div class="t m0 xd h14 y283 ff8 fs3 fc0 sc0 ls0 ws123">what had happened. <span class="_ _1"></span>The answ<span class="_ _1"></span>er conﬁr<span class="_ _8"></span>med my fears. <span class="_ _1"></span>They had rushed the product to</div><div class="t m0 xd h14 y284 ff8 fs3 fc0 sc0 ls0 ws118">market and had made a huge mess in the code. <span class="_ _1"></span>As they added more and more features, the</div><div class="t m0 xd h14 y285 ff8 fs3 fc0 sc0 ls0 ws3f">code got w<span class="_ _4"></span>orse and w<span class="_ _4"></span>orse until they simpl<span class="_ _4"></span>y could not manage it any longer<span class="_ _1"></span>. <span class="ffa">It was the bad</span></div><div class="t m0 xd h1d y286 ffa fs3 fc0 sc0 ls0 ws0">code that br<span class="_ _4"></span>ought the company do<span class="_ _4"></span>wn.</div><div class="t m0 x2b h14 y287 ff8 fs3 fc0 sc0 ls0 ws0">Ha<span class="_ _4"></span>ve <span class="_ _5"></span><span class="ffa">you<span class="_ _16"> </span></span><span class="ws124">e<span class="_ _4"></span>ver been signiﬁcantl<span class="_ _4"></span>y impeded by bad code? If y<span class="_ _4"></span>ou are a programmer of</span></div><div class="t m0 xd h14 y288 ff8 fs3 fc0 sc0 ls0 ws74">an<span class="_ _4"></span>y experience then you’<span class="_ _1"></span>ve felt this impediment man<span class="_ _4"></span>y times. Indeed<span class="_ _4"></span>, w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve a name for</div><div class="t m0 xd h14 y289 ff8 fs3 fc0 sc0 ls0 ws60">it. <span class="_ _4"></span>W<span class="_ _0"></span>e call it <span class="ffa ws0">wading</span>. <span class="_ _4"></span>W<span class="_ _0"></span>e wade through bad code. <span class="_ _4"></span>W<span class="_ _0"></span>e slog through a morass of tangled</div><div class="t m0 xd h14 y28a ff8 fs3 fc0 sc0 ls0 ws125">brambles and hidden pitfalls. <span class="_ _4"></span>W<span class="_ _0"></span>e str<span class="_ _8"></span>uggle to ﬁnd our w<span class="_ _4"></span>ay<span class="_ _0"></span>, hoping for some hint, some</div><div class="t m0 xd h14 y28b ff8 fs3 fc0 sc0 lsd wsef">clue, of what is going on; but all w<span class="_ _1"></span>e see is more and more senseless code.</div><div class="t m0 x2b h14 y28c ff8 fs3 fc0 sc0 ls0 ws0">Of course you ha<span class="_ _1"></span>ve been impeded by bad code. So then—w<span class="_ _4"></span>h<span class="_ _4"></span>y did you write it?</div><div class="t m0 x2b h14 y28d ff8 fs3 fc0 sc0 ls0 ws126">W<span class="_ _0"></span>ere you trying to go fast? W<span class="_ _2"></span>ere you in a rush? Probably so. P<span class="_ _1"></span>erhaps you felt that y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y28e ff8 fs3 fc0 sc0 ls0 ws127">didn’<span class="_ _1"></span>t hav<span class="_ _4"></span>e time to do a good job; that your boss w<span class="_ _4"></span>ould be angr<span class="_ _8"></span>y with you if you took the</div><div class="t m0 xd h14 y28f ff8 fs3 fc0 sc0 ls0 ws128">time to clean up your code. P<span class="_ _1"></span>erhaps you w<span class="_ _4"></span>ere just tired of w<span class="_ _4"></span>orking on this program and</div><div class="t m0 xd h14 y290 ff8 fs3 fc0 sc0 ls0 ws129">w<span class="_ _4"></span>anted it to be o<span class="_ _4"></span>ver<span class="_ _1"></span>. Or maybe y<span class="_ _4"></span>ou looked at the backlog of other stuf<span class="_ _1"></span>f that you had prom-</div><div class="t m0 xd h14 y291 ff8 fs3 fc0 sc0 ls0 ws12a">ised to get done and realized that you needed to slam this module to<span class="_ _4"></span>gether so you could</div><div class="t m0 xd h14 y292 ff8 fs3 fc0 sc0 ls0 ws0">mo<span class="_ _4"></span>ve on to the ne<span class="_ _4"></span>xt. W<span class="_ _2"></span>e’<span class="_ _4"></span>ve all done it. </div><div class="t m0 x2b h14 y293 ff8 fs3 fc0 sc0 ls0 ws12b">W<span class="_ _0"></span>e’<span class="_ _1"></span>ve all looked at the mess w<span class="_ _4"></span>e’<span class="_ _4"></span>ve just made and then ha<span class="_ _4"></span>ve chosen to lea<span class="_ _1"></span>ve it for</div><div class="t m0 xd h14 y294 ff8 fs3 fc0 sc0 ls0 ws28">another da<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>e’<span class="_ _4"></span>ve all felt the relief of seeing our messy pro<span class="_ _4"></span>g<span class="_ _8"></span>ram w<span class="_ _4"></span>ork and deciding that a</div><div class="t m0 xd h25 y295 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[Beck07].</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:580.945010px;width:58.729000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf23" class="pf w1 h2" data-page-no="23"><div class="pc pc23 w1 h2"><img class="bi x14 y296 w7 h26" alt="" src="bg23.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">4<span class="_ _1b"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws12c">w<span class="_ _4"></span>orking mess is better than nothing. <span class="_ _4"></span>W<span class="_ _0"></span>e’<span class="_ _4"></span>ve all said w<span class="_ _4"></span>e’<span class="_ _2"></span>d go back and clean it up later<span class="_ _1"></span>. Of</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">course, in those da<span class="_ _4"></span>ys w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t kno<span class="_ _4"></span>w LeBlanc’<span class="_ _2"></span>s law: <span class="_ _4"></span><span class="ffa">Later equals never<span class="_ _1"></span><span class="ff8">.</span></span></div><div class="t m0 xd h17 y297 ff1 fs9 fc0 sc0 ls0 ws0">The <span class="_ _0"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess</div><div class="t m0 xd h14 y298 ff8 fs3 fc0 sc0 ls0 ws12d">If you ha<span class="_ _1"></span>ve been a programmer for more than tw<span class="_ _4"></span>o or three years, y<span class="_ _4"></span>ou ha<span class="_ _4"></span>ve probabl<span class="_ _4"></span>y been</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws12e">signiﬁcantl<span class="_ _4"></span>y slow<span class="_ _1"></span>ed down b<span class="_ _4"></span>y someone else’<span class="_ _2"></span>s messy code. If you ha<span class="_ _1"></span>ve been a programmer</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws12f">for longer than tw<span class="_ _4"></span>o or three years, y<span class="_ _4"></span>ou ha<span class="_ _4"></span>ve probabl<span class="_ _4"></span>y been slo<span class="_ _4"></span>w<span class="_ _4"></span>ed do<span class="_ _4"></span>wn by messy code.</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws23">The degree of the slo<span class="_ _4"></span>wdo<span class="_ _4"></span>wn can be signiﬁcant. Over the span of a year or tw<span class="_ _1"></span>o, teams that</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws28">w<span class="_ _4"></span>ere mo<span class="_ _4"></span>ving very fast at the beginning of a project can ﬁnd themselves mo<span class="_ _1"></span>ving at a snail’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws130">pace. Every change they make to the code breaks tw<span class="_ _1"></span>o or three other par<span class="_ _8"></span>ts of the code. No</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws131">change is tri<span class="_ _4"></span>vial. Every addition or modiﬁcation to the system requires that the tangles,</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws132">twists, and knots be “understood” so that more tangles, twists, and knots can be added.</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws133">Over time the mess becomes so big and so deep and so tall, the<span class="_ _4"></span>y can not clean it up. <span class="_ _4"></span>There</div><div class="t m0 xd h14 y29c ff8 fs3 fc0 sc0 ls0 ws0">is no wa<span class="_ _1"></span>y at all.</div><div class="t m0 x2b h14 y257 ff8 fs3 fc0 sc0 lsd ws134">As the mess builds, the producti<span class="_ _4"></span>vity of the team continues to decrease, asymptotically</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws135">approaching zero. <span class="_ _1"></span>As productivity decreases, management does the onl<span class="_ _4"></span>y thing they can;</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws136">they add more staf<span class="_ _4"></span>f to the project in hopes of increasing productivity<span class="_ _0"></span>. But that ne<span class="_ _4"></span>w staff is</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls0 ws137">not versed in the design of the system. <span class="_ _1"></span>They don’<span class="_ _1"></span>t know the dif<span class="_ _4"></span>ference betw<span class="_ _4"></span>een a change</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 ls0 ws138">that matches the design intent and a change that thwarts the design intent. Further<span class="_ _8"></span>more,</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws139">they<span class="_ _0"></span>, and ev<span class="_ _4"></span>er<span class="_ _8"></span>yone else on the team, are under horriﬁc pressure to increase productivity<span class="_ _0"></span>. So</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 ls0 ws13a">they all make more and more messes, dri<span class="_ _1"></span>ving the productivity e<span class="_ _4"></span>ver further tow<span class="_ _4"></span>ard zero.</div><div class="t m0 xd h14 y2a1 ff8 fs3 fc0 sc0 ls0 ws0">(See Figure 1-1.)</div><div class="t m0 x33 h1c y2a2 ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 1-1</div><div class="t m0 xc h14 y2a3 ff8 fs3 fc0 sc0 ls0 ws0">Productivity vs. time</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:538.945010px;width:197.768000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf24" class="pf w1 h2" data-page-no="24"><div class="pc pc24 w1 h2"><div class="t m0 x35 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">5<span class="_ _10"></span><span class="ff1">The <span class="_ _1"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">The Grand Redesign in the Sk<span class="_ _4"></span>y</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws13b">Eventuall<span class="_ _4"></span>y the team rebels. <span class="_ _4"></span>They inform management that they cannot continue to de<span class="_ _4"></span>velop</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws13c">in this odious code base. <span class="_ _1"></span>They demand a redesign. Management does not want to e<span class="_ _4"></span>xpend</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 lsd ws13d">the resources on a whole ne<span class="_ _4"></span>w redesign of the project, but they cannot den<span class="_ _4"></span>y that productiv-</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws13e">ity is ter<span class="_ _8"></span>rible. Ev<span class="_ _4"></span>entually the<span class="_ _4"></span>y bend to the demands of the developers and authorize the</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0">grand redesign in the sky<span class="_ _0"></span>.</div><div class="t m0 x2b h14 y2a8 ff8 fs3 fc0 sc0 ls0 ws27">A new tiger team is selected. Ev<span class="_ _4"></span>eryone wants to be on this team because it’<span class="_ _3"></span>s a g<span class="_ _8"></span>reen-</div><div class="t m0 xd h14 y2a9 ff8 fs3 fc0 sc0 ls0 ws127">ﬁeld project. <span class="_ _1"></span>They get to star<span class="_ _8"></span>t o<span class="_ _4"></span>ver and create something truly beautiful. But onl<span class="_ _4"></span>y the best</div><div class="t m0 xd h14 y2aa ff8 fs3 fc0 sc0 ls0 wsb8">and brightest are chosen for the tiger team. Everyone else must continue to maintain the</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws0">cur<span class="_ _8"></span>rent system.</div><div class="t m0 x2b h14 y2ac ff8 fs3 fc0 sc0 lsd ws13f">No<span class="_ _4"></span>w the tw<span class="_ _4"></span>o teams are in a race. <span class="_ _4"></span>The tiger team must build a new system that does</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws140">e<span class="_ _4"></span>verything that the old system does. Not only that, they ha<span class="_ _1"></span>ve to keep up with the changes</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws141">that are continuousl<span class="_ _4"></span>y being made to the old system. Management will not replace the old</div><div class="t m0 xd h14 y2af ff8 fs3 fc0 sc0 ls0 ws0">system until the ne<span class="_ _4"></span>w system can do everything that the old system does.</div><div class="t m0 x2b h14 y2b0 ff8 fs3 fc0 sc0 ls0 wsf9">This race can go on for a very long time. I’<span class="_ _4"></span>ve seen it tak<span class="_ _4"></span>e 10 years. <span class="_ _1"></span>And by the time it’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y2b1 ff8 fs3 fc0 sc0 ls0 ws142">done, the original members of the tiger team are long gone, and the cur<span class="_ _8"></span>rent members are</div><div class="t m0 xd h14 y2b2 ff8 fs3 fc0 sc0 ls0 ws0">demanding that the ne<span class="_ _4"></span>w system be redesigned because it’<span class="_ _2"></span>s such a mess.</div><div class="t m0 x2b h14 y2b3 ff8 fs3 fc0 sc0 ls0 ws143">If you ha<span class="_ _1"></span>ve experienced e<span class="_ _4"></span>ven one small part of the stor<span class="_ _8"></span>y I just told<span class="_ _1"></span>, then you already</div><div class="t m0 xd h14 y2b4 ff8 fs3 fc0 sc0 ls0 ws144">kno<span class="_ _4"></span>w that spending time keeping y<span class="_ _4"></span>our code clean is not just cost effecti<span class="_ _4"></span>ve; it’<span class="_ _2"></span>s a matter of</div><div class="t m0 xd h14 y2b5 ff8 fs3 fc0 sc0 ls0 ws0">professional surviv<span class="_ _4"></span>al.</div><div class="t m0 xd h11 y2b6 ff1 fs7 fc0 sc0 ls0 ws0">Attitude</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls0 ws145">Ha<span class="_ _4"></span>ve y<span class="_ _4"></span>ou ever w<span class="_ _4"></span>aded through a mess so grav<span class="_ _4"></span>e that it took weeks to do w<span class="_ _4"></span>hat should ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 ls0 ws146">taken hours? Ha<span class="_ _4"></span>ve y<span class="_ _4"></span>ou seen what should ha<span class="_ _4"></span>ve been a one-line change, made instead in</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws0">hundreds of dif<span class="_ _4"></span>ferent modules? <span class="_ _4"></span>These symptoms are all too common. </div><div class="t m0 x2b h14 y2ba ff8 fs3 fc0 sc0 ls0 ws147">Wh<span class="_ _4"></span>y does this happen to code? Wh<span class="_ _4"></span>y does good code rot so quickl<span class="_ _4"></span>y into bad code? W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 ws148">ha<span class="_ _4"></span>ve lots of explanations for it. <span class="_ _1"></span>W<span class="_ _0"></span>e complain that the requirements changed in wa<span class="_ _4"></span>ys that</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws149">thwart the original design. <span class="_ _4"></span>W<span class="_ _0"></span>e bemoan the schedules that were too tight to do things right.</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws14a">W<span class="_ _0"></span>e blather about stupid managers and intolerant customers and useless mark<span class="_ _4"></span>eting types</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 lsd ws10c">and telephone sanitizers. But the fault, dear Dilber<span class="_ _8"></span>t, is not in our stars, but in ourselves.</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e are unprofessional.</div><div class="t m0 x2b h14 y22b ff8 fs3 fc0 sc0 ls0 ws14b">This ma<span class="_ _4"></span>y be a bitter pill to sw<span class="_ _4"></span>allo<span class="_ _4"></span>w<span class="_ _0"></span>. How could this mess be <span class="ffa ws0">our<span class="_ _b"> </span></span>fault? What about the</div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws14c">requirements? <span class="_ _4"></span>What about the schedule? What about the stupid managers and the useless</div><div class="t m0 xd h14 y22d ff8 fs3 fc0 sc0 ls0 ws0">marketing types? Don’<span class="_ _1"></span>t they bear some of the blame?</div><div class="t m0 x2b h14 y2bc ff8 fs3 fc0 sc0 ls0 ws14d">No. <span class="_ _1"></span>The managers and marketers look to <span class="ffa ws0">us<span class="_ _15"> </span></span>for the information they need to make</div><div class="t m0 xd h14 y2bd ff8 fs3 fc0 sc0 ls0 ws14e">promises and commitments; and e<span class="_ _4"></span>ven when the<span class="_ _4"></span>y don’<span class="_ _4"></span>t look to us, w<span class="_ _4"></span>e should not be shy</div><div class="t m0 xd h14 y2be ff8 fs3 fc0 sc0 ls0 ws92">about telling them what w<span class="_ _1"></span>e think. <span class="_ _4"></span>The users look to us to validate the w<span class="_ _4"></span>a<span class="_ _4"></span>y the requirements</div><div class="t m0 xd h14 y2bf ff8 fs3 fc0 sc0 ls0 ws14f">will ﬁt into the system. <span class="_ _1"></span>The project managers look to us to help work out the schedule. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:160.731000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:308.728010px;width:42.659000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf25" class="pf w1 h2" data-page-no="25"><div class="pc pc25 w1 h2"><img class="bi x37 y2c0 w8 h27" alt="" src="bg25.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">6<span class="_ _1b"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws25">are deeply complicit in the planning of the project and share a great deal of the responsi-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">bility for an<span class="_ _4"></span>y f<span class="_ _8"></span>ailures; especially if those failures ha<span class="_ _4"></span>ve to do with bad code!</div><div class="t m0 x2b h14 y1fa ff8 fs3 fc0 sc0 ls0 ws150">“But w<span class="_ _4"></span>ait!” you sa<span class="_ _4"></span>y<span class="_ _0"></span>. “If I don’<span class="_ _4"></span>t do what m<span class="_ _4"></span>y manager sa<span class="_ _4"></span>ys, I’<span class="_ _4"></span>ll be ﬁred.<span class="_ _1"></span>” Probabl<span class="_ _4"></span>y not.</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws151">Most managers w<span class="_ _4"></span>ant the tr<span class="_ _8"></span>uth, ev<span class="_ _4"></span>en when they don’<span class="_ _1"></span>t act like it. Most managers w<span class="_ _4"></span>ant good</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws9a">code, ev<span class="_ _4"></span>en when the<span class="_ _4"></span>y are obsessing about the schedule. <span class="_ _4"></span>They ma<span class="_ _4"></span>y defend the schedule and</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 lsd ws67">requirements with passion; but that’<span class="_ _2"></span>s their job<span class="_ _4"></span>. It’<span class="_ _2"></span>s <span class="ffa ls0 ws0">your<span class="_ _a"> </span><span class="ff8 ws152">job to defend the code with equal</span></span></div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">passion.</div><div class="t m0 x2b h14 y206 ff8 fs3 fc0 sc0 ls0 ws153">T<span class="_ _0"></span>o drive this point home, w<span class="_ _4"></span>hat if you w<span class="_ _1"></span>ere a doctor and had a patient who demanded</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws154">that you stop all the sill<span class="_ _4"></span>y hand-w<span class="_ _4"></span>ashing in preparation for surgery because it was taking</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws155">too much time?</div><div class="t m0 x39 h21 y278 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x3a h14 y1fc ff8 fs3 fc0 sc0 ls0 ws155">Clearly the patient is the boss; and y<span class="_ _4"></span>et the doctor should absolutel<span class="_ _4"></span>y refuse</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws156">to comply<span class="_ _0"></span>. <span class="_ _4"></span>Why? Because the doctor kno<span class="_ _1"></span>ws more than the patient about the risks of dis-</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws157">ease and infection. It w<span class="_ _4"></span>ould be unprofessional (nev<span class="_ _4"></span>er mind criminal) for the doctor to</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws0">compl<span class="_ _4"></span>y with the patient.</div><div class="t m0 x2b h14 y20b ff8 fs3 fc0 sc0 ls0 ws158">So too it is unprofessional for pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers to bend to the will of managers who don’<span class="_ _1"></span>t</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws0">understand the risks of making messes.</div><div class="t m0 xd h11 y2c1 ff1 fs7 fc0 sc0 ls0 ws0">The Primal Conundrum</div><div class="t m0 xd h14 y2c2 ff8 fs3 fc0 sc0 ls0 ws159">Programmers face a conundrum of basic values. <span class="_ _1"></span>All developers with more than a fe<span class="_ _4"></span>w years</div><div class="t m0 xd h14 y2c3 ff8 fs3 fc0 sc0 ls0 ws15a">experience kno<span class="_ _1"></span>w that previous messes slo<span class="_ _4"></span>w them do<span class="_ _4"></span>wn. <span class="_ _1"></span>And yet all dev<span class="_ _4"></span>elopers feel</div><div class="t m0 xd h14 y2c4 ff8 fs3 fc0 sc0 ls0 ws15b">the <span class="_ _4"></span>pressure to make messes in order to meet deadlines. In short, they don’<span class="_ _4"></span>t take the time</div><div class="t m0 xd h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws0">to go fast!</div><div class="t m0 x2b h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws6b">T<span class="_ _4"></span>r<span class="_ _8"></span>ue professionals kno<span class="_ _4"></span>w that the second par<span class="_ _8"></span>t of the conundrum is wrong. <span class="_ _1"></span>Y<span class="_ _3"></span>ou will <span class="ffa ws0">not</span></div><div class="t m0 xd h14 y2c7 ff8 fs3 fc0 sc0 ls0 ws158">make the deadline b<span class="_ _4"></span>y making the mess. Indeed<span class="_ _1"></span>, the mess will slow y<span class="_ _4"></span>ou do<span class="_ _4"></span>wn instantly<span class="_ _0"></span>, and</div><div class="t m0 xd h14 y2c8 ff8 fs3 fc0 sc0 ls0 ws15c">will force you to miss the deadline. <span class="_ _1"></span>The <span class="ffa ws0">only<span class="_ _a"> </span></span>wa<span class="_ _4"></span>y to make the deadline—the onl<span class="_ _4"></span>y wa<span class="_ _1"></span>y to</div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">go fast—is to keep the code as clean as possible at all times.</div><div class="t m0 xd h11 y2ca ff1 fs7 fc0 sc0 ls0 ws0">The <span class="_ _0"></span>Art of Clean Code?</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws15d">Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y you belie<span class="_ _4"></span>ve that messy code is a signiﬁcant impediment. Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y that you accept</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws15e">that the onl<span class="_ _4"></span>y wa<span class="_ _4"></span>y to go fast is to keep your code clean. <span class="_ _1"></span>Then you must ask y<span class="_ _4"></span>ourself: “Ho<span class="_ _4"></span>w</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws15f">do I write clean code?” It’<span class="_ _2"></span>s no good trying to write clean code if you don’<span class="_ _4"></span>t kno<span class="_ _4"></span>w what it</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 ws0">means for code to be clean! </div><div class="t m0 x2b h14 y2cf ff8 fs3 fc0 sc0 ls0 ws160">The bad ne<span class="_ _4"></span>ws is that writing clean code is a lot like painting a picture. Most of us</div><div class="t m0 xd h14 y2d0 ff8 fs3 fc0 sc0 ls0 ws161">kno<span class="_ _4"></span>w when a picture is painted w<span class="_ _1"></span>ell or badly<span class="_ _0"></span>. But being able to reco<span class="_ _4"></span>gnize good ar<span class="_ _8"></span>t from</div><div class="t m0 xd h14 y2d1 ff8 fs3 fc0 sc0 ls0 ws25">bad does not mean that w<span class="_ _4"></span>e kno<span class="_ _4"></span>w ho<span class="_ _4"></span>w to paint. So too being able to reco<span class="_ _4"></span>gnize clean code</div><div class="t m0 xd h14 y2d2 ff8 fs3 fc0 sc0 ls0 ws0">from dirty code does not mean that we kno<span class="_ _1"></span>w how to write clean code!</div><div class="t m0 xd h25 y2d3 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>When hand-w<span class="_ _4"></span>ashing was ﬁrst recommended to ph<span class="_ _4"></span>ysicians by Ignaz Semmel<span class="_ _4"></span>weis in 1847, it w<span class="_ _4"></span>as rejected on the basis that </div><div class="t m0 x3b h25 y2d4 ff8 fse fc0 sc0 ls13 ws162">doctors were too busy and w<span class="_ _1"></span>ouldn’t ha<span class="_ _4"></span>ve time to wash their hands betw<span class="_ _4"></span>een patient visits.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:381.728010px;width:124.442000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:248.728010px;width:121.748000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf26" class="pf w1 h2" data-page-no="26"><div class="pc pc26 w1 h2"><img class="bi x3c y2d5 w8 h28" alt="" src="bg26.png"/><div class="t m0 x35 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">7<span class="_ _10"></span><span class="ff1">The <span class="_ _1"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 ws163">Writing clean code requires the disciplined use of a m<span class="_ _4"></span>yriad little techniques applied</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws164">through a painstakingly acquired sense of “cleanliness.<span class="_ _0"></span>” <span class="_ _4"></span>This “code-sense” is the key<span class="_ _0"></span>.</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws165">Some of us are born with it. Some of us hav<span class="_ _4"></span>e to ﬁght to acquire it. Not only does it let us</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 lsd ws166">see whether code is good or bad<span class="_ _0"></span>, but it also shows us the strate<span class="_ _4"></span>gy for applying our disci-</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">pline to transform bad code into clean code.</div><div class="t m0 x2b h14 y1be ff8 fs3 fc0 sc0 ls0 wse2">A programmer without “code-sense” can look at a messy module and reco<span class="_ _4"></span>gnize the</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 lsd ws167">mess but will ha<span class="_ _4"></span>ve no idea w<span class="_ _4"></span>hat to do about it. <span class="_ _4"></span>A programmer <span class="ffa ls0 ws0">with<span class="ff8 ws168"> “code-sense” will look</span></span></div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws169">at a messy module and see options and variations. <span class="_ _1"></span>The “code-sense” will help that pro-</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws16a">grammer choose the best variation and guide him or her to plot a sequence of beha<span class="_ _4"></span>vior</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">preserving transfor<span class="_ _8"></span>mations to get from here to there.</div><div class="t m0 x2b h14 y208 ff8 fs3 fc0 sc0 ls0 ws3f">In short, a programmer who writes clean code is an artist who can take a b<span class="_ _4"></span>lank screen</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 lsc ws3f">through a series of transformations until it is an elegantly coded system.</div><div class="t m0 xd h11 y2d6 ff1 fs7 fc0 sc0 ls0 ws0">What Is Clean Code?</div><div class="t m0 xd h14 y2d7 ff8 fs3 fc0 sc0 ls0 ws16b">There are probabl<span class="_ _4"></span>y as man<span class="_ _4"></span>y deﬁnitions as there are programmers. So I asked some very</div><div class="t m0 xd h14 y2d8 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ell-kno<span class="_ _4"></span>wn and deeply e<span class="_ _4"></span>xperienced programmers what they thought. </div><div class="t m0 xd hd y2d9 ffe fs3 fc0 sc0 ls0 ws16c">Bjar<span class="_ _8"></span>ne Stroustrup<span class="_ _4"></span>, inv<span class="_ _4"></span>entor of<span class="_ _6"></span> C++ </div><div class="t m0 xd hd y2da ffe fs3 fc0 sc0 ls0 ws0">and author of<span class="_ _5"></span> <span class="fff">The C++ Pro<span class="_ _8"></span>gramming </span></div><div class="t m0 xd hd y2db fff fs3 fc0 sc0 ls0 ws0">Language</div><div class="t m0 x2b h29 y2dc ffa fsf fc0 sc0 ls0 ws16d">I like my code to be ele<span class="_ _4"></span>gant and efﬁcient. <span class="_ _1"></span>The</div><div class="t m0 x2b h29 y2dd ffa fsf fc0 sc0 ls0 ws16e">logic should be str<span class="_ _1"></span>aightforwar<span class="_ _1"></span>d to make it hard</div><div class="t m0 x2b h29 y2de ffa fsf fc0 sc0 ls14 ws16f">for bugs to hide<span class="_ _4"></span>, the dependencies minimal to</div><div class="t m0 x2b h29 y2df ffa fsf fc0 sc0 ls0 ws170">ease maintenance, err<span class="_ _1"></span>or handling complete</div><div class="t m0 x2b h29 y2e0 ffa fsf fc0 sc0 ls0 ws171">accor<span class="_ _4"></span>ding to an articulated str<span class="_ _4"></span>ategy<span class="_ _4"></span>, and per-</div><div class="t m0 x2b h29 y2e1 ffa fsf fc0 sc0 ls0 ws172">formance c<span class="_ _4"></span>lose to optimal so as not to tempt</div><div class="t m0 x2b h29 y2e2 ffa fsf fc0 sc0 ls0 ws173">people to make the code messy with unprinci-</div><div class="t m0 x2b h29 y2e3 ffa fsf fc0 sc0 ls0 ws174">pled optimizations. Clean code does one thing</div><div class="t m0 x2b h29 y2e4 ffa fsf fc0 sc0 ls0 ws0">well.</div><div class="t m0 x2b h14 y2e5 ff8 fs3 fc0 sc0 lsc ws175">Bjarne uses the word “ele<span class="_ _4"></span>gant.<span class="_ _1"></span>” <span class="_ _4"></span>That’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y2e6 ff8 fs3 fc0 sc0 ls0 ws176">quite a w<span class="_ _4"></span>ord! <span class="_ _4"></span>The dictionary in my MacBook</div><div class="t m0 x1b h21 y2e7 ff8 fsc fc0 sc0 ls0 ws0">®</div><div class="t m0 xd h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws177">pro<span class="_ _4"></span>vides the follo<span class="_ _4"></span>wing deﬁnitions: <span class="ffa ws0">pleasingly</span></div><div class="t m0 xd h14 y2e9 ffa fs3 fc0 sc0 ls0 ws178">gr<span class="_ _4"></span>aceful and stylish in appear<span class="_ _4"></span>ance or manner<span class="_ _4"></span>; pleasingly ingenious and simple<span class="_ _4"></span>. <span class="ff8">Notice the</span></div><div class="t m0 xd h14 y2ea ff8 fs3 fc0 sc0 ls0 ws179">emphasis on the w<span class="_ _4"></span>ord “pleasing.<span class="_ _1"></span>” <span class="_ _4"></span>Apparentl<span class="_ _4"></span>y Bjar<span class="_ _8"></span>ne thinks that clean code is <span class="ffa ws0">pleasing<span class="_ _a"> </span><span class="ff8">to</span></span></div><div class="t m0 xd h14 y2eb ff8 fs3 fc0 sc0 ls0 wsce">read. Reading it should make y<span class="_ _4"></span>ou smile the wa<span class="_ _4"></span>y a w<span class="_ _4"></span>ell-crafted music box or w<span class="_ _4"></span>ell-designed</div><div class="t m0 xd h14 y2ec ff8 fs3 fc0 sc0 ls0 ws0">car w<span class="_ _4"></span>ould.</div><div class="t m0 x2b h14 y2ed ff8 fs3 fc0 sc0 ls0 ws17a">Bjarne also mentions efﬁciency—<span class="ffa ws0">twice</span>. P<span class="_ _1"></span>erhaps this should not sur<span class="_ _8"></span>prise us coming</div><div class="t m0 xd h14 y2ee ff8 fs3 fc0 sc0 lsd ws17b">from the in<span class="_ _4"></span>ventor of C++; but I think there’<span class="_ _3"></span>s more to it than the sheer desire for speed.</div><div class="t m0 xd h14 y2ef ff8 fs3 fc0 sc0 lsc ws17c">W<span class="_ _0"></span>asted cycles are inelegant, they are not pleasing. <span class="_ _0"></span>And now note the w<span class="_ _1"></span>ord that Bjar<span class="_ _8"></span>ne uses</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:420.728010px;width:109.667000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf27" class="pf w1 h2" data-page-no="27"><div class="pc pc27 w1 h2"><img class="bi x37 y2f0 w6 h2a" alt="" src="bg27.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">8<span class="_ _1b"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 lsc ws17d">to describe the consequence of that inelegance. He uses the w<span class="_ _1"></span>ord “tempt.<span class="_ _1"></span>” <span class="_ _4"></span>There is a deep</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws17e">truth here. Bad code <span class="ffa ws0">tempts<span class="_ _a"> </span></span>the mess to g<span class="_ _8"></span>ro<span class="_ _4"></span>w! When others change bad code, the<span class="_ _4"></span>y tend to</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">make it w<span class="_ _1"></span>orse. </div><div class="t m0 x2b h14 y1fb ff8 fs3 fc0 sc0 ls0 ws17f">Pragmatic Da<span class="_ _4"></span>ve <span class="_ _1"></span>Thomas and <span class="_ _4"></span>Andy Hunt said this a different w<span class="_ _4"></span>a<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _1"></span>They used the meta-</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws180">phor of broken windo<span class="_ _1"></span>ws.</div><div class="t m0 x15 h21 y2f1 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x7 h14 y1bd ff8 fs3 fc0 sc0 lsd ws181">A building with broken windo<span class="_ _1"></span>ws looks like nobody cares about</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws182">it. So other people stop caring. <span class="_ _1"></span>They allo<span class="_ _4"></span>w more windo<span class="_ _4"></span>ws to become broken. Eventuall<span class="_ _4"></span>y</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 lsc ws183">they acti<span class="_ _4"></span>vel<span class="_ _4"></span>y break them. <span class="_ _4"></span>They despoil the facade with grafﬁti and allo<span class="_ _4"></span>w garbage to col-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">lect. One broken windo<span class="_ _1"></span>w star<span class="_ _8"></span>ts the process tow<span class="_ _4"></span>ard deca<span class="_ _4"></span>y<span class="_ _0"></span>.</div><div class="t m0 x2b h14 y207 ff8 fs3 fc0 sc0 ls0 wsb0">Bjarne also mentions that er<span class="_ _8"></span>ror handing should be complete. <span class="_ _4"></span>This goes to the disci-</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws184">pline of pa<span class="_ _4"></span>ying attention to details. <span class="_ _4"></span>Abbre<span class="_ _4"></span>viated er<span class="_ _8"></span>ror handling is just one wa<span class="_ _4"></span>y that pro-</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws185">grammers gloss o<span class="_ _4"></span>ver details. Memory leaks are another, race conditions still another<span class="_ _1"></span>.</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws186">Inconsistent naming yet another<span class="_ _1"></span>. <span class="_ _1"></span>The upshot is that clean code exhibits close attention to</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws0">detail.</div><div class="t m0 x2b h14 y20b ff8 fs3 fc0 sc0 ls0 wsdb">Bjarne closes with the asser<span class="_ _8"></span>tion that clean code does one thing well. It is no accident</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws103">that there are so many principles of softw<span class="_ _1"></span>are design that can be boiled down to this simple</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 ls0 ws13b">admonition. <span class="_ _4"></span>Writer after writer has tried to communicate this thought. Bad code tries to do</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 ws187">too much, it has muddled intent and ambiguity of pur<span class="_ _8"></span>pose. Clean code is <span class="ffa ws0">focused</span>. Each</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 ws188">function, each class, each module exposes a single-minded attitude that remains entirel<span class="_ _4"></span>y</div><div class="t m0 xd h14 y220 ff8 fs3 fc0 sc0 ls0 ws0">undistracted<span class="_ _1"></span>, and unpolluted<span class="_ _4"></span>, b<span class="_ _4"></span>y the sur<span class="_ _8"></span>rounding details.</div><div class="t m0 xd hd y222 ffe fs3 fc0 sc0 ls0 ws16c">Grady Booch, author of<span class="_ _5"></span> <span class="fff ws0">Object</span></div><div class="t m0 xd hd y223 fff fs3 fc0 sc0 ls0 ws0">Oriented Analysis and Design with </div><div class="t m0 xd hd y2f2 fff fs3 fc0 sc0 ls0 ws0">Applica<span class="_ _4"></span>tions</div><div class="t m0 x2b h29 y2f3 ffa fsf fc0 sc0 ls0 ws189">Clean code is simple and dir<span class="_ _4"></span>ect. Clean code</div><div class="t m0 x2b h29 y2f4 ffa fsf fc0 sc0 ls0 ws18a">r<span class="_ _4"></span>eads <span class="_ _1"></span>like well-written pr<span class="_ _4"></span>ose. Clean code never</div><div class="t m0 x2b h29 y2f5 ffa fsf fc0 sc0 ls14 ws18b">obscur<span class="_ _4"></span>es the designer’<span class="_ _0"></span>s intent but r<span class="_ _4"></span>ather is full</div><div class="t m0 x2b h29 y2f6 ffa fsf fc0 sc0 ls0 ws18c">of crisp abstr<span class="_ _1"></span>actions and str<span class="_ _4"></span>aightforwar<span class="_ _4"></span>d lines</div><div class="t m0 x2b h29 y2f7 ffa fsf fc0 sc0 ls0 ws0">of contr<span class="_ _4"></span>ol.</div><div class="t m0 x2b h14 y2f8 ff8 fs3 fc0 sc0 ls0 ws18d">Grady makes some of the same points as</div><div class="t m0 xd h14 y2f9 ff8 fs3 fc0 sc0 ls11 ws18e">Bjarne, but he takes a <span class="ffa ls0 ws0">r<span class="_ _4"></span>eadability<span class="_ _a"> </span><span class="ff8 ws107">perspectiv<span class="_ _4"></span>e. I</span></span></div><div class="t m0 xd h14 y2fa ff8 fs3 fc0 sc0 ls0 ws18f">especially lik<span class="_ _4"></span>e his view that clean code should</div><div class="t m0 xd h14 y2fb ff8 fs3 fc0 sc0 ls0 ws190">read like w<span class="_ _4"></span>ell-written prose. <span class="_ _1"></span>Think back on a</div><div class="t m0 xd h14 y2fc ff8 fs3 fc0 sc0 ls0 ws191">really good book that y<span class="_ _4"></span>ou’<span class="_ _1"></span>ve read. Remember ho<span class="_ _4"></span>w the w<span class="_ _4"></span>ords disappeared to be replaced</div><div class="t m0 xd h14 y2fd ff8 fs3 fc0 sc0 ls0 ws192">by images! It w<span class="_ _1"></span>as like watching a mo<span class="_ _1"></span>vie, wasn’<span class="_ _1"></span>t it? Better! <span class="_ _1"></span>Y<span class="_ _3"></span>ou saw the characters, y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y2fe ff8 fs3 fc0 sc0 ls0 ws0">heard the sounds, you e<span class="_ _4"></span>xperienced the pathos and the humor<span class="_ _4"></span>.</div><div class="t m0 x2b h14 y2ff ff8 fs3 fc0 sc0 ls0 ws193">Reading clean code will ne<span class="_ _4"></span>ver be quite like reading <span class="ffa">Lor<span class="_ _4"></span>d of the Rings<span class="ff8">. Still, the liter-</span></span></div><div class="t m0 xd h14 y300 ff8 fs3 fc0 sc0 ls0 ws194">ary metaphor is not a bad one. Like a good no<span class="_ _4"></span>vel, clean code should clearl<span class="_ _4"></span>y expose the ten-</div><div class="t m0 xd h14 y301 ff8 fs3 fc0 sc0 lsd ws195">sions in the problem to be solv<span class="_ _4"></span>ed. It should build those tensions to a climax and then giv<span class="_ _4"></span>e</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>http://www<span class="_ _0"></span>.pragmaticprogrammer.com/booksellers/2004-12.html</div><a class="l" href="http://www.pragmaticprogrammer.com/booksellers/2004-12.html"><div class="d m1" style="border-style:none;position:absolute;left:90.830700px;bottom:67.249110px;width:182.684300px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf28" class="pf w1 h2" data-page-no="28"><div class="pc pc28 w1 h2"><img class="bi x37 y303 w9 h2b" alt="" src="bg28.png"/><div class="t m0 x35 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">9<span class="_ _10"></span><span class="ff1">The <span class="_ _1"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws196">the reader that “<span class="_ _0"></span>Aha! Of course!” as the issues and tensions are resolved in the rev<span class="_ _4"></span>elation</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">of an ob<span class="_ _4"></span>vious solution. </div><div class="t m0 x2b h14 y1fa ff8 fs3 fc0 sc0 ls0 ws197">I ﬁnd Grady’<span class="_ _2"></span>s use of the phrase “crisp abstraction” to be a fascinating oxymoron!</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws198">After all the w<span class="_ _4"></span>ord “crisp” is nearly a synon<span class="_ _4"></span>ym for “concrete.<span class="_ _1"></span>” My MacBook’<span class="_ _2"></span>s dictionary</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws199">holds the follo<span class="_ _4"></span>wing deﬁnition of “crisp”: <span class="ffa">briskly decisive and matter<span class="_ _4"></span>-of-fact, without hesi-</span></div><div class="t m0 xd h14 y1be ffa fs3 fc0 sc0 ls0 ws19a">tation or unnecessary detail. <span class="ff8">Despite this seeming juxtaposition of meaning, the w<span class="_ _4"></span>ords</span></div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws95">car<span class="_ _8"></span>ry a pow<span class="_ _1"></span>erful message. Our code should be matter-of-fact as opposed to speculativ<span class="_ _4"></span>e.</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws19b">It <span class="_ _3"></span>should contain only what is necessary<span class="_ _0"></span>. Our readers should perceiv<span class="_ _4"></span>e us to hav<span class="_ _4"></span>e been</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">decisiv<span class="_ _4"></span>e.</div><div class="t m0 xd hd y19e ffe fs3 fc0 sc0 ls0 ws0">“Big” Da<span class="_ _4"></span>ve Thomas, f<span class="_ _4"></span>ounder </div><div class="t m0 xd hd y19f ffe fs3 fc0 sc0 ls0 ws19c">of<span class="_ _5"></span> OTI, godfather of<span class="_ _5"></span> the </div><div class="t m0 xd hd y1a0 ffe fs3 fc0 sc0 ls0 ws0">Eclipse strategy </div><div class="t m0 x2b h29 y304 ffa fsf fc0 sc0 ls0 ws19d">Clean code can be r<span class="_ _4"></span>ead, and enhanced by a</div><div class="t m0 x2b h29 y305 ffa fsf fc0 sc0 ls0 ws19e">developer other than its original author<span class="_ _0"></span>. It has</div><div class="t m0 x2b h29 y306 ffa fsf fc0 sc0 ls0 ws19f">unit and acceptance tests. It has meaningful</div><div class="t m0 x2b h29 y307 ffa fsf fc0 sc0 ls0 ws1a0">names. It pr<span class="_ _4"></span>ovides one w<span class="_ _4"></span>ay r<span class="_ _4"></span>ather than many</div><div class="t m0 x2b h29 y308 ffa fsf fc0 sc0 ls0 ws1a1">ways f<span class="_ _4"></span>or doing one thing. It has minimal depen-</div><div class="t m0 x2b h29 y309 ffa fsf fc0 sc0 ls0 ws1a2">dencies, whic<span class="_ _4"></span>h are explicitl<span class="_ _4"></span>y deﬁned, and pr<span class="_ _4"></span>o-</div><div class="t m0 x2b h29 y30a ffa fsf fc0 sc0 ls0 ws1a3">vides a clear and minimal <span class="_ _1"></span>API. Code should be</div><div class="t m0 x2b h29 y30b ffa fsf fc0 sc0 ls0 ws1a4">liter<span class="_ _4"></span>ate since depending on the language<span class="_ _4"></span>, not all</div><div class="t m0 x2b h29 y30c ffa fsf fc0 sc0 ls0 ws26">necessary information can be expr<span class="_ _1"></span>essed clear<span class="_ _4"></span>ly</div><div class="t m0 x2b h29 y30d ffa fsf fc0 sc0 ls0 ws0">in code alone.</div><div class="t m0 x2b h14 y30e ff8 fs3 fc0 sc0 ls0 ws1a5">Big Da<span class="_ _4"></span>ve shares Grady’<span class="_ _2"></span>s desire for readabil-</div><div class="t m0 xd h14 y30f ff8 fs3 fc0 sc0 lsd ws1a6">ity<span class="_ _0"></span>, but with an impor<span class="_ _8"></span>tant twist. Dav<span class="_ _4"></span>e asserts that</div><div class="t m0 xd h14 y310 ff8 fs3 fc0 sc0 ls0 ws1a7">clean code makes it easy for <span class="ffa ws0">other<span class="_ _b"> </span></span><span class="lsd wsd0">people to enhance it. <span class="_ _4"></span>This may seem ob<span class="_ _1"></span>vious, but it can-</span></div><div class="t m0 xd h14 y311 ff8 fs3 fc0 sc0 ls0 ws1a8">not be o<span class="_ _4"></span>veremphasized. <span class="_ _1"></span>There is, after all, a difference betw<span class="_ _1"></span>een code that is easy to read</div><div class="t m0 xd h14 y2ba ff8 fs3 fc0 sc0 ls0 ws0">and code that is easy to change. </div><div class="t m0 x2b h14 y312 ff8 fs3 fc0 sc0 ls0 ws130">Da<span class="_ _4"></span>ve ties cleanliness to tests! <span class="_ _1"></span>T<span class="_ _0"></span>en years ago this w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve raised a lot of ey<span class="_ _4"></span>ebro<span class="_ _4"></span>ws.</div><div class="t m0 xd h14 y313 ff8 fs3 fc0 sc0 ls0 ws1a9">But the discipline of T<span class="_ _0"></span>est Driv<span class="_ _4"></span>en Dev<span class="_ _4"></span>elopment has made a profound impact upon our</div><div class="t m0 xd h14 y314 ff8 fs3 fc0 sc0 ls0 ws1aa">industry and has become one of our most fundamental disciplines. Dav<span class="_ _4"></span>e is right. Code,</div><div class="t m0 xd h14 y315 ff8 fs3 fc0 sc0 lsc ws1ab">without tests, is not clean. No matter ho<span class="_ _4"></span>w elegant it is, no matter ho<span class="_ _1"></span>w readable and acces-</div><div class="t m0 xd h14 y22a ff8 fs3 fc0 sc0 ls0 ws0">sible, if it hath not tests, it be unclean. </div><div class="t m0 x2b h14 y316 ff8 fs3 fc0 sc0 ls0 ws1ac">Da<span class="_ _4"></span>ve uses the w<span class="_ _4"></span>ord <span class="ffa ws0">minimal<span class="_ _15"> </span></span>twice. <span class="_ _1"></span>Apparently he v<span class="_ _4"></span>alues code that is small, rather</div><div class="t m0 xd h14 y317 ff8 fs3 fc0 sc0 ls0 ws1ad">than code that is large. Indeed<span class="_ _0"></span>, this has been a common refrain throughout software litera-</div><div class="t m0 xd h14 y318 ff8 fs3 fc0 sc0 ls0 ws0">ture since its inception. Smaller is better<span class="_ _1"></span>. </div><div class="t m0 x2b h14 y319 ff8 fs3 fc0 sc0 ls0 ws1c">Da<span class="_ _4"></span>ve also sa<span class="_ _4"></span>ys that code should be <span class="ffa ws0">liter<span class="_ _4"></span>ate<span class="ff8 ws1c">. <span class="_ _1"></span>This is a soft reference to Knuth’<span class="_ _2"></span>s <span class="ffa ws0">literate</span></span></span></div><div class="t m0 xd h1d y31a ffa fs3 fc0 sc0 ls0 ws0">pr<span class="_ _4"></span>o<span class="_ _4"></span>gr<span class="_ _4"></span>amming.</div><div class="t m0 x28 h21 y2ed ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x39 h14 y31b ff8 fs3 fc0 sc0 ls0 ws180">The upshot is that the code should be composed in such a form as to make</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls0 ws0">it readable b<span class="_ _4"></span>y humans. </div><div class="t m0 xd h25 y31d ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>[Knuth92].</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf29" class="pf w1 h2" data-page-no="29"><div class="pc pc29 w1 h2"><img class="bi x3d y31e wa h2c" alt="" src="bg29.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">10<span class="_ _1c"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 xd hd y194 ffe fs3 fc0 sc0 ls0 ws0">Michael F<span class="_ _1"></span>ea<span class="_ _8"></span>thers, author of<span class="_ _8"></span> <span class="fff">Working</span></div><div class="t m0 xd hd y195 fff fs3 fc0 sc0 ls0 ws0">Effectively with Legac<span class="_ _4"></span>y Code</div><div class="t m0 x2b h29 ydf ffa fsf fc0 sc0 ls0 ws1ae">I could list all of the qualities that I notice in</div><div class="t m0 x2b h29 y31f ffa fsf fc0 sc0 ls14 ws1af">clean code<span class="_ _4"></span>, but there is one o<span class="_ _4"></span>ver<span class="_ _4"></span>ar<span class="_ _4"></span>ching quality</div><div class="t m0 x2b h29 y320 ffa fsf fc0 sc0 ls0 ws1b0">that leads to all of them. Clean code always</div><div class="t m0 x2b h29 y321 ffa fsf fc0 sc0 ls0 ws1b1">looks like it was written by someone w<span class="_ _4"></span>ho cares.</div><div class="t m0 x2b h29 y322 ffa fsf fc0 sc0 ls0 ws1b2">Ther<span class="_ _4"></span>e is nothing obvious that you can do to</div><div class="t m0 x2b h29 y323 ffa fsf fc0 sc0 ls0 ws1b3">make it better<span class="_ _0"></span>. <span class="_ _1"></span>All of those things wer<span class="_ _4"></span>e thought</div><div class="t m0 x2b h29 y324 ffa fsf fc0 sc0 ls0 ws1b4">about by the code’<span class="_ _2"></span>s author<span class="_ _0"></span>, and if you try to</div><div class="t m0 x2b h29 y325 ffa fsf fc0 sc0 ls0 ws1b5">imagine impr<span class="_ _1"></span>ovements, you’<span class="_ _0"></span>re led bac<span class="_ _4"></span>k to</div><div class="t m0 x2b h29 y326 ffa fsf fc0 sc0 ls0 ws1b6">wher<span class="_ _1"></span>e you are, sitting in appr<span class="_ _1"></span>eciation of the</div><div class="t m0 x2b h29 y327 ffa fsf fc0 sc0 ls0 ws1b7">code someone left for you—code left by some-</div><div class="t m0 x2b h29 y328 ffa fsf fc0 sc0 ls0 ws0">one who car<span class="_ _1"></span>es deeply about the cr<span class="_ _4"></span>aft.</div><div class="t m0 x2b h14 y329 ff8 fs3 fc0 sc0 ls0 ws1b8">One w<span class="_ _4"></span>ord: care. <span class="_ _4"></span>That’<span class="_ _2"></span>s reall<span class="_ _4"></span>y the topic of</div><div class="t m0 xd h14 y32a ff8 fs3 fc0 sc0 ls0 ws1b9">this book. P<span class="_ _4"></span>erhaps an appropriate subtitle</div><div class="t m0 xd h14 y32b ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ould be <span class="ffa">How to Car<span class="_ _1"></span>e for Code<span class="ff8">.</span></span></div><div class="t m0 x2b h14 y32c ff8 fs3 fc0 sc0 ls0 ws1ba">Michael hit it on the head. Clean code is</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls0 ws1bb">code that has been taken care of. Someone has taken the time to k<span class="_ _4"></span>eep it simple and orderly<span class="_ _0"></span>.</div><div class="t m0 xd h14 y32e ff8 fs3 fc0 sc0 ls0 ws0">They ha<span class="_ _1"></span>ve paid appropriate attention to details. <span class="_ _4"></span>They ha<span class="_ _4"></span>ve cared.</div><div class="t m0 xd hd y32f ffe fs3 fc0 sc0 ls0 ws1bc">R<span class="_ _4"></span>on Jef<span class="_ _8"></span>fries, author of<span class="_ _5"></span> <span class="fff">Extreme Prog<span class="_ _8"></span>ramming </span></div><div class="t m0 xd hd y330 fff fs3 fc0 sc0 ls0 ws0">Installed<span class="ffe"> and </span>Extreme Programming </div><div class="t m0 xd hd y331 fff fs3 fc0 sc0 ls0 ws0">Adventures in C#</div><div class="t m0 xd h14 y332 ff8 fs3 fc0 sc0 lsc ws1bd">Ron began his career pro<span class="_ _4"></span>gramming in F<span class="_ _4"></span>or<span class="_ _8"></span>tran at</div><div class="t m0 xd h14 y333 ff8 fs3 fc0 sc0 ls0 ws63">the Strategic <span class="_ _1"></span>Air Command and has written code in</div><div class="t m0 xd h14 y334 ff8 fs3 fc0 sc0 ls0 ws1be">almost ev<span class="_ _4"></span>ery language and on almost every</div><div class="t m0 xd h14 y335 ff8 fs3 fc0 sc0 ls0 ws0">machine. It pa<span class="_ _4"></span>ys to consider his w<span class="_ _4"></span>ords carefully<span class="_ _0"></span>.</div><div class="t m0 x2b h29 y336 ffa fsf fc0 sc0 ls0 ws1bf">In r<span class="_ _4"></span>ecent years I begin, and near<span class="_ _4"></span>ly end, with Bec<span class="_ _4"></span>k’<span class="_ _0"></span>s</div><div class="t m0 x2b h29 y337 ffa fsf fc0 sc0 ls0 ws0">rules of simple code. In priority or<span class="_ _4"></span>der<span class="_ _0"></span>, simple code:</div><div class="t m0 x2b h29 y338 ffa fsf fc0 sc0 ls0 ws0">•<span class="_ _1d"> </span>Runs all the tests;</div><div class="t m0 x2b h29 y339 ffa fsf fc0 sc0 ls0 ws0">•<span class="_ _1d"> </span>Contains no duplication;</div><div class="t m0 x2b h29 y33a ffa fsf fc0 sc0 ls0 ws0">•<span class="_ _1d"> </span>Expr<span class="_ _4"></span>esses all the design ideas that are in the </div><div class="t m0 x3e h29 y33b ffa fsf fc0 sc0 ls0 ws0">system;</div><div class="t m0 x2b h29 y33c ffa fsf fc0 sc0 ls0 ws1c0">•<span class="_ _1d"> </span>Minimizes the number of entities such as c<span class="_ _4"></span>lasses,</div><div class="t m0 x3e h29 y33d ffa fsf fc0 sc0 ls0 ws0">methods, functions, and the like.</div><div class="t m0 x3f h29 y33e ffa fsf fc0 sc0 ls0 ws1c1">Of these, I f<span class="_ _4"></span>ocus mostly on duplication. <span class="_ _4"></span>When the same thing is done o<span class="_ _4"></span>ver and over<span class="_ _0"></span>,</div><div class="t m0 x2b h29 y33f ffa fsf fc0 sc0 ls0 ws1c2">it’<span class="_ _2"></span>s a sign that there is an idea in our mind that is not well r<span class="_ _1"></span>epresented in the code<span class="_ _4"></span>. I try to</div><div class="t m0 x2b h29 y340 ffa fsf fc0 sc0 ls0 ws0">ﬁgur<span class="_ _4"></span>e out what it is. <span class="_ _1"></span>Then I try to express that idea mor<span class="_ _1"></span>e clear<span class="_ _4"></span>ly<span class="_ _4"></span>.</div><div class="t m0 x3f h29 y341 ffa fsf fc0 sc0 ls0 ws1c3">Expr<span class="_ _4"></span>essiveness to me includes meaningful names, and I am likely to c<span class="_ _4"></span>hange the</div><div class="t m0 x2b h29 y342 ffa fsf fc0 sc0 ls0 ws1c4">names of things sever<span class="_ _1"></span>al times befor<span class="_ _4"></span>e I settle in. <span class="_ _4"></span>W<span class="_ _4"></span>ith modern coding tools such as Ec<span class="_ _4"></span>lipse,</div><div class="t m0 x2b h29 y343 ffa fsf fc0 sc0 ls0 ws1c5">r<span class="_ _4"></span>enaming is quite inexpensive, so it doesn’<span class="_ _1"></span>t tr<span class="_ _4"></span>ouble me to c<span class="_ _4"></span>hange. Expr<span class="_ _4"></span>essiveness goes</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2a" class="pf w1 h2" data-page-no="2a"><div class="pc pc2a w1 h2"><img class="bi x40 y344 w8 h2d" alt="" src="bg2a.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">11<span class="_ _10"></span><span class="ff1">The <span class="_ _1"></span>T<span class="_ _0"></span>otal Cost of Owning a Mess</span></div><div class="t m0 x2b h29 y345 ffa fsf fc0 sc0 ls0 ws1c6">beyond names, ho<span class="_ _4"></span>wever<span class="_ _0"></span>. I also look at w<span class="_ _4"></span>hether an object or method is doing more than one</div><div class="t m0 x2b h29 y346 ffa fsf fc0 sc0 ls0 ws1c7">thing. If it’<span class="_ _2"></span>s an object, it pr<span class="_ _4"></span>obab<span class="_ _4"></span>ly needs to be br<span class="_ _4"></span>oken into two or mor<span class="_ _4"></span>e objects. If it’<span class="_ _0"></span>s a</div><div class="t m0 x2b h29 y347 ffa fsf fc0 sc0 ls0 ws1c8">method, I will always use the Extr<span class="_ _1"></span>act Method refactoring on it, r<span class="_ _1"></span>esulting in one method</div><div class="t m0 x2b h29 y348 ffa fsf fc0 sc0 ls0 ws0">that says mor<span class="_ _4"></span>e clear<span class="_ _4"></span>ly what it does, and some submethods saying ho<span class="_ _4"></span>w it is done.</div><div class="t m0 x3f h29 y349 ffa fsf fc0 sc0 ls0 ws1c9">Duplication and expr<span class="_ _4"></span>essiveness take me a very long way into what I consider c<span class="_ _4"></span>lean</div><div class="t m0 x2b h29 y34a ffa fsf fc0 sc0 ls0 ws1ca">code, and impr<span class="_ _1"></span>oving dirty code with just these two things in mind can make a huge dif<span class="_ _4"></span>fer-</div><div class="t m0 x2b h29 y34b ffa fsf fc0 sc0 ls0 ws1cb">ence. <span class="_ _1"></span>Ther<span class="_ _4"></span>e is, howe<span class="_ _4"></span>ver<span class="_ _0"></span>, one other thing that I’m awar<span class="_ _4"></span>e of doing, whic<span class="_ _4"></span>h is a bit harder to</div><div class="t m0 x2b h29 y34c ffa fsf fc0 sc0 ls0 ws0">explain.</div><div class="t m0 x3f h29 y34d ffa fsf fc0 sc0 ls0 ws1cc">After years of doing this wor<span class="_ _1"></span>k, it seems to me that all pro<span class="_ _4"></span>gr<span class="_ _4"></span>ams are made up of very</div><div class="t m0 x2b h29 y34e ffa fsf fc0 sc0 ls0 ws1cd">similar elements. One example is <span class="_ _1"></span>“ﬁnd things in a collection.<span class="_ _3"></span>” <span class="_ _4"></span>Whether we have a data-</div><div class="t m0 x2b h29 y34f ffa fsf fc0 sc0 ls0 ws1ce">base of employee r<span class="_ _1"></span>ecords, or a hash map of keys and values, or an arr<span class="_ _1"></span>ay of items of some</div><div class="t m0 x2b h29 y350 ffa fsf fc0 sc0 ls0 ws1cf">kind, we often ﬁnd ourselves w<span class="_ _4"></span>anting a particular item fr<span class="_ _4"></span>om that collection. <span class="_ _4"></span>When I ﬁnd</div><div class="t m0 x2b h29 y351 ffa fsf fc0 sc0 ls0 ws1d0">that happening, I will often wr<span class="_ _1"></span>ap the particular implementation in a more a<span class="_ _4"></span>bstract method</div><div class="t m0 x2b h29 y352 ffa fsf fc0 sc0 ls0 ws0">or class. <span class="_ _1"></span>That gives me a couple of inter<span class="_ _4"></span>esting advantages.</div><div class="t m0 x3f h29 y353 ffa fsf fc0 sc0 ls14 ws1d1">I can implement the functionality now with something simple<span class="_ _4"></span>, say a hash map, but</div><div class="t m0 x2b h29 y354 ffa fsf fc0 sc0 ls0 ws1d2">since now all the r<span class="_ _1"></span>efer<span class="_ _4"></span>ences to that searc<span class="_ _4"></span>h are co<span class="_ _4"></span>ver<span class="_ _4"></span>ed by my little abstr<span class="_ _1"></span>action, I can</div><div class="t m0 x2b h29 y355 ffa fsf fc0 sc0 ls0 ws1d3">change the implementation an<span class="_ _4"></span>y time I want. I can go f<span class="_ _4"></span>orwar<span class="_ _4"></span>d quickl<span class="_ _4"></span>y while pr<span class="_ _4"></span>eserving my</div><div class="t m0 x2b h29 y356 ffa fsf fc0 sc0 ls0 ws0">ability to c<span class="_ _4"></span>hange later<span class="_ _0"></span>.</div><div class="t m0 x3f h29 y357 ffa fsf fc0 sc0 ls0 ws1d4">In addition, the collection abstr<span class="_ _1"></span>action often calls my attention to what’<span class="_ _2"></span>s <span class="_ _4"></span>“r<span class="_ _4"></span>eally”</div><div class="t m0 x2b h29 y358 ffa fsf fc0 sc0 ls0 ws1d5">going on, and keeps me fr<span class="_ _1"></span>om running down the path of implementing arbitr<span class="_ _4"></span>ary collection</div><div class="t m0 x2b h29 y359 ffa fsf fc0 sc0 ls0 ws0">behavior when all I r<span class="_ _1"></span>eally need is a few fair<span class="_ _1"></span>ly simple ways of ﬁnding what I w<span class="_ _4"></span>ant.</div><div class="t m0 x3f h29 y35a ffa fsf fc0 sc0 ls14 ws1d6">Reduced duplication, high expr<span class="_ _4"></span>essiveness, and earl<span class="_ _4"></span>y building of simple abstr<span class="_ _4"></span>actions.</div><div class="t m0 x2b h29 y35b ffa fsf fc0 sc0 ls0 ws0">That’<span class="_ _2"></span>s what makes clean code f<span class="_ _4"></span>or me.</div><div class="t m0 x2b h14 y330 ff8 fs3 fc0 sc0 ls0 ws1d7">Here, in a fe<span class="_ _4"></span>w shor<span class="_ _8"></span>t parag<span class="_ _8"></span>raphs, Ron has summarized the contents of this book. No</div><div class="t m0 xd h14 y331 ff8 fs3 fc0 sc0 ls0 ws0">duplication, one thing, expressi<span class="_ _4"></span>veness, tin<span class="_ _4"></span>y abstractions. Everything is there. </div><div class="t m0 xd hd y35c ffe fs3 fc0 sc0 ls0 ws0">War<span class="_ _4"></span>d Cunningham, inv<span class="_ _4"></span>entor of<span class="_ _6"></span> Wiki, </div><div class="t m0 xd hd y35d ffe fs3 fc0 sc0 ls0 ws0">in<span class="_ _4"></span>ventor of<span class="_ _5"></span> Fit, coinventor of<span class="_ _5"></span> eXtreme </div><div class="t m0 xd hd y35e ffe fs3 fc0 sc0 ls0 ws0">Programming<span class="_ _4"></span>. Motive f<span class="_ _4"></span>orce behind </div><div class="t m0 xd hd y35f ffe fs3 fc0 sc0 ls0 ws0">Design Patter<span class="_ _8"></span>ns. Smalltalk and OO </div><div class="t m0 xd hd y360 ffe fs3 fc0 sc0 ls0 ws0">thought leader<span class="_ _0"></span>. The godfather of<span class="_ _5"></span> all </div><div class="t m0 xd hd y361 ffe fs3 fc0 sc0 ls0 ws0">those who care about code.</div><div class="t m0 x2b h29 y362 ffa fsf fc0 sc0 ls0 ws1d8">Y<span class="_ _0"></span>ou know you ar<span class="_ _4"></span>e wor<span class="_ _4"></span>king on clean code when eac<span class="_ _4"></span>h</div><div class="t m0 x2b h29 y363 ffa fsf fc0 sc0 ls0 ws1d9">r<span class="_ _4"></span>outine you r<span class="_ _4"></span>ead turns out to be pretty muc<span class="_ _4"></span>h what</div><div class="t m0 x2b h29 y364 ffa fsf fc0 sc0 ls0 ws1da">you expected. <span class="_ _0"></span>Y<span class="_ _1"></span>ou can call it beautiful code when</div><div class="t m0 x2b h29 y365 ffa fsf fc0 sc0 ls0 ws1db">the code also makes it look like the languag<span class="_ _4"></span>e was</div><div class="t m0 x2b h29 y366 ffa fsf fc0 sc0 ls0 ws0">made for the pr<span class="_ _1"></span>oblem.</div><div class="t m0 x2b h14 y367 ff8 fs3 fc0 sc0 ls0 ws1dc">Statements like this are characteristic of <span class="_ _4"></span>W<span class="_ _1"></span>ard.</div><div class="t m0 xd h14 y368 ff8 fs3 fc0 sc0 ls0 ws1dd">Y<span class="_ _3"></span>ou read it, nod your head<span class="_ _1"></span>, and then go on to the</div><div class="t m0 xd h14 y369 ff8 fs3 fc0 sc0 ls0 ws1de">next topic. It sounds so reasonab<span class="_ _4"></span>le, so obvious, that it barel<span class="_ _4"></span>y registers as something</div><div class="t m0 xd h14 y36a ff8 fs3 fc0 sc0 ls0 ws1df">profound. <span class="_ _0"></span>Y<span class="_ _2"></span>ou might think it w<span class="_ _4"></span>as pretty much what y<span class="_ _4"></span>ou expected. But let’<span class="_ _2"></span>s take a closer</div><div class="t m0 xd h14 y2d3 ff8 fs3 fc0 sc0 ls0 ws0">look.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2b" class="pf w1 h2" data-page-no="2b"><div class="pc pc2b w1 h2"><img class="bi x40 y36b w8 h2e" alt="" src="bg2b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">12<span class="_ _1c"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 ws1e0">“. <span class="_ _4"></span>. . <span class="_ _4"></span>pretty much what y<span class="_ _4"></span>ou expected.<span class="_ _0"></span>” When w<span class="_ _4"></span>as the last time you sa<span class="_ _1"></span>w a module that</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws10d">w<span class="_ _4"></span>as pretty much what you e<span class="_ _4"></span>xpected? Isn’<span class="_ _4"></span>t it more likel<span class="_ _4"></span>y that the modules you look at will</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws1e1">be puzzling, complicated<span class="_ _1"></span>, tangled? Isn’<span class="_ _4"></span>t misdirection the r<span class="_ _8"></span>ule? <span class="_ _1"></span>Aren’<span class="_ _4"></span>t you used to ﬂailing</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws1e2">about trying to g<span class="_ _8"></span>rab and hold the threads of reasoning that spew forth from the whole sys-</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws1e3">tem and w<span class="_ _4"></span>ea<span class="_ _4"></span>ve their wa<span class="_ _1"></span>y through the module you are reading? <span class="_ _4"></span>When was the last time y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 wsaa">read through some code and nodded your head the w<span class="_ _4"></span>a<span class="_ _4"></span>y you might ha<span class="_ _4"></span>ve nodded y<span class="_ _4"></span>our head</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws1e4">at W<span class="_ _0"></span>ard’<span class="_ _2"></span>s <span class="_ _5"></span>statement?</div><div class="t m0 x2b h14 y19b ff8 fs3 fc0 sc0 ls0 ws1e5">W<span class="_ _0"></span>ard expects that when y<span class="_ _4"></span>ou read clean code you w<span class="_ _1"></span>on’<span class="_ _4"></span>t be sur<span class="_ _8"></span>prised at all. Indeed<span class="_ _4"></span>, you</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws1e6">w<span class="_ _4"></span>on’<span class="_ _4"></span>t e<span class="_ _4"></span>ven expend much ef<span class="_ _4"></span>for<span class="_ _8"></span>t. <span class="_ _0"></span>Y<span class="_ _2"></span>ou will read it, and it will be pretty much w<span class="_ _4"></span>hat you</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws1e7">expected. It will be ob<span class="_ _4"></span>vious, simple, and compelling. Each module will set the stage for</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws1e8">the next. Each tells y<span class="_ _4"></span>ou ho<span class="_ _4"></span>w the next will be written. Pro<span class="_ _4"></span>g<span class="_ _8"></span>rams that are <span class="ffa ws0">that<span class="_ _18"> </span></span>clean are so</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws108">profoundly w<span class="_ _1"></span>ell written that you don’<span class="_ _1"></span>t even notice it. <span class="_ _1"></span>The designer makes it look ridicu-</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws0">lously simple lik<span class="_ _4"></span>e all exceptional designs.</div><div class="t m0 x2b h14 y21c ff8 fs3 fc0 sc0 lsc ws1e9">And what about <span class="_ _1"></span>W<span class="_ _1"></span>ard’<span class="_ _2"></span>s notion of beauty? W<span class="_ _0"></span>e’<span class="_ _1"></span>ve all railed against the fact that our lan-</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws1ea">guages w<span class="_ _4"></span>eren’<span class="_ _4"></span>t designed for our problems. But <span class="_ _4"></span>W<span class="_ _0"></span>ard’<span class="_ _2"></span>s statement puts the onus back on us.</div><div class="t m0 xd h14 y36d ff8 fs3 fc0 sc0 ls0 ws1eb">He sa<span class="_ _4"></span>ys that beautiful code <span class="ffa">makes the language look<span class="_ _e"> </span>like it was made f<span class="_ _4"></span>or the pr<span class="_ _4"></span>oblem<span class="ff8">! So</span></span></div><div class="t m0 xd h14 y36e ff8 fs3 fc0 sc0 ls0 ws0">it’<span class="_ _2"></span>s <span class="_ _d"> </span><span class="ffa">our<span class="_ _15"> </span></span><span class="ws1ec">responsibility to make the language look simple! Language bigots ev<span class="_ _4"></span>er<span class="_ _8"></span>ywhere,</span></div><div class="t m0 xd h14 y36f ff8 fs3 fc0 sc0 ls0 ws1ed">be<span class="_ _4"></span>ware! It is not the language that makes pro<span class="_ _4"></span>grams appear simple. It is the programmer</div><div class="t m0 xd h14 y370 ff8 fs3 fc0 sc0 ls0 ws0">that make the language appear simple!</div><div class="t m0 xd h17 y371 ff1 fs9 fc0 sc0 ls0 ws0">Schools of <span class="_ _0"></span>Thought</div><div class="t m0 xd h14 y372 ff8 fs3 fc0 sc0 ls0 ws1ee">What about me (Uncle Bob)? <span class="_ _4"></span>What do I think</div><div class="t m0 xd h14 y373 ff8 fs3 fc0 sc0 ls0 ws1ef">clean code is? <span class="_ _1"></span>This book will tell you, in hideous</div><div class="t m0 xd h14 y374 ff8 fs3 fc0 sc0 ls0 ws1f0">detail, what I and m<span class="_ _1"></span>y compatriots think about</div><div class="t m0 xd h14 y375 ff8 fs3 fc0 sc0 ls0 ws1f1">clean code. <span class="_ _4"></span>W<span class="_ _0"></span>e will tell you what w<span class="_ _1"></span>e think makes</div><div class="t m0 xd h14 y376 ff8 fs3 fc0 sc0 ls0 ws1f2">a clean variab<span class="_ _4"></span>le name, a clean function, a clean</div><div class="t m0 xd h14 y377 ff8 fs3 fc0 sc0 ls0 wscc">class, etc. <span class="_ _4"></span>W<span class="_ _0"></span>e will present these opinions as abso-</div><div class="t m0 xd h14 y312 ff8 fs3 fc0 sc0 ls0 ws1f3">lutes, and w<span class="_ _4"></span>e will not apologize for our stridence.</div><div class="t m0 xd h14 y313 ff8 fs3 fc0 sc0 ls0 ws1f4">T<span class="_ _0"></span>o us, at this point in our careers, they <span class="ffa ws0">ar<span class="_ _4"></span>e<span class="_ _18"> </span><span class="ff8">abso-</span></span></div><div class="t m0 xd h14 y314 ff8 fs3 fc0 sc0 ls0 ws19c">lutes. They <span class="_ _8"></span>are <span class="_ _5"></span><span class="ffa ws1f5">our school of thought <span class="ff8">about clean</span></span></div><div class="t m0 xd h14 y315 ff8 fs3 fc0 sc0 ls0 ws0">code.</div><div class="t m0 x2b h14 y378 ff8 fs3 fc0 sc0 ls0 ws1f6">Martial ar<span class="_ _8"></span>tists do not all ag<span class="_ _8"></span>ree about the best</div><div class="t m0 xd h14 y316 ff8 fs3 fc0 sc0 ls0 ws1f7">martial ar<span class="_ _8"></span>t, or the best technique within a mar<span class="_ _8"></span>tial</div><div class="t m0 xd h14 y317 ff8 fs3 fc0 sc0 ls0 ws1f8">art. Often master mar<span class="_ _8"></span>tial ar<span class="_ _8"></span>tists will for<span class="_ _8"></span>m their</div><div class="t m0 xd h14 y318 ff8 fs3 fc0 sc0 lsc ws120">o<span class="_ _4"></span>wn schools of thought and gather students to</div><div class="t m0 xd h14 y2bc ff8 fs3 fc0 sc0 ls0 ws1f9">learn from them. So we see <span class="ffa">Gr<span class="_ _1"></span>acie Jiu Jistu<span class="ff8 ws0">,</span></span></div><div class="t m0 xd h14 y2bd ff8 fs3 fc0 sc0 ls0 ws1fa">founded and taught b<span class="_ _4"></span>y the Gracie f<span class="_ _8"></span>amily in Brazil. <span class="_ _1"></span>W<span class="_ _0"></span>e see <span class="ffa">Hakkoryu Jiu Jistu</span>, founded</div><div class="t m0 xd h14 y2be ff8 fs3 fc0 sc0 ls0 ws1fb">and taught b<span class="_ _4"></span>y Okuyama Ryuho in <span class="_ _4"></span>T<span class="_ _1"></span>oky<span class="_ _4"></span>o. W<span class="_ _0"></span>e see <span class="ffa">J<span class="_ _4"></span>eet K<span class="_ _4"></span>une Do<span class="ff8">, founded and taught by</span></span></div><div class="t m0 xd h14 y2bf ff8 fs3 fc0 sc0 ls0 ws0">Bruce Lee in the United States.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:328.945010px;width:114.298000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2c" class="pf w1 h2" data-page-no="2c"><div class="pc pc2c w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">13<span class="_ _10"></span><span class="ff1 ws1fc">W<span class="_ _0"></span>e Ar<span class="_ _4"></span>e A<span class="_ _4"></span>uthors</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 ws1fd">Students of these approaches immerse themselves in the teachings of the founder<span class="_ _1"></span>.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws1e1">They dedicate themselv<span class="_ _4"></span>es to lear<span class="_ _8"></span>n what that particular master teaches, often to the exclu-</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws1fe">sion of any other master’<span class="_ _3"></span>s teaching. Later<span class="_ _4"></span>, as the students g<span class="_ _8"></span>ro<span class="_ _4"></span>w in their ar<span class="_ _8"></span>t, they ma<span class="_ _4"></span>y</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 wsb3">become the student of a different master so the<span class="_ _4"></span>y can broaden their kno<span class="_ _4"></span>wledge and practice.</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws1ff">Some ev<span class="_ _4"></span>entually go on to reﬁne their skills, disco<span class="_ _1"></span>vering ne<span class="_ _4"></span>w techniques and founding their</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">o<span class="_ _4"></span>wn schools.</div><div class="t m0 x2b h14 y19a ff8 fs3 fc0 sc0 ls0 ws200">None of these different schools is absolutel<span class="_ _1"></span>y <span class="ffa ws0">right</span>. <span class="_ _1"></span>Y<span class="_ _3"></span>et within a par<span class="_ _8"></span>ticular school we</div><div class="t m0 xd h14 y19b ffa fs3 fc0 sc0 ls0 ws0">act<span class="ff8 ws201"> as though the teachings and techniques </span>ar<span class="_ _4"></span>e<span class="ff8 ws201"> right. <span class="_ _1"></span>After all, there is a right wa<span class="_ _4"></span>y to prac-</span></div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws202">tice Hakkoryu Jiu Jitsu, or Jeet Kune Do. But this rightness within a school does not in<span class="_ _1"></span>val-</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">idate the teachings of a different school.</div><div class="t m0 x2b h14 y208 ff8 fs3 fc0 sc0 ls0 ws203">Consider this book a description of the <span class="ffa">Object Mentor School of Clean Code</span><span class="ws204">. The</span></div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws205">techniques and teachings within are the wa<span class="_ _1"></span>y that <span class="ffa ls15 ws0">we <span class="_ _d"> </span></span><span class="ws0">practice<span class="_ _15"> </span><span class="ffa">our<span class="_ _16"> </span></span></span>ar<span class="_ _8"></span>t. W<span class="_ _0"></span>e are willing to</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws206">claim that if you follo<span class="_ _1"></span>w these teachings, you will enjo<span class="_ _1"></span>y the beneﬁts that we ha<span class="_ _4"></span>ve enjo<span class="_ _1"></span>yed<span class="_ _1"></span>,</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws207">and you will learn to write code that is clean and professional. But don’<span class="_ _1"></span>t make the mistake</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws1bb">of thinking that w<span class="_ _4"></span>e are someho<span class="_ _4"></span>w “right” in any absolute sense. <span class="_ _1"></span>There are other schools and</div><div class="t m0 xd h14 y36d ff8 fs3 fc0 sc0 ls0 ws208">other masters that ha<span class="_ _4"></span>ve just as much claim to professionalism as w<span class="_ _4"></span>e. It w<span class="_ _4"></span>ould behoo<span class="_ _4"></span>ve y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y36e ff8 fs3 fc0 sc0 ls0 ws0">to learn from them as well.</div><div class="t m0 x2b h14 y21f ff8 fs3 fc0 sc0 ls0 ws6a">Indeed<span class="_ _1"></span>, many of the recommendations in this book are contro<span class="_ _1"></span>versial. <span class="_ _0"></span>Y<span class="_ _2"></span>ou will proba-</div><div class="t m0 xd h14 y220 ff8 fs3 fc0 sc0 ls0 ws209">bl<span class="_ _4"></span>y not agree with all of them. <span class="_ _1"></span>Y<span class="_ _3"></span>ou might violently disagree with some of them. <span class="_ _4"></span>That’<span class="_ _2"></span>s ﬁne.</div><div class="t m0 xd h14 y221 ff8 fs3 fc0 sc0 ls0 ws20a">W<span class="_ _0"></span>e can’<span class="_ _1"></span>t claim ﬁnal authority<span class="_ _1"></span>. On the other hand<span class="_ _4"></span>, the recommendations in this book are</div><div class="t m0 xd h14 y222 ff8 fs3 fc0 sc0 ls0 ws20b">things that w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve thought long and hard about. <span class="_ _4"></span>W<span class="_ _0"></span>e hav<span class="_ _4"></span>e lear<span class="_ _8"></span>ned them through decades of</div><div class="t m0 xd h14 y223 ff8 fs3 fc0 sc0 ls0 ws20c">experience and repeated trial and error<span class="_ _4"></span>. So whether y<span class="_ _4"></span>ou ag<span class="_ _8"></span>ree or disagree, it would be a</div><div class="t m0 xd h14 y2f2 ff8 fs3 fc0 sc0 ls0 ws0">shame if you did not see, and respect, our point of vie<span class="_ _4"></span>w<span class="_ _0"></span>.</div><div class="t m0 xd h17 y379 ff1 fs9 fc0 sc0 ls0 ws20d">W<span class="_ _2"></span>e Ar<span class="_ _4"></span>e A<span class="_ _1"></span>uthors</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x2b h2f y37a ffb fs10 fc0 sc0 ls0 ws0">@author</div><div class="t m0 x41 h14 y37a ff8 fs3 fc0 sc0 ls0 ws20e">ﬁeld of a Ja<span class="_ _4"></span>vadoc tells us w<span class="_ _4"></span>ho w<span class="_ _4"></span>e are. W<span class="_ _0"></span>e are authors. <span class="_ _1"></span>And one thing about</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws20f">authors is that they ha<span class="_ _1"></span>ve readers. Indeed<span class="_ _1"></span>, authors are <span class="ffa ws0">responsib<span class="_ _4"></span>le<span class="_ _a"> </span><span class="ff8 ws20f">for communicating well</span></span></div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls0 wsc9">with their readers. <span class="_ _1"></span>The next time you write a line of code, remember y<span class="_ _4"></span>ou are an author<span class="_ _4"></span>,</div><div class="t m0 xd h14 y37d ff8 fs3 fc0 sc0 ls0 ws0">writing for readers who will judge y<span class="_ _4"></span>our effort.</div><div class="t m0 x2b h14 y2cd ff8 fs3 fc0 sc0 ls0 ws210">Y<span class="_ _3"></span>ou might ask: How much is code reall<span class="_ _1"></span>y read? Doesn’<span class="_ _4"></span>t most of the effort go into</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 ws0">writing it? </div><div class="t m0 x2b h14 y2cf ff8 fs3 fc0 sc0 ls10 ws211">Ha<span class="_ _4"></span>ve y<span class="_ _4"></span>ou ever pla<span class="_ _1"></span>yed back an edit session? In the 80s and 90s w<span class="_ _4"></span>e had editors like Emacs</div><div class="t m0 xd h14 y2d0 ff8 fs3 fc0 sc0 ls10 ws212">that kept track of e<span class="_ _4"></span>very keystroke. <span class="_ _0"></span>Y<span class="_ _3"></span>ou could w<span class="_ _4"></span>ork for an hour and then play back y<span class="_ _4"></span>our whole</div><div class="t m0 xd h14 y2d1 ff8 fs3 fc0 sc0 ls10 ws0">edit session like a high-speed mo<span class="_ _1"></span>vie. When I did this, the results w<span class="_ _4"></span>ere fascinating.</div><div class="t m0 x2b h14 y37e ff8 fs3 fc0 sc0 lsc ws3f">The vast majority of the pla<span class="_ _1"></span>yback was scrolling and na<span class="_ _4"></span>vigating to other modules!</div><div class="t m0 x2b h29 y37f ffa fsf fc0 sc0 ls0 ws0">Bob enters the module. </div><div class="t m0 x2b h29 y380 ffa fsf fc0 sc0 ls0 ws0">He scr<span class="_ _4"></span>olls down to the function needing c<span class="_ _4"></span>hange. </div><div class="t m0 x2b h29 y381 ffa fsf fc0 sc0 ls0 ws0">He pauses, considering his options. </div><div class="t m0 x2b h29 y382 ffa fsf fc0 sc0 ls0 ws0">Oh, he’<span class="_ _2"></span>s scrolling up to the top of the module to c<span class="_ _4"></span>heck the initialization of a variab<span class="_ _4"></span>le.</div><div class="t m0 x2b h29 y383 ffa fsf fc0 sc0 ls0 ws0">Now he scr<span class="_ _1"></span>olls back down and be<span class="_ _4"></span>gins to type.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:277.945010px;width:93.728000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2d" class="pf w1 h2" data-page-no="2d"><div class="pc pc2d w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bg2d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">14<span class="_ _1c"> </span><span class="ff1 wsf5">Chapter 1:<span class="_ _4"></span> Clean Code</span></div><div class="t m0 x2b h29 y345 ffa fsf fc0 sc0 ls0 ws0">Ooops, he’<span class="_ _2"></span>s erasing w<span class="_ _4"></span>hat he typed!</div><div class="t m0 x2b h29 y346 ffa fsf fc0 sc0 ls0 ws0">He types it ag<span class="_ _4"></span>ain.</div><div class="t m0 x2b h29 y347 ffa fsf fc0 sc0 ls0 ws0">He er<span class="_ _4"></span>ases it ag<span class="_ _4"></span>ain!</div><div class="t m0 x2b h29 y348 ffa fsf fc0 sc0 ls14 ws1d0">He types half of something else but then er<span class="_ _4"></span>ases that!</div><div class="t m0 x2b h29 y349 ffa fsf fc0 sc0 ls0 ws213">He scr<span class="_ _4"></span>olls down to another function that calls the function he’<span class="_ _2"></span>s changing to see how it is</div><div class="t m0 x2b h29 y34a ffa fsf fc0 sc0 ls0 ws0">called.</div><div class="t m0 x2b h29 y34b ffa fsf fc0 sc0 ls0 ws0">He scr<span class="_ _4"></span>olls back up and types the same code he just er<span class="_ _1"></span>ased.</div><div class="t m0 x2b h29 y34c ffa fsf fc0 sc0 ls0 ws0">He pauses.</div><div class="t m0 x2b h29 y34d ffa fsf fc0 sc0 ls0 ws0">He er<span class="_ _4"></span>ases that code ag<span class="_ _4"></span>ain!</div><div class="t m0 x2b h29 y34e ffa fsf fc0 sc0 ls0 ws0">He pops up another window and looks at a subc<span class="_ _4"></span>lass. Is that function overridden?</div><div class="t m0 x2b h14 y385 ff8 fs3 fc0 sc0 ls0 ws0">. . .</div><div class="t m0 x2b h14 y386 ff8 fs3 fc0 sc0 ls0 ws12e">Y<span class="_ _3"></span>ou get the drift. Indeed<span class="_ _4"></span>, the ratio of time spent reading vs. writing is w<span class="_ _4"></span>ell o<span class="_ _4"></span>ver 10:1.</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e are <span class="ffa">constantly</span> reading old code as part of the effort to write new code.</div><div class="t m0 x2b h14 y27c ff8 fs3 fc0 sc0 ls0 ws214">Because this ratio is so high, w<span class="_ _4"></span>e want the reading of code to be easy<span class="_ _0"></span>, ev<span class="_ _4"></span>en if it makes</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws1f5">the writing harder<span class="_ _1"></span>. Of course there’<span class="_ _2"></span>s no wa<span class="_ _4"></span>y to write code without reading it, so <span class="ffa">making it</span></div><div class="t m0 xd h14 y27e ffa fs3 fc0 sc0 ls0 ws0">easy to r<span class="_ _4"></span>ead actually makes it easier to write<span class="ff8">.</span></div><div class="t m0 x2b h14 y388 ff8 fs3 fc0 sc0 ls0 ws84">There is no escape from this lo<span class="_ _4"></span>gic. <span class="_ _1"></span>Y<span class="_ _3"></span>ou cannot write code if you cannot read the sur-</div><div class="t m0 xd h14 y389 ff8 fs3 fc0 sc0 ls0 ws215">rounding code. <span class="_ _1"></span>The code you are trying to write today will be hard or easy to write</div><div class="t m0 xd h14 y38a ff8 fs3 fc0 sc0 ls0 ws216">depending on ho<span class="_ _4"></span>w hard or easy the sur<span class="_ _8"></span>rounding code is to read. So if you w<span class="_ _4"></span>ant to go fast,</div><div class="t m0 xd h14 y38b ff8 fs3 fc0 sc0 ls0 ws217">if you w<span class="_ _4"></span>ant to get done quickl<span class="_ _4"></span>y<span class="_ _1"></span>, if you w<span class="_ _4"></span>ant your code to be easy to write, make it easy to</div><div class="t m0 xd h14 y282 ff8 fs3 fc0 sc0 ls0 ws0">read.</div><div class="t m0 xd h17 y38c ff1 fs9 fc0 sc0 ls0 ws0">The Bo<span class="_ _1"></span>y Scout Rule</div><div class="t m0 xd h14 y38d ff8 fs3 fc0 sc0 ls0 wsc2">It’<span class="_ _2"></span>s not enough to write the code w<span class="_ _4"></span>ell. <span class="_ _4"></span>The code has to be <span class="ffa">kept clean </span>o<span class="_ _1"></span>ver time. <span class="_ _4"></span>W<span class="_ _0"></span>e’<span class="_ _4"></span>ve all</div><div class="t m0 xd h14 y38e ff8 fs3 fc0 sc0 ls0 ws218">seen code rot and degrade as time passes. So w<span class="_ _4"></span>e must take an activ<span class="_ _4"></span>e role in prev<span class="_ _4"></span>enting this</div><div class="t m0 xd h14 y38f ff8 fs3 fc0 sc0 ls0 ws0">degradation.</div><div class="t m0 x2b h14 y390 ff8 fs3 fc0 sc0 ls0 ws0">The Bo<span class="_ _4"></span>y Scouts of <span class="_ _1"></span>America hav<span class="_ _4"></span>e a simple r<span class="_ _8"></span>ule that w<span class="_ _4"></span>e can apply to our profession. </div><div class="t m0 x2b h29 y391 ffa fsf fc0 sc0 ls0 ws0">Leave the campgr<span class="_ _4"></span>ound cleaner than you f<span class="_ _4"></span>ound it.</div><div class="t m0 x42 h30 y392 ffa fs11 fc0 sc0 ls0 ws0">5</div><div class="t m0 x2b h14 y393 ff8 fs3 fc0 sc0 ls0 ws219">If w<span class="_ _4"></span>e all checked-in our code a little cleaner than when w<span class="_ _1"></span>e checked it out, the code</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws4f">simpl<span class="_ _4"></span>y could not rot. <span class="_ _4"></span>The cleanup doesn’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve to be something big. Change one variab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y395 ff8 fs3 fc0 sc0 ls0 ws5f">name for the better<span class="_ _4"></span>, break up one function that’<span class="_ _2"></span>s a little too large, eliminate one small bit of</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">duplication, clean up one composite </div><div class="t m5 x43 h2f y396 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x31 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0"> statement. </div><div class="t m0 x2b h14 y397 ff8 fs3 fc0 sc0 ls0 ws21a">Can you imagine w<span class="_ _1"></span>orking on a project where the code <span class="ffa">simply g<span class="_ _4"></span>ot better <span class="ff8">as time</span></span></div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws21b">passed? Do you belie<span class="_ _4"></span>ve that an<span class="_ _4"></span>y other option is professional? Indeed<span class="_ _1"></span>, isn’<span class="_ _4"></span>t continuous</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">impro<span class="_ _4"></span>vement an intrinsic part of professionalism?</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws21c">5.<span class="_ _17"> </span>This w<span class="_ _4"></span>as adapted from Robert Stephenson Smyth Baden-P<span class="_ _4"></span>ow<span class="_ _4"></span>ell’<span class="_ _0"></span>s farew<span class="_ _4"></span>ell message to the Scouts: “Try and leav<span class="_ _4"></span>e this world a </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">little better than you found it . . .<span class="_ _1"></span>”</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:302.945010px;width:118.064000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2e" class="pf w1 h2" data-page-no="2e"><div class="pc pc2e w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">15<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>equel and Principles</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws21d">In many w<span class="_ _1"></span>ays this book is a “prequel” to a book I wrote in 2002 entitled <span class="_ _1"></span><span class="ffa">Agile Softwar<span class="_ _1"></span>e</span></div><div class="t m0 xd h14 y271 ffa fs3 fc0 sc0 ls0 ws21e">Development: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>actices <span class="ff8">(PPP). <span class="_ _1"></span>The PPP book concer<span class="_ _8"></span>ns itself</span></div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws135">with the principles of object-oriented design, and many of the practices used b<span class="_ _1"></span>y profes-</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws21f">sional dev<span class="_ _4"></span>elopers. If you ha<span class="_ _1"></span>ve not read PPP<span class="_ _3"></span>, then you ma<span class="_ _4"></span>y ﬁnd that it continues the stor<span class="_ _8"></span>y</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws220">told by this book. If y<span class="_ _4"></span>ou ha<span class="_ _4"></span>ve already read it, then y<span class="_ _4"></span>ou’ll ﬁnd man<span class="_ _4"></span>y of the sentiments of</div><div class="t m0 xd h14 y276 ff8 fs3 fc0 sc0 ls0 ws0">that book echoed in this one at the le<span class="_ _4"></span>vel of code.</div><div class="t m0 x2b h14 y39c ff8 fs3 fc0 sc0 ls0 ws221">In this book you will ﬁnd sporadic references to v<span class="_ _4"></span>arious principles of design. <span class="_ _1"></span>These</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws222">include the Single Responsibility Principle (SRP), the Open Closed Principle (OCP), and</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls0 ws223">the Dependency In<span class="_ _1"></span>version Principle (DIP) among others. <span class="_ _4"></span>These principles are described in</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws0">depth in PPP<span class="_ _3"></span>. </div><div class="t m0 xd h17 y39f ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y3a0 ff8 fs3 fc0 sc0 ls0 ws224">Books on art don’<span class="_ _4"></span>t promise to make you an artist. <span class="_ _1"></span>All they can do is giv<span class="_ _4"></span>e you some of the</div><div class="t m0 xd h14 y3a1 ff8 fs3 fc0 sc0 ls11 ws225">tools, techniques, and thought processes that other artists hav<span class="_ _4"></span>e used. So too this book can-</div><div class="t m0 xd h14 y3a2 ff8 fs3 fc0 sc0 ls0 ws226">not promise to make y<span class="_ _4"></span>ou a good programmer<span class="_ _4"></span>. It cannot promise to gi<span class="_ _4"></span>ve you “code-sense.<span class="_ _0"></span>”</div><div class="t m0 xd h14 y3a3 ff8 fs3 fc0 sc0 ls0 ws227">All it can do is sho<span class="_ _4"></span>w you the thought processes of good pro<span class="_ _4"></span>grammers and the tricks, tech-</div><div class="t m0 xd h14 y3a4 ff8 fs3 fc0 sc0 ls0 ws0">niques, and tools that they use. </div><div class="t m0 x2b h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws13a">Just like a book on art, this book will be full of details. <span class="_ _4"></span>There will be lots of code.</div><div class="t m0 xd h14 y3a6 ff8 fs3 fc0 sc0 ls0 ws21f">Y<span class="_ _3"></span>ou’ll see good code and y<span class="_ _4"></span>ou’<span class="_ _4"></span>ll see bad code. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll see bad code transformed into good</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc0 sc0 ls0 ws228">code. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll see lists of heuristics, disciplines, and techniques. <span class="_ _0"></span>Y<span class="_ _3"></span>ou’ll see e<span class="_ _4"></span>xample after</div><div class="t m0 xd h14 y3a8 ff8 fs3 fc0 sc0 ls0 ws0">example. <span class="_ _1"></span>After that, it’<span class="_ _2"></span>s up to you. </div><div class="t m0 x2b h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws38">Remember the old joke about the concert violinist who got lost on his w<span class="_ _4"></span>a<span class="_ _4"></span>y to a perfor-</div><div class="t m0 xd h14 y3aa ff8 fs3 fc0 sc0 ls0 ws9e">mance? He stopped an old man on the corner and asked him ho<span class="_ _4"></span>w to get to Car<span class="_ _8"></span>negie Hall.</div><div class="t m0 xd h14 y3ab ff8 fs3 fc0 sc0 ls0 ws229">The old man looked at the violinist and the violin tucked under his arm, and said: “Prac-</div><div class="t m0 xd h14 y390 ff8 fs3 fc0 sc0 ls0 ws0">tice, son. Practice!”</div><div class="t m0 xd h17 y3ac ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y3ad ff1 fs3 fc0 sc0 ls0 wsa0">[Beck07]:<span class="_ _4"></span>  <span class="ffa ws0">Implementation P<span class="_ _1"></span>atterns<span class="ff8">, Kent Beck, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2007.</span></span></div><div class="t m0 xd h14 y3ae ff1 fs3 fc0 sc0 ls0 wsa0">[Knuth92]:<span class="_ _1"></span>  <span class="ffa ws22a">Literate Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>amming<span class="ff8">, Donald E. Knuth, Center for the Study of Language</span></span></div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws0">and Information, Leland Stanford Junior University<span class="_ _0"></span>, 1992.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:580.945010px;width:135.703000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:413.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:207.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf2f" class="pf w1 h2" data-page-no="2f"><div class="pc pc2f w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf30" class="pf w1 h2" data-page-no="30"><div class="pc pc30 w1 h2"><img class="bi xd y3b0 w4 h31" alt="" src="bg30.png"/><div class="t m0 x16 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">17</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">2</div><div class="t m0 x44 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Meaningful Names</div><div class="t m0 x45 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y<span class="_ _b"> </span>Tim Ottinger</div><div class="t m0 xd h17 y3b2 ff1 fs9 fc0 sc0 ls0 ws0">Intr<span class="_ _4"></span>oduction</div><div class="t m0 xd h14 y3b3 ff8 fs3 fc0 sc0 ls16 ws22b">Names are e<span class="_ _4"></span>verywhere in software. <span class="_ _1"></span>W<span class="_ _0"></span>e name our variables, our functions, our ar<span class="_ _4"></span>guments,</div><div class="t m0 xd h14 y3b4 ff8 fs3 fc0 sc0 ls16 ws22c">classes, and packages. <span class="_ _4"></span>W<span class="_ _0"></span>e name our source ﬁles and the directories that contain them. W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y3b5 ff8 fs3 fc0 sc0 ls17 ws22d">name our jar ﬁles and w<span class="_ _4"></span>ar ﬁles and ear ﬁles. W<span class="_ _0"></span>e name and name and name. Because w<span class="_ _4"></span>e do</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:245.000000px;bottom:440.027010px;width:193.990000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:115.489010px;width:75.812000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf31" class="pf w1 h2" data-page-no="31"><div class="pc pc31 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">18<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws22e">so much of it, w<span class="_ _4"></span>e’<span class="_ _2"></span>d better do it w<span class="_ _4"></span>ell. What follo<span class="_ _1"></span>ws are some simple r<span class="_ _8"></span>ules for creating</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws0">good names.</div><div class="t m0 xd h17 y297 ff1 fs9 fc0 sc0 ls0 ws0">Use Intention-Re<span class="_ _4"></span>v<span class="_ _4"></span>ealing Names</div><div class="t m0 xd h14 y298 ff8 fs3 fc0 sc0 ls0 ws0">It is easy to sa<span class="_ _4"></span>y that names should rev<span class="_ _4"></span>eal intent. What w<span class="_ _1"></span>e want to impress upon you is that</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e<span class="_ _18"> </span>are<span class="_ _16"> </span><span class="ffa">serious<span class="_ _18"> </span></span><span class="lsd ws22f">about this. Choosing good names takes time but sa<span class="_ _4"></span>ves more than it takes.</span></div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws230">So take care with y<span class="_ _4"></span>our names and change them when y<span class="_ _4"></span>ou ﬁnd better ones. Everyone who</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws0">reads your code (including y<span class="_ _4"></span>ou) will be happier if you do.</div><div class="t m0 x2b h14 y385 ff8 fs3 fc0 sc0 ls0 ws231">The name of a v<span class="_ _4"></span>ariable, function, or class, should answ<span class="_ _1"></span>er all the big questions. It</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws232">should tell you w<span class="_ _4"></span>h<span class="_ _4"></span>y it exists, what it does, and ho<span class="_ _1"></span>w it is used. If a name requires a com-</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">ment, then the name does not re<span class="_ _4"></span>veal its intent. </div><div class="t m5 x2b h2f y3b8 ffb fs10 fc0 sc0 ls0 ws0">int d; // elapsed time in days</div><div class="t m0 xd h14 y3b9 ff8 fs3 fc0 sc0 ls0 ws233">The name </div><div class="t m5 x46 h2f y3b9 ffb fs10 fc0 sc0 ls0 ws0">d</div><div class="t m0 x41 h14 y3b9 ff8 fs3 fc0 sc0 ls0 ws233">re<span class="_ _4"></span>veals nothing. It does not ev<span class="_ _4"></span>oke a sense of elapsed time, nor of da<span class="_ _4"></span>ys. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y3ba ff8 fs3 fc0 sc0 ls0 ws230">should choose a name that speciﬁes what is being measured and the unit of that measure-</div><div class="t m0 xd h14 y3bb ff8 fs3 fc0 sc0 ls0 ws0">ment:</div><div class="t m5 x2b h2f y3bc ffb fs10 fc0 sc0 ls0 ws0">int elapsedTimeInDays;</div><div class="t m5 x2b h2f y3bd ffb fs10 fc0 sc0 ls0 ws0">int daysSinceCreation;</div><div class="t m5 x2b h2f y3be ffb fs10 fc0 sc0 ls0 ws0">int daysSinceModification;</div><div class="t m5 x2b h2f y3bf ffb fs10 fc0 sc0 ls0 ws0">int fileAgeInDays;</div><div class="t m0 x2b h14 y3c0 ff8 fs3 fc0 sc0 ls0 ws234">Choosing names that re<span class="_ _4"></span>veal intent can make it much easier to understand and change</div><div class="t m0 xd h14 y3c1 ff8 fs3 fc0 sc0 ls0 ws0">code. <span class="_ _4"></span>What is the pur<span class="_ _8"></span>pose of this code?</div><div class="t m5 x2b h2f y3c2 ffb fs10 fc0 sc0 ls14 ws235">  public List&lt;int[]&gt; getThem() {</div><div class="t m5 x2b h2f y3c3 ffb fs10 fc0 sc0 ls18 ws236">    List&lt;int[]&gt; list1 = new ArrayList&lt;int[]&gt;();</div><div class="t m5 x2b h2f y3c4 ffb fs10 fc0 sc0 ls19 ws235">    for (int[] x : theList)</div><div class="t m5 x2b h2f y3c5 ffb fs10 fc0 sc0 ls1a ws235">      if (x[0] == 4) </div><div class="t m5 x2b h2f y3c6 ffb fs10 fc0 sc0 ls1b ws236">        list1.add(x);</div><div class="t m5 x2b h2f y3c7 ffb fs10 fc0 sc0 ls1a ws237">    return list1;</div><div class="t m5 x2b h2f y3c8 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 x2b h14 y227 ff8 fs3 fc0 sc0 ls0 ws238">Wh<span class="_ _4"></span>y is it hard to tell what this code is doing? <span class="_ _1"></span>There are no complex expressions.</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws239">Spacing and indentation are reasonable. <span class="_ _1"></span>There are only three v<span class="_ _4"></span>ariables and tw<span class="_ _1"></span>o constants</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws157">mentioned. <span class="_ _1"></span>There aren’<span class="_ _4"></span>t even an<span class="_ _4"></span>y fancy classes or pol<span class="_ _4"></span>ymor<span class="_ _8"></span>phic methods, just a list of</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws0">ar<span class="_ _8"></span>ra<span class="_ _4"></span>ys (or so it seems).</div><div class="t m0 x2b h14 y22b ff8 fs3 fc0 sc0 lsd ws23a">The problem isn’<span class="_ _1"></span>t the simplicity of the code but the <span class="ffa ls0 ws0">implicity<span class="_ _16"> </span><span class="ff8 ws23b">of the code (to coin a</span></span></div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws23c">phrase): the degree to which the conte<span class="_ _4"></span>xt is not explicit in the code itself. <span class="_ _1"></span>The code implic-</div><div class="t m0 xd h14 y22d ff8 fs3 fc0 sc0 ls0 ws0">itl<span class="_ _4"></span>y requires that we kno<span class="_ _1"></span>w the answ<span class="_ _4"></span>ers to questions such as:</div><div class="t m0 x47 h14 y3c9 ffe fsb fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span><span class="ff8 fs3">What kinds of things are in </span></div><div class="t m5 x1c h2f y3c9 ffb fs10 fc0 sc0 ls0 ws0">theList</div><div class="t m0 x48 h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">?</div><div class="t m0 x47 h14 y3ca ffe fsb fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span><span class="ff8 fs3">What is the signiﬁcance of the zeroth subscript of an item in </span></div><div class="t m5 x49 h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">theList</div><div class="t m0 x4a h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">?</div><div class="t m0 x47 h14 y3cb ffe fsb fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span><span class="ff8 fs3">What is the signiﬁcance of the v<span class="_ _4"></span>alue </span></div><div class="t m5 x22 h2f y3cb ffb fs10 fc0 sc0 ls0 ws0">4</div><div class="t m0 x4b h14 y3cb ff8 fs3 fc0 sc0 ls0 ws0">?</div><div class="t m0 x47 h14 y3cc ffe fsb fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span><span class="ff8 fs3">Ho<span class="_ _1"></span>w w<span class="_ _4"></span>ould I use the list being retur<span class="_ _8"></span>ned?</span></div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:538.945010px;width:187.505000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf32" class="pf w1 h2" data-page-no="32"><div class="pc pc32 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg32.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">19<span class="_ _10"></span><span class="ff1">A<span class="_ _0"></span>v<span class="_ _4"></span>oid Disinformation</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 wsf8">The answ<span class="_ _1"></span>ers to these questions are not present in the code sample, <span class="ffa ls1d ws212">but they could have</span></div><div class="t m0 xd h14 y195 ffa fs3 fc0 sc0 ls0 ws0">been<span class="ff8 lsc ws161">. Sa<span class="_ _4"></span>y that w<span class="_ _4"></span>e’<span class="_ _1"></span>re w<span class="_ _4"></span>orking in a mine sw<span class="_ _4"></span>eeper game. <span class="_ _4"></span>W<span class="_ _0"></span>e ﬁnd that the board is a list of</span></div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">cells called </div><div class="t m5 x4c h2f y196 ffb fs10 fc0 sc0 ls0 ws0">theList</div><div class="t m0 x4d h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">. Let’<span class="_ _2"></span>s rename that to </div><div class="t m5 x4e h2f y196 ffb fs10 fc0 sc0 ls0 ws0">gameBoard</div><div class="t m0 x4f h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x2b h14 y1fb ff8 fs3 fc0 sc0 ls0 ws23d">Each cell on the board is represented by a simple arra<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>e fur<span class="_ _8"></span>ther ﬁnd that the zeroth</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws23e">subscript is the location of a status v<span class="_ _4"></span>alue and that a status value of 4 means “ﬂagged.<span class="_ _1"></span>” Just</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">by gi<span class="_ _1"></span>ving these concepts names we can impro<span class="_ _1"></span>ve the code considerabl<span class="_ _4"></span>y:</div><div class="t m5 x2b h2f y3ce ffb fs10 fc0 sc0 ls14 ws235">  public List&lt;int[]&gt; getFlaggedCells() {</div><div class="t m5 x2b h2f y3cf ffb fs10 fc0 sc0 ls14 ws237">    List&lt;int[]&gt; flaggedCells = new ArrayList&lt;int[]&gt;();</div><div class="t m5 x2b h2f y3d0 ffb fs10 fc0 sc0 ls19 ws235">    for (int[] cell : gameBoard)</div><div class="t m5 x2b h2f y3d1 ffb fs10 fc0 sc0 ls19 ws237">      if (cell[STATUS_VALUE] == FLAGGED)</div><div class="t m5 x2b h2f y3d2 ffb fs10 fc0 sc0 ls1e ws237">        flaggedCells.add(cell);</div><div class="t m5 x2b h2f y3d3 ffb fs10 fc0 sc0 ls1f ws237">    return flaggedCells;</div><div class="t m5 x2b h2f y3d4 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws23f">Notice that the simplicity of the code has not changed. It still has exactl<span class="_ _4"></span>y the same number</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws240">of operators and constants, with exactl<span class="_ _4"></span>y the same number of nesting lev<span class="_ _4"></span>els. But the code</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws0">has become much more explicit.</div><div class="t m0 x2b h14 y21d ff8 fs3 fc0 sc0 ls0 ws27">W<span class="_ _0"></span>e can go further and write a simple class for cells instead of using an ar<span class="_ _8"></span>ray of </div><div class="t m5 x30 h2f y3d5 ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 x50 h14 y3d5 ff8 fs3 fc0 sc0 ls0 ws0">s.</div><div class="t m0 xd h14 y3d6 ff8 fs3 fc0 sc0 ls0 wsd7">It can include an intention-rev<span class="_ _4"></span>ealing function (call it </div><div class="t m5 x27 h2f y3d6 ffb fs10 fc0 sc0 ls0 ws0">isFlagged</div><div class="t m0 x51 h14 y3d6 ff8 fs3 fc0 sc0 ls0 wsd7">) to hide the magic num-</div><div class="t m0 xd h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws0">bers. It results in a new v<span class="_ _4"></span>ersion of the function:</div><div class="t m5 x2b h2f y3d8 ffb fs10 fc0 sc0 ls14 ws235">  public List&lt;Cell&gt; getFlaggedCells() {</div><div class="t m5 x2b h2f y3d9 ffb fs10 fc0 sc0 ls14 ws237">    List&lt;Cell&gt; flaggedCells = new ArrayList&lt;Cell&gt;();</div><div class="t m5 x2b h2f y3da ffb fs10 fc0 sc0 ls19 ws235">    for (Cell cell : gameBoard)</div><div class="t m5 x2b h2f y3db ffb fs10 fc0 sc0 ls1a ws241">      if (cell.isFlagged())</div><div class="t m5 x2b h2f y3dc ffb fs10 fc0 sc0 ls20 ws241">        flaggedCells.add(cell);</div><div class="t m5 x2b h2f y3dd ffb fs10 fc0 sc0 ls1f ws241">    return flaggedCells;</div><div class="t m5 x2b h2f y3de ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls0 ws242">W<span class="_ _4"></span>ith these simple name changes, it’<span class="_ _2"></span>s not difﬁcult to understand w<span class="_ _4"></span>hat’<span class="_ _2"></span>s going on. <span class="_ _4"></span>This is</div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">the po<span class="_ _4"></span>w<span class="_ _4"></span>er of choosing good names.</div><div class="t m0 xd h17 y3e1 ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>v<span class="_ _4"></span>oid Disinf<span class="_ _4"></span>ormation</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws195">Programmers must a<span class="_ _4"></span>void lea<span class="_ _1"></span>ving f<span class="_ _8"></span>alse clues that obscure the meaning of code. W<span class="_ _2"></span>e should</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws243">a<span class="_ _4"></span>void w<span class="_ _1"></span>ords whose entrenched meanings vary from our intended meaning. F<span class="_ _1"></span>or example,</div><div class="t m5 xd h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">hp</div><div class="t m0 x37 h14 y2ce ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x19 h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">aix</div><div class="t m0 x52 h14 y2ce ff8 fs3 fc0 sc0 ls0 ws244">, and </div><div class="t m5 x1e h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">sco</div><div class="t m0 x3a h14 y2ce ff8 fs3 fc0 sc0 ls0 ws244">w<span class="_ _4"></span>ould be poor variab<span class="_ _4"></span>le names because they are the names of Unix plat-</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 wsa5">forms or variants. Even if y<span class="_ _4"></span>ou are coding a h<span class="_ _4"></span>ypotenuse and </div><div class="t m5 x21 h2f y3e3 ffb fs10 fc0 sc0 ls0 ws0">hp</div><div class="t m0 x53 h14 y3e3 ff8 fs3 fc0 sc0 ls0 wsa5">looks like a good abbre<span class="_ _4"></span>via-</div><div class="t m0 xd h14 y3e4 ff8 fs3 fc0 sc0 ls0 ws0">tion, it could be disinformative.</div><div class="t m0 x2b h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws245">Do not refer to a grouping of accounts as an </div><div class="t m5 x54 h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">accountList</div><div class="t m0 x55 h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws245">unless it’<span class="_ _2"></span>s actually a </div><div class="t m5 x30 h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">List</div><div class="t m0 x56 h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws246">The w<span class="_ _4"></span>ord list means something speciﬁc to programmers. If the container holding the</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws247">accounts is not actually a </div><div class="t m5 x57 h2f y3c9 ffb fs10 fc0 sc0 ls0 ws0">List</div><div class="t m0 x1c h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws247">, it ma<span class="_ _4"></span>y lead to false conclusions.</div><div class="t m0 x58 h21 y3e7 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x59 h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">So</div><div class="t m5 x45 h2f y3c9 ffb fs10 fc0 sc0 ls0 ws0">accountGroup</div><div class="t m0 x1d h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 xd h2f y3e8 ffb fs10 fc0 sc0 ls0 ws0">bunchOfAccounts</div><div class="t m0 x24 h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws0"> or just plain </div><div class="t m5 x5a h2f y3e8 ffb fs10 fc0 sc0 ls0 ws0">accounts</div><div class="t m0 x32 h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws0"> w<span class="_ _4"></span>ould be better<span class="_ _1"></span>.</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>As w<span class="_ _4"></span>e’<span class="_ _4"></span>ll see later on, even if the container <span class="_ _4"></span><span class="ffa">is<span class="ff8"> a </span></span></div><div class="t m6 x5b h32 y302 ffb fs12 fc0 sc0 ls0 ws0">List</div><div class="t m0 x5c h25 y302 ff8 fse fc0 sc0 ls0 ws0">, it’<span class="_ _0"></span>s probabl<span class="_ _4"></span>y better not to encode the container type into the name. </div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:238.945010px;width:128.120000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf33" class="pf w1 h2" data-page-no="33"><div class="pc pc33 w1 h2"><img class="bi x37 y3e9 w9 h33" alt="" src="bg33.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">20<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 ws248">Bew<span class="_ _1"></span>are of using names which vary in small w<span class="_ _4"></span>ays. Ho<span class="_ _1"></span>w long does it take to spot the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws249">subtle difference betw<span class="_ _1"></span>een a </div><div class="t m5 x5d h2f y195 ffb fs10 fc0 sc0 ls0 ws0">XYZControllerForEfficientHandlingOfStrings</div><div class="t m0 x5e h14 y195 ff8 fs3 fc0 sc0 ls0 ws249">in one module</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws24a">and<span class="_ _1"></span>, somew<span class="_ _4"></span>here a little more distant, </div><div class="t m5 x48 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">XYZControllerForEfficient<span class="_ _4"></span>StorageOfStrings</div><div class="t m0 x36 h14 y196 ff8 fs3 fc0 sc0 ls0 ws24b">? The</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ords ha<span class="_ _4"></span>ve frightfull<span class="_ _4"></span>y similar shapes.</div><div class="t m0 x2b h1d y1bd ffd fs3 fc0 sc0 ls0 ws24c">Spelling similar concepts similarly is <span class="ffa ws0">information<span class="_ _4"></span><span class="ffd ws24c">. Using inconsistent spellings is <span class="ffa ws0">dis-</span></span></span></div><div class="t m0 xd h1d y1be ffa fs3 fc0 sc0 ls0 ws0">information<span class="ffd ws24d">. <span class="_ _1"></span>With modern Ja<span class="_ _4"></span>va en<span class="_ _1"></span>vironments we enjoy automatic code completion. W<span class="_ _0"></span>e</span></div><div class="t m0 xd h1d y19a ffd fs3 fc0 sc0 ls0 ws24e">write a few characters of a name and press some hotk<span class="_ _4"></span>ey combination (if that) and are</div><div class="t m0 xd h1d y19b ffd fs3 fc0 sc0 ls0 ws68">rew<span class="_ _4"></span>arded with a list of possible completions for that name. It is very helpful if names for</div><div class="t m0 xd h1d y19c ffd fs3 fc0 sc0 ls0 ws24f">very similar things sort together alphabetically and if the dif<span class="_ _4"></span>ferences are very ob<span class="_ _4"></span>vious,</div><div class="t m0 xd h1d y19d ffd fs3 fc0 sc0 ls0 ws250">because the dev<span class="_ _4"></span>eloper is likely to pick an object by name without seeing your copious</div><div class="t m0 xd h1d y19e ffd fs3 fc0 sc0 ls0 ws0">comments or ev<span class="_ _4"></span>en the list of methods supplied by that class.</div><div class="t m0 x2b h14 y21a ff8 fs3 fc0 sc0 ls0 ws251">A truly a<span class="_ _4"></span>wful example of disinformativ<span class="_ _4"></span>e names w<span class="_ _4"></span>ould be the use of lo<span class="_ _4"></span>wer<span class="_ _4"></span>-case </div><div class="t m5 x29 h2f y3ea ffb fs10 fc0 sc0 ls0 ws0">L</div><div class="t m0 x1d h14 y3ea ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m0 xd h14 y3eb ff8 fs3 fc0 sc0 ls0 ws0">uppercase</div><div class="t m5 x5f h2f y3ec ffb fs10 fc0 sc0 ls0 ws0">O</div><div class="t m0 x1e h14 y3ec ff8 fs3 fc0 sc0 ls0 ws252">as variab<span class="_ _4"></span>le names, especiall<span class="_ _4"></span>y in combination. <span class="_ _4"></span>The problem, of course, is that</div><div class="t m0 xd h14 y3ed ff8 fs3 fc0 sc0 ls0 ws0">they look almost entirel<span class="_ _4"></span>y like the constants one and zero, respecti<span class="_ _4"></span>vel<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m5 x2b h2f y3ee ffb fs10 fc0 sc0 ls0 ws0">int a = l;</div><div class="t m5 x2b h2f y3ef ffb fs10 fc0 sc0 ls0 ws0">if ( O == l )</div><div class="t m5 x2b h2f y3f0 ffb fs10 fc0 sc0 ls1f ws253">  a = O1;</div><div class="t m5 x2b h2f y3f1 ffb fs10 fc0 sc0 ls0 ws0">else</div><div class="t m5 x2b h2f y3f2 ffb fs10 fc0 sc0 ls1f ws253">  l = 01;</div><div class="t m0 x2b h14 y3f3 ff8 fs3 fc0 sc0 lsd ws254">The reader ma<span class="_ _4"></span>y think this a contriv<span class="_ _4"></span>ance, but w<span class="_ _4"></span>e hav<span class="_ _4"></span>e examined code w<span class="_ _4"></span>here such</div><div class="t m0 xd h14 y3f4 ff8 fs3 fc0 sc0 lsd ws255">things w<span class="_ _4"></span>ere abundant. In one case the author of the code suggested using a different font</div><div class="t m0 xd h14 y3f5 ff8 fs3 fc0 sc0 ls0 wsbc">so that the differences w<span class="_ _1"></span>ere more obvious, a solution that w<span class="_ _1"></span>ould hav<span class="_ _4"></span>e to be passed do<span class="_ _4"></span>wn to</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws256">all future dev<span class="_ _4"></span>elopers as oral tradition or in a written document. <span class="_ _4"></span>The problem is conquered</div><div class="t m0 xd h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws0">with ﬁnality and without creating ne<span class="_ _4"></span>w work products b<span class="_ _4"></span>y a simple renaming.</div><div class="t m0 xd h17 y3f8 ff1 fs9 fc0 sc0 ls0 ws0">Make Meaningful </div><div class="t m0 xd h17 y3f9 ff1 fs9 fc0 sc0 ls0 ws0">Distinctions</div><div class="t m0 xd h14 y3fa ff8 fs3 fc0 sc0 ls0 ws257">Programmers create problems for them-</div><div class="t m0 xd h14 y3fb ff8 fs3 fc0 sc0 ls0 ws258">selves w<span class="_ _4"></span>hen they write code solel<span class="_ _4"></span>y to sat-</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws259">isfy a compiler or inter<span class="_ _8"></span>preter<span class="_ _1"></span>. F<span class="_ _4"></span>or example,</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls10 ws25a">because you can’<span class="_ _1"></span>t use the same name to refer</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws25b">to tw<span class="_ _4"></span>o different things in the same scope,</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 wsa8">you might be tempted to change one name</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws25c">in an arbitrary wa<span class="_ _4"></span>y<span class="_ _0"></span>. Sometimes this is done by misspelling one, leading to the sur<span class="_ _8"></span>prising</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">situation where correcting spelling er<span class="_ _8"></span>rors leads to an inability to compile.</div><div class="t m0 x60 h21 y3e5 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x2b h14 y401 ff8 fs3 fc0 sc0 ls0 ws25d">It is not suf<span class="_ _4"></span>ﬁcient to add number series or noise words, e<span class="_ _4"></span>ven though the compiler is</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">satisﬁed. If names must be dif<span class="_ _4"></span>ferent, then they should also mean something different.</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>Consider<span class="_ _4"></span>, for example, the truly hideous practice of creating a v<span class="_ _4"></span>ariable named </div><div class="t m6 x61 h32 y39a ffb fs12 fc0 sc0 ls21 ws0">klass</div><div class="t m0 x62 h25 y39a ff8 fse fc0 sc0 ls0 ws0"> just because the name </div><div class="t m6 x63 h32 y39a ffb fs12 fc0 sc0 ls0 ws0">class</div><div class="t m0 x64 h25 y39a ff8 fse fc0 sc0 ls0 ws0"> was used </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">for something else.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:255.944010px;width:106.808000px;height:31.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf34" class="pf w1 h2" data-page-no="34"><div class="pc pc34 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg34.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">21<span class="_ _10"></span><span class="ff1">Use Pr<span class="_ _4"></span>onounceable Names</span></div><div class="t m0 x2b h14 y194 ff8 fs3 fc0 sc0 ls0 ws244">Number-series naming </div><div class="t m5 x57 h2f y194 ffb fs10 fc0 sc0 ls0 ws25e">(a1, a2, .. aN)</div><div class="t m0 x65 h14 y194 ff8 fs3 fc0 sc0 ls0 ws244">is the opposite of intentional naming. Such</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws25f">names are not disinformative—the<span class="_ _4"></span>y are noninfor<span class="_ _8"></span>mativ<span class="_ _4"></span>e; they pro<span class="_ _1"></span>vide no clue to the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">author’<span class="_ _2"></span>s intention. Consider:</div><div class="t m5 x2b h2f y403 ffb fs10 fc0 sc0 ls14 ws260">  public static void copyChars(char a1[], char a2[]) {</div><div class="t m5 x2b h2f y404 ffb fs10 fc0 sc0 ls14 ws253">    for (int i = 0; i &lt; a1.length; i++) {</div><div class="t m5 x2b h2f y405 ffb fs10 fc0 sc0 ls20 ws253">      a2[i] = a1[i]; </div><div class="t m5 x2b h2f y406 ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x2b h2f y407 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 xd h14 y408 ff8 fs3 fc0 sc0 ls0 ws261">This function reads much better when </div><div class="t m5 x33 h2f y408 ffb fs10 fc0 sc0 ls0 ws0">source</div><div class="t m0 x66 h14 y408 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x54 h2f y408 ffb fs10 fc0 sc0 ls0 ws0">destination</div><div class="t m0 x55 h14 y408 ff8 fs3 fc0 sc0 ls0 ws261">are used for the argument</div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws0">names.</div><div class="t m0 x2b h14 y1de ff8 fs3 fc0 sc0 ls0 ws262">Noise w<span class="_ _4"></span>ords are another meaningless distinction. Imagine that you ha<span class="_ _1"></span>ve a </div><div class="t m5 x64 h2f y1de ffb fs10 fc0 sc0 ls0 ws0">Product</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 wsf9">class. If you ha<span class="_ _1"></span>ve another called </div><div class="t m5 x1c h2f y1df ffb fs10 fc0 sc0 ls0 ws0">ProductInfo</div><div class="t m0 x67 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x68 h2f y1df ffb fs10 fc0 sc0 ls0 ws0">ProductData</div><div class="t m0 x69 h14 y1df ff8 fs3 fc0 sc0 ls0 wsf9">, you ha<span class="_ _1"></span>ve made the names dif-</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws263">ferent without making them mean an<span class="_ _4"></span>ything different. </div><div class="t m5 x17 h2f y1e0 ffb fs10 fc0 sc0 ls0 ws0">Info</div><div class="t m0 x6a h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x49 h2f y1e0 ffb fs10 fc0 sc0 ls0 ws0">Data</div><div class="t m0 x6b h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws263">are indistinct noise</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ords like </div><div class="t m5 x46 h2f y1e1 ffb fs10 fc0 sc0 ls0 ws0">a</div><div class="t m0 x6c h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x6d h2f y1e1 ffb fs10 fc0 sc0 ls0 ws0">an</div><div class="t m0 x39 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">, and </div><div class="t m5 xb h2f y1e1 ffb fs10 fc0 sc0 ls0 ws0">the</div><div class="t m0 x6e h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x2b h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws264">Note that there is nothing wrong with using preﬁx con<span class="_ _4"></span>ventions like </div><div class="t m5 x4a h2f y40a ffb fs10 fc0 sc0 ls0 ws0">a</div><div class="t m0 x6f h14 y40a ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x70 h2f y40a ffb fs10 fc0 sc0 ls0 ws0">the</div><div class="t m0 x71 h14 y40a ff8 fs3 fc0 sc0 ls0 ws264">so long</div><div class="t m0 xd h14 y40b ff8 fs3 fc0 sc0 ls0 ws265">as they mak<span class="_ _4"></span>e a meaningful distinction. F<span class="_ _4"></span>or example you might use </div><div class="t m5 x72 h2f y40b ffb fs10 fc0 sc0 ls0 ws0">a</div><div class="t m0 x73 h14 y40b ff8 fs3 fc0 sc0 ls0 ws265">for all local v<span class="_ _4"></span>ariables</div><div class="t m0 xd h14 y40c ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f y40d ffb fs10 fc0 sc0 ls0 ws0">the</div><div class="t m0 x75 h14 y40d ff8 fs3 fc0 sc0 ls0 ws266">for all function arguments.</div><div class="t m0 x76 h21 y257 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x77 h14 y40d ff8 fs3 fc0 sc0 ls0 ws266">The problem comes in w<span class="_ _4"></span>hen you decide to call a v<span class="_ _4"></span>ari-</div><div class="t m0 xd h14 y40e ff8 fs3 fc0 sc0 ls0 ws0">able </div><div class="t m5 x2b h2f y40e ffb fs10 fc0 sc0 ls0 ws0">theZork</div><div class="t m0 x6c h14 y40e ff8 fs3 fc0 sc0 ls0 ws0"> because you already ha<span class="_ _1"></span>ve another variab<span class="_ _4"></span>le named </div><div class="t m5 x53 h2f y40e ffb fs10 fc0 sc0 ls0 ws0">zork</div><div class="t m0 x72 h14 y40e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y40f ff8 fs3 fc0 sc0 ls0 ws267">Noise w<span class="_ _4"></span>ords are redundant. <span class="_ _4"></span>The w<span class="_ _4"></span>ord </div><div class="t m5 x78 h2f y40f ffb fs10 fc0 sc0 ls0 ws0">variable</div><div class="t m0 x27 h14 y40f ff8 fs3 fc0 sc0 ls0 ws267">should ne<span class="_ _4"></span>ver appear in a variab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y410 ff8 fs3 fc0 sc0 ls0 ws268">name. The <span class="_ _8"></span>word </div><div class="t m5 x3a h2f y410 ffb fs10 fc0 sc0 ls0 ws0">table</div><div class="t m0 x4 h14 y410 ff8 fs3 fc0 sc0 ls0 ws269">should nev<span class="_ _4"></span>er appear in a table name. Ho<span class="_ _1"></span>w is </div><div class="t m5 x79 h2f y410 ffb fs10 fc0 sc0 ls0 ws0">NameString</div><div class="t m0 x7a h14 y410 ff8 fs3 fc0 sc0 ls0 ws269">better than</div><div class="t m5 xd h2f y411 ffb fs10 fc0 sc0 ls0 ws0">Name</div><div class="t m0 x74 h14 y411 ff8 fs3 fc0 sc0 ls0 wsd5">? W<span class="_ _0"></span>ould <span class="_ _8"></span>a </div><div class="t m5 x39 h2f y411 ffb fs10 fc0 sc0 ls0 ws0">Name</div><div class="t m0 x7b h14 y411 ff8 fs3 fc0 sc0 ls0 ws26a">e<span class="_ _4"></span>ver be a ﬂoating point number? If so, it breaks an earlier rule about</div><div class="t m0 xd h14 y412 ff8 fs3 fc0 sc0 ls0 ws26b">disinformation. Imagine ﬁnding one class named </div><div class="t m5 x61 h2f y412 ffb fs10 fc0 sc0 ls0 ws0">Customer</div><div class="t m0 x58 h14 y412 ff8 fs3 fc0 sc0 ls0 ws26b">and another named</div><div class="t m5 xd h2f y413 ffb fs10 fc0 sc0 ls0 ws0">CustomerObject</div><div class="t m0 xe h14 y413 ff8 fs3 fc0 sc0 ls0 wsdb">. <span class="_ _4"></span>What should you understand as the distinction? <span class="_ _4"></span>Which one will represent</div><div class="t m0 xd h14 y414 ff8 fs3 fc0 sc0 ls0 ws0">the best path to a customer’<span class="_ _2"></span>s pa<span class="_ _4"></span>yment histor<span class="_ _8"></span>y?</div><div class="t m0 x74 h14 y415 ff8 fs3 fc0 sc0 ls22 ws26c">There is an application w<span class="_ _4"></span>e kno<span class="_ _4"></span>w of where this is illustrated. w<span class="_ _4"></span>e’<span class="_ _4"></span>ve changed the names</div><div class="t m0 xd h14 y416 ff8 fs3 fc0 sc0 lsd wsef">to protect the guilty<span class="_ _0"></span>, but here’<span class="_ _2"></span>s the exact form of the er<span class="_ _5"></span>ror:</div><div class="t m5 x74 h2f y225 ffb fs10 fc0 sc0 ls0 ws0">getActiveAccount();</div><div class="t m5 x74 h2f y417 ffb fs10 fc0 sc0 ls0 ws0">getActiveAccounts();</div><div class="t m5 x74 h2f y418 ffb fs10 fc0 sc0 ls0 ws0">getActiveAccountInfo();</div><div class="t m0 xd h14 y419 ff8 fs3 fc0 sc0 ls10 ws0">Ho<span class="_ _4"></span>w are the programmers in this project supposed to kno<span class="_ _4"></span>w which of these functions to call?</div><div class="t m0 x74 h14 y3fc ff8 fs3 fc0 sc0 ls0 wsdc">In the absence of speciﬁc con<span class="_ _4"></span>ventions, the v<span class="_ _4"></span>ariable </div><div class="t m5 x61 h2f y3fc ffb fs10 fc0 sc0 ls0 ws0">moneyAmount</div><div class="t m0 x6b h14 y3fc ff8 fs3 fc0 sc0 ls0 wsdc">is indistinguishable</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">from</div><div class="t m5 x7c h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">money</div><div class="t m0 x5f h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x6c h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">customerInfo</div><div class="t m0 x7d h14 y3fd ff8 fs3 fc0 sc0 ls0 ws9e">is indistinguishable from </div><div class="t m5 x7e h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">customer</div><div class="t m0 x21 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x7f h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">accountData</div><div class="t m0 x45 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws9e">is indistinguish-</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws114">able from </div><div class="t m5 x80 h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">account</div><div class="t m0 x6 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws114">, and </div><div class="t m5 x2e h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">theMessage</div><div class="t m0 x81 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws114"> is indistinguishable from </div><div class="t m5 x21 h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">message</div><div class="t m0 x82 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws114">. Distinguish names in</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">such a wa<span class="_ _1"></span>y that the reader kno<span class="_ _4"></span>ws what the dif<span class="_ _4"></span>ferences offer<span class="_ _1"></span>.</div><div class="t m0 xd h17 y41a ff1 fs9 fc0 sc0 ls0 ws0">Use Pr<span class="_ _4"></span>onounceab<span class="_ _4"></span>le Names</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws24">Humans are good at w<span class="_ _4"></span>ords. <span class="_ _1"></span>A signiﬁcant par<span class="_ _8"></span>t of our brains is dedicated to the concept of</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws26d">w<span class="_ _4"></span>ords. <span class="_ _1"></span>And words are, b<span class="_ _4"></span>y deﬁnition, pronounceable. It w<span class="_ _1"></span>ould be a shame not to take</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>Uncle Bob used to do this in C++ but has gi<span class="_ _4"></span>ven up the practice because modern IDEs make it unnecessary<span class="_ _4"></span>.</div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:139.945010px;width:157.814000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf35" class="pf w1 h2" data-page-no="35"><div class="pc pc35 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">22<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws26e">advantage of that huge portion of our brains that has e<span class="_ _4"></span>volved to deal with spok<span class="_ _4"></span>en lan-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">guage. So make y<span class="_ _4"></span>our names pronounceable.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws26f">If you can’<span class="_ _1"></span>t pronounce it, you can’<span class="_ _1"></span>t discuss it without sounding like an idiot. “W<span class="_ _0"></span>ell,</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws270">o<span class="_ _4"></span>ver here on the bee cee arr three cee enn tee we ha<span class="_ _1"></span>ve a pee ess zee ky<span class="_ _4"></span>ew int, see?” <span class="_ _1"></span>This</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">matters because pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming is a social activity<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y41c ff8 fs3 fc0 sc0 ls0 ws271">A compan<span class="_ _4"></span>y I know has </div><div class="t m5 x5a h2f y41c ffb fs10 fc0 sc0 ls0 ws0">genymdhms</div><div class="t m0 x83 h14 y41c ff8 fs3 fc0 sc0 ls0 ws271">(generation date, year<span class="_ _1"></span>, month, day<span class="_ _0"></span>, hour<span class="_ _4"></span>, minute,</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws272">and second) so they w<span class="_ _4"></span>alked around sa<span class="_ _4"></span>ying “gen wh<span class="_ _4"></span>y emm dee aich emm ess”. I ha<span class="_ _4"></span>ve an</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws1ea">anno<span class="_ _4"></span>ying habit of pronouncing e<span class="_ _4"></span>verything as written, so I star<span class="_ _8"></span>ted saying “gen-yah-mudda-</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws273">hims.<span class="_ _1"></span>” It later was being called this b<span class="_ _4"></span>y a host of designers and anal<span class="_ _4"></span>ysts, and we still</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws274">sounded sill<span class="_ _4"></span>y<span class="_ _1"></span>. But w<span class="_ _4"></span>e were in on the jok<span class="_ _4"></span>e, so it was fun. Fun or not, w<span class="_ _4"></span>e w<span class="_ _4"></span>ere tolerating</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws275">poor naming. Ne<span class="_ _4"></span>w developers had to ha<span class="_ _1"></span>ve the variab<span class="_ _4"></span>les explained to them, and then the<span class="_ _4"></span>y</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws0">spoke about it in sill<span class="_ _4"></span>y made-up w<span class="_ _4"></span>ords instead of using proper English ter<span class="_ _8"></span>ms. Compare</div><div class="t m5 x74 h2f y41d ffb fs10 fc0 sc0 ls0 ws0">class DtaRcrd102 {</div><div class="t m5 x52 h2f y41e ffb fs10 fc0 sc0 ls0 ws0">private Date genymdhms; </div><div class="t m5 x52 h2f y41f ffb fs10 fc0 sc0 ls0 ws0">private Date modymdhms;</div><div class="t m5 x52 h2f y420 ffb fs10 fc0 sc0 ls0 ws0">private final String pszqint = &quot;102&quot;;</div><div class="t m5 x52 h2f y421 ffb fs10 fc0 sc0 ls0 ws0">/* ... */</div><div class="t m5 x74 h2f y422 ffb fs10 fc0 sc0 ls0 ws0">};</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 x74 h2f y424 ffb fs10 fc0 sc0 ls0 ws0">class Customer {</div><div class="t m5 x52 h2f y425 ffb fs10 fc0 sc0 ls0 ws0">private Date generationTimestamp; </div><div class="t m5 x52 h2f y426 ffb fs10 fc0 sc0 ls0 ws0">private Date modificationTimestamp;;</div><div class="t m5 x52 h2f y427 ffb fs10 fc0 sc0 ls0 ws0">private final String recordId = &quot;102&quot;;</div><div class="t m5 x52 h2f y428 ffb fs10 fc0 sc0 ls0 ws0">/* ... */</div><div class="t m5 x74 h2f y429 ffb fs10 fc0 sc0 ls0 ws0">};</div><div class="t m0 xd h14 y42a ff8 fs3 fc0 sc0 ls0 ws276">Intelligent con<span class="_ _4"></span>versation is no<span class="_ _1"></span>w possible: “Hey<span class="_ _0"></span>, Mikey<span class="_ _0"></span>, take a look at this record! <span class="_ _1"></span>The gen-</div><div class="t m0 xd h14 y42b ff8 fs3 fc0 sc0 ls0 ws0">eration timestamp is set to tomor<span class="_ _8"></span>ro<span class="_ _4"></span>w’<span class="_ _2"></span>s date! Ho<span class="_ _4"></span>w can that be?”</div><div class="t m0 xd h17 y42c ff1 fs9 fc0 sc0 ls0 ws0">Use Sear<span class="_ _4"></span>chab<span class="_ _4"></span>le Names</div><div class="t m0 xd h14 y313 ff8 fs3 fc0 sc0 ls0 ws277">Single-letter names and numeric constants ha<span class="_ _4"></span>ve a particular problem in that they are not</div><div class="t m0 xd h14 y314 ff8 fs3 fc0 sc0 ls0 ws0">easy to locate across a body of text.</div><div class="t m0 x74 h14 y42d ff8 fs3 fc0 sc0 ls0 ws278">One might easil<span class="_ _4"></span>y g<span class="_ _8"></span>rep for </div><div class="t m5 x84 h2f y42d ffb fs10 fc0 sc0 ls0 ws0">MAX_CLASSES_PER_STUDENT</div><div class="t m0 x85 h14 y42d ff8 fs3 fc0 sc0 ls11 ws279">, but the number 7 could be more</div><div class="t m0 xd h14 y378 ff8 fs3 fc0 sc0 ls0 ws27a">troublesome. Searches ma<span class="_ _1"></span>y tur<span class="_ _8"></span>n up the digit as par<span class="_ _8"></span>t of ﬁle names, other constant deﬁni-</div><div class="t m0 xd h14 y316 ff8 fs3 fc0 sc0 ls0 ws27b">tions, and in various e<span class="_ _4"></span>xpressions where the v<span class="_ _4"></span>alue is used with different intent. It is e<span class="_ _4"></span>ven</div><div class="t m0 xd h14 y317 ff8 fs3 fc0 sc0 ls0 ws27c">w<span class="_ _4"></span>orse when a constant is a long number and someone might ha<span class="_ _1"></span>ve transposed digits,</div><div class="t m0 xd h14 y318 ff8 fs3 fc0 sc0 lsd wsef">thereby creating a bug w<span class="_ _4"></span>hile simultaneousl<span class="_ _4"></span>y ev<span class="_ _4"></span>ading the programmer’<span class="_ _2"></span>s search.</div><div class="t m0 x74 h14 y319 ff8 fs3 fc0 sc0 ls0 ws15e">Like<span class="_ _4"></span>wise, the name </div><div class="t m5 xa h2f y42e ffb fs10 fc0 sc0 ls0 ws0">e</div><div class="t m0 x7 h14 y42e ff8 fs3 fc0 sc0 ls0 ws15e">is a poor choice for an<span class="_ _4"></span>y variab<span class="_ _4"></span>le for which a pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer might</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws27d">need to search. It is the most common letter in the English language and likel<span class="_ _4"></span>y to sho<span class="_ _4"></span>w up</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 lsc ws27e">in e<span class="_ _4"></span>very passage of text in ev<span class="_ _4"></span>er<span class="_ _8"></span>y program. In this regard<span class="_ _1"></span>, longer names trump shor<span class="_ _8"></span>ter</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws0">names, and an<span class="_ _4"></span>y searchable name trumps a constant in code.</div><div class="t m0 x74 h14 y3cc ff8 fs3 fc0 sc0 ls0 ws8e">My personal preference is that single-letter names can ONL<span class="_ _2"></span>Y be used as local vari-</div><div class="t m0 xd h14 y430 ff8 fs3 fc0 sc0 ls0 ws27f">ables inside short methods. <span class="_ _1"></span><span class="ffa">The length of a name should corr<span class="_ _4"></span>espond to the size of its scope</span></div><a class="l" href="#pf8" data-dest-detail='[8,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:244.945010px;width:134.476000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf36" class="pf w1 h2" data-page-no="36"><div class="pc pc36 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">23<span class="_ _10"></span><span class="ff1">A<span class="_ _0"></span>v<span class="_ _4"></span>oid Encodings</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws9e">[N5]. If a v<span class="_ _4"></span>ariable or constant might be seen or used in multiple places in a body of code,</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 lsc ws3f">it is imperativ<span class="_ _4"></span>e to giv<span class="_ _4"></span>e it a search-friendly name. Once again compare</div><div class="t m5 x74 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">for (int j=0; j&lt;34; j++) {</div><div class="t m5 x52 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">s += (t[j]*4)/5;</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 x74 h2f y3ce ffb fs10 fc0 sc0 ls0 ws0">int realDaysPerIdealDay = 4;</div><div class="t m5 x74 h2f y3cf ffb fs10 fc0 sc0 ls0 ws0">const int WORK_DAYS_PER_WEEK = 5;</div><div class="t m5 x74 h2f y3d0 ffb fs10 fc0 sc0 ls0 ws0">int sum = 0;</div><div class="t m5 x74 h2f y3d1 ffb fs10 fc0 sc0 ls0 ws0">for (int j=0; j &lt; NUMBER_OF_TASKS; j++) {</div><div class="t m5 x52 h2f y3d2 ffb fs10 fc0 sc0 ls0 ws0">int realTaskDays = taskEstimate[j] * realDaysPerIdealDay;</div><div class="t m5 x52 h2f y3d3 ffb fs10 fc0 sc0 ls0 ws0">int realTaskWeeks = (realdays / WORK_DAYS_PER_WEEK);</div><div class="t m5 x52 h2f y3d4 ffb fs10 fc0 sc0 ls0 ws0">sum += realTaskWeeks;</div><div class="t m5 x74 h2f y434 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1d y435 ffd fs3 fc0 sc0 ls0 ws3a">Note that </div><div class="t m5 x86 h2f y435 ffb fs10 fc0 sc0 ls0 ws0">sum</div><div class="t m0 x87 h1d y435 ffd fs3 fc0 sc0 ls0 ws3a">, abov<span class="_ _4"></span>e, is not a particularly useful name but at least is searchable. The</div><div class="t m0 xd h1d y40a ffd fs3 fc0 sc0 ls0 ws280">intentionally named code makes for a longer function, b<span class="_ _4"></span>ut consider how much easier it</div><div class="t m0 xd h1d y40b ffd fs3 fc0 sc0 ls0 ws281">will be to ﬁnd </div><div class="t m5 xe h2f y40b ffb fs10 fc0 sc0 ls0 ws0">WORK_DAYS_PER_WEEK</div><div class="t m0 x20 h1d y40b ffd fs3 fc0 sc0 ls0 ws281">than to ﬁnd all the places where 5 was used and ﬁlter</div><div class="t m0 xd h1d y40c ffd fs3 fc0 sc0 ls0 ws0">the list do<span class="_ _4"></span>wn to just the instances with the intended meaning.</div><div class="t m0 xd h17 y436 ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>v<span class="_ _4"></span>oid Encodings</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 lsd ws282">W<span class="_ _0"></span>e ha<span class="_ _4"></span>ve enough encodings to deal with without adding more to our burden. Encoding</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 lsd ws283">type or scope information into names simply adds an extra burden of deciphering. It</div><div class="t m0 xd h14 y2a1 ff8 fs3 fc0 sc0 ls0 ws1f6">hardly seems reasonab<span class="_ _4"></span>le to require each ne<span class="_ _4"></span>w emplo<span class="_ _4"></span>yee to learn yet another encoding “lan-</div><div class="t m0 xd h14 y437 ff8 fs3 fc0 sc0 ls0 ws284">guage” in addition to learning the (usually considerable) body of code that the<span class="_ _4"></span>y’<span class="_ _4"></span>ll be w<span class="_ _4"></span>ork-</div><div class="t m0 xd h14 y438 ff8 fs3 fc0 sc0 lsd wsbc">ing in. It is an unnecessary mental burden when trying to solve a problem. Encoded names</div><div class="t m0 xd h14 y287 ff8 fs3 fc0 sc0 ls0 ws0">are seldom pronounceable and are easy to mis-type.</div><div class="t m0 xd h11 y439 ff1 fs7 fc0 sc0 ls0 ws0">Hungarian Notation</div><div class="t m0 xd h14 y43a ff8 fs3 fc0 sc0 ls0 ws285">In da<span class="_ _4"></span>ys of old<span class="_ _1"></span>, when w<span class="_ _4"></span>e w<span class="_ _4"></span>orked in name-length-challenged languages, w<span class="_ _4"></span>e violated this</div><div class="t m0 xd h14 y43b ff8 fs3 fc0 sc0 ls0 wsc0">rule out of necessity<span class="_ _1"></span>, and with regret. F<span class="_ _4"></span>or<span class="_ _8"></span>tran forced encodings by making the ﬁrst letter a</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc0 sc0 lsc ws286">code for the type. Earl<span class="_ _4"></span>y versions of B<span class="_ _4"></span>ASIC allo<span class="_ _4"></span>wed onl<span class="_ _4"></span>y a letter plus one digit. Hungarian</div><div class="t m0 xd h14 y43c ff8 fs3 fc0 sc0 ls0 ws0">Notation (HN) took this to a whole ne<span class="_ _4"></span>w le<span class="_ _4"></span>vel.</div><div class="t m0 x74 h14 y395 ff8 fs3 fc0 sc0 ls0 ws287">HN w<span class="_ _4"></span>as considered to be pretty impor<span class="_ _8"></span>tant back in the W<span class="_ _1"></span>indows C <span class="_ _0"></span>API, when ev<span class="_ _4"></span>er<span class="_ _8"></span>y-</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws288">thing was an inte<span class="_ _4"></span>ger handle or a long pointer or a </div><div class="t m5 x34 h2f y396 ffb fs10 fc0 sc0 ls0 ws0">void</div><div class="t m0 x40 h14 y396 ff8 fs3 fc0 sc0 ls0 ws288">pointer<span class="_ _4"></span>, or one of sev<span class="_ _4"></span>eral implemen-</div><div class="t m0 xd h14 y43d ff8 fs3 fc0 sc0 lsd wsef">tations of “string” (with dif<span class="_ _4"></span>ferent uses and attributes). <span class="_ _4"></span>The compiler did not check types in</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">those da<span class="_ _4"></span>ys, so the programmers needed a crutch to help them remember the types. </div><div class="t m0 x74 h14 y399 ff8 fs3 fc0 sc0 ls22 ws289">In modern languages we ha<span class="_ _1"></span>ve much richer type systems, and the compilers remember</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws28a">and enforce the types. <span class="_ _4"></span>What’<span class="_ _2"></span>s more, there is a trend tow<span class="_ _1"></span>ard smaller classes and shor<span class="_ _8"></span>ter</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws28b">functions so that people can usuall<span class="_ _4"></span>y see the point of declaration of each variab<span class="_ _4"></span>le they’<span class="_ _0"></span>re</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">using.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:355.945010px;width:99.713000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:247.728010px;width:103.501000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf37" class="pf w1 h2" data-page-no="37"><div class="pc pc37 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">24<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws28c">Ja<span class="_ _4"></span>va pro<span class="_ _4"></span>grammers don’<span class="_ _4"></span>t need type encoding. Objects are strongly typed<span class="_ _1"></span>, and editing</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws28d">en<span class="_ _4"></span>vironments ha<span class="_ _4"></span>ve adv<span class="_ _4"></span>anced such that they detect a type er<span class="_ _8"></span>ror long before you can run a</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws28e">compile! So no<span class="_ _4"></span>wada<span class="_ _1"></span>ys HN and other for<span class="_ _8"></span>ms of type encoding are simply impediments.</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws28f">They make it harder to change the name or type of a v<span class="_ _1"></span>ariable, function, or class. <span class="_ _4"></span>They</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws186">make it harder to read the code. <span class="_ _1"></span>And they create the possibility that the encoding system</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">will mislead the reader<span class="_ _1"></span>.</div><div class="t m5 x74 h2f y441 ffb fs10 fc0 sc0 ls0 ws0">PhoneNumber phoneString; </div><div class="t m5 x74 h2f y442 ffb fs10 fc0 sc0 ls0 ws0">// name not changed when type changed!</div><div class="t m0 xd h11 y443 ff1 fs7 fc0 sc0 ls0 ws0">Member Pr<span class="_ _4"></span>eﬁxes</div><div class="t m0 xd h14 y444 ff8 fs3 fc0 sc0 ls0 ws290">Y<span class="_ _3"></span>ou also don’<span class="_ _4"></span>t need to preﬁx member variab<span class="_ _4"></span>les with </div><div class="t m5 x88 h2f y444 ffb fs10 fc0 sc0 ls0 ws0">m_</div><div class="t m0 x89 h14 y444 ff8 fs3 fc0 sc0 ls0 ws290">an<span class="_ _4"></span>ymore. <span class="_ _1"></span>Y<span class="_ _3"></span>our classes and func-</div><div class="t m0 xd h14 y445 ff8 fs3 fc0 sc0 ls0 ws291">tions should be small enough that you don’<span class="_ _1"></span>t need them. <span class="_ _1"></span>And you should be using an edit-</div><div class="t m0 xd h14 y446 ff8 fs3 fc0 sc0 ls0 ws0">ing en<span class="_ _4"></span>vironment that highlights or colorizes members to make them distinct.</div><div class="t m5 x74 h2f y447 ffb fs10 fc0 sc0 ls0 ws0">public class Part { </div><div class="t m5 x52 h2f y448 ffb fs10 fc0 sc0 ls0 ws0">private String m_dsc; // The textual description</div><div class="t m5 x52 h2f y449 ffb fs10 fc0 sc0 ls0 ws0">void setName(String name) {</div><div class="t m5 x8a h2f y44a ffb fs10 fc0 sc0 ls0 ws0">m_dsc = name;</div><div class="t m5 x52 h2f y44b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y44c ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y44d ffb fs10 fc0 sc0 ls0 ws0">_________________________________________________</div><div class="t m5 x74 h2f y44e ffb fs10 fc0 sc0 ls0 ws0">public class Part { </div><div class="t m5 x52 h2f y44f ffb fs10 fc0 sc0 ls0 ws0">String description;</div><div class="t m5 x52 h2f y450 ffb fs10 fc0 sc0 ls0 ws0">void setDescription(String description) { </div><div class="t m5 x8a h2f y451 ffb fs10 fc0 sc0 ls0 ws0">this.description = description;</div><div class="t m5 x52 h2f y452 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y453 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y454 ff8 fs3 fc0 sc0 ls0 ws292">Besides, people quickl<span class="_ _4"></span>y lear<span class="_ _8"></span>n to ignore the preﬁx (or sufﬁx) to see the meaningful</div><div class="t m0 xd h14 y455 ff8 fs3 fc0 sc0 ls0 ws293">part of the name. <span class="_ _4"></span>The more we read the code, the less w<span class="_ _1"></span>e see the preﬁxes. Ev<span class="_ _4"></span>entually the</div><div class="t m0 xd h14 y456 ff8 fs3 fc0 sc0 ls0 ws0">preﬁx<span class="_ _4"></span>es become unseen clutter and a marker of older code.</div><div class="t m0 xd h11 y457 ff1 fs7 fc0 sc0 ls0 ws0">Interfaces and Implementations</div><div class="t m0 xd h14 y314 ff8 fs3 fc0 sc0 lsd ws6e">These are sometimes a special case for encodings. F<span class="_ _1"></span>or example, sa<span class="_ _4"></span>y you are building an</div><div class="t m0 xd h14 y315 ff8 fs3 fc0 sc0 ls0 ws0">A<span class="fsb">BSTRACT</span><span class="ls23"> F<span class="_ _4"></span><span class="fsb ls0">ACTORY<span class="_ _18"> </span><span class="fs3 ws294">for the creation of shapes. <span class="_ _4"></span>This factor<span class="_ _8"></span>y will be an interface and will</span></span></span></div><div class="t m0 xd h14 y22a ff8 fs3 fc0 sc0 ls0 ws295">be implemented by a concrete class. <span class="_ _1"></span>What should you name them? </div><div class="t m5 x8b h2f y458 ffb fs10 fc0 sc0 ls0 ws0">IShapeFactory</div><div class="t m0 x8c h14 y458 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y459 ffb fs10 fc0 sc0 ls0 ws0">ShapeFactory</div><div class="t m0 x41 h14 y459 ff8 fs3 fc0 sc0 ls0 ws296">? I prefer to lea<span class="_ _4"></span>ve interfaces unadorned. <span class="_ _4"></span>The preceding </div><div class="t m5 x8d h2f y459 ffb fs10 fc0 sc0 ls0 ws0">I</div><div class="t m0 x60 h14 y459 ff8 fs3 fc0 sc0 ls0 ws296">, so common in</div><div class="t m0 xd h14 y45a ff8 fs3 fc0 sc0 lsc ws297">toda<span class="_ _4"></span>y’<span class="_ _2"></span>s legacy w<span class="_ _4"></span>ads, is a distraction at best and too much information at worst. I don’<span class="_ _1"></span>t</div><div class="t m0 xd h14 y45b ff8 fs3 fc0 sc0 ls0 ws298">want m<span class="_ _1"></span>y users kno<span class="_ _4"></span>wing that I’m handing them an interface. I just want them to kno<span class="_ _4"></span>w that</div><div class="t m0 xd h14 y45c ff8 fs3 fc0 sc0 ls0 ws15d">it’<span class="_ _2"></span>s a </div><div class="t m5 x8e h2f y45c ffb fs10 fc0 sc0 ls0 ws0">ShapeFactory</div><div class="t m0 x87 h14 y45c ff8 fs3 fc0 sc0 ls0 ws15d">. So if I must encode either the interface or the implementation, I choose</div><div class="t m0 xd h14 y45d ff8 fs3 fc0 sc0 ls0 ws299">the implementation. Calling it </div><div class="t m5 x8f h2f y45d ffb fs10 fc0 sc0 ls0 ws0">ShapeFactoryImp</div><div class="t m0 x66 h14 y45d ff8 fs3 fc0 sc0 ls0 ws299">, or ev<span class="_ _4"></span>en the hideous </div><div class="t m5 x82 h2f y45d ffb fs10 fc0 sc0 ls0 ws0">CShapeFactory</div><div class="t m0 x90 h14 y45d ff8 fs3 fc0 sc0 ls0 ws299">, is pref-</div><div class="t m0 xd h14 y45e ff8 fs3 fc0 sc0 ls0 ws0">erable to encoding the interface.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:474.728010px;width:87.042000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:230.728010px;width:163.318000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf38" class="pf w1 h2" data-page-no="38"><div class="pc pc38 w1 h2"><img class="bi x37 y45f w8 h27" alt="" src="bg38.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">25<span class="_ _10"></span><span class="ff1">Method Names</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">A<span class="_ _2"></span>v<span class="_ _4"></span>oid Mental Mapping</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws29a">Readers shouldn’<span class="_ _1"></span>t hav<span class="_ _4"></span>e to mentally translate y<span class="_ _4"></span>our names into other names they already</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws204">kno<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>This problem generall<span class="_ _4"></span>y arises from a choice to use neither problem domain terms</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws0">nor solution domain terms.</div><div class="t m0 x74 h14 y460 ff8 fs3 fc0 sc0 ls0 ws29b">This is a problem with single-letter v<span class="_ _4"></span>ariable names. Certainl<span class="_ _4"></span>y a loop counter may be</div><div class="t m0 xd h14 y461 ff8 fs3 fc0 sc0 ls0 ws0">named</div><div class="t m5 x1a h2f y461 ffb fs10 fc0 sc0 ls0 ws0">i</div><div class="t m0 x3f h14 y461 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x4c h2f y461 ffb fs10 fc0 sc0 ls0 ws0">j</div><div class="t m0 x91 h14 y461 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x24 h2f y461 ffb fs10 fc0 sc0 ls0 ws0">k</div><div class="t m0 x87 h14 y461 ff8 fs3 fc0 sc0 ls0 ws29c">(though ne<span class="_ _4"></span>ver </div><div class="t m5 x92 h2f y461 ffb fs10 fc0 sc0 ls0 ws0">l</div><div class="t m0 x8 h14 y461 ff8 fs3 fc0 sc0 ls0 ws29c">!) if its scope is very small and no other names can con-</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws210">ﬂict with it. <span class="_ _1"></span>This is because those single-letter names for loop counters are traditional.</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls0 ws29d">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, in most other conte<span class="_ _4"></span>xts a single-letter name is a poor choice; it’<span class="_ _2"></span>s just a place</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws1dc">holder that the reader must mentall<span class="_ _4"></span>y map to the actual concept. <span class="_ _4"></span>There can be no w<span class="_ _4"></span>orse rea-</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls0 ws0">son for using the name </div><div class="t m5 x2e h2f y39e ffb fs10 fc0 sc0 ls0 ws0">c</div><div class="t m0 xa h14 y39e ff8 fs3 fc0 sc0 ls0 ws0"> than because </div><div class="t m5 x31 h2f y39e ffb fs10 fc0 sc0 ls0 ws0">a</div><div class="t m0 x33 h14 y39e ff8 fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 x67 h2f y39e ffb fs10 fc0 sc0 ls0 ws0">b</div><div class="t m0 x1b h14 y39e ff8 fs3 fc0 sc0 ls0 ws0"> w<span class="_ _4"></span>ere already taken.</div><div class="t m0 x74 h14 y253 ff8 fs3 fc0 sc0 ls0 ws194">In general pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers are pretty smar<span class="_ _8"></span>t people. Smar<span class="_ _8"></span>t people sometimes like to sho<span class="_ _1"></span>w</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws206">off their smarts b<span class="_ _4"></span>y demonstrating their mental juggling abilities. <span class="_ _4"></span>After all, if you can reli-</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 wsf3">abl<span class="_ _4"></span>y remember that </div><div class="t m5 x5 h2f y463 ffb fs10 fc0 sc0 ls0 ws0">r</div><div class="t m0 x2e h14 y463 ff8 fs3 fc0 sc0 ls0 wsf3">is the lo<span class="_ _4"></span>w<span class="_ _4"></span>er-cased version of the url with the host and scheme</div><div class="t m0 xd h14 y3b9 ff8 fs3 fc0 sc0 ls0 ws0">remo<span class="_ _4"></span>ved<span class="_ _1"></span>, then you must clearl<span class="_ _4"></span>y be very smart.</div><div class="t m0 x74 h14 y464 ff8 fs3 fc0 sc0 ls0 ws29e">One dif<span class="_ _4"></span>ference between a smart programmer and a professional pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer is that</div><div class="t m0 xd h14 y465 ff8 fs3 fc0 sc0 ls0 wsb0">the professional understands that <span class="ffa">clarity is king</span>. Professionals use their po<span class="_ _1"></span>w<span class="_ _4"></span>ers for good</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 ls0 ws0">and write code that others can understand. </div><div class="t m0 xd h17 y467 ff1 fs9 fc0 sc0 ls0 ws0">Class Names</div><div class="t m0 xd h14 y468 ff8 fs3 fc0 sc0 ls0 ws29f">Classes and objects should ha<span class="_ _4"></span>ve noun or noun phrase names like </div><div class="t m5 x59 h2f y468 ffb fs10 fc0 sc0 ls0 ws0">Customer</div><div class="t m0 x93 h14 y468 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x94 h2f y468 ffb fs10 fc0 sc0 ls0 ws0">WikiPage</div><div class="t m0 x56 h14 y468 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y469 ffb fs10 fc0 sc0 ls0 ws0">Account</div><div class="t m0 x95 h14 y469 ff8 fs3 fc0 sc0 ls0 ws2a0">, and </div><div class="t m5 x41 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">AddressParser</div><div class="t m0 x1f h14 y469 ff8 fs3 fc0 sc0 ls0 ws2a0">. <span class="_ _1"></span>A<span class="_ _0"></span>void w<span class="_ _1"></span>ords like </div><div class="t m5 x1b h2f y469 ffb fs10 fc0 sc0 ls0 ws0">Manager</div><div class="t m0 x96 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x88 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">Processor</div><div class="t m0 x51 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x49 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">Data</div><div class="t m0 x97 h14 y469 ff8 fs3 fc0 sc0 ls0 ws2a0">, or </div><div class="t m5 x60 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">Info</div><div class="t m0 x98 h14 y469 ff8 fs3 fc0 sc0 ls0 ws2a0">in the name</div><div class="t m0 xd h14 y46a ff8 fs3 fc0 sc0 ls0 ws0">of a class. <span class="_ _1"></span>A class name should not be a verb<span class="_ _4"></span>.</div><div class="t m0 xd h17 y46b ff1 fs9 fc0 sc0 ls0 ws0">Method Names</div><div class="t m0 xd h14 y3fa ff8 fs3 fc0 sc0 ls0 ws2a1">Methods should ha<span class="_ _4"></span>ve verb or v<span class="_ _4"></span>erb phrase names like </div><div class="t m5 x85 h2f y3fa ffb fs10 fc0 sc0 ls0 ws0">postPayment</div><div class="t m0 x79 h14 y3fa ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x97 h2f y3fa ffb fs10 fc0 sc0 ls0 ws0">deletePage</div><div class="t m0 x99 h14 y3fa ff8 fs3 fc0 sc0 ls0 ws2a1">, or </div><div class="t m5 x30 h2f y3fa ffb fs10 fc0 sc0 ls0 ws0">save</div><div class="t m0 x56 h14 y3fa ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y3fb ff8 fs3 fc0 sc0 ls0 ws2a2">Accessors, mutators, and predicates should be named for their v<span class="_ _4"></span>alue and preﬁxed with </div><div class="t m5 x29 h2f y3fb ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x56 h14 y3fb ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y3fc ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x3b h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">, and </div><div class="t m5 x9a h2f y3fc ffb fs10 fc0 sc0 ls0 ws0">is</div><div class="t m0 x5f h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0"> according to the ja<span class="_ _4"></span>vabean standard.</div><div class="t m0 x66 h21 y228 ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m5 x74 h2f y46c ffb fs10 fc0 sc0 ls0 ws0">string name = employee.getName();</div><div class="t m5 x74 h2f y46d ffb fs10 fc0 sc0 ls0 ws0">customer.setName(&quot;mike&quot;);</div><div class="t m5 x74 h2f y46e ffb fs10 fc0 sc0 ls0 ws0">if (paycheck.isPosted())...</div><div class="t m0 x74 h14 y46f ff8 fs3 fc0 sc0 ls0 ws2a3">When constructors are o<span class="_ _4"></span>verloaded<span class="_ _1"></span>, use static f<span class="_ _8"></span>actory methods with names that</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls0 ws0">describe the arguments. F<span class="_ _1"></span>or example,</div><div class="t m5 x74 h2f y471 ffb fs10 fc0 sc0 ls0 ws0">Complex fulcrumPoint = Complex.FromRealNumber(23.0);</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">is generall<span class="_ _4"></span>y better than</div><div class="t m5 x74 h2f y472 ffb fs10 fc0 sc0 ls0 ws0">Complex fulcrumPoint = new Complex(23.0);</div><div class="t m0 xd h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">Consider enforcing their use b<span class="_ _4"></span>y making the cor<span class="_ _8"></span>responding constr<span class="_ _8"></span>uctors priv<span class="_ _4"></span>ate.</div><div class="t m0 xd h25 y474 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>http://ja<span class="_ _4"></span>va.sun.com/products/ja<span class="_ _4"></span>vabeans/docs/spec.html</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:138.199000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:335.945010px;width:75.823000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:255.945010px;width:90.593000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://java.sun.com/products/javabeans/docs/spec.html"><div class="d m1" style="border-style:none;position:absolute;left:90.830700px;bottom:45.249210px;width:152.183300px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf39" class="pf w1 h2" data-page-no="39"><div class="pc pc39 w1 h2"><img class="bi x67 y475 wb h34" alt="" src="bg39.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">26<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Be Cute</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws2a4">If names are too cle<span class="_ _4"></span>ver<span class="_ _4"></span>, they will be</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 wse8">memorable onl<span class="_ _4"></span>y to people who share the</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws2a5">author’<span class="_ _2"></span>s sense of humor<span class="_ _4"></span>, and only as long</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws2a6">as these people remember the joke. <span class="_ _4"></span>W<span class="_ _4"></span>ill</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws2a7">they kno<span class="_ _1"></span>w what the function named</div><div class="t m5 xd h2f y276 ffb fs10 fc0 sc0 ls0 ws0">HolyHandGrenade</div><div class="t m0 x3a h14 y276 ff8 fs3 fc0 sc0 ls0 ws2a8">is supposed to do? Sure,</div><div class="t m0 xd h14 y277 ff8 fs3 fc0 sc0 lsd ws2a9">it’<span class="_ _2"></span>s cute, but ma<span class="_ _4"></span>ybe in this case</div><div class="t m5 xd h2f y278 ffb fs10 fc0 sc0 ls0 ws0">DeleteItems</div><div class="t m0 x6d h14 y278 ff8 fs3 fc0 sc0 ls0 ws2aa">might be a better name.</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws0">Choose clarity o<span class="_ _4"></span>ver entertainment value.</div><div class="t m0 x74 h14 y27a ff8 fs3 fc0 sc0 ls0 ws2ab">Cuteness in code often appears in the form of colloquialisms or slang. F<span class="_ _4"></span>or example,</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws2ac">don’<span class="_ _1"></span>t use the name </div><div class="t m5 x7b h2f y476 ffb fs10 fc0 sc0 ls0 ws0">whack()</div><div class="t m0 x9b h14 y476 ff8 fs3 fc0 sc0 ls0 ws2ac">to mean </div><div class="t m5 x9c h2f y476 ffb fs10 fc0 sc0 ls0 ws0">kill()</div><div class="t m0 x9d h14 y476 ff8 fs3 fc0 sc0 ls0 ws2ac">. Don’<span class="_ _1"></span>t tell little culture-dependent jokes like</div><div class="t m5 xd h2f y477 ffb fs10 fc0 sc0 ls0 ws0">eatMyShorts()</div><div class="t m0 xe h14 y477 ff8 fs3 fc0 sc0 ls0 ws0">to mean </div><div class="t m5 x9e h2f y477 ffb fs10 fc0 sc0 ls0 ws0">abort()</div><div class="t m0 x84 h14 y477 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y3b9 ff8 fs3 fc0 sc0 ls0 ws0">Sa<span class="_ _4"></span>y what y<span class="_ _4"></span>ou mean. Mean what y<span class="_ _4"></span>ou say<span class="_ _0"></span>.</div><div class="t m0 xd h17 y478 ff1 fs9 fc0 sc0 ls0 ws0">Pick One <span class="_ _0"></span>W<span class="_ _2"></span>ord per Concept</div><div class="t m0 xd h14 y2da ff8 fs3 fc0 sc0 ls0 ws2ad">Pick one w<span class="_ _4"></span>ord for one abstract concept and stick with it. F<span class="_ _4"></span>or instance, it’<span class="_ _2"></span>s confusing to</div><div class="t m0 xd h14 y2db ff8 fs3 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>ve </div><div class="t m5 x7c h2f y2db ffb fs10 fc0 sc0 ls0 ws0">fetch</div><div class="t m0 x5f h14 y2db ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x1e h2f y2db ffb fs10 fc0 sc0 ls0 ws0">retrieve,</div><div class="t m0 x2e h14 y2db ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x2f h2f y2db ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x1c h14 y2db ff8 fs3 fc0 sc0 ls0 ws2ae">as equiv<span class="_ _1"></span>alent methods of different classes. Ho<span class="_ _4"></span>w do you</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws2af">remember which method name goes with w<span class="_ _4"></span>hich class? Sadly<span class="_ _0"></span>, you often ha<span class="_ _1"></span>ve to remember</div><div class="t m0 xd h14 y3a6 ff8 fs3 fc0 sc0 ls0 ws2b0">which compan<span class="_ _4"></span>y<span class="_ _0"></span>, g<span class="_ _8"></span>roup, or individual wrote the library or class in order to remember which</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc0 sc0 ls0 ws2b1">term was used. Otherwise, y<span class="_ _4"></span>ou spend an awful lot of time bro<span class="_ _1"></span>wsing through headers and</div><div class="t m0 xd h14 y3a8 ff8 fs3 fc0 sc0 ls0 ws0">pre<span class="_ _4"></span>vious code samples.</div><div class="t m0 x74 h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws2b2">Modern editing environments lik<span class="_ _4"></span>e Eclipse and IntelliJ-pro<span class="_ _4"></span>vide context-sensiti<span class="_ _4"></span>ve clues,</div><div class="t m0 xd h14 y3aa ff8 fs3 fc0 sc0 ls0 ws2b3">such as the list of methods you can call on a gi<span class="_ _4"></span>ven object. But note that the list doesn’<span class="_ _1"></span>t usu-</div><div class="t m0 xd h14 y3ab ff8 fs3 fc0 sc0 ls0 ws132">all<span class="_ _4"></span>y give y<span class="_ _4"></span>ou the comments you wrote around y<span class="_ _4"></span>our function names and parameter lists.</div><div class="t m0 xd h14 y390 ff8 fs3 fc0 sc0 ls0 ws2b4">Y<span class="_ _3"></span>ou are lucky if it giv<span class="_ _4"></span>es the parameter <span class="ffa ws0">names<span class="_ _15"> </span></span>from function declarations. <span class="_ _1"></span>The function</div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 wsaa">names ha<span class="_ _4"></span>ve to stand alone, and they ha<span class="_ _1"></span>ve to be consistent in order for you to pick the cor<span class="_ _4"></span>-</div><div class="t m0 xd h14 y47a ff8 fs3 fc0 sc0 ls0 ws0">rect method without any additional e<span class="_ _4"></span>xploration.</div><div class="t m0 x74 h14 y2fa ff8 fs3 fc0 sc0 ls0 ws2b5">Like<span class="_ _4"></span>wise, it’<span class="_ _2"></span>s confusing to hav<span class="_ _4"></span>e a </div><div class="t m5 x5c h2f y47b ffb fs10 fc0 sc0 ls0 ws0">controller</div><div class="t m0 x3c h14 y47b ff8 fs3 fc0 sc0 ls0 ws2b5">and a </div><div class="t m5 x9f h2f y47b ffb fs10 fc0 sc0 ls0 ws0">manager</div><div class="t m0 xa0 h14 y47b ff8 fs3 fc0 sc0 ls0 ws2b5">and a </div><div class="t m5 x8b h2f y47b ffb fs10 fc0 sc0 ls0 ws0">driver</div><div class="t m0 x98 h14 y47b ff8 fs3 fc0 sc0 ls0 ws2b5">in the same</div><div class="t m0 xd h14 y47c ff8 fs3 fc0 sc0 ls0 ws2b6">code base. <span class="_ _4"></span>What is the essential difference betw<span class="_ _4"></span>een a </div><div class="t m5 xa1 h2f y47c ffb fs10 fc0 sc0 ls0 ws0">DeviceManager</div><div class="t m0 x60 h14 y47c ff8 fs3 fc0 sc0 ls0 ws2b6">and a </div><div class="t m5 x99 h2f y47c ffb fs10 fc0 sc0 ls0 ws0">Protocol-</div><div class="t m5 xd h2f y47d ffb fs10 fc0 sc0 ls0 ws0">Controller</div><div class="t m0 x5f h14 y47e ff8 fs3 fc0 sc0 ls0 ws2b7">? <span class="_ _4"></span>Why are both not </div><div class="t m5 xa2 h2f y47e ffb fs10 fc0 sc0 ls0 ws0">controller</div><div class="t m0 x4b h14 y47e ff8 fs3 fc0 sc0 ls0 ws2b7">s or both not </div><div class="t m5 x89 h2f y47e ffb fs10 fc0 sc0 ls0 ws0">manager</div><div class="t m0 xa3 h14 y47e ff8 fs3 fc0 sc0 ls0 ws2b7">s? <span class="_ _1"></span>Are they both Driv<span class="_ _4"></span>ers</div><div class="t m0 xd h14 y47f ff8 fs3 fc0 sc0 ls0 ws2b8">really? <span class="_ _1"></span>The name leads you to e<span class="_ _4"></span>xpect tw<span class="_ _4"></span>o objects that hav<span class="_ _4"></span>e very different type as w<span class="_ _1"></span>ell as</div><div class="t m0 xd h14 y480 ff8 fs3 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>ving different classes.</div><div class="t m0 x74 h14 y2ec ff8 fs3 fc0 sc0 ls0 ws0">A consistent lexicon is a great boon to the programmers who must use y<span class="_ _4"></span>our code. </div><div class="t m0 xd h17 y481 ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Pun</div><div class="t m0 xd h14 y482 ff8 fs3 fc0 sc0 ls0 ws27">A<span class="_ _0"></span>v<span class="_ _4"></span>oid using the same word for tw<span class="_ _1"></span>o pur<span class="_ _8"></span>poses. Using the same ter<span class="_ _8"></span>m for tw<span class="_ _4"></span>o different ideas</div><div class="t m0 xd h14 y483 ff8 fs3 fc0 sc0 ls0 ws0">is essentiall<span class="_ _4"></span>y a pun.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:374.945010px;width:167.739000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:85.190000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:105.945010px;width:61.489000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3a" class="pf w1 h2" data-page-no="3a"><div class="pc pc3a w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">27<span class="_ _10"></span><span class="ff1">Add Meaningful Conte<span class="_ _4"></span>xt</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws221">If you follo<span class="_ _1"></span>w the “one w<span class="_ _4"></span>ord per concept” r<span class="_ _8"></span>ule, you could end up with man<span class="_ _4"></span>y classes</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws2b9">that ha<span class="_ _4"></span>ve, for example, an </div><div class="t m5 xa4 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x8f h14 y195 ff8 fs3 fc0 sc0 ls0 ws2b9">method. <span class="_ _1"></span>As long as the parameter lists and retur<span class="_ _8"></span>n values of</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">the v<span class="_ _4"></span>arious </div><div class="t m5 x4c h2f y196 ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x86 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> methods are semanticall<span class="_ _4"></span>y equiv<span class="_ _4"></span>alent, all is well.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws2ba">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er one might decide to use the word </div><div class="t m5 x23 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x54 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws2ba">for “consistency” w<span class="_ _4"></span>hen he or she is not</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 wsf7">in fact adding in the same sense. Let’<span class="_ _2"></span>s say w<span class="_ _1"></span>e hav<span class="_ _4"></span>e many classes w<span class="_ _4"></span>here </div><div class="t m5 x60 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 xa5 h14 y1bd ff8 fs3 fc0 sc0 ls0 wsf7">will create a</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws2bb">new v<span class="_ _1"></span>alue by adding or concatenating tw<span class="_ _4"></span>o existing v<span class="_ _4"></span>alues. No<span class="_ _4"></span>w let’<span class="_ _2"></span>s say w<span class="_ _1"></span>e are writing a</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws2bc">new class that has a method that puts its single parameter into a collection. Should w<span class="_ _1"></span>e call</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws49">this method </div><div class="t m5 x1e h2f y19b ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x24 h14 y19b ff8 fs3 fc0 sc0 ls0 ws49">? It might seem consistent because w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve so many other </div><div class="t m5 xa6 h2f y19b ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x94 h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">methods,</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 lsd ws2bd">but in this case, the semantics are different, so w<span class="_ _1"></span>e should use a name like </div><div class="t m5 xa7 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">insert</div><div class="t m0 x94 h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 xa8 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">append</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">instead. <span class="_ _1"></span>T<span class="_ _1"></span>o call the new method </div><div class="t m5 x1c h2f y19d ffb fs10 fc0 sc0 ls0 ws0">add</div><div class="t m0 x20 h14 y19d ff8 fs3 fc0 sc0 ls0 ws0"> w<span class="_ _4"></span>ould be a pun.</div><div class="t m0 x74 h14 y208 ff8 fs3 fc0 sc0 ls0 ws2be">Our goal, as authors, is to make our code as easy as possib<span class="_ _4"></span>le to understand. W<span class="_ _0"></span>e w<span class="_ _4"></span>ant</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws2bf">our code to be a quick skim, not an intense study<span class="_ _0"></span>. W<span class="_ _0"></span>e w<span class="_ _4"></span>ant to use the popular paperback</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws2c0">model whereb<span class="_ _4"></span>y the author is responsible for making himself clear and not the academic</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">model where it is the scholar’<span class="_ _3"></span>s job to dig the meaning out of the paper<span class="_ _4"></span>.</div><div class="t m0 xd h17 y484 ff1 fs9 fc0 sc0 ls0 ws0">Use Solution Domain Names</div><div class="t m0 xd h14 y485 ff8 fs3 fc0 sc0 ls0 ws2c1">Remember that the people who read y<span class="_ _4"></span>our code will be programmers. So go ahead and use</div><div class="t m0 xd h14 y486 ff8 fs3 fc0 sc0 ls0 ws2c2">computer science (CS) terms, algorithm names, patter<span class="_ _8"></span>n names, math ter<span class="_ _8"></span>ms, and so for<span class="_ _8"></span>th. It</div><div class="t m0 xd h14 y487 ff8 fs3 fc0 sc0 ls0 ws2c3">is not wise to dra<span class="_ _4"></span>w ev<span class="_ _4"></span>er<span class="_ _8"></span>y name from the problem domain because w<span class="_ _1"></span>e don’<span class="_ _4"></span>t want our</div><div class="t m0 xd h14 y488 ff8 fs3 fc0 sc0 ls0 ws1d7">co<span class="_ _4"></span>w<span class="_ _4"></span>orkers to ha<span class="_ _4"></span>ve to run back and for<span class="_ _8"></span>th to the customer asking what e<span class="_ _4"></span>very name means</div><div class="t m0 xd h14 y489 ff8 fs3 fc0 sc0 ls0 ws0">when the<span class="_ _4"></span>y already kno<span class="_ _4"></span>w the concept by a dif<span class="_ _4"></span>ferent name.</div><div class="t m0 x74 h14 y48a ff8 fs3 fc0 sc0 ls0 ws2c4">The name </div><div class="t m5 x39 h2f y48b ffb fs10 fc0 sc0 ls0 ws0">AccountVisitor</div><div class="t m0 x84 h14 y48b ff8 fs3 fc0 sc0 ls0 ws2c4">means a great deal to a programmer who is familiar with</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws2c5">the V<span class="fsb ws0">ISITOR<span class="_ _18"> </span></span>patter<span class="_ _8"></span>n. What pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer w<span class="_ _4"></span>ould not kno<span class="_ _4"></span>w what a </div><div class="t m5 x49 h2f y48c ffb fs10 fc0 sc0 ls0 ws0">JobQueue</div><div class="t m0 xa9 h14 y48c ff8 fs3 fc0 sc0 ls0 ws2c6">w<span class="_ _4"></span>as? There <span class="_ _5"></span>are</div><div class="t m0 xd h14 y48d ff8 fs3 fc0 sc0 ls0 ws2ab">lots of very technical things that programmers ha<span class="_ _4"></span>ve to do. Choosing technical names for</div><div class="t m0 xd h14 y48e ff8 fs3 fc0 sc0 ls0 ws0">those things is usually the most appropriate course.</div><div class="t m0 xd h17 y48f ff1 fs9 fc0 sc0 ls0 ws0">Use Pr<span class="_ _4"></span>ob<span class="_ _4"></span>lem Domain Names</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws2c7">When there is no “pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer-eese” for w<span class="_ _4"></span>hat you’<span class="_ _0"></span>re doing, use the name from the prob-</div><div class="t m0 xd h14 y2e6 ff8 fs3 fc0 sc0 ls0 wsa4">lem domain. <span class="_ _1"></span>At least the programmer who maintains y<span class="_ _4"></span>our code can ask a domain expert</div><div class="t m0 xd h14 y490 ff8 fs3 fc0 sc0 ls0 ws0">what it means.</div><div class="t m0 x74 h14 y491 ff8 fs3 fc0 sc0 ls0 ws2c8">Separating solution and problem domain concepts is part of the job of a good pro-</div><div class="t m0 xd h14 y492 ff8 fs3 fc0 sc0 ls0 ws2c9">grammer and designer<span class="_ _4"></span>. <span class="_ _4"></span>The code that has more to do with problem domain concepts</div><div class="t m0 xd h14 y493 ff8 fs3 fc0 sc0 ls0 ws0">should ha<span class="_ _4"></span>ve names dra<span class="_ _4"></span>wn from the problem domain.</div><div class="t m0 xd h17 y494 ff1 fs9 fc0 sc0 ls0 ws0">Add Meaningful Conte<span class="_ _4"></span>xt</div><div class="t m0 xd h14 y495 ff8 fs3 fc0 sc0 ls0 ws2ca">There are a fe<span class="_ _4"></span>w names which are meaningful in and of themselves—most are not. Instead<span class="_ _1"></span>,</div><div class="t m0 xd h14 y473 ff8 fs3 fc0 sc0 ls0 ws2cb">you need to place names in conte<span class="_ _4"></span>xt for your reader b<span class="_ _4"></span>y enclosing them in w<span class="_ _4"></span>ell-named</div><div class="t m0 xd h14 y496 ff8 fs3 fc0 sc0 ls0 ws2cc">classes, functions, or namespaces. <span class="_ _4"></span>When all else fails, then preﬁxing the name may be nec-</div><div class="t m0 xd h14 y497 ff8 fs3 fc0 sc0 ls0 ws0">essary as a last resor<span class="_ _8"></span>t.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:388.945010px;width:169.944000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:233.945010px;width:170.775000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:114.945010px;width:148.922000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3b" class="pf w1 h2" data-page-no="3b"><div class="pc pc3b w1 h2"><img class="bi xd y498 wc h35" alt="" src="bg3b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">28<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws2cd">Imagine that you ha<span class="_ _1"></span>ve variab<span class="_ _4"></span>les named </div><div class="t m5 xaa h2f y194 ffb fs10 fc0 sc0 ls0 ws0">firstName</div><div class="t m0 x2a h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x27 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">lastName</div><div class="t m0 xab h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x51 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">street</div><div class="t m0 xac h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x8d h2f y194 ffb fs10 fc0 sc0 ls0 ws0">houseNumber</div><div class="t m0 x36 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x30 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">city</div><div class="t m0 x56 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">state</div><div class="t m0 x7c h14 y195 ff8 fs3 fc0 sc0 ls0 ws2ce">, and </div><div class="t m5 x46 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">zipcode</div><div class="t m0 x18 h14 y195 ff8 fs3 fc0 sc0 ls0 ws2ce">. <span class="_ _1"></span>T<span class="_ _1"></span>aken together it’<span class="_ _3"></span>s pretty clear that they form an address. But what if</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws2c0">you just sa<span class="_ _1"></span>w the </div><div class="t m5 x6 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">state</div><div class="t m0 x9e h14 y196 ff8 fs3 fc0 sc0 ls0 ws2c0">v<span class="_ _4"></span>ariable being used alone in a method? <span class="_ _4"></span>W<span class="_ _0"></span>ould you automaticall<span class="_ _4"></span>y</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">infer that it w<span class="_ _4"></span>as par<span class="_ _8"></span>t of an address?</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws9">Y<span class="_ _3"></span>ou can add context by using preﬁx<span class="_ _1"></span>es: </div><div class="t m5 xad h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">addrFirstName</div><div class="t m0 x89 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xae h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">addrLastName</div><div class="t m0 x8b h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x4a h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">addrState</div><div class="t m0 x64 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws9">, and so</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 wse2">on. <span class="_ _1"></span>At least readers will understand that these variab<span class="_ _4"></span>les are par<span class="_ _8"></span>t of a larger structure. Of</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws2cf">course, a better solution is to create a class named </div><div class="t m5 x3c h2f y19a ffb fs10 fc0 sc0 ls0 ws0">Address</div><div class="t m0 x61 h14 y19a ff8 fs3 fc0 sc0 ls0 ws2cf">. <span class="_ _1"></span>Then, even the compiler kno<span class="_ _1"></span>ws</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">that the variab<span class="_ _4"></span>les belong to a bigger concept.</div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 ls0 ws2d0">Consider the method in Listing 2-1. Do the variab<span class="_ _4"></span>les need a more meaningful con-</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws2d1">text? <span class="_ _1"></span>The function name pro<span class="_ _4"></span>vides only part of the context; the algorithm pro<span class="_ _1"></span>vides the rest.</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws2d2">Once you read through the function, y<span class="_ _4"></span>ou see that the three variab<span class="_ _4"></span>les, </div><div class="t m5 xaf h2f y208 ffb fs10 fc0 sc0 ls0 ws0">number</div><div class="t m0 x70 h14 y208 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x99 h2f y208 ffb fs10 fc0 sc0 ls0 ws0">verb</div><div class="t m0 xb0 h14 y208 ff8 fs3 fc0 sc0 ls0 ws2d2">, and</div><div class="t m5 xd h2f y3ea ffb fs10 fc0 sc0 ls0 ws0">pluralModifier</div><div class="t m0 xe h14 y3ea ff8 fs3 fc0 sc0 ls0 ws2bd">, are part of the “guess statistics” message. Unfor<span class="_ _8"></span>tunately<span class="_ _0"></span>, the context must</div><div class="t m0 xd h14 y3eb ff8 fs3 fc0 sc0 ls0 ws0">be infer<span class="_ _8"></span>red. <span class="_ _4"></span>When you ﬁrst look at the method<span class="_ _1"></span>, the meanings of the variab<span class="_ _4"></span>les are opaque.</div><div class="t m0 x74 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws2d3">The function is a bit too long and the v<span class="_ _4"></span>ariables are used throughout. <span class="_ _1"></span>T<span class="_ _1"></span>o split the func-</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws2d4">tion into smaller pieces w<span class="_ _4"></span>e need to create a </div><div class="t m5 x1b h2f y400 ffb fs10 fc0 sc0 ls0 ws0">GuessStatisticsMessage</div><div class="t m0 x6b h14 y400 ff8 fs3 fc0 sc0 ls24 ws2d5">class and make the</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls17 ws2d6">three variab<span class="_ _4"></span>les ﬁelds of this class. <span class="_ _1"></span>This provides a clear conte<span class="_ _4"></span>xt for the three variab<span class="_ _4"></span>les. <span class="_ _4"></span>They</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls17 ws0">are <span class="ffa">deﬁnitivel<span class="_ _4"></span>y <span class="ff8 ws2d7">part of the </span></span></div><div class="t m5 xb1 h2f y398 ffb fs10 fc0 sc0 ls0 ws0">GuessStatisticsMessage</div><div class="t m0 x34 h14 y398 ff8 fs3 fc0 sc0 ls17 ws2d7">. <span class="_ _1"></span>The improv<span class="_ _4"></span>ement of context <span class="ls12 ws2d8">also allo<span class="_ _4"></span>ws</span></div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls12 ws265">the algorithm to be made much cleaner by <span class="_ _4"></span>breaking it into many smaller functions. <span class="ls0">(See</span></div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">Listing 2-2.) </div><div class="t m0 x74 h1c y499 ff1 fs3 fc0 sc0 ls0 ws0">Listing 2-1 </div><div class="t m0 x74 h36 y49a ffc fs3 fc0 sc0 ls0 ws0">Variables with unclear context.</div><div class="t m5 x74 h2f y49b ffb fs10 fc0 sc0 ls0 ws0">private void printGuessStatistics(char candidate, int count) {</div><div class="t m5 x74 h2f y49c ffb fs10 fc0 sc0 ls0 ws0">    String number;</div><div class="t m5 x74 h2f y49d ffb fs10 fc0 sc0 ls0 ws0">    String verb;</div><div class="t m5 x74 h2f y49e ffb fs10 fc0 sc0 ls0 ws0">    String pluralModifier;</div><div class="t m5 x74 h2f y49f ffb fs10 fc0 sc0 ls0 ws0">    if (count == 0) {</div><div class="t m5 x74 h2f y4a0 ffb fs10 fc0 sc0 ls0 ws0">      number = &quot;no&quot;;</div><div class="t m5 x74 h2f y4a1 ffb fs10 fc0 sc0 ls0 ws0">      verb = &quot;are&quot;;</div><div class="t m5 x74 h2f y4a2 ffb fs10 fc0 sc0 ls0 ws0">      pluralModifier = &quot;s&quot;;</div><div class="t m5 x74 h2f yf0 ffb fs10 fc0 sc0 ls0 ws0">    } else if (count == 1) {</div><div class="t m5 x74 h2f y4a3 ffb fs10 fc0 sc0 ls0 ws0">      number = &quot;1&quot;;</div><div class="t m5 x74 h2f y4a4 ffb fs10 fc0 sc0 ls0 ws0">      verb = &quot;is&quot;;</div><div class="t m5 x74 h2f y4a5 ffb fs10 fc0 sc0 ls0 ws0">      pluralModifier = &quot;&quot;;</div><div class="t m5 x74 h2f y4a6 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4a7 ffb fs10 fc0 sc0 ls0 ws0">      number = Integer.toString(count);</div><div class="t m5 x74 h2f y4a8 ffb fs10 fc0 sc0 ls0 ws0">      verb = &quot;are&quot;;</div><div class="t m5 x74 h2f y4a9 ffb fs10 fc0 sc0 ls0 ws0">      pluralModifier = &quot;s&quot;;</div><div class="t m5 x74 h2f y4aa ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4ab ffb fs10 fc0 sc0 ls0 ws0">    String guessMessage = String.format(</div><div class="t m5 x74 h2f y4ac ffb fs10 fc0 sc0 ls0 ws0">      &quot;There %s %s %s%s&quot;, verb, number, candidate, pluralModifier</div><div class="t m5 x74 h2f y4ad ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f y4ae ffb fs10 fc0 sc0 ls0 ws0">    print(guessMessage);</div><div class="t m5 x74 h2f y4af ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3c" class="pf w1 h2" data-page-no="3c"><div class="pc pc3c w1 h2"><img class="bi xd y4b0 wc h37" alt="" src="bg3c.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">29<span class="_ _10"></span><span class="ff1">Don’t <span class="_ _0"></span>Add Gr<span class="_ _4"></span>atuitous Context</span></div><div class="t m0 xd h17 y4b1 ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t <span class="_ _0"></span>Add Gr<span class="_ _4"></span>atuitous Context</div><div class="t m0 xd h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws8f">In an imaginary application called “Gas Station Deluxe,<span class="_ _0"></span>” it is a bad idea to preﬁx every</div><div class="t m0 xd h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws2d9">class with </div><div class="t m5 x5f h2f y4b3 ffb fs10 fc0 sc0 ls0 ws0">GSD</div><div class="t m0 x28 h14 y4b3 ff8 fs3 fc0 sc0 lsc ws2da">. Frankl<span class="_ _4"></span>y<span class="_ _0"></span>, you are w<span class="_ _4"></span>orking against your tools. <span class="_ _0"></span>Y<span class="_ _3"></span>ou type </div><div class="t m5 x97 h2f y4b3 ffb fs10 fc0 sc0 ls0 ws0">G</div><div class="t m0 xac h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws2d9">and press the com-</div><div class="t m0 xd h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws2db">pletion ke<span class="_ _4"></span>y and are rew<span class="_ _4"></span>arded with a mile-long list of ev<span class="_ _4"></span>er<span class="_ _8"></span>y class in the system. Is that</div><div class="t m0 xd h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws0">wise? <span class="_ _4"></span>Why mak<span class="_ _4"></span>e it hard for the IDE to help you? </div><div class="t m0 x74 h14 y1f8 ff8 fs3 fc0 sc0 ls0 ws2dc">Like<span class="_ _4"></span>wise, sa<span class="_ _4"></span>y you in<span class="_ _4"></span>vented a </div><div class="t m5 x20 h2f y1f8 ffb fs10 fc0 sc0 ls0 ws0">MailingAddress</div><div class="t m0 x54 h14 y1f8 ff8 fs3 fc0 sc0 ls0 ws2dc">class in </div><div class="t m5 x21 h2f y1f8 ffb fs10 fc0 sc0 ls0 ws0">GSD</div><div class="t m0 xab h14 y1f8 ff8 fs3 fc0 sc0 ls0 ws2dc">’<span class="_ _2"></span>s accounting module, and</div><div class="t m0 xd h14 y1f9 ff8 fs3 fc0 sc0 ls0 ws2dd">you named it </div><div class="t m5 x6d h2f y1f9 ffb fs10 fc0 sc0 ls0 ws0">GSDAccountAddress</div><div class="t m0 xa2 h14 y1f9 ff8 fs3 fc0 sc0 ls0 ws2dd">. Later<span class="_ _4"></span>, you need a mailing address for y<span class="_ _4"></span>our customer con-</div><div class="t m0 xd h14 y39a ff8 fs3 fc0 sc0 ls0 ws2de">tact application. Do you use </div><div class="t m5 x9b h2f y39a ffb fs10 fc0 sc0 ls0 ws0">GSDAccountAddress</div><div class="t m0 x66 h14 y39a ff8 fs3 fc0 sc0 ls0 ws2de">? Does it sound like the right name? <span class="_ _1"></span>T<span class="_ _0"></span>en of</div><div class="t m0 xd h14 y4b6 ff8 fs3 fc0 sc0 ls0 ws0">17 characters are redundant or ir<span class="_ _8"></span>relev<span class="_ _4"></span>ant.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 2-2 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Variables have a context.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public class GuessStatisticsMessage {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  private String number;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  private String verb;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private String pluralModifier;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  public String make(char candidate, int count) {</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    createPluralDependentMessageParts(count);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    return String.format(</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls1f ws236">      &quot;There %s %s %s%s&quot;, </div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls1f ws236">       verb, number, candidate, pluralModifier );</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  private void createPluralDependentMessageParts(int count) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    if (count == 0) {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      thereAreNoLetters();</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    } else if (count == 1) {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      thereIsOneLetter();</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      thereAreManyLetters(count);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  private void thereAreManyLetters(int count) {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    number = Integer.toString(count);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    verb = &quot;are&quot;;</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    pluralModifier = &quot;s&quot;;</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  private void thereIsOneLetter() {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    number = &quot;1&quot;;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    verb = &quot;is&quot;;</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    pluralModifier = &quot;&quot;;</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  private void thereAreNoLetters() {</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    number = &quot;no&quot;;</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    verb = &quot;are&quot;;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    pluralModifier = &quot;s&quot;;</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:171.945010px;width:181.071000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3d" class="pf w1 h2" data-page-no="3d"><div class="pc pc3d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">30<span class="_ _1e"> </span><span class="ff1 wsf5">Chapter 2:<span class="_ _4"></span> Meaningful Names</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws2df">Shorter names are generally better than longer ones, so long as they are clear<span class="_ _1"></span>. <span class="_ _1"></span>Add no</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">more context to a name than is necessary<span class="_ _0"></span>.</div><div class="t m0 x74 h1d y1fa ffd fs3 fc0 sc0 ls0 ws2e0">The names </div><div class="t m5 x3a h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">accountAddress</div><div class="t m0 x92 h1d y1fa ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x26 h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">customerAddress</div><div class="t m0 x40 h1d y1fa ffd fs3 fc0 sc0 ls0 ws2e0">are ﬁne names for instances of the</div><div class="t m0 xd h1d y1fb ffd fs3 fc0 sc0 ls0 ws0">class</div><div class="t m5 x7c h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">Address</div><div class="t m0 x28 h1d y1fb ffd fs3 fc0 sc0 ls0 ws2e1">but could be poor names for classes. </div><div class="t m5 xb2 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">Address</div><div class="t m0 x21 h1d y1fb ffd fs3 fc0 sc0 ls0 ws2e1">is a ﬁne name for a class. If I</div><div class="t m0 xd h1d y1bd ffd fs3 fc0 sc0 ls0 ws2e2">need to differentiate between MA<span class="_ _1"></span>C addresses, port addresses, and W<span class="_ _0"></span>eb addresses, I might</div><div class="t m0 xd h1d y1be ffd fs3 fc0 sc0 ls0 ws0">consider</div><div class="t m5 x3f h2f y1be ffb fs10 fc0 sc0 ls0 ws0">PostalAddress</div><div class="t m0 x2e h1d y1be ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xa h2f y1be ffb fs10 fc0 sc0 ls0 ws0">MAC</div><div class="t m0 x2f h1d y1be ffd fs3 fc0 sc0 ls0 ws2e3">, and </div><div class="t m5 x8 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">URI</div><div class="t m0 x43 h1d y1be ffd fs3 fc0 sc0 ls0 ws2e3">. The resulting names are more precise, which is the</div><div class="t m0 xd h1d y19a ffd fs3 fc0 sc0 ls0 ws0">point of all naming.</div><div class="t m0 xd h17 y4dc ff1 fs9 fc0 sc0 ls0 ws2e4">Final W<span class="_ _2"></span>ords</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws2e5">The hardest thing about choosing good names is that it requires good descriptiv<span class="_ _4"></span>e skills and</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 lsd ws80">a shared cultural background. <span class="_ _4"></span>This is a teaching issue rather than a technical, business, or</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">management issue. <span class="_ _1"></span>As a result many people in this ﬁeld don’<span class="_ _1"></span>t lear<span class="_ _8"></span>n to do it very well.</div><div class="t m0 x74 h14 y4de ff8 fs3 fc0 sc0 ls0 ws2e6">P<span class="_ _4"></span>eople are also afraid of renaming things for fear that some other dev<span class="_ _4"></span>elopers will</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls22 ws133">object. <span class="_ _4"></span>W<span class="_ _0"></span>e do not share that fear and ﬁnd that we are actuall<span class="_ _4"></span>y grateful when names change</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 lsc ws129">(for the better). Most of the time w<span class="_ _4"></span>e don’<span class="_ _4"></span>t really memorize the names of classes and meth-</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws2e7">ods. <span class="_ _4"></span>W<span class="_ _0"></span>e use the moder<span class="_ _8"></span>n tools to deal with details like that so w<span class="_ _4"></span>e can focus on whether the</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws84">code reads like paragraphs and sentences, or at least like tables and data structure (a sen-</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 ls0 ws2e8">tence isn’<span class="_ _1"></span>t alw<span class="_ _4"></span>a<span class="_ _4"></span>ys the best wa<span class="_ _4"></span>y to displa<span class="_ _4"></span>y data). <span class="_ _0"></span>Y<span class="_ _2"></span>ou will probabl<span class="_ _4"></span>y end up sur<span class="_ _8"></span>prising some-</div><div class="t m0 xd h14 y25b ff8 fs3 fc0 sc0 ls0 ws2e9">one when y<span class="_ _4"></span>ou rename, just like y<span class="_ _4"></span>ou might with any other code impro<span class="_ _1"></span>vement. Don’<span class="_ _4"></span>t let it</div><div class="t m0 xd h14 y25c ff8 fs3 fc0 sc0 ls0 ws0">stop you in y<span class="_ _4"></span>our tracks.</div><div class="t m0 x74 h14 y2d ff8 fs3 fc0 sc0 ls10 ws2ea">F<span class="_ _1"></span>ollow some of these rules and see whether y<span class="_ _4"></span>ou don’<span class="_ _4"></span>t impro<span class="_ _4"></span>ve the readability of y<span class="_ _4"></span>our</div><div class="t m0 xd h14 y4e3 ff8 fs3 fc0 sc0 ls10 ws2eb">code. If you are maintaining someone else’<span class="_ _3"></span>s code, use ref<span class="_ _8"></span>actoring tools to help resolve these</div><div class="t m0 xd h14 y4e4 ff8 fs3 fc0 sc0 ls10 ws0">problems. It will pa<span class="_ _1"></span>y off in the short ter<span class="_ _8"></span>m and continue to pa<span class="_ _4"></span>y in the long r<span class="_ _8"></span>un.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:475.945010px;width:72.485000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3e" class="pf w1 h2" data-page-no="3e"><div class="pc pc3e w1 h2"><img class="bi xd y4e5 w4 h38" alt="" src="bg3e.png"/><div class="t m0 x16 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">31</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">3</div><div class="t m0 xa3 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Functions</div><div class="t m0 xd h14 y4e6 ff8 fs3 fc0 sc0 ls0 ws2ec">In the earl<span class="_ _4"></span>y days of pro<span class="_ _4"></span>gramming we composed our systems of routines and subroutines.</div><div class="t m0 xd h14 y4e7 ff8 fs3 fc0 sc0 ls0 wsf6">Then, in the era of F<span class="_ _1"></span>or<span class="_ _8"></span>tran and PL/1 we composed our systems of pro<span class="_ _4"></span>grams, subprograms,</div><div class="t m0 xd h14 y4e8 ff8 fs3 fc0 sc0 ls0 ws2ed">and functions. No<span class="_ _4"></span>wada<span class="_ _1"></span>ys only the function surviv<span class="_ _4"></span>es from those early da<span class="_ _4"></span>ys. Functions are</div><div class="t m0 xd h14 y4e9 ff8 fs3 fc0 sc0 lsc ws2ee">the ﬁrst line of organization in an<span class="_ _4"></span>y program. <span class="_ _4"></span>Writing them w<span class="_ _4"></span>ell is the topic of this chapter<span class="_ _4"></span>. </div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:337.566000px;bottom:440.027010px;width:101.351000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf3f" class="pf w1 h2" data-page-no="3f"><div class="pc pc3f w1 h2"><img class="bi xd y2f0 wd h39" alt="" src="bg3f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">32<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws2ef">Consider the code in Listing 3-1. It’<span class="_ _2"></span>s hard to ﬁnd a long function in FitNesse,</div><div class="t m0 x30 h21 y4ea ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x25 h14 y194 ff8 fs3 fc0 sc0 ls25 ws0">but</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 lsd ws2f0">after a bit of searching I came across this one. Not onl<span class="_ _4"></span>y is it long, but it’<span class="_ _2"></span>s got duplicated</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws22a">code, lots of odd strings, and many strange and inob<span class="_ _1"></span>vious data types and <span class="_ _4"></span>APIs. See ho<span class="_ _4"></span>w</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">much sense you can mak<span class="_ _4"></span>e of it in the next three minutes. </div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>An open-source testing tool. www<span class="_ _0"></span>.ﬁtnese.org</div><div class="t m0 x74 h1c y4eb ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-1 </div><div class="t m0 x74 h36 y4ec ffc fs3 fc0 sc0 ls0 ws0">HtmlUtil.java (FitNesse 20070619)</div><div class="t m5 x74 h2f y4ed ffb fs10 fc0 sc0 ls14 ws235">  public static String testableHtml(</div><div class="t m5 x74 h2f y4ee ffb fs10 fc0 sc0 ls1f ws241">    PageData pageData,</div><div class="t m5 x74 h2f y4ef ffb fs10 fc0 sc0 ls1f ws2f1">    boolean includeSuiteSetup</div><div class="t m5 x74 h2f y4f0 ffb fs10 fc0 sc0 ls0 ws0">  ) throws Exception {</div><div class="t m5 x74 h2f y4f1 ffb fs10 fc0 sc0 ls0 ws0">    WikiPage wikiPage = pageData.getWikiPage();</div><div class="t m5 x74 h2f y4f2 ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer buffer = new StringBuffer();</div><div class="t m5 x74 h2f y4f3 ffb fs10 fc0 sc0 ls0 ws0">    if (pageData.hasAttribute(&quot;Test&quot;)) {</div><div class="t m5 x74 h2f y4f4 ffb fs10 fc0 sc0 ls0 ws0">      if (includeSuiteSetup) {</div><div class="t m5 x74 h2f y4f5 ffb fs10 fc0 sc0 ls0 ws0">        WikiPage suiteSetup =</div><div class="t m5 x74 h2f y4f6 ffb fs10 fc0 sc0 ls0 ws0">          PageCrawlerImpl.getInheritedPage(</div><div class="t m5 x74 h2f y4f7 ffb fs10 fc0 sc0 ls0 ws0">                  SuiteResponder.SUITE_SETUP_NAME, wikiPage</div><div class="t m5 x74 h2f y4f8 ffb fs10 fc0 sc0 ls0 ws0">          );</div><div class="t m5 x74 h2f y4f9 ffb fs10 fc0 sc0 ls0 ws0">        if (suiteSetup != null) {</div><div class="t m5 x74 h2f y4fa ffb fs10 fc0 sc0 ls0 ws0">          WikiPagePath pagePath =</div><div class="t m5 x74 h2f y4fb ffb fs10 fc0 sc0 ls26 ws2f2">            suiteSetup.getPageCrawler().getFullPath(suiteSetup);</div><div class="t m5 x74 h2f y4fc ffb fs10 fc0 sc0 ls0 ws0">          String pagePathName = PathParser.render(pagePath);</div><div class="t m5 x74 h2f y4fd ffb fs10 fc0 sc0 ls0 ws0">          buffer.append(&quot;!include -setup .&quot;)</div><div class="t m5 x74 h2f y4fe ffb fs10 fc0 sc0 ls0 ws0">                .append(pagePathName)</div><div class="t m5 x74 h2f y4ff ffb fs10 fc0 sc0 ls0 ws0">                .append(&quot;\n&quot;);</div><div class="t m5 x74 h2f y500 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y501 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y502 ffb fs10 fc0 sc0 ls0 ws0">      WikiPage setup = </div><div class="t m5 x74 h2f y503 ffb fs10 fc0 sc0 ls0 ws0">        PageCrawlerImpl.getInheritedPage(&quot;SetUp&quot;, wikiPage);</div><div class="t m5 x74 h2f y504 ffb fs10 fc0 sc0 ls0 ws0">      if (setup != null) {</div><div class="t m5 x74 h2f y505 ffb fs10 fc0 sc0 ls0 ws0">        WikiPagePath setupPath =</div><div class="t m5 x74 h2f y506 ffb fs10 fc0 sc0 ls0 ws0">          wikiPage.getPageCrawler().getFullPath(setup);</div><div class="t m5 x74 h2f y507 ffb fs10 fc0 sc0 ls0 ws0">        String setupPathName = PathParser.render(setupPath);</div><div class="t m5 x74 h2f y508 ffb fs10 fc0 sc0 ls0 ws0">        buffer.append(&quot;!include -setup .&quot;)</div><div class="t m5 x74 h2f y509 ffb fs10 fc0 sc0 ls0 ws0">              .append(setupPathName)</div><div class="t m5 x74 h2f y50a ffb fs10 fc0 sc0 ls0 ws0">              .append(&quot;\n&quot;);</div><div class="t m5 x74 h2f y50b ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y50c ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y50d ffb fs10 fc0 sc0 ls0 ws0">    buffer.append(pageData.getContent());</div><div class="t m5 x74 h2f y50e ffb fs10 fc0 sc0 ls0 ws0">    if (pageData.hasAttribute(&quot;Test&quot;)) {</div><div class="t m5 x74 h2f y50f ffb fs10 fc0 sc0 ls0 ws0">      WikiPage teardown = </div><div class="t m5 x74 h2f y510 ffb fs10 fc0 sc0 ls0 ws0">        PageCrawlerImpl.getInheritedPage(&quot;TearDown&quot;, wikiPage);</div><div class="t m5 x74 h2f y511 ffb fs10 fc0 sc0 ls0 ws0">      if (teardown != null) {</div><div class="t m5 x74 h2f y512 ffb fs10 fc0 sc0 ls0 ws0">        WikiPagePath tearDownPath =</div><div class="t m5 x74 h2f y513 ffb fs10 fc0 sc0 ls0 ws0">          wikiPage.getPageCrawler().getFullPath(teardown);</div><div class="t m5 x74 h2f y514 ffb fs10 fc0 sc0 ls0 ws0">        String tearDownPathName = PathParser.render(tearDownPath);</div><div class="t m5 x74 h2f y515 ffb fs10 fc0 sc0 ls0 ws0">        buffer.append(&quot;\n&quot;)</div><div class="t m5 x74 h2f y516 ffb fs10 fc0 sc0 ls0 ws0">              .append(&quot;!include -teardown .&quot;)</div><div class="t m5 x74 h2f y517 ffb fs10 fc0 sc0 ls0 ws0">              .append(tearDownPathName)</div><div class="t m5 x74 h2f y518 ffb fs10 fc0 sc0 ls0 ws0">              .append(&quot;\n&quot;);</div><div class="t m5 x74 h2f y519 ffb fs10 fc0 sc0 ls0 ws0">      }</div><a class="l" href="http://www.fitnese.org"><div class="d m1" style="border-style:none;position:absolute;left:171.904000px;bottom:67.249110px;width:45.515000px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf40" class="pf w1 h2" data-page-no="40"><div class="pc pc40 w1 h2"><img class="bi xd y51a wd h3a" alt="" src="bg40.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">33<span class="_ _10"></span><span class="ff1">Functions</span></div><div class="t m0 x74 h14 y51b ff8 fs3 fc0 sc0 ls0 wsae">Do you understand the function after three minutes of study? Probab<span class="_ _4"></span>ly not. <span class="_ _1"></span>There’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y51c ff8 fs3 fc0 sc0 ls0 ws2f3">too much going on in there at too many dif<span class="_ _1"></span>ferent levels of abstraction. <span class="_ _1"></span>There are strange</div><div class="t m0 xd h14 y51d ff8 fs3 fc0 sc0 ls0 ws24d">strings and odd function calls mix<span class="_ _4"></span>ed in with doubl<span class="_ _4"></span>y nested </div><div class="t m5 x62 h2f y51d ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xa0 h14 y51d ff8 fs3 fc0 sc0 ls0 ws24d">statements controlled b<span class="_ _4"></span>y</div><div class="t m0 xd h14 y51e ff8 fs3 fc0 sc0 ls0 ws0">ﬂags.</div><div class="t m0 x74 h14 y51f ff8 fs3 fc0 sc0 ls17 ws2f4">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, with just a fe<span class="_ _4"></span>w simple method extractions, some renaming, and a little</div><div class="t m0 xd h14 y520 ff8 fs3 fc0 sc0 ls17 ws2f5">restructuring, I was able to capture the intent of the function in the nine lines of Listing 3-2.</div><div class="t m0 xd h14 y521 ff8 fs3 fc0 sc0 ls0 ws0">See whether y<span class="_ _4"></span>ou can understand <span class="ffa">that</span> in the next 3 minutes.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      if (includeSuiteSetup) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">        WikiPage suiteTeardown =</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">          PageCrawlerImpl.getInheritedPage(</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">                  SuiteResponder.SUITE_TEARDOWN_NAME,</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">                  wikiPage</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">          );</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">        if (suiteTeardown != null) {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">          WikiPagePath pagePath =</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls1f ws2f6">            suiteTeardown.getPageCrawler().getFullPath (suiteTeardown);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">          String pagePathName = PathParser.render(pagePath);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">          buffer.append(&quot;!include -teardown .&quot;)</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">                .append(pagePathName)</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">                .append(&quot;\n&quot;);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    pageData.setContent(buffer.toString());</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    return pageData.getHtml();</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y524 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-2 </div><div class="t m0 x74 h36 y456 ffc fs3 fc0 sc0 ls0 ws0">HtmlUtil.java (refactored)</div><div class="t m5 x74 h2f y525 ffb fs10 fc0 sc0 ls14 ws235">  public static String renderPageWithSetupsAndTeardowns(</div><div class="t m5 x74 h2f y526 ffb fs10 fc0 sc0 ls0 ws0">    PageData pageData, boolean isSuite</div><div class="t m5 x74 h2f y527 ffb fs10 fc0 sc0 ls0 ws0">  ) throws Exception {</div><div class="t m5 x74 h2f y528 ffb fs10 fc0 sc0 ls0 ws0">    boolean isTestPage = pageData.hasAttribute(&quot;Test&quot;);</div><div class="t m5 x74 h2f y529 ffb fs10 fc0 sc0 ls0 ws0">    if (isTestPage) {</div><div class="t m5 x74 h2f y52a ffb fs10 fc0 sc0 ls0 ws0">      WikiPage testPage = pageData.getWikiPage();</div><div class="t m5 x74 h2f y52b ffb fs10 fc0 sc0 ls0 ws0">      StringBuffer newPageContent = new StringBuffer();</div><div class="t m5 x74 h2f y52c ffb fs10 fc0 sc0 ls0 ws0">      includeSetupPages(testPage, newPageContent, isSuite);</div><div class="t m5 x74 h2f y52d ffb fs10 fc0 sc0 ls0 ws0">      newPageContent.append(pageData.getContent());</div><div class="t m5 x74 h2f y52e ffb fs10 fc0 sc0 ls0 ws0">      includeTeardownPages(testPage, newPageContent, isSuite);</div><div class="t m5 x74 h2f y52f ffb fs10 fc0 sc0 ls0 ws0">      pageData.setContent(newPageContent.toString());</div><div class="t m5 x74 h2f y530 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y531 ffb fs10 fc0 sc0 ls0 ws0">    return pageData.getHtml();</div><div class="t m5 x74 h2f y532 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">HtmlUtil.java (FitNesse 20070619)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf41" class="pf w1 h2" data-page-no="41"><div class="pc pc41 w1 h2"><img class="bi x37 y533 w8 h27" alt="" src="bg41.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">34<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws2f7">Unless you are a student of F<span class="_ _4"></span>itNesse, you probab<span class="_ _4"></span>ly don’<span class="_ _1"></span>t understand all the details.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws2f8">Still, you probab<span class="_ _4"></span>ly understand that this function performs the inclusion of some setup and</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws2f9">teardo<span class="_ _4"></span>wn pages into a test page and then renders that page into HTML. If you are familiar</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 wsd1">with JUnit,</div><div class="t m0 xb3 h21 y534 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x41 h14 y197 ff8 fs3 fc0 sc0 ls0 wsd1">you probab<span class="_ _4"></span>ly realize that this function belongs to some kind of <span class="_ _1"></span>W<span class="_ _0"></span>eb-based</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls10 ws1a6">testing framew<span class="_ _1"></span>ork. <span class="_ _4"></span>And<span class="_ _1"></span>, of course, that is cor<span class="_ _8"></span>rect. Divining that information from Listing 3-2</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 lsd wsef">is pretty easy<span class="_ _0"></span>, but it’<span class="_ _2"></span>s pretty well obscured b<span class="_ _4"></span>y Listing 3-1. </div><div class="t m0 x74 h14 y19a ff8 fs3 fc0 sc0 ls0 ws4e">So what is it that mak<span class="_ _4"></span>es a function like Listing 3-2 easy to read and understand? Ho<span class="_ _4"></span>w</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 lsd ws2fa">can w<span class="_ _4"></span>e make a function communicate its intent? <span class="_ _4"></span>What attributes can we gi<span class="_ _4"></span>ve our functions</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">that will allo<span class="_ _4"></span>w a casual reader to intuit the kind of program they li<span class="_ _4"></span>ve inside?</div><div class="t m0 xd h17 y535 ff1 fs9 fc0 sc0 ls0 ws0">Small!</div><div class="t m0 xd h14 y536 ff8 fs3 fc0 sc0 ls0 ws7d">The ﬁrst rule of functions is that they should be small. <span class="_ _4"></span>The second rule of functions is that</div><div class="t m0 xd h14 y537 ffa fs3 fc0 sc0 ls0 ws2fb">they should be smaller than that<span class="ff8">. <span class="_ _1"></span>This is not an asser<span class="_ _8"></span>tion that I can justify<span class="_ _0"></span>. I can’<span class="_ _4"></span>t pro<span class="_ _4"></span>vide</span></div><div class="t m0 xd h14 y538 ff8 fs3 fc0 sc0 ls0 ws270">an<span class="_ _4"></span>y references to research that shows that v<span class="_ _4"></span>er<span class="_ _8"></span>y small functions are better<span class="_ _1"></span>. What I can tell</div><div class="t m0 xd h14 y464 ff8 fs3 fc0 sc0 ls0 ws2fc">you is that for nearl<span class="_ _4"></span>y four decades I ha<span class="_ _4"></span>ve written functions of all dif<span class="_ _4"></span>ferent sizes. I’<span class="_ _4"></span>ve writ-</div><div class="t m0 xd h14 y465 ff8 fs3 fc0 sc0 ls0 ws22">ten sev<span class="_ _4"></span>eral nasty 3,000-line abominations. I’<span class="_ _4"></span>ve written scads of functions in the 100 to 300</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 ls0 ws2fd">line range. <span class="_ _1"></span>And I’<span class="_ _4"></span>ve written functions that w<span class="_ _4"></span>ere 20 to 30 lines long. What this e<span class="_ _4"></span>xperience</div><div class="t m0 xd h14 y539 ff8 fs3 fc0 sc0 ls0 ws0">has taught me, through long trial and er<span class="_ _8"></span>ror<span class="_ _4"></span>, is that functions should be very small.</div><div class="t m0 x74 h14 y487 ff8 fs3 fc0 sc0 ls0 ws248">In the eighties w<span class="_ _4"></span>e used to sa<span class="_ _4"></span>y that a function should be no bigger than a screen-full.</div><div class="t m0 xd h14 y488 ff8 fs3 fc0 sc0 ls0 ws2fe">Of course w<span class="_ _4"></span>e said that at a time when VT100 screens w<span class="_ _4"></span>ere 24 lines b<span class="_ _4"></span>y 80 columns, and</div><div class="t m0 xd h14 y489 ff8 fs3 fc0 sc0 ls0 ws2ff">our editors used 4 lines for administrati<span class="_ _4"></span>ve pur<span class="_ _8"></span>poses. No<span class="_ _4"></span>wada<span class="_ _4"></span>ys with a cranked-do<span class="_ _1"></span>wn font</div><div class="t m0 xd h14 y53a ff8 fs3 fc0 sc0 ls0 ws2e9">and a nice big monitor<span class="_ _4"></span>, you can ﬁt 150 characters on a line and a 100 lines or more on a</div><div class="t m0 xd h14 y53b ff8 fs3 fc0 sc0 ls0 ws240">screen. Lines should not be 150 characters long. Functions should not be 100 lines long.</div><div class="t m0 xd h14 y53c ff8 fs3 fc0 sc0 ls0 ws0">Functions should hardl<span class="_ _4"></span>y ever be 20 lines long. </div><div class="t m0 x74 h14 y53d ff8 fs3 fc0 sc0 ls0 ws17c">Ho<span class="_ _4"></span>w short should a function be? In 1999 I went to visit K<span class="_ _4"></span>ent Beck at his home in Ore-</div><div class="t m0 xd h14 y53e ff8 fs3 fc0 sc0 ls0 ws300">gon. <span class="_ _4"></span>W<span class="_ _0"></span>e sat down and did some pro<span class="_ _1"></span>g<span class="_ _8"></span>ramming together<span class="_ _1"></span>. <span class="_ _4"></span>At one point he sho<span class="_ _4"></span>w<span class="_ _4"></span>ed me a cute</div><div class="t m0 xd h14 y53f ff8 fs3 fc0 sc0 ls0 ws301">little Ja<span class="_ _4"></span>va/Swing pro<span class="_ _4"></span>gram that he called <span class="ffa ws0">Sparkle</span>. It produced a visual ef<span class="_ _4"></span>fect on the screen</div><div class="t m0 xd h14 y540 ff8 fs3 fc0 sc0 ls0 ws302">very similar to the magic wand of the fairy godmother in the mo<span class="_ _4"></span>vie Cinderella. <span class="_ _4"></span>As you</div><div class="t m0 xd h14 y541 ff8 fs3 fc0 sc0 ls0 ws303">mo<span class="_ _4"></span>ved the mouse, the sparkles w<span class="_ _1"></span>ould drip from the cursor with a satisfying scintillation,</div><div class="t m0 xd h14 y542 ff8 fs3 fc0 sc0 ls0 ws304">falling to the bottom of the windo<span class="_ _4"></span>w through a simulated g<span class="_ _8"></span>ra<span class="_ _4"></span>vitational ﬁeld. When K<span class="_ _4"></span>ent</div><div class="t m0 xd h14 y543 ff8 fs3 fc0 sc0 ls0 ws305">sho<span class="_ _4"></span>w<span class="_ _4"></span>ed me the code, I was struck by ho<span class="_ _1"></span>w small all the functions were. I w<span class="_ _4"></span>as used to func-</div><div class="t m0 xd h14 y3ad ff8 fs3 fc0 sc0 ls0 ws51">tions in Swing pro<span class="_ _4"></span>g<span class="_ _8"></span>rams that took up miles of vertical space. Every function in <span class="ffa ws0">this<span class="_ _16"> </span><span class="ff8">pro-</span></span></div><div class="t m0 xd h14 y544 ff8 fs3 fc0 sc0 ls0 ws306">gram was just tw<span class="_ _4"></span>o, or three, or four lines long. Each w<span class="_ _4"></span>as transparently ob<span class="_ _4"></span>vious. Each told</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls0 wsd2">a story<span class="_ _1"></span>. <span class="_ _4"></span>And each led you to the ne<span class="_ _4"></span>xt in a compelling order<span class="_ _4"></span>. <span class="_ _1"></span><span class="ffa ws0">That’<span class="_ _2"></span>s <span class="ff8 wsd2">ho<span class="_ _4"></span>w short your functions</span></span></div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws0">should be!</div><div class="t m0 x5f h21 y2eb ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xd h25 y545 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>An open-source unit-testing tool for Ja<span class="_ _4"></span>va. www<span class="_ _0"></span>.junit.org</div><div class="t m0 xd h25 y546 ff8 fse fc0 sc0 ls13 ws162">3.<span class="_ _17"> </span>I ask<span class="_ _4"></span>ed Kent whether he still had a cop<span class="_ _4"></span>y<span class="_ _1"></span>, but he was unable to ﬁnd one. I searched all m<span class="_ _4"></span>y old computers too, but to no av<span class="_ _4"></span>ail.</div><div class="t m0 x3b h25 y547 ff8 fse fc0 sc0 ls0 ws0">All that is left no<span class="_ _4"></span>w is my memory of that program.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:451.945010px;width:38.892000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.junit.org"><div class="d m1" style="border-style:none;position:absolute;left:208.810000px;bottom:79.249110px;width:40.077000px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf42" class="pf w1 h2" data-page-no="42"><div class="pc pc42 w1 h2"><img class="bi xd y548 wc h3b" alt="" src="bg42.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">35<span class="_ _10"></span><span class="ff1">Do One <span class="_ _1"></span>Thing</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls10 wsa4">Ho<span class="_ _4"></span>w short should your functions be? <span class="_ _4"></span>They should usuall<span class="_ _4"></span>y be shorter than Listing 3-2!</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">Indeed<span class="_ _1"></span>, Listing 3-2 should really be shortened to Listing 3-3.</div><div class="t m0 xd h11 y549 ff1 fs7 fc0 sc0 ls0 ws0">Blocks and Indenting</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws1d7">This implies that the blocks within </div><div class="t m5 x77 h2f y20a ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x5c h14 y20a ff8 fs3 fc0 sc0 ls0 ws0">statements,</div><div class="t m5 x54 h2f y20a ffb fs10 fc0 sc0 ls0 ws0">else</div><div class="t m0 x85 h14 y20a ff8 fs3 fc0 sc0 ls0 ws0">statements,</div><div class="t m5 x58 h2f y20a ffb fs10 fc0 sc0 ls0 ws0">while</div><div class="t m0 x6f h14 y20a ff8 fs3 fc0 sc0 ls0 ws1d7">statements, and</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 ls0 ws307">so on should be one line long. Probabl<span class="_ _4"></span>y that line should be a function call. Not onl<span class="_ _4"></span>y does</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 lsd ws308">this keep the enclosing function small, but it also adds documentary value because the</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 ls0 ws0">function called within the block can ha<span class="_ _1"></span>ve a nicely descripti<span class="_ _4"></span>ve name.</div><div class="t m0 x74 h14 y54a ff8 fs3 fc0 sc0 ls0 ws11e">This also implies that functions should not be large enough to hold nested structures.</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws309">Therefore, the indent lev<span class="_ _4"></span>el of a function should not be greater than one or two. <span class="_ _1"></span>This, of</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">course, makes the functions easier to read and understand.</div><div class="t m0 xd h17 y54d ff1 fs9 fc0 sc0 ls0 ws0">Do One <span class="_ _0"></span>Thing</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls0 ws13a">It should be very clear that Listing 3-1 is doing lots</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 lsd wse7">more than one thing. It’<span class="_ _2"></span>s creating buffers, fetching</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 ls0 wse4">pages, searching for inherited pages, rendering paths,</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws30a">appending arcane strings, and generating HTML,</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 lsd ws30b">among other things. Listing 3-1 is very busy doing</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws30c">lots of different things. On the other hand<span class="_ _0"></span>, Listing 3-3</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws30d">is doing one simple thing. It’<span class="_ _2"></span>s including setups and</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws0">teardo<span class="_ _4"></span>wns into test pages. </div><div class="t m0 x74 h14 y229 ff8 fs3 fc0 sc0 ls0 ws30e">The follo<span class="_ _4"></span>wing advice has appeared in one form</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws0">or another for 30 years or more.</div><div class="t m0 x3f h1b y551 ff5 fs2 fc0 sc0 ls0 ws0">F<span class="fs13">UNCTIONS<span class="_ _a"> </span>SHOULD<span class="_ _a"> </span>DO<span class="_ _a"> </span>ONE<span class="_ _a"> </span>THING</span>. T<span class="fs13">HEY<span class="_ _a"> </span>SHOULD<span class="_ _a"> </span>DO<span class="_ _a"> </span>IT<span class="_ _a"> </span>WELL</span>.</div><div class="t m0 x3f h1b y552 ff5 fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 x5f h1b y553 ff5 fs13 fc0 sc0 ls0 ws0">HEY<span class="_ _a"> </span>SHOULD<span class="_ _a"> </span>DO<span class="_ _a"> </span>IT<span class="_ _a"> </span>ONLY<span class="fs2">.</span></div><div class="t m0 x74 h14 y2ec ff8 fs3 fc0 sc0 ls0 ws30f">The problem with this statement is that it is hard to kno<span class="_ _1"></span>w what “one thing” is. Does</div><div class="t m0 xd h14 y554 ff8 fs3 fc0 sc0 ls0 ws0">Listing 3-3 do one thing? It’<span class="_ _2"></span>s easy to make the case that it’<span class="_ _2"></span>s doing three things: </div><div class="t m0 x47 h14 y555 ffe fsb fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span><span class="ff8 fs3">Determining whether the page is a test page. </span></div><div class="t m0 x47 h14 y556 ffe fsb fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span><span class="ff8 fs3">If so, including setups and teardo<span class="_ _1"></span>wns. </span></div><div class="t m0 x47 h14 y557 ffe fsb fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span><span class="ff8 fs3">Rendering the page in HTML.</span></div><div class="t m0 x74 h1c y558 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-3 </div><div class="t m0 x74 h36 y559 ffc fs3 fc0 sc0 ls0 ws0">HtmlUtil.java (re-refactored)</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls14 ws235">  public static String renderPageWithSetupsAndTeardowns(</div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">    PageData pageData, boolean isSuite) throws Exception {</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">    if (isTestPage(pageData))</div><div class="t m5 x74 h2f y55d ffb fs10 fc0 sc0 ls0 ws0">      includeSetupAndTeardownPages(pageData, isSuite);</div><div class="t m5 x74 h2f y55e ffb fs10 fc0 sc0 ls0 ws0">    return pageData.getHtml();</div><div class="t m5 x74 h2f y55f ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:451.728010px;width:109.367000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:322.945010px;width:83.960000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf43" class="pf w1 h2" data-page-no="43"><div class="pc pc43 w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bg43.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">36<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws310">So which is it? Is the function doing one thing or three things? Notice that the three</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 wsce">steps of the function are one le<span class="_ _4"></span>vel of abstraction belo<span class="_ _4"></span>w the stated name of the function. W<span class="_ _2"></span>e</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">can describe the function b<span class="_ _4"></span>y describing it as a brief <span class="ffa ls27">TO</span></div><div class="t m0 x27 h21 y560 ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x17 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> paragraph:</div><div class="t m0 x74 h29 y561 ffa fsf fc0 sc0 ls0 ws311">T<span class="_ _4"></span>O RenderP<span class="_ _1"></span>ageW<span class="_ _1"></span>ithSetupsAndT<span class="_ _1"></span>ear<span class="_ _4"></span>downs, we c<span class="_ _4"></span>heck to see whether the pa<span class="_ _4"></span>ge is a test pag<span class="_ _4"></span>e</div><div class="t m0 x74 h29 y562 ffa fsf fc0 sc0 ls0 ws312">and if so<span class="_ _4"></span>, we include the setups and tear<span class="_ _1"></span>downs. In either case we r<span class="_ _4"></span>ender the pag<span class="_ _4"></span>e in</div><div class="t m0 x74 h29 y563 ffa fsf fc0 sc0 ls0 ws0">HTML.</div><div class="t m0 x74 h14 y19b ff8 fs3 fc0 sc0 ls0 ws313">If a function does onl<span class="_ _4"></span>y those steps that are one level belo<span class="_ _1"></span>w the stated name of the</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws314">function, then the function is doing one thing. <span class="_ _1"></span>After all, the reason we write functions is to</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 wsce">decompose a larger concept (in other w<span class="_ _1"></span>ords, the name of the function) into a set of steps at</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws0">the next le<span class="_ _4"></span>vel of abstraction.</div><div class="t m0 x74 h14 y21a ff8 fs3 fc0 sc0 ls0 ws315">It should be very clear that Listing 3-1 contains steps at many dif<span class="_ _4"></span>ferent le<span class="_ _4"></span>vels of</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws140">abstraction. So it is clearl<span class="_ _4"></span>y doing more than one thing. Even Listing 3-2 has tw<span class="_ _4"></span>o lev<span class="_ _4"></span>els of</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws316">abstraction, as pro<span class="_ _4"></span>ved b<span class="_ _4"></span>y our ability to shrink it do<span class="_ _4"></span>wn. But it w<span class="_ _4"></span>ould be very hard to mean-</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws317">ingfull<span class="_ _4"></span>y shrink Listing 3-3. W<span class="_ _0"></span>e could extract the </div><div class="t m5 xb4 h2f y564 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x85 h14 y564 ff8 fs3 fc0 sc0 ls0 ws317">statement into a function named</div><div class="t m5 xd h2f y565 ffb fs10 fc0 sc0 ls0 ws0">includeSetupsAndTeardownsIfTestPage</div><div class="t m0 x9c h14 y565 ff8 fs3 fc0 sc0 lsd ws318">, but that simpl<span class="_ _4"></span>y restates the code without changing</div><div class="t m0 xd h14 y566 ff8 fs3 fc0 sc0 ls0 ws0">the le<span class="_ _4"></span>vel of abstraction.</div><div class="t m0 x74 h14 y567 ff8 fs3 fc0 sc0 ls0 ws319">So, another w<span class="_ _4"></span>ay to kno<span class="_ _1"></span>w that a function is doing more than “one thing” is if you can</div><div class="t m0 xd h14 y568 ff8 fs3 fc0 sc0 ls0 ws31a">extract another function from it with a name that is not merel<span class="_ _4"></span>y a restatement of its imple-</div><div class="t m0 xd h14 y569 ff8 fs3 fc0 sc0 ls0 ws0">mentation [G34].</div><div class="t m0 xd h11 y56a ff1 fs7 fc0 sc0 ls0 ws0">Sections within Functions</div><div class="t m0 xd h14 y469 ff8 fs3 fc0 sc0 ls0 ws31b">Look at Listing 4-7 on page 71. Notice that the </div><div class="t m5 x3c h2f y469 ffb fs10 fc0 sc0 ls0 ws0">generatePrimes</div><div class="t m0 xb5 h14 y469 ff8 fs3 fc0 sc0 ls0 ws31b">function is di<span class="_ _4"></span>vided into</div><div class="t m0 xd h14 y46a ff8 fs3 fc0 sc0 ls0 ws31c">sections such as <span class="ffa ws0">declar<span class="_ _1"></span>ations<span class="ff8">,<span class="_ _15"> </span></span>initializations<span class="ff8 ws31c">, and </span>sieve<span class="ff8 ws31c">. <span class="_ _1"></span>This is an obvious symptom of</span></span></div><div class="t m0 xd h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws93">doing more than one thing. Functions that do one thing cannot be reasonabl<span class="_ _4"></span>y di<span class="_ _4"></span>vided into</div><div class="t m0 xd h14 y3aa ff8 fs3 fc0 sc0 ls0 ws0">sections.</div><div class="t m0 xd h17 y56b ff1 fs9 fc0 sc0 ls0 ws0">One Le<span class="_ _4"></span>v<span class="_ _4"></span>el of <span class="_ _0"></span>Abstraction per Function</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws229">In order to make sure our functions are doing “one thing,<span class="_ _0"></span>” we need to make sure that the</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls0 ws26c">statements within our function are all at the same lev<span class="_ _4"></span>el of abstraction. It is easy to see ho<span class="_ _4"></span>w</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws71">Listing 3-1 violates this rule. <span class="_ _4"></span>There are concepts in there that are at a very high level of</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws31d">abstraction, such as </div><div class="t m5 x7b h2f y3ff ffb fs10 fc0 sc0 ls0 ws0">getHtml()</div><div class="t m0 x1 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws31d">; others that are at an intermediate level of abstraction, such</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">as:</div><div class="t m5 x19 h2f y400 ffb fs10 fc0 sc0 ls0 ws31e">String pagePathName = PathParser.render(pagePath)</div><div class="t m0 xb6 h14 y400 ff8 fs3 fc0 sc0 ls0 ws2fe">; and still others that are remark-</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">abl<span class="_ _4"></span>y lo<span class="_ _4"></span>w lev<span class="_ _4"></span>el, such as: </div><div class="t m5 x9e h2f y397 ffb fs10 fc0 sc0 ls0 ws0">.append(&quot;\n&quot;)</div><div class="t m0 x9c h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y401 ff8 fs3 fc0 sc0 ls0 ws31f">Mixing le<span class="_ _4"></span>vels of abstraction within a function is al<span class="_ _4"></span>wa<span class="_ _4"></span>ys confusing. Readers ma<span class="_ _4"></span>y not</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws320">be able to tell w<span class="_ _4"></span>hether a particular expression is an essential concept or a detail. W<span class="_ _2"></span>orse,</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws321">4.<span class="_ _17"> </span>The LOGO language used the k<span class="_ _4"></span>eyword “T<span class="_ _1"></span>O” in the same way that Rub<span class="_ _4"></span>y and Python use “def.<span class="_ _4"></span>” So every function began with </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">the w<span class="_ _4"></span>ord “TO<span class="_ _4"></span>.<span class="_ _4"></span>” <span class="_ _4"></span>This had an interesting effect on the w<span class="_ _4"></span>ay functions w<span class="_ _4"></span>ere designed. </div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:321.728010px;width:131.351000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:231.945010px;width:229.355000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf44" class="pf w1 h2" data-page-no="44"><div class="pc pc44 w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bg44.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">37<span class="_ _10"></span><span class="ff1">Switch Statements</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws322">like broken windo<span class="_ _1"></span>ws, once details are mixed with essential concepts, more and more</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">details tend to accrete within the function.</div><div class="t m0 xd h11 y56c ff1 fs7 fc0 sc0 ls0 ws0">Reading Code fr<span class="_ _4"></span>om <span class="_ _1"></span>T<span class="_ _0"></span>op to Bottom:<span class="_ _4"></span> <span class="ff5">The Stepdo<span class="_ _4"></span>wn Rule</span></div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 wsdc">W<span class="_ _0"></span>e want the code to read lik<span class="_ _4"></span>e a top-do<span class="_ _4"></span>wn nar<span class="_ _8"></span>rative.</div><div class="t m0 x2a h21 y56d ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 xb7 h14 y2a6 ff8 fs3 fc0 sc0 ls0 wsdc">W<span class="_ _0"></span>e want e<span class="_ _4"></span>very function to be fol-</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws79">lo<span class="_ _4"></span>w<span class="_ _4"></span>ed by those at the ne<span class="_ _4"></span>xt level of abstraction so that w<span class="_ _1"></span>e can read the program, descending</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls22 ws21">one lev<span class="_ _4"></span>el of abstraction at a time as w<span class="_ _4"></span>e read do<span class="_ _4"></span>wn the list of functions. I call this <span class="_ _4"></span><span class="ffa ls0 ws323">The Step-</span></div><div class="t m0 xd h14 y56f ffa fs3 fc0 sc0 ls0 ws0">down Rule<span class="ff8">.</span></div><div class="t m0 x74 h14 y2aa ff8 fs3 fc0 sc0 ls0 ws324">T<span class="_ _0"></span>o say this dif<span class="_ _4"></span>ferently<span class="_ _0"></span>, w<span class="_ _4"></span>e want to be ab<span class="_ _4"></span>le to read the program as though it w<span class="_ _4"></span>ere a set</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws0">of<span class="_ _16"> </span><span class="ffa ls27">TO<span class="_ _16"> </span></span><span class="ws1e7">parag<span class="_ _8"></span>raphs, each of which is describing the current lev<span class="_ _4"></span>el of abstraction and refer-</span></div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws0">encing subsequent <span class="_ _1"></span><span class="ffa ls27">TO<span class="_ _8"></span><span class="ff8 ls0"> parag<span class="_ _8"></span>raphs at the next lev<span class="_ _4"></span>el do<span class="_ _4"></span>wn. </span></span></div><div class="t m0 x74 h29 y571 ffa fsf fc0 sc0 ls28 ws2ca">T<span class="_ _0"></span>o include the setups and tear<span class="_ _4"></span>downs, we inc<span class="_ _4"></span>lude setups, then we inc<span class="_ _4"></span>lude the test page con-</div><div class="t m0 x74 h29 y572 ffa fsf fc0 sc0 ls0 ws0">tent, and then we inc<span class="_ _4"></span>lude the teardo<span class="_ _4"></span>wns.</div><div class="t m0 x95 h29 y573 ffa fsf fc0 sc0 ls0 ws325">T<span class="_ _0"></span>o include the setups, we inc<span class="_ _4"></span>lude the suite setup if this is a suite, then we inc<span class="_ _4"></span>lude the</div><div class="t m0 x74 h29 y574 ffa fsf fc0 sc0 ls0 ws0">r<span class="_ _4"></span>egular setup.</div><div class="t m0 x95 h29 y575 ffa fsf fc0 sc0 ls0 ws326">T<span class="_ _0"></span>o include the suite setup, we sear<span class="_ _4"></span>ch the par<span class="_ _1"></span>ent hierar<span class="_ _1"></span>chy for the <span class="_ _0"></span>“SuiteSetUp” page</div><div class="t m0 x74 h29 y576 ffa fsf fc0 sc0 ls0 ws0">and add an include statement with the path of that pa<span class="_ _4"></span>ge.</div><div class="t m0 x95 h29 y577 ffa fsf fc0 sc0 ls0 ws0">T<span class="_ _0"></span>o searc<span class="_ _4"></span>h the parent. . .</div><div class="t m0 x74 h14 y578 ff8 fs3 fc0 sc0 ls0 ws294">It turns out to be very difﬁcult for pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers to lear<span class="_ _8"></span>n to follo<span class="_ _4"></span>w this r<span class="_ _8"></span>ule and write</div><div class="t m0 xd h14 y579 ff8 fs3 fc0 sc0 ls0 ws327">functions that sta<span class="_ _4"></span>y at a single lev<span class="_ _4"></span>el of abstraction. But lear<span class="_ _8"></span>ning this trick is also very</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws2ac">important. It is the key to keeping functions short and making sure they do “one thing.<span class="_ _0"></span>”</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls0 ws328">Making the code read like a top-do<span class="_ _1"></span>wn set of <span class="_ _4"></span><span class="ffa ls27 ws0">TO<span class="_ _16"> </span><span class="ff8 ls0 ws328">parag<span class="_ _8"></span>raphs is an effecti<span class="_ _4"></span>ve technique for</span></span></div><div class="t m0 xd h14 y57c ff8 fs3 fc0 sc0 ls0 ws0">keeping the abstraction le<span class="_ _4"></span>vel consistent.</div><div class="t m0 x74 h14 y57d ff8 fs3 fc0 sc0 ls29 ws329">T<span class="_ _0"></span>ake a look at Listing 3-7 at the end of this chapter<span class="_ _4"></span>. It sho<span class="_ _4"></span>ws the whole</div><div class="t m5 xd h2f y57e ffb fs10 fc0 sc0 ls2a ws0">testableHtml</div><div class="t m0 x14 h14 y57e ff8 fs3 fc0 sc0 ls29 ws32a">function refactored according to the principles described here. Notice</div><div class="t m0 xd h14 y57f ff8 fs3 fc0 sc0 ls29 ws98">ho<span class="_ _4"></span>w each function introduces the next, and each function remains at a consistent le<span class="_ _4"></span>vel</div><div class="t m0 xd h14 y580 ff8 fs3 fc0 sc0 ls29 ws0">of abstraction.</div><div class="t m0 xd h17 y581 ff1 fs9 fc0 sc0 ls0 ws0">Switch Statements</div><div class="t m0 xd h14 y582 ff8 fs3 fc0 sc0 ls0 ws223">It’<span class="_ _2"></span>s hard to make a small </div><div class="t m5 xa h2f y582 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xa2 h14 y582 ff8 fs3 fc0 sc0 ls0 ws0">statement.</div><div class="t m0 xb8 h21 y583 ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 xad h14 y582 ff8 fs3 fc0 sc0 ls0 ws223">Even a </div><div class="t m5 x54 h2f y582 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x61 h14 y582 ff8 fs3 fc0 sc0 ls0 ws223">statement with onl<span class="_ _4"></span>y two cases is</div><div class="t m0 xd h14 y584 ff8 fs3 fc0 sc0 ls0 ws32b">larger than I’<span class="_ _3"></span>d like a single block or function to be. It’<span class="_ _3"></span>s also hard to make a </div><div class="t m5 xa5 h2f y584 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xb0 h14 y584 ff8 fs3 fc0 sc0 ls0 ws0">state-</div><div class="t m0 xd h14 y585 ff8 fs3 fc0 sc0 ls0 wse4">ment that does one thing. By their nature, </div><div class="t m5 x4b h2f y585 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x3d h14 y585 ff8 fs3 fc0 sc0 ls0 wse4">statements al<span class="_ _4"></span>wa<span class="_ _1"></span>ys do <span class="ffa ws0">N<span class="_ _a"> </span></span>things. Unfor<span class="_ _8"></span>tu-</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws32c">nately w<span class="_ _1"></span>e can’<span class="_ _4"></span>t al<span class="_ _4"></span>wa<span class="_ _4"></span>ys a<span class="_ _4"></span>void </div><div class="t m5 x1 h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x9c h14 y3e5 ff8 fs3 fc0 sc0 ls2b ws32d">statements, but w<span class="_ _4"></span>e <span class="ffa ls0 ws0">can<span class="_ _15"> </span><span class="ff8 ws32c">make sure that each </span></span></div><div class="t m5 xa8 h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 lsd ws2b5">statement is buried in a lo<span class="_ _4"></span>w-lev<span class="_ _4"></span>el class and is nev<span class="_ _4"></span>er repeated. W<span class="_ _2"></span>e do this, of course, with</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">polymorphism.</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>[KP78], p. 37.</div><div class="t m0 xd h25 y39b ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _17"> </span>And<span class="_ _1"></span>, of course, I include if/else chains in this.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:546.728010px;width:279.011000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:211.945010px;width:110.039000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf45" class="pf w1 h2" data-page-no="45"><div class="pc pc45 w1 h2"><img class="bi xd y586 wc h3c" alt="" src="bg45.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">38<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws32e">Consider Listing 3-4. It sho<span class="_ _4"></span>ws just one of the operations that might depend on the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">type of emplo<span class="_ _4"></span>yee. </div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws32f">There are se<span class="_ _4"></span>veral problems with this function. F<span class="_ _4"></span>irst, it’<span class="_ _2"></span>s large, and w<span class="_ _4"></span>hen new</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 wsd4">emplo<span class="_ _4"></span>yee types are added<span class="_ _0"></span>, it will g<span class="_ _8"></span>ro<span class="_ _4"></span>w<span class="_ _1"></span>. Second<span class="_ _1"></span>, it very clearly does more than one thing.</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 wsd0">Third<span class="_ _1"></span>, it violates the Single Responsibility Principle</div><div class="t m0 x7e h21 y389 ff8 fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 xb4 h14 y587 ff8 fs3 fc0 sc0 ls0 wsd0">(SRP) because there is more than one</div><div class="t m0 xd h14 y588 ff8 fs3 fc0 sc0 ls0 ws330">reason for it to change. F<span class="_ _1"></span>our<span class="_ _8"></span>th, it violates the Open Closed Principle</div><div class="t m0 xac h21 y38a ff8 fsc fc0 sc0 ls0 ws0">8</div><div class="t m0 xaf h14 y588 ff8 fs3 fc0 sc0 ls0 ws330">(OCP) because it</div><div class="t m0 xd h14 y578 ff8 fs3 fc0 sc0 ls0 wsfb">must change whene<span class="_ _4"></span>ver ne<span class="_ _4"></span>w types are added. But possibl<span class="_ _4"></span>y the w<span class="_ _4"></span>orst problem with this</div><div class="t m0 xd h14 y579 ff8 fs3 fc0 sc0 ls0 ws331">function is that there are an unlimited number of other functions that will ha<span class="_ _4"></span>ve the same</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws0">structure. F<span class="_ _4"></span>or example w<span class="_ _4"></span>e could ha<span class="_ _4"></span>ve</div><div class="t m5 x74 h2f y589 ffb fs10 fc0 sc0 ls0 ws332">isPayday(Employee e, Date <span class="_ _8"></span>date), </div><div class="t m0 xd h14 y415 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x74 h2f y58a ffb fs10 fc0 sc0 ls0 ws333">deliverPay(Employee e, Money <span class="_ _8"></span>pay), </div><div class="t m0 xd h14 y58b ff8 fs3 fc0 sc0 ls0 ws0">or a host of others. <span class="_ _1"></span>All of which w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve the same deleterious structure.</div><div class="t m0 x74 h14 y58c ff8 fs3 fc0 sc0 lsd ws334">The solution to this problem (see Listing 3-5) is to bury the </div><div class="t m5 xb9 h2f y58d ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xa7 h14 y58d ff8 fs3 fc0 sc0 ls0 ws335">statement in the</div><div class="t m0 xd h14 y43a ff8 fs3 fc0 sc0 ls0 ws336">basement of an A<span class="fsb ws0">BSTRACT<span class="fs3 ls2c"> F</span>ACTORY<span class="fs3">,</span></span></div><div class="t m0 x26 h21 y58e ff8 fsc fc0 sc0 ls0 ws0">9</div><div class="t m0 x32 h14 y43a ff8 fs3 fc0 sc0 ls0 ws336"> and nev<span class="_ _4"></span>er let any<span class="_ _4"></span>one see it. <span class="_ _4"></span>The factor<span class="_ _8"></span>y will use the</div><div class="t m5 xd h2f y43b ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x52 h14 y43b ff8 fs3 fc0 sc0 ls0 ws8c">statement to create appropriate instances of the deriv<span class="_ _1"></span>atives of </div><div class="t m5 x58 h2f y43b ffb fs10 fc0 sc0 ls0 ws0">Employee</div><div class="t m0 xa6 h14 y43b ff8 fs3 fc0 sc0 ls0 ws8c">, and the v<span class="_ _4"></span>ar-</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws337">ious functions, such as </div><div class="t m5 x6e h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">calculatePay</div><div class="t m0 x26 h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x31 h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">isPayday</div><div class="t m0 x23 h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws337">, and </div><div class="t m5 x96 h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">deliverPay</div><div class="t m0 x55 h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws337">, will be dispatched pol<span class="_ _4"></span>y-</div><div class="t m0 xd h14 y43c ff8 fs3 fc0 sc0 ls0 ws0">mor<span class="_ _8"></span>phically through the </div><div class="t m5 xa h2f y43c ffb fs10 fc0 sc0 ls0 ws0">Employee</div><div class="t m0 x8 h14 y43c ff8 fs3 fc0 sc0 ls0 ws0"> interface.</div><div class="t m0 x74 h14 y395 ff8 fs3 fc0 sc0 ls0 ws338">My general rule for </div><div class="t m5 x7 h2f y395 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x8 h14 y395 ff8 fs3 fc0 sc0 ls0 ws338">statements is that they can be tolerated if the<span class="_ _4"></span>y appear</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls12 ws150">onl<span class="_ _1"></span>y once, are used to create pol<span class="_ _4"></span>ymor<span class="_ _8"></span>phic objects, and are hidden behind an inheritance</div><div class="t m0 x74 h1c y558 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-4 </div><div class="t m0 x74 h36 y559 ffc fs3 fc0 sc0 ls0 ws0">Payroll.java</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">public Money calculatePay(Employee e) </div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">throws InvalidEmployeeType {</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">    switch (e.type) {</div><div class="t m5 x74 h2f y55d ffb fs10 fc0 sc0 ls0 ws0">      case COMMISSIONED:</div><div class="t m5 x74 h2f y55e ffb fs10 fc0 sc0 ls0 ws0">        return calculateCommissionedPay(e);</div><div class="t m5 x74 h2f y55f ffb fs10 fc0 sc0 ls0 ws0">      case HOURLY:</div><div class="t m5 x74 h2f y58f ffb fs10 fc0 sc0 ls0 ws0">        return calculateHourlyPay(e);</div><div class="t m5 x74 h2f y590 ffb fs10 fc0 sc0 ls0 ws0">      case SALARIED:</div><div class="t m5 x74 h2f y591 ffb fs10 fc0 sc0 ls0 ws0">        return calculateSalariedPay(e);</div><div class="t m5 x74 h2f y592 ffb fs10 fc0 sc0 ls0 ws0">      default:</div><div class="t m5 x74 h2f y593 ffb fs10 fc0 sc0 ls0 ws0">        throw new InvalidEmployeeType(e.type);</div><div class="t m5 x74 h2f y594 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y595 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y596 ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _17"> </span>a. http://en.wikipedia.or<span class="_ _4"></span>g/wiki/Single_responsibility_principle </div><div class="t m0 x3b h25 y597 ff8 fse fc0 sc0 ls0 ws0">b<span class="_ _4"></span>. http://www<span class="_ _4"></span>.objectmentor<span class="_ _4"></span>.com/resources/articles/sr<span class="_ _8"></span>p.pdf</div><div class="t m0 xd h25 y598 ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _17"> </span>a. http://en.wikipedia.or<span class="_ _4"></span>g/wiki/Open/closed_principle</div><div class="t m0 x3b h25 y599 ff8 fse fc0 sc0 ls0 ws0">b<span class="_ _4"></span>. http://www<span class="_ _4"></span>.objectmentor<span class="_ _4"></span>.com/resources/articles/ocp.pdf</div><div class="t m0 xd h25 y59a ff8 fse fc0 sc0 ls0 ws0">9.<span class="_ _17"> </span>[GOF].</div><a class="l" href="http://en.wikipedia.org/wiki/Single_responsibility_principle"><div class="d m1" style="border-style:none;position:absolute;left:97.438600px;bottom:111.868010px;width:167.881400px;height:7.658000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.objectmentor.com/resources/articles/srp.pdf"><div class="d m1" style="border-style:none;position:absolute;left:97.547200px;bottom:103.868010px;width:155.835800px;height:7.658000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Open/closed_principle"><div class="d m1" style="border-style:none;position:absolute;left:97.440000px;bottom:95.867510px;width:143.367000px;height:7.657500px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.objectmentor.com/resources/articles/ocp.pdf"><div class="d m1" style="border-style:none;position:absolute;left:97.547200px;bottom:87.866510px;width:157.182800px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf46" class="pf w1 h2" data-page-no="46"><div class="pc pc46 w1 h2"><img class="bi xd y59b wc h3d" alt="" src="bg46.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">39<span class="_ _10"></span><span class="ff1">Use Descriptiv<span class="_ _4"></span>e Names</span></div><div class="t m0 xd h14 y59c ff8 fs3 fc0 sc0 ls12 ws0">relat<span class="ls0 ws3b">ionship so that the rest of the system can’<span class="_ _1"></span>t see them [G23]. Of course every circum-</span></div><div class="t m0 xd h14 y59d ff8 fs3 fc0 sc0 ls0 ws0">stance is unique, and there are times when I violate one or more parts of that rule.</div><div class="t m0 xd h17 y59e ff1 fs9 fc0 sc0 ls0 ws0">Use Descriptiv<span class="_ _1"></span>e Names</div><div class="t m0 xd h14 y59f ff8 fs3 fc0 sc0 ls2d ws339">In Listing 3-7 I changed the name of our example function from </div><div class="t m5 x60 h2f y59f ffb fs10 fc0 sc0 ls2e ws0">testableHtml</div><div class="t m0 x1d h14 y59f ff8 fs3 fc0 sc0 ls2d ws0">to</div><div class="t m5 xd h2f y5a0 ffb fs10 fc0 sc0 ls2e ws0">SetupTeardownIncluder.render</div><div class="t m0 x38 h14 y5a0 ff8 fs3 fc0 sc0 ls2d ws38">. <span class="_ _1"></span>This is a f<span class="_ _8"></span>ar better name because it better describes what</div><div class="t m0 xd h14 y5a1 ff8 fs3 fc0 sc0 ls2d ws2b5">the function does. I also ga<span class="_ _4"></span>ve each of the pri<span class="_ _4"></span>vate methods an equall<span class="_ _4"></span>y descriptiv<span class="_ _4"></span>e name</div><div class="t m0 xd h14 y5a2 ff8 fs3 fc0 sc0 ls2d ws1e5">such as </div><div class="t m5 x75 h2f y5a2 ffb fs10 fc0 sc0 ls2e ws0">isTestable</div><div class="t m0 xba h14 y5a2 ff8 fs3 fc0 sc0 ls2d ws0">or</div><div class="t m5 x4 h2f y5a2 ffb fs10 fc0 sc0 ls2e ws0">includeSetupAndTeardownPages</div><div class="t m0 x2a h14 y5a2 ff8 fs3 fc0 sc0 ls2d ws1e5">. It is hard to o<span class="_ _4"></span>verestimate the v<span class="_ _4"></span>alue</div><div class="t m0 xd h14 y5a3 ff8 fs3 fc0 sc0 ls2d ws2e7">of good names. Remember W<span class="_ _0"></span>ard’<span class="_ _2"></span>s principle: “<span class="ffa">Y<span class="_ _1"></span>ou know you ar<span class="_ _1"></span>e wor<span class="_ _4"></span>king on clean code</span></div><div class="t m0 xd h14 y5a4 ffa fs3 fc0 sc0 ls2d ws33a">when eac<span class="_ _4"></span>h r<span class="_ _4"></span>outine turns out to be pr<span class="_ _4"></span>etty much what you expected.<span class="_ _0"></span><span class="ff8">” Half the battle to</span></div><div class="t m0 xd h14 y5a5 ff8 fs3 fc0 sc0 ls2d ws33b">achieving that principle is choosing good names for small functions that do one thing.</div><div class="t m0 xd h14 y5a6 ff8 fs3 fc0 sc0 ls2d ws33c">The smaller and more focused a function is, the easier it is to choose a descripti<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y5a7 ff8 fs3 fc0 sc0 ls2d ws0">name.</div><div class="t m0 x74 h14 y5a8 ff8 fs3 fc0 sc0 ls12 ws33d">Don’<span class="_ _1"></span>t be afraid to make a name long. <span class="_ _4"></span>A long descriptiv<span class="_ _4"></span>e name is better than a shor<span class="_ _8"></span>t</div><div class="t m0 xd h14 y5a9 ff8 fs3 fc0 sc0 ls12 ws33e">enigmatic name. <span class="_ _1"></span>A long descriptive name is better than a long descripti<span class="_ _4"></span>ve comment. Use</div><div class="t m0 xd h14 y5aa ff8 fs3 fc0 sc0 ls12 ws2c1">a naming con<span class="_ _4"></span>vention that allo<span class="_ _1"></span>ws multiple words to be easil<span class="_ _4"></span>y read in the function names,</div><div class="t m0 xd h14 y5ab ff8 fs3 fc0 sc0 ls12 ws33f">and then make use of those multiple w<span class="_ _1"></span>ords to give the function a name that sa<span class="_ _1"></span>ys what</div><div class="t m0 xd h14 y5ac ff8 fs3 fc0 sc0 ls12 ws0">it does.</div><div class="t m0 x74 h1c y5ad ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-5 </div><div class="t m0 x74 h36 y5ae ffc fs3 fc0 sc0 ls0 ws0">Employee and Factory</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public abstract class Employee {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  public abstract boolean isPayday();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  public abstract Money calculatePay();</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  public abstract void deliverPay(Money pay);</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">-----------------</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">public interface EmployeeFactory {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public Employee makeEmployee(EmployeeRecord r) throws InvalidEmployeeType;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">-----------------</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">public class EmployeeFactoryImpl implements EmployeeFactory {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public Employee makeEmployee(EmployeeRecord r) throws InvalidEmployeeType {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    switch (r.type) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      case COMMISSIONED:</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">        return new CommissionedEmployee(r) ;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      case HOURLY:</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">        return new HourlyEmployee(r);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      case SALARIED:</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">        return new SalariedEmploye(r);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      default:</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">        throw new InvalidEmployeeType(r.type);</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:281.945010px;width:136.293000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf47" class="pf w1 h2" data-page-no="47"><div class="pc pc47 w1 h2"><img class="bi x27 y5b0 we h3e" alt="" src="bg47.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">40<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws340">Don’<span class="_ _1"></span>t be afraid to spend time choosing a name. Indeed<span class="_ _4"></span>, you should try sev<span class="_ _4"></span>eral differ<span class="_ _4"></span>-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws341">ent names and read the code with each in place. Modern IDEs like Eclipse or IntelliJ make</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws32d">it trivial to change names. Use one of those IDEs and e<span class="_ _4"></span>xperiment with different names</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">until you ﬁnd one that is as descripti<span class="_ _4"></span>ve as y<span class="_ _4"></span>ou can make it. </div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws342">Choosing descripti<span class="_ _4"></span>ve names will clarify the design of the module in your mind and</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws6d">help you to impro<span class="_ _1"></span>ve it. It is not at all uncommon that hunting for a good name results in a</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">fa<span class="_ _4"></span>vorable restructuring of the code. </div><div class="t m0 x74 h14 y206 ff8 fs3 fc0 sc0 ls12 ws343">Be consistent in your names. Use the same phrases, nouns, and v<span class="_ _4"></span>erbs in the function</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls12 ws344">names you choose for y<span class="_ _4"></span>our modules. Consider<span class="_ _4"></span>, for example, the names </div><div class="t m5 xbb h2f y207 ffb fs10 fc0 sc0 ls0 ws0">includeSetup-</div><div class="t m5 xd h2f y5b1 ffb fs10 fc0 sc0 ls0 ws0">AndTeardownPages</div><div class="t m0 xbc h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x18 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">includeSetupPages</div><div class="t m0 x26 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x31 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">includeSuiteSetupPage</div><div class="t m0 x7f h14 y1fc ff8 fs3 fc0 sc0 ls12 ws345">, and </div><div class="t m5 x72 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">includeSetupPage</div><div class="t m0 xb0 h14 y1fc ff8 fs3 fc0 sc0 ls12 ws346">. The</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls12 ws347">similar phraseology in those names allo<span class="_ _1"></span>ws the sequence to tell a stor<span class="_ _8"></span>y<span class="_ _0"></span>. Indeed<span class="_ _4"></span>, if I</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls12 ws348">sho<span class="_ _4"></span>w<span class="_ _4"></span>ed you just the sequence abo<span class="_ _1"></span>v<span class="ws349">e, you’<span class="_ _3"></span>d ask yourself: “What <span class="ls25 ws34a">happened to</span></span></div><div class="t m5 xd h2f y3ec ffb fs10 fc0 sc0 ls0 ws0">includeTeardownPages</div><div class="t m0 x9 h14 y3ec ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x2e h2f y3ec ffb fs10 fc0 sc0 ls0 ws0">includeSuiteTeardownPage</div><div class="t m0 x34 h14 y3ec ff8 fs3 fc0 sc0 ls25 ws34b">, and </div><div class="t m5 xb7 h2f y3ec ffb fs10 fc0 sc0 ls0 ws0">includeTeardownPage</div><div class="t m0 xbd h14 y3ec ff8 fs3 fc0 sc0 ls12 ws34c">?” Ho<span class="_ _4"></span>w’<span class="_ _2"></span>s that</div><div class="t m0 xd h14 y3ed ff8 fs3 fc0 sc0 ls12 ws0">for being “. . . <span class="ffa">pr<span class="_ _4"></span>etty much w<span class="_ _4"></span>hat you expected<span class="ff8 ls2f">.”</span></span></div><div class="t m0 xd h17 y484 ff1 fs9 fc0 sc0 ls0 ws20d">Function Arguments</div><div class="t m0 xd h14 y485 ff8 fs3 fc0 sc0 ls0 ws34d">The ideal number of arguments for a function is</div><div class="t m0 xd h14 y486 ff8 fs3 fc0 sc0 ls30 wsfa">zero (niladic). Next comes one (monadic), follo<span class="_ _1"></span>wed</div><div class="t m0 xd h14 y487 ff8 fs3 fc0 sc0 ls0 ws245">closely b<span class="_ _1"></span>y two (dyadic). <span class="_ _1"></span>Three arguments (triadic)</div><div class="t m0 xd h14 y488 ff8 fs3 fc0 sc0 ls0 wse4">should be a<span class="_ _4"></span>voided w<span class="_ _4"></span>here possible. More than three</div><div class="t m0 xd h14 y489 ff8 fs3 fc0 sc0 ls0 ws2d4">(polyadic) requires v<span class="_ _4"></span>ery special justiﬁcation—and</div><div class="t m0 xd h14 y53a ff8 fs3 fc0 sc0 ls0 ws0">then shouldn’<span class="_ _1"></span>t be used anyw<span class="_ _4"></span>ay<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y5b2 ff8 fs3 fc0 sc0 ls16 ws34e">Arguments are hard. <span class="_ _1"></span>They take a lot of con-</div><div class="t m0 xd h14 y5b3 ff8 fs3 fc0 sc0 ls16 ws34f">ceptual po<span class="_ _4"></span>w<span class="_ _4"></span>er<span class="_ _4"></span>. <span class="_ _4"></span>That’<span class="_ _2"></span>s wh<span class="_ _1"></span>y I got rid of almost all of</div><div class="t m0 xd h14 y53d ff8 fs3 fc0 sc0 ls16 ws350">them from the example. Consider<span class="_ _1"></span>, for instance, the</div><div class="t m5 xd h2f y37a ffb fs10 fc0 sc0 ls31 ws0">StringBuffer</div><div class="t m0 x86 h14 y37a ff8 fs3 fc0 sc0 ls16 ws351">in the example. <span class="_ _4"></span>W<span class="_ _0"></span>e could ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls16 ws352">passed it around as an argument rather than mak-</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls32 ws353">ing it an instance variab<span class="_ _4"></span>le, but then our readers</div><div class="t m0 xd h14 y37d ff8 fs3 fc0 sc0 ls16 ws354">w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve had to inter<span class="_ _8"></span>pret it each time they sa<span class="_ _1"></span>w</div><div class="t m0 xd h14 y5b4 ff8 fs3 fc0 sc0 ls16 ws355">it. <span class="_ _4"></span>When you are reading the story told by the</div><div class="t m0 xd h14 y42d ff8 fs3 fc0 sc0 ls16 ws0">module,</div><div class="t m5 x3f h2f y42d ffb fs10 fc0 sc0 ls31 ws0">includeSetupPage()</div><div class="t m0 x5a h14 y42d ff8 fs3 fc0 sc0 ls16 ws1a8">is easier to understand than </div><div class="t m5 xae h2f y42d ffb fs10 fc0 sc0 ls31 ws0">includeSetupPageInto(newPage-</div><div class="t m5 xd h2f y5b5 ffb fs10 fc0 sc0 ls31 ws0">Content)</div><div class="t m0 x9a h14 y3ad ff8 fs3 fc0 sc0 ls16 ws356">. <span class="_ _1"></span>The argument is at a different le<span class="_ _4"></span>vel of abstraction than the function name and</div><div class="t m0 xd h14 y544 ff8 fs3 fc0 sc0 ls16 ws357">forces you to kno<span class="_ _1"></span>w a detail (in other w<span class="_ _4"></span>ords, </div><div class="t m5 x9d h2f y544 ffb fs10 fc0 sc0 ls31 ws0">StringBuffer</div><div class="t m0 x89 h14 y544 ff8 fs3 fc0 sc0 ls16 ws357">) that isn’<span class="_ _1"></span>t par<span class="_ _8"></span>ticularly important</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls16 ws0">at that point. </div><div class="t m0 x74 h14 y5b6 ff8 fs3 fc0 sc0 ls16 ws358">Arguments are e<span class="_ _4"></span>ven harder from a testing point of vie<span class="_ _4"></span>w<span class="_ _0"></span>. Imagine the difﬁculty of</div><div class="t m0 xd h14 y42e ff8 fs3 fc0 sc0 ls0 ws359">writing all the test cases to ensure that all the various combinations of ar<span class="_ _4"></span>guments w<span class="_ _4"></span>ork</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws24c">properly<span class="_ _0"></span>. If there are no ar<span class="_ _4"></span>guments, this is trivial. If there’<span class="_ _2"></span>s one argument, it’<span class="_ _3"></span>s not too hard.</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls0 ws35a">W<span class="_ _4"></span>ith tw<span class="_ _4"></span>o arguments the prob<span class="_ _4"></span>lem gets a bit more challenging. W<span class="_ _1"></span>ith more than two ar<span class="_ _4"></span>gu-</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws0">ments, testing ev<span class="_ _4"></span>ery combination of appropriate values can be daunting.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:388.945010px;width:122.727000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf48" class="pf w1 h2" data-page-no="48"><div class="pc pc48 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">41<span class="_ _10"></span><span class="ff1 ws1fc">Function Arguments</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls17 ws35b">Output arguments are harder to understand than input ar<span class="_ _4"></span>guments. When w<span class="_ _1"></span>e read a</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls17 ws35c">function, w<span class="_ _4"></span>e are used to the idea of infor<span class="_ _8"></span>mation going <span class="ffa ws0">in</span> to the function through arguments</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls17 ws0">and<span class="_ _9"> </span><span class="ffa">out<span class="_ _15"> </span></span><span class="ws35d">through the retur<span class="_ _8"></span>n value. <span class="_ _1"></span>W<span class="_ _0"></span>e don’<span class="_ _4"></span>t usually expect information to be going out</span></div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls17 ws0">through the arguments. So output ar<span class="_ _4"></span>guments often cause us to do a double-take. </div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws35e">One input argument is the ne<span class="_ _4"></span>xt best thing to no arguments. </div><div class="t m5 xa9 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">SetupTeardown-</div><div class="t m5 xd h2f y5b7 ffb fs10 fc0 sc0 ls0 ws0">Includer.render(pageData)</div><div class="t m0 x2f h14 y1be ff8 fs3 fc0 sc0 ls0 ws35f">is pretty easy to understand. Clearl<span class="_ _4"></span>y we are going to <span class="ffa ws0">r<span class="_ _1"></span>ender <span class="ff8">the</span></span></div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">data in the </div><div class="t m5 x46 h2f y19a ffb fs10 fc0 sc0 ls0 ws0">pageData</div><div class="t m0 xba h14 y19a ff8 fs3 fc0 sc0 ls0 ws0"> object. </div><div class="t m0 xd h11 y5b8 ff1 fs7 fc0 sc0 ls0 ws0">Common Monadic F<span class="_ _1"></span>orms</div><div class="t m0 xd h14 y5b9 ff8 fs3 fc0 sc0 lsc ws360">There are tw<span class="_ _4"></span>o very common reasons to pass a single argument into a function. <span class="_ _0"></span>Y<span class="_ _3"></span>ou may be</div><div class="t m0 xd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws2f5">asking a question about that argument, as in </div><div class="t m5 xbe h2f y5ba ffb fs10 fc0 sc0 ls0 ws0">boolean<span class="_ _18"> </span>fileExists(“MyFile”)</div><div class="t m0 x45 h14 y5ba ff8 fs3 fc0 sc0 ls0 ws2f5">. Or you ma<span class="_ _1"></span>y be</div><div class="t m0 xd h14 y5bb ff8 fs3 fc0 sc0 ls0 ws361">operating on that argument, transforming it into something else and <span class="ffa">r<span class="_ _4"></span>eturning it<span class="ff8">. F<span class="_ _4"></span>or</span></span></div><div class="t m0 xd h14 y5bc ff8 fs3 fc0 sc0 ls0 ws0">example,</div><div class="t m5 x5f h2f y329 ffb fs10 fc0 sc0 ls0 ws0">InputStream<span class="_ _20"> </span>fileOpen(“MyFile”)</div><div class="t m0 x1b h14 y329 ff8 fs3 fc0 sc0 ls0 ws362">transforms a ﬁle name </div><div class="t m5 xa7 h2f y329 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x90 h14 y329 ff8 fs3 fc0 sc0 ls0 ws362">into an</div><div class="t m5 xd h2f y5bd ffb fs10 fc0 sc0 ls0 ws0">InputStream</div><div class="t m0 x41 h14 y5bd ff8 fs3 fc0 sc0 ls0 ws363">return value. <span class="_ _1"></span>These two uses are w<span class="_ _4"></span>hat readers expect w<span class="_ _4"></span>hen they see a func-</div><div class="t m0 xd h14 y5be ff8 fs3 fc0 sc0 ls0 ws210">tion. <span class="_ _0"></span>Y<span class="_ _2"></span>ou should choose names that make the distinction clear<span class="_ _1"></span>, and alw<span class="_ _4"></span>a<span class="_ _4"></span>ys use the tw<span class="_ _4"></span>o</div><div class="t m0 xd h14 y5bf ff8 fs3 fc0 sc0 ls0 ws0">forms in a consistent context. (See Command Query Separation below<span class="_ _0"></span>.) </div><div class="t m0 x74 h14 y5c0 ff8 fs3 fc0 sc0 lsd ws364">A some<span class="_ _4"></span>what less common, but still very useful form for a single argument function,</div><div class="t m0 xd h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws0">is an <span class="_ _6"></span><span class="ffa">event</span><span class="lsd ws29e">. In this form there is an input argument but no output ar<span class="_ _4"></span>gument. <span class="_ _4"></span>The o<span class="_ _4"></span>verall</span></div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls0 ws288">program is meant to inter<span class="_ _8"></span>pret the function call as an e<span class="_ _4"></span>vent and use the argument to alter the</div><div class="t m0 xd h14 y5c3 ff8 fs3 fc0 sc0 ls0 ws365">state of the system, for example, </div><div class="t m5 xc h2f y5c3 ffb fs10 fc0 sc0 ls0 ws366">void passwordAttemptFailedNtimes(int attempts)</div><div class="t m0 xb0 h14 y5c3 ff8 fs3 fc0 sc0 ls0 ws365">. Use</div><div class="t m0 xd h14 y5c4 ff8 fs3 fc0 sc0 ls0 ws367">this form with care. It should be very clear to the reader that this is an event. Choose</div><div class="t m0 xd h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws0">names and contexts carefull<span class="_ _4"></span>y<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y5c5 ff8 fs3 fc0 sc0 ls0 ws303">T<span class="_ _4"></span>r<span class="_ _8"></span>y to a<span class="_ _4"></span>void an<span class="_ _4"></span>y monadic functions that don’<span class="_ _4"></span>t follo<span class="_ _4"></span>w these for<span class="_ _8"></span>ms, for example, </div><div class="t m5 xbf h2f y5c5 ffb fs10 fc0 sc0 ls0 ws0">void</div><div class="t m5 xd h2f y5c6 ffb fs10 fc0 sc0 ls0 ws368">includeSetupPageInto(StringBuffer pageText)</div><div class="t m0 x65 h14 y5c7 ff8 fs3 fc0 sc0 ls0 ws369">. Using an output argument instead of a</div><div class="t m0 xd h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws1ab">return value for a transformation is confusing. If a function is going to transfor<span class="_ _8"></span>m its input</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws36a">argument, the transformation should appear as the return value. Indeed<span class="_ _1"></span>, </div><div class="t m5 xa6 h2f y5c9 ffb fs10 fc0 sc0 ls0 ws0">StringBuffer</div><div class="t m5 xd h2f y5ca ffb fs10 fc0 sc0 ls0 ws36b">transform(StringBuffer in)</div><div class="t m0 x9b h14 y5cb ff8 fs3 fc0 sc0 ls10 ws36c">is better than </div><div class="t m5 xb8 h2f y5cb ffb fs10 fc0 sc0 ls0 ws36d">void transform-(StringBuffer <span class="_ _2"></span>out)</div><div class="t m0 x63 h14 y5cb ff8 fs3 fc0 sc0 ls0 ws229">, e<span class="_ _4"></span>ven if the</div><div class="t m0 xd h14 y5cc ff8 fs3 fc0 sc0 ls0 ws36e">implementation in the ﬁrst case simply returns the input argument. <span class="_ _0"></span>At least it still follows</div><div class="t m0 xd h14 y5cd ff8 fs3 fc0 sc0 ls0 ws0">the form of a transfor<span class="_ _8"></span>mation. </div><div class="t m0 xd h11 y46c ff1 fs7 fc0 sc0 ls0 ws11">Flag Arguments</div><div class="t m0 xd h14 y544 ff8 fs3 fc0 sc0 ls30 ws14d">Flag arguments are ugl<span class="_ _4"></span>y<span class="_ _0"></span>. Passing a boolean into a function is a truly ter<span class="_ _8"></span>rible practice. It</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls30 ws36f">immediatel<span class="_ _4"></span>y complicates the signature of the method<span class="_ _4"></span>, loudly proclaiming that this function</div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls30 ws9">does more than one thing. It does one thing if the ﬂag is true and another if the ﬂag is f<span class="_ _8"></span>alse!</div><div class="t m0 x74 h14 y42e ff8 fs3 fc0 sc0 ls12 ws370">In Listing 3-7 w<span class="_ _4"></span>e had no choice because the callers w<span class="_ _4"></span>ere already passing that ﬂag</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls12 ws371">in, and I w<span class="_ _4"></span>anted to limit the scope of ref<span class="_ _8"></span>actoring to the function and belo<span class="_ _4"></span>w<span class="_ _0"></span>. Still, the</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls12 ws372">method call </div><div class="t m5 x1e h2f y31c ffb fs10 fc0 sc0 ls0 ws0">render(true)</div><div class="t m0 x7 h14 y31c ff8 fs3 fc0 sc0 ls12 ws372">is just plain confusing to a poor reader<span class="_ _1"></span>. Mousing o<span class="_ _4"></span>ver the<span class="_ _21"> </span>call</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls12 ws373">and seeing </div><div class="t m5 x6c h2f y42f ffb fs10 fc0 sc0 ls0 ws374">render(boolean isSuite)</div><div class="t m0 x32 h14 y42f ff8 fs3 fc0 sc0 ls33 wsd6">helps a little, but not that much. <span class="_ _4"></span>W<span class="_ _0"></span>e<span class="_ _21"> </span>should hav<span class="_ _4"></span>e</div><div class="t m0 xd h14 y5ce ff8 fs3 fc0 sc0 ls33 ws0">split the function into tw<span class="_ _4"></span>o: </div><div class="t m5 x2f h2f y5ce ffb fs10 fc0 sc0 ls0 ws0">renderForSuite()</div><div class="t m0 x78 h14 y5ce ff8 fs3 fc0 sc0 ls12 ws0"> and </div><div class="t m5 xc0 h2f y5ce ffb fs10 fc0 sc0 ls0 ws0">renderForSingleTest()</div><div class="t m0 xaf h14 y5ce ff8 fs3 fc0 sc0 ls0 ws0">.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:477.728010px;width:131.269000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:191.728010px;width:81.855000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf49" class="pf w1 h2" data-page-no="49"><div class="pc pc49 w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bg49.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">42<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Dy<span class="_ _4"></span>adic Functions</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws357">A function with tw<span class="_ _4"></span>o arguments is harder to understand than a monadic function. F<span class="_ _1"></span>or exam-</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">ple,</div><div class="t m5 x8e h2f y272 ffb fs10 fc0 sc0 ls0 ws0">writeField(name)</div><div class="t m0 x2e h14 y272 ff8 fs3 fc0 sc0 ls0 ws375">is easier to understand than </div><div class="t m5 x27 h2f y272 ffb fs10 fc0 sc0 ls0 ws376">writeField(output-Stream, name)</div><div class="t m0 x1d h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x50 h21 y5cf ff8 fsc fc0 sc0 ls0 ws0">10</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws377">Though the meaning of both is clear<span class="_ _4"></span>, the ﬁrst glides past the ey<span class="_ _4"></span>e, easily depositing its</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws378">meaning. <span class="_ _1"></span>The second requires a shor<span class="_ _8"></span>t pause until we learn to ignore the ﬁrst parameter<span class="_ _1"></span>.</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0">And<span class="_ _16"> </span><span class="ffa">that</span><span class="ws345">, of course, ev<span class="_ _4"></span>entually results in prob<span class="_ _4"></span>lems because we should ne<span class="_ _4"></span>ver ignore an<span class="_ _4"></span>y</span></div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 lsd wsef">part of code. <span class="_ _4"></span>The par<span class="_ _8"></span>ts w<span class="_ _4"></span>e ignore are where the bugs will hide.</div><div class="t m0 x74 h14 y2a9 ff8 fs3 fc0 sc0 ls0 ws379">There are times, of course, where tw<span class="_ _1"></span>o arguments are appropriate. F<span class="_ _1"></span>or example,</div><div class="t m5 xd h2f y2aa ffb fs10 fc0 sc0 ls0 ws37a">Point p = new Point(0,0);</div><div class="t m0 x57 h14 y2aa ff8 fs3 fc0 sc0 ls0 ws37b">is perfectl<span class="_ _4"></span>y reasonable. Cartesian points naturally take tw<span class="_ _1"></span>o</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws37c">arguments. Indeed<span class="_ _0"></span>, we’<span class="_ _3"></span>d be very sur<span class="_ _8"></span>prised to see </div><div class="t m5 x7e h2f y2ab ffb fs10 fc0 sc0 ls0 ws37d">new Point(0)</div><div class="t m0 x51 h14 y2ab ff8 fs3 fc0 sc0 ls0 ws37c">. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the tw<span class="_ _1"></span>o argu-</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws37e">ments in this case <span class="ffa">ar<span class="_ _4"></span>e or<span class="_ _4"></span>dered components of a single value!<span class="_ _e"> </span><span class="ff8 ws0">Whereas</span></span></div><div class="t m5 xc1 h2f y570 ffb fs10 fc0 sc0 ls0 ws0">output-Stream</div><div class="t m0 x8c h14 y570 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y5d0 ffb fs10 fc0 sc0 ls0 ws0">name</div><div class="t m0 x74 h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws0"> ha<span class="_ _4"></span>ve neither a natural cohesion, nor a natural ordering. </div><div class="t m0 x74 h14 y2ae ff8 fs3 fc0 sc0 ls0 ws37f">Even ob<span class="_ _4"></span>vious dyadic functions like </div><div class="t m5 x4e h2f y5d1 ffb fs10 fc0 sc0 ls0 ws36b">assertEquals(expected, actual)</div><div class="t m0 xa7 h14 y5d1 ff8 fs3 fc0 sc0 ls0 ws37f">are problematic.</div><div class="t m0 xd h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws378">Ho<span class="_ _4"></span>w many times ha<span class="_ _1"></span>ve you put the </div><div class="t m5 x77 h2f y5d2 ffb fs10 fc0 sc0 ls0 ws0">actual</div><div class="t m0 xad h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws378">where the </div><div class="t m5 x88 h2f y5d2 ffb fs10 fc0 sc0 ls0 ws0">expected</div><div class="t m0 x55 h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws378">should be? <span class="_ _1"></span>The two ar<span class="_ _4"></span>gu-</div><div class="t m0 xd h14 y2d7 ff8 fs3 fc0 sc0 ls0 ws380">ments ha<span class="_ _4"></span>ve no natural ordering. <span class="_ _1"></span>The </div><div class="t m5 x4e h2f y2d7 ffb fs10 fc0 sc0 ls0 ws0">expected,<span class="_ _18"> </span>actual</div><div class="t m0 xc2 h14 y2d7 ff8 fs3 fc0 sc0 ls0 ws380">ordering is a con<span class="_ _4"></span>vention that</div><div class="t m0 xd h14 y2d8 ff8 fs3 fc0 sc0 ls0 ws0">requires practice to learn.</div><div class="t m0 x74 h14 y5d3 ff8 fs3 fc0 sc0 ls0 ws381">Dyads aren’<span class="_ _1"></span>t evil, and you will certainl<span class="_ _4"></span>y hav<span class="_ _4"></span>e to write them. Ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, you should be</div><div class="t m0 xd h14 y2c2 ff8 fs3 fc0 sc0 ls0 wsa9">a<span class="_ _4"></span>ware that the<span class="_ _4"></span>y come at a cost and should take adv<span class="_ _4"></span>antage of what mechanims ma<span class="_ _4"></span>y be</div><div class="t m0 xd h14 y2c3 ff8 fs3 fc0 sc0 ls0 ws382">a<span class="_ _4"></span>vailab<span class="_ _4"></span>le to you to con<span class="_ _1"></span>ver<span class="_ _8"></span>t them into monads. F<span class="_ _1"></span>or example, you might make the</div><div class="t m5 xd h2f y2c4 ffb fs10 fc0 sc0 ls0 ws0">writeField</div><div class="t m0 xc3 h14 y2c4 ff8 fs3 fc0 sc0 ls0 ws383">method a member of </div><div class="t m5 x26 h2f y2c4 ffb fs10 fc0 sc0 ls0 ws0">outputStream</div><div class="t m0 xb2 h14 y2c4 ff8 fs3 fc0 sc0 ls0 ws383">so that you can sa<span class="_ _1"></span>y </div><div class="t m5 xbb h2f y2c4 ffb fs10 fc0 sc0 ls0 ws0">outputStream.</div><div class="t m5 xd h2f y5d4 ffb fs10 fc0 sc0 ls0 ws0">writeField(name)</div><div class="t m0 xbc h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws26a">. Or you might mak<span class="_ _4"></span>e the </div><div class="t m5 xc4 h2f y2c5 ffb fs10 fc0 sc0 ls0 ws0">outputStream</div><div class="t m0 x9f h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws26a">a member v<span class="_ _4"></span>ariable of the cur<span class="_ _8"></span>rent</div><div class="t m0 xd h14 y468 ff8 fs3 fc0 sc0 ls0 wsee">class so that you don’<span class="_ _1"></span>t ha<span class="_ _4"></span>ve to pass it. Or you might e<span class="_ _4"></span>xtract a new class lik<span class="_ _4"></span>e </div><div class="t m5 x63 h2f y468 ffb fs10 fc0 sc0 ls0 ws0">FieldWriter</div><div class="t m0 xd h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">that takes the </div><div class="t m5 x91 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">outputStream</div><div class="t m0 xa4 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0"> in its constructor and has a </div><div class="t m5 x27 h2f y469 ffb fs10 fc0 sc0 ls0 ws0">write</div><div class="t m0 x21 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0"> method.</div><div class="t m0 xd h11 y5d5 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>riads</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws384">Functions that take three ar<span class="_ _4"></span>guments are signiﬁcantly harder to understand than dyads. <span class="_ _1"></span>The</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 wsdb">issues of ordering, pausing, and ignoring are more than doubled. I suggest y<span class="_ _4"></span>ou think very</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls0 ws0">carefully before creating a triad.</div><div class="t m0 x74 h14 y2cc ff8 fs3 fc0 sc0 ls0 ws385">F<span class="_ _1"></span>or example, consider the common o<span class="_ _4"></span>verload of </div><div class="t m5 x88 h2f y2cc ffb fs10 fc0 sc0 ls0 ws0">assertEquals</div><div class="t m0 x79 h14 y2cc ff8 fs3 fc0 sc0 ls0 ws385">that takes three ar<span class="_ _4"></span>gu-</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws0">ments:</div><div class="t m5 xc5 h2f y2cd ffb fs10 fc0 sc0 ls0 ws386">assertEquals(message, expected, actual)</div><div class="t m0 xc0 h14 y2cd ff8 fs3 fc0 sc0 ls0 ws387">. Ho<span class="_ _4"></span>w many times ha<span class="_ _1"></span>ve you read the</div><div class="t m5 xd h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">message</div><div class="t m0 x75 h14 y2ce ff8 fs3 fc0 sc0 ls0 ws388">and thought it w<span class="_ _4"></span>as the </div><div class="t m5 x84 h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">expected</div><div class="t m0 x83 h14 y2ce ff8 fs3 fc0 sc0 ls0 ws388">? I ha<span class="_ _4"></span>ve stumb<span class="_ _4"></span>led and paused o<span class="_ _4"></span>ver that particular</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 ws341">triad man<span class="_ _4"></span>y times. In f<span class="_ _8"></span>act, <span class="ffa">every time I see it, </span>I do a doub<span class="_ _4"></span>le-take and then learn to ignore the</div><div class="t m0 xd h14 y5d6 ff8 fs3 fc0 sc0 ls0 ws0">message.</div><div class="t m0 x74 h14 y2d1 ff8 fs3 fc0 sc0 ls0 ws389">On the other hand<span class="_ _1"></span>, here is a triad that is not quite so insidious: </div><div class="t m5 xc1 h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(1.0,</div><div class="t m5 xd h2f y5d7 ffb fs10 fc0 sc0 ls0 ws38a">amount, .001)</div><div class="t m0 x14 h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws38b">. <span class="_ _1"></span>Although this still requires a double-take, it’<span class="_ _3"></span>s one that’<span class="_ _0"></span>s w<span class="_ _1"></span>or<span class="_ _8"></span>th taking. It’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">al<span class="_ _4"></span>wa<span class="_ _1"></span>ys good to be reminded that equality of ﬂoating point values is a relati<span class="_ _4"></span>ve thing.</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">10.<span class="_ _16"> </span>I just ﬁnished refactoring a module that used the dyadic form. I was able to mak<span class="_ _4"></span>e the </div><div class="t m6 x53 h32 y39a ffb fs12 fc0 sc0 ls0 ws0">outputStream</div><div class="t m0 xaf h25 y39a ff8 fse fc0 sc0 ls0 ws0"> a ﬁeld of the class and </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">con<span class="_ _4"></span>vert all the </div><div class="t m6 x6d h32 y302 ffb fs12 fc0 sc0 ls0 ws0">writeField</div><div class="t m0 xc6 h25 y302 ff8 fse fc0 sc0 ls0 ws0"> calls to the monadic form. The result w<span class="_ _4"></span>as much cleaner<span class="_ _4"></span>.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:89.376000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:275.728010px;width:33.120000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4a" class="pf w1 h2" data-page-no="4a"><div class="pc pc4a w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">43<span class="_ _10"></span><span class="ff1 ws1fc">Function Arguments</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Argument Objects</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws38c">When a function seems to need more than tw<span class="_ _4"></span>o or three arguments, it is likel<span class="_ _1"></span>y that some of</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws23c">those arguments ought to be wrapped into a class of their o<span class="_ _1"></span>wn. Consider, for e<span class="_ _4"></span>xample, the</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws0">difference betw<span class="_ _1"></span>een the tw<span class="_ _4"></span>o following declarations:</div><div class="t m5 x74 h2f y5d8 ffb fs10 fc0 sc0 ls0 ws0">Circle makeCircle(double x, double y, double radius);</div><div class="t m5 x74 h2f y5d9 ffb fs10 fc0 sc0 ls0 ws0">Circle makeCircle(Point center, double radius);</div><div class="t m0 xd h14 y5da ff8 fs3 fc0 sc0 ls34 ws38d">Reducing the number of arguments b<span class="_ _4"></span>y creating objects out of them ma<span class="_ _4"></span>y seem like</div><div class="t m0 xd h14 y5db ff8 fs3 fc0 sc0 ls34 ws38e">cheating, but it’<span class="_ _2"></span>s not. <span class="_ _4"></span>When g<span class="_ _8"></span>roups of variab<span class="_ _4"></span>les are passed together<span class="_ _1"></span>, the wa<span class="_ _4"></span>y </div><div class="t m5 x36 h2f y5db ffb fs10 fc0 sc0 ls0 ws0">x</div><div class="t m0 x29 h14 y5db ff8 fs3 fc0 sc0 ls34 ws0">and</div><div class="t m5 xd h2f y5dc ffb fs10 fc0 sc0 ls0 ws0">y</div><div class="t m0 x47 h14 y5dc ff8 fs3 fc0 sc0 ls34 wsd0"> are in the example abo<span class="_ _4"></span>ve, the<span class="_ _4"></span>y are likely part of a concept that deserves a name of its</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls34 ws0">o<span class="_ _4"></span>wn.</div><div class="t m0 xd h11 y5de ff1 fs7 fc0 sc0 ls0 ws0">Argument Lists</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 ls0 ws38f">Sometimes w<span class="_ _4"></span>e want to pass a v<span class="_ _4"></span>ariable number of ar<span class="_ _4"></span>guments into a function. Consider<span class="_ _4"></span>, for</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws0">example, the </div><div class="t m5 x6d h2f y4df ffb fs10 fc0 sc0 ls0 ws0">String.format</div><div class="t m0 xc7 h14 y4df ff8 fs3 fc0 sc0 ls0 ws0"> method:</div><div class="t m5 x74 h2f y5df ffb fs10 fc0 sc0 ls0 ws0">String.format(&quot;%s worked %.2f hours.&quot;, name, hours);</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls16 ws2dd">If the variab<span class="_ _4"></span>le arguments are all treated identicall<span class="_ _4"></span>y<span class="_ _0"></span>, as they are in the example abo<span class="_ _1"></span>ve, then</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls16 ws390">they are equi<span class="_ _4"></span>valent to a single ar<span class="_ _4"></span>gument of type </div><div class="t m5 x42 h2f y29d ffb fs10 fc0 sc0 ls31 ws0">List</div><div class="t m0 x96 h14 y29d ff8 fs3 fc0 sc0 ls16 ws390">. By that reasoning, </div><div class="t m5 x60 h2f y29d ffb fs10 fc0 sc0 ls31 ws0">String.format</div><div class="t m0 xc8 h14 y29d ff8 fs3 fc0 sc0 ls35 ws391"> is</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 ls16 ws392">actually dyadic. Indeed<span class="_ _0"></span>, the declaration of </div><div class="t m5 x66 h2f y5e0 ffb fs10 fc0 sc0 ls31 ws0">String.format</div><div class="t m0 x62 h14 y5e0 ff8 fs3 fc0 sc0 ls16 ws392">as sho<span class="_ _4"></span>wn belo<span class="_ _4"></span>w is clearly</div><div class="t m0 xd h14 y5e1 ff8 fs3 fc0 sc0 ls16 ws0">dyadic.</div><div class="t m5 x74 h2f y5e2 ffb fs10 fc0 sc0 ls0 ws0">public String format(String format, Object... args)</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls34 ws2ad">So all the same rules apply<span class="_ _0"></span>. Functions that take variab<span class="_ _4"></span>le arguments can be monads,</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls34 ws393">dyads, or e<span class="_ _4"></span>ven triads. But it w<span class="_ _4"></span>ould be a mistake to gi<span class="_ _4"></span>ve them more arguments than</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 ls34 ws0">that.</div><div class="t m5 x74 h2f y5e3 ffb fs10 fc0 sc0 ls0 ws0">void monad(Integer... args);</div><div class="t m5 x74 h2f y5e4 ffb fs10 fc0 sc0 ls0 ws0">void dyad(String name, Integer... args);</div><div class="t m5 x74 h2f y5e5 ffb fs10 fc0 sc0 ls0 ws0">void triad(String name, int count, Integer... args);</div><div class="t m0 xd h11 y5e6 ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>erbs and Ke<span class="_ _4"></span>yw<span class="_ _4"></span>ords</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls36 ws394">Choosing good names for a function can go a long wa<span class="_ _1"></span>y to<span class="_ _4"></span>ward explaining the intent of</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls36 ws395">the function and the order and intent of the arguments. In the case of a monad<span class="_ _0"></span>, the</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls36 ws396">function and argument should form a very nice verb/noun pair<span class="_ _1"></span>. F<span class="_ _4"></span>or example,</div><div class="t m5 xd h2f y400 ffb fs10 fc0 sc0 ls0 ws0">write(name)</div><div class="t m0 x1e h14 y400 ff8 fs3 fc0 sc0 ls36 ws36c">is very ev<span class="_ _4"></span>ocativ<span class="_ _4"></span>e. Whate<span class="_ _4"></span>ver this “name” thing is, it is being “written.<span class="_ _0"></span>” <span class="_ _4"></span>An</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls36 ws30f">e<span class="_ _4"></span>ven better name might be </div><div class="t m5 x9b h2f y397 ffb fs10 fc0 sc0 ls0 ws0">writeField(name)</div><div class="t m0 x65 h14 y397 ff8 fs3 fc0 sc0 ls36 ws30f">, which tells us that the “name” thing is a</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls36 ws0">“ﬁeld.<span class="_ _1"></span>”</div><div class="t m0 x74 h14 y402 ff8 fs3 fc0 sc0 ls0 ws397">This last is an example of the <span class="ffa ws0">ke<span class="_ _4"></span>ywor<span class="_ _4"></span>d<span class="_ _18"> </span><span class="ff8 ws397">for<span class="_ _8"></span>m of a function name. Using this for<span class="_ _8"></span>m w<span class="_ _4"></span>e</span></span></div><div class="t m0 xd h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws398">encode the names of the arguments into the function name. F<span class="_ _1"></span>or example, </div><div class="t m5 xa6 h2f y5e7 ffb fs10 fc0 sc0 ls0 ws0">assertEquals</div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws24b">might be better written as </div><div class="t m5 x2f h2f y5e8 ffb fs10 fc0 sc0 ls0 ws0">assertExpectedEqualsActual(expected,<span class="_ _9"> </span>actual)</div><div class="t m0 x5e h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws399">. This <span class="_ _8"></span>strongly</div><div class="t m0 xd h14 y5e9 ff8 fs3 fc0 sc0 lsc ws3f">mitigates the problem of ha<span class="_ _1"></span>ving to remember the ordering of the arguments.</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:434.728010px;width:80.211000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:94.862000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:217.728010px;width:105.307000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4b" class="pf w1 h2" data-page-no="4b"><div class="pc pc4b w1 h2"><img class="bi xd y5ea wc h3f" alt="" src="bg4b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">44<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Ha<span class="_ _1"></span>v<span class="_ _4"></span>e No Side Effects</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 lsd ws11e">Side effects are lies. <span class="_ _0"></span>Y<span class="_ _3"></span>our function promises to do one thing, but it also does other <span class="ffa ls0 ws0">hidden</span></div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws39a">things. Sometimes it will make une<span class="_ _4"></span>xpected changes to the variab<span class="_ _4"></span>les of its own class.</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws39b">Sometimes it will make them to the parameters passed into the function or to system glo-</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws47">bals. In either case they are de<span class="_ _4"></span>vious and damaging mistruths that often result in strange</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws0">temporal couplings and order dependencies. </div><div class="t m0 x74 h14 y462 ff8 fs3 fc0 sc0 ls0 ws16c">Consider<span class="_ _4"></span>, for example, the seemingl<span class="_ _4"></span>y innocuous function in Listing 3-6. <span class="_ _4"></span>This function</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls0 ws25">uses a standard algorithm to match a </div><div class="t m5 x32 h2f y39c ffb fs10 fc0 sc0 ls0 ws0">userName</div><div class="t m0 x23 h14 y39c ff8 fs3 fc0 sc0 ls0 ws25">to a </div><div class="t m5 x7e h2f y39c ffb fs10 fc0 sc0 ls0 ws0">password</div><div class="t m0 xc9 h14 y39c ff8 fs3 fc0 sc0 ls0 ws25">. It returns </div><div class="t m5 xc1 h2f y39c ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 xa6 h14 y39c ff8 fs3 fc0 sc0 ls0 ws25">if they match</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f y39d ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 x8a h14 y39d ff8 fs3 fc0 sc0 ls0 ws0"> if anything goes wrong. But it also has a side ef<span class="_ _1"></span>fect. Can you spot it?</div><div class="t m0 x74 h14 y5eb ff8 fs3 fc0 sc0 ls0 ws27f">The side effect is the call to </div><div class="t m5 x92 h2f y2f8 ffb fs10 fc0 sc0 ls0 ws0">Session.initialize()</div><div class="t m0 x40 h14 y2f8 ff8 fs3 fc0 sc0 ls0 ws27f">, of course. <span class="_ _1"></span>The </div><div class="t m5 x59 h2f y2f8 ffb fs10 fc0 sc0 ls0 ws0">checkPassword</div><div class="t m0 xb0 h14 y2f8 ff8 fs3 fc0 sc0 ls0 ws0">func-</div><div class="t m0 xd h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws39c">tion, by its name, sa<span class="_ _1"></span>ys that it checks the passw<span class="_ _4"></span>ord. <span class="_ _1"></span>The name does not imply that it initial-</div><div class="t m0 xd h14 y2fa ff8 fs3 fc0 sc0 ls0 ws39d">izes the session. So a caller who belie<span class="_ _4"></span>ves w<span class="_ _4"></span>hat the name of the function sa<span class="_ _4"></span>ys r<span class="_ _8"></span>uns the risk</div><div class="t m0 xd h14 y2fb ff8 fs3 fc0 sc0 ls0 ws30e">of erasing the existing session data w<span class="_ _4"></span>hen he or she decides to check the validity of the</div><div class="t m0 xd h14 y2fc ff8 fs3 fc0 sc0 ls0 ws0">user<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y5ec ff8 fs3 fc0 sc0 ls12 ws39e">This side effect creates a temporal coupling. <span class="_ _1"></span>That is, </div><div class="t m5 xca h2f y2ea ffb fs10 fc0 sc0 ls0 ws0">checkPassword</div><div class="t m0 xa5 h14 y2ea ff8 fs3 fc0 sc0 ls12 ws39e">can only be</div><div class="t m0 xd h14 y2eb ff8 fs3 fc0 sc0 ls12 ws39f">called at certain times (in other words, w<span class="_ _4"></span>hen it is safe to initialize the session). If it is</div><div class="t m0 xd h14 y2ec ff8 fs3 fc0 sc0 ls12 ws3a0">called out of order<span class="_ _4"></span>, session data ma<span class="_ _4"></span>y be inadvertently lost. <span class="_ _1"></span>T<span class="_ _0"></span>emporal couplings are con-</div><div class="t m0 xd h14 y554 ff8 fs3 fc0 sc0 ls12 ws3a1">fusing, especially w<span class="_ _4"></span>hen hidden as a side ef<span class="_ _4"></span>fect. If you must ha<span class="_ _4"></span>ve a temporal coupling,</div><div class="t m0 xd h14 y5ed ff8 fs3 fc0 sc0 ls12 ws8b">you should mak<span class="_ _4"></span>e it clear in the name of the function. In this case we might rename the</div><div class="t m0 xd h14 y5ee ff8 fs3 fc0 sc0 ls12 ws0">function</div><div class="t m5 xcb h2f y5ee ffb fs10 fc0 sc0 ls0 ws0">checkPasswordAndInitializeSession</div><div class="t m0 x78 h14 y5ee ff8 fs3 fc0 sc0 ls12 ws3a2">, though that certainly violates “Do one</div><div class="t m0 xd h14 y5ef ff8 fs3 fc0 sc0 ls12 ws0">thing.<span class="_ _1"></span>”</div><div class="t m0 x74 h1c y5f0 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-6</div><div class="t m0 x74 h36 y5f1 ffc fs3 fc0 sc0 ls0 ws0">UserValidator.java</div><div class="t m5 x74 h2f y5f2 ffb fs10 fc0 sc0 ls0 ws0">public class UserValidator {</div><div class="t m5 x74 h2f y5f3 ffb fs10 fc0 sc0 ls0 ws0">  private Cryptographer cryptographer;</div><div class="t m5 x74 h2f y5f4 ffb fs10 fc0 sc0 ls0 ws0">  public boolean checkPassword(String userName, String password) {</div><div class="t m5 x74 h2f y5f5 ffb fs10 fc0 sc0 ls0 ws0">    User user = UserGateway.findByName(userName);</div><div class="t m5 x74 h2f y5f6 ffb fs10 fc0 sc0 ls0 ws0">    if (user != User.NULL) {</div><div class="t m5 x74 h2f y5f7 ffb fs10 fc0 sc0 ls0 ws0">      String codedPhrase = user.getPhraseEncodedByPassword();</div><div class="t m5 x74 h2f y5f8 ffb fs10 fc0 sc0 ls0 ws0">      String phrase = cryptographer.decrypt(codedPhrase, password);</div><div class="t m5 x74 h2f y5f9 ffb fs10 fc0 sc0 ls0 ws0">      if (&quot;Valid Password&quot;.equals(phrase)) {</div><div class="t m5 x74 h2f y5fa ffb fs10 fc0 sc0 ls0 ws0">        Session.initialize();</div><div class="t m5 x74 h2f y5fb ffb fs10 fc0 sc0 ls0 ws0">        return true;</div><div class="t m5 x74 h2f y5fc ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y5fd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y5fe ffb fs10 fc0 sc0 ls0 ws0">    return false;</div><div class="t m5 x74 h2f y5ff ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y600 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:124.478000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4c" class="pf w1 h2" data-page-no="4c"><div class="pc pc4c w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">45<span class="_ _10"></span><span class="ff1">Command Query Separation</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Output Arguments</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws3a3">Arguments are most naturall<span class="_ _4"></span>y inter<span class="_ _8"></span>preted as <span class="ffa ws0">inputs<span class="_ _16"> </span></span>to a function. If you ha<span class="_ _4"></span>ve been pro-</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws3a0">gramming for more than a few years, I’m sure y<span class="_ _4"></span>ou’<span class="_ _1"></span>ve done a double-take on an ar<span class="_ _4"></span>gument</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws0">that was actuall<span class="_ _1"></span>y an <span class="ffa">output</span> rather than an input. F<span class="_ _4"></span>or example:</div><div class="t m5 x74 h2f y5d8 ffb fs10 fc0 sc0 ls0 ws0">appendFooter(s);</div><div class="t m0 xd h14 y601 ff8 fs3 fc0 sc0 ls0 ws3a4">Does this function append </div><div class="t m5 x2f h2f y601 ffb fs10 fc0 sc0 ls0 ws0">s</div><div class="t m0 xcc h14 y601 ff8 fs3 fc0 sc0 ls0 ws3a4">as the footer to something? Or does it append some footer</div><div class="t m0 xd h14 y602 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xcd h2f y602 ffb fs10 fc0 sc0 ls0 ws0">s</div><div class="t m0 x19 h14 y602 ff8 fs3 fc0 sc0 ls0 ws1e6">? Is </div><div class="t m5 x9a h2f y602 ffb fs10 fc0 sc0 ls0 ws0">s</div><div class="t m0 x5f h14 y602 ff8 fs3 fc0 sc0 ls0 ws1e6">an input or an output? It doesn’<span class="_ _1"></span>t take long to look at the function signature</div><div class="t m0 xd h14 y603 ff8 fs3 fc0 sc0 ls0 ws0">and see:</div><div class="t m5 x74 h2f y604 ffb fs10 fc0 sc0 ls0 ws0">public void appendFooter(StringBuffer report)</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 lsd ws3a5">This clariﬁes the issue, but onl<span class="_ _4"></span>y at the expense of checking the declaration of the function.</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 wsfa">Anything that forces y<span class="_ _4"></span>ou to check the function signature is equi<span class="_ _4"></span>valent to a doub<span class="_ _4"></span>le-take. It’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws0">a cogniti<span class="_ _1"></span>ve break and should be a<span class="_ _4"></span>voided.</div><div class="t m0 x74 h14 y605 ff8 fs3 fc0 sc0 ls0 ws3a6">In the da<span class="_ _4"></span>ys before object oriented programming it was sometimes necessary to ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y2b0 ff8 fs3 fc0 sc0 ls0 ws3a7">output arguments. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, much of the need for output arguments disappears in OO lan-</div><div class="t m0 xd h14 y2b1 ff8 fs3 fc0 sc0 ls0 ws3a8">guages because </div><div class="t m5 x24 h2f y5bf ffb fs10 fc0 sc0 ls0 ws0">this</div><div class="t m0 x5 h14 y5bf ff8 fs3 fc0 sc0 ls0 ws0">is<span class="_ _a"> </span><span class="ffa">intended<span class="_ _a"> </span></span><span class="ws3a8">to act as an output argument. In other w<span class="_ _4"></span>ords, it w<span class="_ _4"></span>ould be</span></div><div class="t m0 xd h14 y5d3 ff8 fs3 fc0 sc0 ls0 ws0">better for </div><div class="t m5 xcb h2f y5d3 ffb fs10 fc0 sc0 ls0 ws0">appendFooter</div><div class="t m0 x4 h14 y5d3 ff8 fs3 fc0 sc0 ls0 ws0"> to be in<span class="_ _4"></span>vok<span class="_ _4"></span>ed as</div><div class="t m5 x74 h2f y606 ffb fs10 fc0 sc0 ls0 ws0">report.appendFooter();</div><div class="t m0 x74 h14 y2db ff8 fs3 fc0 sc0 ls0 ws1dc">In general output arguments should be a<span class="_ _1"></span>voided. If your function must change the state</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws0">of something, ha<span class="_ _4"></span>ve it change the state of its o<span class="_ _4"></span>wning object. </div><div class="t m0 xd h17 y607 ff1 fs9 fc0 sc0 ls0 ws0">Command Query Separation</div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls32 ws3a9">Functions should either do something or answ<span class="_ _1"></span>er something, but not both. Either your</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls16 ws2e7">function should change the state of an object, or it should return some infor<span class="_ _8"></span>mation about</div><div class="t m0 xd h14 y609 ff8 fs3 fc0 sc0 ls16 ws3aa">that object. Doing both often leads to confusion. Consider<span class="_ _4"></span>, for example, the follo<span class="_ _1"></span>wing</div><div class="t m0 xd h14 y60a ff8 fs3 fc0 sc0 ls16 ws0">function:</div><div class="t m5 x74 h2f y60b ffb fs10 fc0 sc0 ls0 ws0">public boolean set(String attribute, String value);</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc0 sc0 lsd ws3ab">This function sets the v<span class="_ _4"></span>alue of a named attribute and retur<span class="_ _8"></span>ns </div><div class="t m5 xab h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 x58 h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws29e">if it is successful and</div><div class="t m5 xd h2f y43c ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 x7c h14 y43c ff8 fs3 fc0 sc0 lsd wsef"> if no such attribute exists. <span class="_ _1"></span>This leads to odd statements like this:</div><div class="t m5 x74 h2f y60c ffb fs10 fc0 sc0 ls0 ws0">if (set(&quot;username&quot;, &quot;unclebob&quot;))...</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws3ac">Imagine this from the point of vie<span class="_ _4"></span>w of the reader<span class="_ _4"></span>. What does it mean? Is it asking w<span class="_ _4"></span>hether</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls0 ws3ad">the “</div><div class="t m5 x8e h2f y470 ffb fs10 fc0 sc0 ls0 ws0">username</div><div class="t m0 x28 h14 y470 ff8 fs3 fc0 sc0 lsd ws3ae">” attribute w<span class="_ _4"></span>as previousl<span class="_ _4"></span>y set to “</div><div class="t m5 x3d h2f y470 ffb fs10 fc0 sc0 ls0 ws0">unclebob</div><div class="t m0 xa1 h14 y470 ff8 fs3 fc0 sc0 ls0 ws3ad">”? Or is it asking whether the</div><div class="t m0 xd h14 y401 ff8 fs3 fc0 sc0 ls0 ws0">“</div><div class="t m5 x47 h2f y401 ffb fs10 fc0 sc0 ls0 ws0">username</div><div class="t m0 x8a h14 y401 ff8 fs3 fc0 sc0 lsd ws2ba">” attribute w<span class="_ _4"></span>as successfully set to “</div><div class="t m5 xbe h2f y401 ffb fs10 fc0 sc0 ls0 ws0">unclebob</div><div class="t m0 x96 h14 y401 ff8 fs3 fc0 sc0 ls0 ws299">”? It’<span class="_ _2"></span>s hard to infer the meaning from</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">the call because it’<span class="_ _2"></span>s not clear whether the w<span class="_ _1"></span>ord “</div><div class="t m5 xce h2f y402 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x7e h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">” is a verb or an adjecti<span class="_ _4"></span>ve. </div><div class="t m0 x74 h14 y60d ff8 fs3 fc0 sc0 ls17 ws2eb">The author intended </div><div class="t m5 x15 h2f y60d ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x5d h14 y60d ff8 fs3 fc0 sc0 ls37 ws3af">to be a verb, but in the conte<span class="_ _4"></span>xt of the </div><div class="t m5 xb5 h2f y60d ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x73 h14 y60d ff8 fs3 fc0 sc0 ls17 ws2eb">statement it <span class="ffa ws0">feels <span class="ff8">like</span></span></div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 ls17 ws3b0">an adjectiv<span class="_ _4"></span>e. So the statement reads as “If the </div><div class="t m5 x34 h2f y60e ffb fs10 fc0 sc0 ls0 ws0">username</div><div class="t m0 xc2 h14 y60e ff8 fs3 fc0 sc0 ls38 ws3b1">attribute w<span class="_ _4"></span>as previousl<span class="_ _4"></span>y set to</div><div class="t m5 xd h2f y482 ffb fs10 fc0 sc0 ls0 ws0">unclebob</div><div class="t m0 x9a h14 y482 ff8 fs3 fc0 sc0 ls17 ws3b2">” and not “set the </div><div class="t m5 x1f h2f y482 ffb fs10 fc0 sc0 ls0 ws0">username</div><div class="t m0 x43 h14 y482 ff8 fs3 fc0 sc0 ls39 ws2f0">attribute to </div><div class="t m5 xce h2f y482 ffb fs10 fc0 sc0 ls0 ws0">unclebob</div><div class="t m0 x61 h14 y482 ff8 fs3 fc0 sc0 ls17 ws3b2">and if that w<span class="_ _4"></span>orked then. <span class="_ _1"></span>. <span class="_ _1"></span>. <span class="_ _4"></span>.<span class="_ _1"></span>” W<span class="_ _2"></span>e</div><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:294.945010px;width:173.307000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:97.551000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4d" class="pf w1 h2" data-page-no="4d"><div class="pc pc4d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">46<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls17 ws3b3">could try to resolve this by renaming the </div><div class="t m5 xaa h2f y194 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 xcf h14 y194 ff8 fs3 fc0 sc0 ls17 ws3b3">function to </div><div class="t m5 x21 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">setAndCheckIfExists</div><div class="t m0 x99 h14 y194 ff8 fs3 fc0 sc0 ls3a ws3b4">, but that</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls17 ws3b5">doesn’<span class="_ _1"></span>t much help the readability of the </div><div class="t m5 x22 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x9d h14 y195 ff8 fs3 fc0 sc0 ls17 ws3b5">statement. <span class="_ _1"></span>The real solution is to separate the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls17 ws0">command from the query so that the ambiguity cannot occur<span class="_ _4"></span>.</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">if (attributeExists(&quot;username&quot;)) {</div><div class="t m5 x52 h2f y404 ffb fs10 fc0 sc0 ls0 ws0">setAttribute(&quot;username&quot;, &quot;unclebob&quot;);</div><div class="t m5 x52 h2f y405 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h17 y60f ff1 fs9 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>efer Exceptions to Returning Err<span class="_ _1"></span>or Codes</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws3b6">Returning er<span class="_ _8"></span>ror codes from command functions is a subtle violation of command quer<span class="_ _8"></span>y</div><div class="t m0 xd h14 y386 ff8 fs3 fc0 sc0 ls0 ws130">separation. It promotes commands being used as expressions in the predicates of </div><div class="t m5 x90 h2f y386 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xb0 h14 y386 ff8 fs3 fc0 sc0 ls0 ws0">state-</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws0">ments.</div><div class="t m5 x74 h2f y2d6 ffb fs10 fc0 sc0 ls0 ws0">if (deletePage(page) == E_OK)</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 lsd wsb4">This does not suf<span class="_ _4"></span>fer from verb/adjectiv<span class="_ _4"></span>e confusion but does lead to deeply nested struc-</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws83">tures. <span class="_ _4"></span>When you return an er<span class="_ _8"></span>ror code, you create the problem that the caller must deal with</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">the er<span class="_ _8"></span>ror immediately<span class="_ _0"></span>.</div><div class="t m5 x74 h2f y610 ffb fs10 fc0 sc0 ls0 ws0">if (deletePage(page) == E_OK) {</div><div class="t m5 x52 h2f y611 ffb fs10 fc0 sc0 ls0 ws0">if (registry.deleteReference(page.name) == E_OK) {</div><div class="t m5 x8a h2f y612 ffb fs10 fc0 sc0 ls0 ws0">if (configKeys.deleteKey(page.name.makeKey()) == E_OK){</div><div class="t m5 x6c h2f y613 ffb fs10 fc0 sc0 ls0 ws0">logger.log(&quot;page deleted&quot;);</div><div class="t m5 x8a h2f y614 ffb fs10 fc0 sc0 ls0 ws0">} else {</div><div class="t m5 x6c h2f y615 ffb fs10 fc0 sc0 ls0 ws0">logger.log(&quot;configKey not deleted&quot;);</div><div class="t m5 x8a h2f y616 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y617 ffb fs10 fc0 sc0 ls0 ws0">} else {</div><div class="t m5 x8a h2f y618 ffb fs10 fc0 sc0 ls0 ws0">logger.log(&quot;deleteReference from registry failed&quot;);</div><div class="t m5 x52 h2f y619 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y61a ffb fs10 fc0 sc0 ls0 ws0">} else {</div><div class="t m5 x52 h2f y61b ffb fs10 fc0 sc0 ls0 ws0">logger.log(&quot;delete failed&quot;);</div><div class="t m5 x52 h2f y61c ffb fs10 fc0 sc0 ls0 ws0">return E_ERROR;</div><div class="t m5 x74 h2f y61d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y37c ff8 fs3 fc0 sc0 ls0 ws94">On the other hand<span class="_ _1"></span>, if you use exceptions instead of returned er<span class="_ _8"></span>ror codes, then the er<span class="_ _8"></span>ror</div><div class="t m0 xd h14 y37d ff8 fs3 fc0 sc0 ls0 ws0">processing code can be separated from the happ<span class="_ _4"></span>y path code and can be simpliﬁed:</div><div class="t m5 x74 h2f y61e ffb fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x52 h2f y61f ffb fs10 fc0 sc0 ls0 ws0">deletePage(page);</div><div class="t m5 x52 h2f y620 ffb fs10 fc0 sc0 ls0 ws0">registry.deleteReference(page.name);</div><div class="t m5 x52 h2f y621 ffb fs10 fc0 sc0 ls0 ws0">configKeys.deleteKey(page.name.makeKey());</div><div class="t m5 x74 h2f y622 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y623 ffb fs10 fc0 sc0 ls0 ws0">catch (Exception e) {</div><div class="t m5 x52 h2f y624 ffb fs10 fc0 sc0 ls0 ws0">logger.log(e.getMessage());</div><div class="t m5 x74 h2f y625 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y626 ff1 fs7 fc0 sc0 ls0 ws0">Extract T<span class="_ _0"></span>ry/Catch Blocks</div><div class="t m5 xd h2f y60e ffb fs10 fc0 sc0 ls0 ws0">Try/catch</div><div class="t m0 x5f h14 y60e ff8 fs3 fc0 sc0 ls0 ws399">blocks are ugl<span class="_ _4"></span>y in their o<span class="_ _4"></span>wn right. <span class="_ _4"></span>They confuse the structure of the code and</div><div class="t m0 xd h14 y482 ff8 fs3 fc0 sc0 ls0 ws3b7">mix er<span class="_ _8"></span>ror processing with normal processing. So it is better to extract the bodies of the </div><div class="t m5 x25 h2f y482 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xd h14 y483 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f y483 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x8a h14 y483 ff8 fs3 fc0 sc0 ls0 ws0"> blocks out into functions of their o<span class="_ _1"></span>wn.</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:484.945010px;width:264.520000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:115.728010px;width:130.982000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4e" class="pf w1 h2" data-page-no="4e"><div class="pc pc4e w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg4e.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">47<span class="_ _10"></span><span class="ff1">Pr<span class="_ _4"></span>efer Exceptions to Returning Err<span class="_ _4"></span>or Codes</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls14 ws253">  public void delete(Page page) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls3b ws2f1">    try {</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls1f ws3b8">      deletePageAndAllReferences(page);</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls19 ws236">    catch (Exception e) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls3c ws237">      logError(e);</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws253">  private void deletePageAndAllReferences(Page page) throws Exception {</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls1a ws2f6">    deletePage(page);</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls18 ws3b9">    registry.deleteReference(page.name);</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls18 ws3b9">    configKeys.deleteKey(page.name.makeKey());</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls14 ws253">  private void logError(Exception e) {</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls1f ws3b8">    logger.log(e.getMessage());</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 x74 h14 y636 ff8 fs3 fc0 sc0 ls0 ws3ba">In the abo<span class="_ _4"></span>ve, the </div><div class="t m5 x9 h2f y636 ffb fs10 fc0 sc0 ls0 ws0">delete</div><div class="t m0 x57 h14 y636 ff8 fs3 fc0 sc0 ls11 ws225"> function is all about er<span class="_ _8"></span>ror processing. It is easy to understand</div><div class="t m0 xd h14 y637 ff8 fs3 fc0 sc0 ls0 ws3bb">and then ignore. <span class="_ _1"></span>The </div><div class="t m5 x4 h2f y637 ffb fs10 fc0 sc0 ls0 ws0">deletePageAndAllReferences</div><div class="t m0 x7e h14 y637 ff8 fs3 fc0 sc0 ls0 ws3bb">function is all about the processes of</div><div class="t m0 xd h14 y638 ff8 fs3 fc0 sc0 ls0 ws272">fully deleting a </div><div class="t m5 x24 h2f y638 ffb fs10 fc0 sc0 ls0 ws0">page</div><div class="t m0 x7b h14 y638 ff8 fs3 fc0 sc0 ls0 ws272">. Er<span class="_ _8"></span>ror handling can be ignored. <span class="_ _4"></span>This pro<span class="_ _4"></span>vides a nice separation that</div><div class="t m0 xd h14 y639 ff8 fs3 fc0 sc0 ls0 ws0">makes the code easier to understand and modify<span class="_ _0"></span>.</div><div class="t m0 xd h11 y63a ff1 fs7 fc0 sc0 ls0 ws0">Err<span class="_ _4"></span>or Handling Is One <span class="_ _1"></span>Thing</div><div class="t m0 xd h14 y32f ff8 fs3 fc0 sc0 ls0 ws3bc">Functions should do one thing. Er<span class="_ _8"></span>ror handing is one thing. <span class="_ _4"></span>Thus, a function that handles</div><div class="t m0 xd h14 y330 ff8 fs3 fc0 sc0 ls0 ws388">er<span class="_ _8"></span>rors should do nothing else. <span class="_ _4"></span>This implies (as in the example abo<span class="_ _1"></span>ve) that if the ke<span class="_ _4"></span>yword</div><div class="t m5 xd h2f y63b ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x74 h14 y63b ff8 fs3 fc0 sc0 ls0 ws3bd">exists in a function, it should be the v<span class="_ _4"></span>er<span class="_ _8"></span>y ﬁrst w<span class="_ _4"></span>ord in the function and that there</div><div class="t m0 xd h14 y63c ff8 fs3 fc0 sc0 ls0 ws0">should be nothing after the </div><div class="t m5 xc7 h2f y63c ffb fs10 fc0 sc0 ls0 ws0">catch/finally</div><div class="t m0 x22 h14 y63c ff8 fs3 fc0 sc0 ls0 ws0"> blocks.</div><div class="t m0 xd h11 y63d ff1 fs7 fc0 sc0 ls0 ws0">The</div><div class="t m2 x7c h19 y63d ffc fs7 fc0 sc0 ls0 ws0">Error.java</div><div class="t m0 x7b h11 y63d ff1 fs7 fc0 sc0 ls0 ws0"> Dependency Magnet</div><div class="t m0 xd h14 y63e ff8 fs3 fc0 sc0 ls0 ws3be">Returning er<span class="_ _8"></span>ror codes usually implies that there is some class or enum in which all the</div><div class="t m0 xd h14 y63f ff8 fs3 fc0 sc0 ls0 ws0">er<span class="_ _8"></span>ror codes are deﬁned.</div><div class="t m5 x74 h2f y640 ffb fs10 fc0 sc0 ls0 ws0">public enum Error {</div><div class="t m5 x52 h2f y641 ffb fs10 fc0 sc0 ls0 ws0">OK,</div><div class="t m5 x52 h2f y642 ffb fs10 fc0 sc0 ls0 ws0">INVALID,</div><div class="t m5 x52 h2f y643 ffb fs10 fc0 sc0 ls0 ws0">NO_SUCH,</div><div class="t m5 x52 h2f y644 ffb fs10 fc0 sc0 ls0 ws0">LOCKED,</div><div class="t m5 x52 h2f y645 ffb fs10 fc0 sc0 ls0 ws0">OUT_OF_RESOURCES,</div><div class="t m5 x52 h2f y646 ffb fs10 fc0 sc0 ls0 ws0">WAITING_FOR_EVENT;</div><div class="t m5 x74 h2f y647 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y648 ff8 fs3 fc0 sc0 ls0 ws334">Classes like this are a <span class="ffa">dependency ma<span class="_ _4"></span>gnet; <span class="ff8">many other classes must import and use</span></span></div><div class="t m0 xd h14 y649 ff8 fs3 fc0 sc0 ls0 ws3bf">them. <span class="_ _1"></span>Thus, when the </div><div class="t m5 xd0 h2f y42e ffb fs10 fc0 sc0 ls0 ws0">Error<span class="_ _9"> </span>enum</div><div class="t m0 xc h14 y42e ff8 fs3 fc0 sc0 ls0 ws3bf">changes, all those other classes need to be recompiled</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws82">and redeplo<span class="_ _4"></span>yed.</div><div class="t m0 x39 h21 y64a ff8 fsc fc0 sc0 ls0 ws0">11</div><div class="t m0 x6 h14 y31b ff8 fs3 fc0 sc0 lsc ws2b3">This puts a negati<span class="_ _4"></span>ve pressure on the </div><div class="t m5 x2a h2f y31b ffb fs10 fc0 sc0 ls0 ws0">Error</div><div class="t m0 x69 h14 y31b ff8 fs3 fc0 sc0 ls0 ws82">class. Programmers don’<span class="_ _1"></span>t want</div><div class="t m0 xd h25 y64b ff8 fse fc0 sc0 ls0 ws0">11.<span class="_ _16"> </span>Those who felt that the<span class="_ _4"></span>y could get aw<span class="_ _4"></span>ay without recompiling and redeplo<span class="_ _4"></span>ying ha<span class="_ _4"></span>ve been found—and dealt with.</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:354.728010px;width:150.293000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:272.428010px;width:188.615000px;height:13.668000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf4f" class="pf w1 h2" data-page-no="4f"><div class="pc pc4f w1 h2"><img class="bi x37 y64c w9 h40" alt="" src="bg4f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">48<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 lsd ws1e9">to add new errors because then they ha<span class="_ _4"></span>ve to rebuild and redeplo<span class="_ _1"></span>y ev<span class="_ _4"></span>er<span class="_ _8"></span>ything. So they reuse</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">old er<span class="_ _8"></span>ror codes instead of adding new ones.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls3d ws1ef">When you use e<span class="_ _4"></span>xceptions rather than er<span class="_ _8"></span>ror codes, then new e<span class="_ _4"></span>xceptions are <span class="ffa ws0">derivatives <span class="ff8">of</span></span></div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls3d ws0">the exception class. <span class="_ _1"></span>They can be added without forcing an<span class="_ _4"></span>y recompilation or redeplo<span class="_ _4"></span>yment.</div><div class="t m0 xc8 h21 y64d ff8 fsc fc0 sc0 ls3e ws0">12</div><div class="t m0 xd h17 y64e ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Repeat <span class="_ _2"></span>Y<span class="_ _3"></span>ourself</div><div class="t m0 x92 h41 y64f ff1 fs14 fc0 sc0 ls0 ws0">13</div><div class="t m0 xd h14 y650 ff8 fs3 fc0 sc0 ls0 wsa5">Look back at Listing 3-1 carefull<span class="_ _4"></span>y and you</div><div class="t m0 xd h14 y651 ff8 fs3 fc0 sc0 ls0 ws3c0">will notice that there is an algorithm that</div><div class="t m0 xd h14 y652 ff8 fs3 fc0 sc0 ls0 ws3bf">gets repeated four times, once for each of</div><div class="t m0 xd h14 y653 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x7c h2f y653 ffb fs10 fc0 sc0 ls0 ws0">SetUp</div><div class="t m0 x5f h14 y653 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x28 h2f y653 ffb fs10 fc0 sc0 ls0 ws0">SuiteSetUp</div><div class="t m0 xa h14 y653 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x2f h2f y653 ffb fs10 fc0 sc0 ls0 ws0">TearDown</div><div class="t m0 xd1 h14 y653 ff8 fs3 fc0 sc0 ls0 ws3c1">, and</div><div class="t m5 xd h2f y654 ffb fs10 fc0 sc0 ls0 ws0">SuiteTearDown</div><div class="t m0 xe h14 y654 ff8 fs3 fc0 sc0 ls0 ws3c2">cases. It’<span class="_ _2"></span>s not easy to spot</div><div class="t m0 xd h14 y655 ff8 fs3 fc0 sc0 ls0 ws3c3">this duplication because the four instances</div><div class="t m0 xd h14 y656 ff8 fs3 fc0 sc0 ls0 ws3c4">are intermixed with other code and aren’<span class="_ _1"></span>t</div><div class="t m0 xd h14 y657 ff8 fs3 fc0 sc0 ls0 ws2ff">uniformly duplicated. Still, the duplication</div><div class="t m0 xd h14 y658 ff8 fs3 fc0 sc0 ls0 ws3c5">is a problem because it b<span class="_ _4"></span>loats the code and</div><div class="t m0 xd h14 y659 ff8 fs3 fc0 sc0 ls0 ws13f">will require four-fold modiﬁcation should the algorithm e<span class="_ _4"></span>ver ha<span class="_ _1"></span>ve to change. It is also a</div><div class="t m0 xd h14 y65a ff8 fs3 fc0 sc0 ls0 ws0">four-fold opportunity for an er<span class="_ _8"></span>ror of omission.</div><div class="t m0 x74 h14 y65b ff8 fs3 fc0 sc0 ls0 ws3bf">This duplication was remedied b<span class="_ _1"></span>y the </div><div class="t m5 x9d h2f y65b ffb fs10 fc0 sc0 ls0 ws0">include</div><div class="t m0 xd2 h14 y65b ff8 fs3 fc0 sc0 ls0 ws3bf">method in Listing 3-7. Read through</div><div class="t m0 xd h14 y65c ff8 fs3 fc0 sc0 lsc ws3c6">that code again and notice ho<span class="_ _4"></span>w the readability of the whole module is enhanced b<span class="_ _4"></span>y the</div><div class="t m0 xd h14 y65d ff8 fs3 fc0 sc0 ls0 ws0">reduction of that duplication.</div><div class="t m0 x74 h14 y65e ff8 fs3 fc0 sc0 ls0 ws3e">Duplication ma<span class="_ _4"></span>y be the root of all evil in softw<span class="_ _4"></span>are. Many principles and practices ha<span class="_ _1"></span>ve</div><div class="t m0 xd h14 y65f ff8 fs3 fc0 sc0 ls0 ws3c7">been created for the pur<span class="_ _8"></span>pose of controlling or eliminating it. Consider<span class="_ _4"></span>, for example, that</div><div class="t m0 xd h14 y660 ff8 fs3 fc0 sc0 ls0 ws3c8">all of Codd’<span class="_ _2"></span>s database normal for<span class="_ _8"></span>ms ser<span class="_ _8"></span>ve to eliminate duplication in data. Consider also</div><div class="t m0 xd h14 y661 ff8 fs3 fc0 sc0 ls0 ws340">ho<span class="_ _4"></span>w object-oriented programming serves to concentrate code into base classes that w<span class="_ _4"></span>ould</div><div class="t m0 xd h14 y662 ff8 fs3 fc0 sc0 ls0 ws3c9">otherwise be redundant. Structured programming, <span class="_ _4"></span>Aspect Oriented Programming, Compo-</div><div class="t m0 xd h14 y663 ff8 fs3 fc0 sc0 ls0 ws3ca">nent Oriented Pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming, are all, in par<span class="_ _8"></span>t, strategies for eliminating duplication. It</div><div class="t m0 xd h14 y664 ff8 fs3 fc0 sc0 ls0 ws3cb">w<span class="_ _4"></span>ould appear that since the in<span class="_ _4"></span>vention of the subroutine, inno<span class="_ _1"></span>vations in softw<span class="_ _4"></span>are develop-</div><div class="t m0 xd h14 y665 ff8 fs3 fc0 sc0 ls0 ws0">ment ha<span class="_ _4"></span>ve been an ongoing attempt to eliminate duplication from our source code. </div><div class="t m0 xd h17 y666 ff1 fs9 fc0 sc0 ls0 ws0">Structur<span class="_ _4"></span>ed Pr<span class="_ _4"></span>ogramming</div><div class="t m0 xd h14 y667 ff8 fs3 fc0 sc0 ls17 ws3cc">Some programmers follo<span class="_ _4"></span>w Edsger Dijkstra’<span class="_ _2"></span>s rules of str<span class="_ _8"></span>uctured programming.</div><div class="t m0 xd3 h21 y668 ff8 fsc fc0 sc0 ls3f ws0">14</div><div class="t m0 x64 h14 y667 ff8 fs3 fc0 sc0 ls17 ws0">Dijkstra</div><div class="t m0 xd h14 y669 ff8 fs3 fc0 sc0 ls17 ws3cd">said that ev<span class="_ _4"></span>ery function, and every block within a function, should ha<span class="_ _1"></span>ve one entr<span class="_ _8"></span>y and one</div><div class="t m0 xd h14 y66a ff8 fs3 fc0 sc0 ls17 ws39d">exit. F<span class="_ _1"></span>ollo<span class="_ _4"></span>wing these r<span class="_ _8"></span>ules means that there should only be one </div><div class="t m5 xab h2f y66a ffb fs10 fc0 sc0 ls0 ws0">return</div><div class="t m0 x59 h14 y66a ff8 fs3 fc0 sc0 ls17 ws39d">statement in a func-</div><div class="t m0 xd h14 y66b ff8 fs3 fc0 sc0 ls17 ws0">tion, no </div><div class="t m5 x75 h2f y66b ffb fs10 fc0 sc0 ls0 ws0">break</div><div class="t m0 x6d h14 y66b ff8 fs3 fc0 sc0 ls17 ws0"> or </div><div class="t m5 x3a h2f y66b ffb fs10 fc0 sc0 ls0 ws0">continue</div><div class="t m0 xb1 h14 y66b ff8 fs3 fc0 sc0 ls17 ws0"> statements in a loop, and ne<span class="_ _4"></span>ver<span class="_ _4"></span>, <span class="ffa">ever<span class="_ _2"></span>,<span class="ff8"> any </span></span></div><div class="t m5 x72 h2f y66b ffb fs10 fc0 sc0 ls0 ws0">goto</div><div class="t m0 x8b h14 y66b ff8 fs3 fc0 sc0 ls17 ws0"> statements. </div><div class="t m0 xd h25 y66c ff8 fse fc0 sc0 ls0 ws0">12.<span class="_ _16"> </span>This is an example of the Open Closed Principle (OCP) [PPP02].</div><div class="t m0 xd h25 y66d ff8 fse fc0 sc0 ls0 ws0">13.<span class="_ _16"> </span>The DR<span class="_ _0"></span>Y principle. [PRA<span class="_ _4"></span>G].</div><div class="t m0 xd h25 y66e ff8 fse fc0 sc0 ls0 ws0">14.<span class="_ _16"> </span>[SP72].</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:510.545010px;width:138.198000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:196.545010px;width:151.699000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf50" class="pf w1 h2" data-page-no="50"><div class="pc pc50 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">49<span class="_ _10"></span><span class="ff1">Conclusion</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws3ce">While w<span class="_ _4"></span>e are sympathetic to the goals and disciplines of str<span class="_ _8"></span>uctured programming,</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws3cf">those rules ser<span class="_ _8"></span>ve little beneﬁt when functions are v<span class="_ _4"></span>er<span class="_ _8"></span>y small. It is only in lar<span class="_ _4"></span>ger functions</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">that such rules pro<span class="_ _4"></span>vide signiﬁcant beneﬁt. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3d0">So if you k<span class="_ _4"></span>eep your functions small, then the occasional multiple </div><div class="t m5 x4a h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">return</div><div class="t m0 x7a h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd4 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">break</div><div class="t m0 x8c h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3d0">, or</div><div class="t m5 xd h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">continue</div><div class="t m0 x3f h14 y1bd ff8 fs3 fc0 sc0 ls0 ws212">statement does no harm and can sometimes even be more e<span class="_ _4"></span>xpressiv<span class="_ _4"></span>e than the sin-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws3d1">gle-entry<span class="_ _1"></span>, single-exit rule. On the other hand<span class="_ _4"></span>, </div><div class="t m5 x1b h2f y1be ffb fs10 fc0 sc0 ls0 ws0">goto</div><div class="t m0 x4f h14 y1be ff8 fs3 fc0 sc0 ls0 ws3d1">only mak<span class="_ _4"></span>es sense in large functions, so</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">it should be a<span class="_ _4"></span>voided.</div><div class="t m0 xd h17 y4dc ff1 fs9 fc0 sc0 ls0 ws0">Ho<span class="_ _1"></span>w Do <span class="_ _2"></span>Y<span class="_ _3"></span>ou <span class="_ _0"></span>Write Functions Lik<span class="_ _4"></span>e <span class="_ _1"></span>This?</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws3d2">Writing softw<span class="_ _4"></span>are is like any other kind of writing. <span class="_ _4"></span>When you write a paper or an article,</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws3d3">you get y<span class="_ _4"></span>our thoughts do<span class="_ _4"></span>wn ﬁrst, then you massage it until it reads w<span class="_ _4"></span>ell. <span class="_ _1"></span>The ﬁrst draft</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 lsc ws3d4">might be clumsy and disorganized<span class="_ _0"></span>, so you w<span class="_ _4"></span>ordsmith it and restr<span class="_ _8"></span>ucture it and reﬁne it until</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">it reads the w<span class="_ _4"></span>ay y<span class="_ _4"></span>ou want it to read.</div><div class="t m0 x74 h14 y4df ff8 fs3 fc0 sc0 ls0 ws3d5">When I write functions, they come out long and complicated. <span class="_ _1"></span>They ha<span class="_ _4"></span>ve lots of</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws3d6">indenting and nested loops. <span class="_ _1"></span>They ha<span class="_ _4"></span>ve long argument lists. <span class="_ _1"></span>The names are arbitrar<span class="_ _8"></span>y<span class="_ _0"></span>, and</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws111">there is duplicated code. But I also ha<span class="_ _4"></span>ve a suite of unit tests that co<span class="_ _1"></span>ver ev<span class="_ _4"></span>er<span class="_ _8"></span>y one of those</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws0">clumsy lines of code. </div><div class="t m0 x74 h14 y2a ff8 fs3 fc0 sc0 ls0 ws3d7">So then I massage and reﬁne that code, splitting out functions, changing names, elim-</div><div class="t m0 xd h14 y2b ff8 fs3 fc0 sc0 ls0 ws3d8">inating duplication. I shrink the methods and reorder them. Sometimes I break out whole</div><div class="t m0 xd h14 y2c ff8 fs3 fc0 sc0 ls0 ws0">classes, all the while k<span class="_ _4"></span>eeping the tests passing. </div><div class="t m0 x74 h14 y284 ff8 fs3 fc0 sc0 ls0 wsd2">In the end<span class="_ _1"></span>, I wind up with functions that follo<span class="_ _4"></span>w the r<span class="_ _8"></span>ules I’<span class="_ _4"></span>ve laid do<span class="_ _1"></span>wn in this chapter<span class="_ _4"></span>.</div><div class="t m0 xd h14 y285 ff8 fs3 fc0 sc0 ls0 ws0">I don’<span class="_ _1"></span>t write them that wa<span class="_ _4"></span>y to star<span class="_ _8"></span>t. I don’<span class="_ _4"></span>t think an<span class="_ _4"></span>yone could.</div><div class="t m0 xd h17 y66f ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y670 ff8 fs3 fc0 sc0 lsd ws3d9">Every system is built from a domain-speciﬁc language designed by the pro<span class="_ _4"></span>grammers to</div><div class="t m0 xd h14 y671 ff8 fs3 fc0 sc0 ls0 wsb5">describe that system. Functions are the verbs of that language, and classes are the nouns.</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls0 ws2ba">This is not some thro<span class="_ _4"></span>wback to the hideous old notion that the nouns and verbs in a require-</div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls0 ws1f7">ments document are the ﬁrst guess of the classes and functions of a system. Rather<span class="_ _4"></span>, this is</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls0 ws3da">a much older truth. <span class="_ _4"></span>The ar<span class="_ _8"></span>t of programming is, and has al<span class="_ _4"></span>wa<span class="_ _4"></span>ys been, the art of language</div><div class="t m0 xd h14 y675 ff8 fs3 fc0 sc0 ls0 ws0">design.</div><div class="t m0 x74 h14 y676 ff8 fs3 fc0 sc0 ls12 ws3a">Master pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers think of systems as stories to be told rather than programs to</div><div class="t m0 xd h14 y677 ff8 fs3 fc0 sc0 ls12 ws3db">be written. <span class="_ _1"></span>They use the facilities of their chosen programming language to constr<span class="_ _8"></span>uct a</div><div class="t m0 xd h14 y678 ff8 fs3 fc0 sc0 ls40 ws26c">much richer and more expressi<span class="_ _4"></span>ve language that can be used to tell that story<span class="_ _1"></span>. Part of that</div><div class="t m0 xd h14 y679 ff8 fs3 fc0 sc0 ls12 ws3dc">domain-speciﬁc language is the hierarch<span class="_ _4"></span>y of functions that describe all the actions that</div><div class="t m0 xd h14 y67a ff8 fs3 fc0 sc0 ls12 ws108">take place within that system. In an artful act of recursion those actions are written to</div><div class="t m0 xd h14 y67b ff8 fs3 fc0 sc0 ls12 ws3dd">use the very domain-speciﬁc language they deﬁne to tell their o<span class="_ _1"></span>wn small par<span class="_ _8"></span>t of the</div><div class="t m0 xd h14 y67c ff8 fs3 fc0 sc0 ls12 ws0">story<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y67d ff8 fs3 fc0 sc0 ls12 ws87">This chapter has been about the mechanics of writing functions w<span class="_ _4"></span>ell. If you follo<span class="_ _1"></span>w</div><div class="t m0 xd h14 y67e ff8 fs3 fc0 sc0 ls12 ws3de">the rules herein, your functions will be short, well named<span class="_ _1"></span>, and nicel<span class="_ _4"></span>y organized. But</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:475.945010px;width:239.790000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:266.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf51" class="pf w1 h2" data-page-no="51"><div class="pc pc51 w1 h2"><img class="bi xd y67f wc h42" alt="" src="bg51.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">50<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls12 ws10f">ne<span class="_ _4"></span>ver forget that y<span class="_ _4"></span>our real goal is to tell the stor<span class="_ _8"></span>y of the system, and that the functions</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls12 ws11e">you write need to ﬁt cleanl<span class="_ _4"></span>y to<span class="_ _4"></span>gether into a clear and precise language to help you with</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls12 ws0">that telling.</div><div class="t m3 xd h1a y680 ffc fsa fc0 sc0 ls0 ws0">SetupTeardownIncluder</div><div class="t m0 x74 h1c y681 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-7 </div><div class="t m0 x74 h36 y682 ffc fs3 fc0 sc0 ls0 ws0">SetupTeardownIncluder.java</div><div class="t m5 x74 h2f y5b8 ffb fs10 fc0 sc0 ls0 ws0">package fitnesse.html;</div><div class="t m5 x74 h2f y683 ffb fs10 fc0 sc0 ls0 ws0">import fitnesse.responders.run.SuiteResponder;</div><div class="t m5 x74 h2f y684 ffb fs10 fc0 sc0 ls0 ws0">import fitnesse.wiki.*;</div><div class="t m5 x74 h2f y685 ffb fs10 fc0 sc0 ls0 ws0">public class SetupTeardownIncluder {</div><div class="t m5 x74 h2f y686 ffb fs10 fc0 sc0 ls0 ws0">  private PageData pageData;</div><div class="t m5 x74 h2f y687 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isSuite;</div><div class="t m5 x74 h2f y688 ffb fs10 fc0 sc0 ls0 ws0">  private WikiPage testPage;</div><div class="t m5 x74 h2f y689 ffb fs10 fc0 sc0 ls0 ws0">  private StringBuffer newPageContent;</div><div class="t m5 x74 h2f y68a ffb fs10 fc0 sc0 ls0 ws0">  private PageCrawler pageCrawler;</div><div class="t m5 x74 h2f y68b ffb fs10 fc0 sc0 ls0 ws0">  public static String render(PageData pageData) throws Exception {</div><div class="t m5 x74 h2f y68c ffb fs10 fc0 sc0 ls0 ws0">    return render(pageData, false);</div><div class="t m5 x74 h2f y68d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y68e ffb fs10 fc0 sc0 ls0 ws0">  public static String render(PageData pageData, boolean isSuite)</div><div class="t m5 x74 h2f y68f ffb fs10 fc0 sc0 ls0 ws0">    throws Exception {</div><div class="t m5 x74 h2f y690 ffb fs10 fc0 sc0 ls0 ws0">    return new SetupTeardownIncluder(pageData).render(isSuite);</div><div class="t m5 x74 h2f y691 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y692 ffb fs10 fc0 sc0 ls0 ws0">  private SetupTeardownIncluder(PageData pageData) {</div><div class="t m5 x74 h2f y693 ffb fs10 fc0 sc0 ls0 ws0">    this.pageData = pageData;</div><div class="t m5 x74 h2f y694 ffb fs10 fc0 sc0 ls0 ws0">    testPage = pageData.getWikiPage();</div><div class="t m5 x74 h2f y695 ffb fs10 fc0 sc0 ls0 ws0">    pageCrawler = testPage.getPageCrawler();</div><div class="t m5 x74 h2f y696 ffb fs10 fc0 sc0 ls0 ws0">    newPageContent = new StringBuffer();</div><div class="t m5 x74 h2f y697 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y698 ffb fs10 fc0 sc0 ls0 ws0">  private String render(boolean isSuite) throws Exception {</div><div class="t m5 x74 h2f y699 ffb fs10 fc0 sc0 ls0 ws0">    this.isSuite = isSuite;</div><div class="t m5 x74 h2f y69a ffb fs10 fc0 sc0 ls0 ws0">    if (isTestPage())</div><div class="t m5 x74 h2f y69b ffb fs10 fc0 sc0 ls0 ws0">      includeSetupAndTeardownPages();</div><div class="t m5 x74 h2f y69c ffb fs10 fc0 sc0 ls0 ws0">    return pageData.getHtml();</div><div class="t m5 x74 h2f y69d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y69e ffb fs10 fc0 sc0 ls0 ws0">  private boolean isTestPage() throws Exception {</div><div class="t m5 x74 h2f y69f ffb fs10 fc0 sc0 ls0 ws0">    return pageData.hasAttribute(&quot;Test&quot;);</div><div class="t m5 x74 h2f y6a0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a1 ffb fs10 fc0 sc0 ls0 ws0">  private void includeSetupAndTeardownPages() throws Exception {</div><div class="t m5 x74 h2f y6a2 ffb fs10 fc0 sc0 ls0 ws0">    includeSetupPages();</div><div class="t m5 x74 h2f y6a3 ffb fs10 fc0 sc0 ls0 ws0">    includePageContent();</div><div class="t m5 x74 h2f y6a4 ffb fs10 fc0 sc0 ls0 ws0">    includeTeardownPages();</div><div class="t m5 x74 h2f y6a5 ffb fs10 fc0 sc0 ls0 ws0">    updatePageContent();</div><div class="t m5 x74 h2f y6a6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:526.594010px;width:141.092000px;height:14.717000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf52" class="pf w1 h2" data-page-no="52"><div class="pc pc52 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg52.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">51</div><div class="t m7 xd h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SetupTeardownIncluder</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private void includeSetupPages() throws Exception {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    if (isSuite)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      includeSuiteSetupPage();</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    includeSetupPage();</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  private void includeSuiteSetupPage() throws Exception {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    include(SuiteResponder.SUITE_SETUP_NAME, &quot;-setup&quot;);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  private void includeSetupPage() throws Exception {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    include(&quot;SetUp&quot;, &quot;-setup&quot;);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  private void includePageContent() throws Exception {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    newPageContent.append(pageData.getContent());</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  private void includeTeardownPages() throws Exception {</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    includeTeardownPage();</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    if (isSuite)</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">      includeSuiteTeardownPage();</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  private void includeTeardownPage() throws Exception {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    include(&quot;TearDown&quot;, &quot;-teardown&quot;);</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  private void includeSuiteTeardownPage() throws Exception {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    include(SuiteResponder.SUITE_TEARDOWN_NAME, &quot;-teardown&quot;);</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  private void updatePageContent() throws Exception {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    pageData.setContent(newPageContent.toString());</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  private void include(String pageName, String arg) throws Exception {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    WikiPage inheritedPage = findInheritedPage(pageName);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    if (inheritedPage != null) {</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">      String pagePathName = getPathNameForPage(inheritedPage);</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      buildIncludeDirective(pagePathName, arg);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  private WikiPage findInheritedPage(String pageName) throws Exception {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return PageCrawlerImpl.getInheritedPage(pageName, testPage);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  private String getPathNameForPage(WikiPage page) throws Exception {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    WikiPagePath pagePath = pageCrawler.getFullPath(page);</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    return PathParser.render(pagePath);</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  private void buildIncludeDirective(String pagePathName, String arg) {</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">    newPageContent</div><div class="t m5 x74 h2f y6b5 ffb fs10 fc0 sc0 ls0 ws0">      .append(&quot;\n!include &quot;)</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SetupTeardownIncluder.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf53" class="pf w1 h2" data-page-no="53"><div class="pc pc53 w1 h2"><img class="bi xd y6b6 wc h44" alt="" src="bg53.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">52<span class="_ _1f"> </span><span class="ff1 wsa0">Chapter 3:<span class="_ _4"></span> Functions</span></div><div class="t m0 xd h17 y6b7 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y3b6 ff1 fs3 fc0 sc0 ls0 wsa0">[KP78]:<span class="_ _4"></span>  <span class="ff8 ws2de">Kernighan and Plaugher<span class="_ _4"></span>, <span class="_ _1"></span><span class="ffa">The Elements of Pro<span class="_ _4"></span>gr<span class="_ _4"></span>amming Style<span class="ff8">, 2d. ed., McGra<span class="_ _4"></span>w-</span></span></span></div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">Hill, 1978.</div><div class="t m0 xd h14 y3b1 ff1 fs3 fc0 sc0 ls0 wsa0">[PPP02]:<span class="_ _4"></span>  <span class="ff8 ws3df">Rober<span class="_ _8"></span>t C. Mar<span class="_ _8"></span>tin, <span class="_ _1"></span><span class="ffa">Agile Softwar<span class="_ _4"></span>e Development: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>ac-</span></span></div><div class="t m0 xd h14 y256 ffa fs3 fc0 sc0 ls0 ws0">tices<span class="ff8">, Prentice Hall, 2002.</span></div><div class="t m0 xd h14 y258 ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa wse4">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e<span class="ff8">, Gamma et al.,</span></span></div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><div class="t m0 xd h14 y29e ff1 fs3 fc0 sc0 ls0 wsa0">[PRA<span class="_ _1"></span>G]:  <span class="ffa ws3e0">The Pr<span class="_ _1"></span>agmatic Pr<span class="_ _4"></span>o<span class="_ _4"></span>gr<span class="_ _4"></span>ammer<span class="_ _4"></span><span class="ff8">, <span class="_ _4"></span>Andrew Hunt, Da<span class="_ _1"></span>ve <span class="_ _4"></span>Thomas, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>,</span></span></div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws0">2000.</div><div class="t m0 xd h14 y2a1 ff1 fs3 fc0 sc0 ls0 wsa0">[SP72]:<span class="_ _4"></span>  <span class="ffa ws3d6">Structured Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>amming<span class="ff8">, O<span class="_ _4"></span>.-J<span class="_ _1"></span>. Dahl, E. W<span class="_ _3"></span>. Dijkstra, C. <span class="_ _4"></span>A. R. Hoare, <span class="_ _4"></span>Academic</span></span></div><div class="t m0 xd h14 y437 ff8 fs3 fc0 sc0 ls0 ws0">Press, London, 1972.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      .append(arg)</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      .append(&quot; .&quot;)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      .append(pagePathName)</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      .append(&quot;\n&quot;);</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 3-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SetupTeardownIncluder.java</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:477.945010px;width:77.392000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf54" class="pf w1 h2" data-page-no="54"><div class="pc pc54 w1 h2"><img class="bi xd y6b8 w4 h45" alt="" src="bg54.png"/><div class="t m0 x16 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">53</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">4</div><div class="t m0 xca h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Comments</div><div class="t m0 x4f h1d y6b9 ffa fs3 fc0 sc0 ls0 ws0">“Don’<span class="_ _0"></span>t comment bad code—re<span class="_ _4"></span>write it.<span class="_ _3"></span>”</div><div class="t m0 xd5 h14 y6ba ff8 fs3 fc0 sc0 ls0 ws0">—Brian <span class="_ _4"></span>W<span class="_ _2"></span>. Kernighan and P<span class="_ _3"></span>. J<span class="_ _4"></span>. Plaugher</div><div class="t m0 x56 h21 y6bb ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 xd h14 y6bc ff8 fs3 fc0 sc0 ls0 ws2a8">Nothing can be quite so helpful as a w<span class="_ _4"></span>ell-placed comment. Nothing can clutter up a mod-</div><div class="t m0 xd h14 y6bd ff8 fs3 fc0 sc0 ls0 ws3a8">ule more than fri<span class="_ _4"></span>volous do<span class="_ _4"></span>gmatic comments. Nothing can be quite so damaging as an old</div><div class="t m0 xd h14 y6be ff8 fs3 fc0 sc0 lsc ws3f">crufty comment that propagates lies and misinfor<span class="_ _8"></span>mation.</div><div class="t m0 x74 h14 y6bf ff8 fs3 fc0 sc0 ls0 ws3e1">Comments are not like Schindler’<span class="_ _2"></span>s List. <span class="_ _1"></span>They are not “pure good.<span class="_ _1"></span>” Indeed<span class="_ _1"></span>, comments</div><div class="t m0 xd h14 y6c0 ff8 fs3 fc0 sc0 ls0 ws1c">are, at best, a necessary evil. If our pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming languages w<span class="_ _4"></span>ere expressiv<span class="_ _4"></span>e enough, or if</div><div class="t m0 xd h25 y6c1 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[KP78], p. 144.</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:328.285000px;bottom:440.027010px;width:110.639000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf55" class="pf w1 h2" data-page-no="55"><div class="pc pc55 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">54<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls11 ws225">w<span class="_ _4"></span>e had the talent to subtly wield those languages to e<span class="_ _4"></span>xpress our intent, we w<span class="_ _1"></span>ould not need</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">comments very much—perhaps not at all. </div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws3e2">The proper use of comments is to compensate for our failure to express ourself in</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3e3">code. Note that I used the w<span class="_ _4"></span>ord <span class="ffa ws0">failur<span class="_ _4"></span>e<span class="ff8 ws3e3">. I meant it. Comments are al<span class="_ _4"></span>wa<span class="_ _4"></span>ys failures. W<span class="_ _2"></span>e must</span></span></div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws1fa">ha<span class="_ _4"></span>ve them because w<span class="_ _4"></span>e cannot al<span class="_ _4"></span>wa<span class="_ _4"></span>ys ﬁgure out ho<span class="_ _4"></span>w to express ourselv<span class="_ _4"></span>es without them,</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 lsd wsef">but their use is not a cause for celebration. </div><div class="t m0 x74 h14 y205 ff8 fs3 fc0 sc0 ls0 ws84">So when y<span class="_ _4"></span>ou ﬁnd yourself in a position w<span class="_ _4"></span>here you need to write a comment, think it</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws34">through and see whether there isn’<span class="_ _1"></span>t some wa<span class="_ _1"></span>y to tur<span class="_ _8"></span>n the tables and express y<span class="_ _4"></span>ourself in</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws3e4">code. Every time you e<span class="_ _4"></span>xpress yourself in code, y<span class="_ _4"></span>ou should pat yourself on the back. Every</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws3e5">time you write a comment, y<span class="_ _4"></span>ou should grimace and feel the f<span class="_ _8"></span>ailure of your ability of</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws0">expression.</div><div class="t m0 x74 h14 y209 ff8 fs3 fc0 sc0 ls0 ws3e6">Wh<span class="_ _4"></span>y am I so do<span class="_ _4"></span>wn on comments? Because they lie. Not al<span class="_ _4"></span>wa<span class="_ _4"></span>ys, and not intentionall<span class="_ _4"></span>y<span class="_ _1"></span>,</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 lsd ws3e7">but too often. <span class="_ _1"></span>The older a comment is, and the f<span class="_ _8"></span>ar<span class="_ _8"></span>ther a<span class="_ _4"></span>wa<span class="_ _1"></span>y it is from the code it describes,</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 ls0 ws31">the more likel<span class="_ _4"></span>y it is to be just plain wrong. <span class="_ _4"></span>The reason is simple. Programmers can’<span class="_ _1"></span>t realis-</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws0">tically maintain them. </div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws3e8">Code changes and e<span class="_ _4"></span>volves. Chunks of it mo<span class="_ _1"></span>ve from here to there. <span class="_ _1"></span>Those chunks bifur-</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 lsc ws3e9">cate and reproduce and come to<span class="_ _4"></span>gether again to for<span class="_ _8"></span>m chimeras. Unfor<span class="_ _8"></span>tunately the com-</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws3ea">ments don’<span class="_ _1"></span>t alw<span class="_ _4"></span>a<span class="_ _4"></span>ys follow them—<span class="_ _4"></span><span class="ffa ws0">can’<span class="_ _1"></span>t<span class="_ _23"> </span><span class="ff8 ws3ea">al<span class="_ _4"></span>wa<span class="_ _1"></span>ys follow them. <span class="_ _1"></span>And all too often the</span></span></div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws3eb">comments get separated from the code they describe and become orphaned blurbs of e<span class="_ _4"></span>ver-</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws7e">decreasing accuracy<span class="_ _0"></span>. F<span class="_ _1"></span>or example, look what has happened to this comment and the line it</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>as intended to describe:</div><div class="t m5 x52 h2f y6c4 ffb fs10 fc0 sc0 ls0 ws0">MockRequest request;</div><div class="t m5 x52 h2f y6c5 ffb fs10 fc0 sc0 ls0 ws0">private final String HTTP_DATE_REGEXP = </div><div class="t m5 x74 h2f y6c6 ffb fs10 fc0 sc0 ls18 ws3b9">    &quot;[SMTWF][a-z]{2}\\,\\s[0-9]{2}\\s[JFMASOND][a-z]{2}\\s&quot;+</div><div class="t m5 x74 h2f y6c7 ffb fs10 fc0 sc0 ls18 ws3b9">    &quot;[0-9]{4}\\s[0-9]{2}\\:[0-9]{2}\\:[0-9]{2}\\sGMT&quot;;</div><div class="t m5 x52 h2f y6c8 ffb fs10 fc0 sc0 ls0 ws0">private Response response;</div><div class="t m5 x52 h2f y6c9 ffb fs10 fc0 sc0 ls0 ws0">private FitNesseContext context;</div><div class="t m5 x52 h2f y6ca ffb fs10 fc0 sc0 ls0 ws0">private FileResponder responder;</div><div class="t m5 x52 h2f y6cb ffb fs10 fc0 sc0 ls0 ws0">private Locale saveLocale;</div><div class="t m5 x52 h46 y6cc ffc fs10 fc0 sc0 ls0 ws0">// Example: &quot;Tue, 02 Apr 2003 22:18:49 GMT&quot;</div><div class="t m0 xd h14 y43a ff8 fs3 fc0 sc0 ls0 ws3ec">Other instance v<span class="_ _4"></span>ariables that w<span class="_ _4"></span>ere probabl<span class="_ _4"></span>y added later w<span class="_ _4"></span>ere inter<span class="_ _8"></span>posed between the</div><div class="t m5 xd h2f y43b ffb fs10 fc0 sc0 ls0 ws0">HTTP_DATE_REGEXP</div><div class="t m0 xbc h14 y43b ff8 fs3 fc0 sc0 ls0 ws0"> constant and it’<span class="_ _2"></span>s explanatory comment. </div><div class="t m0 x74 h14 y393 ff8 fs3 fc0 sc0 ls0 ws3ed">It is possible to mak<span class="_ _4"></span>e the point that programmers should be disciplined enough to</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws144">keep the comments in a high state of repair<span class="_ _1"></span>, relev<span class="_ _4"></span>ance, and accuracy<span class="_ _0"></span>. I ag<span class="_ _8"></span>ree, they should.</div><div class="t m0 xd h14 y395 ff8 fs3 fc0 sc0 ls0 ws31f">But I w<span class="_ _4"></span>ould rather that energy go to<span class="_ _1"></span>ward making the code so clear and expressi<span class="_ _4"></span>ve that it</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">does not need the comments in the ﬁrst place. </div><div class="t m0 x74 h14 y397 ff8 fs3 fc0 sc0 ls0 ws3ee">Inaccurate comments are far w<span class="_ _4"></span>orse than no comments at all. <span class="_ _4"></span>They delude and mislead.</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws3ef">They set e<span class="_ _4"></span>xpectations that will nev<span class="_ _4"></span>er be fulﬁlled. <span class="_ _4"></span>They la<span class="_ _4"></span>y do<span class="_ _4"></span>wn old r<span class="_ _8"></span>ules that need not, or</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">should not, be follo<span class="_ _4"></span>w<span class="_ _4"></span>ed any longer<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws3f0">T<span class="_ _4"></span>r<span class="_ _8"></span>uth can only be found in one place: the code. Onl<span class="_ _4"></span>y the code can truly tell y<span class="_ _4"></span>ou what</div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws209">it does. It is the onl<span class="_ _4"></span>y source of tr<span class="_ _8"></span>uly accurate information. <span class="_ _4"></span>Therefore, though comments are</div><div class="t m0 xd h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws0">sometimes necessary<span class="_ _1"></span>, w<span class="_ _4"></span>e will expend signiﬁcant energy to minimize them.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf56" class="pf w1 h2" data-page-no="56"><div class="pc pc56 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">55<span class="_ _10"></span><span class="ff1">Good Comments</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Comments Do Not Make Up f<span class="_ _1"></span>or Bad Code</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws3f1">One of the more common moti<span class="_ _4"></span>vations for writing comments is bad code. <span class="_ _4"></span>W<span class="_ _0"></span>e write a mod-</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 lsc ws306">ule and w<span class="_ _4"></span>e kno<span class="_ _4"></span>w it is confusing and disorganized. <span class="_ _4"></span>W<span class="_ _0"></span>e kno<span class="_ _4"></span>w it’<span class="_ _2"></span>s a mess. So we sa<span class="_ _1"></span>y to our-</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws0">selves, “Ooh, I’<span class="_ _3"></span>d better comment that!” No! <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _2"></span>d better clean it! </div><div class="t m0 x74 h14 y460 ff8 fs3 fc0 sc0 ls0 ws5f">Clear and expressi<span class="_ _4"></span>ve code with fe<span class="_ _4"></span>w comments is far superior to cluttered and complex</div><div class="t m0 xd h14 y461 ff8 fs3 fc0 sc0 ls0 ws3f2">code with lots of comments. Rather than spend your time writing the comments that</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws0">explain the mess y<span class="_ _4"></span>ou’<span class="_ _4"></span>ve made, spend it cleaning that mess.</div><div class="t m0 xd h17 y6cd ff1 fs9 fc0 sc0 ls0 ws0">Explain <span class="_ _2"></span>Y<span class="_ _3"></span>our<span class="_ _4"></span>self in Code</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws127">There are certainly times w<span class="_ _4"></span>hen code makes a poor vehicle for explanation. Unfortunatel<span class="_ _4"></span>y<span class="_ _1"></span>,</div><div class="t m0 xd h14 y6ce ff8 fs3 fc0 sc0 ls0 wsa0">many pro<span class="_ _1"></span>g<span class="_ _8"></span>rammers hav<span class="_ _4"></span>e taken this to mean that code is seldom, if ev<span class="_ _4"></span>er<span class="_ _4"></span>, a good means for</div><div class="t m0 xd h14 y6cf ff8 fs3 fc0 sc0 ls0 ws0">explanation. <span class="_ _1"></span>This is patently false. <span class="_ _4"></span>Which w<span class="_ _4"></span>ould you rather see? <span class="_ _1"></span>This:</div><div class="t m5 x74 h2f y6d0 ffb fs10 fc0 sc0 ls0 ws0">// Check to see if the employee is eligible for full benefits</div><div class="t m5 x74 h2f y6d1 ffb fs10 fc0 sc0 ls0 ws0">if ((employee.flags &amp; HOURLY_FLAG) &amp;&amp; </div><div class="t m5 x74 h2f y6d2 ffb fs10 fc0 sc0 ls19 ws237">    (employee.age &gt; 65)) </div><div class="t m0 xd h14 y2d9 ff8 fs3 fc0 sc0 ls0 ws0">Or this?</div><div class="t m5 x74 h2f y6d3 ffb fs10 fc0 sc0 ls0 ws0">if (employee.isEligibleForFullBenefits())</div><div class="t m0 x74 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws3f3">It takes onl<span class="_ _4"></span>y a few seconds of thought to e<span class="_ _4"></span>xplain most of your intent in code. In man<span class="_ _4"></span>y</div><div class="t m0 xd h14 y6d5 ff8 fs3 fc0 sc0 ls0 ws182">cases it’<span class="_ _2"></span>s simply a matter of creating a function that sa<span class="_ _1"></span>ys the same thing as the comment</div><div class="t m0 xd h14 y6d6 ff8 fs3 fc0 sc0 ls0 ws0">you w<span class="_ _4"></span>ant to write.</div><div class="t m0 xd h17 y6d7 ff1 fs9 fc0 sc0 ls0 ws0">Good Comments</div><div class="t m0 xd h14 y6d8 ff8 fs3 fc0 sc0 ls0 ws3f4">Some comments are necessary or beneﬁcial. W<span class="_ _0"></span>e’<span class="_ _1"></span>ll look at a few that I consider w<span class="_ _4"></span>orthy of</div><div class="t m0 xd h14 y58d ff8 fs3 fc0 sc0 ls0 ws3f5">the bits they consume. K<span class="_ _4"></span>eep in mind<span class="_ _1"></span>, how<span class="_ _1"></span>ever<span class="_ _1"></span>, that the only truly good comment is the</div><div class="t m0 xd h14 y43a ff8 fs3 fc0 sc0 ls0 ws0">comment you found a w<span class="_ _4"></span>a<span class="_ _4"></span>y not to write.</div><div class="t m0 xd h11 y61e ff1 fs7 fc0 sc0 ls0 ws0">Legal Comments</div><div class="t m0 xd h14 y6d9 ff8 fs3 fc0 sc0 lsc ws29">Sometimes our cor<span class="_ _8"></span>porate coding standards force us to write certain comments for legal</div><div class="t m0 xd h14 y6da ff8 fs3 fc0 sc0 ls0 ws3f6">reasons. F<span class="_ _1"></span>or example, copyright and authorship statements are necessary and reasonable</div><div class="t m0 xd h14 y6db ff8 fs3 fc0 sc0 ls0 ws0">things to put into a comment at the start of each source ﬁle.</div><div class="t m0 x74 h14 y6dc ff8 fs3 fc0 sc0 ls0 ws3f7">Here, for example, is the standard comment header that w<span class="_ _1"></span>e put at the beginning of</div><div class="t m0 xd h14 y6dd ff8 fs3 fc0 sc0 ls0 ws3a5">e<span class="_ _4"></span>very source ﬁle in FitNesse. I am happ<span class="_ _4"></span>y to say that our IDE hides this comment from act-</div><div class="t m0 xd h14 y6de ff8 fs3 fc0 sc0 ls0 ws0">ing as clutter b<span class="_ _4"></span>y automatically collapsing it.</div><div class="t m5 x74 h2f y6df ffb fs10 fc0 sc0 ls0 ws0">// Copyright (C) 2003,2004,2005 by Object Mentor, Inc. All rights reserved.</div><div class="t m5 x74 h2f y6e0 ffb fs10 fc0 sc0 ls41 ws0">//<span class="_ _23"> </span>Released under the terms of the GNU General Public License version 2 or later.</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:252.645000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:461.945010px;width:147.804000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:273.945010px;width:100.715000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:201.728010px;width:86.808000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf57" class="pf w1 h2" data-page-no="57"><div class="pc pc57 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">56<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 lsc ws3f8">Comments like this should not be contracts or le<span class="_ _4"></span>gal tomes. Where possib<span class="_ _4"></span>le, refer to a stan-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws3f9">dard license or other external document rather than putting all the terms and conditions</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">into the comment.</div><div class="t m0 xd h11 y6e1 ff1 fs7 fc0 sc0 ls0 ws0">Inf<span class="_ _4"></span>ormativ<span class="_ _4"></span>e Comments</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws3d3">It is sometimes useful to pro<span class="_ _4"></span>vide basic information with a comment. F<span class="_ _4"></span>or example, con-</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">sider this comment that explains the return value of an abstract method:</div><div class="t m5 x52 h46 y6e2 ffc fs10 fc0 sc0 ls0 ws0">// Returns an instance of the Responder being tested.</div><div class="t m5 x52 h2f y6e3 ffb fs10 fc0 sc0 ls0 ws0">protected abstract Responder responderInstance();</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 lsd ws3fa">A comment like this can sometimes be useful, but it is better to use the name of the func-</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 ls0 ws21e">tion to con<span class="_ _4"></span>ve<span class="_ _4"></span>y the infor<span class="_ _8"></span>mation where possib<span class="_ _4"></span>le. F<span class="_ _4"></span>or example, in this case the comment</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws0">could be made redundant b<span class="_ _4"></span>y renaming the function: </div><div class="t m5 xd2 h2f y2ad ffb fs10 fc0 sc0 ls0 ws0">responderBeingTested</div><div class="t m0 xa7 h14 y2ad ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y5bc ff8 fs3 fc0 sc0 ls0 ws0">Here’<span class="_ _2"></span>s a case that’<span class="_ _2"></span>s a bit better:</div><div class="t m5 x8a h2f y6e4 ffb fs10 fc0 sc0 ls0 ws0">// format matched kk:mm:ss EEE, MMM dd, yyyy</div><div class="t m5 x8a h2f y6e5 ffb fs10 fc0 sc0 ls0 ws0">Pattern timeMatcher = Pattern.compile(</div><div class="t m5 x74 h2f y6e6 ffb fs10 fc0 sc0 ls19 ws237">       &quot;\\d*:\\d*:\\d* \\w*, \\w* \\d*, \\d*&quot;);</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls0 ws3fb">In this case the comment lets us kno<span class="_ _4"></span>w that the regular e<span class="_ _4"></span>xpression is intended to match a</div><div class="t m0 xd h14 y32e ff8 fs3 fc0 sc0 ls0 ws3fc">time and date that w<span class="_ _4"></span>ere for<span class="_ _8"></span>matted with the </div><div class="t m5 x1b h2f y32e ffb fs10 fc0 sc0 ls0 ws0">SimpleDateFormat.format</div><div class="t m0 x8b h14 y32e ff8 fs3 fc0 sc0 ls0 ws3fc">function using the</div><div class="t m0 xd h14 y6e7 ff8 fs3 fc0 sc0 ls0 ws3fd">speciﬁed format string. Still, it might hav<span class="_ _4"></span>e been better<span class="_ _4"></span>, and clearer, if this code had been</div><div class="t m0 xd h14 y32f ff8 fs3 fc0 sc0 ls0 ws3fe">mo<span class="_ _4"></span>ved to a special class that con<span class="_ _1"></span>verted the for<span class="_ _8"></span>mats of dates and times. <span class="_ _4"></span>Then the comment</div><div class="t m0 xd h14 y330 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ould likel<span class="_ _4"></span>y hav<span class="_ _4"></span>e been superﬂuous.</div><div class="t m0 xd h11 y6e8 ff1 fs7 fc0 sc0 ls0 ws0">Explanation of Intent</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 ls0 ws3ff">Sometimes a comment goes bey<span class="_ _4"></span>ond just useful infor<span class="_ _8"></span>mation about the implementation and</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws93">pro<span class="_ _4"></span>vides the intent behind a decision. In the follo<span class="_ _4"></span>wing case w<span class="_ _4"></span>e see an interesting decision</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 ls0 ws400">documented b<span class="_ _4"></span>y a comment. When comparing tw<span class="_ _1"></span>o objects, the author decided that he</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>anted to sor<span class="_ _8"></span>t objects of his class higher than objects of any other<span class="_ _1"></span>.</div><div class="t m5 x52 h2f y640 ffb fs10 fc0 sc0 ls0 ws0">public int compareTo(Object o)</div><div class="t m5 x52 h2f y641 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y642 ffb fs10 fc0 sc0 ls0 ws0">if(o instanceof WikiPagePath)</div><div class="t m5 x8a h2f y643 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y644 ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath p = (WikiPagePath) o;</div><div class="t m5 x6c h2f y645 ffb fs10 fc0 sc0 ls0 ws0">String compressedName = StringUtil.join(names, &quot;&quot;);</div><div class="t m5 x6c h2f y646 ffb fs10 fc0 sc0 ls42 ws0">String compressedArgumentName = StringUtil.join(p.names, &quot;&quot;);</div><div class="t m5 x6c h2f y647 ffb fs10 fc0 sc0 ls0 ws0">return compressedName.compareTo(compressedArgumentName);</div><div class="t m5 x8a h2f y6e9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y6ea ffb fs10 fc0 sc0 ls0 ws0">return 1; <span class="ffc">// we are greater because we are the right type.</span></div><div class="t m5 x52 h2f y6eb ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws401">Here’<span class="_ _2"></span>s an ev<span class="_ _4"></span>en better example. <span class="_ _0"></span>Y<span class="_ _3"></span>ou might not ag<span class="_ _8"></span>ree with the programmer’<span class="_ _2"></span>s solution to</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 lsd wsef">the problem, but at least y<span class="_ _4"></span>ou kno<span class="_ _4"></span>w what he w<span class="_ _4"></span>as tr<span class="_ _8"></span>ying to do.</div><div class="t m5 x52 h2f y6ec ffb fs10 fc0 sc0 ls0 ws0">public void testConcurrentAddWidgets() throws Exception {</div><div class="t m5 x8a h2f y6ed ffb fs10 fc0 sc0 ls0 ws0">WidgetBuilder widgetBuilder = </div><div class="t m5 x6c h2f y6ee ffb fs10 fc0 sc0 ls0 ws0">new WidgetBuilder(new Class[]{BoldWidget.class});</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:534.728010px;width:118.867000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:296.728010px;width:110.015000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf58" class="pf w1 h2" data-page-no="58"><div class="pc pc58 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">57<span class="_ _10"></span><span class="ff1">Good Comments</span></div><div class="t m5 x8a h2f y345 ffb fs10 fc0 sc0 ls0 ws0">String text = &quot;&apos;&apos;&apos;bold text&apos;&apos;&apos;&quot;;</div><div class="t m5 x8a h2f y627 ffb fs10 fc0 sc0 ls0 ws0">ParentWidget parent = </div><div class="t m5 x6c h2f y628 ffb fs10 fc0 sc0 ls0 ws0">new BoldWidget(new MockWidgetRoot(), &quot;&apos;&apos;&apos;bold text&apos;&apos;&apos;&quot;);</div><div class="t m5 x8a h2f y629 ffb fs10 fc0 sc0 ls0 ws0">AtomicBoolean failFlag = new AtomicBoolean();</div><div class="t m5 x8a h2f y62a ffb fs10 fc0 sc0 ls0 ws0">failFlag.set(false);</div><div class="t m5 x8a h46 y6ef ffc fs10 fc0 sc0 ls0 ws0">//This is our best attempt to get a race condition </div><div class="t m5 x8a h46 y6f0 ffc fs10 fc0 sc0 ls0 ws0">//by creating large number of threads.</div><div class="t m5 x8a h2f y6f1 ffb fs10 fc0 sc0 ls0 ws0">for (int i = 0; i &lt; 25000; i++) {</div><div class="t m5 x6c h2f y6f2 ffb fs10 fc0 sc0 ls0 ws0">WidgetBuilderThread widgetBuilderThread = </div><div class="t m5 x86 h2f y6f3 ffb fs10 fc0 sc0 ls0 ws0">new WidgetBuilderThread(widgetBuilder, text, parent, failFlag);</div><div class="t m5 x6c h2f y6f4 ffb fs10 fc0 sc0 ls0 ws0">Thread thread = new Thread(widgetBuilderThread);</div><div class="t m5 x6c h2f y6f5 ffb fs10 fc0 sc0 ls0 ws0">thread.start();</div><div class="t m5 x8a h2f y6f6 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y6f7 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(false, failFlag.get());</div><div class="t m5 x52 h2f y6f8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y6f9 ff1 fs7 fc0 sc0 ls0 ws0">Clariﬁcation</div><div class="t m0 xd h14 y6fa ff8 fs3 fc0 sc0 ls0 ws402">Sometimes it is just helpful to translate the meaning of some obscure argument or return</div><div class="t m0 xd h14 y6fb ff8 fs3 fc0 sc0 ls0 ws403">v<span class="_ _4"></span>alue into something that’<span class="_ _2"></span>s readable. In general it is better to ﬁnd a wa<span class="_ _1"></span>y to make that argu-</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 lsd ws404">ment or return value clear in its o<span class="_ _4"></span>wn right; but when its part of the standard library<span class="_ _1"></span>, or in</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls0 ws0">code that you cannot alter<span class="_ _1"></span>, then a helpful clarifying comment can be useful.</div><div class="t m5 x52 h2f y6fc ffb fs10 fc0 sc0 ls0 ws0">public void testCompareTo() throws Exception</div><div class="t m5 x52 h2f y6fd ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y6fe ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath a = PathParser.parse(&quot;PageA&quot;);</div><div class="t m5 x8a h2f y6ff ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath ab = PathParser.parse(&quot;PageA.PageB&quot;);</div><div class="t m5 x8a h2f y700 ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath b = PathParser.parse(&quot;PageB&quot;);</div><div class="t m5 x8a h2f y701 ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath aa = PathParser.parse(&quot;PageA.PageA&quot;);</div><div class="t m5 x8a h2f y702 ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath bb = PathParser.parse(&quot;PageB.PageB&quot;);</div><div class="t m5 x8a h2f y703 ffb fs10 fc0 sc0 ls0 ws0">WikiPagePath ba = PathParser.parse(&quot;PageB.PageA&quot;);</div><div class="t m5 x8a h2f y704 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(a.compareTo(a) == 0);    // a == a</div><div class="t m5 x8a h2f y705 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(a.compareTo(b) != 0);    // a != b</div><div class="t m5 x8a h2f y706 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(ab.compareTo(ab) == 0);  // ab == ab</div><div class="t m5 x8a h2f y707 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(a.compareTo(b) == -1);   // a &lt; b</div><div class="t m5 x8a h2f y708 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(aa.compareTo(ab) == -1); // aa &lt; ab</div><div class="t m5 x8a h2f y709 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(ba.compareTo(bb) == -1); // ba &lt; bb</div><div class="t m5 x8a h2f y70a ffb fs10 fc0 sc0 ls0 ws0">assertTrue(b.compareTo(a) == 1);    // b &gt; a</div><div class="t m5 x8a h2f y70b ffb fs10 fc0 sc0 ls0 ws0">assertTrue(ab.compareTo(aa) == 1);  // ab &gt; aa</div><div class="t m5 x8a h2f y70c ffb fs10 fc0 sc0 ls0 ws0">assertTrue(bb.compareTo(ba) == 1);  // bb &gt; ba</div><div class="t m5 x52 h2f y70d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y70e ff8 fs3 fc0 sc0 ls0 ws185">There is a substantial risk, of course, that a clarifying comment is incor<span class="_ _8"></span>rect. Go</div><div class="t m0 xd h14 y70f ff8 fs3 fc0 sc0 ls0 ws22">through the pre<span class="_ _4"></span>vious example and see ho<span class="_ _4"></span>w difﬁcult it is to v<span class="_ _4"></span>erify that they are cor<span class="_ _8"></span>rect. <span class="_ _1"></span>This</div><div class="t m0 xd h14 y710 ff8 fs3 fc0 sc0 ls0 ws405">explains both w<span class="_ _4"></span>hy the clariﬁcation is necessary and wh<span class="_ _1"></span>y it’<span class="_ _2"></span>s risky<span class="_ _1"></span>. So before writing com-</div><div class="t m0 xd h14 y711 ff8 fs3 fc0 sc0 ls0 ws406">ments like this, take care that there is no better w<span class="_ _4"></span>a<span class="_ _4"></span>y<span class="_ _0"></span>, and then take ev<span class="_ _4"></span>en more care that they</div><div class="t m0 xd h14 y712 ff8 fs3 fc0 sc0 ls0 ws0">are accurate.</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:426.728010px;width:64.667000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf59" class="pf w1 h2" data-page-no="59"><div class="pc pc59 w1 h2"><img class="bi x23 y713 wf h47" alt="" src="bg59.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">58<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">W<span class="_ _2"></span>arning of Consequences</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws407">Sometimes it is useful to w<span class="_ _4"></span>ar<span class="_ _8"></span>n other pro-</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws408">grammers about cer<span class="_ _8"></span>tain consequences. F<span class="_ _4"></span>or</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws409">example, here is a comment that e<span class="_ _4"></span>xplains</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws0">wh<span class="_ _1"></span>y a par<span class="_ _8"></span>ticular test case is tur<span class="_ _8"></span>ned off:</div><div class="t m5 x52 h46 y714 ffc fs10 fc0 sc0 ls0 ws0">// Don&apos;t run unless you </div><div class="t m5 x52 h46 y715 ffc fs10 fc0 sc0 ls43 ws0">//<span class="_ _23"> </span>have some time to kill.</div><div class="t m5 x52 h2f y716 ffb fs10 fc0 sc0 ls0 ws0">public void _testWithReallyBigFile()</div><div class="t m5 x52 h2f y717 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y718 ffb fs10 fc0 sc0 ls0 ws0">writeLinesToFile(10000000);</div><div class="t m5 x8a h2f y719 ffb fs10 fc0 sc0 ls0 ws0">response.setBody(testFile);</div><div class="t m5 x8a h2f y71a ffb fs10 fc0 sc0 ls0 ws0">response.readyToSend(this);</div><div class="t m5 x8a h2f y71b ffb fs10 fc0 sc0 ls0 ws0">String responseString = output.toString();</div><div class="t m5 x8a h2f y71c ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;Content-Length: 1000000000&quot;, responseString);</div><div class="t m5 x8a h2f y71d ffb fs10 fc0 sc0 ls0 ws0">assertTrue(bytesSent &gt; 1000000000);</div><div class="t m5 x52 h2f y71e ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y6fb ff8 fs3 fc0 sc0 ls11 ws53">No<span class="_ _4"></span>wada<span class="_ _1"></span>ys, of course, we’<span class="_ _3"></span>d tur<span class="_ _8"></span>n off the test case b<span class="_ _4"></span>y using the </div><div class="t m5 x49 h2f y6fb ffb fs10 fc0 sc0 ls0 ws0">@Ignore</div><div class="t m0 x4a h14 y6fb ff8 fs3 fc0 sc0 ls44 ws201"> attribute with an</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 ls0 ws2ea">appropriate explanatory string. </div><div class="t m5 xa2 h2f y32c ffb fs10 fc0 sc0 ls0 ws40a">@Ignore(&quot;Takes too long to run&quot;)</div><div class="t m0 x82 h14 y32c ff8 fs3 fc0 sc0 ls0 ws2ea">. But back in the da<span class="_ _4"></span>ys</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls0 ws151">before JUnit 4, putting an underscore in front of the method name w<span class="_ _4"></span>as a common conv<span class="_ _4"></span>en-</div><div class="t m0 xd h14 y32e ff8 fs3 fc0 sc0 ls0 ws0">tion. <span class="_ _1"></span>The comment, while ﬂippant, makes the point pretty w<span class="_ _4"></span>ell. </div><div class="t m0 x74 h14 y51d ff8 fs3 fc0 sc0 ls0 ws0">Here’<span class="_ _2"></span>s another<span class="_ _4"></span>, more poignant example: </div><div class="t m5 x52 h2f y71f ffb fs10 fc0 sc0 ls0 ws0">public static SimpleDateFormat makeStandardHttpDateFormat()</div><div class="t m5 x52 h2f y720 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h46 y721 ffc fs10 fc0 sc0 ls0 ws0">//SimpleDateFormat is not thread safe, </div><div class="t m5 x8a h46 y722 ffc fs10 fc0 sc0 ls0 ws0">//so we need to create each instance independently.</div><div class="t m5 x8a h2f y723 ffb fs10 fc0 sc0 ls45 ws0">SimpleDateFormat df = new SimpleDateFormat(&quot;EEE, dd MMM  yyyy HH:mm:ss z&quot;);</div><div class="t m5 x8a h2f y724 ffb fs10 fc0 sc0 ls0 ws0">df.setTimeZone(TimeZone.getTimeZone(&quot;GMT&quot;));</div><div class="t m5 x8a h2f y725 ffb fs10 fc0 sc0 ls0 ws0">return df;</div><div class="t m5 x52 h2f y726 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y5a0 ff8 fs3 fc0 sc0 ls0 ws7f">Y<span class="_ _3"></span>ou might complain that there are better wa<span class="_ _4"></span>ys to solve this prob<span class="_ _4"></span>lem. I might ag<span class="_ _8"></span>ree with</div><div class="t m0 xd h14 y5a1 ff8 fs3 fc0 sc0 ls0 wsee">you. But the comment, as gi<span class="_ _4"></span>ven here, is perfectl<span class="_ _4"></span>y reasonable. It will pre<span class="_ _4"></span>vent some o<span class="_ _1"></span>verly</div><div class="t m0 xd h14 y5a2 ff8 fs3 fc0 sc0 ls0 ws0">eager programmer from using a static initializer in the name of ef<span class="_ _4"></span>ﬁciency<span class="_ _0"></span>. </div><div class="t m0 xd h11 y727 ff1 fs7 fc0 sc0 ls0 ws0">TODO Comments</div><div class="t m0 xd h14 y584 ff8 fs3 fc0 sc0 ls0 ws40b">It is sometimes reasonable to lea<span class="_ _1"></span>ve “T<span class="_ _0"></span>o do” notes in the for<span class="_ _8"></span>m of </div><div class="t m5 x49 h2f y584 ffb fs10 fc0 sc0 ls0 ws0">//TODO</div><div class="t m0 xaf h14 y584 ff8 fs3 fc0 sc0 ls0 ws40b">comments. In the</div><div class="t m0 xd h14 y585 ff8 fs3 fc0 sc0 ls0 ws341">follo<span class="_ _4"></span>wing case, the </div><div class="t m5 x4d h2f y585 ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x6e h14 y585 ff8 fs3 fc0 sc0 ls0 ws341">comment explains w<span class="_ _4"></span>hy the function has a de<span class="_ _4"></span>generate implementa-</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws0">tion and what that function’<span class="_ _3"></span>s future should be. </div><div class="t m5 x52 h46 y728 ffc fs10 fc0 sc0 ls0 ws0">//TODO-MdM these are not needed</div><div class="t m5 x52 h46 y729 ffc fs10 fc0 sc0 ls0 ws0">// We expect this to go away when we do the checkout model</div><div class="t m5 x52 h2f y72a ffb fs10 fc0 sc0 ls0 ws0">protected VersionInfo makeVersion() throws Exception</div><div class="t m5 x52 h2f y72b ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y72c ffb fs10 fc0 sc0 ls0 ws0">return null;</div><div class="t m5 x52 h2f y72d ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:132.626000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:197.728010px;width:93.445000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5a" class="pf w1 h2" data-page-no="5a"><div class="pc pc5a w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">59<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m5 x74 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x9a h14 y194 ff8 fs3 fc0 sc0 ls46 ws40c">s are jobs that the pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer thinks should be done, but for some reason</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls46 ws40d">can’<span class="_ _1"></span>t do at the moment. It might be a reminder to delete a deprecated feature or a</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls46 ws2a2">plea for someone else to look at a problem. It might be a request for someone else to</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls46 ws40e">think of a better name or a reminder to make a change that is dependent on a</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls46 ws40f">planned e<span class="_ _4"></span>vent. <span class="_ _4"></span>Whatever else a </div><div class="t m5 x8 h2f y198 ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x31 h14 y198 ff8 fs3 fc0 sc0 ls47 ws40f">might be, it is <span class="ffa ws0">not<span class="_ _e"> </span></span>an excuse to lea<span class="_ _4"></span>ve bad code in</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls47 ws0">the system.</div><div class="t m0 x74 h14 y19a ff8 fs3 fc0 sc0 ls34 ws410">No<span class="_ _4"></span>wada<span class="_ _1"></span>ys, most good IDEs pro<span class="_ _4"></span>vide special gestures and features to locate all the</div><div class="t m5 xd h2f y19b ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x8e h14 y19b ff8 fs3 fc0 sc0 ls34 ws134">comments, so it’<span class="_ _2"></span>s not likel<span class="_ _4"></span>y that they will get lost. Still, you don’<span class="_ _1"></span>t w<span class="_ _4"></span>ant your code</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls34 ws411">to be littered with </div><div class="t m5 xd6 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x6e h14 y19c ff8 fs3 fc0 sc0 ls34 ws411">s. So scan through them regularl<span class="_ _4"></span>y and eliminate the ones you</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls34 ws0">can.</div><div class="t m0 xd h11 y72e ff1 fs7 fc0 sc0 ls0 ws0">Ampliﬁcation</div><div class="t m0 xd h14 y72f ff8 fs3 fc0 sc0 ls0 ws412">A comment ma<span class="_ _4"></span>y be used to amplify the impor<span class="_ _8"></span>tance of something that ma<span class="_ _4"></span>y otherwise seem</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls0 ws0">inconsequential.</div><div class="t m5 x86 h2f y731 ffb fs10 fc0 sc0 ls0 ws0">String listItemContent = match.group(3).trim();</div><div class="t m5 x86 h46 y732 ffc fs10 fc0 sc0 ls0 ws0">// the trim is real important.  It removes the starting </div><div class="t m5 x86 h46 y733 ffc fs10 fc0 sc0 ls0 ws0">// spaces that could cause the item to be recognized</div><div class="t m5 x86 h46 y734 ffc fs10 fc0 sc0 ls0 ws0">// as another list.</div><div class="t m5 x86 h2f y735 ffb fs10 fc0 sc0 ls0 ws0">new ListItemWidget(this, listItemContent, this.level + 1);</div><div class="t m5 x86 h2f y736 ffb fs10 fc0 sc0 ls0 ws0">return buildList(text.substring(match.end()));</div><div class="t m0 xd h11 y737 ff1 fs7 fc0 sc0 ls0 ws0">Ja<span class="_ _0"></span>vadocs in Pub<span class="_ _4"></span>lic <span class="_ _0"></span>APIs</div><div class="t m0 xd h14 y48b ff8 fs3 fc0 sc0 ls0 ws413">There is nothing quite so helpful and satisfying as a w<span class="_ _4"></span>ell-described public <span class="_ _1"></span>API. <span class="_ _4"></span>The ja<span class="_ _4"></span>va-</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws266">docs for the standard Ja<span class="_ _4"></span>va library are a case in point. It w<span class="_ _4"></span>ould be difﬁcult, at best, to write</div><div class="t m0 xd h14 y48d ff8 fs3 fc0 sc0 ls0 ws0">Ja<span class="_ _4"></span>va pro<span class="_ _4"></span>grams without them. </div><div class="t m0 x74 h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws414">If you are writing a pub<span class="_ _4"></span>lic <span class="_ _1"></span>API, then you should certainly write good ja<span class="_ _4"></span>vadocs for it.</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 ls0 ws415">But keep in mind the rest of the advice in this chapter<span class="_ _1"></span>. Ja<span class="_ _4"></span>vadocs can be just as misleading,</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws0">nonlocal, and dishonest as an<span class="_ _4"></span>y other kind of comment.</div><div class="t m0 xd h17 y738 ff1 fs9 fc0 sc0 ls0 ws0">Bad Comments</div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 ls0 ws416">Most comments fall into this category<span class="_ _1"></span>. Usually the<span class="_ _4"></span>y are cr<span class="_ _8"></span>utches or excuses for poor code</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 ls0 ws2c4">or justiﬁcations for insuf<span class="_ _4"></span>ﬁcient decisions, amounting to little more than the programmer</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws0">talking to himself.</div><div class="t m0 xd h11 y73b ff1 fs7 fc0 sc0 ls0 ws0">Mumbling</div><div class="t m0 xd h14 y73c ff8 fs3 fc0 sc0 ls0 wscd">Plopping in a comment just because you feel y<span class="_ _4"></span>ou should or because the process requires it,</div><div class="t m0 xd h14 y3cb ff8 fs3 fc0 sc0 ls0 ws394">is a hack. If you decide to write a comment, then spend the time necessary to make sure it</div><div class="t m0 xd h14 y73d ff8 fs3 fc0 sc0 ls0 ws0">is the best comment you can write. </div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:444.728010px;width:70.007000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:323.728010px;width:121.293000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:204.945010px;width:92.161000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:129.728010px;width:53.775000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5b" class="pf w1 h2" data-page-no="5b"><div class="pc pc5b w1 h2"><img class="bi xd y73e wc h48" alt="" src="bg5b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">60<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws417">Here, for example, is a case I found in F<span class="_ _4"></span>itNesse, where a comment might indeed ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 wsb4">been useful. But the author w<span class="_ _4"></span>as in a hur<span class="_ _8"></span>r<span class="_ _8"></span>y or just not paying much attention. His mum-</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">bling left behind an enigma:</div><div class="t m5 x52 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">public void loadProperties()</div><div class="t m5 x52 h2f y404 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y405 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m5 x8a h2f y406 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y407 ffb fs10 fc0 sc0 ls14 ws236">      String propertiesPath = propertiesLocation + &quot;/&quot; + PROPERTIES_FILE;</div><div class="t m5 x74 h2f y73f ffb fs10 fc0 sc0 ls18 ws237">      FileInputStream propertiesStream = new FileInputStream(propertiesPath);</div><div class="t m5 x74 h2f y740 ffb fs10 fc0 sc0 ls1f ws3b8">      loadedProperties.load(propertiesStream);</div><div class="t m5 x8a h2f y741 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y742 ffb fs10 fc0 sc0 ls0 ws0">catch(IOException e)</div><div class="t m5 x8a h2f y743 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h46 y744 ffc fs10 fc0 sc0 ls0 ws0">// No properties files means all defaults are loaded</div><div class="t m5 x8a h2f y745 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y746 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y747 ff8 fs3 fc0 sc0 ls0 ws418">What does that comment in the </div><div class="t m5 x43 h2f y747 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xc4 h14 y747 ff8 fs3 fc0 sc0 ls0 ws418">block mean? Clearl<span class="_ _4"></span>y it meant something to the</div><div class="t m0 xd h14 y748 ff8 fs3 fc0 sc0 lsd ws419">author<span class="_ _4"></span>, but the meaning does not come through all that w<span class="_ _4"></span>ell. <span class="_ _4"></span>Apparently<span class="_ _0"></span>, if w<span class="_ _4"></span>e get an</div><div class="t m5 xd h2f y3d5 ffb fs10 fc0 sc0 ls0 ws0">IOException</div><div class="t m0 x4c h14 y3d5 ff8 fs3 fc0 sc0 ls0 wsa0">, it means that there w<span class="_ _4"></span>as no proper<span class="_ _8"></span>ties ﬁle; and in that case all the defaults are</div><div class="t m0 xd h14 y3d6 ff8 fs3 fc0 sc0 ls0 ws41a">loaded. But who loads all the defaults? <span class="_ _4"></span>W<span class="_ _0"></span>ere they loaded before the call to</div><div class="t m5 xd h2f y3d7 ffb fs10 fc0 sc0 ls0 ws0">loadProperties.load</div><div class="t m0 x7b h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws41b">? Or did </div><div class="t m5 xcc h2f y3d7 ffb fs10 fc0 sc0 ls0 ws0">loadProperties.load</div><div class="t m0 x54 h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws41b">catch the exception, load the defaults,</div><div class="t m0 xd h14 y749 ff8 fs3 fc0 sc0 ls0 ws363">and then pass the exception on for us to ignore? Or did </div><div class="t m5 x89 h2f y749 ffb fs10 fc0 sc0 ls0 ws0">loadProperties.load</div><div class="t m0 x98 h14 y749 ff8 fs3 fc0 sc0 ls0 ws363">load all the</div><div class="t m0 xd h14 y74a ff8 fs3 fc0 sc0 ls0 ws41c">defaults before attempting to load the ﬁle? W<span class="_ _0"></span>as the author trying to comfor<span class="_ _8"></span>t himself about</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws41d">the fact that he was lea<span class="_ _1"></span>ving the </div><div class="t m5 x84 h2f y74b ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x43 h14 y74b ff8 fs3 fc0 sc0 ls0 ws41d"> block empty? Or—and this is the scary possibility—</div><div class="t m0 xd h14 y74c ff8 fs3 fc0 sc0 ls0 ws2af">w<span class="_ _4"></span>as the author tr<span class="_ _8"></span>ying to tell himself to come back here later and write the code that w<span class="_ _4"></span>ould</div><div class="t m0 xd h14 y74d ff8 fs3 fc0 sc0 ls0 ws0">load the defaults?</div><div class="t m0 x74 h14 y57c ff8 fs3 fc0 sc0 ls0 ws40f">Our onl<span class="_ _4"></span>y recourse is to examine the code in other parts of the system to ﬁnd out what’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y74e ff8 fs3 fc0 sc0 ls0 ws1a">going on. <span class="_ _1"></span>Any comment that forces y<span class="_ _4"></span>ou to look in another module for the meaning of that</div><div class="t m0 xd h14 y74f ff8 fs3 fc0 sc0 ls0 ws0">comment has failed to communicate to you and is not w<span class="_ _1"></span>or<span class="_ _8"></span>th the bits it consumes. </div><div class="t m0 xd h11 y750 ff1 fs7 fc0 sc0 ls0 ws0">Redundant Comments</div><div class="t m0 xd h14 y2f8 ff8 fs3 fc0 sc0 ls0 wsf4">Listing 4-1 sho<span class="_ _4"></span>ws a simple function with a header comment that is completely redundant.</div><div class="t m0 xd h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws0">The comment probabl<span class="_ _4"></span>y takes longer to read than the code itself.</div><div class="t m0 x74 h1c y751 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-1 </div><div class="t m0 x74 h36 y2fc ffc fs3 fc0 sc0 ls0 ws0">waitForClose</div><div class="t m5 x52 h46 y752 ffc fs10 fc0 sc0 ls0 ws0">// Utility method that returns when this.closed is true. Throws an exception</div><div class="t m5 x52 h46 y753 ffc fs10 fc0 sc0 ls0 ws0">// if the timeout is reached.</div><div class="t m5 x52 h2f y754 ffb fs10 fc0 sc0 ls0 ws0">public synchronized void waitForClose(final long timeoutMillis) </div><div class="t m5 x74 h2f y755 ffb fs10 fc0 sc0 ls19 ws237">  throws Exception</div><div class="t m5 x52 h2f y33e ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y756 ffb fs10 fc0 sc0 ls0 ws0">if(!closed)</div><div class="t m5 x8a h2f y757 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y758 ffb fs10 fc0 sc0 ls0 ws0">wait(timeoutMillis);</div><div class="t m5 x6c h2f y759 ffb fs10 fc0 sc0 ls0 ws0">if(!closed)</div><div class="t m5 x86 h2f y75a ffb fs10 fc0 sc0 ls0 ws0">throw new Exception(&quot;MockResponseSender could not be closed&quot;);</div><div class="t m5 x8a h2f y75b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y75c ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:246.728010px;width:115.667000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5c" class="pf w1 h2" data-page-no="5c"><div class="pc pc5c w1 h2"><img class="bi xd y75d wc h49" alt="" src="bg5c.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">61<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws41e">What pur<span class="_ _8"></span>pose does this comment serve? It’<span class="_ _2"></span>s cer<span class="_ _8"></span>tainly not more informati<span class="_ _4"></span>ve than the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws3eb">code. It does not justify the code, or pro<span class="_ _4"></span>vide intent or rationale. It is not easier to read than</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws10e">the code. Indeed<span class="_ _1"></span>, it is less precise than the code and entices the reader to accept that lack of</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws41f">precision in lieu of true understanding. It is rather like a gladhanding used-car salesman</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">assuring you that y<span class="_ _4"></span>ou don’<span class="_ _4"></span>t need to look under the hood.</div><div class="t m0 x74 h14 y1be ff8 fs3 fc0 sc0 ls0 ws420">No<span class="_ _4"></span>w consider the legion of useless and redundant ja<span class="_ _4"></span>v<span class="_ _4"></span>adocs in Listing 4-2 taken from</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws421">T<span class="_ _0"></span>omcat. <span class="_ _4"></span>These comments ser<span class="_ _8"></span>ve onl<span class="_ _4"></span>y to clutter and obscure the code. <span class="_ _4"></span>They serve no docu-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws422">mentary pur<span class="_ _8"></span>pose at all. <span class="_ _4"></span>T<span class="_ _1"></span>o make matters w<span class="_ _4"></span>orse, I only sho<span class="_ _1"></span>wed y<span class="_ _4"></span>ou the ﬁrst few<span class="_ _0"></span>. <span class="_ _1"></span>There are</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">many more in this module.</div><div class="t m0 x74 h1c y75e ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-2 </div><div class="t m0 x74 h36 y19f ffc fs3 fc0 sc0 ls0 ws0">ContainerBase.java (Tomcat)</div><div class="t m5 x74 h2f y75f ffb fs10 fc0 sc0 ls0 ws0">public abstract class ContainerBase</div><div class="t m5 x74 h2f y760 ffb fs10 fc0 sc0 ls0 ws0">  implements Container, Lifecycle, Pipeline, </div><div class="t m5 x74 h2f y761 ffb fs10 fc0 sc0 ls14 ws237">  MBeanRegistration, Serializable {</div><div class="t m5 x74 h2f y762 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y763 ffb fs10 fc0 sc0 ls0 ws0">   * The processor delay for this component.</div><div class="t m5 x74 h2f y764 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y765 ffb fs10 fc0 sc0 ls0 ws0">  protected int backgroundProcessorDelay = -1;</div><div class="t m5 x74 h2f y766 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y767 ffb fs10 fc0 sc0 ls0 ws0">   * The lifecycle event support for this component.</div><div class="t m5 x74 h2f y768 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y769 ffb fs10 fc0 sc0 ls0 ws0">  protected LifecycleSupport lifecycle = </div><div class="t m5 x74 h2f y76a ffb fs10 fc0 sc0 ls19 ws2f1">    new LifecycleSupport(this);</div><div class="t m5 x74 h2f y76b ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y76c ffb fs10 fc0 sc0 ls0 ws0">   * The container event listeners for this Container.</div><div class="t m5 x74 h2f y76d ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y76e ffb fs10 fc0 sc0 ls0 ws0">  protected ArrayList listeners = new ArrayList();</div><div class="t m5 x74 h2f y76f ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y770 ffb fs10 fc0 sc0 ls0 ws0">   * The Loader implementation with which this Container is</div><div class="t m5 x74 h2f y771 ffb fs10 fc0 sc0 ls20 ws3b9">   * associated.</div><div class="t m5 x74 h2f y772 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y773 ffb fs10 fc0 sc0 ls0 ws0">  protected Loader loader = null;</div><div class="t m5 x74 h2f y774 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y775 ffb fs10 fc0 sc0 ls0 ws423">   * The Logger implementation with which this Container is  <span class="_ _0"></span>  </div><div class="t m5 x74 h2f y776 ffb fs10 fc0 sc0 ls20 ws3b9">   * associated.</div><div class="t m5 x74 h2f y777 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y778 ffb fs10 fc0 sc0 ls0 ws0">  protected Log logger = null;</div><div class="t m5 x74 h2f y779 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y77a ffb fs10 fc0 sc0 ls0 ws0">   * Associated logger name.</div><div class="t m5 x74 h2f y77b ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y77c ffb fs10 fc0 sc0 ls0 ws0">  protected String logName = null;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5d" class="pf w1 h2" data-page-no="5d"><div class="pc pc5d w1 h2"><img class="bi xd y77d wc h4a" alt="" src="bg5d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">62<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">   * The Manager implementation with which this Container is </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls20 ws3b9">   * associated.</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  protected Manager manager = null;</div><div class="t m5 x74 h2f y77e ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y77f ffb fs10 fc0 sc0 ls0 ws0">   * The cluster with which this Container is associated.</div><div class="t m5 x74 h2f y780 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y781 ffb fs10 fc0 sc0 ls0 ws0">  protected Cluster cluster = null;</div><div class="t m5 x74 h2f y782 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y783 ffb fs10 fc0 sc0 ls0 ws0">   * The human-readable name of this Container.</div><div class="t m5 x74 h2f y784 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y785 ffb fs10 fc0 sc0 ls0 ws0">  protected String name = null;</div><div class="t m5 x74 h2f y786 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y787 ffb fs10 fc0 sc0 ls0 ws0">   * The parent Container to which this Container is a child.</div><div class="t m5 x74 h2f y788 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y789 ffb fs10 fc0 sc0 ls0 ws0">  protected Container parent = null;</div><div class="t m5 x74 h2f y78a ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y78b ffb fs10 fc0 sc0 ls0 ws0">   * The parent class loader to be configured when we install a </div><div class="t m5 x74 h2f y78c ffb fs10 fc0 sc0 ls3c ws3b8">   * Loader.</div><div class="t m5 x74 h2f y78d ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y78e ffb fs10 fc0 sc0 ls0 ws0">  protected ClassLoader parentClassLoader = null;</div><div class="t m5 x74 h2f y78f ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y790 ffb fs10 fc0 sc0 ls0 ws0">   * The Pipeline object with which this Container is </div><div class="t m5 x74 h2f y791 ffb fs10 fc0 sc0 ls20 ws3b9">   * associated.</div><div class="t m5 x74 h2f y792 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y793 ffb fs10 fc0 sc0 ls0 ws0">  protected Pipeline pipeline = new StandardPipeline(this);</div><div class="t m5 x74 h2f y794 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y795 ffb fs10 fc0 sc0 ls0 ws0">   * The Realm with which this Container is associated.</div><div class="t m5 x74 h2f y796 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y797 ffb fs10 fc0 sc0 ls0 ws0">  protected Realm realm = null;</div><div class="t m5 x74 h2f y798 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y799 ffb fs10 fc0 sc0 ls0 ws0">   * The resources DirContext object with which this Container </div><div class="t m5 x74 h2f y79a ffb fs10 fc0 sc0 ls1f ws3b8">   * is associated.</div><div class="t m5 x74 h2f y79b ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y79c ffb fs10 fc0 sc0 ls0 ws0">  protected DirContext resources = null;</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-2 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ContainerBase.java (Tomcat)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5e" class="pf w1 h2" data-page-no="5e"><div class="pc pc5e w1 h2"><img class="bi xd y3b0 wc h4b" alt="" src="bg5e.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">63<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Misleading Comments</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws168">Sometimes, with all the best intentions, a programmer makes a statement in his comments</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws336">that isn’<span class="_ _1"></span>t precise enough to be accurate. Consider for another moment the badly redundant</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 lsd wsef">but also subtl<span class="_ _4"></span>y misleading comment we sa<span class="_ _1"></span>w in Listing 4-1.</div><div class="t m0 x74 h14 y79d ff8 fs3 fc0 sc0 ls0 ws424">Did you disco<span class="_ _1"></span>ver ho<span class="_ _4"></span>w the comment w<span class="_ _4"></span>as misleading? <span class="_ _4"></span>The method does not retur<span class="_ _8"></span>n</div><div class="t m0 xd h1d y79e ffa fs3 fc0 sc0 ls0 ws0">when</div><div class="t m5 xd7 h2f y79e ffb fs10 fc0 sc0 ls0 ws0">this.closed</div><div class="t m0 x18 h14 y79e ff8 fs3 fc0 sc0 ls0 ws0">becomes</div><div class="t m5 x2f h2f y79e ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 x1c h14 y79e ff8 fs3 fc0 sc0 ls0 ws20">. It returns <span class="ffa ws0">if</span></div><div class="t m5 x1b h2f y79e ffb fs10 fc0 sc0 ls0 ws0">this.closed</div><div class="t m0 xa1 h14 y79e ff8 fs3 fc0 sc0 ls0 ws0">is</div><div class="t m5 xc9 h2f y79e ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 xa0 h14 y79e ff8 fs3 fc0 sc0 ls0 ws20">; otherwise, it w<span class="_ _4"></span>aits for a</div><div class="t m0 xd h14 y2a8 ff8 fs3 fc0 sc0 ls0 ws0">blind time-out and then thro<span class="_ _1"></span>ws an exception <span class="ffa">if</span></div><div class="t m5 x66 h2f y2a8 ffb fs10 fc0 sc0 ls0 ws0">this.closed</div><div class="t m0 xae h14 y2a8 ff8 fs3 fc0 sc0 ls0 ws0"> is still not </div><div class="t m5 x97 h2f y2a8 ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 xa7 h14 y2a8 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y5db ff8 fs3 fc0 sc0 ls0 ws251">This subtle bit of misinformation, couched in a comment that is harder to read than</div><div class="t m0 xd h14 y5dc ff8 fs3 fc0 sc0 ls0 ws425">the body of the code, could cause another pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer to blithel<span class="_ _4"></span>y call this function in the</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls0 ws426">expectation that it will return as soon as </div><div class="t m5 x83 h2f y5dd ffb fs10 fc0 sc0 ls0 ws0">this.closed</div><div class="t m0 xd2 h14 y5dd ff8 fs3 fc0 sc0 ls0 ws0">becomes</div><div class="t m5 x62 h2f y5dd ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 xb5 h14 y5dd ff8 fs3 fc0 sc0 ls0 ws426">. <span class="_ _1"></span>That poor programmer</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 lsd ws427">w<span class="_ _4"></span>ould then ﬁnd himself in a debugging session trying to ﬁgure out wh<span class="_ _4"></span>y his code ex<span class="_ _4"></span>ecuted</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws0">so slo<span class="_ _4"></span>wly<span class="_ _0"></span>.</div><div class="t m0 xd h11 y79f ff1 fs7 fc0 sc0 ls0 ws0">Mandated Comments</div><div class="t m0 xd h14 y7a0 ff8 fs3 fc0 sc0 ls0 ws428">It is just plain sill<span class="_ _4"></span>y to hav<span class="_ _4"></span>e a r<span class="_ _8"></span>ule that sa<span class="_ _4"></span>ys that every function must ha<span class="_ _4"></span>ve a ja<span class="_ _4"></span>v<span class="_ _4"></span>adoc, or</div><div class="t m0 xd h14 y7a1 ff8 fs3 fc0 sc0 ls0 ws2e9">e<span class="_ _4"></span>very variable must ha<span class="_ _1"></span>ve a comment. Comments like this just clutter up the code, propa-</div><div class="t m0 xd h14 y485 ff8 fs3 fc0 sc0 ls22 ws429">gate lies, and lend to general confusion and disorganization. </div><div class="t m0 x74 h14 y7a2 ff8 fs3 fc0 sc0 ls0 ws206">F<span class="_ _1"></span>or example, required ja<span class="_ _4"></span>vadocs for e<span class="_ _4"></span>very function lead to abominations such as List-</div><div class="t m0 xd h14 y7a3 ff8 fs3 fc0 sc0 ls0 ws42a">ing 4-3. <span class="_ _1"></span>This clutter adds nothing and ser<span class="_ _8"></span>ves only to obfuscate the code and create the</div><div class="t m0 xd h14 y7a4 ff8 fs3 fc0 sc0 ls0 ws0">potential for lies and misdirection.</div><div class="t m0 xd h11 y73b ff1 fs7 fc0 sc0 ls0 ws0">Jour<span class="_ _4"></span>nal Comments</div><div class="t m0 xd h14 y73c ff8 fs3 fc0 sc0 ls0 ws42b">Sometimes people add a comment to the start of a module every time they edit it. <span class="_ _1"></span>These</div><div class="t m0 xd h14 y3cb ff8 fs3 fc0 sc0 ls0 ws42c">comments accumulate as a kind of journal, or log, of e<span class="_ _4"></span>very change that has ever been</div><div class="t m0 xd h14 y73d ff8 fs3 fc0 sc0 ls0 ws0">made. I ha<span class="_ _4"></span>ve seen some modules with dozens of pages of these run-on jour<span class="_ _8"></span>nal entries. </div><div class="t m0 x74 h1c y7a5 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-3 </div><div class="t m5 x74 h2f y7a6 ffb fs10 fc0 sc0 ls1b ws236">  /**</div><div class="t m5 x74 h2f y7a7 ffb fs10 fc0 sc0 ls0 ws0">   * </div><div class="t m5 x74 h2f y7a8 ffb fs10 fc0 sc0 ls0 ws0">   * @param title The title of the CD</div><div class="t m5 x74 h2f y7a9 ffb fs10 fc0 sc0 ls0 ws0">   * @param author The author of the CD</div><div class="t m5 x74 h2f y7aa ffb fs10 fc0 sc0 ls0 ws0">   * @param tracks The number of tracks on the CD</div><div class="t m5 x74 h2f y7ab ffb fs10 fc0 sc0 ls0 ws0">   * @param durationInMinutes The duration of the CD in minutes</div><div class="t m5 x74 h2f y7ac ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y7ad ffb fs10 fc0 sc0 ls0 ws0">  public void addCD(String title, String author, </div><div class="t m5 x74 h2f y7ae ffb fs10 fc0 sc0 ls3c ws235">                     int tracks, int durationInMinutes) {</div><div class="t m5 x74 h2f y7af ffb fs10 fc0 sc0 ls0 ws0">    CD cd = new CD();</div><div class="t m5 x74 h2f y7b0 ffb fs10 fc0 sc0 ls0 ws0">    cd.title = title;</div><div class="t m5 x74 h2f y7b1 ffb fs10 fc0 sc0 ls0 ws0">    cd.author = author;</div><div class="t m5 x74 h2f y7b2 ffb fs10 fc0 sc0 ls0 ws0">    cd.tracks = tracks;</div><div class="t m5 x74 h2f y7b3 ffb fs10 fc0 sc0 ls0 ws0">    cd.duration = duration;</div><div class="t m5 x74 h2f y7b4 ffb fs10 fc0 sc0 ls0 ws0">    cdList.add(cd);</div><div class="t m5 x74 h2f y7b5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:410.728010px;width:110.987000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:114.995000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:129.728010px;width:97.969000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf5f" class="pf w1 h2" data-page-no="5f"><div class="pc pc5f w1 h2"><img class="bi xd y7b6 wc h4c" alt="" src="bg5f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">64<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 x74 h14 y6fb ff8 fs3 fc0 sc0 ls0 ws42d">Long ago there w<span class="_ _4"></span>as a good reason to create and maintain these log entries at the start</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 ls0 ws53">of ev<span class="_ _4"></span>ery module. W<span class="_ _0"></span>e didn’<span class="_ _1"></span>t hav<span class="_ _4"></span>e source code control systems that did it for us. No<span class="_ _4"></span>wada<span class="_ _4"></span>ys,</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls22 ws21">ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, these long journals are just more clutter to obfuscate the module. <span class="_ _1"></span>They should be</div><div class="t m0 xd h14 y32e ff8 fs3 fc0 sc0 ls0 ws0">completely remo<span class="_ _1"></span>ved.</div><div class="t m0 xd h11 y7b7 ff1 fs7 fc0 sc0 ls0 ws0">Noise Comments</div><div class="t m0 xd h14 y2a1 ff8 fs3 fc0 sc0 lsd ws42e">Sometimes you see comments that are nothing but noise. <span class="_ _1"></span>They restate the ob<span class="_ _4"></span>vious and</div><div class="t m0 xd h14 y437 ff8 fs3 fc0 sc0 ls0 ws0">pro<span class="_ _4"></span>vide no ne<span class="_ _4"></span>w infor<span class="_ _8"></span>mation.</div><div class="t m5 x74 h2f y7b8 ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x74 h2f y7b9 ffb fs10 fc0 sc0 ls14 ws235"> * Default constructor.</div><div class="t m5 x74 h2f y7ba ffb fs10 fc0 sc0 ls3c ws241"> */</div><div class="t m5 x74 h2f y7bb ffb fs10 fc0 sc0 ls0 ws0">protected AnnualDateRule() {</div><div class="t m5 x74 h2f y7bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y7bd ff8 fs3 fc0 sc0 ls0 ws0">No, <span class="ffa">r<span class="_ _4"></span>eally?<span class="ff8"> Or ho<span class="_ _4"></span>w about this:</span></span></div><div class="t m5 x74 h2f y7be ffb fs10 fc0 sc0 ls0 ws0">/** The day of the month. */</div><div class="t m5 x74 h2f y7bf ffb fs10 fc0 sc0 ls19 ws237">    private int dayOfMonth;</div><div class="t m0 xd h14 y7c0 ff8 fs3 fc0 sc0 ls0 ws0">And then there’<span class="_ _2"></span>s this paragon of redundancy:</div><div class="t m5 x74 h2f y7c1 ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x74 h2f y7c2 ffb fs10 fc0 sc0 ls0 ws260"> * Returns the day of the month.</div><div class="t m5 x74 h2f y7c3 ffb fs10 fc0 sc0 ls3b ws0"> *</div><div class="t m5 x74 h2f y7c4 ffb fs10 fc0 sc0 ls0 ws260"> * @return the day of the month.</div><div class="t m5 x74 h2f y7c5 ffb fs10 fc0 sc0 ls3c ws241"> */</div><div class="t m5 x74 h2f y7c6 ffb fs10 fc0 sc0 ls0 ws0">public int getDayOfMonth() {</div><div class="t m5 x74 h2f y7c7 ffb fs10 fc0 sc0 ls18 ws241">  return dayOfMonth;</div><div class="t m5 x74 h2f y7c8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y7c9 ffb fs10 fc0 sc0 ls0 ws0"> * Changes (from 11-Oct-2001)</div><div class="t m5 x74 h2f y7ca ffb fs10 fc0 sc0 ls0 ws0"> * --------------------------</div><div class="t m5 x74 h2f y7cb ffb fs10 fc0 sc0 ls0 ws0"> * 11-Oct-2001 : Re-organised the class and moved it to new package </div><div class="t m5 x74 h2f y7cc ffb fs10 fc0 sc0 ls0 ws0"> *               com.jrefinery.date (DG);</div><div class="t m5 x74 h2f y7cd ffb fs10 fc0 sc0 ls0 ws0"> * 05-Nov-2001 : Added a getDescription() method, and eliminated NotableDate </div><div class="t m5 x74 h2f y7ce ffb fs10 fc0 sc0 ls0 ws0"> *               class (DG);</div><div class="t m5 x74 h2f y7cf ffb fs10 fc0 sc0 ls0 ws0"> * 12-Nov-2001 : IBD requires setDescription() method, now that NotableDate </div><div class="t m5 x74 h2f y7d0 ffb fs10 fc0 sc0 ls0 ws0"> *               class is gone (DG);  Changed getPreviousDayOfWeek(), </div><div class="t m5 x74 h2f y7d1 ffb fs10 fc0 sc0 ls0 ws0"> *               getFollowingDayOfWeek() and getNearestDayOfWeek() to correct </div><div class="t m5 x74 h2f y7d2 ffb fs10 fc0 sc0 ls0 ws0"> *               bugs (DG);</div><div class="t m5 x74 h2f y7d3 ffb fs10 fc0 sc0 ls0 ws0"> * 05-Dec-2001 : Fixed bug in SpreadsheetDate class (DG);</div><div class="t m5 x74 h2f y7d4 ffb fs10 fc0 sc0 ls0 ws0"> * 29-May-2002 : Moved the month constants into a separate interface </div><div class="t m5 x74 h2f y7d5 ffb fs10 fc0 sc0 ls0 ws0"> *               (MonthConstants) (DG);</div><div class="t m5 x74 h2f y7d6 ffb fs10 fc0 sc0 ls0 ws0"> * 27-Aug-2002 : <span class="ls45">Fixed bug in addMonths() method, thanks to N???levka Petr (DG);</span></div><div class="t m5 x74 h2f y7d7 ffb fs10 fc0 sc0 ls0 ws0"> * 03-Oct-2002 : Fixed errors reported by Checkstyle (DG);</div><div class="t m5 x74 h2f y7d8 ffb fs10 fc0 sc0 ls0 ws0"> * 13-Mar-2003 : Implemented Serializable (DG);</div><div class="t m5 x74 h2f y7d9 ffb fs10 fc0 sc0 ls0 ws0"> * 29-May-2003 : Fixed bug in addMonths method (DG);</div><div class="t m5 x74 h2f y7da ffb fs10 fc0 sc0 ls0 ws0"> * 04-Sep-2003 : Implemented Comparable.  Updated the isInRange javadocs (DG);</div><div class="t m5 x74 h2f y7db ffb fs10 fc0 sc0 ls0 ws0"> * 05-Jan-2005 : Fixed bug in addYears() method (1096282) (DG);</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:329.728010px;width:86.315000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf60" class="pf w1 h2" data-page-no="60"><div class="pc pc60 w1 h2"><img class="bi xd y7dc wc h4d" alt="" src="bg60.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">65<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws42f">These comments are so noisy that w<span class="_ _4"></span>e lear<span class="_ _8"></span>n to ignore them. <span class="_ _1"></span>As we read through code, our</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws3e7">ey<span class="_ _4"></span>es simply skip o<span class="_ _1"></span>ver them. Eventuall<span class="_ _4"></span>y the comments begin to lie as the code around them</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">changes.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws430">The ﬁrst comment in Listing 4-4 seems appropriate.</div><div class="t m0 x89 h21 y64d ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xae h14 y1fb ff8 fs3 fc0 sc0 ls0 ws430">It explains w<span class="_ _4"></span>hy the </div><div class="t m5 x98 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xd8 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">block</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws431">is being ignored. But the second comment is pure noise. <span class="_ _1"></span>Apparently the pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer was</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">just so frustrated with writing </div><div class="t m5 x1 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x8 h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m5 x81 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x33 h14 y1be ff8 fs3 fc0 sc0 ls0 ws0"> blocks in this function that he needed to v<span class="_ _4"></span>ent.</div><div class="t m0 x74 h14 y7dd ff8 fs3 fc0 sc0 ls0 ws432">Rather than venting in a w<span class="_ _1"></span>or<span class="_ _8"></span>thless and noisy comment, the programmer should ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y7de ff8 fs3 fc0 sc0 ls0 wsc4">reco<span class="_ _4"></span>gnized that his fr<span class="_ _8"></span>ustration could be resolved b<span class="_ _4"></span>y impro<span class="_ _4"></span>ving the str<span class="_ _8"></span>ucture of his code.</div><div class="t m0 xd h14 y7df ff8 fs3 fc0 sc0 ls0 ws433">He should ha<span class="_ _4"></span>ve redirected his energy to e<span class="_ _4"></span>xtracting that last </div><div class="t m5 x69 h2f y7e0 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x53 h14 y7e0 ff8 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m5 xab h2f y7e0 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x97 h14 y7e0 ff8 fs3 fc0 sc0 ls0 ws433">block into a separate</div><div class="t m0 xd h14 y7e1 ff8 fs3 fc0 sc0 ls0 ws0">function, as sho<span class="_ _4"></span>wn in Listing 4-5.</div><div class="t m0 xd h25 y7e2 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>The current trend for IDEs to check spelling in comments will be a balm for those of us who read a lot of code.</div><div class="t m0 x74 h1c y276 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-4 </div><div class="t m0 x74 h36 y7e3 ffc fs3 fc0 sc0 ls0 ws0">startSending</div><div class="t m5 x52 h2f y7e4 ffb fs10 fc0 sc0 ls0 ws0">private void startSending()</div><div class="t m5 x52 h2f y7e5 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y7e6 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m5 x8a h2f y7e7 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y7e8 ffb fs10 fc0 sc0 ls0 ws0">doSending();</div><div class="t m5 x8a h2f y7e9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y7ea ffb fs10 fc0 sc0 ls0 ws0">catch(SocketException e)</div><div class="t m5 x8a h2f y7eb ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h46 y7ec ffc fs10 fc0 sc0 ls0 ws0">// normal. someone stopped the request.</div><div class="t m5 x8a h2f y7ed ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y7ee ffb fs10 fc0 sc0 ls0 ws0">catch(Exception e)</div><div class="t m5 x8a h2f y7ef ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y7f0 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m5 x6c h2f y7f1 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x86 h2f y7f2 ffb fs10 fc0 sc0 ls0 ws0">response.add(ErrorResponder.makeExceptionString(e));</div><div class="t m5 x86 h2f y7f3 ffb fs10 fc0 sc0 ls0 ws0">response.closeAll();</div><div class="t m5 x6c h2f y7f4 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x6c h2f y7f5 ffb fs10 fc0 sc0 ls0 ws0">catch(Exception e1)</div><div class="t m5 x6c h2f y7f6 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x86 h46 y7f7 ffc fs10 fc0 sc0 ls0 ws0">//Give me a break!</div><div class="t m5 x6c h2f y7f8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y7f9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y7fa ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y3fe ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-5 </div><div class="t m0 x74 h36 y7fb ffc fs3 fc0 sc0 ls0 ws0">startSending (refactored)</div><div class="t m5 x52 h2f y7fc ffb fs10 fc0 sc0 ls0 ws0">private void startSending()</div><div class="t m5 x52 h2f y7fd ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y7fe ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m5 x8a h2f y7ff ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y800 ffb fs10 fc0 sc0 ls0 ws0">doSending();</div><div class="t m5 x8a h2f y801 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf61" class="pf w1 h2" data-page-no="61"><div class="pc pc61 w1 h2"><img class="bi xd y802 wc h4e" alt="" src="bg61.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">66<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 xd h14 y803 ff8 fs3 fc0 sc0 ls0 ws154">Replace the temptation to create noise with the determination to clean your code. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll</div><div class="t m0 xd h14 y804 ff8 fs3 fc0 sc0 ls0 ws0">ﬁnd it makes y<span class="_ _4"></span>ou a better and happier programmer<span class="_ _4"></span>.</div><div class="t m0 xd h11 y805 ff1 fs7 fc0 sc0 ls0 ws0">Scary Noise</div><div class="t m0 xd h14 y806 ff8 fs3 fc0 sc0 ls0 ws434">Ja<span class="_ _4"></span>vadocs can also be noisy<span class="_ _0"></span>. <span class="_ _4"></span>What pur<span class="_ _8"></span>pose do the following Ja<span class="_ _1"></span>vadocs (from a w<span class="_ _4"></span>ell-kno<span class="_ _4"></span>wn</div><div class="t m0 xd h14 y807 ff8 fs3 fc0 sc0 ls0 ws435">open-source library) ser<span class="_ _8"></span>ve? <span class="_ _1"></span>Answ<span class="_ _4"></span>er: nothing. <span class="_ _4"></span>They are just redundant noisy comments</div><div class="t m0 xd h14 y808 ff8 fs3 fc0 sc0 ls0 ws0">written out of some misplaced desire to pro<span class="_ _4"></span>vide documentation.</div><div class="t m5 x74 h2f y809 ffb fs10 fc0 sc0 ls0 ws0">/** The name. */</div><div class="t m5 x74 h2f y80a ffb fs10 fc0 sc0 ls0 ws0">private String name;</div><div class="t m5 x74 h2f y80b ffb fs10 fc0 sc0 ls0 ws0">/** The version. */</div><div class="t m5 x74 h2f y80c ffb fs10 fc0 sc0 ls0 ws0">private String version;</div><div class="t m5 x74 h2f y80d ffb fs10 fc0 sc0 ls0 ws0">/** The licenceName. */</div><div class="t m5 x74 h2f y80e ffb fs10 fc0 sc0 ls0 ws0">private String licenceName;</div><div class="t m5 x74 h2f y80f ffb fs10 fc0 sc0 ls0 ws0">/** The version. */</div><div class="t m5 x74 h2f y810 ffb fs10 fc0 sc0 ls0 ws0">private String info;</div><div class="t m0 x74 h14 y648 ff8 fs3 fc0 sc0 lsc ws41d">Read these comments again more carefully<span class="_ _0"></span>. Do y<span class="_ _4"></span>ou see the cut-paste er<span class="_ _8"></span>ror? If authors</div><div class="t m0 xd h14 y649 ff8 fs3 fc0 sc0 ls0 ws436">aren’<span class="_ _1"></span>t paying attention w<span class="_ _4"></span>hen comments are written (or pasted), wh<span class="_ _4"></span>y should readers be</div><div class="t m0 xd h14 y811 ff8 fs3 fc0 sc0 ls0 ws0">expected to proﬁt from them?</div><div class="t m5 x8a h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">catch(SocketException e)</div><div class="t m5 x8a h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">// normal. someone stopped the request.</div><div class="t m5 x8a h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y522 ffb fs10 fc0 sc0 ls0 ws0">catch(Exception e)</div><div class="t m5 x8a h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y4be ffb fs10 fc0 sc0 ls0 ws0">addExceptionAndCloseResponse(e);</div><div class="t m5 x8a h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">private void addExceptionAndCloseResponse(Exception e)</div><div class="t m5 x52 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m5 x8a h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">response.add(ErrorResponder.makeExceptionString(e));</div><div class="t m5 x6c h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">response.closeAll();</div><div class="t m5 x8a h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">catch(Exception e1)</div><div class="t m5 x8a h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">startSending (refactored)</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:311.728010px;width:60.323000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf62" class="pf w1 h2" data-page-no="62"><div class="pc pc62 w1 h2"><img class="bi xd y3cd wc h4f" alt="" src="bg62.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">67<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Use a Comment <span class="_ _1"></span>When <span class="_ _0"></span>Y<span class="_ _3"></span>ou Can Use a Function or a <span class="_ _0"></span>V<span class="_ _2"></span>ariab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws0">Consider the follo<span class="_ _4"></span>wing stretch of code:</div><div class="t m5 x74 h2f y812 ffb fs10 fc0 sc0 ls0 ws0">// does the module from the global list &lt;mod&gt; depend on the</div><div class="t m5 x74 h2f y813 ffb fs10 fc0 sc0 ls0 ws0">// subsystem we are part of?</div><div class="t m5 x74 h2f y814 ffb fs10 fc0 sc0 ls0 ws0">if (smodule.getDependSubsystems().contains(subSysMod.getSubSystem()))</div><div class="t m0 xd h14 y79e ff8 fs3 fc0 sc0 ls0 ws0">This could be rephrased without the comment as</div><div class="t m5 x74 h2f y815 ffb fs10 fc0 sc0 ls0 ws0">ArrayList moduleDependees = smodule.getDependSubsystems();</div><div class="t m5 x74 h2f y816 ffb fs10 fc0 sc0 ls0 ws0">String ourSubSystem = subSysMod.getSubSystem();</div><div class="t m5 x74 h2f y817 ffb fs10 fc0 sc0 ls0 ws0">if (moduleDependees.contains(ourSubSystem))</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls0 ws29">The author of the original code ma<span class="_ _4"></span>y ha<span class="_ _4"></span>ve written the comment ﬁrst (unlikel<span class="_ _4"></span>y) and then</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 ls0 ws437">written the code to fulﬁll the comment. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the author should then ha<span class="_ _1"></span>ve refactored</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws0">the code, as I did<span class="_ _1"></span>, so that the comment could be remo<span class="_ _4"></span>ved.</div><div class="t m0 xd h11 y79f ff1 fs7 fc0 sc0 ls0 ws0">P<span class="_ _1"></span>osition Marker<span class="_ _4"></span>s</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws1ab">Sometimes pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers like to mark a particular position in a source ﬁle. F<span class="_ _4"></span>or example, I</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws0">recently found this in a pro<span class="_ _1"></span>g<span class="_ _8"></span>ram I was looking through:</div><div class="t m5 x74 h2f y818 ffb fs10 fc0 sc0 ls0 ws0">// Actions //////////////////////////////////</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 lsc ws34">There are rare times when it mak<span class="_ _4"></span>es sense to gather cer<span class="_ _8"></span>tain functions together beneath a</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws26a">banner like this. But in general the<span class="_ _4"></span>y are clutter that should be eliminated—especially the</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 ls0 ws0">noisy train of slashes at the end.</div><div class="t m0 x74 h14 y25e ff8 fs3 fc0 sc0 ls11 ws438">Think of it this w<span class="_ _4"></span>ay<span class="_ _0"></span>. <span class="_ _1"></span>A banner is star<span class="_ _8"></span>tling and obvious if y<span class="_ _4"></span>ou don’<span class="_ _4"></span>t see banners very</div><div class="t m0 xd h14 y25f ff8 fs3 fc0 sc0 ls0 ws306">often. So use them very sparingly<span class="_ _0"></span>, and onl<span class="_ _4"></span>y when the beneﬁt is signiﬁcant. If you o<span class="_ _1"></span>veruse</div><div class="t m0 xd h14 y819 ff8 fs3 fc0 sc0 ls0 ws0">banners, they’<span class="_ _1"></span>ll f<span class="_ _8"></span>all into the background noise and be ignored.</div><div class="t m0 xd h11 y81a ff1 fs7 fc0 sc0 ls0 ws0">Closing Brace Comments</div><div class="t m0 xd h14 y81b ff8 fs3 fc0 sc0 ls0 ws22a">Sometimes pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers will put special comments on closing braces, as in Listing 4-6.</div><div class="t m0 xd h14 y419 ff8 fs3 fc0 sc0 ls0 ws201">Although this might make sense for long functions with deepl<span class="_ _4"></span>y nested str<span class="_ _8"></span>uctures, it serves</div><div class="t m0 xd h14 y81c ff8 fs3 fc0 sc0 ls0 ws99">only to clutter the kind of small and encapsulated functions that w<span class="_ _1"></span>e prefer<span class="_ _4"></span>. So if you ﬁnd</div><div class="t m0 xd h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">yourself w<span class="_ _4"></span>anting to mark your closing braces, try to shorten your functions instead.</div><div class="t m0 x74 h1c y584 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-6 </div><div class="t m0 x74 h36 y396 ffc fs3 fc0 sc0 ls0 ws0">wc.java</div><div class="t m5 x74 h2f y81d ffb fs10 fc0 sc0 ls0 ws0">public class wc {</div><div class="t m5 x74 h2f y81e ffb fs10 fc0 sc0 ls0 ws0">  public static void main(String[] args) {</div><div class="t m5 x74 h2f y81f ffb fs10 fc0 sc0 ls0 ws0">    BufferedReader in = new BufferedReader(new InputStreamReader(System.in));</div><div class="t m5 x74 h2f y820 ffb fs10 fc0 sc0 ls0 ws0">    String line;</div><div class="t m5 x74 h2f y821 ffb fs10 fc0 sc0 ls0 ws0">    int lineCount = 0;</div><div class="t m5 x74 h2f y822 ffb fs10 fc0 sc0 ls0 ws0">    int charCount = 0;</div><div class="t m5 x74 h2f y823 ffb fs10 fc0 sc0 ls0 ws0">    int wordCount = 0;</div><div class="t m5 x74 h2f y824 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:410.728010px;width:87.982000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:339.938000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:256.728010px;width:129.866000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf63" class="pf w1 h2" data-page-no="63"><div class="pc pc63 w1 h2"><img class="bi xd y825 wc h50" alt="" src="bg63.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">68<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 xd h11 y3ee ff1 fs7 fc0 sc0 ls0 ws0">Attributions and Bylines</div><div class="t m5 x74 h2f y5df ffb fs10 fc0 sc0 ls0 ws0">/* Added by Rick */</div><div class="t m0 x74 h14 y259 ff8 fs3 fc0 sc0 ls0 ws2c">Source code control systems are very good at remembering who added w<span class="_ _4"></span>hat, when.</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls0 ws2d0">There is no need to pollute the code with little bylines. <span class="_ _0"></span>Y<span class="_ _3"></span>ou might think that such com-</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 ls0 ws1ef">ments w<span class="_ _4"></span>ould be useful in order to help others kno<span class="_ _4"></span>w who to talk to about the code. But the</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws439">reality is that they tend to sta<span class="_ _1"></span>y around for years and years, getting less and less accurate</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 ls0 ws0">and relev<span class="_ _1"></span>ant.</div><div class="t m0 x74 h14 y25e ff8 fs3 fc0 sc0 lsc ws3f">Again, the source code control system is a better place for this kind of information.</div><div class="t m0 xd h11 y826 ff1 fs7 fc0 sc0 ls0 ws0">Commented-Out Code</div><div class="t m0 xd h14 y827 ff8 fs3 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>ew practices are as odious as commenting-out code. Don’<span class="_ _1"></span>t do this!</div><div class="t m5 x8a h2f y828 ffb fs10 fc0 sc0 ls0 ws0">InputStreamResponse response = new InputStreamResponse();</div><div class="t m5 x8a h2f y829 ffb fs10 fc0 sc0 ls0 ws0">response.setBody(formatter.getResultStream(), formatter.getByteCount());</div><div class="t m5 x74 h46 y82a ffc fs10 fc0 sc0 ls0 ws0">//<span class="_ _24"> </span>InputStream resultsStream = formatter.getResultStream();</div><div class="t m5 x74 h46 y82b ffc fs10 fc0 sc0 ls0 ws0">//<span class="_ _24"> </span>StreamReader reader = new StreamReader(resultsStream);</div><div class="t m5 x74 h46 y82c ffc fs10 fc0 sc0 ls0 ws0">//<span class="_ _24"> </span>response.setContent(reader.read(formatter.getByteCount()));</div><div class="t m0 xd h14 y1d0 ff8 fs3 fc0 sc0 ls0 ws3e7">Others who see that commented-out code w<span class="_ _1"></span>on’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve the courage to delete it. <span class="_ _4"></span>They’<span class="_ _1"></span>ll think</div><div class="t m0 xd h14 y1d1 ff8 fs3 fc0 sc0 lsc ws29c">it is there for a reason and is too important to delete. So commented-out code gathers like</div><div class="t m0 xd h14 y1d2 ff8 fs3 fc0 sc0 ls0 ws0">dregs at the bottom of a bad bottle of wine.</div><div class="t m0 x74 h14 y213 ff8 fs3 fc0 sc0 ls0 ws0">Consider this from apache commons:</div><div class="t m5 x8a h2f y82d ffb fs10 fc0 sc0 ls0 ws0">this.bytePos = writeBytes(pngIdBytes, 0);</div><div class="t m5 x8a h46 y82e ffc fs10 fc0 sc0 ls0 ws0">//hdrPos = bytePos;</div><div class="t m5 x8a h2f y82f ffb fs10 fc0 sc0 ls0 ws0">writeHeader();</div><div class="t m5 x8a h2f y830 ffb fs10 fc0 sc0 ls0 ws0">writeResolution();</div><div class="t m5 x8a h46 y831 ffc fs10 fc0 sc0 ls0 ws0">//dataPos = bytePos;</div><div class="t m5 x8a h2f y832 ffb fs10 fc0 sc0 ls0 ws0">if (writeImageData()) {</div><div class="t m5 x86 h2f y833 ffb fs10 fc0 sc0 ls0 ws0">writeEnd();</div><div class="t m5 x86 h2f y834 ffb fs10 fc0 sc0 ls0 ws0">this.pngBytes = resizeByteArray(this.pngBytes, this.maxPos);</div><div class="t m5 x8a h2f y835 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y836 ffb fs10 fc0 sc0 ls0 ws0">      while ((line = in.readLine()) != null) {</div><div class="t m5 x74 h2f y837 ffb fs10 fc0 sc0 ls0 ws0">        lineCount++;</div><div class="t m5 x74 h2f y838 ffb fs10 fc0 sc0 ls0 ws0">        charCount += line.length();</div><div class="t m5 x74 h2f y839 ffb fs10 fc0 sc0 ls0 ws0">        String words[] = line.split(&quot;\\W&quot;);</div><div class="t m5 x74 h2f y83a ffb fs10 fc0 sc0 ls0 ws0">        wordCount += words.length;</div><div class="t m5 x74 h46 y83b ffc fs10 fc0 sc0 ls0 ws0">      } //while</div><div class="t m5 x74 h2f y83c ffb fs10 fc0 sc0 ls0 ws0">      System.out.println(&quot;wordCount = &quot; + wordCount);</div><div class="t m5 x74 h2f y83d ffb fs10 fc0 sc0 ls0 ws0">      System.out.println(&quot;lineCount = &quot; + lineCount);</div><div class="t m5 x74 h2f y83e ffb fs10 fc0 sc0 ls0 ws0">      System.out.println(&quot;charCount = &quot; + charCount);</div><div class="t m5 x74 h46 y83f ffc fs10 fc0 sc0 ls0 ws0">    } // try</div><div class="t m5 x74 h2f y840 ffb fs10 fc0 sc0 ls0 ws0">    catch (IOException e) {</div><div class="t m5 x74 h2f y841 ffb fs10 fc0 sc0 ls0 ws0">      System.err.println(&quot;Error:&quot; + e.getMessage());</div><div class="t m5 x74 h46 y842 ffc fs10 fc0 sc0 ls0 ws0">    } //catch</div><div class="t m5 x74 h2f y843 ffb fs10 fc0 sc0 ls0 ws0">  } //main</div><div class="t m5 x74 h2f y844 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-6 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">wc.java</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:404.728010px;width:125.786000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:280.728010px;width:116.315000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf64" class="pf w1 h2" data-page-no="64"><div class="pc pc64 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">69<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m5 x8a h2f y345 ffb fs10 fc0 sc0 ls0 ws0">else {</div><div class="t m5 x86 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">this.pngBytes = null;</div><div class="t m5 x8a h2f y628 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y629 ffb fs10 fc0 sc0 ls0 ws0">return this.pngBytes;</div><div class="t m0 xd h14 y845 ff8 fs3 fc0 sc0 ls0 ws43a">Wh<span class="_ _4"></span>y are those tw<span class="_ _4"></span>o lines of code commented? <span class="_ _4"></span>Are they important? W<span class="_ _2"></span>ere they left as</div><div class="t m0 xd h14 y56d ff8 fs3 fc0 sc0 ls0 ws401">reminders for some imminent change? Or are they just cruft that someone commented-out</div><div class="t m0 xd h14 y41c ff8 fs3 fc0 sc0 ls0 ws0">years ago and has simpl<span class="_ _4"></span>y not bothered to clean up.</div><div class="t m0 x74 h14 y681 ff8 fs3 fc0 sc0 ls0 ws1b8">There w<span class="_ _4"></span>as a time, back in the sixties, when commenting-out code might ha<span class="_ _4"></span>ve been</div><div class="t m0 xd h14 y408 ff8 fs3 fc0 sc0 ls0 wsda">useful. But w<span class="_ _4"></span>e’<span class="_ _4"></span>ve had good source code control systems for a v<span class="_ _4"></span>er<span class="_ _8"></span>y long time no<span class="_ _4"></span>w<span class="_ _1"></span>. <span class="_ _1"></span>Those</div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws43b">systems will remember the code for us. <span class="_ _4"></span>W<span class="_ _0"></span>e don’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve to comment it out any more. Just</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws0">delete the code. <span class="_ _4"></span>W<span class="_ _0"></span>e won’<span class="_ _1"></span>t lose it. Promise.</div><div class="t m0 xd h11 y847 ff1 fs7 fc0 sc0 ls0 ws0">HTML Comments</div><div class="t m0 xd h14 y329 ff8 fs3 fc0 sc0 ls0 ws43c">HTML in source code comments is an abomination, as you can tell b<span class="_ _4"></span>y reading the code</div><div class="t m0 xd h14 y32a ff8 fs3 fc0 sc0 ls0 ws43d">belo<span class="_ _4"></span>w<span class="_ _0"></span>. It makes the comments hard to read in the one place where the<span class="_ _4"></span>y should be easy to</div><div class="t m0 xd h14 y32b ff8 fs3 fc0 sc0 ls0 ws139">read—the editor/IDE. If comments are going to be extracted b<span class="_ _4"></span>y some tool (like Ja<span class="_ _4"></span>vadoc) to</div><div class="t m0 xd h14 y848 ff8 fs3 fc0 sc0 ls0 ws43e">appear in a <span class="_ _4"></span>W<span class="_ _0"></span>eb page, then it should be the responsibility of that tool, and not the program-</div><div class="t m0 xd h14 y849 ff8 fs3 fc0 sc0 ls0 ws0">mer<span class="_ _4"></span>, to adorn the comments with appropriate HTML.</div><div class="t m5 x74 h2f y606 ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x74 h2f y84a ffb fs10 fc0 sc0 ls14 ws423"> * Task to run fit tests. </div><div class="t m5 x74 h2f y84b ffb fs10 fc0 sc0 ls0 ws423"> * This task runs fitnesse tests and publishes the results.</div><div class="t m5 x74 h2f y84c ffb fs10 fc0 sc0 ls19 ws235"> * &lt;p/&gt;</div><div class="t m5 x74 h2f y84d ffb fs10 fc0 sc0 ls19 ws235"> * &lt;pre&gt;</div><div class="t m5 x74 h2f y84e ffb fs10 fc0 sc0 ls19 ws235"> * Usage:</div><div class="t m5 x74 h2f y84f ffb fs10 fc0 sc0 ls0 ws236"> * &amp;lt;taskdef name=&amp;quot;execute-fitnesse-tests&amp;quot; </div><div class="t m5 x74 h2f y850 ffb fs10 fc0 sc0 ls0 ws260"> *     classname=&amp;quot;fitnesse.ant.ExecuteFitnesseTestsTask&amp;quot; </div><div class="t m5 x74 h2f y851 ffb fs10 fc0 sc0 ls0 ws260"> *     classpathref=&amp;quot;classpath&amp;quot; /&amp;gt;</div><div class="t m5 x74 h2f y852 ffb fs10 fc0 sc0 ls1f ws253"> * OR</div><div class="t m5 x74 h2f y853 ffb fs10 fc0 sc0 ls0 ws236"> * &amp;lt;taskdef classpathref=&amp;quot;classpath&amp;quot; </div><div class="t m5 x74 h2f y854 ffb fs10 fc0 sc0 ls0 ws423"> *             resource=&amp;quot;tasks.properties&amp;quot; /&amp;gt;</div><div class="t m5 x74 h2f y855 ffb fs10 fc0 sc0 ls19 ws235"> * &lt;p/&gt;</div><div class="t m5 x74 h2f y856 ffb fs10 fc0 sc0 ls14 ws237"> * &amp;lt;execute-fitnesse-tests </div><div class="t m5 x74 h2f y857 ffb fs10 fc0 sc0 ls0 ws260"> *     suitepage=&amp;quot;FitNesse.SuiteAcceptanceTests&amp;quot; </div><div class="t m5 x74 h2f y858 ffb fs10 fc0 sc0 ls0 ws260"> *     fitnesseport=&amp;quot;8082&amp;quot; </div><div class="t m5 x74 h2f y859 ffb fs10 fc0 sc0 ls0 ws260"> *     resultsdir=&amp;quot;${results.dir}&amp;quot; </div><div class="t m5 x74 h2f y85a ffb fs10 fc0 sc0 ls0 ws260"> *     resultshtmlpage=&amp;quot;fit-results.html&amp;quot; </div><div class="t m5 x74 h2f y85b ffb fs10 fc0 sc0 ls0 ws260"> *     classpathref=&amp;quot;classpath&amp;quot; /&amp;gt;</div><div class="t m5 x74 h2f y85c ffb fs10 fc0 sc0 ls19 ws235"> * &lt;/pre&gt;</div><div class="t m5 x74 h2f y85d ffb fs10 fc0 sc0 ls3c ws241"> */</div><div class="t m0 xd h11 y85e ff1 fs7 fc0 sc0 ls0 ws0">Nonlocal Inf<span class="_ _4"></span>ormation</div><div class="t m0 xd h14 y42e ff8 fs3 fc0 sc0 ls0 ws229">If you must write a comment, then mak<span class="_ _4"></span>e sure it describes the code it appears near<span class="_ _4"></span>. Don’<span class="_ _4"></span>t</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws2ac">of<span class="_ _4"></span>fer systemwide infor<span class="_ _8"></span>mation in the context of a local comment. Consider<span class="_ _4"></span>, for example,</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls0 ws43f">the ja<span class="_ _4"></span>vadoc comment belo<span class="_ _1"></span>w<span class="_ _1"></span>. <span class="_ _1"></span>Aside from the f<span class="_ _8"></span>act that it is hor<span class="_ _8"></span>ribl<span class="_ _4"></span>y redundant, it also offers</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws29a">information about the def<span class="_ _8"></span>ault port. <span class="_ _4"></span>And yet the function has absolutel<span class="_ _4"></span>y no control o<span class="_ _4"></span>ver</div><div class="t m0 xd h14 y5ce ff8 fs3 fc0 sc0 lsd ws109">what that default is. <span class="_ _1"></span>The comment is not describing the function, but some other<span class="_ _4"></span>, f<span class="_ _8"></span>ar dis-</div><div class="t m0 xd h14 y85f ff8 fs3 fc0 sc0 ls0 ws34f">tant part of the system. Of course there is no guarantee that this comment will be changed</div><div class="t m0 xd h14 y860 ff8 fs3 fc0 sc0 ls0 ws0">when the code containing the default is changed.</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:441.728010px;width:94.991000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:152.728010px;width:110.700000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf65" class="pf w1 h2" data-page-no="65"><div class="pc pc65 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">70<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m5 x52 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x52 h2f y627 ffb fs10 fc0 sc0 ls0 ws0"> * Port on which fitnesse would run. Defaults to &lt;b&gt;8082&lt;/b&gt;.</div><div class="t m5 x52 h2f y628 ffb fs10 fc0 sc0 ls0 ws0"> *</div><div class="t m5 x52 h2f y629 ffb fs10 fc0 sc0 ls0 ws0"> * @param fitnessePort</div><div class="t m5 x52 h2f y62a ffb fs10 fc0 sc0 ls0 ws0"> */</div><div class="t m5 x52 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">public void setFitnessePort(int fitnessePort)</div><div class="t m5 x52 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y62d ffb fs10 fc0 sc0 ls0 ws0">this.fitnessePort = fitnessePort;</div><div class="t m5 x52 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y862 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>oo Much Inf<span class="_ _4"></span>ormation</div><div class="t m0 xd h14 y863 ff8 fs3 fc0 sc0 ls0 ws1dd">Don’<span class="_ _1"></span>t put interesting historical discussions or ir<span class="_ _5"></span>relev<span class="_ _4"></span>ant descriptions of details into your</div><div class="t m0 xd h14 y5b9 ff8 fs3 fc0 sc0 ls0 ws440">comments. <span class="_ _1"></span>The comment below w<span class="_ _4"></span>as extracted from a module designed to test that a func-</div><div class="t m0 xd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws441">tion could encode and decode base64. Other than the RFC number<span class="_ _4"></span>, someone reading this</div><div class="t m0 xd h14 y5bb ff8 fs3 fc0 sc0 ls0 ws0">code has no need for the arcane information contained in the comment. </div><div class="t m5 x74 h2f y864 ffb fs10 fc0 sc0 ls0 ws0">/*</div><div class="t m5 x52 h2f y865 ffb fs10 fc0 sc0 ls0 ws0"> RFC 2045 - Multipurpose Internet Mail Extensions (MIME) </div><div class="t m5 x52 h2f y866 ffb fs10 fc0 sc0 ls0 ws260"> Part One: Format of Internet Message Bodies</div><div class="t m5 x52 h2f y867 ffb fs10 fc0 sc0 ls0 ws0"> section 6.8.  Base64 Content-Transfer-Encoding</div><div class="t m5 x52 h2f y868 ffb fs10 fc0 sc0 ls0 ws423"> The encoding process represents 24-bit groups of input bits as output </div><div class="t m5 x52 h2f y869 ffb fs10 fc0 sc0 ls0 ws423"> strings of 4 encoded characters. Proceeding from left to right, a </div><div class="t m5 x52 h2f y86a ffb fs10 fc0 sc0 ls0 ws423"> 24-bit input group is formed by concatenating 3 8-bit input groups. </div><div class="t m5 x52 h2f y86b ffb fs10 fc0 sc0 ls0 ws423"> These 24 bits are then treated as 4 concatenated 6-bit groups, each </div><div class="t m5 x52 h2f y86c ffb fs10 fc0 sc0 ls0 ws423"> of which is translated into a single digit in the base64 alphabet. </div><div class="t m5 x52 h2f y86d ffb fs10 fc0 sc0 ls0 ws423"> When encoding a bit stream via the base64 encoding, the bit stream </div><div class="t m5 x52 h2f y86e ffb fs10 fc0 sc0 ls0 ws423"> must be presumed to be ordered with the most-significant-bit first. </div><div class="t m5 x52 h2f y86f ffb fs10 fc0 sc0 ls0 ws423"> That is, the first bit in the stream will be the high-order bit in </div><div class="t m5 x52 h2f y870 ffb fs10 fc0 sc0 ls0 ws423"> the first 8-bit byte, and the eighth bit will be the low-order bit in </div><div class="t m5 x52 h2f y871 ffb fs10 fc0 sc0 ls0 ws260"> the first 8-bit byte, and so on.</div><div class="t m5 x74 h2f y872 ffb fs10 fc0 sc0 ls3c ws241"> */</div><div class="t m0 xd h11 y873 ff1 fs7 fc0 sc0 ls0 ws0">Inob<span class="_ _4"></span>vious Connection</div><div class="t m0 xd h14 y874 ff8 fs3 fc0 sc0 ls0 ws82">The connection betw<span class="_ _4"></span>een a comment and the code it describes should be obvious. If y<span class="_ _4"></span>ou are</div><div class="t m0 xd h14 y875 ff8 fs3 fc0 sc0 ls0 ws442">going to the trouble to write a comment, then at least y<span class="_ _4"></span>ou’<span class="_ _2"></span>d like the reader to be ab<span class="_ _4"></span>le to</div><div class="t m0 xd h14 y876 ff8 fs3 fc0 sc0 ls0 ws0">look at the comment and the code and understand what the comment is talking about. </div><div class="t m0 x74 h14 y877 ff8 fs3 fc0 sc0 ls0 ws0">Consider<span class="_ _4"></span>, for example, this comment dra<span class="_ _1"></span>wn from apache commons:</div><div class="t m5 x74 h2f y878 ffb fs10 fc0 sc0 ls1c ws0">         /*</div><div class="t m5 x74 h2f y879 ffb fs10 fc0 sc0 ls19 ws253">          * start with an array that is big enough to hold all the pixels</div><div class="t m5 x74 h2f y87a ffb fs10 fc0 sc0 ls19 ws253">          * (plus filter bytes), and an extra 200 bytes for header info</div><div class="t m5 x74 h2f y87b ffb fs10 fc0 sc0 ls1c ws0">          */</div><div class="t m5 x74 h2f y87c ffb fs10 fc0 sc0 ls18 ws235">         this.pngBytes = new byte[((this.width + 1) * this.height * 3) + 200];</div><div class="t m0 xd h14 y87d ff8 fs3 fc0 sc0 ls0 ws2c7">What is a ﬁlter b<span class="_ _4"></span>yte? Does it relate to the +1? Or to the *3? Both? Is a pixel a b<span class="_ _4"></span>yte? Wh<span class="_ _1"></span>y</div><div class="t m0 xd h14 y87e ff8 fs3 fc0 sc0 ls0 ws443">200? <span class="_ _1"></span>The pur<span class="_ _5"></span>pose of a comment is to explain code that does not e<span class="_ _4"></span>xplain itself. It is a pity</div><div class="t m0 xd h14 y87f ff8 fs3 fc0 sc0 ls0 ws0">when a comment needs its o<span class="_ _1"></span>wn explanation. </div><div class="t m0 xd h11 y880 ff1 fs7 fc0 sc0 ls0 ws0">Function Headers</div><div class="t m0 xd h14 y496 ff8 fs3 fc0 sc0 ls0 ws1e9">Short functions don’<span class="_ _4"></span>t need much description. <span class="_ _4"></span>A w<span class="_ _4"></span>ell-chosen name for a small function that</div><div class="t m0 xd h14 y497 ff8 fs3 fc0 sc0 ls0 ws0">does one thing is usuall<span class="_ _4"></span>y better than a comment header<span class="_ _4"></span>. </div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:489.728010px;width:117.267000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:266.728010px;width:111.878000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:88.728110px;width:91.551000px;height:13.367900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf66" class="pf w1 h2" data-page-no="66"><div class="pc pc66 w1 h2"><img class="bi xd y881 wc h1" alt="" src="bg66.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">71<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Ja<span class="_ _0"></span>vadocs in Nonpub<span class="_ _4"></span>lic Code</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws3cb">As useful as ja<span class="_ _4"></span>vadocs are for pub<span class="_ _4"></span>lic <span class="_ _4"></span>APIs, they are anathema to code that is not intended</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws18f">for public consumption. Generating ja<span class="_ _1"></span>vadoc pages for the classes and functions inside a</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws444">system is not generall<span class="_ _4"></span>y useful, and the extra formality of the jav<span class="_ _4"></span>adoc comments amounts</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws0">to little more than cruft and distraction. </div><div class="t m0 xd h11 y882 ff1 fs7 fc0 sc0 ls0 ws0">Example</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws445">I wrote the module in Listing 4-7 for the ﬁrst <span class="ffa">XP Immersion</span>. It w<span class="_ _4"></span>as intended to be an</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws40b">example of bad coding and commenting style. K<span class="_ _4"></span>ent Beck then refactored this code into a</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws446">much more pleasant form in front of several dozen enthusiastic students. Later I adapted</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls48 ws24c">the example for m<span class="_ _1"></span>y book <span class="_ _1"></span><span class="ffa ls0 ws447">Agile Softwar<span class="_ _4"></span>e Development, Principles, P<span class="_ _0"></span>atterns, and Practices</span></div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">and the ﬁrst of m<span class="_ _4"></span>y <span class="ffa">Cr<span class="_ _4"></span>aftsman<span class="ff8"> articles published in </span>Softwar<span class="_ _1"></span>e Development<span class="ff8 ls49 ws448"> magazine. </span></span></div><div class="t m0 x74 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws2c5">What I ﬁnd fascinating about this module is that there was a time w<span class="_ _4"></span>hen many of us</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls0 ws449">w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve considered it “w<span class="_ _4"></span>ell documented.<span class="_ _1"></span>” No<span class="_ _4"></span>w we see it as a small mess. See ho<span class="_ _1"></span>w</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws0">many dif<span class="_ _1"></span>ferent comment problems you can ﬁnd.</div><div class="t m0 x74 h1c y883 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-7 </div><div class="t m0 x74 h36 y29d ffc fs3 fc0 sc0 ls0 ws0">GeneratePrimes.java</div><div class="t m5 x74 h2f y884 ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x74 h2f y885 ffb fs10 fc0 sc0 ls0 ws0"> * This class Generates prime numbers up to a user specified</div><div class="t m5 x74 h2f y886 ffb fs10 fc0 sc0 ls0 ws0"> * maximum.  The algorithm used is the Sieve of Eratosthenes.</div><div class="t m5 x74 h2f y887 ffb fs10 fc0 sc0 ls0 ws0"> * &lt;p&gt;</div><div class="t m5 x74 h2f y888 ffb fs10 fc0 sc0 ls0 ws0"> * Eratosthenes of Cyrene, b. c. 276 BC, Cyrene, Libya --</div><div class="t m5 x74 h2f y889 ffb fs10 fc0 sc0 ls0 ws0"> * d. c. 194, Alexandria.  The first man to calculate the</div><div class="t m5 x74 h2f y88a ffb fs10 fc0 sc0 ls0 ws0"> * circumference of the Earth.  Also known for working on</div><div class="t m5 x74 h2f y88b ffb fs10 fc0 sc0 ls0 ws0"> * calendars with leap years and ran the library at Alexandria.</div><div class="t m5 x74 h2f y88c ffb fs10 fc0 sc0 ls0 ws0"> * &lt;p&gt;</div><div class="t m5 x74 h2f y88d ffb fs10 fc0 sc0 ls0 ws0"> * The algorithm is quite simple.  Given an array of integers</div><div class="t m5 x74 h2f y88e ffb fs10 fc0 sc0 ls0 ws0"> * starting at 2.  Cross out all multiples of 2.  Find the next</div><div class="t m5 x74 h2f y88f ffb fs10 fc0 sc0 ls0 ws0"> * uncrossed integer, and cross out all of its multiples.</div><div class="t m5 x74 h2f y890 ffb fs10 fc0 sc0 ls0 ws0"> * Repeat untilyou have passed the square root of the maximum</div><div class="t m5 x74 h2f y891 ffb fs10 fc0 sc0 ls0 ws0"> * value.</div><div class="t m5 x74 h2f y892 ffb fs10 fc0 sc0 ls0 ws0"> *</div><div class="t m5 x74 h2f y893 ffb fs10 fc0 sc0 ls0 ws0"> * @author Alphonse</div><div class="t m5 x74 h2f y894 ffb fs10 fc0 sc0 ls0 ws0"> * @version 13 Feb 2002 atp</div><div class="t m5 x74 h2f y895 ffb fs10 fc0 sc0 ls0 ws0"> */</div><div class="t m5 x74 h2f y896 ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f y897 ffb fs10 fc0 sc0 ls0 ws0">public class GeneratePrimes</div><div class="t m5 x74 h2f y898 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y899 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y89a ffb fs10 fc0 sc0 ls0 ws0">   * @param maxValue is the generation limit.</div><div class="t m5 x74 h2f y89b ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y89c ffb fs10 fc0 sc0 ls0 ws0">  public static int[] generatePrimes(int maxValue)</div><div class="t m5 x74 h2f y89d ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y89e ffb fs10 fc0 sc0 ls0 ws0">    if (maxValue &gt;= 2) // the only valid case</div><div class="t m5 x74 h2f y89f ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y8a0 ffb fs10 fc0 sc0 ls0 ws0">      // declarations</div><div class="t m5 x74 h2f y8a1 ffb fs10 fc0 sc0 ls0 ws0">      int s = maxValue + 1; // size of array</div><div class="t m5 x74 h2f y8a2 ffb fs10 fc0 sc0 ls0 ws0">      boolean[] f = new boolean[s];</div><div class="t m5 x74 h2f y8a3 ffb fs10 fc0 sc0 ls0 ws0">      int i;</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:500.728010px;width:45.336000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:144.321000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf67" class="pf w1 h2" data-page-no="67"><div class="pc pc67 w1 h2"><img class="bi xd y67f wc h51" alt="" src="bg67.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">72<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 x74 h14 y8a4 ff8 fs3 fc0 sc0 ls0 ws44a">In Listing 4-8 you can see a refactored v<span class="_ _4"></span>ersion of the same module. Note that the use</div><div class="t m0 xd h14 y8a5 ff8 fs3 fc0 sc0 ls0 ws1bc">of comments is signiﬁcantl<span class="_ _4"></span>y restrained. <span class="_ _4"></span>There are just tw<span class="_ _4"></span>o comments in the whole module.</div><div class="t m0 xd h14 y8a6 ff8 fs3 fc0 sc0 ls0 ws0">Both comments are explanatory in nature. </div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      // initialize array to true.</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      for (i = 0; i &lt; s; i++)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">        f[i] = true;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      // get rid of known non-primes</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      f[0] = f[1] = false;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">      // sieve</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      int j;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      for (i = 2; i &lt; Math.sqrt(s) + 1; i++)</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">        if (f[i]) // if i is uncrossed, cross its multiples.</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">        {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">          for (j = 2 * i; j &lt; s; j += i)</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">            f[j] = false; // multiple is not prime</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      // how many primes are there?</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      int count = 0;</div><div class="t m5 x74 h2f y8a7 ffb fs10 fc0 sc0 ls0 ws0">      for (i = 0; i &lt; s; i++)</div><div class="t m5 x74 h2f y8a8 ffb fs10 fc0 sc0 ls0 ws0">      {</div><div class="t m5 x74 h2f y8a9 ffb fs10 fc0 sc0 ls0 ws0">        if (f[i])</div><div class="t m5 x74 h2f y8aa ffb fs10 fc0 sc0 ls0 ws0">          count++; // bump count.</div><div class="t m5 x74 h2f y8ab ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y8ac ffb fs10 fc0 sc0 ls0 ws0">      int[] primes = new int[count];</div><div class="t m5 x74 h2f y8ad ffb fs10 fc0 sc0 ls0 ws0">      // move the primes into the result</div><div class="t m5 x74 h2f y8ae ffb fs10 fc0 sc0 ls0 ws0">      for (i = 0, j = 0; i &lt; s; i++)</div><div class="t m5 x74 h2f y8af ffb fs10 fc0 sc0 ls0 ws0">      {</div><div class="t m5 x74 h2f y8b0 ffb fs10 fc0 sc0 ls0 ws0">        if (f[i])             // if prime</div><div class="t m5 x74 h2f y8b1 ffb fs10 fc0 sc0 ls0 ws0">          primes[j++] = i;</div><div class="t m5 x74 h2f y8b2 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y8b3 ffb fs10 fc0 sc0 ls0 ws0">      return primes;  // return the primes</div><div class="t m5 x74 h2f y8b4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y8b5 ffb fs10 fc0 sc0 ls0 ws0">    else // maxValue &lt; 2</div><div class="t m5 x74 h2f y8b6 ffb fs10 fc0 sc0 ls0 ws0">      return new int[0]; // return null array if bad input.</div><div class="t m5 x74 h2f y8b7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8b8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b4 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-8 </div><div class="t m0 x74 h36 y8b9 ffc fs3 fc0 sc0 ls0 ws0">PrimeGenerator.java (refactored)</div><div class="t m5 x74 h2f y8ba ffb fs10 fc0 sc0 ls0 ws0">/**</div><div class="t m5 x74 h2f y8bb ffb fs10 fc0 sc0 ls0 ws0"> * This class Generates prime numbers up to a user specified</div><div class="t m5 x74 h2f y8bc ffb fs10 fc0 sc0 ls0 ws0"> * maximum.  The algorithm used is the Sieve of Eratosthenes.</div><div class="t m5 x74 h2f y8bd ffb fs10 fc0 sc0 ls0 ws0"> * Given an array of integers starting at 2:</div><div class="t m5 x74 h2f y8be ffb fs10 fc0 sc0 ls0 ws0"> * Find the first uncrossed integer, and cross out all its</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">GeneratePrimes.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf68" class="pf w1 h2" data-page-no="68"><div class="pc pc68 w1 h2"><img class="bi xd y8bf wc h52" alt="" src="bg68.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">73<span class="_ _10"></span><span class="ff1">Bad Comments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0"> * multiples.  Repeat until there are no more multiples</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0"> * in the array.</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0"> */</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">public class PrimeGenerator</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  private static boolean[] crossedOut;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  private static int[] result;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  public static int[] generatePrimes(int maxValue)</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    if (maxValue &lt; 2)</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      return new int[0];</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      uncrossIntegersUpTo(maxValue);</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      crossOutMultiples();</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      putUncrossedIntegersIntoResult();</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      return result;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8a9 ffb fs10 fc0 sc0 ls0 ws0">  private static void uncrossIntegersUpTo(int maxValue)</div><div class="t m5 x74 h2f y8aa ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y8ab ffb fs10 fc0 sc0 ls0 ws0">    crossedOut = new boolean[maxValue + 1];</div><div class="t m5 x74 h2f y8c0 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 2; i &lt; crossedOut.length; i++)</div><div class="t m5 x74 h2f y8ac ffb fs10 fc0 sc0 ls0 ws0">      crossedOut[i] = false;</div><div class="t m5 x74 h2f y8c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8ae ffb fs10 fc0 sc0 ls0 ws0">  private static void crossOutMultiples()</div><div class="t m5 x74 h2f y8af ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y8b0 ffb fs10 fc0 sc0 ls0 ws0">    int limit = determineIterationLimit();</div><div class="t m5 x74 h2f y8b1 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 2; i &lt;= limit; i++)</div><div class="t m5 x74 h2f y8b2 ffb fs10 fc0 sc0 ls0 ws0">      if (notCrossed(i))</div><div class="t m5 x74 h2f y8c2 ffb fs10 fc0 sc0 ls0 ws0">        crossOutMultiplesOf(i);</div><div class="t m5 x74 h2f y8b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8b5 ffb fs10 fc0 sc0 ls0 ws0">  private static int determineIterationLimit()</div><div class="t m5 x74 h2f y8b6 ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y8b7 ffb fs10 fc0 sc0 ls0 ws0">    // Every multiple in the array has a prime factor that</div><div class="t m5 x74 h2f y8b8 ffb fs10 fc0 sc0 ls0 ws0">    // is less than or equal to the root of the array size,</div><div class="t m5 x74 h2f y8c3 ffb fs10 fc0 sc0 ls0 ws0">    // so we don&apos;t have to cross out multiples of numbers</div><div class="t m5 x74 h2f y8c4 ffb fs10 fc0 sc0 ls0 ws0">    // larger than that root.</div><div class="t m5 x74 h2f y8c5 ffb fs10 fc0 sc0 ls0 ws0">    double iterationLimit = Math.sqrt(crossedOut.length);</div><div class="t m5 x74 h2f y8c6 ffb fs10 fc0 sc0 ls0 ws0">    return (int) iterationLimit;</div><div class="t m5 x74 h2f y8c7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8c8 ffb fs10 fc0 sc0 ls0 ws0">  private static void crossOutMultiplesOf(int i)</div><div class="t m5 x74 h2f y8c9 ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y8ca ffb fs10 fc0 sc0 ls0 ws0">    for (int multiple = 2*i;</div><div class="t m5 x74 h2f y8cb ffb fs10 fc0 sc0 ls0 ws0">         multiple &lt; crossedOut.length;</div><div class="t m5 x74 h2f y8cc ffb fs10 fc0 sc0 ls0 ws0">         multiple += i)</div><div class="t m5 x74 h2f y8cd ffb fs10 fc0 sc0 ls0 ws0">      crossedOut[multiple] = true;</div><div class="t m5 x74 h2f y8ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">PrimeGenerator.java (refactored)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf69" class="pf w1 h2" data-page-no="69"><div class="pc pc69 w1 h2"><img class="bi xd y8cf wc h53" alt="" src="bg69.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">74<span class="_ _22"> </span><span class="ff1 wsa0">Chapter 4:<span class="_ _4"></span> Comments</span></div><div class="t m0 x74 h14 y32f ff8 fs3 fc0 sc0 ls0 ws266">It is easy to argue that the ﬁrst comment is redundant because it reads v<span class="_ _4"></span>er<span class="_ _8"></span>y much like</div><div class="t m0 xd h14 y330 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y330 ffb fs10 fc0 sc0 ls0 ws0">generatePrimes</div><div class="t m0 x4d h14 y330 ff8 fs3 fc0 sc0 ls0 ws33d">function itself. Still, I think the comment serves to ease the reader into</div><div class="t m0 xd h14 y331 ff8 fs3 fc0 sc0 ls0 ws0">the algorithm, so I’m inclined to lea<span class="_ _4"></span>ve it.</div><div class="t m0 x74 h14 y332 ff8 fs3 fc0 sc0 ls0 ws44b">The second argument is almost certainly necessary<span class="_ _0"></span>. It explains the rationale behind</div><div class="t m0 xd h14 y333 ff8 fs3 fc0 sc0 ls0 ws307">the use of the square root as the loop limit. I could ﬁnd no simple variab<span class="_ _4"></span>le name, nor an<span class="_ _4"></span>y</div><div class="t m0 xd h14 y334 ff8 fs3 fc0 sc0 ls0 ws44c">dif<span class="_ _4"></span>ferent coding str<span class="_ _8"></span>ucture that made this point clear<span class="_ _4"></span>. On the other hand<span class="_ _1"></span>, the use of the</div><div class="t m0 xd h14 y335 ff8 fs3 fc0 sc0 ls0 ws44d">square root might be a conceit. <span class="_ _1"></span>Am I really sa<span class="_ _4"></span>ving that much time by limiting the iteration</div><div class="t m0 xd h14 y8d0 ff8 fs3 fc0 sc0 ls10 ws0">to the square root? Could the calculation of the square root take more time than I’m sa<span class="_ _4"></span>ving? </div><div class="t m0 x74 h14 y7de ff8 fs3 fc0 sc0 ls0 ws343">It’<span class="_ _2"></span>s w<span class="_ _4"></span>or<span class="_ _8"></span>th thinking about. Using the square root as the iteration limit satisﬁes the old C</div><div class="t m0 xd h14 y7df ff8 fs3 fc0 sc0 lsd ws140">and assembl<span class="_ _4"></span>y language hacker in me, but I’m not con<span class="_ _1"></span>vinced it’<span class="_ _2"></span>s worth the time and effort</div><div class="t m0 xd h14 y8d1 ff8 fs3 fc0 sc0 ls0 ws0">that e<span class="_ _4"></span>veryone else will expend to understand it.</div><div class="t m0 xd h17 y8d2 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y45b ff1 fs3 fc0 sc0 ls0 wsa0">[KP78]:<span class="_ _4"></span>  <span class="ff8 ws2de">Kernighan and Plaugher<span class="_ _4"></span>, <span class="_ _1"></span><span class="ffa">The Elements of Pro<span class="_ _4"></span>gr<span class="_ _4"></span>amming Style<span class="ff8">, 2d. ed., McGra<span class="_ _4"></span>w-</span></span></span></div><div class="t m0 xd h14 y45c ff8 fs3 fc0 sc0 ls0 ws0">Hill, 1978.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private static boolean notCrossed(int i)</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    return crossedOut[i] == false;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  private static void putUncrossedIntegersIntoResult()</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    result = new int[numberOfUncrossedIntegers()];</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    for (int j = 0, i = 2; i &lt; crossedOut.length; i++)</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      if (notCrossed(i))</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">        result[j++] = i;</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  private static int numberOfUncrossedIntegers()</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    int count = 0;</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 2; i &lt; crossedOut.length; i++)</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      if (notCrossed(i))</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">        count++;</div><div class="t m5 x74 h2f y8a7 ffb fs10 fc0 sc0 ls0 ws0">    return count;</div><div class="t m5 x74 h2f y8a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y8a9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 4-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">PrimeGenerator.java (refactored)</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:174.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6a" class="pf w1 h2" data-page-no="6a"><div class="pc pc6a w1 h2"><img class="bi xd y8d3 w4 h54" alt="" src="bg6a.png"/><div class="t m0 x16 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">75</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">5</div><div class="t m0 x6a h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">F<span class="_ _2"></span>ormatting</div><div class="t m0 xd h14 y8d4 ff8 fs3 fc0 sc0 ls12 wsf9">When people look under the hood<span class="_ _1"></span>, we w<span class="_ _4"></span>ant them to be impressed with the neatness, con-</div><div class="t m0 xd h14 y8d5 ff8 fs3 fc0 sc0 ls12 ws44e">sistency<span class="_ _0"></span>, and attention to detail that they percei<span class="_ _4"></span>ve. <span class="_ _4"></span>W<span class="_ _0"></span>e want them to be struck by the</div><div class="t m0 xd h14 y8d6 ff8 fs3 fc0 sc0 ls12 ws44f">orderliness. <span class="_ _4"></span>W<span class="_ _0"></span>e want their ey<span class="_ _4"></span>ebro<span class="_ _4"></span>ws to rise as they scroll through the modules. <span class="_ _4"></span>W<span class="_ _0"></span>e want</div><div class="t m0 xd h14 y8d7 ff8 fs3 fc0 sc0 ls12 ws335">them to percei<span class="_ _4"></span>ve that professionals ha<span class="_ _4"></span>ve been at w<span class="_ _4"></span>ork. If instead they see a scramb<span class="_ _4"></span>led</div><div class="t m0 xd h14 y8d8 ff8 fs3 fc0 sc0 ls12 ws450">mass of code that looks like it w<span class="_ _4"></span>as written by a be<span class="_ _4"></span>vy of drunken sailors, then they are</div><div class="t m0 xd h14 y8d9 ff8 fs3 fc0 sc0 ls12 ws1f4">likel<span class="_ _4"></span>y to conclude that the same inattention to detail per<span class="_ _8"></span>vades e<span class="_ _4"></span>very other aspect of the</div><div class="t m0 xd h14 y8da ff8 fs3 fc0 sc0 ls12 ws0">project.</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:323.056000px;bottom:440.027010px;width:115.876000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6b" class="pf w1 h2" data-page-no="6b"><div class="pc pc6b w1 h2"><img class="bi x37 y8db w8 h27" alt="" src="bg6b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">76<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls16 ws451">Y<span class="_ _3"></span>ou should take care that your code is nicel<span class="_ _4"></span>y for<span class="_ _8"></span>matted. <span class="_ _0"></span>Y<span class="_ _2"></span>ou should choose a set of</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws2da">simple rules that gov<span class="_ _4"></span>ern the for<span class="_ _8"></span>mat of your code, and then you should consistentl<span class="_ _4"></span>y appl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls16 ws452">those rules. If you are w<span class="_ _4"></span>orking on a team, then the team should agree to a single set of</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls16 ws301">formatting r<span class="_ _8"></span>ules and all members should comply<span class="_ _0"></span>. It helps to ha<span class="_ _4"></span>ve an automated tool that</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls16 ws0">can apply those formatting rules for you.</div><div class="t m0 xd h17 y8dc ff1 fs9 fc0 sc0 ls0 ws0">The Purpose of F<span class="_ _0"></span>ormatting</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls12 wse0">First of all, let’<span class="_ _3"></span>s be clear<span class="_ _4"></span>. Code for<span class="_ _8"></span>matting is <span class="ffa ws0">important</span>. It is too important to ignore and</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls12 ws453">it is too important to treat religiously<span class="_ _0"></span>. Code for<span class="_ _8"></span>matting is about communication, and</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls12 wsef">communication is the professional de<span class="_ _4"></span>veloper’<span class="_ _2"></span>s ﬁrst order of business. </div><div class="t m0 x74 h14 y3b7 ff8 fs3 fc0 sc0 ls32 ws454">P<span class="_ _4"></span>erhaps you thought that “getting it w<span class="_ _1"></span>orking” was the ﬁrst order of business for a</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls32 ws81">professional de<span class="_ _4"></span>veloper<span class="_ _1"></span>. I hope by no<span class="_ _4"></span>w<span class="_ _0"></span>, ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, that this book has disabused you of that</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls16 ws455">idea. <span class="_ _1"></span>The functionality that you create toda<span class="_ _4"></span>y has a good chance of changing in the next</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls32 ws456">release, but the readability of your code will ha<span class="_ _1"></span>ve a profound effect on all the changes</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls16 ws457">that will e<span class="_ _4"></span>ver be made. <span class="_ _4"></span>The coding style and readability set precedents that continue to</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls16 ws458">af<span class="_ _4"></span>fect maintainability and extensibility long after the original code has been changed</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls16 ws0">bey<span class="_ _4"></span>ond recognition. <span class="_ _0"></span>Y<span class="_ _3"></span>our style and discipline sur<span class="_ _8"></span>viv<span class="_ _4"></span>es, ev<span class="_ _4"></span>en though your code does not.</div><div class="t m0 x74 h14 y25a ff8 fs3 fc0 sc0 ls0 ws0">So what are the formatting issues that help us to communicate best?</div><div class="t m0 xd h17 y8dd ff1 fs9 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>ertical F<span class="_ _1"></span>ormatting</div><div class="t m0 xd h14 y2c7 ff8 fs3 fc0 sc0 ls0 ws459">Let’<span class="_ _2"></span>s start with ver<span class="_ _8"></span>tical size. Ho<span class="_ _4"></span>w big should a source ﬁle be? In Ja<span class="_ _4"></span>va, ﬁle size is closel<span class="_ _4"></span>y</div><div class="t m0 xd h14 y2c8 ff8 fs3 fc0 sc0 ls0 ws45a">related to class size. <span class="_ _4"></span>W<span class="_ _0"></span>e’ll talk about class size w<span class="_ _4"></span>hen w<span class="_ _4"></span>e talk about classes. F<span class="_ _4"></span>or the</div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">moment let’<span class="_ _2"></span>s just consider ﬁle size.</div><div class="t m0 x74 h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws45b">Ho<span class="_ _4"></span>w big are most Ja<span class="_ _4"></span>va source ﬁles? It turns out that there is a huge range of sizes and</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws0">some remarkable dif<span class="_ _4"></span>ferences in style. Figure 5-1 sho<span class="_ _1"></span>ws some of those differences. </div><div class="t m0 x74 h14 y671 ff8 fs3 fc0 sc0 ls12 ws3b3">Sev<span class="_ _4"></span>en different projects are depicted. Junit, F<span class="_ _4"></span>itNesse, testNG, T<span class="_ _4"></span>ime and Money<span class="_ _0"></span>,</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls12 ws45c">JDepend<span class="_ _1"></span>, Ant, and T<span class="_ _1"></span>omcat. <span class="_ _4"></span>The lines through the box<span class="_ _4"></span>es sho<span class="_ _4"></span>w the minimum and maxi-</div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls12 ws153">mum ﬁle lengths in each project. <span class="_ _1"></span>The box sho<span class="_ _4"></span>ws approximatel<span class="_ _4"></span>y one-third (one standard</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls12 ws0">de<span class="_ _4"></span>viation</div><div class="t m0 x8a h21 y393 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x80 h14 y8de ff8 fs3 fc0 sc0 ls12 ws9d">) of the ﬁles. <span class="_ _1"></span>The middle of the box is the mean. So the a<span class="_ _4"></span>verage ﬁle size in the</div><div class="t m0 xd h14 y8df ff8 fs3 fc0 sc0 ls12 ws188">FitNesse project is about 65 lines, and about one-third of the ﬁles are betw<span class="_ _1"></span>een 40 and</div><div class="t m0 xd h14 y7fb ff8 fs3 fc0 sc0 ls12 ws45d">100+ lines. <span class="_ _1"></span>The largest ﬁle in FitNesse is about 400 lines and the smallest is 6 lines.</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 ls12 ws45e">Note that this is a lo<span class="_ _4"></span>g scale, so the small difference in vertical position implies a very</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls12 ws0">large dif<span class="_ _4"></span>ference in absolute size.</div><div class="t m0 xd h25 y8e2 ff8 fse fc0 sc0 ls0 ws45f">1.<span class="_ _17"> </span>The bo<span class="_ _4"></span>x shows sigma/2 abo<span class="_ _1"></span>ve and below the mean. <span class="_ _0"></span>Y<span class="_ _0"></span>es, I know that the ﬁle length distribution is not normal, and so the stan-</div><div class="t m0 x3b h25 y8e3 ff8 fse fc0 sc0 ls0 ws0">dard deviation is not mathematicall<span class="_ _4"></span>y precise. But we’<span class="_ _1"></span>re not trying for precision here. W<span class="_ _1"></span>e’<span class="_ _1"></span>re just tr<span class="_ _8"></span>ying to get a feel.</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:502.945010px;width:161.956000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:320.945010px;width:117.615000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6c" class="pf w1 h2" data-page-no="6c"><div class="pc pc6c w1 h2"><img class="bi x2c y8e4 w10 h55" alt="" src="bg6c.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">77<span class="_ _10"></span><span class="ff1">V<span class="_ _2"></span>ertical F<span class="_ _4"></span>ormatting</span></div><div class="t m0 x74 h14 y8e5 ff8 fs3 fc0 sc0 ls16 ws460">Junit, FitNesse, and <span class="_ _1"></span>T<span class="_ _4"></span>ime and Money are composed of relati<span class="_ _4"></span>vely small ﬁles. None</div><div class="t m0 xd h14 y8e6 ff8 fs3 fc0 sc0 ls16 ws38f">are o<span class="_ _4"></span>ver 500 lines and most of those ﬁles are less than 200 lines. <span class="_ _1"></span>T<span class="_ _1"></span>omcat and <span class="_ _1"></span>Ant, on the</div><div class="t m0 xd h14 y8e7 ff8 fs3 fc0 sc0 ls16 ws23c">other hand<span class="_ _1"></span>, hav<span class="_ _4"></span>e some ﬁles that are sev<span class="_ _4"></span>eral thousand lines long and close to half are o<span class="_ _4"></span>ver</div><div class="t m0 xd h14 y8e8 ff8 fs3 fc0 sc0 ls16 ws0">200 lines. </div><div class="t m0 x74 h14 y8e9 ff8 fs3 fc0 sc0 ls4a ws461">What does that mean to us? It appears to be possible to build signiﬁcant systems</div><div class="t m0 xd h14 y8ea ff8 fs3 fc0 sc0 ls4b ws191">(FitNesse is close to 50,000 lines) out of ﬁles that are typicall<span class="_ _4"></span>y 200 lines long, with an</div><div class="t m0 xd h14 y8eb ff8 fs3 fc0 sc0 ls17 ws336">upper limit of 500. <span class="_ _1"></span>Although this should not be a hard and f<span class="_ _8"></span>ast rule, it should be considered</div><div class="t m0 xd h14 y8ec ff8 fs3 fc0 sc0 ls4b ws0">very desirable. Small ﬁles are usuall<span class="_ _4"></span>y easier to understand than large ﬁles are.</div><div class="t m0 xd h11 y8ed ff1 fs7 fc0 sc0 ls0 ws0">The Ne<span class="_ _4"></span>wspaper Metaphor</div><div class="t m0 xd h14 y8ee ff8 fs3 fc0 sc0 ls0 ws462">Think of a w<span class="_ _4"></span>ell-written newspaper article. <span class="_ _0"></span>Y<span class="_ _2"></span>ou read it vertically<span class="_ _0"></span>. <span class="_ _1"></span>At the top you expect a</div><div class="t m0 xd h14 y8ef ff8 fs3 fc0 sc0 ls0 ws463">headline that will tell you w<span class="_ _4"></span>hat the story is about and allows y<span class="_ _4"></span>ou to decide whether it is</div><div class="t m0 xd h14 y8f0 ff8 fs3 fc0 sc0 ls0 ws464">something you w<span class="_ _4"></span>ant to read. <span class="_ _1"></span>The ﬁrst parag<span class="_ _8"></span>raph gives y<span class="_ _4"></span>ou a synopsis of the whole story<span class="_ _0"></span>,</div><div class="t m0 xd h14 y8f1 ff8 fs3 fc0 sc0 ls0 ws465">hiding all the details while gi<span class="_ _4"></span>ving you the broad-brush concepts. <span class="_ _1"></span>As you continue do<span class="_ _4"></span>wn-</div><div class="t m0 xd h14 y8f2 ff8 fs3 fc0 sc0 ls0 ws466">w<span class="_ _4"></span>ard<span class="_ _4"></span>, the details increase until you ha<span class="_ _1"></span>ve all the dates, names, quotes, claims, and other</div><div class="t m0 xd h14 y8f3 ff8 fs3 fc0 sc0 ls0 ws0">minutia.</div><div class="t m0 x74 h14 y8f4 ff8 fs3 fc0 sc0 ls0 ws3a7">W<span class="_ _0"></span>e w<span class="_ _4"></span>ould like a source ﬁle to be like a ne<span class="_ _4"></span>wspaper article. <span class="_ _4"></span>The name should be simple</div><div class="t m0 xd h14 y8f5 ff8 fs3 fc0 sc0 ls32 ws36e">but explanatory<span class="_ _0"></span>. <span class="_ _4"></span>The name, by itself, should be suf<span class="_ _4"></span>ﬁcient to tell us whether w<span class="_ _4"></span>e are in the</div><div class="t m0 xd h14 y8f6 ff8 fs3 fc0 sc0 ls16 ws59">right module or not. <span class="_ _1"></span>The topmost par<span class="_ _8"></span>ts of the source ﬁle should pro<span class="_ _4"></span>vide the high-level</div><div class="t m0 x33 h1c y8f7 ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 5-1</div><div class="t m0 x3a h14 y8f8 ff8 fs3 fc0 sc0 lsd wsef">File length distributions LOG scale (bo<span class="_ _4"></span>x height = sigma)</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:224.932010px;width:134.351000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6d" class="pf w1 h2" data-page-no="6d"><div class="pc pc6d w1 h2"><img class="bi xd y8f9 wc h56" alt="" src="bg6d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">78<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws32b">concepts and algorithms. Detail should increase as w<span class="_ _4"></span>e mo<span class="_ _4"></span>ve do<span class="_ _4"></span>wnw<span class="_ _4"></span>ard<span class="_ _4"></span>, until at the end</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws0">w<span class="_ _4"></span>e ﬁnd the lo<span class="_ _4"></span>west le<span class="_ _4"></span>vel functions and details in the source ﬁle.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws288">A newspaper is composed of man<span class="_ _1"></span>y ar<span class="_ _8"></span>ticles; most are very small. Some are a bit larger<span class="_ _1"></span>.</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws30">V<span class="_ _0"></span>ery few contain as much te<span class="_ _4"></span>xt as a page can hold. <span class="_ _4"></span>This makes the ne<span class="_ _4"></span>wspaper <span class="ffa ws0">usab<span class="_ _4"></span>le<span class="ff8 ws30">. If the</span></span></div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 lsc ws467">ne<span class="_ _4"></span>wspaper were just one long story containing a disorganized agglomeration of facts,</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">dates, and names, then w<span class="_ _4"></span>e simply w<span class="_ _1"></span>ould not read it.</div><div class="t m0 xd h11 y8fa ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>er<span class="_ _8"></span>tical Openness Between Concepts</div><div class="t m0 xd h14 y2aa ff8 fs3 fc0 sc0 ls0 ws3e">Nearly all code is read left to right and top to bottom. Each line represents an e<span class="_ _4"></span>xpression or</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws3f3">a clause, and each group of lines represents a complete thought. <span class="_ _4"></span>Those thoughts should be</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws0">separated from each other with blank lines. </div><div class="t m0 x74 h14 y2ad ff8 fs3 fc0 sc0 ls0 ws249">Consider<span class="_ _4"></span>, for example, Listing 5-1. <span class="_ _1"></span>There are blank lines that separate the package</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws468">declaration, the import(s), and each of the functions. <span class="_ _4"></span>This extremel<span class="_ _4"></span>y simple r<span class="_ _8"></span>ule has a pro-</div><div class="t m0 xd h14 y2af ff8 fs3 fc0 sc0 ls0 wsf5">found effect on the visual la<span class="_ _1"></span>yout of the code. Each b<span class="_ _4"></span>lank line is a visual cue that identiﬁes</div><div class="t m0 xd h14 y8fb ff8 fs3 fc0 sc0 ls0 ws128">a new and separate concept. <span class="_ _0"></span>As you scan do<span class="_ _4"></span>wn the listing, your e<span class="_ _4"></span>ye is dra<span class="_ _4"></span>wn to the ﬁrst</div><div class="t m0 xd h14 y8fc ff8 fs3 fc0 sc0 ls0 ws0">line that follo<span class="_ _4"></span>ws a blank line.</div><div class="t m0 xd h14 y8fd ff8 fs3 fc0 sc0 ls0 ws469">T<span class="_ _0"></span>aking those blank lines out, as in Listing 5-2, has a remarkabl<span class="_ _4"></span>y obscuring effect on the</div><div class="t m0 xd h14 y8fe ff8 fs3 fc0 sc0 ls0 ws0">readability of the code.</div><div class="t m0 x74 h1c y8ff ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-1 </div><div class="t m0 x74 h36 y900 ffc fs3 fc0 sc0 ls0 ws0">BoldWidget.java</div><div class="t m5 x74 h2f y901 ffb fs10 fc0 sc0 ls0 ws0">package fitnesse.wikitext.widgets;</div><div class="t m5 x74 h2f y902 ffb fs10 fc0 sc0 ls0 ws0">import java.util.regex.*;</div><div class="t m5 x74 h2f y903 ffb fs10 fc0 sc0 ls0 ws0">public class BoldWidget extends ParentWidget {</div><div class="t m5 x74 h2f y904 ffb fs10 fc0 sc0 ls0 ws0">  public static final String REGEXP = &quot;&apos;&apos;&apos;.+?&apos;&apos;&apos;&quot;;</div><div class="t m5 x74 h2f y905 ffb fs10 fc0 sc0 ls0 ws0">  private static final Pattern pattern = Pattern.compile(&quot;&apos;&apos;&apos;(.+?)&apos;&apos;&apos;&quot;,</div><div class="t m5 x74 h2f y906 ffb fs10 fc0 sc0 ls0 ws0">    Pattern.MULTILINE + Pattern.DOTALL</div><div class="t m5 x74 h2f y907 ffb fs10 fc0 sc0 ls0 ws0">  );</div><div class="t m5 x74 h2f y908 ffb fs10 fc0 sc0 ls0 ws0">  public BoldWidget(ParentWidget parent, String text) throws Exception {</div><div class="t m5 x74 h2f y909 ffb fs10 fc0 sc0 ls1a ws2f6">    super(parent);</div><div class="t m5 x74 h2f y90a ffb fs10 fc0 sc0 ls0 ws0">    Matcher match = pattern.matcher(text);</div><div class="t m5 x74 h2f y90b ffb fs10 fc0 sc0 ls0 ws0">    match.find();</div><div class="t m5 x74 h2f y90c ffb fs10 fc0 sc0 ls0 ws0">    addChildWidgets(match.group(1));</div><div class="t m5 x74 h2f y90d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y90e ffb fs10 fc0 sc0 ls0 ws0">  public String render() throws Exception {</div><div class="t m5 x74 h2f y90f ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer html = new StringBuffer(&quot;&lt;b&gt;&quot;);</div><div class="t m5 x74 h2f y910 ffb fs10 fc0 sc0 ls0 ws0">    html.append(childHtml()).append(&quot;&lt;/b&gt;&quot;);</div><div class="t m5 x74 h2f y911 ffb fs10 fc0 sc0 ls0 ws0">    return html.toString();</div><div class="t m5 x74 h2f y912 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y913 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:495.728010px;width:188.566000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6e" class="pf w1 h2" data-page-no="6e"><div class="pc pc6e w1 h2"><img class="bi xd y586 wc h57" alt="" src="bg6e.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">79<span class="_ _10"></span><span class="ff1">V<span class="_ _2"></span>ertical F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd h14 y914 ff8 fs3 fc0 sc0 ls12 ws46a">This effect is e<span class="_ _1"></span>ven more pronounced when y<span class="_ _4"></span>ou unfocus your ey<span class="_ _4"></span>es. In the ﬁrst example</div><div class="t m0 xd h14 y915 ff8 fs3 fc0 sc0 ls12 ws46b">the different groupings of lines pop out at you, w<span class="_ _4"></span>hereas the second example looks lik<span class="_ _4"></span>e a</div><div class="t m0 xd h14 y916 ff8 fs3 fc0 sc0 ls12 ws0">muddle. <span class="_ _1"></span>The difference betw<span class="_ _4"></span>een these tw<span class="_ _4"></span>o listings is a bit of vertical openness.</div><div class="t m0 xd h11 y917 ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>er<span class="_ _8"></span>tical Density</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls12 ws222">If openness separates concepts, then vertical density implies close association. So lines</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls12 ws46c">of code that are tightl<span class="_ _4"></span>y related should appear vertically dense. Notice ho<span class="_ _4"></span>w the useless</div><div class="t m0 xd h14 y57c ff8 fs3 fc0 sc0 ls12 ws0">comments in Listing 5-3 break the close association of the tw<span class="_ _4"></span>o instance variab<span class="_ _4"></span>les.  </div><div class="t m0 x74 h14 y918 ff8 fs3 fc0 sc0 ls0 ws46d">Listing 5-4 is much easier to read. It ﬁts in an “ey<span class="_ _4"></span>e-full,<span class="_ _1"></span>” or at least it does for me. I</div><div class="t m0 xd h14 y919 ff8 fs3 fc0 sc0 ls0 ws2e5">can look at it and see that this is a class with tw<span class="_ _4"></span>o variab<span class="_ _4"></span>les and a method<span class="_ _1"></span>, without having to</div><div class="t m0 xd h14 y91a ff8 fs3 fc0 sc0 ls0 ws365">mo<span class="_ _4"></span>ve m<span class="_ _1"></span>y head or eyes much. <span class="_ _1"></span>The previous listing forces me to use much more e<span class="_ _4"></span>ye and</div><div class="t m0 xd h14 y91b ff8 fs3 fc0 sc0 ls0 ws0">head motion to achie<span class="_ _4"></span>ve the same lev<span class="_ _4"></span>el of comprehension. </div><div class="t m0 x74 h1c y5ad ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-2 </div><div class="t m0 x74 h36 y5ae ffc fs3 fc0 sc0 ls0 ws0">BoldWidget.java</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">package fitnesse.wikitext.widgets;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">import java.util.regex.*;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">public class BoldWidget extends ParentWidget {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  public static final String REGEXP = &quot;&apos;&apos;&apos;.+?&apos;&apos;&apos;&quot;;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private static final Pattern pattern = Pattern.compile(&quot;&apos;&apos;&apos;(.+?)&apos;&apos;&apos;&quot;,</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    Pattern.MULTILINE + Pattern.DOTALL);</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  public BoldWidget(ParentWidget parent, String text) throws Exception {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    super(parent);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    Matcher match = pattern.matcher(text);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    match.find();</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    addChildWidgets(match.group(1));}</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public String render() throws Exception {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer html = new StringBuffer(&quot;&lt;b&gt;&quot;);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    html.append(childHtml()).append(&quot;&lt;/b&gt;&quot;);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    return html.toString();</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y91c ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-3 </div><div class="t m5 x74 h2f y91d ffb fs10 fc0 sc0 ls0 ws0">public class ReporterConfig {</div><div class="t m5 x74 h2f y91e ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y91f ffb fs10 fc0 sc0 ls0 ws0">   * The class name of the reporter listener</div><div class="t m5 x74 h2f y920 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y921 ffb fs10 fc0 sc0 ls0 ws0">  private String m_className;</div><div class="t m5 x74 h2f y922 ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y923 ffb fs10 fc0 sc0 ls0 ws0">   * The properties of the reporter listener</div><div class="t m5 x74 h2f y924 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y925 ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;Property&gt; m_properties = new ArrayList&lt;Property&gt;();</div><div class="t m5 x74 h2f y926 ffb fs10 fc0 sc0 ls0 ws0">  public void addProperty(Property property) {</div><div class="t m5 x74 h2f y927 ffb fs10 fc0 sc0 ls0 ws0">    m_properties.add(property);</div><div class="t m5 x74 h2f y928 ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:340.728010px;width:81.539000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf6f" class="pf w1 h2" data-page-no="6f"><div class="pc pc6f w1 h2"><img class="bi xd y929 wc h58" alt="" src="bg6f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">80<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd h11 y92a ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>er<span class="_ _8"></span>tical Distance</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws14d">Ha<span class="_ _4"></span>ve y<span class="_ _4"></span>ou ever chased y<span class="_ _4"></span>our tail through a class, hopping from one function to the next,</div><div class="t m0 xd h14 y92b ff8 fs3 fc0 sc0 ls29 ws46e">scrolling up and do<span class="_ _4"></span>wn the source ﬁle, trying to divine ho<span class="_ _4"></span>w the functions relate and</div><div class="t m0 xd h14 y209 ff8 fs3 fc0 sc0 ls0 ws2fc">operate, onl<span class="_ _4"></span>y to get lost in a rat’<span class="_ _2"></span>s nest of confusion? Hav<span class="_ _4"></span>e you e<span class="_ _4"></span>ver hunted up the chain of</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws44">inheritance for the deﬁnition of a v<span class="_ _4"></span>ariable or function? <span class="_ _1"></span>This is fr<span class="_ _8"></span>ustrating because you are</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 ls0 ws2e0">trying to understand <span class="ffa ws0">what<span class="_ _15"> </span></span><span class="lsd ws46f">the system does, but y<span class="_ _4"></span>ou are spending your time and mental</span></div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws0">energy on trying to locate and remember <span class="ffa">wher<span class="_ _1"></span>e<span class="ff8"> the pieces are.</span></span></div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws99">Concepts that are closel<span class="_ _4"></span>y related should be kept vertically close to each other [G10].</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws259">Clearly this rule doesn’<span class="_ _1"></span>t work for concepts that belong in separate ﬁles. But then closel<span class="_ _4"></span>y</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws470">related concepts should not be separated into different ﬁles unless y<span class="_ _4"></span>ou ha<span class="_ _4"></span>ve a very good</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">reason. Indeed<span class="_ _1"></span>, this is one of the reasons that protected variab<span class="_ _4"></span>les should be av<span class="_ _4"></span>oided. </div><div class="t m0 x74 h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws214">F<span class="_ _1"></span>or those concepts that are so closely related that they belong in the same source ﬁle,</div><div class="t m0 xd h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws74">their vertical separation should be a measure of ho<span class="_ _4"></span>w impor<span class="_ _8"></span>tant each is to the understand-</div><div class="t m0 xd h14 y1e6 ff8 fs3 fc0 sc0 ls0 ws35f">ability of the other<span class="_ _1"></span>. W<span class="_ _0"></span>e w<span class="_ _4"></span>ant to a<span class="_ _4"></span>void forcing our readers to hop around through our source</div><div class="t m0 xd h14 y1e7 ff8 fs3 fc0 sc0 ls0 ws0">ﬁles and classes.</div><div class="t m0 xd hd y1e9 ffe fs3 fc0 sc0 ls0 ws0">V<span class="_ _4"></span>ariable Declarations. <span class="ff8 ls16 ws471">V<span class="_ _2"></span>ariables should be declared as close to their usage as possi-</span></div><div class="t m0 xd h14 y1ea ff8 fs3 fc0 sc0 ls16 ws276">ble. Because our functions are v<span class="_ _4"></span>er<span class="_ _8"></span>y short, local variables should appear a<span class="ff10">t</span> the top of each</div><div class="t m0 xd h14 y1eb ff8 fs3 fc0 sc0 ls16 ws0">function, as in this longish function from Junit4.3.1. </div><div class="t m5 x52 h2f y92c ffb fs10 fc0 sc0 ls0 ws0">private static void readPreferences() {</div><div class="t m5 x8a h46 y92d ffc fs10 fc0 sc0 ls0 ws0">InputStream is= null;</div><div class="t m5 x8a h2f y92e ffb fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x6c h2f y92f ffb fs10 fc0 sc0 ls0 ws0">is= new FileInputStream(getPreferencesFile());</div><div class="t m5 x6c h2f y930 ffb fs10 fc0 sc0 ls0 ws0">setPreferences(new Properties(getPreferences()));</div><div class="t m5 x6c h2f y931 ffb fs10 fc0 sc0 ls0 ws0">getPreferences().load(is);</div><div class="t m5 x8a h2f y932 ffb fs10 fc0 sc0 ls0 ws0">} catch (IOException e) {</div><div class="t m5 x6c h2f y933 ffb fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x86 h2f y934 ffb fs10 fc0 sc0 ls0 ws0">if (is != null)</div><div class="t m5 xbc h2f y935 ffb fs10 fc0 sc0 ls0 ws0">is.close();</div><div class="t m5 x6c h2f y936 ffb fs10 fc0 sc0 ls0 ws0">} catch (IOException e1) {</div><div class="t m5 x6c h2f y937 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y938 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y939 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls0 ws167">Control variab<span class="_ _4"></span>les for loops should usuall<span class="_ _4"></span>y be declared within the loop statement, as in this</div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 ls0 ws0">cute little function from the same source.</div><div class="t m0 x74 h1c y93a ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-4 </div><div class="t m5 x74 h2f y93b ffb fs10 fc0 sc0 ls0 ws0">public class ReporterConfig {</div><div class="t m5 x74 h2f y93c ffb fs10 fc0 sc0 ls0 ws0">  private String m_className;</div><div class="t m5 x74 h2f y93d ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;Property&gt; m_properties = new ArrayList&lt;Property&gt;();</div><div class="t m5 x74 h2f y93e ffb fs10 fc0 sc0 ls0 ws0">  public void addProperty(Property property) {</div><div class="t m5 x74 h2f y93f ffb fs10 fc0 sc0 ls0 ws0">    m_properties.add(property);</div><div class="t m5 x74 h2f y940 ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:487.728010px;width:86.866000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf70" class="pf w1 h2" data-page-no="70"><div class="pc pc70 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">81<span class="_ _10"></span><span class="ff1">V<span class="_ _2"></span>ertical F<span class="_ _4"></span>ormatting</span></div><div class="t m5 x52 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public int countTestCases() {</div><div class="t m5 x8a h2f y627 ffb fs10 fc0 sc0 ls0 ws0">int count= 0;</div><div class="t m5 x8a h2f y628 ffb fs10 fc0 sc0 ls0 ws0">for (<span class="ffc">Test each</span> : tests)</div><div class="t m5 x6c h2f y629 ffb fs10 fc0 sc0 ls0 ws0">count += each.countTestCases();</div><div class="t m5 x8a h2f y62a ffb fs10 fc0 sc0 ls0 ws0">return count;</div><div class="t m5 x52 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws472">In rare cases a v<span class="_ _4"></span>ariable might be declared at the top of a block or just before a loop in a</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws473">long-ish function. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can see such a v<span class="_ _4"></span>ariable in this snippet from the midst of a very long</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">function in T<span class="_ _0"></span>estNG.</div><div class="t m5 x74 h2f y941 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y942 ffb fs10 fc0 sc0 ls0 ws0">for (XmlTest test : m_suite.getTests()) {</div><div class="t m5 x5f h46 y943 ffc fs10 fc0 sc0 ls0 ws0">TestRunner tr = m_runnerFactory.newTestRunner(this, test);</div><div class="t m5 x74 h2f y944 ffb fs10 fc0 sc0 ls1f ws3b8">      tr.addListener(m_textReporter);</div><div class="t m5 x74 h2f y945 ffb fs10 fc0 sc0 ls1a ws2f6">      m_testRunners.add(tr);</div><div class="t m5 x74 h2f y946 ffb fs10 fc0 sc0 ls1f ws237">      invoker = tr.getInvoker();</div><div class="t m5 x74 h2f y947 ffb fs10 fc0 sc0 ls1f ws235">      for (ITestNGMethod m : tr.getBeforeSuiteMethods()) {</div><div class="t m5 x74 h2f y948 ffb fs10 fc0 sc0 ls1f ws2f1">        beforeSuiteMethods.put(m.getMethod(), m);</div><div class="t m5 x74 h2f y949 ffb fs10 fc0 sc0 ls1c ws0">      }</div><div class="t m5 x74 h2f y94a ffb fs10 fc0 sc0 ls19 ws235">      for (ITestNGMethod m : tr.getAfterSuiteMethods()) {</div><div class="t m5 x74 h2f y94b ffb fs10 fc0 sc0 ls19 ws2f1">        afterSuiteMethods.put(m.getMethod(), m);</div><div class="t m5 x74 h2f y94c ffb fs10 fc0 sc0 ls1c ws0">      }</div><div class="t m5 x74 h2f y94d ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y94e ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m0 xd hd y94f ffe fs3 fc0 sc0 ls0 ws0">Instance v<span class="_ _4"></span>ariables,  <span class="ff8 ws40c">on the other hand<span class="_ _1"></span>, should be declared at the top of the class. <span class="_ _4"></span>This</span></div><div class="t m0 xd h14 y950 ff8 fs3 fc0 sc0 ls0 ws474">should not increase the vertical distance of these variab<span class="_ _4"></span>les, because in a w<span class="_ _4"></span>ell-designed</div><div class="t m0 xd h14 y951 ff8 fs3 fc0 sc0 ls0 ws0">class, they are used b<span class="_ _4"></span>y many<span class="_ _0"></span>, if not all, of the methods of the class.</div><div class="t m0 x74 h14 y952 ff8 fs3 fc0 sc0 ls0 ws475">There ha<span class="_ _4"></span>ve been man<span class="_ _4"></span>y debates o<span class="_ _4"></span>ver where instance v<span class="_ _4"></span>ariables should go. In C++ w<span class="_ _1"></span>e</div><div class="t m0 xd h14 y953 ff8 fs3 fc0 sc0 ls0 ws476">commonly practiced the so-called <span class="_ _4"></span><span class="ffa">scissors rule<span class="ff8">, which put all the instance v<span class="_ _4"></span>ariables at the</span></span></div><div class="t m0 xd h14 y954 ff8 fs3 fc0 sc0 ls0 ws350">bottom. <span class="_ _1"></span>The common conv<span class="_ _4"></span>ention in Jav<span class="_ _4"></span>a, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er<span class="_ _4"></span>, is to put them all at the top of the class.</div><div class="t m0 xd h14 y955 ff8 fs3 fc0 sc0 ls0 ws477">I see no reason to follo<span class="_ _4"></span>w any other con<span class="_ _1"></span>vention. <span class="_ _1"></span>The impor<span class="_ _8"></span>tant thing is for the instance vari-</div><div class="t m0 xd h14 y956 ff8 fs3 fc0 sc0 ls0 wsc5">ables to be declared in one w<span class="_ _1"></span>ell-known place. Ev<span class="_ _4"></span>er<span class="_ _8"></span>ybody should kno<span class="_ _4"></span>w where to go to see</div><div class="t m0 xd h14 y957 ff8 fs3 fc0 sc0 ls0 ws0">the declarations. </div><div class="t m0 x74 h14 y958 ff8 fs3 fc0 sc0 ls0 ws478">Consider<span class="_ _4"></span>, for example, the strange case of the </div><div class="t m5 xd2 h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">TestSuite</div><div class="t m0 x53 h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws478">class in JUnit 4.3.1. I ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y43c ff8 fs3 fc0 sc0 ls0 ws13d">greatly attenuated this class to make the point. If y<span class="_ _4"></span>ou look about halfwa<span class="_ _1"></span>y down the listing,</div><div class="t m0 xd h14 y959 ff8 fs3 fc0 sc0 ls0 ws479">you will see tw<span class="_ _1"></span>o instance variab<span class="_ _4"></span>les declared there. It w<span class="_ _4"></span>ould be hard to hide them in a better</div><div class="t m0 xd h14 y95a ff8 fs3 fc0 sc0 ls0 ws47a">place. Someone reading this code w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve to stumble across the declarations b<span class="_ _4"></span>y acci-</div><div class="t m0 xd h14 y95b ff8 fs3 fc0 sc0 ls0 ws0">dent (as I did). </div><div class="t m5 x74 h2f y95c ffb fs10 fc0 sc0 ls0 ws0">public class TestSuite implements Test {</div><div class="t m5 x52 h2f y95d ffb fs10 fc0 sc0 ls0 ws0">static public Test createTest(Class&lt;? extends TestCase&gt; theClass, </div><div class="t m5 x74 h2f y95e ffb fs10 fc0 sc0 ls4c ws423">                                String name) {</div><div class="t m5 x74 h2f y95f ffb fs10 fc0 sc0 ls4c ws260">     ...</div><div class="t m5 x52 h2f y960 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf71" class="pf w1 h2" data-page-no="71"><div class="pc pc71 w1 h2"><img class="bi xd y961 wc h59" alt="" src="bg71.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">82<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m5 x52 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public static Constructor&lt;? extends TestCase&gt; </div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls14 ws235">  getTestConstructor(Class&lt;? extends TestCase&gt; theClass) </div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls14 ws237">  throws NoSuchMethodException {</div><div class="t m5 x8a h2f y629 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">public static Test warning(final String message) {</div><div class="t m5 x8a h2f y62d ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">private static String exceptionToString(Throwable t) {</div><div class="t m5 x8a h2f y630 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h46 y6f7 ffc fs10 fc0 sc0 ls0 ws0">private String fName;</div><div class="t m5 x52 h46 y962 ffc fs10 fc0 sc0 ls0 ws0">private Vector&lt;Test&gt; fTests= new Vector&lt;Test&gt;(10);</div><div class="t m5 x52 h2f y963 ffb fs10 fc0 sc0 ls0 ws0">public TestSuite() {</div><div class="t m5 x52 h2f y964 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y965 ffb fs10 fc0 sc0 ls0 ws0"> public TestSuite(final Class&lt;? extends TestCase&gt; theClass) {</div><div class="t m5 x74 h2f y966 ffb fs10 fc0 sc0 ls4c ws260">     ...</div><div class="t m5 x52 h2f y967 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y968 ffb fs10 fc0 sc0 ls0 ws0">public TestSuite(Class&lt;? extends TestCase&gt;  theClass, String name) {</div><div class="t m5 x8a h2f y969 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f y96a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y96b ffb fs10 fc0 sc0 ls14 ws253">  ... ... ... ... ...</div><div class="t m5 x74 h2f y96c ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd hd y96d ffe fs3 fc0 sc0 ls0 ws0">Dependent Functions<span class="_ _4"></span>. <span class="ff8 ws47b">If one function calls another, the<span class="_ _4"></span>y should be vertically close,</span></div><div class="t m0 xd h14 y96e ff8 fs3 fc0 sc0 ls0 ws343">and the caller should be abo<span class="_ _4"></span>ve the callee, if at all possib<span class="_ _4"></span>le. <span class="_ _4"></span>This giv<span class="_ _4"></span>es the program a natural</div><div class="t m0 xd h14 y952 ff8 fs3 fc0 sc0 ls0 ws47c">ﬂo<span class="_ _4"></span>w<span class="_ _0"></span>. If the conv<span class="_ _4"></span>ention is follo<span class="_ _4"></span>w<span class="_ _4"></span>ed reliabl<span class="_ _4"></span>y<span class="_ _1"></span>, readers will be able to trust that function deﬁni-</div><div class="t m0 xd h14 y953 ff8 fs3 fc0 sc0 ls0 ws13c">tions will follo<span class="_ _4"></span>w shortly after their use. Consider<span class="_ _4"></span>, for example, the snippet from F<span class="_ _4"></span>itNesse</div><div class="t m0 xd h14 y954 ff8 fs3 fc0 sc0 ls0 ws37f">in Listing 5-5. Notice ho<span class="_ _4"></span>w the topmost function calls those belo<span class="_ _4"></span>w it and ho<span class="_ _4"></span>w they in turn</div><div class="t m0 xd h14 y955 ff8 fs3 fc0 sc0 ls0 ws1f1">call those belo<span class="_ _4"></span>w them. <span class="_ _4"></span>This makes it easy to ﬁnd the called functions and greatly enhances</div><div class="t m0 xd h14 y956 ff8 fs3 fc0 sc0 ls0 ws0">the readability of the whole module.</div><div class="t m0 x74 h1c y96f ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-5 </div><div class="t m0 x74 h36 y970 ffc fs3 fc0 sc0 ls0 ws0">WikiPageResponder.java</div><div class="t m5 x74 h2f y971 ffb fs10 fc0 sc0 ls0 ws0">public class WikiPageResponder implements SecureResponder {</div><div class="t m5 x74 h2f y972 ffb fs10 fc0 sc0 ls0 ws0">  protected WikiPage page;</div><div class="t m5 x74 h2f y973 ffb fs10 fc0 sc0 ls0 ws0">  protected PageData pageData;</div><div class="t m5 x74 h2f y974 ffb fs10 fc0 sc0 ls0 ws0">  protected String pageTitle;</div><div class="t m5 x74 h2f y975 ffb fs10 fc0 sc0 ls0 ws0">  protected Request request;</div><div class="t m5 x74 h2f y976 ffb fs10 fc0 sc0 ls0 ws0">  protected PageCrawler crawler;</div><div class="t m5 x74 h2f y977 ffb fs10 fc0 sc0 ls0 ws0">  public Response makeResponse(FitNesseContext context, Request request)</div><div class="t m5 x74 h2f y978 ffb fs10 fc0 sc0 ls0 ws0">    throws Exception {</div><div class="t m5 x74 h2f y979 ffb fs10 fc0 sc0 ls0 ws0">    String pageName = getPageNameOrDefault(request, &quot;FrontPage&quot;);</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf72" class="pf w1 h2" data-page-no="72"><div class="pc pc72 w1 h2"><img class="bi xd y97a wc h5a" alt="" src="bg72.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">83<span class="_ _10"></span><span class="ff1">V<span class="_ _2"></span>ertical F<span class="_ _4"></span>ormatting</span></div><div class="t m0 x74 h14 y97b ff8 fs3 fc0 sc0 ls0 ws2ba">As an aside, this snippet pro<span class="_ _4"></span>vides a nice example of k<span class="_ _4"></span>eeping constants at the appropri-</div><div class="t m0 xd h14 y97c ff8 fs3 fc0 sc0 ls0 ws47d">ate lev<span class="_ _4"></span>el [G35]. <span class="_ _4"></span>The </div><div class="t m5 xc7 h2f y97c ffb fs10 fc0 sc0 ls0 ws0">&quot;FrontPage&quot;</div><div class="t m0 x44 h14 y97c ff8 fs3 fc0 sc0 lsd ws47e">constant could ha<span class="_ _4"></span>ve been buried in the</div><div class="t m5 xd h2f y367 ffb fs10 fc0 sc0 ls0 ws0">getPageNameOrDefault</div><div class="t m0 x4 h14 y367 ff8 fs3 fc0 sc0 lsd ws47f">function, but that w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve hidden a w<span class="_ _4"></span>ell-kno<span class="_ _4"></span>wn and expected</div><div class="t m0 xd h14 y368 ff8 fs3 fc0 sc0 ls0 ws111">constant in an inappropriately lo<span class="_ _1"></span>w-lev<span class="_ _4"></span>el function. It was better to pass that constant do<span class="_ _1"></span>wn</div><div class="t m0 xd h14 y369 ff8 fs3 fc0 sc0 ls0 ws0">from the place where it mak<span class="_ _4"></span>es sense to kno<span class="_ _4"></span>w it to the place that actually uses it.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    loadPage(pageName, context);</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    if (page == null)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      return notFoundResponse(context, request);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      return makePageResponse(context);</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  private String getPageNameOrDefault(Request request, String defaultPageName)</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls1c ws0">  {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    String pageName = request.getResource();</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    if (StringUtil.isBlank(pageName))</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      pageName = defaultPageName;</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    return pageName;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  protected void loadPage(String resource, FitNesseContext context)</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    throws Exception {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    WikiPagePath path = PathParser.parse(resource);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    crawler = context.root.getPageCrawler();</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    crawler.setDeadEndStrategy(new VirtualEnabledPageCrawler());</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    page = crawler.getPage(context.root, path);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    if (page != null)</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      pageData = page.getData();</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  private Response notFoundResponse(FitNesseContext context, Request request)</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    throws Exception {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    return new NotFoundResponder().makeResponse(context, request);</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  private SimpleResponse makePageResponse(FitNesseContext context)</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    throws Exception {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    pageTitle = PathParser.render(crawler.getFullPath(page));</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    String html = makeHtml(context);</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    SimpleResponse response = new SimpleResponse();</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    response.setMaxAge(0);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    response.setContent(html);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    return response;</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">WikiPageResponder.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf73" class="pf w1 h2" data-page-no="73"><div class="pc pc73 w1 h2"><img class="bi x37 y3e9 w9 h5b" alt="" src="bg73.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">84<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd hd y194 ffe fs3 fc0 sc0 ls0 ws0">Conceptual Af<span class="_ _8"></span>ﬁnity<span class="_ _2"></span>. <span class="ff8 ws480">Cer<span class="_ _8"></span>tain bits of code </span><span class="ffa">want</span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws481">to be near other bits. <span class="_ _1"></span>They ha<span class="_ _4"></span>ve a certain</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws482">conceptual af<span class="_ _4"></span>ﬁnity<span class="_ _1"></span>. <span class="_ _4"></span>The stronger that afﬁnity<span class="_ _0"></span>, the</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws483">less vertical distance there should be betw<span class="_ _4"></span>een</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">them.</div><div class="t m0 x74 h14 y1be ff8 fs3 fc0 sc0 ls0 ws484">As w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve seen, this afﬁnity might be based</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws438">on a direct dependence, such as one function call-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws485">ing another<span class="_ _4"></span>, or a function using a variab<span class="_ _4"></span>le. But</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws8f">there are other possible causes of af<span class="_ _4"></span>ﬁnity<span class="_ _0"></span>. <span class="_ _4"></span>Afﬁnity</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws2ff">might be caused because a group of functions per-</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws13a">form a similar operation. Consider this snippet of</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">code from Junit 4.3.1:</div><div class="t m5 x74 h2f y97e ffb fs10 fc0 sc0 ls0 ws0">public class Assert {</div><div class="t m5 x52 h2f y97f ffb fs10 fc0 sc0 ls0 ws0">static public void assertTrue(String message, boolean condition) {</div><div class="t m5 x8a h2f y980 ffb fs10 fc0 sc0 ls0 ws0">if (!condition)</div><div class="t m5 x6c h2f y981 ffb fs10 fc0 sc0 ls0 ws0">fail(message);</div><div class="t m5 x52 h2f y982 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y983 ffb fs10 fc0 sc0 ls0 ws0">static public void assertTrue(boolean condition) {</div><div class="t m5 x8a h2f y984 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(null, condition);</div><div class="t m5 x52 h2f y985 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y986 ffb fs10 fc0 sc0 ls0 ws0">static public void assertFalse(String message, boolean condition) {</div><div class="t m5 x8a h2f y987 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(message, !condition);</div><div class="t m5 x52 h2f y988 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y989 ffb fs10 fc0 sc0 ls0 ws0">static public void assertFalse(boolean condition) {</div><div class="t m5 x8a h2f y98a ffb fs10 fc0 sc0 ls0 ws0">assertFalse(null, condition);</div><div class="t m5 x52 h2f y98b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y98c ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m0 xd h14 y98d ff8 fs3 fc0 sc0 ls0 ws486">These functions ha<span class="_ _4"></span>ve a strong conceptual af<span class="_ _4"></span>ﬁnity because they share a common naming</div><div class="t m0 xd h14 y98e ff8 fs3 fc0 sc0 ls0 ws2df">scheme and perform variations of the same basic task. <span class="_ _1"></span>The f<span class="_ _8"></span>act that they call each other is</div><div class="t m0 xd h14 y58c ff8 fs3 fc0 sc0 ls0 ws0">secondary<span class="_ _1"></span>. Even if they didn’<span class="_ _1"></span>t, they w<span class="_ _1"></span>ould still want to be close to<span class="_ _4"></span>gether<span class="_ _4"></span>. </div><div class="t m0 xd h11 y98f ff1 fs7 fc0 sc0 ls0 ws0">V<span class="_ _3"></span>er<span class="_ _8"></span>tical Ordering</div><div class="t m0 xd h14 y583 ff8 fs3 fc0 sc0 ls0 ws487">In general w<span class="_ _4"></span>e want function call dependencies to point in the do<span class="_ _1"></span>wnward direction. <span class="_ _1"></span>That is,</div><div class="t m0 xd h14 y6d9 ff8 fs3 fc0 sc0 ls0 ws439">a function that is called should be belo<span class="_ _4"></span>w a function that does the calling.</div><div class="t m0 x6f h21 y3fe ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xbb h14 y6d9 ff8 fs3 fc0 sc0 ls0 ws439">This creates a</div><div class="t m0 xd h14 y6da ff8 fs3 fc0 sc0 ls0 ws0">nice ﬂo<span class="_ _4"></span>w do<span class="_ _4"></span>wn the source code module from high lev<span class="_ _4"></span>el to lo<span class="_ _4"></span>w level. </div><div class="t m0 x74 h14 y480 ff8 fs3 fc0 sc0 ls16 ws182">As in newspaper articles, w<span class="_ _4"></span>e expect the most important concepts to come ﬁrst, and</div><div class="t m0 xd h14 y6dc ff8 fs3 fc0 sc0 ls16 wsfc">w<span class="_ _4"></span>e expect them to be expressed with the least amount of polluting detail. <span class="_ _1"></span>W<span class="_ _0"></span>e expect the</div><div class="t m0 xd h14 y6dd ff8 fs3 fc0 sc0 ls16 ws139">lo<span class="_ _4"></span>w-lev<span class="_ _4"></span>el details to come last. <span class="_ _4"></span>This allo<span class="_ _4"></span>ws us to skim source ﬁles, getting the gist from the</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>This is the e<span class="_ _4"></span>xact opposite of languages like Pascal, C, and C++ that enforce functions to be deﬁned<span class="_ _4"></span>, or at least declared<span class="_ _4"></span>, </div><div class="t m0 x3b h25 y39b ffa fse fc0 sc0 ls0 ws0">befor<span class="_ _4"></span>e<span class="ff8"> they are used. </span></div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:213.728010px;width:90.696000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf74" class="pf w1 h2" data-page-no="74"><div class="pc pc74 w1 h2"><img class="bi x2c y990 w11 h5c" alt="" src="bg74.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">85<span class="_ _10"></span><span class="ff1">Horizontal F<span class="_ _1"></span>ormatting</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws488">ﬁrst few functions, without ha<span class="_ _1"></span>ving to immerse ourselves in the details. Listing 5-5 is</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls32 ws13d">organized this w<span class="_ _4"></span>a<span class="_ _4"></span>y<span class="_ _1"></span>. P<span class="_ _4"></span>erhaps ev<span class="_ _4"></span>en better examples are Listing 15-5 on page 263, and List-</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls16 ws0">ing 3-7 on page 50.</div><div class="t m0 xd h17 y991 ff1 fs9 fc0 sc0 ls0 ws0">Horizontal F<span class="_ _0"></span>ormatting</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws489">Ho<span class="_ _4"></span>w wide should a line be? <span class="_ _4"></span>T<span class="_ _0"></span>o answ<span class="_ _4"></span>er that, let’<span class="_ _2"></span>s look at ho<span class="_ _4"></span>w wide lines are in typical pro-</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws48a">grams. <span class="_ _4"></span>Again, w<span class="_ _4"></span>e examine the sev<span class="_ _4"></span>en different projects. F<span class="_ _4"></span>igure 5-2 sho<span class="_ _4"></span>ws the distribution</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws48b">of line lengths of all se<span class="_ _4"></span>ven projects. <span class="_ _4"></span>The regularity is impressi<span class="_ _4"></span>ve, especiall<span class="_ _4"></span>y right around</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws48c">45 characters. Indeed<span class="_ _1"></span>, ev<span class="_ _4"></span>er<span class="_ _8"></span>y size from 20 to 60 represents about 1 percent of the total</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws61">number of lines. <span class="_ _1"></span>That’<span class="_ _0"></span>s 40 percent! P<span class="_ _1"></span>erhaps another 30 percent are less than 10 characters</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws48d">wide. Remember this is a lo<span class="_ _4"></span>g scale, so the linear appearance of the drop-off abo<span class="_ _1"></span>ve 80 char-</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">acters is reall<span class="_ _4"></span>y very signiﬁcant. Programmers clearly prefer short lines. </div><div class="t m0 x74 h14 y992 ff8 fs3 fc0 sc0 ls0 ws141">This suggests that w<span class="_ _4"></span>e should striv<span class="_ _4"></span>e to keep our lines short. <span class="_ _4"></span>The old Hollerith limit of</div><div class="t m0 xd h14 y993 ff8 fs3 fc0 sc0 ls0 ws48e">80 is a bit arbitrary<span class="_ _1"></span>, and I’m not opposed to lines edging out to 100 or ev<span class="_ _4"></span>en 120. But</div><div class="t m0 xd h14 y994 ff8 fs3 fc0 sc0 ls0 ws0">bey<span class="_ _4"></span>ond that is probabl<span class="_ _4"></span>y just careless. </div><div class="t m0 x74 h14 y995 ff8 fs3 fc0 sc0 ls0 ws28">I used to follo<span class="_ _4"></span>w the rule that you should nev<span class="_ _4"></span>er ha<span class="_ _4"></span>ve to scroll to the right. But monitors</div><div class="t m0 xd h14 y996 ff8 fs3 fc0 sc0 ls0 ws2ad">are too wide for that no<span class="_ _4"></span>wada<span class="_ _1"></span>ys, and younger pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers can shrink the font so small</div><div class="t m0 x48 h1c y997 ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 5-2</div><div class="t m0 x92 h14 y998 ff8 fs3 fc0 sc0 ls11 ws168">Ja<span class="_ _4"></span>va line width distribution</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:526.946010px;width:135.648000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf75" class="pf w1 h2" data-page-no="75"><div class="pc pc75 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">86<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws11e">that the<span class="_ _4"></span>y can get 200 characters across the screen. Don’<span class="_ _4"></span>t do that. I personall<span class="_ _4"></span>y set my limit</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">at 120.</div><div class="t m0 xd h11 y56c ff1 fs7 fc0 sc0 ls0 ws0">Horizontal Openness and Density</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws2f5">W<span class="_ _0"></span>e use horizontal white space to associate things that are strongl<span class="_ _4"></span>y related and disassociate</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0">things that are more w<span class="_ _4"></span>eakly related. Consider the follo<span class="_ _1"></span>wing function:</div><div class="t m5 x74 h2f y999 ffb fs10 fc0 sc0 ls14 ws253">  private void measureLine(String line) {</div><div class="t m5 x74 h2f y99a ffb fs10 fc0 sc0 ls1e ws241">    lineCount++;</div><div class="t m5 x74 h2f y99b ffb fs10 fc0 sc0 ls19 ws236">    int lineSize = line.length();</div><div class="t m5 x74 h2f y99c ffb fs10 fc0 sc0 ls19 ws236">    totalChars += lineSize;</div><div class="t m5 x74 h2f y99d ffb fs10 fc0 sc0 ls18 ws2f6">    lineWidthHistogram.addLine(lineSize, lineCount);</div><div class="t m5 x74 h2f y99e ffb fs10 fc0 sc0 ls1f ws3b8">    recordWidestLine(lineSize);</div><div class="t m5 x74 h2f y99f ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 xd h14 y6ce ff8 fs3 fc0 sc0 ls0 ws243">I sur<span class="_ _8"></span>rounded the assignment operators with white space to accentuate them. <span class="_ _1"></span>Assignment</div><div class="t m0 xd h14 y6cf ff8 fs3 fc0 sc0 ls0 wsb6">statements ha<span class="_ _4"></span>ve tw<span class="_ _4"></span>o distinct and major elements: the left side and the right side. <span class="_ _1"></span>The</div><div class="t m0 xd h14 y9a0 ff8 fs3 fc0 sc0 ls0 ws0">spaces make that separation ob<span class="_ _4"></span>vious.</div><div class="t m0 x74 h14 y8fc ff8 fs3 fc0 sc0 ls12 ws67">On the other hand<span class="_ _1"></span>, I didn’<span class="_ _4"></span>t put spaces betw<span class="_ _4"></span>een the function names and the opening</div><div class="t m0 xd h14 y9a1 ff8 fs3 fc0 sc0 ls12 ws48f">parenthesis. <span class="_ _1"></span>This is because the function and its arguments are closely related. Separat-</div><div class="t m0 xd h14 y9a2 ff8 fs3 fc0 sc0 ls12 ws15d">ing them makes them appear disjoined instead of conjoined. I separate ar<span class="_ _4"></span>guments within</div><div class="t m0 xd h14 y900 ff8 fs3 fc0 sc0 ls12 ws459">the function call parenthesis to accentuate the comma and sho<span class="_ _4"></span>w that the arguments are</div><div class="t m0 xd h14 y9a3 ff8 fs3 fc0 sc0 ls12 ws0">separate.</div><div class="t m0 x74 h14 y9a4 ff8 fs3 fc0 sc0 ls0 ws0">Another use for white space is to accentuate the precedence of operators. </div><div class="t m5 x74 h2f y9a5 ffb fs10 fc0 sc0 ls0 ws0">public class Quadratic {</div><div class="t m5 x74 h2f y9a6 ffb fs10 fc0 sc0 ls0 ws260">  public static double root1(double a, double b, double c) {</div><div class="t m5 x74 h2f y9a7 ffb fs10 fc0 sc0 ls14 ws236">    double determinant = determinant(a, b, c);</div><div class="t m5 x74 h2f y9a8 ffb fs10 fc0 sc0 ls14 ws236">    return (-b + Math.sqrt(determinant)) / (2*a);</div><div class="t m5 x74 h2f y9a9 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9aa ffb fs10 fc0 sc0 ls14 ws423">  public static double root2(int a, int b, int c) {</div><div class="t m5 x74 h2f y9ab ffb fs10 fc0 sc0 ls14 ws236">    double determinant = determinant(a, b, c);</div><div class="t m5 x74 h2f y9ac ffb fs10 fc0 sc0 ls14 ws236">    return (-b - Math.sqrt(determinant)) / (2*a); </div><div class="t m5 x74 h2f y9ad ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9ae ffb fs10 fc0 sc0 ls0 ws260">  private static double determinant(double a, double b, double <span class="_ _0"></span>c) {</div><div class="t m5 x74 h2f y9af ffb fs10 fc0 sc0 ls1f ws235">    return b*b - 4*a*c;</div><div class="t m5 x74 h2f y9b0 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9b1 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y47f ff8 fs3 fc0 sc0 ls0 ws490">Notice ho<span class="_ _4"></span>w nicely the equations read. <span class="_ _1"></span>The factors hav<span class="_ _4"></span>e no white space betw<span class="_ _4"></span>een them</div><div class="t m0 xd h14 y480 ff8 fs3 fc0 sc0 ls0 ws491">because they are high precedence. <span class="_ _1"></span>The ter<span class="_ _8"></span>ms are separated by w<span class="_ _4"></span>hite space because addi-</div><div class="t m0 xd h14 y6dc ff8 fs3 fc0 sc0 ls0 ws0">tion and subtraction are lo<span class="_ _4"></span>w<span class="_ _4"></span>er precedence.</div><div class="t m0 x74 h14 y554 ff8 fs3 fc0 sc0 ls29 ws296">Unfortunately<span class="_ _0"></span>, most tools for refor<span class="_ _8"></span>matting code are blind to the precedence of</div><div class="t m0 xd h14 y5ed ff8 fs3 fc0 sc0 ls29 ws492">operators and impose the same spacing throughout. So subtle spacings like those</div><div class="t m0 xd h14 y5ee ff8 fs3 fc0 sc0 ls29 ws0">sho<span class="_ _4"></span>wn abo<span class="_ _4"></span>ve tend to get lost after y<span class="_ _4"></span>ou refor<span class="_ _8"></span>mat the code. </div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:546.728010px;width:171.682000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf76" class="pf w1 h2" data-page-no="76"><div class="pc pc76 w1 h2"><img class="bi x37 y9b2 w8 h27" alt="" src="bg76.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">87<span class="_ _10"></span><span class="ff1">Horizontal F<span class="_ _1"></span>ormatting</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws11">Horizontal Alignment</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws147">When I was an assemb<span class="_ _4"></span>l<span class="_ _4"></span>y language programmer<span class="_ _4"></span>,</div><div class="t m0 xcf h21 y9b3 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xd5 h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws147">I used horizontal alignment to accentuate</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws202">certain str<span class="_ _8"></span>uctures. When I started coding in C, C++, and ev<span class="_ _4"></span>entually Ja<span class="_ _1"></span>va, I continued to try</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws209">to line up all the v<span class="_ _4"></span>ariable names in a set of declarations, or all the rvalues in a set of assign-</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws0">ment statements. My code might ha<span class="_ _4"></span>ve looked lik<span class="_ _4"></span>e this:</div><div class="t m5 x74 h2f y714 ffb fs10 fc0 sc0 ls0 ws0">public class FitNesseExpediter implements ResponseSender</div><div class="t m5 x74 h2f y715 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y716 ffb fs10 fc0 sc0 ls0 ws0">private   Socket          socket;</div><div class="t m5 x52 h2f y717 ffb fs10 fc0 sc0 ls0 ws0">private   InputStream     input;</div><div class="t m5 x52 h2f y718 ffb fs10 fc0 sc0 ls0 ws0">private   OutputStream    output;</div><div class="t m5 x52 h2f y9b4 ffb fs10 fc0 sc0 ls0 ws0">private   Request         request;</div><div class="t m5 x52 h2f y719 ffb fs10 fc0 sc0 ls0 ws0">private   Response        response;</div><div class="t m5 x52 h2f y71a ffb fs10 fc0 sc0 ls0 ws0">private   FitNesseContext context;</div><div class="t m5 x52 h2f y71b ffb fs10 fc0 sc0 ls0 ws0">protected long            requestParsingTimeLimit;</div><div class="t m5 x52 h2f y71c ffb fs10 fc0 sc0 ls0 ws0">private   long            requestProgress;</div><div class="t m5 x52 h2f y71d ffb fs10 fc0 sc0 ls0 ws0">private   long            requestParsingDeadline;</div><div class="t m5 x52 h2f y71e ffb fs10 fc0 sc0 ls0 ws0">private   boolean         hasError;</div><div class="t m5 x52 h2f y9b5 ffb fs10 fc0 sc0 ls1f ws241">public FitNesseExpediter(Socket  <span class="_ _4"></span>        s, </div><div class="t m5 x52 h2f y9b6 ffb fs10 fc0 sc0 ls0 ws0">                         FitNesseContext context) throws Exception</div><div class="t m5 x52 h2f y9b7 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y9b8 ffb fs10 fc0 sc0 ls0 ws0">this.context =            context;</div><div class="t m5 x8a h2f y9b9 ffb fs10 fc0 sc0 ls0 ws0">socket =                  s;</div><div class="t m5 x8a h2f y9ba ffb fs10 fc0 sc0 ls0 ws0">input =                   s.getInputStream();</div><div class="t m5 x8a h2f y9bb ffb fs10 fc0 sc0 ls0 ws0">output =                  s.getOutputStream();</div><div class="t m5 x8a h2f y9bc ffb fs10 fc0 sc0 ls0 ws0">requestParsingTimeLimit = 10000;</div><div class="t m5 x52 h2f y9bd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y9be ff8 fs3 fc0 sc0 ls0 ws71">I ha<span class="_ _4"></span>ve found<span class="_ _1"></span>, ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, that this kind of alignment is not useful. <span class="_ _4"></span>The alignment seems to</div><div class="t m0 xd h14 y9bf ff8 fs3 fc0 sc0 ls0 ws397">emphasize the wrong things and leads m<span class="_ _4"></span>y ey<span class="_ _4"></span>e a<span class="_ _4"></span>wa<span class="_ _4"></span>y from the true intent. F<span class="_ _4"></span>or example, in</div><div class="t m0 xd h14 y454 ff8 fs3 fc0 sc0 ls0 ws493">the list of declarations abo<span class="_ _4"></span>ve y<span class="_ _4"></span>ou are tempted to read do<span class="_ _4"></span>wn the list of variab<span class="_ _4"></span>le names with-</div><div class="t m0 xd h14 y455 ff8 fs3 fc0 sc0 ls0 ws2d7">out looking at their types. Like<span class="_ _4"></span>wise, in the list of assignment statements you are tempted to</div><div class="t m0 xd h14 y456 ff8 fs3 fc0 sc0 ls0 ws494">look do<span class="_ _4"></span>wn the list of rvalues without e<span class="_ _4"></span>ver seeing the assignment operator<span class="_ _1"></span>. <span class="_ _4"></span>T<span class="_ _1"></span>o make matters</div><div class="t m0 xd h14 y9c0 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>orse, automatic reformatting tools usually eliminate this kind of alignment. </div><div class="t m0 x74 h14 y9c1 ff8 fs3 fc0 sc0 ls0 ws495">So, in the end<span class="_ _1"></span>, I don’<span class="_ _4"></span>t do this kind of thing anymore. No<span class="_ _1"></span>wada<span class="_ _4"></span>ys I prefer unaligned</div><div class="t m0 xd h14 y9c2 ff8 fs3 fc0 sc0 ls0 ws437">declarations and assignments, as sho<span class="_ _4"></span>wn belo<span class="_ _4"></span>w<span class="_ _0"></span>, because they point out an important deﬁ-</div><div class="t m0 xd h14 y9c3 ff8 fs3 fc0 sc0 ls0 ws35">ciency<span class="_ _0"></span>. If I ha<span class="_ _4"></span>ve long lists that need to be aligned<span class="_ _1"></span>, <span class="ffa">the pr<span class="_ _4"></span>oblem is the length of the lists<span class="ff8">, not</span></span></div><div class="t m0 xd h14 y9c4 ff8 fs3 fc0 sc0 ls0 ws76">the lack of alignment. <span class="_ _1"></span>The length of the list of declarations in </div><div class="t m5 xa3 h2f y583 ffb fs10 fc0 sc0 ls0 ws0">FitNesseExpediter</div><div class="t m0 x36 h14 y583 ff8 fs3 fc0 sc0 ls0 ws0">belo<span class="_ _4"></span>w</div><div class="t m0 xd h14 y6d9 ff8 fs3 fc0 sc0 ls0 ws0">suggests that this class should be split up.</div><div class="t m5 x74 h2f y204 ffb fs10 fc0 sc0 ls0 ws0">public class FitNesseExpediter implements ResponseSender</div><div class="t m5 x74 h2f y9c5 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y9c6 ffb fs10 fc0 sc0 ls0 ws0">private Socket socket;</div><div class="t m5 x52 h2f y9c7 ffb fs10 fc0 sc0 ls0 ws0">private InputStream input;</div><div class="t m5 x52 h2f y9c8 ffb fs10 fc0 sc0 ls0 ws0">private OutputStream output;</div><div class="t m5 x52 h2f y9c9 ffb fs10 fc0 sc0 ls0 ws0">private Request request;</div><div class="t m0 xd h25 y9ca ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>Who am I kidding? I still am an assemb<span class="_ _4"></span>ly language programmer<span class="_ _1"></span>. <span class="_ _4"></span>Y<span class="_ _0"></span>ou can take the bo<span class="_ _4"></span>y a<span class="_ _4"></span>wa<span class="_ _4"></span>y from the metal, but you can’<span class="_ _4"></span>t </div><div class="t m0 x3b h25 y9cb ff8 fse fc0 sc0 ls0 ws0">take the metal out of the bo<span class="_ _4"></span>y!</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:111.311000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf77" class="pf w1 h2" data-page-no="77"><div class="pc pc77 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">88<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m5 x52 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">private Response response;</div><div class="t m5 x52 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">private FitNesseContext context;</div><div class="t m5 x52 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">protected long requestParsingTimeLimit;</div><div class="t m5 x52 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">private long requestProgress;</div><div class="t m5 x52 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">private long requestParsingDeadline;</div><div class="t m5 x52 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">private boolean hasError;</div><div class="t m5 x52 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">public FitNesseExpediter(Socket s, FitNesseContext context) throws Exception</div><div class="t m5 x52 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y62e ffb fs10 fc0 sc0 ls0 ws0">this.context = context;</div><div class="t m5 x8a h2f y62f ffb fs10 fc0 sc0 ls0 ws0">socket = s;</div><div class="t m5 x8a h2f y630 ffb fs10 fc0 sc0 ls0 ws0">input = s.getInputStream();</div><div class="t m5 x8a h2f y631 ffb fs10 fc0 sc0 ls0 ws0">output = s.getOutputStream();</div><div class="t m5 x8a h2f y632 ffb fs10 fc0 sc0 ls0 ws0">requestParsingTimeLimit = 10000;</div><div class="t m5 x52 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y9cd ff1 fs7 fc0 sc0 ls0 ws0">Indentation</div><div class="t m0 xd h14 y9ce ff8 fs3 fc0 sc0 ls0 ws496">A source ﬁle is a hierarch<span class="_ _4"></span>y rather like an outline. <span class="_ _4"></span>There is information that per<span class="_ _8"></span>tains to the</div><div class="t m0 xd h14 y9cf ff8 fs3 fc0 sc0 ls0 ws2c7">ﬁle as a whole, to the indi<span class="_ _4"></span>vidual classes within the ﬁle, to the methods within the classes,</div><div class="t m0 xd h14 y9d0 ff8 fs3 fc0 sc0 ls0 ws344">to the blocks within the methods, and recursi<span class="_ _4"></span>vel<span class="_ _4"></span>y to the blocks within the b<span class="_ _4"></span>locks. Each</div><div class="t m0 xd h14 y9d1 ff8 fs3 fc0 sc0 ls0 ws497">le<span class="_ _4"></span>vel of this hierarch<span class="_ _4"></span>y is a scope into which names can be declared and in which declara-</div><div class="t m0 xd h14 y51b ff8 fs3 fc0 sc0 ls0 ws0">tions and ex<span class="_ _4"></span>ecutable statements are interpreted. </div><div class="t m0 x74 h14 y9d2 ff8 fs3 fc0 sc0 ls12 ws1eb">T<span class="_ _0"></span>o make this hierarchy of scopes visib<span class="_ _4"></span>le, w<span class="_ _4"></span>e indent the lines of source code in pro-</div><div class="t m0 xd h14 y9d3 ff8 fs3 fc0 sc0 ls12 ws1eb">portion to their position in the hiearchy<span class="_ _0"></span>. Statements at the lev<span class="_ _4"></span>el of the ﬁle, such as most</div><div class="t m0 xd h14 y9d4 ff8 fs3 fc0 sc0 ls12 wsd8">class declarations, are not indented at all. Methods within a class are indented one lev<span class="_ _4"></span>el</div><div class="t m0 xd h14 y51f ff8 fs3 fc0 sc0 ls12 ws498">to the right of the class. Implementations of those methods are implemented one lev<span class="_ _4"></span>el to</div><div class="t m0 xd h14 y520 ff8 fs3 fc0 sc0 ls12 ws363">the right of the method declaration. Block implementations are implemented one lev<span class="_ _4"></span>el</div><div class="t m0 xd h14 y521 ff8 fs3 fc0 sc0 ls12 ws0">to the right of their containing block, and so on.</div><div class="t m0 x74 h14 y9d5 ff8 fs3 fc0 sc0 ls0 ws499">Programmers rel<span class="_ _4"></span>y heavil<span class="_ _4"></span>y on this indentation scheme. <span class="_ _1"></span>They visually line up lines on</div><div class="t m0 xd h14 y9d6 ff8 fs3 fc0 sc0 ls0 ws5d">the left to see what scope the<span class="_ _4"></span>y appear in. <span class="_ _4"></span>This allo<span class="_ _4"></span>ws them to quickly hop o<span class="_ _1"></span>ver scopes,</div><div class="t m0 xd h14 y9d7 ff8 fs3 fc0 sc0 ls0 ws49a">such as implementations of </div><div class="t m5 x5d h2f y3ab ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xa2 h14 y3ab ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x76 h2f y3ab ffb fs10 fc0 sc0 ls0 ws0">while</div><div class="t m0 x4e h14 y3ab ff8 fs3 fc0 sc0 ls0 ws49a">statements, that are not rele<span class="_ _4"></span>vant to their current</div><div class="t m0 xd h14 y390 ff8 fs3 fc0 sc0 ls0 ws22e">situation. <span class="_ _1"></span>They scan the left for new method declarations, ne<span class="_ _4"></span>w variab<span class="_ _4"></span>les, and ev<span class="_ _4"></span>en new</div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 ws0">classes. <span class="_ _4"></span>W<span class="_ _4"></span>ithout indentation, programs w<span class="_ _4"></span>ould be vir<span class="_ _8"></span>tually unreadab<span class="_ _4"></span>le by humans. </div><div class="t m0 x74 h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws0">Consider the follo<span class="_ _4"></span>wing programs that are syntacticall<span class="_ _4"></span>y and semantically identical:</div><div class="t m5 x74 h2f y9d8 ffb fs10 fc0 sc0 ls0 ws0">public class FitNesseServer implements SocketServer { private FitNesseContext </div><div class="t m5 x74 h2f y9d9 ffb fs10 fc0 sc0 ls0 ws0">context; public FitNesseServer(FitNesseContext context) { this.context = </div><div class="t m5 x74 h2f y9da ffb fs10 fc0 sc0 ls0 ws0">context; } public void serve(Socket s) { serve(s, 10000); } public void </div><div class="t m5 x74 h2f y9db ffb fs10 fc0 sc0 ls0 ws0">serve(Socket s, long requestTimeout) { try { FitNesseExpediter sender = new </div><div class="t m5 x74 h2f y9dc ffb fs10 fc0 sc0 ls0 ws0">FitNesseExpediter(s, context); </div><div class="t m5 x74 h2f y9dd ffb fs10 fc0 sc0 ls0 ws0">sender.setRequestParsingTimeLimit(requestTimeout); sender.start(); } </div><div class="t m5 x74 h2f y9de ffb fs10 fc0 sc0 ls0 ws0">catch(Exception e) { e.printStackTrace(); } } }</div><div class="t m5 x74 h2f y9df ffb fs10 fc0 sc0 ls0 ws0">-----</div><div class="t m5 x74 h2f y9e0 ffb fs10 fc0 sc0 ls0 ws0">public class FitNesseServer implements SocketServer {</div><div class="t m5 x74 h2f y9e1 ffb fs10 fc0 sc0 ls14 ws237">  private FitNesseContext context;</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:435.728010px;width:60.012000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf78" class="pf w1 h2" data-page-no="78"><div class="pc pc78 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">89<span class="_ _10"></span><span class="ff1">Horizontal F<span class="_ _1"></span>ormatting</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls14 ws235">  public FitNesseServer(FitNesseContext context) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls19 ws237">    this.context = context;</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls14 ws253">  public void serve(Socket s) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls1a ws237">    serve(s, 10000);</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls14 ws260">  public void serve(Socket s, long requestTimeout) {</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls1b ws260">    try {</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls18 ws236">      FitNesseExpediter sender = new FitNesseExpediter(s, context);</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls19 ws49b">      sender.setRequestParsingTimeLimit(requestTimeout);</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls1e ws241">      sender.start();</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls19 ws236">    catch (Exception e) {</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls20 ws2f1">      e.printStackTrace();</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y748 ff8 fs3 fc0 sc0 ls0 ws49c">Y<span class="_ _3"></span>our eye can rapidl<span class="_ _4"></span>y discern the str<span class="_ _8"></span>ucture of the indented ﬁle. <span class="_ _1"></span>Y<span class="_ _3"></span>ou can almost instantly</div><div class="t m0 xd h14 y3d5 ff8 fs3 fc0 sc0 ls0 ws49d">spot the variab<span class="_ _4"></span>les, constructors, accessors, and methods. It takes just a few seconds to real-</div><div class="t m0 xd h14 y3d6 ff8 fs3 fc0 sc0 ls0 ws306">ize that this is some kind of simple front end to a socket, with a time-out. <span class="_ _1"></span>The unindented</div><div class="t m0 xd h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws0">version, ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, is vir<span class="_ _8"></span>tually impenetrab<span class="_ _4"></span>le without intense study<span class="_ _1"></span>. </div><div class="t m0 xd hd y74a ffe fs3 fc0 sc0 ls0 ws0">Breaking Indentation. <span class="ff8 ws279">It is sometimes tempting to break the indentation r<span class="_ _8"></span>ule for short</span></div><div class="t m5 xd h2f y74b ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x3b h14 y74b ff8 fs3 fc0 sc0 ls0 ws49e">statements, short </div><div class="t m5 xb h2f y74b ffb fs10 fc0 sc0 ls0 ws0">while</div><div class="t m0 x1f h14 y74b ff8 fs3 fc0 sc0 ls0 ws49e">loops, or short functions. Whene<span class="_ _4"></span>ver I ha<span class="_ _4"></span>ve succumbed to this</div><div class="t m0 xd h14 y74c ff8 fs3 fc0 sc0 ls0 ws49f">temptation, I ha<span class="_ _4"></span>ve almost al<span class="_ _4"></span>wa<span class="_ _1"></span>ys gone back and put the indentation back in. So I av<span class="_ _4"></span>oid col-</div><div class="t m0 xd h14 y74d ff8 fs3 fc0 sc0 ls0 ws0">lapsing scopes do<span class="_ _4"></span>wn to one line like this:</div><div class="t m5 x74 h2f y9e3 ffb fs10 fc0 sc0 ls0 ws0">public class CommentWidget extends TextWidget</div><div class="t m5 x74 h2f y9e4 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y9e5 ffb fs10 fc0 sc0 ls0 ws0">public static final String REGEXP = &quot;^#[^\r\n]*(?:(?:\r\n)|\n|\r)?&quot;;</div><div class="t m5 x52 h2f y9e6 ffb fs10 fc0 sc0 ls0 ws0">public CommentWidget(ParentWidget parent, String text){super(parent, text);}</div><div class="t m5 x52 h2f y9e7 ffb fs10 fc0 sc0 ls0 ws0">public String render() throws Exception {return &quot;&quot;; }</div><div class="t m5 x74 h2f y9e8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws0">I prefer to expand and indent the scopes instead<span class="_ _1"></span>, like this:</div><div class="t m5 x74 h2f y9ea ffb fs10 fc0 sc0 ls0 ws0">public class CommentWidget extends TextWidget {</div><div class="t m5 x74 h2f y9eb ffb fs10 fc0 sc0 ls0 ws253">  public static final String REGEXP = &quot;^#[^\r\n]*(?:(?:\r\n)|\n|\r)?&quot;;</div><div class="t m5 x74 h2f y9ec ffb fs10 fc0 sc0 ls14 ws253">  public CommentWidget(ParentWidget parent, String text) {</div><div class="t m5 x74 h2f y9ed ffb fs10 fc0 sc0 ls1f ws241">    super(parent, text);</div><div class="t m5 x74 h2f y9ee ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9ef ffb fs10 fc0 sc0 ls14 ws253">  public String render() throws Exception {</div><div class="t m5 x74 h2f y9f0 ffb fs10 fc0 sc0 ls20 ws236">    return &quot;&quot;;</div><div class="t m5 x74 h2f y9f1 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y9f2 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf79" class="pf w1 h2" data-page-no="79"><div class="pc pc79 w1 h2"><img class="bi x1b y9f3 w12 h5d" alt="" src="bg79.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">90<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Dumm<span class="_ _4"></span>y Scopes</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls16 ws11f">Sometimes the body of a </div><div class="t m5 x7d h2f y2a4 ffb fs10 fc0 sc0 ls31 ws0">while</div><div class="t m0 xa2 h14 y2a4 ff8 fs3 fc0 sc0 ls16 ws0">or</div><div class="t m5 x76 h2f y2a4 ffb fs10 fc0 sc0 ls31 ws0">for</div><div class="t m0 x31 h14 y2a4 ff8 fs3 fc0 sc0 ls16 ws11f">statement is a dumm<span class="_ _4"></span>y<span class="_ _0"></span>, as shown belo<span class="_ _1"></span>w<span class="_ _1"></span>. I don’<span class="_ _1"></span>t like</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls16 ws112">these kinds of structures and tr<span class="_ _8"></span>y to av<span class="_ _4"></span>oid them. <span class="_ _4"></span>When I can’<span class="_ _4"></span>t av<span class="_ _4"></span>oid them, I make sure that</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls16 ws29d">the dumm<span class="_ _4"></span>y body is properly indented and surrounded by braces. I can’<span class="_ _1"></span>t tell you ho<span class="_ _1"></span>w</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls16 ws9f">man<span class="_ _4"></span>y times I’<span class="_ _4"></span>ve been fooled b<span class="_ _4"></span>y a semicolon silently sitting at the end of a </div><div class="t m5 xbb h2f y2a6 ffb fs10 fc0 sc0 ls31 ws0">while</div><div class="t m0 x64 h14 y2a6 ff8 fs3 fc0 sc0 ls16 ws9f">loop on</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls16 ws1f6">the same line. Unless you mak<span class="_ _4"></span>e that semicolon <span class="ffa ws0">visible</span><span class="ls4d ws4a0"> b<span class="_ _4"></span>y indenting it on it’<span class="_ _2"></span>s o<span class="_ _4"></span>wn line, it’<span class="_ _2"></span>s</span></div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls16 ws0">just too hard to see.</div><div class="t m5 x74 h2f y6e2 ffb fs10 fc0 sc0 ls0 ws0">while (dis.read(buf, 0, readBufferSize) != -1) </div><div class="t m5 x74 h2f y6e3 ffb fs10 fc0 sc0 ls1c ws0">  ;</div><div class="t m0 xd h17 y9f4 ff1 fs9 fc0 sc0 ls0 ws0">T<span class="_ _2"></span>eam Rules</div><div class="t m0 xd h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws4a1">The title of this section is a pla<span class="_ _4"></span>y on</div><div class="t m0 xd h14 y564 ff8 fs3 fc0 sc0 ls0 ws4a2">w<span class="_ _4"></span>ords. Every programmer has his o<span class="_ _4"></span>wn</div><div class="t m0 xd h14 y9f6 ff8 fs3 fc0 sc0 lsd ws4a3">fa<span class="_ _4"></span>vorite formatting r<span class="_ _8"></span>ules, but if he w<span class="_ _4"></span>orks</div><div class="t m0 xd h14 y9f7 ff8 fs3 fc0 sc0 ls0 ws0">in a team, then the team rules. </div><div class="t m0 x74 h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws3c2">A team of de<span class="_ _4"></span>velopers should agree</div><div class="t m0 xd h14 y749 ff8 fs3 fc0 sc0 ls0 ws2e0">upon a single formatting style, and then</div><div class="t m0 xd h14 y74a ff8 fs3 fc0 sc0 ls0 ws4a4">e<span class="_ _4"></span>very member of that team should use</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls44 ws13d">that style. <span class="_ _4"></span>W<span class="_ _0"></span>e want the softw<span class="_ _4"></span>are to ha<span class="_ _4"></span>ve a</div><div class="t m0 xd h14 y74c ff8 fs3 fc0 sc0 lsc ws4a5">consistent style. <span class="_ _4"></span>W<span class="_ _0"></span>e don’<span class="_ _4"></span>t want it to appear to ha<span class="_ _1"></span>ve been written by a bunch of disagreeing</div><div class="t m0 xd h14 y74d ff8 fs3 fc0 sc0 ls0 ws0">individuals.</div><div class="t m0 x74 h14 y57c ff8 fs3 fc0 sc0 ls0 ws455">When I started the FitNesse project back in 2002, I sat do<span class="_ _4"></span>wn with the team to w<span class="_ _4"></span>ork</div><div class="t m0 xd h14 y74e ff8 fs3 fc0 sc0 ls0 ws4a6">out a coding style. <span class="_ _1"></span>This took about 10 minutes. W<span class="_ _0"></span>e decided w<span class="_ _4"></span>here we’<span class="_ _3"></span>d put our braces,</div><div class="t m0 xd h14 y74f ff8 fs3 fc0 sc0 ls0 ws4a7">what our indent size w<span class="_ _1"></span>ould be, ho<span class="_ _4"></span>w we w<span class="_ _1"></span>ould name classes, variab<span class="_ _4"></span>les, and methods, and</div><div class="t m0 xd h14 y827 ff8 fs3 fc0 sc0 ls0 ws2b5">so forth. <span class="_ _4"></span>Then we encoded those rules into the code formatter of our IDE and hav<span class="_ _4"></span>e stuck</div><div class="t m0 xd h14 y9f8 ff8 fs3 fc0 sc0 ls0 wsc8">with them e<span class="_ _4"></span>ver since. <span class="_ _4"></span>These w<span class="_ _4"></span>ere not the r<span class="_ _8"></span>ules that I prefer; they w<span class="_ _1"></span>ere r<span class="_ _8"></span>ules decided by the</div><div class="t m0 xd h14 y9f9 ff8 fs3 fc0 sc0 ls0 ws247">team. <span class="_ _1"></span>As a member of that team I follow<span class="_ _1"></span>ed them when writing code in the FitNesse</div><div class="t m0 xd h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws0">project.</div><div class="t m0 x74 h14 y9fa ff8 fs3 fc0 sc0 ls0 ws4a8">Remember<span class="_ _4"></span>, a good software system is composed of a set of documents that read</div><div class="t m0 xd h14 y9fb ff8 fs3 fc0 sc0 ls0 ws169">nicely<span class="_ _0"></span>. <span class="_ _1"></span>They need to ha<span class="_ _4"></span>ve a consistent and smooth style. <span class="_ _1"></span>The reader needs to be able to</div><div class="t m0 xd h14 y9fc ff8 fs3 fc0 sc0 ls0 ws4a9">trust that the for<span class="_ _8"></span>matting gestures he or she has seen in one source ﬁle will mean the same</div><div class="t m0 xd h14 y9fd ff8 fs3 fc0 sc0 ls0 ws4e">thing in others. <span class="_ _1"></span>The last thing we w<span class="_ _4"></span>ant to do is add more complexity to the source code b<span class="_ _4"></span>y</div><div class="t m0 xd h14 y9fe ff8 fs3 fc0 sc0 ls0 ws0">writing it in a jumble of dif<span class="_ _4"></span>ferent indi<span class="_ _4"></span>vidual styles.</div><div class="t m0 xd h17 y9ff ff1 fs9 fc0 sc0 ls0 ws0">Uncle Bob’<span class="_ _0"></span>s F<span class="_ _0"></span>ormatting Rules</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws4aa">The rules I use personally are very simple and are illustrated by the code in Listing 5-6.</div><div class="t m0 xd h14 ya00 ff8 fs3 fc0 sc0 ls0 ws0">Consider this an example of ho<span class="_ _1"></span>w code makes the best coding standard document. </div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:444.945010px;width:69.876000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:78.518000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:127.946010px;width:179.006000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7a" class="pf w1 h2" data-page-no="7a"><div class="pc pc7a w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg7a.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">91<span class="_ _10"></span><span class="ff1">Uncle Bob’<span class="_ _1"></span>s F<span class="_ _1"></span>ormatting Rules</span></div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-6 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">CodeAnalyzer.java</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public class CodeAnalyzer implements JavaFileAnalysis {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  private int lineCount;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  private int maxLineWidth;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private int widestLineNumber;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private LineWidthHistogram lineWidthHistogram;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  private int totalChars;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public CodeAnalyzer() {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    lineWidthHistogram = new LineWidthHistogram();</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public static List&lt;File&gt; findJavaFiles(File parentDirectory) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    List&lt;File&gt; files = new ArrayList&lt;File&gt;();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    findJavaFiles(parentDirectory, files);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    return files;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  private static void findJavaFiles(File parentDirectory, List&lt;File&gt; files) {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    for (File file : parentDirectory.listFiles()) {</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      if (file.getName().endsWith(&quot;.java&quot;))</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">        files.add(file);</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">      else if (file.isDirectory())</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">        findJavaFiles(file, files);</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  public void analyzeFile(File javaFile) throws Exception {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    BufferedReader br = new BufferedReader(new FileReader(javaFile));</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    String line;</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    while ((line = br.readLine()) != null)</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      measureLine(line);</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  private void measureLine(String line) {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    lineCount++;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    int lineSize = line.length();</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    totalChars += lineSize;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    lineWidthHistogram.addLine(lineSize, lineCount);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    recordWidestLine(lineSize);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">  private void recordWidestLine(int lineSize) {</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    if (lineSize &gt; maxLineWidth) {</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">      maxLineWidth = lineSize;</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">      widestLineNumber = lineCount;</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  public int getLineCount() {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    return lineCount;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  public int getMaxLineWidth() {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    return maxLineWidth;</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7b" class="pf w1 h2" data-page-no="7b"><div class="pc pc7b w1 h2"><img class="bi xd ya03 wc h5e" alt="" src="bg7b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">92<span class="_ _25"> </span><span class="ff1 wsa0">Chapter 5:<span class="_ _4"></span> F<span class="_ _4"></span>ormatting</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public int getWidestLineNumber() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return widestLineNumber;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  public LineWidthHistogram getLineWidthHistogram() {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return lineWidthHistogram;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  public double getMeanLineWidth() {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    return (double)totalChars/lineCount;</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  public int getMedianLineWidth() {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    Integer[] sortedWidths = getSortedWidths();</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    int cumulativeLineCount = 0;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    for (int width : sortedWidths) {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      cumulativeLineCount += lineCountForWidth(width);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      if (cumulativeLineCount &gt; lineCount/2)</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">        return width;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    throw new Error(&quot;Cannot get here&quot;);</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  private int lineCountForWidth(int width) {</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    return lineWidthHistogram.getLinesforWidth(width).size();</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  private Integer[] getSortedWidths() {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    Set&lt;Integer&gt; widths = lineWidthHistogram.getWidths();</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    Integer[] sortedWidths = (widths.toArray(new Integer[0]));</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    Arrays.sort(sortedWidths);</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    return sortedWidths;</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 5-6 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">CodeAnalyzer.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7c" class="pf w1 h2" data-page-no="7c"><div class="pc pc7c w1 h2"><img class="bi xd ya04 w4 h5f" alt="" src="bg7c.png"/><div class="t m0 x16 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">93</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">6</div><div class="t m0 xbc h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Objects and Data Structur<span class="_ _1"></span>es</div><div class="t m0 xd h14 ya05 ff8 fs3 fc0 sc0 ls0 ws44a">There is a reason that w<span class="_ _4"></span>e keep our v<span class="_ _4"></span>ariables pri<span class="_ _4"></span>vate. <span class="_ _4"></span>W<span class="_ _0"></span>e don’<span class="_ _4"></span>t want an<span class="_ _1"></span>yone else to depend</div><div class="t m0 xd h14 ya06 ff8 fs3 fc0 sc0 ls0 ws11e">on them. <span class="_ _4"></span>W<span class="_ _0"></span>e want to keep the freedom to change their type or implementation on a w<span class="_ _4"></span>him</div><div class="t m0 xd h14 ya07 ff8 fs3 fc0 sc0 ls0 ws275">or an impulse. <span class="_ _4"></span>Why<span class="_ _0"></span>, then, do so many pro<span class="_ _1"></span>g<span class="_ _8"></span>rammers automatically add getters and setters</div><div class="t m0 xd h14 ya08 ff8 fs3 fc0 sc0 ls0 ws0">to their objects, exposing their pri<span class="_ _4"></span>vate v<span class="_ _4"></span>ariables as if the<span class="_ _4"></span>y w<span class="_ _4"></span>ere public?</div><div class="t m0 xd h17 ya09 ff1 fs9 fc0 sc0 ls0 ws20d">Data Abstraction</div><div class="t m0 xd h14 ya0a ff8 fs3 fc0 sc0 ls0 ws4ab">Consider the dif<span class="_ _4"></span>ference between Listing 6-1 and Listing 6-2. Both represent the data of a</div><div class="t m0 xd h14 ya0b ff8 fs3 fc0 sc0 ls0 ws25">point on the Cartesian plane. <span class="_ _4"></span>And yet one e<span class="_ _4"></span>xposes its implementation and the other com-</div><div class="t m0 xd h14 ya0c ff8 fs3 fc0 sc0 ls0 ws0">pletely hides it. </div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:147.171000px;bottom:440.027010px;width:291.913000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:94.704110px;width:101.713000px;height:15.595900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7d" class="pf w1 h2" data-page-no="7d"><div class="pc pc7d w1 h2"><img class="bi xd ya0d wc h60" alt="" src="bg7d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">94<span class="_ _26"> </span><span class="ff1 ws305">Chapter 6:<span class="_ _4"></span> Objects and Data Structures</span></div><div class="t m0 x74 h14 y6fb ff8 fs3 fc0 sc0 ls0 ws4ac">The beautiful thing about Listing 6-2 is that there is no wa<span class="_ _1"></span>y you can tell w<span class="_ _4"></span>hether the</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 ls0 ws4ad">implementation is in rectangular or polar coordinates. It might be neither! <span class="_ _1"></span>And yet the</div><div class="t m0 xd h14 y32d ff8 fs3 fc0 sc0 ls0 ws0">interface still unmistakabl<span class="_ _4"></span>y represents a data str<span class="_ _8"></span>ucture.</div><div class="t m0 x74 h14 y51c ff8 fs3 fc0 sc0 ls0 ws4ae">But it represents more than just a data structure. <span class="_ _4"></span>The methods enforce an access</div><div class="t m0 xd h14 y51d ff8 fs3 fc0 sc0 lsd ws4af">policy<span class="_ _0"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can read the individual coordinates independentl<span class="_ _1"></span>y<span class="_ _1"></span>, but you must set the coordi-</div><div class="t m0 xd h14 y51e ff8 fs3 fc0 sc0 ls0 ws0">nates together as an atomic operation. </div><div class="t m0 x74 h14 y51f ff8 fs3 fc0 sc0 ls0 ws32">Listing 6-1, on the other hand<span class="_ _1"></span>, is very clearly implemented in rectangular coordinates,</div><div class="t m0 xd h14 y520 ff8 fs3 fc0 sc0 ls0 wsd5">and it forces us to manipulate those coordinates independently<span class="_ _0"></span>. <span class="_ _1"></span>This exposes implementa-</div><div class="t m0 xd h14 y521 ff8 fs3 fc0 sc0 ls0 wsd6">tion. Indeed<span class="_ _1"></span>, it w<span class="_ _4"></span>ould expose implementation ev<span class="_ _4"></span>en if the variab<span class="_ _4"></span>les w<span class="_ _4"></span>ere priv<span class="_ _4"></span>ate and w<span class="_ _4"></span>e</div><div class="t m0 xd h14 ya0e ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ere using single variab<span class="_ _4"></span>le getters and setters. </div><div class="t m0 x74 h14 y9d6 ff8 fs3 fc0 sc0 ls12 ws356">Hiding implementation is not just a matter of putting a la<span class="_ _4"></span>yer of functions betw<span class="_ _4"></span>een</div><div class="t m0 xd h14 y9d7 ff8 fs3 fc0 sc0 ls12 ws4b0">the variab<span class="_ _4"></span>les. Hiding implementation is about abstractions! <span class="_ _1"></span>A class does not simply</div><div class="t m0 xd h14 ya0f ff8 fs3 fc0 sc0 ls12 ws345">push <span class="_ _0"></span>its variab<span class="_ _4"></span>les out through getters and setters. Rather it exposes abstract interfaces</div><div class="t m0 xd h14 ya10 ff8 fs3 fc0 sc0 ls12 ws4b1">that allo<span class="_ _4"></span>w its users to manipulate the <span class="ffa ws0">essence<span class="_ _15"> </span></span>of the data, without ha<span class="_ _4"></span>ving to kno<span class="_ _4"></span>w its</div><div class="t m0 xd h14 ya11 ff8 fs3 fc0 sc0 ls12 ws0">implementation.</div><div class="t m0 x74 h14 ya12 ff8 fs3 fc0 sc0 ls0 ws49e">Consider Listing 6-3 and Listing 6-4. <span class="_ _1"></span>The ﬁrst uses concrete ter<span class="_ _8"></span>ms to communicate</div><div class="t m0 xd h14 ya13 ff8 fs3 fc0 sc0 ls0 ws4b2">the fuel le<span class="_ _4"></span>vel of a vehicle, w<span class="_ _4"></span>hereas the second does so with the abstraction of percentage.</div><div class="t m0 xd h14 ya14 ff8 fs3 fc0 sc0 ls0 ws27d">In the concrete case you can be pretty sure that these are just accessors of v<span class="_ _4"></span>ariables. In the</div><div class="t m0 xd h14 y70e ff8 fs3 fc0 sc0 ls0 ws0">abstract case you ha<span class="_ _1"></span>ve no clue at all about the form of the data.  </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-1</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Concrete Point</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public class Point {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  public double x;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  public double y;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y299 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-2</div><div class="t m0 x74 h36 ya15 ffc fs3 fc0 sc0 ls0 ws0">Abstract Point</div><div class="t m5 x74 h2f ya16 ffb fs10 fc0 sc0 ls0 ws0">public interface Point {</div><div class="t m5 x74 h2f ya17 ffb fs10 fc0 sc0 ls0 ws0">  double getX();</div><div class="t m5 x74 h2f ya18 ffb fs10 fc0 sc0 ls0 ws0">  double getY();</div><div class="t m5 x74 h2f ya19 ffb fs10 fc0 sc0 ls0 ws0">  void setCartesian(double x, double y);</div><div class="t m5 x74 h2f ya1a ffb fs10 fc0 sc0 ls0 ws0">  double getR();</div><div class="t m5 x74 h2f ya1b ffb fs10 fc0 sc0 ls0 ws0">  double getTheta();</div><div class="t m5 x74 h2f ya1c ffb fs10 fc0 sc0 ls0 ws0">  void setPolar(double r, double theta);</div><div class="t m5 x74 h2f ya1d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c ya1e ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-3</div><div class="t m0 x74 h36 y6dd ffc fs3 fc0 sc0 ls0 ws0">Concrete Vehicle</div><div class="t m5 x74 h2f ya1f ffb fs10 fc0 sc0 ls0 ws0">public interface Vehicle {</div><div class="t m5 x74 h2f ya20 ffb fs10 fc0 sc0 ls0 ws0">  double getFuelTankCapacityInGallons();</div><div class="t m5 x74 h2f ya21 ffb fs10 fc0 sc0 ls0 ws0">  double getGallonsOfGasoline();</div><div class="t m5 x74 h2f ya22 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7e" class="pf w1 h2" data-page-no="7e"><div class="pc pc7e w1 h2"><img class="bi xd ya23 wc h61" alt="" src="bg7e.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">95<span class="_ _10"></span><span class="ff1 ws1fc">Data/Object Anti-Symmetry</span></div><div class="t m0 x74 h14 ya24 ff8 fs3 fc0 sc0 ls0 ws4b3">In both of the abo<span class="_ _4"></span>ve cases the second option is preferab<span class="_ _4"></span>le. W<span class="_ _2"></span>e do not want to expose</div><div class="t m0 xd h14 ya25 ff8 fs3 fc0 sc0 ls0 ws4b4">the details of our data. Rather w<span class="_ _4"></span>e want to e<span class="_ _4"></span>xpress our data in abstract ter<span class="_ _8"></span>ms. <span class="_ _4"></span>This is not</div><div class="t m0 xd h14 ya26 ff8 fs3 fc0 sc0 ls0 wsd8">merely accomplished b<span class="_ _1"></span>y using interf<span class="_ _8"></span>aces and/or getters and setters. Serious thought needs</div><div class="t m0 xd h14 ya27 ff8 fs3 fc0 sc0 ls0 ws3b7">to be put into the best wa<span class="_ _1"></span>y to represent the data that an object contains. <span class="_ _4"></span>The w<span class="_ _4"></span>orst option is</div><div class="t m0 xd h14 ya28 ff8 fs3 fc0 sc0 ls0 ws0">to blithel<span class="_ _4"></span>y add getters and setters.</div><div class="t m0 xd h17 ya29 ff1 fs9 fc0 sc0 ls0 ws20d">Data/Object Anti-Symmetry</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls0 ws22b">These tw<span class="_ _4"></span>o examples sho<span class="_ _1"></span>w the difference betw<span class="_ _4"></span>een objects and data str<span class="_ _8"></span>uctures. Objects hide</div><div class="t m0 xd h14 ya2a ff8 fs3 fc0 sc0 ls0 ws4b5">their data behind abstractions and expose functions that operate on that data. Data struc-</div><div class="t m0 xd h14 y28 ff8 fs3 fc0 sc0 lsc ws308">ture expose their data and ha<span class="_ _1"></span>ve no meaningful functions. Go back and read that again.</div><div class="t m0 xd h14 ya2b ff8 fs3 fc0 sc0 ls0 ws4b6">Notice the complimentary nature of the two deﬁnitions. <span class="_ _1"></span>They are virtual opposites. <span class="_ _4"></span>This</div><div class="t m0 xd h14 ya2c ff8 fs3 fc0 sc0 lsd wsef">difference ma<span class="_ _1"></span>y seem trivial, but it has far-reaching implications.</div><div class="t m0 x74 h14 y803 ff8 fs3 fc0 sc0 ls0 ws4b7">Consider<span class="_ _4"></span>, for example, the procedural shape e<span class="_ _4"></span>xample in Listing 6-5. <span class="_ _4"></span>The </div><div class="t m5 xd9 h2f y2c3 ffb fs10 fc0 sc0 ls0 ws0">Geometry</div><div class="t m0 xd h14 y2c4 ff8 fs3 fc0 sc0 ls0 ws21b">class operates on the three shape classes. <span class="_ _1"></span>The shape classes are simple data str<span class="_ _8"></span>uctures</div><div class="t m0 xd h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws0">without an<span class="_ _4"></span>y behavior<span class="_ _1"></span>. <span class="_ _1"></span>All the behavior is in the </div><div class="t m5 x68 h2f y2c5 ffb fs10 fc0 sc0 ls0 ws0">Geometry</div><div class="t m0 x85 h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws0"> class.</div><div class="t m0 x74 h1c ya2d ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-4</div><div class="t m0 x74 h36 ya2e ffc fs3 fc0 sc0 ls0 ws0">Abstract Vehicle</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public interface Vehicle {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  double getPercentFuelRemaining();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y414 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-5 </div><div class="t m0 x74 h36 y46a ffc fs3 fc0 sc0 ls0 ws0">Procedural Shape</div><div class="t m5 x74 h2f ya2f ffb fs10 fc0 sc0 ls0 ws0">public class Square {</div><div class="t m5 x74 h2f ya30 ffb fs10 fc0 sc0 ls0 ws0">  public Point topLeft;</div><div class="t m5 x74 h2f ya31 ffb fs10 fc0 sc0 ls0 ws0">  public double side;</div><div class="t m5 x74 h2f ya32 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f ya33 ffb fs10 fc0 sc0 ls0 ws0">public class Rectangle {</div><div class="t m5 x74 h2f ya34 ffb fs10 fc0 sc0 ls0 ws0">  public Point topLeft;</div><div class="t m5 x74 h2f ya35 ffb fs10 fc0 sc0 ls0 ws0">  public double height;</div><div class="t m5 x74 h2f ya36 ffb fs10 fc0 sc0 ls0 ws0">  public double width;</div><div class="t m5 x74 h2f ya37 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f ya38 ffb fs10 fc0 sc0 ls0 ws0">public class Circle {</div><div class="t m5 x74 h2f ya39 ffb fs10 fc0 sc0 ls0 ws0">  public Point center;</div><div class="t m5 x74 h2f ya3a ffb fs10 fc0 sc0 ls0 ws0">  public double radius;</div><div class="t m5 x74 h2f ya3b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f ya3c ffb fs10 fc0 sc0 ls0 ws0">public class Geometry {</div><div class="t m5 x74 h2f ya3d ffb fs10 fc0 sc0 ls0 ws0">  public final double PI = 3.141592653589793;</div><div class="t m5 x74 h2f ya3e ffb fs10 fc0 sc0 ls0 ws0">  public double area(Object shape) throws NoSuchShapeException </div><div class="t m5 x74 h2f ya3f ffb fs10 fc0 sc0 ls1c ws0">  {</div><div class="t m5 x74 h2f ya40 ffb fs10 fc0 sc0 ls0 ws0">    if (shape instanceof Square) {</div><div class="t m5 x74 h2f ya41 ffb fs10 fc0 sc0 ls0 ws0">      Square s = (Square)shape;</div><div class="t m5 x74 h2f ya42 ffb fs10 fc0 sc0 ls0 ws0">      return s.side * s.side;</div><div class="t m5 x74 h2f ya43 ffb fs10 fc0 sc0 ls0 ws0">    }</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:434.945010px;width:168.713000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf7f" class="pf w1 h2" data-page-no="7f"><div class="pc pc7f w1 h2"><img class="bi xd y3e9 wc h62" alt="" src="bg7f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">96<span class="_ _26"> </span><span class="ff1 ws305">Chapter 6:<span class="_ _4"></span> Objects and Data Structures</span></div><div class="t m0 x74 h14 ya44 ff8 fs3 fc0 sc0 ls16 ws4b8">Object-oriented pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers might wrinkle their noses at this and complain that it</div><div class="t m0 xd h14 ya45 ff8 fs3 fc0 sc0 ls16 ws4b4">is procedural—and they’<span class="_ _3"></span>d be right. But the sneer may not be w<span class="_ _1"></span>ar<span class="_ _5"></span>ranted. Consider what</div><div class="t m0 xd h14 ya46 ff8 fs3 fc0 sc0 ls16 ws4b9">w<span class="_ _4"></span>ould happen if a </div><div class="t m5 x18 h2f y4de ffb fs10 fc0 sc0 ls31 ws0">perimeter()</div><div class="t m0 x38 h14 y4de ff8 fs3 fc0 sc0 ls4e ws23e"> function w<span class="_ _4"></span>ere added to </div><div class="t m5 xb7 h2f y4de ffb fs10 fc0 sc0 ls31 ws0">Geometry</div><div class="t m0 x55 h14 y4de ff8 fs3 fc0 sc0 ls16 ws4b9">. <span class="_ _1"></span>The shape classes would</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws4ba">be unaffected! <span class="_ _0"></span>Any other classes that depended upon the shapes w<span class="_ _4"></span>ould also be unaffected!</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls16 ws4bb">On the other hand<span class="_ _1"></span>, if I add a new shape, I must change all the functions in </div><div class="t m5 x98 h2f y4e0 ffb fs10 fc0 sc0 ls31 ws0">Geometry</div><div class="t m0 x1d h14 y4e0 ff8 fs3 fc0 sc0 ls16 ws0">to</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls16 ws4bc">deal with it. <span class="_ _1"></span>Again, read that o<span class="_ _4"></span>ver<span class="_ _1"></span>. Notice that the two conditions are diametricall<span class="_ _4"></span>y</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls16 ws0">opposed.</div><div class="t m0 x74 h14 y2a ff8 fs3 fc0 sc0 ls0 ws124">No<span class="_ _4"></span>w consider the object-oriented solution in Listing 6-6. Here the </div><div class="t m5 x4a h2f y2a ffb fs10 fc0 sc0 ls0 ws0">area()</div><div class="t m0 xda h14 y2a ff8 fs3 fc0 sc0 ls0 ws124">method is</div><div class="t m0 xd h14 y2b ff8 fs3 fc0 sc0 ls0 ws4b9">polymorphic. No </div><div class="t m5 x6 h2f y2b ffb fs10 fc0 sc0 ls0 ws0">Geometry</div><div class="t m0 x7 h14 y2b ff8 fs3 fc0 sc0 ls2b ws225"> class is necessary<span class="_ _1"></span>. So if I add a new shape, none of the e<span class="_ _4"></span>xisting</div><div class="t m0 xd h14 y2c ffa fs3 fc0 sc0 ls0 ws0">functions<span class="ff8 lsd wsef"> are af<span class="_ _4"></span>fected<span class="_ _4"></span>, but if I add a new function all of the <span class="_ _4"></span><span class="ffa ls0 ws0">shapes<span class="ff8"> must be changed!</span></span></span></div><div class="t m0 x36 h21 y51e ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    else if (shape instanceof Rectangle) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      Rectangle r = (Rectangle)shape;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      return r.height * r.width;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    else if (shape instanceof Circle) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      Circle c = (Circle)shape;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">      return PI * c.radius * c.radius;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    throw new NoSuchShapeException();</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y2c7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-6 </div><div class="t m0 x74 h36 y30f ffc fs3 fc0 sc0 ls0 ws0">Polymorphic Shapes</div><div class="t m5 x74 h2f y63d ffb fs10 fc0 sc0 ls0 ws0">public class Square implements Shape {</div><div class="t m5 x74 h2f ya47 ffb fs10 fc0 sc0 ls0 ws0">  private Point topLeft;</div><div class="t m5 x74 h2f ya48 ffb fs10 fc0 sc0 ls0 ws0">  private double side;</div><div class="t m5 x74 h2f ya49 ffb fs10 fc0 sc0 ls0 ws0">  public double area() {</div><div class="t m5 x74 h2f ya4a ffb fs10 fc0 sc0 ls0 ws0">    return side*side;</div><div class="t m5 x74 h2f ya4b ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya4c ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f ya4d ffb fs10 fc0 sc0 ls0 ws0">public class Rectangle implements Shape {</div><div class="t m5 x74 h2f ya4e ffb fs10 fc0 sc0 ls0 ws0">  private Point topLeft;</div><div class="t m5 x74 h2f ya4f ffb fs10 fc0 sc0 ls0 ws0">  private double height;</div><div class="t m5 x74 h2f ya50 ffb fs10 fc0 sc0 ls0 ws0">  private double width;</div><div class="t m5 x74 h2f ya51 ffb fs10 fc0 sc0 ls0 ws0">  public double area() {</div><div class="t m5 x74 h2f ya52 ffb fs10 fc0 sc0 ls0 ws0">    return height * width;</div><div class="t m5 x74 h2f ya53 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya54 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>There are w<span class="_ _4"></span>ays around this that are w<span class="_ _4"></span>ell kno<span class="_ _4"></span>wn to experienced object-oriented designers: V<span class="_ _4"></span><span class="fs15 ls4f">ISITOR<span class="fse ls0">, or dual-dispatch, for </span></span></div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">example. But these techniques carry costs of their own and generally return the structure to that of a procedural program.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Procedural Shape</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf80" class="pf w1 h2" data-page-no="80"><div class="pc pc80 w1 h2"><img class="bi xd ya55 wc h63" alt="" src="bg80.png"/><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">97<span class="_ _10"></span><span class="ff1">The La<span class="_ _1"></span>w of Demeter</span></div><div class="t m0 x74 h14 y75e ff8 fs3 fc0 sc0 lsc ws4bd">Again, w<span class="_ _4"></span>e see the complimentar<span class="_ _8"></span>y nature of these tw<span class="_ _4"></span>o deﬁnitions; they are virtual</div><div class="t m0 xd h14 ya56 ff8 fs3 fc0 sc0 ls0 ws0">opposites! <span class="_ _1"></span>This exposes the fundamental dichotom<span class="_ _4"></span>y between objects and data structures: </div><div class="t m0 x74 h29 y97e ffa fsf fc0 sc0 ls0 ws4be">Pr<span class="_ _4"></span>ocedur<span class="_ _4"></span>al code (code using data structur<span class="_ _4"></span>es) makes it easy to add new functions without</div><div class="t m0 x74 h29 ya57 ffa fsf fc0 sc0 ls0 ws281">changing the existing data structur<span class="_ _4"></span>es. OO code, on the other hand, makes it easy to add</div><div class="t m0 x74 h29 ya58 ffa fsf fc0 sc0 ls0 ws0">new c<span class="_ _4"></span>lasses without changing existing functions.</div><div class="t m0 x74 h14 y9d0 ff8 fs3 fc0 sc0 ls0 ws0">The complement is also true: </div><div class="t m0 x74 h29 ya59 ffa fsf fc0 sc0 ls0 ws4bf">Pr<span class="_ _4"></span>ocedur<span class="_ _4"></span>al code makes it har<span class="_ _4"></span>d to add new data structur<span class="_ _4"></span>es because all the functions must</div><div class="t m0 x74 h29 ya5a ffa fsf fc0 sc0 ls0 ws0">change<span class="_ _4"></span>. OO code makes it har<span class="_ _4"></span>d to add new functions because all the classes must c<span class="_ _4"></span>hange.</div><div class="t m0 x74 h14 y51d ff8 fs3 fc0 sc0 ls0 ws302">So, the things that are hard for OO are easy for procedures, and the things that are</div><div class="t m0 xd h14 y51e ff8 fs3 fc0 sc0 ls0 ws0">hard for procedures are easy for OO!</div><div class="t m0 x74 h14 y51f ff8 fs3 fc0 sc0 ls0 ws1ba">In any comple<span class="_ _4"></span>x system there are going to be times when w<span class="_ _1"></span>e want to add ne<span class="_ _4"></span>w data</div><div class="t m0 xd h14 y520 ff8 fs3 fc0 sc0 ls0 ws234">types rather than ne<span class="_ _4"></span>w functions. F<span class="_ _4"></span>or these cases objects and OO are most appropriate. On</div><div class="t m0 xd h14 y521 ff8 fs3 fc0 sc0 ls0 ws4c0">the other hand<span class="_ _1"></span>, there will also be times when w<span class="_ _4"></span>e’<span class="_ _4"></span>ll want to add ne<span class="_ _4"></span>w functions as opposed</div><div class="t m0 xd h14 ya0e ff8 fs3 fc0 sc0 ls0 ws0">to data types. In that case procedural code and data structures will be more appropriate.</div><div class="t m0 x74 h14 y9d6 ff8 fs3 fc0 sc0 ls0 ws4c1">Mature pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers kno<span class="_ _4"></span>w that the idea that everything is an object <span class="ffa">is a myth</span>. Some-</div><div class="t m0 xd h14 y9d7 ff8 fs3 fc0 sc0 ls0 ws0">times you reall<span class="_ _4"></span>y <span class="ffa">do</span> w<span class="_ _4"></span>ant simple data str<span class="_ _8"></span>uctures with procedures operating on them.</div><div class="t m0 xd h17 ya5b ff1 fs9 fc0 sc0 ls0 ws0">The La<span class="_ _1"></span>w of Demeter</div><div class="t m0 xd h14 y393 ff8 fs3 fc0 sc0 ls0 ws195">There is a w<span class="_ _4"></span>ell-kno<span class="_ _4"></span>wn heuristic called the <span class="ffa">Law of Demeter</span></div><div class="t m0 xc2 h21 y2cd ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xc9 h14 y393 ff8 fs3 fc0 sc0 ls0 ws195">that sa<span class="_ _4"></span>ys a module should not</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws3a5">kno<span class="_ _4"></span>w about the innards of the <span class="ffa ws0">objects </span>it manipulates. <span class="_ _1"></span>As we sa<span class="_ _1"></span>w in the last section, objects</div><div class="t m0 xd h14 y395 ff8 fs3 fc0 sc0 ls0 ws4c2">hide their data and expose operations. <span class="_ _1"></span>This means that an object should not expose its</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws4c3">internal str<span class="_ _8"></span>ucture through accessors because to do so is to expose, rather than to hide, its</div><div class="t m0 xd h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">internal str<span class="_ _8"></span>ucture. </div><div class="t m0 x74 h14 y398 ff8 fs3 fc0 sc0 ls0 ws1ad">More precisely<span class="_ _0"></span>, the La<span class="_ _1"></span>w of Demeter says that a method <span class="ffa ws0">f </span>of a class <span class="ffa ws0">C </span>should only call</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">the methods of these:</div><div class="t m0 x2c h1d ya5c ffa fs3 fc0 sc0 ls50 ws0">•C</div><div class="t m0 x2c h14 ya5d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>An object created b<span class="_ _4"></span>y <span class="ffa">f</span></div><div class="t m5 x74 h2f ya5e ffb fs10 fc0 sc0 ls0 ws0">public class Circle implements Shape {</div><div class="t m5 x74 h2f ya5f ffb fs10 fc0 sc0 ls0 ws0">  private Point center;</div><div class="t m5 x74 h2f ya60 ffb fs10 fc0 sc0 ls0 ws0">  private double radius;</div><div class="t m5 x74 h2f ya61 ffb fs10 fc0 sc0 ls0 ws0">  public final double PI = 3.141592653589793;</div><div class="t m5 x74 h2f ya62 ffb fs10 fc0 sc0 ls0 ws0">  public double area() {</div><div class="t m5 x74 h2f ya63 ffb fs10 fc0 sc0 ls0 ws0">    return PI * radius * radius;</div><div class="t m5 x74 h2f ya64 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya65 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 ya66 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>http://en.wikipedia.or<span class="_ _4"></span>g/wiki/Law_of_Demeter </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-6 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Polymorphic Shapes</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:222.944010px;width:122.543000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Law_of_Demeter"><div class="d m1" style="border-style:none;position:absolute;left:90.830700px;bottom:54.449110px;width:129.080300px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf81" class="pf w1 h2" data-page-no="81"><div class="pc pc81 w1 h2"><img class="bi x37 y384 w9 h64" alt="" src="bg81.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">98<span class="_ _26"> </span><span class="ff1 ws305">Chapter 6:<span class="_ _4"></span> Objects and Data Structures</span></div><div class="t m0 x2c h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>An object passed as an argument to <span class="ffa">f</span></div><div class="t m0 x2c h14 y4b8 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>An object held in an instance v<span class="_ _4"></span>ariable of <span class="ffa">C</span></div><div class="t m0 x74 h14 ya67 ff8 fs3 fc0 sc0 ls0 ws4c4">The method should <span class="ffa ws0">not<span class="_ _15"> </span></span>in<span class="_ _4"></span>voke methods on objects that are returned b<span class="_ _4"></span>y any of the</div><div class="t m0 xd h14 ya68 ff8 fs3 fc0 sc0 ls0 ws0">allo<span class="_ _4"></span>w<span class="_ _4"></span>ed functions. In other w<span class="_ _4"></span>ords, talk to friends, not to strangers.</div><div class="t m0 x74 h14 ya69 ff8 fs3 fc0 sc0 ls0 ws4c5">The follo<span class="_ _4"></span>wing code</div><div class="t m0 xa h21 y199 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x7 h14 ya6a ff8 fs3 fc0 sc0 ls0 ws4c5">appears to violate the La<span class="_ _4"></span>w of Demeter (among other things)</div><div class="t m0 xd h14 ya6b ff8 fs3 fc0 sc0 ls0 ws4c6">because it calls the </div><div class="t m5 xba h2f ya6b ffb fs10 fc0 sc0 ls0 ws0">getScratchDir()</div><div class="t m0 xd1 h14 ya6b ff8 fs3 fc0 sc0 ls0 ws4c6">function on the return value of </div><div class="t m5 x82 h2f ya6b ffb fs10 fc0 sc0 ls0 ws0">getOptions()</div><div class="t m0 xd9 h14 ya6b ff8 fs3 fc0 sc0 ls0 ws4c6">and then</div><div class="t m0 xd h14 y5da ff8 fs3 fc0 sc0 ls0 ws0">calls</div><div class="t m5 x8e h2f y5da ffb fs10 fc0 sc0 ls0 ws0">getAbsolutePath()</div><div class="t m0 x2e h14 y5da ff8 fs3 fc0 sc0 ls0 ws0"> on the return value of </div><div class="t m5 x65 h2f y5da ffb fs10 fc0 sc0 ls0 ws0">getScratchDir()</div><div class="t m0 xca h14 y5da ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f ya16 ffb fs10 fc0 sc0 ls0 ws0">final String outputDir = ctxt.getOptions().getScratchDir().getAbsolutePath();</div><div class="t m0 xd h11 ya6c ff1 fs7 fc0 sc0 ls0 ws13">T<span class="_ _0"></span>rain Wr<span class="_ _4"></span>ecks</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws15d">This kind of code is often called a <span class="ffa">tr<span class="_ _4"></span>ain wr<span class="_ _4"></span>eck <span class="ff8 lsd ws48d">because it look lik<span class="_ _4"></span>e a bunch of coupled train</span></span></div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws4c7">cars. Chains of calls like this are generall<span class="_ _4"></span>y considered to be sloppy style and should be</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws0">a<span class="_ _4"></span>voided [G36]. It is usuall<span class="_ _4"></span>y best to split them up as follo<span class="_ _4"></span>ws:</div><div class="t m5 x74 h2f ya6d ffb fs10 fc0 sc0 ls0 ws0">Options opts = ctxt.getOptions();</div><div class="t m5 x74 h2f ya6e ffb fs10 fc0 sc0 ls0 ws0">File scratchDir = opts.getScratchDir();</div><div class="t m5 x74 h2f ya6f ffb fs10 fc0 sc0 ls0 ws0">final String outputDir = scratchDir.getAbsolutePath();</div><div class="t m0 x74 h14 y38a ff8 fs3 fc0 sc0 ls0 wsf9">Are these tw<span class="_ _4"></span>o snippets of code viola-</div><div class="t m0 xd h14 y38b ff8 fs3 fc0 sc0 ls0 ws4c8">tions of the La<span class="_ _4"></span>w of Demeter? Certainly</div><div class="t m0 xd h14 y282 ff8 fs3 fc0 sc0 ls0 ws4c9">the containing module kno<span class="_ _4"></span>ws that the</div><div class="t m5 xd h2f y3c0 ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 x8e h14 y3c0 ff8 fs3 fc0 sc0 ls0 ws243">object contains options, which con-</div><div class="t m0 xd h14 y3c1 ff8 fs3 fc0 sc0 ls0 ws4ca">tain a scratch directory<span class="_ _1"></span>, which has an</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls0 ws4cb">absolute path. <span class="_ _1"></span>That’<span class="_ _0"></span>s a lot of kno<span class="_ _1"></span>wledge</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls0 ws4cc">for one function to kno<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>The calling</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 lsc ws4cd">function kno<span class="_ _4"></span>ws ho<span class="_ _4"></span>w to na<span class="_ _4"></span>vigate through</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws0">a lot of different objects.</div><div class="t m0 x74 h14 y2ba ff8 fs3 fc0 sc0 ls0 ws3c5">Whether this is a violation of Demeter depends on whether or not </div><div class="t m5 xac h2f y2ba ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 x5e h14 y2ba ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xa6 h2f y2ba ffb fs10 fc0 sc0 ls0 ws0">Options</div><div class="t m0 xd8 h14 y2ba ff8 fs3 fc0 sc0 ls0 ws0">,<span class="_ _28"> </span>and</div><div class="t m5 xd h2f y226 ffb fs10 fc0 sc0 ls0 ws0">ScratchDir</div><div class="t m0 x4c h14 y226 ff8 fs3 fc0 sc0 ls0 ws4ce">are<span class="_ _1d"> </span>objects or data str<span class="_ _8"></span>uctures. If they are objects, then their internal str<span class="_ _8"></span>ucture</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws4c3">should be hidden rather than exposed<span class="_ _1"></span>, and so kno<span class="_ _4"></span>wledge of their innards is a clear viola-</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws4cf">tion of the La<span class="_ _4"></span>w of Demeter<span class="_ _1"></span>. On the other hand<span class="_ _4"></span>, if </div><div class="t m5 xb2 h2f y228 ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 x85 h14 y228 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xdb h2f y228 ffb fs10 fc0 sc0 ls0 ws0">Options</div><div class="t m0 xa0 h14 y228 ff8 fs3 fc0 sc0 ls0 ws4cf">, and </div><div class="t m5 xac h2f y228 ffb fs10 fc0 sc0 ls0 ws0">ScratchDir</div><div class="t m0 x64 h14 y228 ff8 fs3 fc0 sc0 ls0 ws4cf">are just</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws3f">data structures with no behavior<span class="_ _1"></span>, then they naturally e<span class="_ _4"></span>xpose their inter<span class="_ _8"></span>nal structure, and so</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws0">Demeter does not apply<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y22b ff8 fs3 fc0 sc0 ls0 ws152">The use of accessor functions confuses the issue. If the code had been written as fol-</div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws0">lo<span class="_ _4"></span>ws, then w<span class="_ _4"></span>e probabl<span class="_ _4"></span>y w<span class="_ _4"></span>ouldn’<span class="_ _4"></span>t be asking about Demeter violations.</div><div class="t m5 x74 h2f ya70 ffb fs10 fc0 sc0 ls0 ws0">final String outputDir = ctxt.options.scratchDir.absolutePath;</div><div class="t m0 x74 h14 y3c9 ff8 fs3 fc0 sc0 ls0 wsa0">This issue w<span class="_ _4"></span>ould be a lot less confusing if data structures simply had public v<span class="_ _4"></span>ariables</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws2d2">and no functions, whereas objects had pri<span class="_ _4"></span>v<span class="_ _4"></span>ate variab<span class="_ _4"></span>les and public functions. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er<span class="_ _4"></span>,</div><div class="t m0 xd h25 ya71 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>F<span class="_ _1"></span>ound somewhere in the apache frame<span class="_ _4"></span>work. </div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:455.728010px;width:69.465000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf82" class="pf w1 h2" data-page-no="82"><div class="pc pc82 w1 h2"><div class="t m0 x16 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">99<span class="_ _10"></span><span class="ff1">The La<span class="_ _1"></span>w of Demeter</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws4d0">there are framew<span class="_ _1"></span>orks and standards (e.g., “beans”) that demand that ev<span class="_ _4"></span>en simple data</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">structures hav<span class="_ _4"></span>e accessors and mutators.</div><div class="t m0 xd h11 y56c ff1 fs7 fc0 sc0 ls0 ws0">Hybrids</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws40d">This confusion sometimes leads to unfortunate hybrid structures that are half object and</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws4d1">half data structure. <span class="_ _4"></span>They ha<span class="_ _4"></span>ve functions that do signiﬁcant things, and they also ha<span class="_ _1"></span>ve either</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws4d2">public v<span class="_ _4"></span>ariables or pub<span class="_ _4"></span>lic accessors and mutators that, for all intents and pur<span class="_ _8"></span>poses, make</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws4d3">the priv<span class="_ _1"></span>ate variables pub<span class="_ _4"></span>lic, tempting other external functions to use those variab<span class="_ _4"></span>les the</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ay a procedural pro<span class="_ _4"></span>gram would use a data structure.</div><div class="t m0 x2a h21 y207 ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x74 h14 y2ab ff8 fs3 fc0 sc0 lsd wsef">Such h<span class="_ _4"></span>ybrids make it hard to add new functions but also mak<span class="_ _4"></span>e it hard to add new data</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws4d4">structures. <span class="_ _4"></span>They are the w<span class="_ _4"></span>orst of both w<span class="_ _4"></span>orlds. <span class="_ _4"></span>A<span class="_ _0"></span>v<span class="_ _4"></span>oid creating them. <span class="_ _4"></span>They are indicati<span class="_ _4"></span>ve of a</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws3cb">muddled design whose authors are unsure of—or w<span class="_ _1"></span>orse, ignorant of—whether they need</div><div class="t m0 xd h14 y6ce ff8 fs3 fc0 sc0 ls0 ws0">protection from functions or types.</div><div class="t m0 xd h11 ya73 ff1 fs7 fc0 sc0 ls0 ws0">Hiding Structur<span class="_ _4"></span>e</div><div class="t m0 xd h14 y465 ff8 fs3 fc0 sc0 ls0 ws4d5">What if </div><div class="t m5 xdc h2f y465 ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 x91 h14 y465 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x39 h2f y465 ffb fs10 fc0 sc0 ls0 ws0">options</div><div class="t m0 xd0 h14 y465 ff8 fs3 fc0 sc0 ls0 ws4d5">, and </div><div class="t m5 x5a h2f y465 ffb fs10 fc0 sc0 ls0 ws0">scratchDir</div><div class="t m0 x22 h14 y465 ff8 fs3 fc0 sc0 ls0 ws4d5">are objects with real beha<span class="_ _4"></span>vior? <span class="_ _4"></span>Then, because</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 lsc ws4d6">objects are supposed to hide their internal str<span class="_ _8"></span>ucture, we should not be ab<span class="_ _4"></span>le to na<span class="_ _4"></span>vigate</div><div class="t m0 xd h14 y539 ff8 fs3 fc0 sc0 ls0 ws0">through them. Ho<span class="_ _4"></span>w then w<span class="_ _4"></span>ould w<span class="_ _4"></span>e get the absolute path of the scratch director<span class="_ _8"></span>y? </div><div class="t m5 x74 h2f y901 ffb fs10 fc0 sc0 ls0 ws0">ctxt.getAbsolutePathOfScratchDirectoryOption();</div><div class="t m0 xd h14 y3c0 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x74 h2f ya74 ffb fs10 fc0 sc0 ls0 ws0">ctx.getScratchDirectoryOption().getAbsolutePath()</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws4d7">The ﬁrst option could lead to an explosion of methods in the ctxt object. <span class="_ _1"></span>The second pre-</div><div class="t m0 xd h14 y48d ff8 fs3 fc0 sc0 ls0 ws4d8">sumes that </div><div class="t m5 x4c h2f y48d ffb fs10 fc0 sc0 ls0 ws0">getScratchDirectoryOption()</div><div class="t m0 xdd h14 y48d ff8 fs3 fc0 sc0 ls0 ws4d8">returns a data str<span class="_ _8"></span>ucture, not an object. Neither</div><div class="t m0 xd h14 y48e ff8 fs3 fc0 sc0 ls0 ws0">option feels good.</div><div class="t m0 x74 h14 y54f ff8 fs3 fc0 sc0 ls0 ws0">If</div><div class="t m5 x52 h2f y54f ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 x4c h14 y54f ff8 fs3 fc0 sc0 ls0 ws426">is an object, w<span class="_ _4"></span>e should be telling it to <span class="ffa">do something; </span>w<span class="_ _4"></span>e should not be asking it</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws4d9">about its internals. So wh<span class="_ _4"></span>y did we w<span class="_ _4"></span>ant the absolute path of the scratch directory? What</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws14d">w<span class="_ _4"></span>ere w<span class="_ _4"></span>e going to do with it? Consider this code from (many lines farther down in) the</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws0">same module:</div><div class="t m5 x74 h2f ya75 ffb fs10 fc0 sc0 ls0 ws0">String outFile = outputDir + &quot;/&quot; + className.replace(&apos;.&apos;, &apos;/&apos;) + &quot;.class&quot;;</div><div class="t m5 x74 h2f ya76 ffb fs10 fc0 sc0 ls0 ws0">FileOutputStream fout = new FileOutputStream(outFile);</div><div class="t m5 x74 h2f ya77 ffb fs10 fc0 sc0 ls0 ws0">BufferedOutputStream bos = new BufferedOutputStream(fout);</div><div class="t m0 x74 h14 y585 ff8 fs3 fc0 sc0 ls0 ws2fc">The admixture of dif<span class="_ _4"></span>ferent levels of detail [G34][G6] is a bit troub<span class="_ _4"></span>ling. Dots, slashes,</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws313">ﬁle extensions, and </div><div class="t m5 xb h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">File</div><div class="t m0 x7d h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws313">objects should not be so carelessl<span class="_ _4"></span>y mixed to<span class="_ _4"></span>gether<span class="_ _4"></span>, and mixed</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws33d">with the enclosing code. Ignoring that, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, w<span class="_ _1"></span>e see that the intent of getting the abso-</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">lute path of the scratch directory was to create a scratch ﬁle of a gi<span class="_ _4"></span>ven name.</div><div class="t m0 xd h25 ya78 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>This is sometimes called F<span class="_ _1"></span>eature Envy from [Refactoring].</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:546.728010px;width:42.012000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:401.728010px;width:87.315000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf83" class="pf w1 h2" data-page-no="83"><div class="pc pc83 w1 h2"><img class="bi xd ya79 wc h65" alt="" src="bg83.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">100<span class="_ _29"> </span><span class="ff1 ws305">Chapter 6:<span class="_ _4"></span> Objects and Data Structures</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">So, what if w<span class="_ _1"></span>e told the </div><div class="t m5 xc7 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 xa2 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0"> object to do this? </div><div class="t m5 x74 h2f ya7a ffb fs10 fc0 sc0 ls0 ws0">BufferedOutputStream bos = ctxt.createScratchFileStream(classFileName);</div><div class="t m0 x74 h14 ya7b ff8 fs3 fc0 sc0 ls0 ws4da">That seems like a reasonab<span class="_ _4"></span>le thing for an object to do! <span class="_ _4"></span>This allo<span class="_ _4"></span>ws </div><div class="t m5 x6f h2f ya7b ffb fs10 fc0 sc0 ls0 ws0">ctxt</div><div class="t m0 xd3 h14 ya7b ff8 fs3 fc0 sc0 ls0 ws4da">to hide its</div><div class="t m0 xd h14 ya7c ff8 fs3 fc0 sc0 ls0 ws2bb">internals and prevents the current function from having to violate the La<span class="_ _1"></span>w of Demeter by</div><div class="t m0 xd h14 ya7d ff8 fs3 fc0 sc0 lsc ws3f">na<span class="_ _4"></span>vigating through objects it shouldn’<span class="_ _4"></span>t kno<span class="_ _4"></span>w about.</div><div class="t m0 xd h17 ya7e ff1 fs9 fc0 sc0 ls0 ws4db">Data T<span class="_ _0"></span>ransfer <span class="_ _5"></span>Objects</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 wsa6">The quintessential form of a data str<span class="_ _8"></span>ucture is a class with public v<span class="_ _4"></span>ariables and no func-</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls22 ws56">tions. <span class="_ _1"></span>This is sometimes called a data transfer object, or DTO<span class="_ _1"></span>. DTOs are v<span class="_ _4"></span>er<span class="_ _8"></span>y useful struc-</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws4dc">tures, especiall<span class="_ _4"></span>y when communicating with databases or parsing messages from sockets,</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws178">and so on. <span class="_ _1"></span>They often become the ﬁrst in a series of translation stages that con<span class="_ _4"></span>vert raw data</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws0">in a database into objects in the application code. </div><div class="t m0 x74 h14 y29c ff8 fs3 fc0 sc0 ls0 ws4dd">Some<span class="_ _4"></span>what more common is the “bean” form shown in Listing 6-7. Beans ha<span class="_ _1"></span>ve priv<span class="_ _4"></span>ate</div><div class="t m0 xd h14 ya7f ff8 fs3 fc0 sc0 ls0 ws4de">v<span class="_ _4"></span>ariables manipulated b<span class="_ _4"></span>y getters and setters. <span class="_ _4"></span>The quasi-encapsulation of beans seems to</div><div class="t m0 xd h14 y388 ff8 fs3 fc0 sc0 lsd wsef">make some OO purists feel better but usuall<span class="_ _4"></span>y pro<span class="_ _4"></span>vides no other beneﬁt.</div><div class="t m0 x74 h1c ya80 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-7 </div><div class="t m0 x74 h36 y38b ffc fs3 fc0 sc0 ls0 ws0">address.java</div><div class="t m5 x74 h2f ya81 ffb fs10 fc0 sc0 ls0 ws0">public class Address {</div><div class="t m5 x74 h2f ya82 ffb fs10 fc0 sc0 ls18 ws236">  private String street;</div><div class="t m5 x74 h2f ya83 ffb fs10 fc0 sc0 ls14 ws237">  private String streetExtra;</div><div class="t m5 x74 h2f ya84 ffb fs10 fc0 sc0 ls18 ws236">  private String city;</div><div class="t m5 x74 h2f ya85 ffb fs10 fc0 sc0 ls18 ws236">  private String state;</div><div class="t m5 x74 h2f ya86 ffb fs10 fc0 sc0 ls18 ws236">  private String zip;</div><div class="t m5 x74 h2f ya87 ffb fs10 fc0 sc0 ls14 ws253">  public Address(String street, String streetExtra, </div><div class="t m5 x74 h2f ya88 ffb fs10 fc0 sc0 ls1e ws253">                  String city, String state, String zip) {</div><div class="t m5 x74 h2f ya89 ffb fs10 fc0 sc0 ls19 ws237">    this.street = street;</div><div class="t m5 x74 h2f ya8a ffb fs10 fc0 sc0 ls19 ws237">    this.streetExtra = streetExtra;</div><div class="t m5 x74 h2f ya8b ffb fs10 fc0 sc0 ls19 ws237">    this.city = city;</div><div class="t m5 x74 h2f ya8c ffb fs10 fc0 sc0 ls19 ws237">    this.state = state;</div><div class="t m5 x74 h2f ya8d ffb fs10 fc0 sc0 ls19 ws237">    this.zip = zip;</div><div class="t m5 x74 h2f ya8e ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f ya8f ffb fs10 fc0 sc0 ls14 ws235">  public String getStreet() {</div><div class="t m5 x74 h2f ya90 ffb fs10 fc0 sc0 ls1a ws237">    return street;</div><div class="t m5 x74 h2f ya91 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f ya92 ffb fs10 fc0 sc0 ls14 ws235">  public String getStreetExtra() {</div><div class="t m5 x74 h2f ya93 ffb fs10 fc0 sc0 ls1f ws241">    return streetExtra;</div><div class="t m5 x74 h2f ya94 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f ya95 ffb fs10 fc0 sc0 ls14 ws235">  public String getCity() {</div><div class="t m5 x74 h2f ya96 ffb fs10 fc0 sc0 ls20 ws236">    return city;</div><div class="t m5 x74 h2f ya97 ffb fs10 fc0 sc0 ls1c ws0">  }</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:493.945010px;width:132.514000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf84" class="pf w1 h2" data-page-no="84"><div class="pc pc84 w1 h2"><img class="bi xd ya98 wc h66" alt="" src="bg84.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">101<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd h11 ya99 ff1 fs7 fc0 sc0 ls0 ws0">Activ<span class="_ _4"></span>e Record</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws4df">Activ<span class="_ _4"></span>e Records are special forms of DTOs. <span class="_ _1"></span>They are data structures with public (or bean-</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls11 ws118">accessed) v<span class="_ _4"></span>ariables; but they typicall<span class="_ _4"></span>y ha<span class="_ _4"></span>ve na<span class="_ _4"></span>vigational methods like </div><div class="t m5 x59 h2f y27b ffb fs10 fc0 sc0 ls0 ws0">save</div><div class="t m0 x6f h14 y27b ff8 fs3 fc0 sc0 ls51 ws2bc"> and </div><div class="t m5 x7a h2f y27b ffb fs10 fc0 sc0 ls0 ws0">find</div><div class="t m0 xa8 h14 y27b ff8 fs3 fc0 sc0 ls0 ws4e0">. T<span class="_ _2"></span>ypi-</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws4e1">call<span class="_ _4"></span>y these <span class="_ _4"></span>Activ<span class="_ _4"></span>e Records are direct translations from database tables, or other data</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws0">sources.</div><div class="t m0 x74 h14 ya7f ff8 fs3 fc0 sc0 ls0 ws22b">Unfortunately w<span class="_ _4"></span>e often ﬁnd that dev<span class="_ _4"></span>elopers tr<span class="_ _8"></span>y to treat these data structures as though</div><div class="t m0 xd h14 y388 ff8 fs3 fc0 sc0 lsd ws4e2">they w<span class="_ _1"></span>ere objects by putting business rule methods in them. <span class="_ _4"></span>This is a<span class="_ _4"></span>wkward because it</div><div class="t m0 xd h14 y389 ff8 fs3 fc0 sc0 ls0 ws0">creates a h<span class="_ _4"></span>ybrid between a data structure and an object. </div><div class="t m0 x74 h14 y29d ff8 fs3 fc0 sc0 ls0 ws48f">The solution, of course, is to treat the <span class="_ _1"></span>Active Record as a data structure and to create</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 lsd ws4e3">separate objects that contain the business rules and that hide their inter<span class="_ _8"></span>nal data (which are</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws0">probabl<span class="_ _4"></span>y just instances of the <span class="_ _1"></span>Active Record).</div><div class="t m0 xd h17 ya9a ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws359">Objects expose beha<span class="_ _1"></span>vior and hide data. <span class="_ _4"></span>This makes it easy to add new kinds of objects</div><div class="t m0 xd h14 y3aa ff8 fs3 fc0 sc0 ls0 ws22">without changing existing beha<span class="_ _1"></span>viors. It also makes it hard to add new beha<span class="_ _4"></span>viors to existing</div><div class="t m0 xd h14 y3ab ff8 fs3 fc0 sc0 ls0 ws4e4">objects. Data structures expose data and ha<span class="_ _4"></span>ve no signiﬁcant beha<span class="_ _4"></span>vior<span class="_ _4"></span>. <span class="_ _1"></span>This makes it easy to</div><div class="t m0 xd h14 y390 ff8 fs3 fc0 sc0 lsd ws2fc">add new beha<span class="_ _1"></span>viors to existing data structures but makes it hard to add new data structures</div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 ws0">to existing functions.</div><div class="t m0 x74 h14 y2f9 ff8 fs3 fc0 sc0 ls22 ws21">In any gi<span class="_ _1"></span>ven system w<span class="_ _4"></span>e will sometimes want the ﬂexibility to add ne<span class="_ _4"></span>w data types, and</div><div class="t m0 xd h14 y2fa ff8 fs3 fc0 sc0 ls0 ws50">so w<span class="_ _4"></span>e prefer objects for that par<span class="_ _8"></span>t of the system. Other times w<span class="_ _4"></span>e will want the ﬂe<span class="_ _4"></span>xibility to</div><div class="t m0 xd h14 y2fb ff8 fs3 fc0 sc0 ls0 ws4b2">add new beha<span class="_ _1"></span>viors, and so in that par<span class="_ _8"></span>t of the system w<span class="_ _4"></span>e prefer data types and procedures.</div><div class="t m0 xd h14 y2fc ff8 fs3 fc0 sc0 ls0 ws4e5">Good softw<span class="_ _4"></span>are developers understand these issues without prejudice and choose the</div><div class="t m0 xd h14 y2fd ff8 fs3 fc0 sc0 ls0 ws0">approach that is best for the job at hand.</div><div class="t m0 xd h17 ya9b ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y31c ff1 fs3 fc0 sc0 ls0 wsa0">[Refactoring]:<span class="_ _4"></span>  <span class="ffa ls30 wsf5">Refactoring: Impr<span class="_ _4"></span>oving the Design of Existing Code<span class="ff8">, Martin F<span class="_ _1"></span>owler et <span class="_ _4"></span>al.,</span></span></div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1999.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls14 ws235">  public String getState() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls1a ws237">    return state;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls14 ws235">  public String getZip() {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls20 ws236">    return zip;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 6-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">address.java</div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:132.945010px;width:77.392000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:467.728010px;width:72.311000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:299.944010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf85" class="pf w1 h2" data-page-no="85"><div class="pc pc85 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf86" class="pf w1 h2" data-page-no="86"><div class="pc pc86 w1 h2"><img class="bi xd ya9c w4 h67" alt="" src="bg86.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">103</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">7</div><div class="t m0 xde h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Err<span class="_ _1"></span>or Handling</div><div class="t m0 x97 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y Michael F<span class="_ _4"></span>eathers</div><div class="t m0 xd h14 ya9d ff8 fs3 fc0 sc0 ls0 ws498">It might seem odd to ha<span class="_ _4"></span>ve a section about error handling in a book about clean code. Er<span class="_ _5"></span>ror</div><div class="t m0 xd h14 ya9e ff8 fs3 fc0 sc0 ls0 wsa2">handling is just one of those things that w<span class="_ _4"></span>e all ha<span class="_ _4"></span>ve to do when w<span class="_ _1"></span>e program. Input can be</div><div class="t m0 xd h14 ya9f ff8 fs3 fc0 sc0 ls0 ws3ee">abnormal and devices can fail. In shor<span class="_ _8"></span>t, things can go wrong, and when the<span class="_ _4"></span>y do, w<span class="_ _4"></span>e as pro-</div><div class="t m0 xd h14 yaa0 ff8 fs3 fc0 sc0 ls0 ws0">grammers are responsible for making sure that our code does what it needs to do.</div><div class="t m0 x74 h14 yaa1 ff8 fs3 fc0 sc0 ls0 ws138">The connection to clean code, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, should be clear<span class="_ _0"></span>. Many code bases are com-</div><div class="t m0 xd h14 yaa2 ff8 fs3 fc0 sc0 ls0 ws4a3">pletely dominated b<span class="_ _1"></span>y er<span class="_ _5"></span>ror handling. <span class="_ _4"></span>When I say dominated<span class="_ _0"></span>, I don’<span class="_ _4"></span>t mean that er<span class="_ _8"></span>ror han-</div><div class="t m0 xd h14 yaa3 ff8 fs3 fc0 sc0 ls0 ws4e6">dling is all that they do. I mean that it is nearl<span class="_ _4"></span>y impossible to see w<span class="_ _4"></span>hat the code does</div><div class="t m0 xd h14 yaa4 ff8 fs3 fc0 sc0 ls0 ws4e7">because of all of the scattered er<span class="_ _8"></span>ror handling. Er<span class="_ _8"></span>ror handling is impor<span class="_ _8"></span>tant, <span class="ffa ls52 ws4e8">but if it</span></div><div class="t m0 xd h14 yaa5 ffa fs3 fc0 sc0 ls0 ws0">obscur<span class="_ _4"></span>es logic, it’<span class="_ _2"></span>s wr<span class="_ _1"></span>ong<span class="ff8">.</span></div><div class="t m0 x74 h14 yaa6 ff8 fs3 fc0 sc0 ls0 ws4e9">In this chapter I’<span class="_ _4"></span>ll outline a number of techniques and considerations that you can use</div><div class="t m0 xd h14 yaa7 ff8 fs3 fc0 sc0 lsd wsef">to write code that is both clean and robust—code that handles er<span class="_ _8"></span>rors with grace and style.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:277.651000px;bottom:440.027010px;width:161.307000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf87" class="pf w1 h2" data-page-no="87"><div class="pc pc87 w1 h2"><img class="bi xd yaa8 wc h68" alt="" src="bg87.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">104<span class="_ _2a"> </span><span class="ff1 wsf5">Chapter 7:<span class="_ _4"></span> Error Handling</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Use Exceptions Rather <span class="_ _0"></span>Than Return Codes</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws4ea">Back in the distant past there w<span class="_ _4"></span>ere many languages that didn’<span class="_ _1"></span>t ha<span class="_ _4"></span>ve exceptions. In those</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws264">languages the techniques for handling and reporting er<span class="_ _8"></span>rors were limited. <span class="_ _0"></span>Y<span class="_ _3"></span>ou either set an</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws59">er<span class="_ _8"></span>ror ﬂag or returned an er<span class="_ _5"></span>ror code that the caller could check. <span class="_ _4"></span>The code in Listing 7-1</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws0">illustrates these approaches.</div><div class="t m0 x74 h14 y59f ff8 fs3 fc0 sc0 ls0 ws3b4">The problem with these approaches is that the<span class="_ _4"></span>y clutter the caller<span class="_ _4"></span>. <span class="_ _1"></span>The caller must</div><div class="t m0 xd h14 y5a0 ff8 fs3 fc0 sc0 ls0 ws4eb">check for er<span class="_ _8"></span>rors immediately after the call. Unfortunatel<span class="_ _4"></span>y<span class="_ _1"></span>, it’<span class="_ _2"></span>s easy to forget. F<span class="_ _1"></span>or this rea-</div><div class="t m0 xd h14 y5a1 ff8 fs3 fc0 sc0 ls0 ws55">son it is better to thro<span class="_ _4"></span>w an exception w<span class="_ _4"></span>hen you encounter an error<span class="_ _4"></span>. <span class="_ _4"></span>The calling code is</div><div class="t m0 xd h14 y5a2 ff8 fs3 fc0 sc0 ls0 ws0">cleaner<span class="_ _1"></span>. Its logic is not obscured b<span class="_ _4"></span>y er<span class="_ _8"></span>ror handling.</div><div class="t m0 x74 h14 y7e1 ff8 fs3 fc0 sc0 ls0 ws454">Listing 7-2 sho<span class="_ _4"></span>ws the code after w<span class="_ _4"></span>e’<span class="_ _4"></span>ve chosen to thro<span class="_ _4"></span>w exceptions in methods that</div><div class="t m0 xd h14 yaa9 ff8 fs3 fc0 sc0 ls0 ws0">can detect er<span class="_ _8"></span>rors.</div><div class="t m0 x74 h1c y2a8 ff1 fs3 fc0 sc0 ls0 ws0">Listing 7-1 </div><div class="t m0 x74 h36 y277 ffc fs3 fc0 sc0 ls0 ws0">DeviceController.java</div><div class="t m5 x74 h2f yaaa ffb fs10 fc0 sc0 ls0 ws0">public class DeviceController {</div><div class="t m5 x74 h2f yaab ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f yaac ffb fs10 fc0 sc0 ls0 ws0">  public void sendShutDown() {</div><div class="t m5 x74 h2f yaad ffb fs10 fc0 sc0 ls0 ws0">    DeviceHandle handle = getHandle(DEV1);</div><div class="t m5 x74 h2f yaae ffb fs10 fc0 sc0 ls0 ws0">    // Check the state of the device</div><div class="t m5 x74 h2f yaaf ffb fs10 fc0 sc0 ls0 ws0">    if (handle != DeviceHandle.INVALID) {</div><div class="t m5 x74 h2f yab0 ffb fs10 fc0 sc0 ls0 ws0">      // Save the device status to the record field</div><div class="t m5 x74 h2f yab1 ffb fs10 fc0 sc0 ls0 ws0">      retrieveDeviceRecord(handle);</div><div class="t m5 x74 h2f yab2 ffb fs10 fc0 sc0 ls0 ws0">      // If not suspended, shut down</div><div class="t m5 x74 h2f yab3 ffb fs10 fc0 sc0 ls0 ws0">      if (record.getStatus() != DEVICE_SUSPENDED) {</div><div class="t m5 x74 h2f yab4 ffb fs10 fc0 sc0 ls0 ws0">        pauseDevice(handle);</div><div class="t m5 x74 h2f yab5 ffb fs10 fc0 sc0 ls0 ws0">        clearDeviceWorkQueue(handle);</div><div class="t m5 x74 h2f yab6 ffb fs10 fc0 sc0 ls0 ws0">        closeDevice(handle);</div><div class="t m5 x74 h2f yab7 ffb fs10 fc0 sc0 ls0 ws0">      } else {</div><div class="t m5 x74 h2f yab8 ffb fs10 fc0 sc0 ls0 ws0">        logger.log(&quot;Device suspended.  Unable to shut down&quot;);</div><div class="t m5 x74 h2f yab9 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yaba ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f yabb ffb fs10 fc0 sc0 ls0 ws0">      logger.log(&quot;Invalid handle for: &quot; + DEV1.toString());</div><div class="t m5 x74 h2f yabc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yabd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yabe ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f yabf ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y3ff ff1 fs3 fc0 sc0 ls0 ws0">Listing 7-2 </div><div class="t m0 x74 h36 y8e0 ffc fs3 fc0 sc0 ls0 ws0">DeviceController.java (with exceptions)</div><div class="t m5 x74 h2f yac0 ffb fs10 fc0 sc0 ls0 ws0">public class DeviceController {</div><div class="t m5 x74 h2f yac1 ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f yac2 ffb fs10 fc0 sc0 ls0 ws0">  public void sendShutDown() {</div><div class="t m5 x74 h2f yac3 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yac4 ffb fs10 fc0 sc0 ls0 ws0">      tryToShutDown();</div><div class="t m5 x74 h2f yac5 ffb fs10 fc0 sc0 ls0 ws0">    } catch (DeviceShutDownError e) {</div><div class="t m5 x74 h2f yac6 ffb fs10 fc0 sc0 ls0 ws0">      logger.log(e);</div><div class="t m5 x74 h2f yac7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yac8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:256.776000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf88" class="pf w1 h2" data-page-no="88"><div class="pc pc88 w1 h2"><img class="bi xd yac9 wc h69" alt="" src="bg88.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">105<span class="_ _10"></span><span class="ff1 ws4ec">Write Y<span class="_ _2"></span>our </span></div><div class="t m7 xc3 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">Try-Catch-Finally</div><div class="t m0 xdf h1c y79 ff1 fs3 fc0 sc0 ls0 ws0"> Statement First</div><div class="t m0 xd h14 y914 ff8 fs3 fc0 sc0 ls0 ws4ed">Notice ho<span class="_ _4"></span>w much cleaner it is. <span class="_ _4"></span>This isn’<span class="_ _1"></span>t just a matter of aesthetics. <span class="_ _4"></span>The code is better</div><div class="t m0 xd h14 y915 ff8 fs3 fc0 sc0 ls0 ws226">because tw<span class="_ _4"></span>o concerns that were tangled<span class="_ _1"></span>, the algorithm for device shutdo<span class="_ _1"></span>wn and er<span class="_ _8"></span>ror han-</div><div class="t m0 xd h14 y916 ff8 fs3 fc0 sc0 ls0 ws2d2">dling, are no<span class="_ _4"></span>w separated. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can look at each of those concerns and understand them</div><div class="t m0 xd h14 yaca ff8 fs3 fc0 sc0 ls0 ws0">independentl<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 xd h17 y8dd ff1 fs9 fc0 sc0 ls0 ws4ee">Write Y<span class="_ _3"></span>our </div><div class="t m3 xbc h1a y8dd ffc fsa fc0 sc0 ls0 ws0">Try-Catch-Finally</div><div class="t m0 x65 h17 y8dd ff1 fs9 fc0 sc0 ls0 ws0"> Statement First</div><div class="t m0 xd h14 y63c ff8 fs3 fc0 sc0 ls0 ws7d">One of the most interesting things about exceptions is that the<span class="_ _4"></span>y <span class="ffa">deﬁne a scope</span><span class="ls48 ws3f1"> within your</span></div><div class="t m0 xd h14 yacb ff8 fs3 fc0 sc0 ls0 ws29c">program. <span class="_ _4"></span>When you e<span class="_ _4"></span>xecute code in the </div><div class="t m5 xe0 h2f yacb ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xbe h14 yacb ff8 fs3 fc0 sc0 ls0 ws29c">portion of a </div><div class="t m5 x9f h2f yacb ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x21 h14 yacb ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 x6a h2f yacb ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xb9 h14 yacb ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 x72 h2f yacb ffb fs10 fc0 sc0 ls0 ws0">finally</div><div class="t m0 xbd h14 yacb ff8 fs3 fc0 sc0 ls0 ws29c">statement, you</div><div class="t m0 xd h14 yacc ff8 fs3 fc0 sc0 ls0 ws0">are stating that ex<span class="_ _4"></span>ecution can abort at any point and then resume at the </div><div class="t m5 xac h2f yacc ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xe1 h14 yacc ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y59f ff8 fs3 fc0 sc0 ls0 ws4ef">In a wa<span class="_ _1"></span>y<span class="_ _1"></span>, </div><div class="t m5 x14 h2f y5c9 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xe2 h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws4ef">blocks are lik<span class="_ _4"></span>e transactions. <span class="_ _1"></span>Y<span class="_ _3"></span>our </div><div class="t m5 xb4 h2f y5c9 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xc2 h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws4ef">has to lea<span class="_ _4"></span>ve y<span class="_ _4"></span>our program in a</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws290">consistent state, no matter what happens in the </div><div class="t m5 xce h2f y5cb ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x7e h14 y5cb ff8 fs3 fc0 sc0 ls0 ws290">. F<span class="_ _1"></span>or this reason it is good practice to</div><div class="t m0 xd h14 y5cc ff8 fs3 fc0 sc0 ls0 ws4f0">start with a </div><div class="t m5 x6d h2f y5cc ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x3a h14 y5cc ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 xbc h2f y5cc ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x4 h14 y5cc ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 x2e h2f y5cc ffb fs10 fc0 sc0 ls0 ws0">finally</div><div class="t m0 x1c h14 y5cc ff8 fs3 fc0 sc0 ls0 ws4f0">statement when y<span class="_ _4"></span>ou are writing code that could thro<span class="_ _4"></span>w</div><div class="t m0 xd h14 y5cd ff8 fs3 fc0 sc0 ls0 ws4f1">exceptions. <span class="_ _1"></span>This helps you deﬁne w<span class="_ _4"></span>hat the user of that code should expect, no matter what</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">goes wrong with the code that is ex<span class="_ _4"></span>ecuted in the </div><div class="t m5 x42 h2f y2e5 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xb2 h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y674 ff8 fs3 fc0 sc0 ls0 ws1d7">Let’<span class="_ _2"></span>s look at an example. <span class="_ _4"></span>W<span class="_ _0"></span>e need to write some code that accesses a ﬁle and reads</div><div class="t m0 xd h14 y675 ff8 fs3 fc0 sc0 ls0 ws0">some serialized objects.</div><div class="t m0 x74 h14 y676 ff8 fs3 fc0 sc0 ls53 ws9">W<span class="_ _0"></span>e start with a unit test that shows that w<span class="_ _1"></span>e’ll get an e<span class="_ _4"></span>xception when the ﬁle doesn’<span class="_ _1"></span>t exist:</div><div class="t m5 x74 h2f y81d ffb fs10 fc0 sc0 ls14 ws237">  @Test(expected = StorageException.class)</div><div class="t m5 x74 h2f y81e ffb fs10 fc0 sc0 ls0 ws236">  public void retrieveSectionShouldThrowOnInvalidFileName() {</div><div class="t m5 x74 h2f yacd ffb fs10 fc0 sc0 ls18 ws241">    sectionStore.retrieveSection(&quot;invalid - file&quot;);</div><div class="t m5 x74 h2f yace ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 x74 h14 y73c ff8 fs3 fc0 sc0 ls0 ws0">The test dri<span class="_ _4"></span>ves us to create this stub:</div><div class="t m5 x74 h2f yacf ffb fs10 fc0 sc0 ls0 ws0">public List&lt;RecordedGrip&gt; retrieveSection(String sectionName) {</div><div class="t m5 x74 h2f yad0 ffb fs10 fc0 sc0 ls14 ws423">  // dummy return until we have a real implementation</div><div class="t m5 x74 h2f yad1 ffb fs10 fc0 sc0 ls14 ws237">  return new ArrayList&lt;RecordedGrip&gt;();</div><div class="t m5 x74 h2f yad2 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yad3 ffb fs10 fc0 sc0 ls0 ws0">  private void tryToShutDown() throws DeviceShutDownError {</div><div class="t m5 x74 h2f yad4 ffb fs10 fc0 sc0 ls0 ws0">    DeviceHandle handle = getHandle(DEV1);</div><div class="t m5 x74 h2f yad5 ffb fs10 fc0 sc0 ls0 ws0">    DeviceRecord record = retrieveDeviceRecord(handle);</div><div class="t m5 x74 h2f yad6 ffb fs10 fc0 sc0 ls0 ws0">    pauseDevice(handle);</div><div class="t m5 x74 h2f yad7 ffb fs10 fc0 sc0 ls0 ws0">    clearDeviceWorkQueue(handle);</div><div class="t m5 x74 h2f yad8 ffb fs10 fc0 sc0 ls0 ws0">    closeDevice(handle);</div><div class="t m5 x74 h2f yad9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yada ffb fs10 fc0 sc0 ls0 ws0">  private DeviceHandle getHandle(DeviceID id) {</div><div class="t m5 x74 h2f yadb ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x74 h2f yadc ffb fs10 fc0 sc0 ls0 ws0">    throw new DeviceShutDownError(&quot;Invalid handle for: &quot; + id.toString());</div><div class="t m5 x74 h2f yadd ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x74 h2f yade ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yadf ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f yae0 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 7-2 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DeviceController.java (with exceptions)</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:320.594010px;width:280.244000px;height:15.947000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf89" class="pf w1 h2" data-page-no="89"><div class="pc pc89 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">106<span class="_ _2a"> </span><span class="ff1 wsf5">Chapter 7:<span class="_ _4"></span> Error Handling</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws4f2">Our test fails because it doesn’<span class="_ _4"></span>t thro<span class="_ _4"></span>w an exception. Next, w<span class="_ _1"></span>e change our implementa-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">tion so that it attempts to access an in<span class="_ _4"></span>valid ﬁle. <span class="_ _1"></span>This operation thro<span class="_ _4"></span>ws an exception:</div><div class="t m5 x74 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">public List&lt;RecordedGrip&gt; retrieveSection(String sectionName) {</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls20 ws253">  try {</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls14 ws237">    FileInputStream stream = new FileInputStream(sectionName)</div><div class="t m5 x74 h2f yae1 ffb fs10 fc0 sc0 ls14 ws253">  } catch (Exception e) {</div><div class="t m5 x74 h2f yae2 ffb fs10 fc0 sc0 ls14 ws237">    throw new StorageException(&quot;retrieval error&quot;, e);</div><div class="t m5 x74 h2f yae3 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f yae4 ffb fs10 fc0 sc0 ls14 ws237">  return new ArrayList&lt;RecordedGrip&gt;(); </div><div class="t m5 x74 h2f yae5 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws206">Our test passes no<span class="_ _4"></span>w because w<span class="_ _4"></span>e’<span class="_ _4"></span>ve caught the exception. <span class="_ _0"></span>At this point, we can refac-</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws4f3">tor<span class="_ _1"></span>. W<span class="_ _0"></span>e can narrow the type of the e<span class="_ _4"></span>xception w<span class="_ _4"></span>e catch to match the type that is actually</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">thro<span class="_ _4"></span>wn from the </div><div class="t m5 x3a h2f y1df ffb fs10 fc0 sc0 ls0 ws0">FileInputStream</div><div class="t m0 xdf h14 y1df ff8 fs3 fc0 sc0 ls0 ws0"> constructor: </div><div class="t m5 x65 h2f y1df ffb fs10 fc0 sc0 ls0 ws0">FileNotFoundException</div><div class="t m0 x73 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">:</div><div class="t m5 x74 h2f y5de ffb fs10 fc0 sc0 ls0 ws0">public List&lt;RecordedGrip&gt; retrieveSection(String sectionName) {</div><div class="t m5 x74 h2f yae6 ffb fs10 fc0 sc0 ls20 ws253">  try {</div><div class="t m5 x74 h2f yae7 ffb fs10 fc0 sc0 ls14 ws237">    FileInputStream stream = new FileInputStream(sectionName);</div><div class="t m5 x74 h2f yae8 ffb fs10 fc0 sc0 ls1a ws2f6">    stream.close();</div><div class="t m5 x74 h2f yae9 ffb fs10 fc0 sc0 ls14 ws253">  } catch (FileNotFoundException e) {</div><div class="t m5 x74 h2f yaea ffb fs10 fc0 sc0 ls14 ws237">    throw new StorageException(&quot;retrieval error”, e);</div><div class="t m5 x74 h2f yaeb ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f yaec ffb fs10 fc0 sc0 ls14 ws237">  return new ArrayList&lt;RecordedGrip&gt;();</div><div class="t m5 x74 h2f yaed ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y74a ff8 fs3 fc0 sc0 ls0 ws494">No<span class="_ _4"></span>w that w<span class="_ _4"></span>e’<span class="_ _4"></span>ve deﬁned the scope with a </div><div class="t m5 x78 h2f y74a ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xce h14 y74a ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 x34 h2f y74a ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xb7 h14 y74a ff8 fs3 fc0 sc0 ls11 ws4c">structure, we can use TDD to build</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws2be">up the rest of the lo<span class="_ _4"></span>gic that we need. <span class="_ _1"></span>That logic will be added betw<span class="_ _1"></span>een the creation of the</div><div class="t m5 xd h2f y74c ffb fs10 fc0 sc0 ls0 ws0">FileInputStream</div><div class="t m0 x24 h14 y74c ff8 fs3 fc0 sc0 ls0 ws0"> and the </div><div class="t m5 xa h2f y74c ffb fs10 fc0 sc0 ls0 ws0">close</div><div class="t m0 x1 h14 y74c ff8 fs3 fc0 sc0 ls0 ws0">, and can pretend that nothing goes wrong.</div><div class="t m0 x74 h14 y57b ff8 fs3 fc0 sc0 ls0 ws294">T<span class="_ _4"></span>r<span class="_ _8"></span>y to write tests that force exceptions, and then add beha<span class="_ _4"></span>vior to your handler to sat-</div><div class="t m0 xd h14 y57c ff8 fs3 fc0 sc0 lsd ws4f4">isfy your tests. <span class="_ _1"></span>This will cause you to build the transaction scope of the </div><div class="t m5 xc1 h2f y57c ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xbd h14 y57c ff8 fs3 fc0 sc0 ls0 ws15e">block ﬁrst and</div><div class="t m0 xd h14 y74e ff8 fs3 fc0 sc0 ls0 ws0">will help you maintain the transaction nature of that scope.</div><div class="t m0 xd h17 yaee ff1 fs9 fc0 sc0 ls0 ws0">Use Unchecked Exceptions</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws181">The debate is o<span class="_ _4"></span>ver<span class="_ _1"></span>. F<span class="_ _4"></span>or years Ja<span class="_ _1"></span>va pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers ha<span class="_ _4"></span>ve debated o<span class="_ _4"></span>ver the beneﬁts and liabili-</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws1e1">ties of checked exceptions. <span class="_ _1"></span>When checked exceptions w<span class="_ _4"></span>ere introduced in the ﬁrst version</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws4f5">of Ja<span class="_ _4"></span>va, the<span class="_ _4"></span>y seemed like a great idea. <span class="_ _4"></span>The signature of every method w<span class="_ _4"></span>ould list all of the</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 wsc7">exceptions that it could pass to its caller<span class="_ _1"></span>. Moreo<span class="_ _4"></span>ver<span class="_ _1"></span>, these exceptions w<span class="_ _4"></span>ere par<span class="_ _8"></span>t of the type</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 wsd2">of the method. <span class="_ _0"></span>Y<span class="_ _2"></span>our code literall<span class="_ _4"></span>y w<span class="_ _4"></span>ouldn’<span class="_ _4"></span>t compile if the signature didn’<span class="_ _4"></span>t match what y<span class="_ _4"></span>our</div><div class="t m0 xd h14 y5d6 ff8 fs3 fc0 sc0 ls0 ws0">code could do. </div><div class="t m0 x74 h14 y2d1 ff8 fs3 fc0 sc0 ls0 ws84">At the time, w<span class="_ _4"></span>e thought that checked exceptions w<span class="_ _1"></span>ere a g<span class="_ _8"></span>reat idea; and yes, they can</div><div class="t m0 xd h14 y2d2 ff8 fs3 fc0 sc0 ls0 ws0">yield <span class="ffa">some<span class="_ _b"> </span></span><span class="ws1ff">beneﬁt. Ho<span class="_ _4"></span>we<span class="_ _1"></span>ver<span class="_ _4"></span>, it is clear no<span class="_ _4"></span>w that they aren’<span class="_ _4"></span>t necessary for the production of</span></div><div class="t m0 xd h14 yaef ff8 fs3 fc0 sc0 lsd wscf">robust softw<span class="_ _4"></span>are. C# doesn’<span class="_ _4"></span>t hav<span class="_ _4"></span>e checked exceptions, and despite v<span class="_ _4"></span>aliant attempts, C++</div><div class="t m0 xd h14 yaf0 ff8 fs3 fc0 sc0 lsd ws4f6">doesn’<span class="_ _1"></span>t either<span class="_ _4"></span>. Neither do Python or Ruby<span class="_ _0"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>et it is possible to write robust softw<span class="_ _4"></span>are in all</div><div class="t m0 xd h14 yaf1 ff8 fs3 fc0 sc0 ls0 ws1ad">of these languages. Because that is the case, w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve to decide—really—w<span class="_ _4"></span>hether checked</div><div class="t m0 xd h14 yaf2 ff8 fs3 fc0 sc0 ls0 ws0">exceptions are w<span class="_ _1"></span>or<span class="_ _8"></span>th their price.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:250.945010px;width:160.076000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8a" class="pf w1 h2" data-page-no="8a"><div class="pc pc8a w1 h2"><img class="bi x37 yaf3 w8 h27" alt="" src="bg8a.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">107<span class="_ _10"></span><span class="ff1">Deﬁne Exception Classes in <span class="_ _1"></span>T<span class="_ _0"></span>erms of a Caller’<span class="_ _4"></span>s Needs</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws1b">What price? <span class="_ _1"></span>The price of checked exceptions is an Open/Closed Principle</div><div class="t m0 x93 h21 y4ea ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x99 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">violation.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws27d">If you thro<span class="_ _1"></span>w a checked exception from a method in y<span class="_ _4"></span>our code and the </div><div class="t m5 x59 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xbd h14 y195 ff8 fs3 fc0 sc0 ls54 ws4f7"> is three le<span class="_ _4"></span>vels</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">abo<span class="_ _4"></span>ve, <span class="_ _8"></span><span class="ffa ws100">you must declar<span class="_ _4"></span>e that exception in the signatur<span class="_ _4"></span>e of each method betw<span class="_ _4"></span>een you and</span></div><div class="t m0 xd h1d y197 ffa fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x74 h6a y197 ff11 fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xdc h14 y197 ff8 fs3 fc0 sc0 ls0 ws4f8">. <span class="_ _1"></span>This means that a change at a low le<span class="_ _4"></span>vel of the softw<span class="_ _4"></span>are can force signature</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 lsd ws4f9">changes on many higher le<span class="_ _1"></span>vels. <span class="_ _4"></span>The changed modules must be rebuilt and redeplo<span class="_ _4"></span>yed<span class="_ _0"></span>,</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">ev<span class="_ _4"></span>en though nothing they care about changed. </div><div class="t m0 x74 h14 y19a ff8 fs3 fc0 sc0 ls16 ws4fa">Consider the calling hierarch<span class="_ _4"></span>y of a large system. Functions at the top call functions</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls16 ws49d">belo<span class="_ _4"></span>w them, which call more functions belo<span class="_ _1"></span>w them, ad inﬁnitum. Now let’<span class="_ _3"></span>s say one of the</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls16 ws3d2">lo<span class="_ _4"></span>w<span class="_ _4"></span>est lev<span class="_ _4"></span>el functions is modiﬁed in such a wa<span class="_ _4"></span>y that it must thro<span class="_ _4"></span>w an exception. If that</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls16 ws4fb">exception is checked<span class="_ _0"></span>, then the function signature must add a </div><div class="t m5 xb5 h2f y19d ffb fs10 fc0 sc0 ls31 ws0">throws</div><div class="t m0 x60 h14 y19d ff8 fs3 fc0 sc0 ls16 ws4fb">clause. But this</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls16 ws3d4">means that ev<span class="_ _4"></span>ery function that calls our modiﬁed function must also be modiﬁed either to</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls16 ws4fc">catch the new e<span class="_ _4"></span>xception or to append the appropriate </div><div class="t m5 xe3 h2f yaf4 ffb fs10 fc0 sc0 ls31 ws0">throws</div><div class="t m0 xab h14 yaf4 ff8 fs3 fc0 sc0 ls16 ws4fc">clause to its signature. <span class="_ _1"></span>Ad</div><div class="t m0 xd h14 yaf5 ff8 fs3 fc0 sc0 ls25 ws4fd">inﬁnitum. <span class="_ _1"></span>The net result is a cascade of changes that work their w<span class="_ _4"></span>a<span class="_ _4"></span>y from the lo<span class="_ _4"></span>west le<span class="_ _4"></span>vels</div><div class="t m0 xd h14 yaf6 ff8 fs3 fc0 sc0 ls16 ws109">of the software to the highest! Encapsulation is brok<span class="_ _4"></span>en because all functions in the path</div><div class="t m0 xd h14 yaf7 ff8 fs3 fc0 sc0 ls16 ws336">of a thro<span class="_ _4"></span>w must kno<span class="_ _4"></span>w about details of that lo<span class="_ _4"></span>w-lev<span class="_ _4"></span>el exception. Giv<span class="_ _4"></span>en that the pur<span class="_ _8"></span>pose of</div><div class="t m0 xd h14 yaf8 ff8 fs3 fc0 sc0 ls16 ws11b">exceptions is to allo<span class="_ _1"></span>w you to handle er<span class="_ _8"></span>rors at a distance, it is a shame that checked excep-</div><div class="t m0 xd h14 yaf9 ff8 fs3 fc0 sc0 ls16 ws0">tions break encapsulation in this w<span class="_ _4"></span>ay<span class="_ _0"></span>. </div><div class="t m0 x74 h14 yafa ff8 fs3 fc0 sc0 ls0 ws3a0">Checked e<span class="_ _4"></span>xceptions can sometimes be useful if you are writing a critical library: <span class="_ _1"></span>Y<span class="_ _3"></span>ou</div><div class="t m0 xd h14 yafb ff8 fs3 fc0 sc0 ls0 ws4fe">must catch them. But in general application de<span class="_ _4"></span>velopment the dependency costs outw<span class="_ _4"></span>eigh</div><div class="t m0 xd h14 yafc ff8 fs3 fc0 sc0 ls0 ws0">the beneﬁts.</div><div class="t m0 xd h17 yafd ff1 fs9 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>o<span class="_ _1"></span>vide Context with Exceptions</div><div class="t m0 xd h14 y373 ff8 fs3 fc0 sc0 ls0 ws3d7">Each exception that y<span class="_ _4"></span>ou thro<span class="_ _4"></span>w should pro<span class="_ _4"></span>vide enough context to determine the source and</div><div class="t m0 xd h14 y374 ff8 fs3 fc0 sc0 ls0 ws2a2">location of an er<span class="_ _8"></span>ror<span class="_ _1"></span>. In Jav<span class="_ _4"></span>a, you can get a stack trace from an<span class="_ _4"></span>y exception; ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _4"></span>, a stack</div><div class="t m0 xd h14 y375 ff8 fs3 fc0 sc0 ls0 ws0">trace can’<span class="_ _1"></span>t tell you the intent of the operation that failed. </div><div class="t m0 x74 h14 y37a ff8 fs3 fc0 sc0 ls0 ws462">Create informative error messages and pass them along with your e<span class="_ _4"></span>xceptions. Men-</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws3f8">tion the operation that failed and the type of failure. If you are logging in y<span class="_ _4"></span>our application,</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls0 ws0">pass along enough information to be able to log the error in your </div><div class="t m5 xa0 h2f y37c ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x6b h14 y37c ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h17 yafe ff1 fs9 fc0 sc0 ls0 ws0">Deﬁne Exception Classes in <span class="_ _0"></span>T<span class="_ _0"></span>erms of a Caller’<span class="_ _0"></span>s Needs</div><div class="t m0 xd h14 y2e9 ff8 fs3 fc0 sc0 ls0 ws4ff">There are man<span class="_ _4"></span>y wa<span class="_ _4"></span>ys to classify er<span class="_ _8"></span>rors. W<span class="_ _2"></span>e can classify them by their source: Did they</div><div class="t m0 xd h14 y2ea ff8 fs3 fc0 sc0 ls0 ws146">come from one component or another? Or their type: <span class="_ _1"></span>Are they device failures, netw<span class="_ _1"></span>ork</div><div class="t m0 xd h14 y2eb ff8 fs3 fc0 sc0 ls0 ws293">failures, or programming er<span class="_ _8"></span>rors? Ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, when w<span class="_ _4"></span>e deﬁne exception classes in an appli-</div><div class="t m0 xd h14 y2ec ff8 fs3 fc0 sc0 ls0 ws0">cation, our most important concer<span class="_ _8"></span>n should be <span class="ffa">how they ar<span class="_ _1"></span>e caught<span class="ff8">.</span></span></div><div class="t m0 xd h25 yaff ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[Martin].</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:316.946010px;width:195.124000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:197.946010px;width:318.867000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8b" class="pf w1 h2" data-page-no="8b"><div class="pc pc8b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">108<span class="_ _2a"> </span><span class="ff1 wsf5">Chapter 7:<span class="_ _4"></span> Error Handling</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws4a9">Let’<span class="_ _2"></span>s look at an example of poor e<span class="_ _4"></span>xception classiﬁcation. Here is a </div><div class="t m5 x8d h2f y194 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 xbd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 xbb h2f y194 ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xd9 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">-</div><div class="t m5 x64 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">finally</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws500">statement for a third-party librar<span class="_ _8"></span>y call. It co<span class="_ _4"></span>vers all of the exceptions that the calls can</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">thro<span class="_ _4"></span>w:</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls19 ws235">    ACMEPort port = new ACMEPort(12);</div><div class="t m5 x74 h2f y405 ffb fs10 fc0 sc0 ls1b ws260">    try {</div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls3c ws237">      port.open();</div><div class="t m5 x74 h2f y407 ffb fs10 fc0 sc0 ls18 ws236">    } catch (DeviceResponseException e) {</div><div class="t m5 x74 h2f y73f ffb fs10 fc0 sc0 ls20 ws2f1">      reportPortError(e);</div><div class="t m5 x74 h2f y740 ffb fs10 fc0 sc0 ls19 ws237">      logger.log(&quot;Device response exception&quot;, e);</div><div class="t m5 x74 h2f y741 ffb fs10 fc0 sc0 ls18 ws237">    } catch (ATM1212UnlockedException e) {</div><div class="t m5 x74 h2f y742 ffb fs10 fc0 sc0 ls20 ws2f1">      reportPortError(e);</div><div class="t m5 x74 h2f y743 ffb fs10 fc0 sc0 ls19 ws237">      logger.log(&quot;Unlock exception&quot;, e);</div><div class="t m5 x74 h2f y744 ffb fs10 fc0 sc0 ls19 ws235">    } catch (GMXError e) {</div><div class="t m5 x74 h2f y745 ffb fs10 fc0 sc0 ls20 ws2f1">      reportPortError(e);</div><div class="t m5 x74 h2f y746 ffb fs10 fc0 sc0 ls19 ws237">      logger.log(&quot;Device response exception&quot;);</div><div class="t m5 x74 h2f yb00 ffb fs10 fc0 sc0 ls1a ws235">    } finally {</div><div class="t m5 x74 h2f yb01 ffb fs10 fc0 sc0 ls1c ws0">      …</div><div class="t m5 x74 h2f yb02 ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m0 x74 h14 y638 ff8 fs3 fc0 sc0 ls0 ws469">That statement contains a lot of duplication, and w<span class="_ _4"></span>e shouldn’<span class="_ _4"></span>t be sur<span class="_ _8"></span>prised. In most</div><div class="t m0 xd h14 y639 ff8 fs3 fc0 sc0 lsc ws346">exception handling situations, the w<span class="_ _1"></span>ork that we do is relati<span class="_ _4"></span>vel<span class="_ _4"></span>y standard regardless of the</div><div class="t m0 xd h14 y587 ff8 fs3 fc0 sc0 ls0 ws0">actual cause. <span class="_ _4"></span>W<span class="_ _0"></span>e hav<span class="_ _4"></span>e to record an er<span class="_ _8"></span>ror and make sure that w<span class="_ _4"></span>e can proceed.</div><div class="t m0 x74 h14 yb03 ff8 fs3 fc0 sc0 ls0 ws371">In this case, because w<span class="_ _4"></span>e kno<span class="_ _4"></span>w that the w<span class="_ _4"></span>ork that we are doing is roughl<span class="_ _4"></span>y the same</div><div class="t m0 xd h14 yb04 ff8 fs3 fc0 sc0 lsc ws163">regardless of the e<span class="_ _4"></span>xception, we can simplify our code considerab<span class="_ _4"></span>ly b<span class="_ _4"></span>y wrapping the <span class="_ _1"></span>API</div><div class="t m0 xd h14 yb05 ff8 fs3 fc0 sc0 ls0 ws0">that w<span class="_ _4"></span>e are calling and making sure that it retur<span class="_ _8"></span>ns a common exception type:</div><div class="t m5 x74 h2f y805 ffb fs10 fc0 sc0 ls18 ws236">    LocalPort port = new LocalPort(12);</div><div class="t m5 x74 h2f yb06 ffb fs10 fc0 sc0 ls1b ws260">    try {</div><div class="t m5 x74 h2f yb07 ffb fs10 fc0 sc0 ls3c ws237">      port.open();</div><div class="t m5 x74 h2f yb08 ffb fs10 fc0 sc0 ls19 ws235">    } catch (PortDeviceFailure e) {</div><div class="t m5 x74 h2f yb09 ffb fs10 fc0 sc0 ls1e ws241">      reportError(e);</div><div class="t m5 x74 h2f yb0a ffb fs10 fc0 sc0 ls1f ws2f1">      logger.log(e.getMessage(), e);</div><div class="t m5 x74 h2f yb0b ffb fs10 fc0 sc0 ls1a ws235">    } finally {</div><div class="t m5 x74 h2f yb0c ffb fs10 fc0 sc0 ls1c ws0">      …</div><div class="t m5 x74 h2f yb0d ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m0 x74 h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws0">Our</div><div class="t m5 xdc h2f y9e9 ffb fs10 fc0 sc0 ls0 ws0">LocalPort</div><div class="t m0 xba h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws4ed">class is just a simple wrapper that catches and translates exceptions</div><div class="t m0 xd h14 yb0e ff8 fs3 fc0 sc0 ls0 ws0">thro<span class="_ _4"></span>wn by the </div><div class="t m5 x14 h2f yb0e ffb fs10 fc0 sc0 ls0 ws0">ACMEPort</div><div class="t m0 xd0 h14 yb0e ff8 fs3 fc0 sc0 ls0 ws0"> class:</div><div class="t m5 x74 h2f yb0f ffb fs10 fc0 sc0 ls0 ws0">public class LocalPort {</div><div class="t m5 x74 h2f yb10 ffb fs10 fc0 sc0 ls0 ws0">  private ACMEPort innerPort;</div><div class="t m5 x74 h2f yb11 ffb fs10 fc0 sc0 ls0 ws0">  public LocalPort(int portNumber) {</div><div class="t m5 x74 h2f yb12 ffb fs10 fc0 sc0 ls0 ws0">    innerPort = new ACMEPort(portNumber);</div><div class="t m5 x74 h2f yb13 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yb14 ffb fs10 fc0 sc0 ls0 ws0">  public void open() {</div><div class="t m5 x74 h2f yb15 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yb16 ffb fs10 fc0 sc0 ls0 ws0">      innerPort.open();</div><div class="t m5 x74 h2f yb17 ffb fs10 fc0 sc0 ls0 ws0">    } catch (DeviceResponseException e) {</div><div class="t m5 x74 h2f yb18 ffb fs10 fc0 sc0 ls0 ws0">      throw new PortDeviceFailure(e);</div><div class="t m5 x74 h2f yb19 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ATM1212UnlockedException e) {</div><div class="t m5 x74 h2f yb1a ffb fs10 fc0 sc0 ls0 ws0">      throw new PortDeviceFailure(e);</div><div class="t m5 x74 h2f yb1b ffb fs10 fc0 sc0 ls0 ws0">    } catch (GMXError e) {</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8c" class="pf w1 h2" data-page-no="8c"><div class="pc pc8c w1 h2"><img class="bi x67 yb1c wb h6b" alt="" src="bg8c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">109<span class="_ _10"></span><span class="ff1">Deﬁne the Normal Flo<span class="_ _1"></span>w</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">      throw new PortDeviceFailure(e);</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">  …</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws501">Wrappers like the one w<span class="_ _4"></span>e deﬁned for </div><div class="t m5 xc4 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">ACMEPort</div><div class="t m0 xd2 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws501">can be very useful. In fact, wrapping</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws33b">third-party <span class="_ _4"></span>APIs is a best practice. When y<span class="_ _4"></span>ou wrap a third-party <span class="_ _4"></span>API, you minimize y<span class="_ _4"></span>our</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 wsd4">dependencies upon it: <span class="_ _0"></span>Y<span class="_ _2"></span>ou can choose to mo<span class="_ _1"></span>ve to a different library in the future without</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws18a">much penalty<span class="_ _0"></span>. Wrapping also makes it easier to mock out third-party calls when y<span class="_ _4"></span>ou are</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">testing your o<span class="_ _1"></span>wn code.</div><div class="t m0 x74 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws365">One ﬁnal adv<span class="_ _4"></span>antage of wrapping is that you aren’<span class="_ _1"></span>t tied to a par<span class="_ _8"></span>ticular vendor’<span class="_ _2"></span>s <span class="_ _1"></span>API</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws502">design choices. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can deﬁne an <span class="_ _1"></span>API that you feel comfortable with. In the preceding</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws26">example, w<span class="_ _1"></span>e deﬁned a single exception type for </div><div class="t m5 x54 h2f y21a ffb fs10 fc0 sc0 ls0 ws0">port</div><div class="t m0 x85 h14 y21a ff8 fs3 fc0 sc0 ls0 ws26">de<span class="_ _4"></span>vice f<span class="_ _8"></span>ailure and found that w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws0">could write much cleaner code.</div><div class="t m0 x74 h14 y20b ff8 fs3 fc0 sc0 ls0 ws503">Often a single exception class is ﬁne for a particular area of code. <span class="_ _4"></span>The information</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws504">sent with the exception can distinguish the errors. Use different classes onl<span class="_ _4"></span>y if there are</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 ls0 ws0">times when y<span class="_ _4"></span>ou want to catch one e<span class="_ _4"></span>xception and allo<span class="_ _4"></span>w the other one to pass through.</div><div class="t m0 xd h17 yb1d ff1 fs9 fc0 sc0 ls0 ws0">Deﬁne the Normal Flo<span class="_ _1"></span>w</div><div class="t m0 xd h14 yb1e ff8 fs3 fc0 sc0 ls0 ws505">If you follo<span class="_ _1"></span>w the advice in the preceding</div><div class="t m0 xd h14 yb1f ff8 fs3 fc0 sc0 ls10 ws3a7">sections, you’<span class="_ _1"></span>ll end up with a good amount</div><div class="t m0 xd h14 yb20 ff8 fs3 fc0 sc0 ls10 ws506">of separation betw<span class="_ _4"></span>een your business logic</div><div class="t m0 xd h14 y48b ff8 fs3 fc0 sc0 lsd ws61">and your error handling. <span class="_ _4"></span>The bulk of your</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws507">code will start to look like a clean</div><div class="t m0 xd h14 y48d ff8 fs3 fc0 sc0 ls0 ws185">unadorned algorithm. How<span class="_ _1"></span>ever<span class="_ _1"></span>, the pro-</div><div class="t m0 xd h14 y48e ff8 fs3 fc0 sc0 ls0 ws228">cess of doing this pushes er<span class="_ _8"></span>ror detection</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws488">to the edges of your pro<span class="_ _4"></span>gram. <span class="_ _1"></span>Y<span class="_ _3"></span>ou wrap</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws43c">external <span class="_ _1"></span>APIs so that you can thro<span class="_ _4"></span>w your</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls0 ws508">o<span class="_ _4"></span>wn exceptions, and y<span class="_ _4"></span>ou deﬁne a handler abo<span class="_ _4"></span>ve your code so that y<span class="_ _4"></span>ou can deal with any</div><div class="t m0 xd h14 y37d ff8 fs3 fc0 sc0 lsd ws509">aborted computation. Most of the time this is a g<span class="_ _8"></span>reat approach, but there are some times</div><div class="t m0 xd h14 y5b4 ff8 fs3 fc0 sc0 ls0 ws0">when y<span class="_ _4"></span>ou ma<span class="_ _4"></span>y not want to abort.</div><div class="t m0 x74 h14 y2ce ff8 fs3 fc0 sc0 ls0 ws43d">Let’<span class="_ _2"></span>s take a look at an example. Here is some a<span class="_ _1"></span>wkward code that sums e<span class="_ _4"></span>xpenses in a</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 ws0">billing application:</div><div class="t m5 x74 h2f yb21 ffb fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h2f yb22 ffb fs10 fc0 sc0 ls0 ws236">  MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());</div><div class="t m5 x74 h2f yb23 ffb fs10 fc0 sc0 ls14 ws237">  m_total += expenses.getTotal();</div><div class="t m5 x74 h2f yb24 ffb fs10 fc0 sc0 ls0 ws0">} catch(MealExpensesNotFound e) {</div><div class="t m5 x74 h2f yb25 ffb fs10 fc0 sc0 ls14 ws237">  m_total += getMealPerDiem();</div><div class="t m5 x74 h2f yb26 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 yb27 ff8 fs3 fc0 sc0 lsd ws211">In this business, if meals are expensed<span class="_ _1"></span>, they become part of the total. If they aren’<span class="_ _1"></span>t, the</div><div class="t m0 xd h14 y556 ff8 fs3 fc0 sc0 ls0 ws50a">emplo<span class="_ _4"></span>yee gets a meal <span class="ffa">per diem </span>amount for that da<span class="_ _1"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>The exception clutters the lo<span class="_ _4"></span>gic.</div><div class="t m0 xd h14 yb28 ff8 fs3 fc0 sc0 ls0 ws394">W<span class="_ _0"></span>ouldn’<span class="_ _1"></span>t it be better if we didn’<span class="_ _1"></span>t hav<span class="_ _4"></span>e to deal with the special case? If w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t, our code</div><div class="t m0 xd h14 yb29 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ould look much simpler<span class="_ _1"></span>. It would look lik<span class="_ _4"></span>e this:</div><div class="t m5 x74 h2f yb2a ffb fs10 fc0 sc0 ls0 ws0">MealExpenses expenses = expenseReportDAO.getMeals(employee.getID());</div><div class="t m5 x74 h2f yb2b ffb fs10 fc0 sc0 ls0 ws0">m_total += expenses.getTotal();</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:361.944010px;width:142.003000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8d" class="pf w1 h2" data-page-no="8d"><div class="pc pc8d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">110<span class="_ _2a"> </span><span class="ff1 wsf5">Chapter 7:<span class="_ _4"></span> Error Handling</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws50b">Can w<span class="_ _4"></span>e make the code that simple? It turns out that we can. <span class="_ _4"></span>W<span class="_ _0"></span>e can change the</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">ExpenseReportDAO</div><div class="t m0 xe2 h14 y195 ff8 fs3 fc0 sc0 ls0 ws50c">so that it al<span class="_ _4"></span>wa<span class="_ _1"></span>ys retur<span class="_ _8"></span>ns a </div><div class="t m5 x68 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">MealExpense</div><div class="t m0 xc9 h14 y195 ff8 fs3 fc0 sc0 ls0 ws50c">object. If there are no meal</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">expenses, it returns a </div><div class="t m5 x9 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">MealExpense</div><div class="t m0 x8 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> object that returns the <span class="ffa">per diem</span> as its total:</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">public class PerDiemMealExpenses implements MealExpenses {</div><div class="t m5 x74 h2f y404 ffb fs10 fc0 sc0 ls14 ws235">  public int getTotal() {</div><div class="t m5 x74 h2f y405 ffb fs10 fc0 sc0 ls18 ws235">    // return the per diem default</div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y407 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y408 ff8 fs3 fc0 sc0 ls0 ws50d">This is called the S<span class="fsb ws0">PECIAL<span class="fs3 ls55"> C<span class="_ _2"></span><span class="fsb ls0">ASE<span class="fs3 ls55"> P<span class="_ _0"></span><span class="fsb ls0">ATTERN<span class="_ _15"> </span><span class="fs3 ws50d">[F<span class="_ _1"></span>owler]. <span class="_ _0"></span>Y<span class="_ _3"></span>ou create a class or conﬁgure an</span></span></span></span></span></span></div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws3f0">object so that it handles a special case for you. <span class="_ _1"></span>When you do, the client code doesn’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws0">to deal with exceptional beha<span class="_ _1"></span>vior<span class="_ _4"></span>. <span class="_ _4"></span>That beha<span class="_ _4"></span>vior is encapsulated in the special case object.</div><div class="t m0 xd h17 yb2c ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t Return Null</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws50e">I think that an<span class="_ _4"></span>y discussion about er<span class="_ _8"></span>ror handling should include mention of the things we</div><div class="t m0 xd h14 y27e ff8 fs3 fc0 sc0 ls0 ws50f">do that in<span class="_ _4"></span>vite er<span class="_ _8"></span>rors. <span class="_ _4"></span>The ﬁrst on the list is returning </div><div class="t m5 xb2 h2f y27e ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xe3 h14 y27e ff8 fs3 fc0 sc0 ls0 ws50f">. I can’<span class="_ _1"></span>t begin to count the number</div><div class="t m0 xd h14 y27f ff8 fs3 fc0 sc0 ls0 ws169">of applications I’<span class="_ _1"></span>ve seen in which nearl<span class="_ _4"></span>y ev<span class="_ _4"></span>er<span class="_ _8"></span>y other line was a check for </div><div class="t m5 xa6 h2f y27f ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xd4 h14 y27f ff8 fs3 fc0 sc0 ls0 ws169">. Here is</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls0 ws0">some example code:</div><div class="t m5 x74 h2f yb2d ffb fs10 fc0 sc0 ls14 ws253">  public void registerItem(Item item) {</div><div class="t m5 x74 h2f yb2e ffb fs10 fc0 sc0 ls0 ws0">    if (item != null) {</div><div class="t m5 x74 h2f yb2f ffb fs10 fc0 sc0 ls0 ws0">      ItemRegistry registry = peristentStore.getItemRegistry();</div><div class="t m5 x74 h2f yb30 ffb fs10 fc0 sc0 ls0 ws0">      if (registry != null) {</div><div class="t m5 x74 h2f yb31 ffb fs10 fc0 sc0 ls0 ws0">        Item existing = registry.getItem(item.getID());</div><div class="t m5 x74 h2f yb32 ffb fs10 fc0 sc0 ls0 ws0">        if (existing.getBillingPeriod().hasRetailOwner()) {</div><div class="t m5 x74 h2f yb33 ffb fs10 fc0 sc0 ls0 ws0">          existing.register(item);</div><div class="t m5 x74 h2f yb34 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f yb35 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yb36 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yb37 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 lsd ws2ee">If you w<span class="_ _1"></span>ork in a code base with code like this, it might not look all that bad to you, but it is</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws510">bad! <span class="_ _4"></span>When we return </div><div class="t m5 xd0 h2f y550 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xc7 h14 y550 ff8 fs3 fc0 sc0 ls0 ws510">, w<span class="_ _4"></span>e are essentially creating w<span class="_ _1"></span>ork for ourselves and foisting</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws2a6">problems upon our callers. <span class="_ _1"></span>All it takes is one missing </div><div class="t m5 x17 h2f y2cb ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x6a h14 y2cb ff8 fs3 fc0 sc0 ls0 ws2a6">check to send an application</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws0">spinning out of control.</div><div class="t m0 x74 h14 y229 ff8 fs3 fc0 sc0 ls0 ws2bc">Did you notice the fact that there w<span class="_ _4"></span>asn’<span class="_ _4"></span>t a </div><div class="t m5 x66 h2f y229 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x54 h14 y229 ff8 fs3 fc0 sc0 ls11 ws151"> check in the second line of that nested</div><div class="t m5 xd h2f y582 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x3b h14 y582 ff8 fs3 fc0 sc0 ls0 ws511">statement? <span class="_ _4"></span>What w<span class="_ _4"></span>ould hav<span class="_ _4"></span>e happened at r<span class="_ _8"></span>untime if </div><div class="t m5 x61 h2f y582 ffb fs10 fc0 sc0 ls0 ws0">persistentStore</div><div class="t m0 xa9 h14 y582 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ere</div><div class="t m5 x99 h2f y582 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xb0 h14 y582 ff8 fs3 fc0 sc0 ls0 ws187">? W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y584 ff8 fs3 fc0 sc0 ls0 ws512">w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve had a </div><div class="t m5 xb h2f y584 ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 xaa h14 y584 ff8 fs3 fc0 sc0 ls0 ws512">at runtime, and either someone is catching</div><div class="t m5 xd h2f y585 ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 x4 h14 y585 ff8 fs3 fc0 sc0 ls0 ws513">at the top le<span class="_ _4"></span>vel or they are not. Either w<span class="_ _4"></span>a<span class="_ _4"></span>y it’<span class="_ _2"></span>s <span class="ffa ws0">bad</span><span class="ws514">. What <span class="_ _8"></span>exactly</span></div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws43e">should you do in response to a </div><div class="t m5 x8f h2f y3e5 ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 xb4 h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws43e">thro<span class="_ _4"></span>wn from the depths of your appli-</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws0">cation?</div><div class="t m0 x74 h14 y45d ff8 fs3 fc0 sc0 ls0 ws39c">It’<span class="_ _2"></span>s easy to sa<span class="_ _4"></span>y that the problem with the code abo<span class="_ _1"></span>ve is that it is missing a </div><div class="t m5 x98 h2f y45d ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xa8 h14 y45d ff8 fs3 fc0 sc0 ls0 ws0">check,</div><div class="t m0 xd h14 y45e ff8 fs3 fc0 sc0 lsd ws4e3">but in actuality<span class="_ _0"></span>, the problem is that it has <span class="ffa ls0 ws266">too many<span class="_ _0"></span><span class="ff8">. If you are tempted to return </span></span></div><div class="t m5 xda h2f y45e ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x30 h14 y45e ff8 fs3 fc0 sc0 ls0 ws0">from</div><div class="t m0 xd h14 yb27 ff8 fs3 fc0 sc0 ls0 ws3cb">a method<span class="_ _1"></span>, consider thro<span class="_ _4"></span>wing an exception or returning a S<span class="fsb ws0">PECIAL<span class="fs3 ls56"> C<span class="_ _4"></span><span class="fsb ls0">ASE<span class="_ _18"> </span><span class="fs3 ws3cb">object instead. If</span></span></span></span></div><div class="t m0 xd h14 y556 ff8 fs3 fc0 sc0 ls0 ws1f2">you are calling a </div><div class="t m5 xe4 h2f y556 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x4 h14 y556 ff8 fs3 fc0 sc0 ls0 ws1f2">-returning method from a third-par<span class="_ _8"></span>ty <span class="_ _4"></span>API, consider wrapping that</div><div class="t m0 xd h14 yb28 ff8 fs3 fc0 sc0 ls0 ws0">method with a method that either thro<span class="_ _4"></span>ws an exception or returns a special case object.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:433.945010px;width:109.105000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8e" class="pf w1 h2" data-page-no="8e"><div class="pc pc8e w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">111<span class="_ _10"></span><span class="ff1">Don’t P<span class="_ _1"></span>ass Null</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws183">In many cases, special case objects are an easy remedy<span class="_ _0"></span>. Imagine that y<span class="_ _4"></span>ou hav<span class="_ _4"></span>e code</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">like this:</div><div class="t m5 x74 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">List&lt;Employee&gt; employees = getEmployees();</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">if (employees != null) {</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls14 ws253">  for(Employee e : employees) {</div><div class="t m5 x74 h2f yae1 ffb fs10 fc0 sc0 ls19 ws237">    totalPay += e.getPay();</div><div class="t m5 x74 h2f yae2 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f yae3 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws515">Right no<span class="_ _4"></span>w<span class="_ _0"></span>, </div><div class="t m5 xb3 h2f y206 ffb fs10 fc0 sc0 ls0 ws0">getEmployees</div><div class="t m0 x15 h14 y206 ff8 fs3 fc0 sc0 ls0 ws515">can return </div><div class="t m5 x77 h2f y206 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x83 h14 y206 ff8 fs3 fc0 sc0 ls11 ws3fe">, but does it ha<span class="_ _4"></span>ve to? If w<span class="_ _4"></span>e change </div><div class="t m5 x5e h2f y206 ffb fs10 fc0 sc0 ls0 ws0">getEmployee</div><div class="t m0 xc8 h14 y206 ff8 fs3 fc0 sc0 ls0 ws0">so</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">that it returns an empty list, we can clean up the code:</div><div class="t m5 x74 h2f yb38 ffb fs10 fc0 sc0 ls0 ws0">List&lt;Employee&gt; employees = getEmployees();</div><div class="t m5 x74 h2f yb39 ffb fs10 fc0 sc0 ls0 ws0">for(Employee e : employees) {</div><div class="t m5 x74 h2f yb3a ffb fs10 fc0 sc0 ls14 ws237">  totalPay += e.getPay();</div><div class="t m5 x74 h2f yb3b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws516">F<span class="_ _1"></span>or<span class="_ _8"></span>tunately<span class="_ _0"></span>, Ja<span class="_ _4"></span>va has </div><div class="t m5 xc6 h2f y9f5 ffb fs10 fc0 sc0 ls0 ws0">Collections.emptyList()</div><div class="t m0 x66 h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws516">, and it returns a predeﬁned immutable list</div><div class="t m0 xd h14 y564 ff8 fs3 fc0 sc0 ls0 ws0">that w<span class="_ _4"></span>e can use for this pur<span class="_ _8"></span>pose:</div><div class="t m5 x74 h2f yb3c ffb fs10 fc0 sc0 ls0 ws0">public List&lt;Employee&gt; getEmployees() {</div><div class="t m5 x74 h2f yb3d ffb fs10 fc0 sc0 ls14 ws260">  if( .. there are no employees .. ) </div><div class="t m5 x74 h2f yb3e ffb fs10 fc0 sc0 ls19 ws2f1">    return Collections.emptyList();</div><div class="t m5 x74 h2f yb3f ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 yb40 ff8 fs3 fc0 sc0 ls0 ws517">If you code this w<span class="_ _4"></span>a<span class="_ _4"></span>y<span class="_ _0"></span>, you will minimize the chance of </div><div class="t m5 x89 h2f yb40 ffb fs10 fc0 sc0 ls0 ws0">NullPointerExceptions</div><div class="t m0 x94 h14 yb40 ff8 fs3 fc0 sc0 ls0 ws517">and your</div><div class="t m0 xd h14 yb41 ff8 fs3 fc0 sc0 ls0 ws0">code will be cleaner<span class="_ _1"></span>.</div><div class="t m0 xd h17 yb42 ff1 fs9 fc0 sc0 ls0 ws0">Don’<span class="_ _4"></span>t P<span class="_ _4"></span>ass Null</div><div class="t m0 xd h14 yb43 ff8 fs3 fc0 sc0 ls0 ws0">Returning </div><div class="t m5 x5f h2f yb43 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xe5 h14 yb43 ff8 fs3 fc0 sc0 lsd ws2ed">from methods is bad<span class="_ _1"></span>, but passing </div><div class="t m5 xc0 h2f yb43 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xb7 h14 yb43 ff8 fs3 fc0 sc0 ls0 ws464">into methods is w<span class="_ _4"></span>orse. Unless you</div><div class="t m0 xd h14 yb44 ff8 fs3 fc0 sc0 ls0 ws518">are w<span class="_ _4"></span>orking with an <span class="_ _1"></span>API which expects y<span class="_ _4"></span>ou to pass </div><div class="t m5 xb2 h2f y375 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x85 h14 y375 ff8 fs3 fc0 sc0 ls0 ws518">, you should a<span class="_ _1"></span>void passing </div><div class="t m5 xe6 h2f y375 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x16 h14 y375 ff8 fs3 fc0 sc0 ls57 ws45b"> in</div><div class="t m0 xd h14 y376 ff8 fs3 fc0 sc0 ls0 ws0">your code w<span class="_ _4"></span>henev<span class="_ _4"></span>er possible.</div><div class="t m0 x74 h14 y37b ff8 fs3 fc0 sc0 ls0 ws2e2">Let’<span class="_ _2"></span>s look at an example to see w<span class="_ _4"></span>hy<span class="_ _0"></span>. Here is a simple method which calculates a met-</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls0 ws0">ric for tw<span class="_ _4"></span>o points:</div><div class="t m5 x74 h2f y98f ffb fs10 fc0 sc0 ls0 ws0">public class MetricsCalculator </div><div class="t m5 x74 h2f yb45 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f yb46 ffb fs10 fc0 sc0 ls14 ws260">  public double xProjection(Point p1, Point p2) {</div><div class="t m5 x74 h2f yb47 ffb fs10 fc0 sc0 ls19 ws253">    return (p2.x – p1.x) * 1.5;</div><div class="t m5 x74 h2f yb48 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f yb49 ffb fs10 fc0 sc0 ls1c ws0">  …</div><div class="t m5 x74 h2f yb4a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">What happens when someone passes </div><div class="t m5 xdd h2f y5b6 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x65 h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0"> as an argument?</div><div class="t m5 x74 h2f yb4b ffb fs10 fc0 sc0 ls0 ws0">calculator.xProjection(null, new Point(12, 13));</div><div class="t m0 x74 h14 yb4c ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e’<span class="_ _4"></span>ll get a </div><div class="t m5 xe5 h2f yb4c ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 x26 h14 yb4c ff8 fs3 fc0 sc0 ls0 ws0">, of course.</div><div class="t m0 x74 h14 y42f ff8 fs3 fc0 sc0 ls0 ws0">Ho<span class="_ _4"></span>w can w<span class="_ _4"></span>e ﬁx it? W<span class="_ _2"></span>e could create a new exception type and thro<span class="_ _1"></span>w it:</div><div class="t m5 x74 h2f yb4d ffb fs10 fc0 sc0 ls0 ws0">public class MetricsCalculator </div><div class="t m5 x74 h2f yb4e ffb fs10 fc0 sc0 ls0 ws0">{</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:304.945010px;width:92.500000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf8f" class="pf w1 h2" data-page-no="8f"><div class="pc pc8f w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">112<span class="_ _2a"> </span><span class="ff1 wsf5">Chapter 7:<span class="_ _4"></span> Error Handling</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls14 ws260">  public double xProjection(Point p1, Point p2) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls18 ws260">    if (p1 == null || p2 == null) {</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls1f ws2f1">      throw InvalidArgumentException(</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls1f ws241">        &quot;Invalid argument for MetricsCalculator.xProjection&quot;);</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls19 ws253">    return (p2.x – p1.x) * 1.5;</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws519">Is this better? It might be a little better than a </div><div class="t m5 x68 h2f y205 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xb4 h14 y205 ff8 fs3 fc0 sc0 ls11 ws51a">pointer exception, but remember<span class="_ _1"></span>, we</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws51b">ha<span class="_ _4"></span>ve to deﬁne a handler for </div><div class="t m5 xcc h2f y206 ffb fs10 fc0 sc0 ls0 ws0">InvalidArgumentException</div><div class="t m0 x17 h14 y206 ff8 fs3 fc0 sc0 ls0 ws51b">. <span class="_ _4"></span>What should the handler do? Is</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">there any good course of action?</div><div class="t m0 x74 h14 y846 ff8 fs3 fc0 sc0 ls0 ws0">There is another alternative. <span class="_ _1"></span>W<span class="_ _0"></span>e could use a set of asser<span class="_ _8"></span>tions:</div><div class="t m5 x74 h2f y59 ffb fs10 fc0 sc0 ls0 ws0">public class MetricsCalculator </div><div class="t m5 x74 h2f yb4f ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f yb50 ffb fs10 fc0 sc0 ls14 ws260">  public double xProjection(Point p1, Point p2) {</div><div class="t m5 x74 h2f yb51 ffb fs10 fc0 sc0 ls14 ws253">    assert p1 != null : &quot;p1 should not be null&quot;;</div><div class="t m5 x74 h2f yb52 ffb fs10 fc0 sc0 ls14 ws253">    assert p2 != null : &quot;p2 should not be null&quot;;</div><div class="t m5 x74 h2f yb53 ffb fs10 fc0 sc0 ls18 ws253">    return (p2.x – p1.x) * 1.5;</div><div class="t m5 x74 h2f yb54 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f yb55 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y3d7 ff8 fs3 fc0 sc0 lsd ws51c">It’<span class="_ _2"></span>s good documentation, but it doesn’<span class="_ _4"></span>t solve the prob<span class="_ _4"></span>lem. If someone passes </div><div class="t m5 x7a h2f y3d7 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xa8 h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws51d">, w<span class="_ _4"></span>e’<span class="_ _4"></span>ll</div><div class="t m0 xd h14 y749 ff8 fs3 fc0 sc0 ls0 ws0">still ha<span class="_ _4"></span>ve a runtime er<span class="_ _8"></span>ror<span class="_ _4"></span>. </div><div class="t m0 x74 h14 y578 ff8 fs3 fc0 sc0 ls0 ws51e">In most programming languages there is no good w<span class="_ _4"></span>ay to deal with a </div><div class="t m5 x63 h2f y578 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xa8 h14 y578 ff8 fs3 fc0 sc0 ls0 ws51e">that is</div><div class="t m0 xd h14 y579 ff8 fs3 fc0 sc0 ls0 ws51f">passed by a caller accidentall<span class="_ _1"></span>y<span class="_ _1"></span>. Because this is the case, the rational approach is to forbid</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws0">passing</div><div class="t m5 x75 h2f y57a ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x41 h14 y57a ff8 fs3 fc0 sc0 ls0 wsa2">b<span class="_ _4"></span>y def<span class="_ _8"></span>ault. <span class="_ _4"></span>When you do, you can code with the kno<span class="_ _1"></span>wledge that a </div><div class="t m5 xda h2f y57a ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xb0 h14 y57a ff8 fs3 fc0 sc0 ls0 wsa2">in an</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls0 ws0">argument list is an indication of a prob<span class="_ _4"></span>lem, and end up with far few<span class="_ _4"></span>er careless mistakes.</div><div class="t m0 xd h17 yb56 ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 lsd ws23">Clean code is readable, but it must also be robust. <span class="_ _1"></span>These are not conﬂicting goals. <span class="_ _4"></span>W<span class="_ _0"></span>e can</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 lsd ws259">write robust clean code if w<span class="_ _4"></span>e see er<span class="_ _8"></span>ror handling as a separate concer<span class="_ _8"></span>n, something that is</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws83">view<span class="_ _1"></span>able independently of our main lo<span class="_ _4"></span>gic. <span class="_ _1"></span>T<span class="_ _1"></span>o the degree that we are ab<span class="_ _4"></span>le to do that, w<span class="_ _4"></span>e can</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws520">reason about it independentl<span class="_ _4"></span>y<span class="_ _1"></span>, and w<span class="_ _4"></span>e can make g<span class="_ _8"></span>reat strides in the maintainability of our</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws0">code.</div><div class="t m0 xd h17 yb57 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y470 ff1 fs3 fc0 sc0 ls0 wsa0">[Martin]:  <span class="ffa ws521">Agile Softw<span class="_ _4"></span>ar<span class="_ _4"></span>e Development: Principles, P<span class="_ _0"></span>atterns, and Practices,<span class="_ _15"> </span><span class="ff8">Robert C.</span></span></div><div class="t m0 xd h14 y401 ff8 fs3 fc0 sc0 ls0 ws0">Martin, Prentice Hall, 2002.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:274.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:170.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf90" class="pf w1 h2" data-page-no="90"><div class="pc pc90 w1 h2"><img class="bi xd yb58 w4 h6c" alt="" src="bg90.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">113</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">8</div><div class="t m0 x6a h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Boundaries</div><div class="t m0 x6b h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y James Grenning</div><div class="t m0 xd h14 yb59 ff8 fs3 fc0 sc0 lsd ws522">W<span class="_ _0"></span>e seldom control all the software in our systems. Sometimes w<span class="_ _1"></span>e buy third-par<span class="_ _8"></span>ty pack-</div><div class="t m0 xd h14 yb5a ff8 fs3 fc0 sc0 ls0 ws2ca">ages or use open source. Other times w<span class="_ _4"></span>e depend on teams in our o<span class="_ _4"></span>wn company to produce</div><div class="t m0 xd h14 yb5b ff8 fs3 fc0 sc0 ls0 wse2">components or subsystems for us. Someho<span class="_ _4"></span>w w<span class="_ _4"></span>e must cleanly inte<span class="_ _4"></span>g<span class="_ _8"></span>rate this foreign code</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:321.561000px;bottom:440.027010px;width:117.359000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf91" class="pf w1 h2" data-page-no="91"><div class="pc pc91 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">114<span class="_ _2b"> </span><span class="ff1 wsa0">Chapter 8:<span class="_ _4"></span> Boundaries</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 wsb1">with our o<span class="_ _4"></span>wn. In this chapter w<span class="_ _4"></span>e look at practices and techniques to keep the boundaries of</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">our software clean.</div><div class="t m0 xd h17 y297 ff1 fs9 fc0 sc0 ls0 ws4db">Using Third-P<span class="_ _1"></span>arty <span class="_ _6"></span>Code</div><div class="t m0 xd h14 y298 ff8 fs3 fc0 sc0 ls0 ws3e8">There is a natural tension betw<span class="_ _4"></span>een the pro<span class="_ _4"></span>vider of an interface and the user of an interf<span class="_ _8"></span>ace.</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws523">Pro<span class="_ _4"></span>viders of third-party packages and framew<span class="_ _4"></span>orks stri<span class="_ _4"></span>ve for broad applicability so they</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws51f">can w<span class="_ _4"></span>ork in many en<span class="_ _1"></span>vironments and appeal to a wide audience. Users, on the other hand<span class="_ _4"></span>,</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws1a7">w<span class="_ _4"></span>ant an interf<span class="_ _8"></span>ace that is focused on their particular needs. <span class="_ _4"></span>This tension can cause problems</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws0">at the boundaries of our systems.</div><div class="t m0 x74 h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws524">Let’<span class="_ _2"></span>s look at </div><div class="t m5 x6 h2f y3b6 ffb fs10 fc0 sc0 ls0 ws0">java.util.Map</div><div class="t m0 x92 h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws524">as an example. <span class="_ _1"></span>As you can see b<span class="_ _4"></span>y examining F<span class="_ _4"></span>igure 8-1,</div><div class="t m5 xd h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x3b h14 y3b7 ff8 fs3 fc0 sc0 ls22 ws21">s ha<span class="_ _4"></span>ve a very broad interface with plenty of capabilities. Cer<span class="_ _8"></span>tainly this po<span class="_ _1"></span>wer and ﬂe<span class="_ _4"></span>xi-</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 lsd ws195">bility is useful, but it can also be a liability<span class="_ _0"></span>. F<span class="_ _4"></span>or instance, our application might build up a</div><div class="t m5 xd h2f y537 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xe7 h14 y537 ff8 fs3 fc0 sc0 ls0 ws525">and pass it around. Our intention might be that none of the recipients of our </div><div class="t m5 xda h2f y537 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x36 h14 y537 ff8 fs3 fc0 sc0 ls0 ws0">delete</div><div class="t m0 xd h14 y538 ff8 fs3 fc0 sc0 ls0 ws494">anything in the map. But right there at the top of the list is the </div><div class="t m5 xe8 h2f y538 ffb fs10 fc0 sc0 ls0 ws0">clear()</div><div class="t m0 x97 h14 y538 ff8 fs3 fc0 sc0 ls0 ws494">method. <span class="_ _1"></span>Any user of</div><div class="t m0 xd h14 y464 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 xe7 h2f y464 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xc5 h14 y464 ff8 fs3 fc0 sc0 ls0 ws526">has the po<span class="_ _4"></span>w<span class="_ _4"></span>er to clear it. Or maybe our design con<span class="_ _1"></span>vention is that onl<span class="_ _4"></span>y par<span class="_ _8"></span>ticular</div><div class="t m0 xd h14 y465 ff8 fs3 fc0 sc0 ls0 ws527">types of objects can be stored in the </div><div class="t m5 x32 h2f y465 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x22 h14 y465 ff8 fs3 fc0 sc0 ls58 ws528">, but </div><div class="t m5 x23 h2f y465 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xc0 h14 y465 ff8 fs3 fc0 sc0 ls0 ws527">s do not reliabl<span class="_ _4"></span>y constrain the types of</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 ls0 ws0">objects placed within them. <span class="_ _1"></span>Any determined user can add items of any type to an<span class="_ _4"></span>y </div><div class="t m5 x64 h2f y466 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xbf h14 y466 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y5ee ff8 fs3 fc0 sc0 ls0 ws0">If our application needs a </div><div class="t m5 x8f h2f y5ee ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x8 h14 y5ee ff8 fs3 fc0 sc0 ls0 ws0"> of </div><div class="t m5 x26 h2f y5ee ffb fs10 fc0 sc0 ls0 ws0">Sensor</div><div class="t m0 xaa h14 y5ee ff8 fs3 fc0 sc0 ls0 ws0">s, you might ﬁnd the sensors set up lik<span class="_ _4"></span>e this:</div><div class="t m5 x8a h2f y342 ffb fs10 fc0 sc0 ls0 ws0">Map sensors = new HashMap();</div><div class="t m0 xb h6d y884 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f y884 ffb fs10 fc0 sc0 ls0 ws0">clear() void – Map</div><div class="t m0 xb h6d yb5c ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb5c ffb fs10 fc0 sc0 ls0 ws0">containsKey(Object key) boolean – Map</div><div class="t m0 xb h6d y71f ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f y71f ffb fs10 fc0 sc0 ls0 ws0">containsValue(Object value) boolean – Map</div><div class="t m0 xb h6d yb5d ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb5d ffb fs10 fc0 sc0 ls0 ws0">entrySet() Set – Map</div><div class="t m0 xb h6d ya74 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f ya74 ffb fs10 fc0 sc0 ls0 ws0">equals(Object o) boolean – Map</div><div class="t m0 xb h6d yb5e ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb5e ffb fs10 fc0 sc0 ls0 ws0">get(Object key) Object – Map</div><div class="t m0 xb h6d yb5f ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb5f ffb fs10 fc0 sc0 ls0 ws0">getClass() Class&lt;? extends Object&gt; – Object</div><div class="t m0 xb h6d yb60 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb60 ffb fs10 fc0 sc0 ls0 ws0">hashCode() int – Map</div><div class="t m0 xb h6d yb61 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb61 ffb fs10 fc0 sc0 ls0 ws0">isEmpty() boolean – Map</div><div class="t m0 xb h6d yb62 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb62 ffb fs10 fc0 sc0 ls0 ws0">keySet() Set – Map</div><div class="t m0 xb h6d y809 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f y809 ffb fs10 fc0 sc0 ls0 ws0">notify() void – Object</div><div class="t m0 xb h6d yb63 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb63 ffb fs10 fc0 sc0 ls0 ws0">notifyAll() void – Object</div><div class="t m0 xb h6d y457 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f y457 ffb fs10 fc0 sc0 ls0 ws0">put(Object key, Object value) Object – Map</div><div class="t m0 xb h6d yb64 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb64 ffb fs10 fc0 sc0 ls0 ws0">putAll(Map t) void – Map</div><div class="t m0 xb h6d yb65 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb65 ffb fs10 fc0 sc0 ls0 ws0">remove(Object key) Object – Map</div><div class="t m0 xb h6d yb66 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb66 ffb fs10 fc0 sc0 ls0 ws0">size() int – Map</div><div class="t m0 xb h6d yb67 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb67 ffb fs10 fc0 sc0 ls0 ws0">toString() String – Object</div><div class="t m0 xb h6d yb68 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb68 ffb fs10 fc0 sc0 ls0 ws0">values() Collection – Map</div><div class="t m0 xb h6d y60c ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f y60c ffb fs10 fc0 sc0 ls0 ws0">wait() void – Object</div><div class="t m0 xb h6d yb69 ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb69 ffb fs10 fc0 sc0 ls0 ws0">wait(long timeout) void – Object</div><div class="t m0 xb h6d yb6a ff12 fsf fc0 sc0 ls0 ws0">•</div><div class="t m5 x2e h2f yb6a ffb fs10 fc0 sc0 ls0 ws0">wait(long timeout, int nanos) void – Object</div><div class="t m0 x33 h1c y3e6 ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 8-1</div><div class="t m0 x76 h14 y6dd ff8 fs3 fc0 sc0 ls0 ws0">The methods of </div><div class="t m7 x7e h6e y6dd ffb fs3 fc0 sc0 ls0 ws0">Map</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:538.945010px;width:144.049000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf92" class="pf w1 h2" data-page-no="92"><div class="pc pc92 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">115<span class="_ _10"></span><span class="ff1 wse1">Using Third-P<span class="_ _1"></span>ar<span class="_ _8"></span>ty <span class="_ _5"></span>Code</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Then, when some other part of the code needs to access the sensor<span class="_ _4"></span>, you see this code:</div><div class="t m5 x8a h2f ya7a ffb fs10 fc0 sc0 ls0 ws0">Sensor s = (Sensor)sensors.get(sensorId );</div><div class="t m0 xd h14 ya7b ff8 fs3 fc0 sc0 ls4b ws17e">W<span class="_ _0"></span>e don’<span class="_ _4"></span>t just see it once, but o<span class="_ _1"></span>ver and o<span class="_ _4"></span>ver again throughout the code. <span class="_ _1"></span>The client of this</div><div class="t m0 xd h14 ya7c ff8 fs3 fc0 sc0 ls4b ws11b">code car<span class="_ _8"></span>ries the responsibility of getting an </div><div class="t m5 xbe h2f ya7c ffb fs10 fc0 sc0 ls0 ws0">Object</div><div class="t m0 x7e h14 ya7c ff8 fs3 fc0 sc0 ls4b ws11b">from the </div><div class="t m5 x6a h2f ya7c ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xa3 h14 ya7c ff8 fs3 fc0 sc0 ls4b ws11b">and casting it to the right</div><div class="t m0 xd h14 ya7d ff8 fs3 fc0 sc0 ls4a ws529">type. <span class="_ _1"></span>This works, but it’<span class="_ _3"></span>s not clean code. <span class="_ _4"></span>Also, this code does not tell its stor<span class="_ _8"></span>y as w<span class="_ _4"></span>ell as <span class="_ _8"></span>it</div><div class="t m0 xd h14 yb6b ff8 fs3 fc0 sc0 ls4b ws52a">could. The readability of this code can be greatly impro<span class="_ _1"></span>ved by using generics, as sho<span class="_ _1"></span>wn</div><div class="t m0 xd h14 y681 ff8 fs3 fc0 sc0 ls4b ws0">belo<span class="_ _4"></span>w:</div><div class="t m5 x8a h2f yb6c ffb fs10 fc0 sc0 ls0 ws0">Map&lt;Sensor&gt; sensors = new HashMap&lt;Sensor&gt;();</div><div class="t m5 x74 h2f yb6d ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x8a h2f yb6e ffb fs10 fc0 sc0 ls0 ws0">Sensor s = sensors.get(sensorId );</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 wsf8">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, this doesn’<span class="_ _1"></span>t solve the prob<span class="_ _4"></span>lem that </div><div class="t m5 x67 h2f y1df ffb fs10 fc0 sc0 ls0 ws0">Map&lt;Sensor&gt;</div><div class="t m0 x89 h14 y1df ff8 fs3 fc0 sc0 ls0 wsf8">pro<span class="_ _4"></span>vides more capability than w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">need or want.</div><div class="t m0 x74 h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws52b">Passing an instance of </div><div class="t m5 x2f h2f y435 ffb fs10 fc0 sc0 ls0 ws0">Map&lt;Sensor&gt;</div><div class="t m0 xe0 h14 y435 ff8 fs3 fc0 sc0 ls0 ws52b">liberally around the system means that there will</div><div class="t m0 xd h14 y40a ff8 fs3 fc0 sc0 ls0 ws2f9">be a lot of places to ﬁx if the interface to </div><div class="t m5 x22 h2f y40a ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x78 h14 y40a ff8 fs3 fc0 sc0 ls0 ws2f9">e<span class="_ _4"></span>ver changes. <span class="_ _0"></span>Y<span class="_ _2"></span>ou might think such a change</div><div class="t m0 xd h14 y40b ff8 fs3 fc0 sc0 lsd ws459">to be unlikel<span class="_ _4"></span>y<span class="_ _1"></span>, but remember that it changed when generics support w<span class="_ _4"></span>as added in Jav<span class="_ _4"></span>a 5.</div><div class="t m0 xd h14 y40c ff8 fs3 fc0 sc0 ls0 ws48">Indeed<span class="_ _1"></span>, we’<span class="_ _1"></span>ve seen systems that are inhibited from using generics because of the sheer</div><div class="t m0 xd h14 yb6f ff8 fs3 fc0 sc0 ls0 ws0">magnitude of changes needed to make up for the liberal use of </div><div class="t m5 x53 h2f y40e ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xb5 h14 y40e ff8 fs3 fc0 sc0 ls0 ws0">s.</div><div class="t m0 x74 h14 y40f ff8 fs3 fc0 sc0 ls0 ws8c">A cleaner wa<span class="_ _1"></span>y to use </div><div class="t m5 xb1 h2f y40f ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x5a h14 y40f ff8 fs3 fc0 sc0 ls0 ws8c">might look like the follo<span class="_ _1"></span>wing. No user of </div><div class="t m5 xac h2f y40f ffb fs10 fc0 sc0 ls0 ws0">Sensors</div><div class="t m0 x93 h14 y40f ff8 fs3 fc0 sc0 ls0 ws8c">w<span class="_ _4"></span>ould care</div><div class="t m0 xd h14 y410 ff8 fs3 fc0 sc0 ls0 ws4cf">one bit if generics w<span class="_ _4"></span>ere used or not. <span class="_ _4"></span>That choice has become (and al<span class="_ _4"></span>wa<span class="_ _4"></span>ys should be) an</div><div class="t m0 xd h14 y411 ff8 fs3 fc0 sc0 ls0 ws0">implementation detail.</div><div class="t m5 x74 h2f yb70 ffb fs10 fc0 sc0 ls0 ws0">public class Sensors {</div><div class="t m5 x52 h2f yb71 ffb fs10 fc0 sc0 ls0 ws0">private Map sensors = new HashMap();</div><div class="t m5 x52 h2f yb72 ffb fs10 fc0 sc0 ls0 ws0">public Sensor getById(String id) {</div><div class="t m5 x8a h2f yb73 ffb fs10 fc0 sc0 ls0 ws0">return (Sensor) sensors.get(id);</div><div class="t m5 x52 h2f yb74 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f yb75 ffb fs10 fc0 sc0 ls0 ws0">//snip</div><div class="t m5 x74 h2f yb76 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y3fa ff8 fs3 fc0 sc0 ls0 ws360">The interface at the boundar<span class="_ _8"></span>y (</div><div class="t m5 x38 h2f y3fa ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x81 h14 y3fa ff8 fs3 fc0 sc0 ls22 ws401">) is hidden. It is able to e<span class="_ _4"></span>volv<span class="_ _4"></span>e with very little impact on</div><div class="t m0 xd h14 y3fb ff8 fs3 fc0 sc0 ls0 ws22d">the rest of the application. <span class="_ _1"></span>The use of generics is no longer a big issue because the casting</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">and type management is handled inside the </div><div class="t m5 xaa h2f y3fc ffb fs10 fc0 sc0 ls0 ws0">Sensors</div><div class="t m0 x54 h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0"> class. </div><div class="t m0 x74 h14 yb77 ff8 fs3 fc0 sc0 ls0 ws52c">This interface is also tailored and constrained to meet the needs of the application. It</div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 ls0 ws55">results in code that is easier to understand and harder to misuse. <span class="_ _1"></span>The </div><div class="t m5 x8d h2f y739 ffb fs10 fc0 sc0 ls0 ws0">Sensors</div><div class="t m0 x94 h14 y739 ff8 fs3 fc0 sc0 ls0 ws55">class can</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 lsd wsef">enforce design and business rules.</div><div class="t m0 x74 h14 y95b ff8 fs3 fc0 sc0 ls0 ws52d">W<span class="_ _0"></span>e are not suggesting that ev<span class="_ _4"></span>ery use of </div><div class="t m5 x78 h2f y95b ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x34 h14 y95b ff8 fs3 fc0 sc0 ls0 ws52d">be encapsulated in this form. Rather, w<span class="_ _1"></span>e</div><div class="t m0 xd h14 ya1e ff8 fs3 fc0 sc0 ls0 ws52e">are advising you not to pass </div><div class="t m5 x84 h2f ya1e ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 xc h14 ya1e ff8 fs3 fc0 sc0 ls0 ws52e">s (or any other interface at a boundary) around your</div><div class="t m0 xd h14 yb78 ff8 fs3 fc0 sc0 ls0 ws2f3">system. If you use a boundary interface like </div><div class="t m5 x1b h2f yb78 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x42 h14 yb78 ff8 fs3 fc0 sc0 ls0 ws2f3">, keep it inside the class, or close famil<span class="_ _4"></span>y</div><div class="t m0 xd h14 yb79 ff8 fs3 fc0 sc0 ls0 ws52f">of <span class="_ _2"></span>classes, where it is used. <span class="_ _1"></span>A<span class="_ _0"></span>void returning it from, or accepting it as an argument to,</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls0 ws530">public APIs.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf93" class="pf w1 h2" data-page-no="93"><div class="pc pc93 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg93.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">116<span class="_ _2b"> </span><span class="ff1 wsa0">Chapter 8:<span class="_ _4"></span> Boundaries</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Exploring and Learning Boundaries</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws44d">Third-party code helps us get more functionality delivered in less time. <span class="_ _1"></span>Where do we start</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws3b2">when w<span class="_ _1"></span>e want to utilize some third-party package? It’<span class="_ _2"></span>s not our job to test the third-par<span class="_ _8"></span>ty</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 lsd wsef">code, but it ma<span class="_ _4"></span>y be in our best interest to write tests for the third-par<span class="_ _8"></span>ty code w<span class="_ _4"></span>e use. </div><div class="t m0 x74 h14 y460 ff8 fs3 fc0 sc0 ls0 ws79">Suppose it is not clear ho<span class="_ _4"></span>w to use our third-party librar<span class="_ _8"></span>y<span class="_ _1"></span>. W<span class="_ _2"></span>e might spend a day or tw<span class="_ _1"></span>o</div><div class="t m0 xd h14 y461 ff8 fs3 fc0 sc0 ls0 ws531">(or more) reading the documentation and deciding ho<span class="_ _4"></span>w w<span class="_ _4"></span>e are going to use it. <span class="_ _4"></span>Then w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws10a">might write our code to use the third-party code and see whether it does what w<span class="_ _1"></span>e think. W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 lsd wsb3">w<span class="_ _4"></span>ould not be sur<span class="_ _8"></span>prised to ﬁnd ourselves bo<span class="_ _4"></span>gged do<span class="_ _4"></span>wn in long debugging sessions tr<span class="_ _8"></span>ying to</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 lsd wsef">ﬁgure out whether the bugs w<span class="_ _1"></span>e are experiencing are in our code or theirs. </div><div class="t m0 x74 h14 y252 ff8 fs3 fc0 sc0 ls0 ws532">Learning the third-par<span class="_ _8"></span>ty code is hard. Integrating the third-par<span class="_ _8"></span>ty code is hard too.</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws30c">Doing both at the same time is doubl<span class="_ _4"></span>y hard. What if w<span class="_ _4"></span>e took a different approach? Instead</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws1e5">of experimenting and trying out the new stuf<span class="_ _4"></span>f in our production code, w<span class="_ _4"></span>e could write some</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws1e">tests to explore our understanding of the third-party code. Jim Newkirk calls such tests</div><div class="t m0 xd h1d y29c ffa fs3 fc0 sc0 ls0 ws0">learning tests.</div><div class="t m0 x28 h21 y730 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x74 h14 y464 ff8 fs3 fc0 sc0 ls0 ws533">In learning tests we call the third-party <span class="_ _1"></span>API, as we e<span class="_ _4"></span>xpect to use it in our application.</div><div class="t m0 xd h14 y465 ff8 fs3 fc0 sc0 ls0 ws100">W<span class="_ _0"></span>e’<span class="_ _0"></span>re essentially doing controlled experiments that check our understanding of that <span class="_ _1"></span>API.</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 ls0 ws0">The tests focus on what w<span class="_ _1"></span>e want out of the <span class="_ _1"></span>API. </div><div class="t m0 xd h17 y467 ff1 fs9 fc0 sc0 ls0 ws0">Learning </div><div class="t m3 x86 h1a y467 ffc fsa fc0 sc0 ls0 ws0">log4j</div><div class="t m0 xd h14 y468 ff8 fs3 fc0 sc0 ls0 ws534">Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y we w<span class="_ _1"></span>ant to use the apache </div><div class="t m5 x43 h2f y468 ffb fs10 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 xc4 h14 y468 ff8 fs3 fc0 sc0 lsd ws535">package rather than our o<span class="_ _4"></span>wn custom-built log-</div><div class="t m0 xd h14 y469 ff8 fs3 fc0 sc0 ls0 ws536">ger<span class="_ _1"></span>. W<span class="_ _0"></span>e do<span class="_ _1"></span>wnload it and open the introductor<span class="_ _8"></span>y documentation page. W<span class="_ _1"></span>ithout too much</div><div class="t m0 xd h14 y46a ff8 fs3 fc0 sc0 ls0 ws0">reading w<span class="_ _4"></span>e write our ﬁrst test case, expecting it to write “hello” to the console.</div><div class="t m5 x52 h2f yb7a ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x52 h2f yb7b ffb fs10 fc0 sc0 ls0 ws0">public void testLogCreate() {</div><div class="t m5 x8a h2f yb7c ffb fs10 fc0 sc0 ls0 ws0">Logger logger = Logger.getLogger(&quot;MyLogger&quot;);</div><div class="t m5 x8a h2f yb7d ffb fs10 fc0 sc0 ls0 ws0">logger.info(&quot;hello&quot;);</div><div class="t m5 x52 h2f yb7e ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls0 ws2d0">When w<span class="_ _4"></span>e r<span class="_ _8"></span>un it, the logger produces an error that tells us w<span class="_ _4"></span>e need something called an</div><div class="t m5 xd h2f y673 ffb fs10 fc0 sc0 ls0 ws0">Appender</div><div class="t m0 x9a h14 y673 ff8 fs3 fc0 sc0 ls0 ws1f1">. <span class="_ _1"></span>After a little more reading we ﬁnd that there is a </div><div class="t m5 xa1 h2f y673 ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender</div><div class="t m0 x6f h14 y673 ff8 fs3 fc0 sc0 ls0 ws1f1">. So w<span class="_ _4"></span>e create a</div><div class="t m5 xd h2f y8de ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender</div><div class="t m0 x24 h14 y8de ff8 fs3 fc0 sc0 ls0 ws0"> and see whether w<span class="_ _1"></span>e hav<span class="_ _4"></span>e unlocked the secrets of logging to the console.</div><div class="t m5 x52 h2f yb7f ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x52 h2f yb80 ffb fs10 fc0 sc0 ls0 ws0">public void testLogAddAppender() {</div><div class="t m5 x8a h2f yb81 ffb fs10 fc0 sc0 ls0 ws0">Logger logger = Logger.getLogger(&quot;MyLogger&quot;);</div><div class="t m5 x8a h2f yb82 ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender appender = new ConsoleAppender();</div><div class="t m5 x8a h2f yb83 ffb fs10 fc0 sc0 ls0 ws0">logger.addAppender(appender);</div><div class="t m5 x8a h2f yb84 ffb fs10 fc0 sc0 ls0 ws0">logger.info(&quot;hello&quot;);</div><div class="t m5 x52 h2f yb85 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[BeckTDD], pp. 136–137.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:216.454000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:335.594010px;width:92.040000px;height:15.947000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf94" class="pf w1 h2" data-page-no="94"><div class="pc pc94 w1 h2"><img class="bi xd yb86 wc h6f" alt="" src="bg94.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">117<span class="_ _10"></span><span class="ff1">Learning </span></div><div class="t m7 x80 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws42b">This time w<span class="_ _4"></span>e ﬁnd that the </div><div class="t m5 x1f h2f y194 ffb fs10 fc0 sc0 ls0 ws0">Appender</div><div class="t m0 xd1 h14 y194 ff8 fs3 fc0 sc0 ls0 ws42b">has no output stream. Odd—it seems logical that it’<span class="_ _3"></span>d</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>ve one. <span class="_ _1"></span>After a little help from Google, w<span class="_ _4"></span>e try the following:</div><div class="t m5 x52 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x52 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">public void testLogAddAppender() {</div><div class="t m5 x8a h2f y433 ffb fs10 fc0 sc0 ls0 ws0">Logger logger = Logger.getLogger(&quot;MyLogger&quot;);</div><div class="t m5 x8a h2f yae1 ffb fs10 fc0 sc0 ls0 ws0">logger.removeAllAppenders();</div><div class="t m5 x8a h2f yae2 ffb fs10 fc0 sc0 ls0 ws0">logger.addAppender(new ConsoleAppender(</div><div class="t m5 x86 h2f yae3 ffb fs10 fc0 sc0 ls0 ws0">new PatternLayout(&quot;%p %t %m%n&quot;), </div><div class="t m5 x86 h2f yae4 ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender.SYSTEM_OUT));</div><div class="t m5 x8a h2f yae5 ffb fs10 fc0 sc0 ls0 ws0">logger.info(&quot;hello&quot;);</div><div class="t m5 x52 h2f yb87 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws537">That w<span class="_ _4"></span>orked; a lo<span class="_ _4"></span>g message that includes “hello” came out on the console! It seems odd</div><div class="t m0 xd h14 y92b ff8 fs3 fc0 sc0 ls0 ws0">that w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve to tell the </div><div class="t m5 xd0 h2f y92b ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender</div><div class="t m0 xe9 h14 y92b ff8 fs3 fc0 sc0 ls0 ws0"> that it writes to the console. </div><div class="t m0 x74 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws245">Interestingl<span class="_ _4"></span>y enough, when w<span class="_ _4"></span>e remo<span class="_ _4"></span>ve the </div><div class="t m5 x42 h2f y1e0 ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender.SystemOut</div><div class="t m0 xe1 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws245">argument, w<span class="_ _1"></span>e</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws538">see that “hello” is still printed. But when w<span class="_ _1"></span>e take out the </div><div class="t m5 xb6 h2f y1e1 ffb fs10 fc0 sc0 ls0 ws0">PatternLayout</div><div class="t m0 x6b h14 y1e1 ff8 fs3 fc0 sc0 ls22 ws1bb">, it once again com-</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">plains about the lack of an output stream. <span class="_ _1"></span>This is ver<span class="_ _8"></span>y strange beha<span class="_ _4"></span>vior<span class="_ _4"></span>. </div><div class="t m0 x74 h14 y1bf ff8 fs3 fc0 sc0 ls0 ws539">Looking a little more carefull<span class="_ _4"></span>y at the documentation, we see that the default</div><div class="t m5 xd h2f y40c ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender</div><div class="t m0 x3a h14 y40c ff8 fs3 fc0 sc0 ls0 ws53a">constructor is “unconﬁgured<span class="_ _4"></span>,<span class="_ _1"></span>” which does not seem too ob<span class="_ _4"></span>vious or useful.</div><div class="t m0 xd h14 yb6f ff8 fs3 fc0 sc0 lsd wsef">This feels like a bug, or at least an inconsistenc<span class="_ _4"></span>y<span class="_ _1"></span>, in </div><div class="t m5 xea h2f yb6f ffb fs10 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 x89 h14 yb6f ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 yb88 ff8 fs3 fc0 sc0 ls17 ws417">A bit more goo<span class="_ _4"></span>gling, reading, and testing, and we e<span class="_ _4"></span>ventuall<span class="_ _4"></span>y wind up with Listing 8-1.</div><div class="t m0 xd h14 yb40 ff8 fs3 fc0 sc0 ls0 ws48">W<span class="_ _0"></span>e’<span class="_ _1"></span>ve disco<span class="_ _4"></span>vered a great deal about the wa<span class="_ _4"></span>y that </div><div class="t m5 xb2 h2f y410 ffb fs10 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 xa1 h14 y410 ff8 fs3 fc0 sc0 ls0 ws48">w<span class="_ _4"></span>orks, and w<span class="_ _4"></span>e’<span class="_ _4"></span>ve encoded that</div><div class="t m0 xd h14 y411 ff8 fs3 fc0 sc0 ls0 ws0">kno<span class="_ _4"></span>wledge into a set of simple unit tests.</div><div class="t m0 x74 h1c yb20 ff1 fs3 fc0 sc0 ls0 ws0">Listing 8-1 </div><div class="t m0 x74 h36 y414 ffc fs3 fc0 sc0 ls0 ws0">LogTest.java</div><div class="t m5 x74 h2f yb89 ffb fs10 fc0 sc0 ls0 ws0">public class LogTest {</div><div class="t m5 x74 h2f yb8a ffb fs10 fc0 sc0 ls0 ws0">    private Logger logger;</div><div class="t m5 x74 h2f yb8b ffb fs10 fc0 sc0 ls0 ws0">    @Before</div><div class="t m5 x74 h2f yb8c ffb fs10 fc0 sc0 ls0 ws0">    public void initialize() {</div><div class="t m5 x74 h2f yb8d ffb fs10 fc0 sc0 ls0 ws0">        logger = Logger.getLogger(&quot;logger&quot;);</div><div class="t m5 x74 h2f yb8e ffb fs10 fc0 sc0 ls0 ws0">        logger.removeAllAppenders();</div><div class="t m5 x74 h2f yb8f ffb fs10 fc0 sc0 ls0 ws0">        Logger.getRootLogger().removeAllAppenders();</div><div class="t m5 x74 h2f yb90 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yb91 ffb fs10 fc0 sc0 ls0 ws0">    @Test</div><div class="t m5 x74 h2f yb92 ffb fs10 fc0 sc0 ls0 ws0">    public void basicLogger() {</div><div class="t m5 x74 h2f yb93 ffb fs10 fc0 sc0 ls0 ws0">        BasicConfigurator.configure();</div><div class="t m5 x74 h2f yb94 ffb fs10 fc0 sc0 ls0 ws0">        logger.info(&quot;basicLogger&quot;);</div><div class="t m5 x74 h2f yb95 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yb96 ffb fs10 fc0 sc0 ls0 ws0">    @Test</div><div class="t m5 x74 h2f yb97 ffb fs10 fc0 sc0 ls0 ws0">    public void addAppenderWithStream() {</div><div class="t m5 x8a h2f yb98 ffb fs10 fc0 sc0 ls0 ws0">logger.addAppender(new ConsoleAppender(</div><div class="t m5 x86 h2f yb99 ffb fs10 fc0 sc0 ls0 ws0">new PatternLayout(&quot;%p %t %m%n&quot;),</div><div class="t m5 x86 h2f yb9a ffb fs10 fc0 sc0 ls0 ws0">ConsoleAppender.SYSTEM_OUT));</div><div class="t m5 x74 h2f yb9b ffb fs10 fc0 sc0 ls0 ws0">        logger.info(&quot;addAppenderWithStream&quot;);</div><div class="t m5 x74 h2f yb9c ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf95" class="pf w1 h2" data-page-no="95"><div class="pc pc95 w1 h2"><img class="bi xd yb9d wc h70" alt="" src="bg95.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">118<span class="_ _2b"> </span><span class="ff1 wsa0">Chapter 8:<span class="_ _4"></span> Boundaries</span></div><div class="t m0 x74 h14 ya27 ff8 fs3 fc0 sc0 ls0 ws3fa">No<span class="_ _4"></span>w w<span class="_ _4"></span>e kno<span class="_ _4"></span>w how to get a simple console lo<span class="_ _4"></span>gger initialized<span class="_ _1"></span>, and w<span class="_ _4"></span>e can encapsulate</div><div class="t m0 xd h14 ya28 ff8 fs3 fc0 sc0 ls0 ws53b">that kno<span class="_ _4"></span>wledge into our o<span class="_ _4"></span>wn logger class so that the rest of our application is isolated from</div><div class="t m0 xd h14 yb9e ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y252 ffb fs10 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 x3f h14 y252 ff8 fs3 fc0 sc0 ls0 ws0"> boundary interf<span class="_ _8"></span>ace. </div><div class="t m0 xd h17 yb9f ff1 fs9 fc0 sc0 ls0 ws4db">Learning T<span class="_ _2"></span>ests <span class="_ _4"></span>Ar<span class="_ _4"></span>e <span class="_ _6"></span>Better Than <span class="_ _6"></span>F<span class="_ _1"></span>r<span class="_ _4"></span>ee</div><div class="t m0 xd h14 ya2a ff8 fs3 fc0 sc0 ls0 ws53c">The learning tests end up costing nothing. W<span class="_ _0"></span>e had to learn the <span class="_ _4"></span>API anyw<span class="_ _1"></span>ay<span class="_ _0"></span>, and writing</div><div class="t m0 xd h14 y28 ff8 fs3 fc0 sc0 ls0 ws59">those tests w<span class="_ _4"></span>as an easy and isolated wa<span class="_ _4"></span>y to get that kno<span class="_ _4"></span>wledge. <span class="_ _4"></span>The learning tests were</div><div class="t m0 xd h14 ya2b ff8 fs3 fc0 sc0 ls0 ws0">precise experiments that helped increase our understanding.</div><div class="t m0 x74 h14 yba0 ff8 fs3 fc0 sc0 ls0 ws223">Not onl<span class="_ _4"></span>y are lear<span class="_ _8"></span>ning tests free, they ha<span class="_ _4"></span>ve a positi<span class="_ _4"></span>ve return on inv<span class="_ _4"></span>estment. <span class="_ _4"></span>When there</div><div class="t m0 xd h14 y803 ff8 fs3 fc0 sc0 ls0 ws340">are new releases of the third-party package, w<span class="_ _4"></span>e run the lear<span class="_ _8"></span>ning tests to see whether there</div><div class="t m0 xd h14 y804 ff8 fs3 fc0 sc0 ls0 ws0">are beha<span class="_ _4"></span>vioral differences. </div><div class="t m0 x74 h14 y330 ff8 fs3 fc0 sc0 ls0 ws53d">Learning tests verify that the third-party packages we are using w<span class="_ _1"></span>ork the wa<span class="_ _4"></span>y w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y331 ff8 fs3 fc0 sc0 ls0 ws1e2">expect them to. Once inte<span class="_ _4"></span>g<span class="_ _8"></span>rated<span class="_ _1"></span>, there are no guarantees that the third-par<span class="_ _8"></span>ty code will stay</div><div class="t m0 xd h14 yba1 ff8 fs3 fc0 sc0 ls0 wsd2">compatible with our needs. <span class="_ _1"></span>The original authors will ha<span class="_ _4"></span>ve pressures to change their code to</div><div class="t m0 xd h14 y35c ff8 fs3 fc0 sc0 lsd ws53e">meet new needs of their o<span class="_ _1"></span>wn. <span class="_ _4"></span>They will ﬁx bugs and add ne<span class="_ _4"></span>w capabilities. W<span class="_ _1"></span>ith each</div><div class="t m0 xd h14 y35d ff8 fs3 fc0 sc0 ls0 ws2a0">release comes ne<span class="_ _4"></span>w risk. If the third-par<span class="_ _8"></span>ty package changes in some wa<span class="_ _4"></span>y incompatible with</div><div class="t m0 xd h14 y35e ff8 fs3 fc0 sc0 ls0 ws0">our tests, w<span class="_ _4"></span>e will ﬁnd out right a<span class="_ _4"></span>wa<span class="_ _4"></span>y<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y8d0 ff8 fs3 fc0 sc0 ls0 ws53f">Whether you need the learning pro<span class="_ _4"></span>vided b<span class="_ _4"></span>y the lear<span class="_ _8"></span>ning tests or not, a clean boundar<span class="_ _8"></span>y</div><div class="t m0 xd h14 yba2 ff8 fs3 fc0 sc0 ls0 ws540">should be supported by a set of outbound tests that ex<span class="_ _1"></span>ercise the interf<span class="_ _8"></span>ace the same wa<span class="_ _1"></span>y the</div><div class="t m0 xd h14 yba3 ff8 fs3 fc0 sc0 ls0 ws541">production code does. <span class="_ _4"></span>W<span class="_ _4"></span>ithout these <span class="ffa">boundary tests </span>to ease the mig<span class="_ _8"></span>ration, w<span class="_ _4"></span>e might be</div><div class="t m0 xd h14 yba4 ff8 fs3 fc0 sc0 ls0 ws0">tempted to sta<span class="_ _4"></span>y with the old version longer than w<span class="_ _4"></span>e should. </div><div class="t m0 xd h17 yba5 ff1 fs9 fc0 sc0 ls0 ws0">Using Code <span class="_ _0"></span>That Does Not <span class="_ _2"></span>Y<span class="_ _3"></span>et Exist</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws3f3">There is another kind of boundary<span class="_ _1"></span>, one that separates the kno<span class="_ _4"></span>wn from the unkno<span class="_ _4"></span>wn. <span class="_ _4"></span>There</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws4c0">are often places in the code where our kno<span class="_ _1"></span>wledge seems to drop off the edge. Sometimes</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws1a8">what is on the other side of the boundary is unkno<span class="_ _4"></span>wab<span class="_ _4"></span>le (at least right no<span class="_ _4"></span>w). Sometimes</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e choose to look no far<span class="_ _8"></span>ther than the boundar<span class="_ _8"></span>y<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y5e7 ff8 fs3 fc0 sc0 ls12 ws3d8">A number of years back I w<span class="_ _4"></span>as part of a team developing softw<span class="_ _4"></span>are for a radio com-</div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls12 ws542">munications system. <span class="_ _1"></span>There was a subsystem, the “T<span class="_ _4"></span>ransmitter<span class="_ _4"></span>,<span class="_ _1"></span>” that we kne<span class="_ _4"></span>w little</div><div class="t m0 xd h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws2a5">about, and the people responsible for the subsystem had not gotten to the point of deﬁning</div><div class="t m0 xd h14 y557 ff8 fs3 fc0 sc0 ls12 ws75">their interface. W<span class="_ _2"></span>e did not want to be block<span class="_ _4"></span>ed<span class="_ _1"></span>, so we started our w<span class="_ _4"></span>ork far aw<span class="_ _4"></span>a<span class="_ _4"></span>y from the</div><div class="t m0 xd h14 yba6 ff8 fs3 fc0 sc0 ls12 ws0">unkno<span class="_ _4"></span>wn part of the code.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    @Test</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    public void addAppenderWithoutStream() {</div><div class="t m5 x8a h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">logger.addAppender(new ConsoleAppender(</div><div class="t m5 x86 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">new PatternLayout(&quot;%p %t %m%n&quot;)));</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">        logger.info(&quot;addAppenderWithoutStream&quot;);</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 8-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">LogTest.java</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:422.945010px;width:217.045000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:183.946010px;width:212.790000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf96" class="pf w1 h2" data-page-no="96"><div class="pc pc96 w1 h2"><img class="bi x37 yba7 w13 h71" alt="" src="bg96.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">119<span class="_ _10"></span><span class="ff1">Using Code <span class="_ _1"></span>That Does Not <span class="_ _0"></span>Y<span class="_ _2"></span>et Exist</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 lsc ws38c">W<span class="_ _0"></span>e had a pretty good idea of where our w<span class="_ _1"></span>orld ended and the new w<span class="_ _1"></span>orld began. <span class="_ _4"></span>As w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws543">w<span class="_ _4"></span>orked<span class="_ _1"></span>, w<span class="_ _4"></span>e sometimes bumped up against this boundar<span class="_ _8"></span>y<span class="_ _1"></span>. <span class="_ _1"></span>Though mists and clouds of</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws243">ignorance obscured our view be<span class="_ _4"></span>yond the boundary<span class="_ _0"></span>, our work made us a<span class="_ _1"></span>ware of w<span class="_ _4"></span>hat we</div><div class="t m0 xd h14 y197 ffa fs3 fc0 sc0 ls0 ws0">wanted<span class="ff8"> the boundary interface to be. W<span class="_ _0"></span>e w<span class="_ _4"></span>anted to tell the transmitter something like this:</span></div><div class="t m0 x74 h29 yba8 ffa fsf fc0 sc0 ls0 ws544">K<span class="_ _4"></span>ey the tr<span class="_ _4"></span>ansmitter on the pr<span class="_ _4"></span>ovided fr<span class="_ _1"></span>equency and emit an analog r<span class="_ _4"></span>epresentation of the</div><div class="t m0 x74 h29 yba9 ffa fsf fc0 sc0 ls0 ws0">data coming fr<span class="_ _4"></span>om this str<span class="_ _4"></span>eam. </div><div class="t m0 x74 h14 y5da ff8 fs3 fc0 sc0 ls0 ws15c">W<span class="_ _0"></span>e had no idea ho<span class="_ _4"></span>w that w<span class="_ _4"></span>ould be done because the <span class="_ _4"></span>API had not been designed yet.</div><div class="t m0 xd h14 y5db ff8 fs3 fc0 sc0 ls0 ws0">So w<span class="_ _4"></span>e decided to w<span class="_ _4"></span>ork out the details later<span class="_ _4"></span>.</div><div class="t m0 x74 h14 y863 ff8 fs3 fc0 sc0 ls0 ws2d4">T<span class="_ _0"></span>o keep from being blocked<span class="_ _0"></span>, we deﬁned our o<span class="_ _1"></span>wn interf<span class="_ _8"></span>ace. W<span class="_ _2"></span>e called it something</div><div class="t m0 xd h14 y5b9 ff8 fs3 fc0 sc0 ls0 ws37f">catch<span class="_ _4"></span>y<span class="_ _1"></span>, like </div><div class="t m5 x4c h2f y5b9 ffb fs10 fc0 sc0 ls0 ws0">Transmitter</div><div class="t m0 x9e h14 y5b9 ff8 fs3 fc0 sc0 ls49 ws51f">. <span class="_ _4"></span>W<span class="_ _0"></span>e gav<span class="_ _4"></span>e it a method called </div><div class="t m5 x96 h2f y5b9 ffb fs10 fc0 sc0 ls0 ws0">transmit</div><div class="t m0 xca h14 y5b9 ff8 fs3 fc0 sc0 ls0 ws37f">that took a frequency and a</div><div class="t m0 xd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws0">data stream. <span class="_ _1"></span>This was the interface w<span class="_ _4"></span>e <span class="ffa">wished</span> we had. </div><div class="t m0 x74 h14 y446 ff8 fs3 fc0 sc0 ls12 wsd1">One good thing about writing the interface w<span class="_ _4"></span>e wish we had is that it’<span class="_ _3"></span>s under our</div><div class="t m0 xd h14 ybaa ff8 fs3 fc0 sc0 ls12 ws8e">control. <span class="_ _1"></span>This helps keep client code more readable and focused on w<span class="_ _4"></span>hat it is tr<span class="_ _8"></span>ying to</div><div class="t m0 xd h14 ybab ff8 fs3 fc0 sc0 ls12 ws0">accomplish.</div><div class="t m0 x74 h14 ybac ff8 fs3 fc0 sc0 ls0 ws545">In Figure 8-2, y<span class="_ _4"></span>ou can see that w<span class="_ _4"></span>e insulated the </div><div class="t m5 x85 h2f y3a0 ffb fs10 fc0 sc0 ls0 ws0">CommunicationsController</div><div class="t m0 xe6 h14 y3a0 ff8 fs3 fc0 sc0 ls0 ws0">classes</div><div class="t m0 xd h14 y3a1 ff8 fs3 fc0 sc0 ls0 ws224">from the transmitter <span class="_ _1"></span>API (which w<span class="_ _4"></span>as out of our control and undeﬁned). By using our own</div><div class="t m0 xd h14 y3a2 ff8 fs3 fc0 sc0 ls0 ws546">application speciﬁc interface, we k<span class="_ _4"></span>ept our </div><div class="t m5 x66 h2f y3a2 ffb fs10 fc0 sc0 ls0 ws0">CommunicationsController</div><div class="t m0 xa7 h14 y3a2 ff8 fs3 fc0 sc0 ls0 ws546">code clean and</div><div class="t m0 xd h14 y3a3 ff8 fs3 fc0 sc0 ls0 ws547">expressi<span class="_ _4"></span>ve. Once the transmitter <span class="_ _1"></span>API was deﬁned<span class="_ _0"></span>, we wrote the </div><div class="t m5 x82 h2f y3a3 ffb fs10 fc0 sc0 ls0 ws0">TransmitterAdapter</div><div class="t m0 x1d h14 y3a3 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m0 xd h14 y3a4 ff8 fs3 fc0 sc0 ls22 ws548">bridge the gap. <span class="_ _1"></span>The A<span class="fsb ls0 ws0">DAPTER</span></div><div class="t m0 x8f h21 y569 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xa2 h14 y3a4 ff8 fs3 fc0 sc0 ls0 wsa6">encapsulated the interaction with the <span class="_ _1"></span>API and pro<span class="_ _4"></span>vides a</div><div class="t m0 xd h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws0">single place to change when the <span class="_ _1"></span>API e<span class="_ _4"></span>volves.</div><div class="t m0 xe9 h1c ybad ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 8-2</div><div class="t m0 x1c h14 ybae ff8 fs3 fc0 sc0 ls0 ws0">Predicting the transmitter</div><div class="t m0 x74 h14 ybaf ff8 fs3 fc0 sc0 ls16 ws549">This design also giv<span class="_ _4"></span>es us a very con<span class="_ _4"></span>venient seam</div><div class="t m0 xe3 h21 ybb0 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xdb h14 ybb1 ff8 fs3 fc0 sc0 ls16 ws549">in the code for testing. Using a</div><div class="t m0 xd h14 ybb2 ff8 fs3 fc0 sc0 ls16 ws0">suitable </div><div class="t m5 x9a h2f ybb2 ffb fs10 fc0 sc0 ls31 ws0">FakeTransmitter</div><div class="t m0 xa h14 ybb2 ff8 fs3 fc0 sc0 ls16 ws524">, w<span class="_ _4"></span>e can test the </div><div class="t m5 xb8 h2f ybb2 ffb fs10 fc0 sc0 ls31 ws0">CommunicationsController</div><div class="t m0 xeb h14 ybb2 ff8 fs3 fc0 sc0 ls16 ws524">classes. <span class="_ _4"></span>W<span class="_ _0"></span>e can also</div><div class="t m0 xd h14 ybb3 ff8 fs3 fc0 sc0 ls16 ws1d7">create boundary tests once we ha<span class="_ _1"></span>ve the </div><div class="t m5 x4e h2f ybb3 ffb fs10 fc0 sc0 ls31 ws0">TransmitterAPI</div><div class="t m0 x89 h14 ybb3 ff8 fs3 fc0 sc0 ls16 ws1d7">that make sure w<span class="_ _4"></span>e are using the</div><div class="t m0 xd h14 ybb4 ff8 fs3 fc0 sc0 ls16 ws0">API cor<span class="_ _8"></span>rectly<span class="_ _0"></span>.</div><div class="t m0 xd h25 ybb5 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>See the <span class="_ _1"></span>Adapter patter<span class="_ _8"></span>n in [GOF].</div><div class="t m0 xd h25 ybb6 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>See more about seams in [WELC].</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf97" class="pf w1 h2" data-page-no="97"><div class="pc pc97 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">120<span class="_ _2b"> </span><span class="ff1 wsa0">Chapter 8:<span class="_ _4"></span> Boundaries</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Clean Boundaries</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws54a">Interesting things happen at boundaries. Change is one of those things. Good software</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws54b">designs accommodate change without huge in<span class="_ _4"></span>vestments and re<span class="_ _4"></span>w<span class="_ _4"></span>ork. When w<span class="_ _1"></span>e use code</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws272">that is out of our control, special care must be taken to protect our in<span class="_ _1"></span>vestment and make</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws0">sure future change is not too costl<span class="_ _4"></span>y<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y461 ff8 fs3 fc0 sc0 ls0 ws62">Code at the boundaries needs clear separation and tests that deﬁne expectations. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws3e">should a<span class="_ _4"></span>void letting too much of our code kno<span class="_ _1"></span>w about the third-par<span class="_ _8"></span>ty par<span class="_ _8"></span>ticulars. It’<span class="_ _2"></span>s better</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls0 ws54c">to depend on something <span class="ffa ws0">you<span class="_ _16"> </span></span>control than on something you don’<span class="_ _1"></span>t control, lest it end up</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws0">controlling you. </div><div class="t m0 x74 h14 y252 ff8 fs3 fc0 sc0 ls0 ws150">W<span class="_ _0"></span>e manage third-party boundaries by ha<span class="_ _4"></span>ving very few places in the code that refer to</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws214">them. <span class="_ _4"></span>W<span class="_ _0"></span>e may wrap them as w<span class="_ _1"></span>e did with </div><div class="t m5 x44 h2f ybb7 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x67 h14 ybb7 ff8 fs3 fc0 sc0 ls0 ws214">, or w<span class="_ _4"></span>e ma<span class="_ _4"></span>y use an A<span class="fsb ws0">DAPTER<span class="_ _a"> </span></span>to conv<span class="_ _4"></span>er<span class="_ _8"></span>t from</div><div class="t m0 xd h14 ybb8 ff8 fs3 fc0 sc0 ls0 ws54d">our perfect interface to the pro<span class="_ _4"></span>vided interface. Either wa<span class="_ _4"></span>y our code speaks to us better<span class="_ _4"></span>,</div><div class="t m0 xd h14 ybb9 ff8 fs3 fc0 sc0 ls0 ws54e">promotes internally consistent usage across the boundary<span class="_ _1"></span>, and has few<span class="_ _1"></span>er maintenance</div><div class="t m0 xd h14 ybba ff8 fs3 fc0 sc0 ls0 ws0">points when the third-party code changes. </div><div class="t m0 xd h17 y478 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y410 ff1 fs3 fc0 sc0 ls0 wsa0">[BeckTDD]:<span class="_ _4"></span>  <span class="ffa ws0">T<span class="_ _0"></span>est Driven Development,<span class="ff8"> Kent Beck, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2003.</span></span></div><div class="t m0 xd h14 y412 ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa ws422">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e, <span class="ff8">Gamma et <span class="_ _4"></span>al.,</span></span></div><div class="t m0 xd h14 y413 ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><div class="t m0 xd h14 y42a ff1 fs3 fc0 sc0 ls0 wsa0">[WELC]:<span class="_ _4"></span>  <span class="ffa ws0">W<span class="_ _0"></span>or<span class="_ _4"></span>king Eff<span class="_ _4"></span>ectively with Leg<span class="_ _4"></span>acy Code,<span class="_ _b"> </span><span class="ff8">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2004.</span></span></div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:580.945010px;width:106.959000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:374.945010px;width:77.392000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf98" class="pf w1 h2" data-page-no="98"><div class="pc pc98 w1 h2"><img class="bi xd ybbb w4 h72" alt="" src="bg98.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">121</div><div class="t m0 x36 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">9</div><div class="t m0 xa3 h3 y24d ff1 fs0 fc0 sc0 ls0 ws54f">Unit T<span class="_ _2c"></span>ests</div><div class="t m0 xd h14 ybbc ff8 fs3 fc0 sc0 ls12 ws535">Our profession has come a long w<span class="_ _4"></span>ay in the last ten y<span class="_ _4"></span>ears. In 1997 no one had heard of</div><div class="t m0 xd h14 ybbd ff8 fs3 fc0 sc0 ls12 wsf8">T<span class="_ _0"></span>est Driv<span class="_ _4"></span>en Dev<span class="_ _4"></span>elopment. F<span class="_ _4"></span>or the vast majority of us, unit tests w<span class="_ _1"></span>ere shor<span class="_ _8"></span>t bits of thro<span class="_ _4"></span>w-</div><div class="t m0 xd h14 ybbe ff8 fs3 fc0 sc0 ls12 wsdb">a<span class="_ _4"></span>wa<span class="_ _1"></span>y code that we wrote to mak<span class="_ _4"></span>e sure our programs “w<span class="_ _4"></span>orked.<span class="_ _1"></span>” W<span class="_ _2"></span>e would painstakingl<span class="_ _4"></span>y</div><div class="t m0 xd h14 ybbf ff8 fs3 fc0 sc0 ls12 ws550">write our classes and methods, and then w<span class="_ _4"></span>e w<span class="_ _4"></span>ould concoct some ad hoc code to test</div><div class="t m0 xd h14 ybc0 ff8 fs3 fc0 sc0 ls12 ws1a5">them. <span class="_ _1"></span>T<span class="_ _0"></span>ypically this w<span class="_ _1"></span>ould in<span class="_ _4"></span>volve some kind of simple dri<span class="_ _4"></span>ver pro<span class="_ _4"></span>g<span class="_ _8"></span>ram that w<span class="_ _4"></span>ould allo<span class="_ _4"></span>w</div><div class="t m0 xd h14 ybc1 ff8 fs3 fc0 sc0 ls12 ws0">us to manuall<span class="_ _4"></span>y interact with the program we had written.</div><div class="t m0 x74 h14 ybc2 ff8 fs3 fc0 sc0 ls0 ws445">I remember writing a C++ pro<span class="_ _4"></span>g<span class="_ _8"></span>ram for an embedded real-time system back in the</div><div class="t m0 xd h14 ybc3 ff8 fs3 fc0 sc0 ls0 ws0">mid-90s. <span class="_ _1"></span>The program was a simple timer with the follo<span class="_ _4"></span>wing signature:</div><div class="t m5 x74 h2f ybc4 ffb fs10 fc0 sc0 ls0 ws0">void Timer::ScheduleCommand(Command* theCommand, int milliseconds) </div><div class="t m0 x74 h14 ybc5 ff8 fs3 fc0 sc0 ls0 ws551">The idea w<span class="_ _4"></span>as simple; the </div><div class="t m5 x8f h2f ybc5 ffb fs10 fc0 sc0 ls0 ws0">execute</div><div class="t m0 x31 h14 ybc5 ff8 fs3 fc0 sc0 ls0 ws551">method of the </div><div class="t m5 x2a h2f ybc5 ffb fs10 fc0 sc0 ls0 ws0">Command</div><div class="t m0 xe8 h14 ybc5 ff8 fs3 fc0 sc0 ls0 ws551">w<span class="_ _4"></span>ould be ex<span class="_ _4"></span>ecuted in a new</div><div class="t m0 xd h14 ybc6 ff8 fs3 fc0 sc0 ls0 ws0">thread after the speciﬁed number of milliseconds. <span class="_ _1"></span>The problem was, ho<span class="_ _1"></span>w to test it.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:337.895000px;bottom:440.027010px;width:101.024000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf99" class="pf w1 h2" data-page-no="99"><div class="pc pc99 w1 h2"><img class="bi x37 ybc7 w8 h27" alt="" src="bg99.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">122<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws2e8">I cobbled to<span class="_ _4"></span>gether a simple dri<span class="_ _4"></span>ver program that listened to the ke<span class="_ _4"></span>yboard. Every time a</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws223">character w<span class="_ _4"></span>as typed<span class="_ _4"></span>, it w<span class="_ _4"></span>ould schedule a command that w<span class="_ _4"></span>ould type the same character ﬁve</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws442">seconds later<span class="_ _1"></span>. <span class="_ _4"></span>Then I tapped out a rhythmic melody on the k<span class="_ _4"></span>eyboard and waited for that</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">melody to repla<span class="_ _4"></span>y on the screen ﬁve seconds later<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws3d7">“I . . . w<span class="_ _4"></span>ant-a-girl . . . just . . . like-the-girl-who-marr . . . ied . . . dear . . . old . . . dad.<span class="_ _1"></span>”</div><div class="t m0 x74 h14 y41c ff8 fs3 fc0 sc0 lsc ws552">I actuall<span class="_ _4"></span>y sang that melody while typing the “.<span class="_ _1"></span>” key<span class="_ _0"></span>, and then I sang it again as the</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws0">dots appeared on the screen.</div><div class="t m0 x74 h14 y408 ff8 fs3 fc0 sc0 ls0 ws51">That w<span class="_ _4"></span>as my test! Once I sa<span class="_ _1"></span>w it w<span class="_ _4"></span>ork and demonstrated it to my colleagues, I thre<span class="_ _4"></span>w</div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws0">the test code a<span class="_ _4"></span>wa<span class="_ _1"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y1de ff8 fs3 fc0 sc0 ls59 ws3a5">As I said<span class="_ _1"></span>, our profession has come a long wa<span class="_ _4"></span>y<span class="_ _0"></span>. No<span class="_ _4"></span>wada<span class="_ _4"></span>ys I w<span class="_ _4"></span>ould write a test that made</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls59 ws206">sure that e<span class="_ _4"></span>very nook and cranny of that code w<span class="_ _4"></span>orked as I expected it to. I w<span class="_ _1"></span>ould isolate m<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls59 ws553">code from the operating system rather than just calling the standard timing functions. I</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls59 ws2e7">w<span class="_ _4"></span>ould mock out those timing functions so that I had absolute control o<span class="_ _4"></span>ver the time. I w<span class="_ _1"></span>ould</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls59 ws30">schedule commands that set boolean ﬂags, and then I w<span class="_ _4"></span>ould step the time forward<span class="_ _0"></span>, watching</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls59 ws554">those ﬂags and ensuring that they w<span class="_ _1"></span>ent from f<span class="_ _8"></span>alse to tr<span class="_ _8"></span>ue just as I changed the time to the</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls59 ws0">right value.</div><div class="t m0 x74 h14 y1c1 ff8 fs3 fc0 sc0 ls0 ws2da">Once I got a suite of tests to pass, I w<span class="_ _4"></span>ould make sure that those tests w<span class="_ _4"></span>ere con<span class="_ _4"></span>venient</div><div class="t m0 xd h14 y1c2 ff8 fs3 fc0 sc0 ls0 wsef">to run for anyone else w<span class="_ _4"></span>ho needed to w<span class="_ _4"></span>ork with the code. I w<span class="_ _4"></span>ould ensure that the tests and</div><div class="t m0 xd h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws0">the code w<span class="_ _4"></span>ere checked in to<span class="_ _4"></span>gether into the same source package.</div><div class="t m0 x74 h14 ybc8 ff8 fs3 fc0 sc0 ls4a wse3">Y<span class="_ _3"></span>es, we’<span class="_ _1"></span>ve come a long w<span class="_ _4"></span>a<span class="_ _4"></span>y; but we ha<span class="_ _1"></span>ve far<span class="_ _8"></span>ther to go. <span class="_ _4"></span>The Agile and TDD mo<span class="_ _4"></span>ve-</div><div class="t m0 xd h14 y1c5 ff8 fs3 fc0 sc0 ls4b ws148">ments ha<span class="_ _4"></span>ve encouraged man<span class="_ _4"></span>y programmers to write automated unit tests, and more are</div><div class="t m0 xd h14 y1c6 ff8 fs3 fc0 sc0 ls4b ws193">joining their ranks e<span class="_ _4"></span>very day<span class="_ _0"></span>. But in the mad r<span class="_ _8"></span>ush to add testing to our discipline, man<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1c7 ff8 fs3 fc0 sc0 ls4b ws555">programmers ha<span class="_ _4"></span>ve missed some of the more subtle, and important, points of writing</div><div class="t m0 xd h14 y1c8 ff8 fs3 fc0 sc0 ls4b ws0">good tests.</div><div class="t m0 xd h17 ybc9 ff1 fs9 fc0 sc0 ls0 ws0">The <span class="_ _0"></span>Three La<span class="_ _0"></span>ws of <span class="_ _d"></span>TDD</div><div class="t m0 xd h14 y312 ff8 fs3 fc0 sc0 ls0 ws391">By no<span class="_ _4"></span>w ev<span class="_ _4"></span>er<span class="_ _8"></span>yone kno<span class="_ _1"></span>ws that <span class="_ _4"></span>TDD asks us to write unit tests ﬁrst, before w<span class="_ _4"></span>e write produc-</div><div class="t m0 xd h14 y313 ff8 fs3 fc0 sc0 ls0 ws0">tion code. But that rule is just the tip of the iceberg. Consider the follo<span class="_ _4"></span>wing three la<span class="_ _4"></span>ws:</div><div class="t m0 x8c h21 y2f8 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 xd hd y315 ffe fs3 fc0 sc0 ls0 ws0">First Law <span class="ff8">Y<span class="_ _3"></span>ou ma<span class="_ _4"></span>y not write production code until you ha<span class="_ _1"></span>ve written a failing unit test.</span></div><div class="t m0 xd hd y22b ffe fs3 fc0 sc0 ls0 ws0">Second Law <span class="ff8 ws202">Y<span class="_ _3"></span>ou ma<span class="_ _4"></span>y not write more of a unit test than is sufﬁcient to fail, and not com-</span></div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws0">piling is failing.</div><div class="t m0 xd hd y37e ffe fs3 fc0 sc0 ls0 ws0">Third Law <span class="ff8 ws3c4">Y<span class="_ _3"></span>ou ma<span class="_ _4"></span>y not write more production code than is sufﬁcient to pass the cur<span class="_ _4"></span>-</span></div><div class="t m0 xd h14 ybca ff8 fs3 fc0 sc0 ls0 ws0">rently failing test. </div><div class="t m0 xd h25 ybcb ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span><span class="ffa">Pr<span class="_ _1"></span>ofessionalism and <span class="_ _4"></span>T<span class="_ _1"></span>est-Driven Development<span class="ff8">, Robert C. Martin, Object Mentor, IEEE Softw<span class="_ _4"></span>are, May/June 2007 (V<span class="_ _0"></span>ol. 24, </span></span></div><div class="t m0 x3b h25 ybcc ff8 fse fc0 sc0 ls0 ws0">No. 3)   pp. 32–36</div><div class="t m0 x3b h25 ybcd ff8 fse fc0 sc0 ls0 ws0">http://doi.ieeecomputersociety<span class="_ _1"></span>.org/10.1109/MS.2007.85 </div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:256.944010px;width:145.430000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://doi.ieeecomputersociety.org/10.1109/MS.2007.85"><div class="d m1" style="border-style:none;position:absolute;left:90.825100px;bottom:76.247710px;width:156.582900px;height:7.657900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9a" class="pf w1 h2" data-page-no="9a"><div class="pc pc9a w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">123<span class="_ _10"></span><span class="ff1 wse1">Keeping T<span class="_ _2"></span>ests <span class="_ _6"></span>Clean</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws556">These three la<span class="_ _4"></span>ws lock you into a c<span class="_ _4"></span>ycle that is perhaps thir<span class="_ _8"></span>ty seconds long. <span class="_ _4"></span>The tests</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws36f">and the production code are written <span class="ffa ws0">to<span class="_ _4"></span>gether<span class="_ _0"></span>,<span class="ff8 ls22 ws56"> with the tests just a fe<span class="_ _4"></span>w seconds ahead of the</span></span></div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">production code.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 wsbe">If w<span class="_ _4"></span>e w<span class="_ _4"></span>ork this wa<span class="_ _4"></span>y<span class="_ _0"></span>, we will write dozens of tests e<span class="_ _4"></span>very da<span class="_ _4"></span>y<span class="_ _1"></span>, hundreds of tests e<span class="_ _4"></span>very</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws557">month, and thousands of tests ev<span class="_ _4"></span>ery year<span class="_ _1"></span>. If we w<span class="_ _1"></span>ork this wa<span class="_ _4"></span>y<span class="_ _0"></span>, those tests will cov<span class="_ _4"></span>er vir<span class="_ _8"></span>tu-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 lsd ws43e">ally all of our production code. <span class="_ _1"></span>The sheer bulk of those tests, which can ri<span class="_ _4"></span>v<span class="_ _4"></span>al the size of the</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">production code itself, can present a daunting management problem.</div><div class="t m0 xd h17 y4dc ff1 fs9 fc0 sc0 ls0 ws0">K<span class="_ _4"></span>eeping T<span class="_ _2"></span>ests Clean</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws558">Some years back I w<span class="_ _4"></span>as asked to coach a team w<span class="_ _4"></span>ho had explicitl<span class="_ _4"></span>y decided that their test</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">code<span class="_ _18"> </span><span class="ffa ws2ed">should not <span class="ff8">be maintained to the same standards of quality as their production code.</span></span></div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 lsc ws559">They ga<span class="_ _1"></span>ve each other license to break the r<span class="_ _8"></span>ules in their unit tests. “Quick and dirty” was</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws55a">the watchw<span class="_ _1"></span>ord. <span class="_ _4"></span>Their variab<span class="_ _4"></span>les did not ha<span class="_ _4"></span>ve to be w<span class="_ _4"></span>ell named<span class="_ _1"></span>, their test functions did not</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls0 ws55b">need to be short and descriptive. <span class="_ _1"></span>Their test code did not need to be w<span class="_ _4"></span>ell designed and</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws1e9">thoughtfull<span class="_ _4"></span>y par<span class="_ _8"></span>titioned. So long as the test code w<span class="_ _4"></span>orked<span class="_ _1"></span>, and so long as it cov<span class="_ _4"></span>ered the pro-</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">duction code, it w<span class="_ _4"></span>as good enough.</div><div class="t m0 x74 h14 y4e2 ff8 fs3 fc0 sc0 ls16 ws55c">Some of you reading this might sympathize with that decision. P<span class="_ _1"></span>erhaps, long in the</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 ls16 ws365">past, you wrote tests of the kind that I wrote for that </div><div class="t m5 xe3 h2f y486 ffb fs10 fc0 sc0 ls31 ws0">Timer</div><div class="t m0 x62 h14 y486 ff8 fs3 fc0 sc0 ls16 ws365">class. It’<span class="_ _2"></span>s a huge step from</div><div class="t m0 xd h14 y487 ff8 fs3 fc0 sc0 ls16 ws2b0">writing that kind of thro<span class="_ _4"></span>w-a<span class="_ _4"></span>wa<span class="_ _1"></span>y test, to writing a suite of automated unit tests. So, like the</div><div class="t m0 xd h14 y488 ff8 fs3 fc0 sc0 ls16 ws5d">team I was coaching, y<span class="_ _4"></span>ou might decide that ha<span class="_ _4"></span>ving dir<span class="_ _8"></span>ty tests is better than ha<span class="_ _4"></span>ving no</div><div class="t m0 xd h14 y489 ff8 fs3 fc0 sc0 ls16 ws0">tests.</div><div class="t m0 x74 h14 y48a ff8 fs3 fc0 sc0 ls0 ws30c">What this team did not realize w<span class="_ _4"></span>as that having dirty tests is equiv<span class="_ _4"></span>alent to, if not w<span class="_ _4"></span>orse</div><div class="t m0 xd h14 y5b2 ff8 fs3 fc0 sc0 ls0 ws55d">than, ha<span class="_ _4"></span>ving no tests. <span class="_ _4"></span>The problem is that tests must change as the production code</div><div class="t m0 xd h14 y5b3 ff8 fs3 fc0 sc0 ls0 ws4c">ev<span class="_ _4"></span>olves. <span class="_ _1"></span>The dir<span class="_ _8"></span>tier the tests, the harder they are to change. <span class="_ _1"></span>The more tangled the test code,</div><div class="t m0 xd h14 y53d ff8 fs3 fc0 sc0 ls0 ws94">the more likel<span class="_ _4"></span>y it is that you will spend more time cramming ne<span class="_ _4"></span>w tests into the suite than it</div><div class="t m0 xd h14 y53e ff8 fs3 fc0 sc0 ls0 ws226">takes to write the ne<span class="_ _4"></span>w production code. <span class="_ _4"></span>As you modify the production code, old tests start</div><div class="t m0 xd h14 y53f ff8 fs3 fc0 sc0 lsc ws68">to fail, and the mess in the test code makes it hard to get those tests to pass again. So the</div><div class="t m0 xd h14 y540 ff8 fs3 fc0 sc0 ls0 ws0">tests become view<span class="_ _1"></span>ed as an ev<span class="_ _4"></span>er-increasing liability<span class="_ _0"></span>.</div><div class="t m0 x74 h14 ybce ff8 fs3 fc0 sc0 ls0 ws55e">From release to release the cost of maintaining m<span class="_ _1"></span>y team’<span class="_ _2"></span>s test suite rose. Eventually it</div><div class="t m0 xd h14 ybcf ff8 fs3 fc0 sc0 ls0 ws371">became the single biggest complaint among the dev<span class="_ _4"></span>elopers. <span class="_ _4"></span>When managers asked wh<span class="_ _4"></span>y</div><div class="t m0 xd h14 ybd0 ff8 fs3 fc0 sc0 ls0 ws43f">their estimates w<span class="_ _4"></span>ere getting so large, the de<span class="_ _4"></span>velopers b<span class="_ _4"></span>lamed the tests. In the end they w<span class="_ _4"></span>ere</div><div class="t m0 xd h14 y3e3 ff8 fs3 fc0 sc0 ls0 ws0">forced to discard the test suite entirel<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y585 ff8 fs3 fc0 sc0 ls0 ws4ef">But, without a test suite they lost the ability to mak<span class="_ _4"></span>e sure that changes to their code</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 ws55f">base w<span class="_ _4"></span>orked as expected. <span class="_ _1"></span>Without a test suite the<span class="_ _4"></span>y could not ensure that changes to one</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 lsc ws29c">part of their system did not break other par<span class="_ _8"></span>ts of their system. So their defect rate began to</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws2c6">rise. <span class="_ _1"></span>As the number of unintended defects rose, they started to fear making changes. <span class="_ _4"></span>They</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws560">stopped cleaning their production code because they feared the changes w<span class="_ _1"></span>ould do more</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 lsc ws2cc">harm than good. <span class="_ _4"></span>Their production code began to rot. In the end they w<span class="_ _1"></span>ere left with no tests,</div><div class="t m0 xd h14 ya00 ff8 fs3 fc0 sc0 lsd ws462">tangled and bug-riddled production code, frustrated customers, and the feeling that their</div><div class="t m0 xd h14 y3cc ff8 fs3 fc0 sc0 ls0 ws0">testing effort had failed them. </div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:475.945010px;width:121.257000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9b" class="pf w1 h2" data-page-no="9b"><div class="pc pc9b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">124<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws89">In a w<span class="_ _4"></span>ay the<span class="_ _4"></span>y were right. <span class="_ _1"></span>Their testing effort <span class="ffa ws0">had </span>failed them. But it w<span class="_ _4"></span>as their decision</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 wsb4">to allo<span class="_ _4"></span>w the tests to be messy that was the seed of that failure. Had the<span class="_ _4"></span>y kept their tests</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws7e">clean, their testing ef<span class="_ _4"></span>for<span class="_ _8"></span>t w<span class="_ _4"></span>ould not hav<span class="_ _4"></span>e failed. I can say this with some certainty because</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws44d">I ha<span class="_ _4"></span>ve participated in, and coached<span class="_ _4"></span>, man<span class="_ _4"></span>y teams who ha<span class="_ _4"></span>ve been successful with <span class="ffa ws0">c<span class="_ _4"></span>lean <span class="ff8">unit</span></span></div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">tests.</div><div class="t m0 x74 h14 y1be ff8 fs3 fc0 sc0 ls0 ws61">The moral of the story is simple: <span class="_ _4"></span><span class="ffa">T<span class="_ _0"></span>est code is just as important as pr<span class="_ _4"></span>oduction code. <span class="ff8 ws0">It</span></span></div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws1ad">is not a second-class citizen. It requires thought, design, and care. It must be kept as clean</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">as production code. </div><div class="t m0 xd h11 ybd1 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>ests Enab<span class="_ _4"></span>le the -ilities</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws17f">If you don’<span class="_ _1"></span>t keep y<span class="_ _4"></span>our tests clean, you will lose them. <span class="_ _1"></span>And without them, you lose the very</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws25">thing that keeps y<span class="_ _4"></span>our production code ﬂexible. <span class="_ _0"></span>Y<span class="_ _3"></span>es, you read that correctly<span class="_ _0"></span>. It is <span class="ffa">unit tests</span></div><div class="t m0 xd h14 y6ce ff8 fs3 fc0 sc0 ls0 ws561">that keep our code ﬂe<span class="_ _4"></span>xible, maintainable, and reusab<span class="_ _4"></span>le. <span class="_ _4"></span>The reason is simple. If you ha<span class="_ _1"></span>ve</div><div class="t m0 xd h14 y6cf ff8 fs3 fc0 sc0 ls0 ws2cf">tests, you do not fear making changes to the code! <span class="_ _1"></span>Without tests e<span class="_ _4"></span>very change is a possible</div><div class="t m0 xd h14 y9a0 ff8 fs3 fc0 sc0 lsd ws562">bug. No matter ho<span class="_ _4"></span>w ﬂexib<span class="_ _4"></span>le your architecture is, no matter ho<span class="_ _4"></span>w nicel<span class="_ _4"></span>y par<span class="_ _8"></span>titioned your</div><div class="t m0 xd h14 ybac ff8 fs3 fc0 sc0 ls0 ws5e">design, without tests you will be reluctant to mak<span class="_ _4"></span>e changes because of the fear that you</div><div class="t m0 xd h14 ybd2 ff8 fs3 fc0 sc0 ls11 ws168">will introduce undetected bugs.</div><div class="t m0 x74 h14 y9a2 ff8 fs3 fc0 sc0 ls0 ws0">But<span class="_ _16"> </span><span class="ffa">with<span class="_ _15"> </span></span><span class="wsd9">tests that fear virtually disappears. <span class="_ _1"></span>The higher your test co<span class="_ _1"></span>verage, the less</span></div><div class="t m0 xd h14 y900 ff8 fs3 fc0 sc0 ls0 ws549">your fear<span class="_ _1"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can make changes with near impunity to code that has a less than stellar</div><div class="t m0 xd h14 y9a3 ff8 fs3 fc0 sc0 ls0 ws563">architecture and a tangled and opaque design. Indeed<span class="_ _1"></span>, you can <span class="ffa ws0">impr<span class="_ _1"></span>ove<span class="_ _16"> </span><span class="ff8 ws563">that architecture</span></span></div><div class="t m0 xd h14 ybd3 ff8 fs3 fc0 sc0 ls0 ws0">and design without fear!</div><div class="t m0 x74 h14 ybd4 ff8 fs3 fc0 sc0 ls0 ws564">So ha<span class="_ _4"></span>ving an automated suite of unit tests that co<span class="_ _4"></span>ver the production code is the ke<span class="_ _4"></span>y to</div><div class="t m0 xd h14 ybd5 ff8 fs3 fc0 sc0 ls0 ws565">keeping y<span class="_ _4"></span>our design and architecture as clean as possible. <span class="_ _1"></span>T<span class="_ _0"></span>ests enable all the -ilities,</div><div class="t m0 xd h14 ybd6 ff8 fs3 fc0 sc0 ls0 ws0">because tests enable <span class="ffa">c<span class="_ _4"></span>hange<span class="ff8">.</span></span></div><div class="t m0 x74 h14 yacc ff8 fs3 fc0 sc0 ls0 ws40b">So if your tests are dirty<span class="_ _0"></span>, then your ability to change your code is hampered<span class="_ _0"></span>, and you</div><div class="t m0 xd h14 ybd7 ff8 fs3 fc0 sc0 ls0 wsa8">begin to lose the ability to impro<span class="_ _1"></span>ve the structure of that code. <span class="_ _4"></span>The dir<span class="_ _8"></span>tier your tests, the</div><div class="t m0 xd h14 ybd8 ff8 fs3 fc0 sc0 ls0 ws0">dirtier your code becomes. Eventuall<span class="_ _4"></span>y you lose the tests, and y<span class="_ _4"></span>our code rots.</div><div class="t m0 xd h17 ybd9 ff1 fs9 fc0 sc0 ls0 ws4db">Clean T<span class="_ _2"></span>ests</div><div class="t m0 xd h14 yb77 ff8 fs3 fc0 sc0 ls34 ws3eb">What makes a clean test? <span class="_ _1"></span>Three things. Readability<span class="_ _1"></span>, readability<span class="_ _0"></span>, and readability<span class="_ _1"></span>. Read-</div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 ls34 wsc8">ability is perhaps e<span class="_ _4"></span>ven more important in unit tests than it is in production code. What</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 ls34 ws225">makes tests readab<span class="_ _4"></span>le? <span class="_ _4"></span>The same thing that makes all code readable: clarity<span class="_ _0"></span>, simplicity<span class="_ _0"></span>,</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls34 ws6e">and density of expression. In a test y<span class="_ _4"></span>ou want to sa<span class="_ _1"></span>y a lot with as few expressions as</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls34 ws0">possible. </div><div class="t m0 x74 h14 yb78 ff8 fs3 fc0 sc0 ls0 ws566">Consider the code from FitNesse in Listing 9-1. <span class="_ _1"></span>These three tests are difﬁcult to</div><div class="t m0 xd h14 yb79 ff8 fs3 fc0 sc0 ls0 ws28a">understand and can certainly be impro<span class="_ _1"></span>ved. First, there is a terrible amount of duplicate</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls0 ws2f">code [G5] in the repeated calls to </div><div class="t m5 x77 h2f y60d ffb fs10 fc0 sc0 ls0 ws0">addPage</div><div class="t m0 x67 h14 y60d ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x34 h2f y60d ffb fs10 fc0 sc0 ls0 ws0">assertSubString</div><div class="t m0 x49 h14 y60d ff8 fs3 fc0 sc0 ls0 ws2f">. More importantly<span class="_ _0"></span>, this</div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 ls0 ws0">code is just loaded with details that interfere with the expressi<span class="_ _4"></span>veness of the test. </div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:471.728010px;width:117.548000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:216.945010px;width:67.485000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9c" class="pf w1 h2" data-page-no="9c"><div class="pc pc9c w1 h2"><img class="bi xd ybda wc h73" alt="" src="bg9c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">125<span class="_ _10"></span><span class="ff1 wse1">Clean T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-1 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerializedPageResponderTest.java</div><div class="t m5 x52 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public void testGetPageHieratchyAsXml() throws Exception</div><div class="t m5 x52 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;PageOne&quot;));</div><div class="t m5 x8a h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;PageOne.ChildOne&quot;));</div><div class="t m5 x8a h2f y522 ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;PageTwo&quot;));</div><div class="t m5 x8a h2f y4be ffb fs10 fc0 sc0 ls0 ws0">request.setResource(&quot;root&quot;);</div><div class="t m5 x8a h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">request.addInput(&quot;type&quot;, &quot;pages&quot;);</div><div class="t m5 x8a h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">Responder responder = new SerializedPageResponder();</div><div class="t m5 x8a h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">SimpleResponse response = </div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls19 ws2f6">      (SimpleResponse) responder.makeResponse(</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls1a ws237">         new FitNesseContext(root), request);</div><div class="t m5 x8a h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">String xml = response.getContent();</div><div class="t m5 x8a h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;text/xml&quot;, response.getContentType());</div><div class="t m5 x8a h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, xml);</div><div class="t m5 x8a h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, xml);</div><div class="t m5 x8a h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;, xml);</div><div class="t m5 x52 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">public void testGetPageHieratchyAsXmlDoesntContainSymbolicLinks() </div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls19 ws237">  throws Exception</div><div class="t m5 x52 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">WikiPage pageOne = crawler.addPage(root, PathParser.parse(&quot;PageOne&quot;));</div><div class="t m5 x8a h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;PageOne.ChildOne&quot;));</div><div class="t m5 x8a h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;PageTwo&quot;));</div><div class="t m5 x8a h2f y97d ffb fs10 fc0 sc0 ls0 ws0">PageData data = pageOne.getData();</div><div class="t m5 x8a h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">WikiPageProperties properties = data.getProperties();</div><div class="t m5 x8a h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">WikiPageProperty symLinks = properties.set(SymbolicPage.PROPERTY_NAME);</div><div class="t m5 x8a h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">symLinks.set(&quot;SymPage&quot;, &quot;PageTwo&quot;);</div><div class="t m5 x8a h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">pageOne.commit(data);</div><div class="t m5 x8a h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">request.setResource(&quot;root&quot;);</div><div class="t m5 x8a h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">request.addInput(&quot;type&quot;, &quot;pages&quot;);</div><div class="t m5 x8a h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">Responder responder = new SerializedPageResponder();</div><div class="t m5 x8a h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">SimpleResponse response = </div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls19 ws2f6">      (SimpleResponse) responder.makeResponse(</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls1a ws237">         new FitNesseContext(root), request);</div><div class="t m5 x8a h2f y4db ffb fs10 fc0 sc0 ls0 ws0">String xml = response.getContent();</div><div class="t m5 x8a h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;text/xml&quot;, response.getContentType());</div><div class="t m5 x8a h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, xml);</div><div class="t m5 x8a h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, xml);</div><div class="t m5 x8a h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;, xml);</div><div class="t m5 x8a h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">assertNotSubString(&quot;SymPage&quot;, xml);</div><div class="t m5 x52 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y8c9 ffb fs10 fc0 sc0 ls0 ws0">public void testGetDataAsHtml() throws Exception</div><div class="t m5 x52 h2f y8ca ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y8cb ffb fs10 fc0 sc0 ls0 ws0">crawler.addPage(root, PathParser.parse(&quot;TestPageOne&quot;), &quot;test page&quot;);</div><div class="t m5 x8a h2f y8cd ffb fs10 fc0 sc0 ls0 ws0">request.setResource(&quot;TestPageOne&quot;);</div><div class="t m5 x8a h2f y8ce ffb fs10 fc0 sc0 ls0 ws0">request.addInput(&quot;type&quot;, &quot;data&quot;);</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9d" class="pf w1 h2" data-page-no="9d"><div class="pc pc9d w1 h2"><img class="bi xd ybdb wc h74" alt="" src="bg9d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">126<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 ybdc ff8 fs3 fc0 sc0 ls0 ws567">F<span class="_ _1"></span>or example, look at the </div><div class="t m5 x92 h2f y3b6 ffb fs10 fc0 sc0 ls0 ws0">PathParser</div><div class="t m0 xbe h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws567">calls. <span class="_ _1"></span>They transfor<span class="_ _8"></span>m strings into </div><div class="t m5 xd9 h2f y3b6 ffb fs10 fc0 sc0 ls0 ws0">PagePath</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws4d9">instances used b<span class="_ _4"></span>y the crawlers. <span class="_ _1"></span>This transformation is completely ir<span class="_ _8"></span>relev<span class="_ _4"></span>ant to the test at</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws457">hand and serves only to obfuscate the intent. <span class="_ _1"></span>The details sur<span class="_ _8"></span>rounding the creation of the</div><div class="t m5 xd h2f y3b1 ffb fs10 fc0 sc0 ls0 ws0">responder</div><div class="t m0 x80 h14 y3b1 ff8 fs3 fc0 sc0 lsc ws568">and the gathering and casting of the </div><div class="t m5 x65 h2f y3b1 ffb fs10 fc0 sc0 ls0 ws0">response</div><div class="t m0 x17 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws4fd">are also just noise. <span class="_ _1"></span>Then there’<span class="_ _0"></span>s the</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 lsd ws201">ham-handed wa<span class="_ _1"></span>y that the request URL is built from a </div><div class="t m5 x40 h2f y256 ffb fs10 fc0 sc0 ls0 ws0">resource</div><div class="t m0 xca h14 y256 ff8 fs3 fc0 sc0 ls11 ws487"> and an argument. (I helped</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws0">write this code, so I feel free to roundl<span class="_ _4"></span>y criticize it.)</div><div class="t m0 x74 h14 y4e1 ff8 fs3 fc0 sc0 ls0 wsad">In the end<span class="_ _1"></span>, this code was not designed to be read. <span class="_ _1"></span>The poor reader is inundated with a</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws0">sw<span class="_ _4"></span>arm of details that must be understood before the tests make any real sense.</div><div class="t m0 x74 h14 y2a ff8 fs3 fc0 sc0 ls0 ws28d">No<span class="_ _4"></span>w consider the impro<span class="_ _4"></span>ved tests in Listing 9-2. <span class="_ _1"></span>These tests do the exact same thing,</div><div class="t m0 xd h14 y2b ff8 fs3 fc0 sc0 lsd wsef">but they ha<span class="_ _1"></span>ve been refactored into a much cleaner and more explanatory for<span class="_ _8"></span>m.</div><div class="t m5 x8a h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">Responder responder = new SerializedPageResponder();</div><div class="t m5 x8a h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">SimpleResponse response = </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls19 ws2f6">       (SimpleResponse) responder.makeResponse(</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls1a ws241">          new FitNesseContext(root), request);</div><div class="t m5 x8a h2f y522 ffb fs10 fc0 sc0 ls0 ws0">String xml = response.getContent();</div><div class="t m5 x8a h2f y4be ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;text/xml&quot;, response.getContentType());</div><div class="t m5 x8a h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;test page&quot;, xml);</div><div class="t m5 x8a h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">assertSubString(&quot;&lt;Test&quot;, xml);</div><div class="t m5 x52 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y3a6 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-2 </div><div class="t m0 x74 h36 y48b ffc fs3 fc0 sc0 ls0 ws0">SerializedPageResponderTest.java (refactored)</div><div class="t m5 x74 h2f y2f3 ffb fs10 fc0 sc0 ls0 ws0">  public void testGetPageHierarchyAsXml() throws Exception {</div><div class="t m5 x74 h2f ybdd ffb fs10 fc0 sc0 ls0 ws0">    makePages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);</div><div class="t m5 x74 h2f ybde ffb fs10 fc0 sc0 ls0 ws0">    submitRequest(&quot;root&quot;, &quot;type:pages&quot;);</div><div class="t m5 x74 h2f ybdf ffb fs10 fc0 sc0 ls0 ws0">    assertResponseIsXML();</div><div class="t m5 x74 h2f ybe0 ffb fs10 fc0 sc0 ls0 ws0">    assertResponseContains(</div><div class="t m5 x74 h2f ybe1 ffb fs10 fc0 sc0 ls0 ws0">      &quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;</div><div class="t m5 x74 h2f ybe2 ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f ybe3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ybe4 ffb fs10 fc0 sc0 ls0 ws0">  public void testSymbolicLinksAreNotInXmlPageHierarchy() throws Exception {</div><div class="t m5 x74 h2f ybe5 ffb fs10 fc0 sc0 ls0 ws0">    WikiPage page = makePage(&quot;PageOne&quot;);</div><div class="t m5 x74 h2f ybe6 ffb fs10 fc0 sc0 ls0 ws0">    makePages(&quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);</div><div class="t m5 x74 h2f ybe7 ffb fs10 fc0 sc0 ls0 ws0">    addLinkTo(page, &quot;PageTwo&quot;, &quot;SymPage&quot;);</div><div class="t m5 x74 h2f ybe8 ffb fs10 fc0 sc0 ls0 ws0">    submitRequest(&quot;root&quot;, &quot;type:pages&quot;);</div><div class="t m5 x74 h2f ybe9 ffb fs10 fc0 sc0 ls0 ws0">    assertResponseIsXML();</div><div class="t m5 x74 h2f ybea ffb fs10 fc0 sc0 ls0 ws0">    assertResponseContains(</div><div class="t m5 x74 h2f ybeb ffb fs10 fc0 sc0 ls0 ws0">      &quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;</div><div class="t m5 x74 h2f ybec ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f ybed ffb fs10 fc0 sc0 ls0 ws0">    assertResponseDoesNotContain(&quot;SymPage&quot;);</div><div class="t m5 x74 h2f ybee ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerializedPageResponderTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9e" class="pf w1 h2" data-page-no="9e"><div class="pc pc9e w1 h2"><img class="bi xd y3cd wc h75" alt="" src="bg9e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">127<span class="_ _10"></span><span class="ff1 wse1">Clean T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 ybef ff8 fs3 fc0 sc0 ls0 ws2bb">The B</div><div class="t m0 x5f h14 y39d ff8 fsb fc0 sc0 ls0 ws0">UILD<span class="fs3">-O</span>PERATE<span class="fs3">-C</span>HECK</div><div class="t m0 x8 h21 y2aa ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x20 h14 y39d ff8 fs3 fc0 sc0 ls0 ws2bb">pattern is made obvious b<span class="_ _4"></span>y the str<span class="_ _8"></span>ucture of these tests.</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 lsd ws15f">Each of the tests is clearly split into three parts. <span class="_ _1"></span>The ﬁrst par<span class="_ _8"></span>t builds up the test data, the</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws42f">second part operates on that test data, and the third par<span class="_ _8"></span>t checks that the operation yielded</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws0">the expected results.</div><div class="t m0 x74 h14 y255 ff8 fs3 fc0 sc0 ls0 ws569">Notice that the v<span class="_ _4"></span>ast majority of anno<span class="_ _4"></span>ying detail has been eliminated. <span class="_ _4"></span>The tests get</div><div class="t m0 xd h14 y29c ff8 fs3 fc0 sc0 ls0 ws470">right to the point and use only the data types and functions that the<span class="_ _4"></span>y truly need. <span class="_ _1"></span>Any<span class="_ _4"></span>one</div><div class="t m0 xd h14 ya7f ff8 fs3 fc0 sc0 ls0 ws56a">who reads these tests should be ab<span class="_ _4"></span>le to w<span class="_ _4"></span>ork out what the<span class="_ _4"></span>y do very quickly<span class="_ _0"></span>, without being</div><div class="t m0 xd h14 y388 ff8 fs3 fc0 sc0 ls0 ws0">misled or o<span class="_ _4"></span>verw<span class="_ _4"></span>helmed by details.</div><div class="t m0 xd h11 ybf0 ff1 fs7 fc0 sc0 ls0 ws18">Domain-Speciﬁc T<span class="_ _0"></span>esting <span class="_ _5"></span>Language</div><div class="t m0 xd h14 yb41 ff8 fs3 fc0 sc0 lsd ws3ff">The tests in Listing 9-2 demonstrate the technique of building a domain-speciﬁc language</div><div class="t m0 xd h14 ybf1 ff8 fs3 fc0 sc0 ls4b ws56b">for your tests. Rather than using the <span class="_ _1"></span>APIs that pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers use to manipulate the sys-</div><div class="t m0 xd h14 ybf2 ff8 fs3 fc0 sc0 ls4a ws56c">tem, w<span class="_ _4"></span>e build up a set of functions and utilities that make use of those <span class="_ _1"></span>APIs and that</div><div class="t m0 xd h14 y96d ff8 fs3 fc0 sc0 ls4b ws294">make the tests more con<span class="_ _1"></span>venient to write and easier to read. <span class="_ _4"></span>These functions and utilities</div><div class="t m0 xd h14 y96e ff8 fs3 fc0 sc0 ls4b ws10c">become a specialized <span class="_ _1"></span>API used by the tests. <span class="_ _1"></span>They are a testing <span class="ffa ws0">languag<span class="_ _4"></span>e<span class="_ _16"> </span><span class="ff8 ws10c">that program-</span></span></div><div class="t m0 xd h14 y952 ff8 fs3 fc0 sc0 ls4b ws56d">mers use to help themselves to write their tests and to help those w<span class="_ _4"></span>ho must read those</div><div class="t m0 xd h14 y953 ff8 fs3 fc0 sc0 ls4b ws0">tests later on.</div><div class="t m0 x74 h14 ybf3 ff8 fs3 fc0 sc0 ls0 ws56e">This testing <span class="_ _1"></span>API is not designed up front; rather it ev<span class="_ _4"></span>olves from the continued refac-</div><div class="t m0 xd h14 ybf4 ff8 fs3 fc0 sc0 ls0 ws3f9">toring of test code that has gotten too tainted by obfuscating detail. Just as y<span class="_ _4"></span>ou sa<span class="_ _4"></span>w me</div><div class="t m0 xd h14 ybf5 ff8 fs3 fc0 sc0 ls0 ws56f">refactor Listing 9-1 into Listing 9-2, so too will disciplined dev<span class="_ _4"></span>elopers refactor their test</div><div class="t m0 xd h14 ybf6 ff8 fs3 fc0 sc0 ls0 ws0">code into more succinct and expressi<span class="_ _4"></span>ve forms. </div><div class="t m0 xd h11 y878 ff1 fs7 fc0 sc0 ls0 ws0">A Dual Standard</div><div class="t m0 xd h14 y6da ff8 fs3 fc0 sc0 ls0 ws335">In one sense the team I mentioned at the beginning of this chapter had things right. <span class="_ _1"></span>The</div><div class="t m0 xd h14 y6db ff8 fs3 fc0 sc0 ls0 ws570">code within the testing <span class="_ _1"></span>API <span class="ffa ws0">does </span>ha<span class="_ _4"></span>ve a dif<span class="_ _4"></span>ferent set of engineering standards than produc-</div><div class="t m0 xd h14 ybf7 ff8 fs3 fc0 sc0 lsd ws1a5">tion code. It must still be simple, succinct, and expressi<span class="_ _4"></span>ve, but it need not be as ef<span class="_ _4"></span>ﬁcient as</div><div class="t m0 xd h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws31">production code. <span class="_ _1"></span>After all, it r<span class="_ _8"></span>uns in a test en<span class="_ _4"></span>vironment, not a production environment, and</div><div class="t m0 xd h14 ybf8 ff8 fs3 fc0 sc0 ls0 ws0">those tw<span class="_ _4"></span>o en<span class="_ _4"></span>vironment ha<span class="_ _4"></span>ve very different needs.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public void testGetDataAsXml() throws Exception {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    makePageWithContent(&quot;TestPageOne&quot;, &quot;test page&quot;);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    submitRequest(&quot;TestPageOne&quot;, &quot;type:data&quot;);</div><div class="t m5 x74 h2f ybf9 ffb fs10 fc0 sc0 ls0 ws0">    assertResponseIsXML();</div><div class="t m5 x74 h2f ybfa ffb fs10 fc0 sc0 ls0 ws0">    assertResponseContains(&quot;test page&quot;, &quot;&lt;Test&quot;);</div><div class="t m5 x74 h2f y77e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>http://ﬁtnesse.or<span class="_ _4"></span>g/FitNesse.AcceptanceT<span class="_ _1"></span>estPatterns</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-2 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerializedPageResponderTest.java (refactored)</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:358.728010px;width:176.623000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:189.728010px;width:87.169000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://fitnesse.org/FitNesse.AcceptanceTestPatterns"><div class="d m1" style="border-style:none;position:absolute;left:90.830700px;bottom:67.249110px;width:143.332300px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf9f" class="pf w1 h2" data-page-no="9f"><div class="pc pc9f w1 h2"><img class="bi xd y3cd wc h76" alt="" src="bg9f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">128<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws571">Consider the test in Listing 9-3. I wrote this test as part of an environment control sys-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws572">tem I was prototyping. <span class="_ _1"></span>Without going into the details y<span class="_ _4"></span>ou can tell that this test checks that</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws573">the lo<span class="_ _4"></span>w temperature alarm, the heater, and the b<span class="_ _4"></span>lo<span class="_ _4"></span>wer are all turned on when the tempera-</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">ture is “wa<span class="_ _1"></span>y too cold.<span class="_ _1"></span>” </div><div class="t m0 x74 h14 y21d ff8 fs3 fc0 sc0 ls0 wsdc">There are, of course, lots of details here. F<span class="_ _1"></span>or example, what is that </div><div class="t m5 x45 h2f y3d5 ffb fs10 fc0 sc0 ls0 ws0">tic</div><div class="t m0 x63 h14 y3d5 ff8 fs3 fc0 sc0 ls0 wsdc">function all</div><div class="t m0 xd h14 y3d6 ff8 fs3 fc0 sc0 ls0 ws479">about? In fact, I’<span class="_ _2"></span>d rather you not w<span class="_ _1"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y about that while reading this test. I’<span class="_ _3"></span>d rather you just</div><div class="t m0 xd h14 y3d7 ff8 fs3 fc0 sc0 ls0 ws2e7">w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y about whether y<span class="_ _4"></span>ou ag<span class="_ _8"></span>ree that the end state of the system is consistent with the tem-</div><div class="t m0 xd h14 y749 ff8 fs3 fc0 sc0 ls0 ws0">perature being “wa<span class="_ _1"></span>y too cold.<span class="_ _1"></span>”</div><div class="t m0 x74 h14 y578 ff8 fs3 fc0 sc0 ls16 ws574">Notice, as you read the test, that y<span class="_ _4"></span>our ey<span class="_ _4"></span>e needs to bounce back and for<span class="_ _8"></span>th betw<span class="_ _4"></span>een</div><div class="t m0 xd h14 y579 ff8 fs3 fc0 sc0 ls16 ws1fa">the name of the state being checked<span class="_ _1"></span>, and the <span class="ffa ws0">sense<span class="_ _16"> </span></span>of the state being checked. <span class="_ _0"></span>Y<span class="_ _2"></span>ou see</div><div class="t m5 xd h2f ybfb ffb fs10 fc0 sc0 ls0 ws0">heaterState</div><div class="t m0 x4c h14 ybfb ff8 fs3 fc0 sc0 ls16 ws226">, and then your e<span class="_ _4"></span>yes glissade left to </div><div class="t m5 xce h2f ybfb ffb fs10 fc0 sc0 ls0 ws0">assertTrue</div><div class="t m0 xc2 h14 ybfb ff8 fs3 fc0 sc0 ls16 ws575">. Y<span class="_ _3"></span>ou <span class="_ _6"></span>see </div><div class="t m5 x58 h2f ybfb ffb fs10 fc0 sc0 ls0 ws0">coolerState</div><div class="t m0 xd4 h14 ybfb ff8 fs3 fc0 sc0 ls16 ws226">and your</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls16 ws7b">ey<span class="_ _4"></span>es must track left to </div><div class="t m5 x2e h2f ybfc ffb fs10 fc0 sc0 ls0 ws0">assertFalse</div><div class="t m0 x20 h14 ybfc ff8 fs3 fc0 sc0 ls16 ws7b">. <span class="_ _1"></span>This is tedious and unreliable. It makes the test hard</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls16 ws0">to read.</div><div class="t m0 x74 h14 ybfe ff8 fs3 fc0 sc0 ls0 ws0">I impro<span class="_ _4"></span>ved the reading of this test greatly b<span class="_ _4"></span>y transforming it into Listing 9-4.</div><div class="t m0 x74 h14 y316 ff8 fs3 fc0 sc0 ls0 ws139">Of course I hid the detail of the </div><div class="t m5 x77 h2f y544 ffb fs10 fc0 sc0 ls0 ws0">tic</div><div class="t m0 x33 h14 y544 ff8 fs3 fc0 sc0 ls0 ws139">function b<span class="_ _4"></span>y creating a </div><div class="t m5 x62 h2f y544 ffb fs10 fc0 sc0 ls0 ws0">wayTooCold</div><div class="t m0 x60 h14 y544 ff8 fs3 fc0 sc0 ls0 ws139">function. But the</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls0 ws576">thing to note is the strange string in the </div><div class="t m5 x83 h2f y3ae ffb fs10 fc0 sc0 ls0 ws0">assertEquals</div><div class="t m0 x96 h14 y3ae ff8 fs3 fc0 sc0 ls0 ws576">. Upper case means “on,<span class="_ _1"></span>” lo<span class="_ _4"></span>w<span class="_ _4"></span>er case</div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws577">means “off,<span class="_ _0"></span>” and the letters are al<span class="_ _4"></span>wa<span class="_ _4"></span>ys in the follo<span class="_ _4"></span>wing order: </div><div class="t m5 x55 h2f y3af ffb fs10 fc0 sc0 ls0 ws578">{heater, blower, cooler,</div><div class="t m5 xd h2f ybff ffb fs10 fc0 sc0 ls0 ws0">hi-temp-alarm, lo-temp-alarm}</div><div class="t m0 x84 h14 yc00 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y31b ff8 fs3 fc0 sc0 ls5a ws40f">Even though this is close to a violation of the rule about mental mapping,</div><div class="t m0 xda h21 y2ed ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xd9 h14 y31b ff8 fs3 fc0 sc0 ls5a ws40f">it seems</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls5a ws46c">appropriate in this case. Notice, once you kno<span class="_ _1"></span>w the meaning, your ey<span class="_ _4"></span>es glide across</div><div class="t m0 x74 h1c yc01 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-3 </div><div class="t m0 x74 h36 yc02 ffc fs3 fc0 sc0 ls0 ws0">EnvironmentControllerTest.java</div><div class="t m5 x74 h2f y4ed ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x74 h2f y4ee ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnLoTempAlarmAtThreashold() throws Exception {</div><div class="t m5 x74 h2f y4ef ffb fs10 fc0 sc0 ls0 ws0">    hw.setTemp(WAY_TOO_COLD);</div><div class="t m5 x74 h2f y4f0 ffb fs10 fc0 sc0 ls0 ws0">    controller.tic();</div><div class="t m5 x74 h2f y4f1 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(hw.heaterState());</div><div class="t m5 x74 h2f y4f2 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(hw.blowerState());</div><div class="t m5 x74 h2f y4f3 ffb fs10 fc0 sc0 ls0 ws0">    assertFalse(hw.coolerState());</div><div class="t m5 x74 h2f y4f4 ffb fs10 fc0 sc0 ls0 ws0">    assertFalse(hw.hiTempAlarm());</div><div class="t m5 x74 h2f y4f5 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(hw.loTempAlarm());</div><div class="t m5 x74 h2f y4f6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y376 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-4 </div><div class="t m0 x74 h36 y580 ffc fs3 fc0 sc0 ls0 ws0">EnvironmentControllerTest.java (refactored)</div><div class="t m5 x74 h2f yc03 ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x74 h2f yc04 ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnLoTempAlarmAtThreshold() throws Exception {</div><div class="t m5 x74 h2f yc05 ffb fs10 fc0 sc0 ls0 ws0">    wayTooCold();</div><div class="t m5 x74 h2f yc06 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;HBchL&quot;, hw.getState());</div><div class="t m5 x74 h2f yc07 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>“<span class="_ _1"></span>A<span class="_ _0"></span>void Mental Mapping” on page 25.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa0" class="pf w1 h2" data-page-no="a0"><div class="pc pca0 w1 h2"><img class="bi xd y31e wc h77" alt="" src="bga0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">129<span class="_ _10"></span><span class="ff1 wse1">Clean T<span class="_ _0"></span>ests</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls5a ws1dc">that string and you can quickl<span class="_ _4"></span>y inter<span class="_ _8"></span>pret the results. Reading the test becomes almost a</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls5a ws2b3">pleasure. Just take a look at Listing 9-5 and see ho<span class="_ _1"></span>w easy it is to understand these tests.</div><div class="t m0 x74 h14 y1c7 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 xdc h2f y96d ffb fs10 fc0 sc0 ls0 ws0">getState</div><div class="t m0 x18 h14 y96d ff8 fs3 fc0 sc0 ls0 ws3a4">function is sho<span class="_ _4"></span>wn in Listing 9-6. Notice that this is not very efﬁcient</div><div class="t m0 xd h14 y96e ff8 fs3 fc0 sc0 ls0 ws0">code. <span class="_ _1"></span>T<span class="_ _1"></span>o make it efﬁcient, I probab<span class="_ _4"></span>ly should ha<span class="_ _1"></span>ve used a </div><div class="t m5 x9f h2f y96e ffb fs10 fc0 sc0 ls0 ws0">StringBuffer</div><div class="t m0 x97 h14 y96e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y1f4 ffb fs10 fc0 sc0 ls0 ws0">StringBuffer</div><div class="t m0 xbc h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws444">s are a bit ugl<span class="_ _4"></span>y<span class="_ _1"></span>. Even in production code I will a<span class="_ _4"></span>void them if the cost is</div><div class="t m0 xd h14 y1f5 ff8 fs3 fc0 sc0 ls0 ws579">small; and you could ar<span class="_ _4"></span>gue that the cost of the code in Listing 9-6 is very small. Ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>,</div><div class="t m0 xd h14 y1f6 ff8 fs3 fc0 sc0 ls0 ws3ef">this application is clearly an embedded real-time system, and it is lik<span class="_ _4"></span>ely that computer and</div><div class="t m0 xd h14 y1f7 ff8 fs3 fc0 sc0 ls0 ws1a">memory resources are very constrained. <span class="_ _4"></span>The <span class="ffa ws0">test<span class="_ _a"> </span></span>en<span class="_ _4"></span>vironment, ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, is not likely to be</div><div class="t m0 xd h14 y1f8 ff8 fs3 fc0 sc0 ls0 ws0">constrained at all. </div><div class="t m0 x74 h1c yc08 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-5 </div><div class="t m0 x74 h36 y198 ffc fs3 fc0 sc0 ls0 ws0">EnvironmentControllerTest.java (bigger selection)</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">@Test</div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnCoolerAndBlowerIfTooHot() throws Exception {</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">    tooHot();</div><div class="t m5 x74 h2f y55d ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;hBChl&quot;, hw.getState());</div><div class="t m5 x74 h2f y55e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y58f ffb fs10 fc0 sc0 ls0 ws0">  @Test</div><div class="t m5 x74 h2f y590 ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnHeaterAndBlowerIfTooCold() throws Exception {</div><div class="t m5 x74 h2f y591 ffb fs10 fc0 sc0 ls0 ws0">    tooCold();</div><div class="t m5 x74 h2f y592 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;HBchl&quot;, hw.getState());</div><div class="t m5 x74 h2f y593 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y595 ffb fs10 fc0 sc0 ls0 ws0">  @Test</div><div class="t m5 x74 h2f yc09 ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnHiTempAlarmAtThreshold() throws Exception {</div><div class="t m5 x74 h2f yc0a ffb fs10 fc0 sc0 ls0 ws0">    wayTooHot();</div><div class="t m5 x74 h2f yc0b ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;hBCHl&quot;, hw.getState());</div><div class="t m5 x74 h2f yc0c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc0d ffb fs10 fc0 sc0 ls0 ws0">  @Test</div><div class="t m5 x74 h2f yc0e ffb fs10 fc0 sc0 ls0 ws0">  public void turnOnLoTempAlarmAtThreshold() throws Exception {</div><div class="t m5 x74 h2f yc0f ffb fs10 fc0 sc0 ls0 ws0">    wayTooCold();</div><div class="t m5 x74 h2f yc10 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;HBchL&quot;, hw.getState());</div><div class="t m5 x74 h2f yc11 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y808 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-6 </div><div class="t m0 x74 h36 y20f ffc fs3 fc0 sc0 ls0 ws0">MockControlHardware.java</div><div class="t m5 x74 h2f yc12 ffb fs10 fc0 sc0 ls0 ws0">public String getState() {</div><div class="t m5 x74 h2f yc13 ffb fs10 fc0 sc0 ls0 ws0">    String state = &quot;&quot;;</div><div class="t m5 x74 h2f yc14 ffb fs10 fc0 sc0 ls0 ws0">    state += heater ? &quot;H&quot; : &quot;h&quot;;</div><div class="t m5 x74 h2f yc15 ffb fs10 fc0 sc0 ls0 ws0">    state += blower ? &quot;B&quot; : &quot;b&quot;;</div><div class="t m5 x74 h2f yc16 ffb fs10 fc0 sc0 ls0 ws0">    state += cooler ? &quot;C&quot; : &quot;c&quot;;</div><div class="t m5 x74 h2f yc17 ffb fs10 fc0 sc0 ls0 ws0">    state += hiTempAlarm ? &quot;H&quot; : &quot;h&quot;;</div><div class="t m5 x74 h2f yc18 ffb fs10 fc0 sc0 ls0 ws0">    state += loTempAlarm ? &quot;L&quot; : &quot;l&quot;;</div><div class="t m5 x74 h2f yc19 ffb fs10 fc0 sc0 ls0 ws0">    return state;</div><div class="t m5 x74 h2f yc1a ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa1" class="pf w1 h2" data-page-no="a1"><div class="pc pca1 w1 h2"><img class="bi xd yc1b wc h78" alt="" src="bga1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">130<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws24">That is the nature of the dual standard. <span class="_ _1"></span>There are things that you might nev<span class="_ _4"></span>er do in a</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws57a">production en<span class="_ _4"></span>vironment that are perfectly ﬁne in a test en<span class="_ _1"></span>vironment. Usually the<span class="_ _4"></span>y inv<span class="_ _4"></span>olve</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">issues of memory or CPU efﬁciency<span class="_ _0"></span>. But they <span class="ffa">ne<span class="_ _4"></span>ver<span class="ff8"> in<span class="_ _4"></span>volve issues of cleanliness. </span></span></div><div class="t m0 xd h17 y991 ff1 fs9 fc0 sc0 ls0 ws20d">One Assert <span class="_ _d"></span>per <span class="_ _8"></span>T<span class="_ _0"></span>est</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls10 ws468">There is a school of thought</div><div class="t m0 x1f h21 ya6b ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x9b h14 y299 ff8 fs3 fc0 sc0 ls10 ws468">that sa<span class="_ _4"></span>ys that ev<span class="_ _4"></span>er<span class="_ _8"></span>y test function in a JUnit test should ha<span class="_ _4"></span>ve one</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls10 ws57b">and onl<span class="_ _4"></span>y one asser<span class="_ _8"></span>t statement. <span class="_ _4"></span>This r<span class="_ _8"></span>ule ma<span class="_ _4"></span>y seem draconian, but the advantage can be seen</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls10 ws0">in Listing 9-5. <span class="_ _1"></span>Those tests come to a single conclusion that is quick and easy to understand. </div><div class="t m0 x74 h14 y385 ff8 fs3 fc0 sc0 ls0 ws57c">But what about Listing 9-2? It seems unreasonab<span class="_ _4"></span>le that w<span class="_ _4"></span>e could someho<span class="_ _4"></span>w easily</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws57d">merge the assertion that the output is XML and that it contains certain substrings. How-</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 wscd">e<span class="_ _4"></span>ver<span class="_ _4"></span>, w<span class="_ _4"></span>e can break the test into two separate tests, each with its o<span class="_ _1"></span>wn par<span class="_ _8"></span>ticular assertion, as</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">sho<span class="_ _4"></span>wn in Listing 9-7.</div><div class="t m0 x74 h14 y5a3 ff8 fs3 fc0 sc0 ls0 ws50f">Notice that I ha<span class="_ _4"></span>ve changed the names of the functions to use the common gi<span class="_ _4"></span>ven-when-</div><div class="t m0 xd h14 y5a4 ff8 fs3 fc0 sc0 ls0 ws0">then</div><div class="t m0 x74 h21 y2e7 ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 x7c h14 yc1c ff8 fs3 fc0 sc0 ls0 wsfa">con<span class="_ _4"></span>vention. <span class="_ _1"></span>This makes the tests ev<span class="_ _4"></span>en easier to read. Unfor<span class="_ _8"></span>tunately<span class="_ _0"></span>, splitting the tests</div><div class="t m0 xd h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws0">as sho<span class="_ _4"></span>wn results in a lot of duplicate code.</div><div class="t m0 x74 h14 y7fb ff8 fs3 fc0 sc0 ls10 ws264">W<span class="_ _0"></span>e can eliminate the duplication by using the T<span class="_ _4"></span><span class="fsb ws0">EMPLATE<span class="fs3 ls5b"> M</span>ETHOD</span></div><div class="t m0 x59 h21 y395 ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 x8b h14 y7fb ff8 fs3 fc0 sc0 ls10 ws264">pattern and putting</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 ls10 ws0">the <span class="ffa">given/w<span class="_ _4"></span>hen <span class="ff8 ws9a">parts in the base class, and the </span>then <span class="ff8 ws9a">parts in different deri<span class="_ _4"></span>vati<span class="_ _4"></span>ves. Or w<span class="_ _4"></span>e could</span></span></div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls10 ws3fa">create a completely separate test class and put the <span class="_ _4"></span><span class="ffa ws0">given<span class="_ _a"> </span><span class="ff8">and<span class="_ _a"> </span></span>when <span class="ff8 ws3fa">parts in the </span></span></div><div class="t m5 xa6 h2f y8e1 ffb fs10 fc0 sc0 ls45 ws0">@Before</div><div class="t m0 xb0 h14 y8e1 ff8 fs3 fc0 sc0 ls10 ws0">func-</div><div class="t m0 xd h14 yc1d ff8 fs3 fc0 sc0 ls10 ws57e">tion, and the <span class="ffa ws0">when</span> parts in each </div><div class="t m5 x84 h2f yc1d ffb fs10 fc0 sc0 ls45 ws0">@Test</div><div class="t m0 x43 h14 yc1d ff8 fs3 fc0 sc0 ls10 ws57e"> function. But this seems like too much mechanism for</div><div class="t m0 xd h14 y2ed ff8 fs3 fc0 sc0 ls10 ws0">such a minor issue. In the end<span class="_ _1"></span>, I prefer the multiple asser<span class="_ _8"></span>ts in Listing 9-2.</div><div class="t m0 xd h25 yc1e ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>See Da<span class="_ _4"></span>ve <span class="_ _1"></span>Astel’<span class="_ _1"></span>s blo<span class="_ _4"></span>g entr<span class="_ _8"></span>y: http://www<span class="_ _1"></span>.ar<span class="_ _8"></span>tima.com/w<span class="_ _4"></span>eblogs/vie<span class="_ _4"></span>wpost.jsp?thread=35578</div><div class="t m0 x74 h1c yc1f ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-7 </div><div class="t m0 x74 h36 yc20 ffc fs3 fc0 sc0 ls0 ws0">SerializedPageResponderTest.java (Single Assert)</div><div class="t m5 x74 h2f yc21 ffb fs10 fc0 sc0 ls0 ws0">public void testGetPageHierarchyAsXml() throws Exception {</div><div class="t m5 x74 h2f yc22 ffb fs10 fc0 sc0 ls0 ws0">    givenPages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);</div><div class="t m5 x74 h2f yc23 ffb fs10 fc0 sc0 ls0 ws0">    whenRequestIsIssued(&quot;root&quot;, &quot;type:pages&quot;);</div><div class="t m5 x74 h2f yc24 ffb fs10 fc0 sc0 ls0 ws0">    thenResponseShouldBeXML();</div><div class="t m5 x74 h2f yc25 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc26 ffb fs10 fc0 sc0 ls0 ws0">  public void testGetPageHierarchyHasRightTags() throws Exception {</div><div class="t m5 x74 h2f yc27 ffb fs10 fc0 sc0 ls0 ws0">    givenPages(&quot;PageOne&quot;, &quot;PageOne.ChildOne&quot;, &quot;PageTwo&quot;);</div><div class="t m5 x74 h2f yc28 ffb fs10 fc0 sc0 ls0 ws0">    whenRequestIsIssued(&quot;root&quot;, &quot;type:pages&quot;);</div><div class="t m5 x74 h2f yc29 ffb fs10 fc0 sc0 ls0 ws0">    thenResponseShouldContain(</div><div class="t m5 x74 h2f yc2a ffb fs10 fc0 sc0 ls0 ws0">      &quot;&lt;name&gt;PageOne&lt;/name&gt;&quot;, &quot;&lt;name&gt;PageTwo&lt;/name&gt;&quot;, &quot;&lt;name&gt;ChildOne&lt;/name&gt;&quot;</div><div class="t m5 x74 h2f yc2b ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f yc2c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>[RSpec].</div><div class="t m0 xd h25 y39b ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _17"> </span>[GOF].</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:526.946010px;width:116.188000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.artima.com/weblogs/viewpost.jsp?thread=35578"><div class="d m1" style="border-style:none;position:absolute;left:171.180000px;bottom:83.249210px;width:168.577000px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa2" class="pf w1 h2" data-page-no="a2"><div class="pc pca2 w1 h2"><img class="bi xd y3cd wc h79" alt="" src="bga2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">131<span class="_ _10"></span><span class="ff1 ws1fc">One Assert <span class="_ _6"></span>per <span class="_ _8"></span>T<span class="_ _0"></span>est</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls4b ws4aa">I think the single assert r<span class="_ _8"></span>ule is a good guideline.</div><div class="t m0 xb7 h21 y4ea ff8 fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 xb6 h14 y194 ff8 fs3 fc0 sc0 ls4b ws4aa">I usually try to create a domain-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls4b ws57f">speciﬁc testing language that supports it, as in Listing 9-5. But I am not afraid to put</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls4b ws4ff">more than one assert in a test. I think the best thing we can sa<span class="_ _1"></span>y is that the number of</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls4b ws0">asserts in a test ought to be minimized.</div><div class="t m0 xd h11 y24c ff1 fs7 fc0 sc0 ls0 ws0">Single Concept per <span class="_ _1"></span>T<span class="_ _0"></span>est</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws223">P<span class="_ _4"></span>erhaps a better rule is that we w<span class="_ _4"></span>ant to test a single concept in each test function. W<span class="_ _2"></span>e don’<span class="_ _4"></span>t</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws4c0">w<span class="_ _4"></span>ant long test functions that go testing one miscellaneous thing after another<span class="_ _4"></span>. Listing 9-8</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws580">is an example of such a test. <span class="_ _1"></span>This test should be split up into three independent tests</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws581">because it tests three independent things. Merging them all to<span class="_ _4"></span>gether into the same function</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws470">forces the reader to ﬁgure out wh<span class="_ _1"></span>y each section is there and what is being tested by that</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws0">section.</div><div class="t m0 x74 h14 y958 ff8 fs3 fc0 sc0 ls0 ws0">The three test functions probabl<span class="_ _4"></span>y ought to be like this:</div><div class="t m0 x2c h14 yc2d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Given</span> the last da<span class="_ _4"></span>y of a month with 31 da<span class="_ _4"></span>ys (like Ma<span class="_ _4"></span>y):</div><div class="t m0 x2b h14 y400 ffe fsb fc0 sc0 ls0 ws0">1.<span class="_ _2e"> </span><span class="ffa fs3">When<span class="ff8"> you add one month, such that the last da<span class="_ _1"></span>y of that month is the 30th </span></span></div><div class="t m0 x75 h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">(like June), <span class="ffa">then</span> the date should be the 30th of that month, not the 31st.</div><div class="t m0 x2b h14 y3e7 ffe fsb fc0 sc0 ls0 ws0">2.<span class="_ _2e"> </span><span class="ffa fs3">When<span class="ff8"> you add tw<span class="_ _1"></span>o months to that date, such that the ﬁnal month has 31 days, </span></span></div><div class="t m0 x75 h14 ybf8 ffa fs3 fc0 sc0 ls0 ws0">then<span class="ff8"> the date should be the 31st.</span></div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _17"> </span>“K<span class="_ _4"></span>eep to the code!”</div><div class="t m0 x74 h1c y329 ff1 fs3 fc0 sc0 ls0 ws0">Listing 9-8 </div><div class="t m5 x74 h2f yc2e ffb fs10 fc0 sc0 ls5c ws253">    /**</div><div class="t m5 x74 h2f yc2f ffb fs10 fc0 sc0 ls0 ws0">     * Miscellaneous tests for the addMonths() method.</div><div class="t m5 x74 h2f yc30 ffb fs10 fc0 sc0 ls0 ws0">     */</div><div class="t m5 x74 h2f yc31 ffb fs10 fc0 sc0 ls0 ws0">    public void testAddMonths() {</div><div class="t m5 x74 h2f yc32 ffb fs10 fc0 sc0 ls0 ws0">        SerialDate d1 = SerialDate.createInstance(31, 5, 2004);</div><div class="t m5 x74 h2f yc33 ffb fs10 fc0 sc0 ls0 ws0">        SerialDate d2 = SerialDate.addMonths(1, d1);</div><div class="t m5 x74 h2f yc34 ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(30, d2.getDayOfMonth());</div><div class="t m5 x74 h2f yc35 ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(6, d2.getMonth());</div><div class="t m5 x74 h2f yc36 ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(2004, d2.getYYYY());</div><div class="t m5 x74 h2f yc37 ffb fs10 fc0 sc0 ls0 ws0">        SerialDate d3 = SerialDate.addMonths(2, d1);</div><div class="t m5 x74 h2f yc38 ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(31, d3.getDayOfMonth());</div><div class="t m5 x74 h2f yc39 ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(7, d3.getMonth());</div><div class="t m5 x74 h2f yc3a ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(2004, d3.getYYYY());</div><div class="t m5 x74 h2f yc3b ffb fs10 fc0 sc0 ls0 ws0">        SerialDate d4 = SerialDate.addMonths(1, SerialDate.addMonths(1, d1));</div><div class="t m5 x74 h2f yc3c ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(30, d4.getDayOfMonth());</div><div class="t m5 x74 h2f yc3d ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(7, d4.getMonth());</div><div class="t m5 x74 h2f yc3e ffb fs10 fc0 sc0 ls0 ws0">        assertEquals(2004, d4.getYYYY());</div><div class="t m5 x74 h2f yc3f ffb fs10 fc0 sc0 ls0 ws0">    }</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:524.728010px;width:120.507000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa3" class="pf w1 h2" data-page-no="a3"><div class="pc pca3 w1 h2"><img class="bi x37 yc40 w8 h27" alt="" src="bga3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">132<span class="_ _2d"> </span><span class="ff1 wsf5">Chapter 9:<span class="_ _4"></span> Unit <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 x2c h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Given</span> the last da<span class="_ _4"></span>y of a month with 30 da<span class="_ _4"></span>ys in it (like June):</div><div class="t m0 x2b h14 yc41 ffe fsb fc0 sc0 ls0 ws0">1.<span class="_ _2e"> </span><span class="ffa fs3">When<span class="_ _b"> </span><span class="ff8 ws582">you add one month such that the last da<span class="_ _4"></span>y of that month has 31 da<span class="_ _4"></span>ys, <span class="ffa ws0">then <span class="ff8">the</span></span></span></span></div><div class="t m0 x75 h14 ya7b ff8 fs3 fc0 sc0 ls0 ws0">date should be the 30th, not the 31st. </div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws527">Stated like this, y<span class="_ _4"></span>ou can see that there is a general r<span class="_ _8"></span>ule hiding amidst the miscella-</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws583">neous tests. <span class="_ _4"></span>When you increment the month, the date can be no greater than the last day of</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws202">the month. <span class="_ _1"></span>This implies that incrementing the month on F<span class="_ _4"></span>ebr<span class="_ _8"></span>uar<span class="_ _8"></span>y 28th should yield March</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">28th.<span class="_ _b"> </span><span class="ffa">That</span> test is missing and w<span class="_ _1"></span>ould be a useful test to write.</div><div class="t m0 x74 h14 y19c ff8 fs3 fc0 sc0 ls0 ws52a">So it’<span class="_ _2"></span>s not the multiple asserts in each section of Listing 9-8 that causes the problem.</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws584">Rather it is the fact that there is more than one concept being tested. So probabl<span class="_ _4"></span>y the best</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws585">rule is that you should minimize the number of asserts per concept and test just one con-</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">cept per test function.</div><div class="t m0 xd h17 yc42 ff1 fs9 fc0 sc0 ls0 ws0">F<span class="_ _3"></span>.I.R.S.T<span class="_ _1"></span>.</div><div class="t m0 x28 h41 yc43 ff1 fs14 fc0 sc0 ls0 ws0">8</div><div class="t m0 xd h14 y658 ff8 fs3 fc0 sc0 ls0 ws0">Clean tests follo<span class="_ _4"></span>w ﬁve other rules that for<span class="_ _8"></span>m the abo<span class="_ _4"></span>ve acron<span class="_ _4"></span>ym:</div><div class="t m0 xd hd y65a ffe fs3 fc0 sc0 ls0 ws0">F<span class="_ _4"></span>ast <span class="ff8 ws414">T<span class="_ _0"></span>ests should be fast. <span class="_ _4"></span>They should run quickly<span class="_ _0"></span>. <span class="_ _4"></span>When tests r<span class="_ _8"></span>un slo<span class="_ _4"></span>w<span class="_ _1"></span>, you w<span class="_ _1"></span>on’<span class="_ _4"></span>t want</span></div><div class="t m0 xd h14 yc44 ff8 fs3 fc0 sc0 ls0 ws1aa">to run them frequently<span class="_ _0"></span>. If you don’<span class="_ _1"></span>t r<span class="_ _8"></span>un them frequently<span class="_ _0"></span>, you w<span class="_ _1"></span>on’<span class="_ _4"></span>t ﬁnd problems earl<span class="_ _4"></span>y</div><div class="t m0 xd h14 yc45 ff8 fs3 fc0 sc0 ls0 wsa0">enough to ﬁx them easil<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou w<span class="_ _4"></span>on’<span class="_ _4"></span>t feel as free to clean up the code. Eventuall<span class="_ _4"></span>y the code</div><div class="t m0 xd h14 yc46 ff8 fs3 fc0 sc0 ls0 ws0">will begin to rot.</div><div class="t m0 xd hd yc47 ffe fs3 fc0 sc0 ls0 ws0">Independent <span class="ff8 ls10 ws29c">T<span class="_ _0"></span>ests should not depend on each other<span class="_ _1"></span>. One test should not set up the condi-</span></div><div class="t m0 xd h14 yc48 ff8 fs3 fc0 sc0 ls10 ws586">tions for the next test. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should be able to run each test independently and run the tests in</div><div class="t m0 xd h14 yc49 ff8 fs3 fc0 sc0 ls10 wsd4">an<span class="_ _4"></span>y order you like. <span class="_ _4"></span>When tests depend on each other<span class="_ _4"></span>, then the ﬁrst one to fail causes a cas-</div><div class="t m0 xd h14 yc4a ff8 fs3 fc0 sc0 ls10 ws0">cade of do<span class="_ _4"></span>wnstream failures, making diagnosis difﬁcult and hiding do<span class="_ _1"></span>wnstream defects.</div><div class="t m0 xd hd yc4b ffe fs3 fc0 sc0 ls0 ws0">Repeatable <span class="ff8 ws587">T<span class="_ _0"></span>ests should be repeatable in an<span class="_ _4"></span>y en<span class="_ _4"></span>vironment. <span class="_ _0"></span>Y<span class="_ _2"></span>ou should be able to run the</span></div><div class="t m0 xd h14 yc4c ff8 fs3 fc0 sc0 ls0 ws588">tests in the production en<span class="_ _4"></span>vironment, in the QA en<span class="_ _4"></span>vironment, and on your laptop w<span class="_ _4"></span>hile</div><div class="t m0 xd h14 yc4d ff8 fs3 fc0 sc0 ls0 ws589">riding home on the train without a netw<span class="_ _4"></span>ork. If your tests aren’<span class="_ _1"></span>t repeatable in an<span class="_ _4"></span>y en<span class="_ _4"></span>viron-</div><div class="t m0 xd h14 yc4e ff8 fs3 fc0 sc0 ls0 ws3d1">ment, then you’<span class="_ _1"></span>ll alw<span class="_ _4"></span>a<span class="_ _4"></span>ys ha<span class="_ _4"></span>ve an excuse for w<span class="_ _4"></span>hy the<span class="_ _4"></span>y fail. <span class="_ _1"></span>Y<span class="_ _3"></span>ou’ll also ﬁnd y<span class="_ _4"></span>ourself unable</div><div class="t m0 xd h14 yc4f ff8 fs3 fc0 sc0 ls0 ws0">to run the tests when the en<span class="_ _4"></span>vironment isn’<span class="_ _4"></span>t a<span class="_ _4"></span>vailab<span class="_ _4"></span>le.</div><div class="t m0 xd hd yc50 ffe fs3 fc0 sc0 ls0 ws0">Self-V<span class="_ _4"></span>alidating <span class="ff8 ws58a">The tests should hav<span class="_ _4"></span>e a boolean output. Either they pass or fail. <span class="_ _0"></span>Y<span class="_ _2"></span>ou</span></div><div class="t m0 xd h14 yc51 ff8 fs3 fc0 sc0 ls0 ws4fd">should not ha<span class="_ _4"></span>ve to read through a lo<span class="_ _4"></span>g ﬁle to tell whether the tests pass. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should not hav<span class="_ _4"></span>e</div><div class="t m0 xd h14 yc52 ff8 fs3 fc0 sc0 ls0 ws58b">to manuall<span class="_ _4"></span>y compare two dif<span class="_ _4"></span>ferent text ﬁles to see w<span class="_ _4"></span>hether the tests pass. If the tests aren’<span class="_ _4"></span>t</div><div class="t m0 xd h14 yc53 ff8 fs3 fc0 sc0 ls0 ws23f">self-validating, then failure can become subjecti<span class="_ _4"></span>ve and running the tests can require a long</div><div class="t m0 xd h14 yc54 ff8 fs3 fc0 sc0 ls0 ws0">manual ev<span class="_ _1"></span>aluation.</div><div class="t m0 xd h25 yc55 ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _17"> </span>Object Mentor <span class="_ _1"></span>Training Materials.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:414.545010px;width:60.131000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa4" class="pf w1 h2" data-page-no="a4"><div class="pc pca4 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">133<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd hd y194 ffe fs3 fc0 sc0 ls0 ws0">Timely <span class="ff8 ws137">The tests need to be written in a timel<span class="_ _4"></span>y f<span class="_ _8"></span>ashion. Unit tests should be written <span class="ffa ws0">just</span></span></div><div class="t m0 xd h14 y195 ffa fs3 fc0 sc0 ls0 ws0">befor<span class="_ _1"></span>e<span class="_ _16"> </span><span class="ff8 ws58c">the production code that makes them pass. If you write tests after the production</span></div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws3e1">code, then you ma<span class="_ _1"></span>y ﬁnd the production code to be hard to test. <span class="_ _1"></span>Y<span class="_ _3"></span>ou may decide that some</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">production code is too hard to test. <span class="_ _0"></span>Y<span class="_ _2"></span>ou ma<span class="_ _4"></span>y not design the production code to be testable.</div><div class="t m0 xd h17 yc56 ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 wsf4">W<span class="_ _0"></span>e ha<span class="_ _4"></span>ve barel<span class="_ _4"></span>y scratched the surface of this topic. Indeed<span class="_ _4"></span>, I think an entire book could be</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws473">written about <span class="ffa">clean tests</span>. <span class="_ _1"></span>T<span class="_ _0"></span>ests are as important to the health of a project as the production</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws58d">code is. P<span class="_ _4"></span>erhaps they are e<span class="_ _4"></span>ven more important, because tests preser<span class="_ _8"></span>ve and enhance the</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws176">ﬂexibility<span class="_ _0"></span>, maintainability<span class="_ _0"></span>, and reusability of the production code. So keep your tests con-</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws402">stantly clean. <span class="_ _1"></span>W<span class="_ _0"></span>ork to make them expressi<span class="_ _4"></span>ve and succinct. In<span class="_ _4"></span>vent testing <span class="_ _1"></span>APIs that act as</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">domain-speciﬁc language that helps you write the tests. </div><div class="t m0 x74 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">If you let the tests rot, then y<span class="_ _4"></span>our code will rot too. Keep y<span class="_ _4"></span>our tests clean.</div><div class="t m0 xd h17 yc57 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y568 ff1 fs3 fc0 sc0 ls0 wsa0">[RSpec]:<span class="_ _4"></span>  <span class="ffa ws0">RSpec: Behavior Driven Development for Ruby Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>ammers<span class="ff8">,</span></span></div><div class="t m0 xd h14 y569 ff8 fs3 fc0 sc0 ls0 ws0">Aslak Hellesøy<span class="_ _0"></span>, David Chelimsk<span class="_ _4"></span>y<span class="_ _1"></span>, Pragmatic Bookshelf, 2008.</div><div class="t m0 xd h14 yc58 ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa wse4">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e<span class="ff8">, Gamma et al.,</span></span></div><div class="t m0 xd h14 yc59 ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:514.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:383.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa5" class="pf w1 h2" data-page-no="a5"><div class="pc pca5 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa6" class="pf w1 h2" data-page-no="a6"><div class="pc pca6 w1 h2"><img class="bi xd y1fd w4 h1e" alt="" src="bga6.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">135</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">10</div><div class="t m0 x8b h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Classes</div><div class="t m0 x6f h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">with Jeff Langr</div><div class="t m0 xd h14 yc5a ff8 fs3 fc0 sc0 ls0 ws1ff">So far in this book we ha<span class="_ _1"></span>ve focused on ho<span class="_ _4"></span>w to write lines and blocks of code w<span class="_ _1"></span>ell. W<span class="_ _0"></span>e ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 yc5b ff8 fs3 fc0 sc0 ls0 ws4af">delved into proper composition of functions and ho<span class="_ _1"></span>w they inter<span class="_ _8"></span>relate. But for all the atten-</div><div class="t m0 xd h14 yc5c ff8 fs3 fc0 sc0 ls0 ws48e">tion to the expressi<span class="_ _4"></span>veness of code statements and the functions the<span class="_ _4"></span>y comprise, we still</div><div class="t m0 xd h14 yc5d ff8 fs3 fc0 sc0 lsc ws1e9">don’<span class="_ _1"></span>t hav<span class="_ _4"></span>e clean code until we’<span class="_ _1"></span>ve paid attention to higher le<span class="_ _4"></span>vels of code organization. Let’<span class="_ _3"></span>s</div><div class="t m0 xd h14 yc5e ff8 fs3 fc0 sc0 ls0 ws0">talk about clean classes.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:364.226000px;bottom:440.027010px;width:74.663000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa7" class="pf w1 h2" data-page-no="a7"><div class="pc pca7 w1 h2"><img class="bi xd yb86 wc h7a" alt="" src="bga7.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">136<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Class Org<span class="_ _4"></span>anization</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws58e">F<span class="_ _1"></span>ollowing the standard Ja<span class="_ _1"></span>va con<span class="_ _4"></span>vention, a class should be<span class="_ _4"></span>gin with a list of variab<span class="_ _4"></span>les. Pub-</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls11 ws7e">lic static constants, if an<span class="_ _4"></span>y<span class="_ _1"></span>, should come ﬁrst. <span class="_ _4"></span>Then priv<span class="_ _4"></span>ate static v<span class="_ _4"></span>ariables, follo<span class="_ _4"></span>w<span class="_ _4"></span>ed by pri-</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws0">v<span class="_ _4"></span>ate instance variab<span class="_ _4"></span>les. <span class="_ _4"></span>There is seldom a good reason to hav<span class="_ _4"></span>e a public v<span class="_ _4"></span>ariable.</div><div class="t m0 x74 h14 y460 ff8 fs3 fc0 sc0 ls0 ws58f">Public functions should follo<span class="_ _1"></span>w the list of variab<span class="_ _4"></span>les. W<span class="_ _2"></span>e like to put the priv<span class="_ _4"></span>ate utilities</div><div class="t m0 xd h14 y461 ff8 fs3 fc0 sc0 ls0 ws2f8">called by a pub<span class="_ _4"></span>lic function right after the public function itself. <span class="_ _1"></span>This follo<span class="_ _4"></span>ws the stepdo<span class="_ _4"></span>wn</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws0">rule and helps the program read like a newspaper article. </div><div class="t m0 xd h11 yc5f ff1 fs7 fc0 sc0 ls0 ws0">Encapsulation</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 lsd ws4b5">W<span class="_ _0"></span>e like to keep our v<span class="_ _4"></span>ariables and utility functions pri<span class="_ _4"></span>v<span class="_ _4"></span>ate, but we’<span class="_ _0"></span>re not fanatic about it.</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws590">Sometimes w<span class="_ _4"></span>e need to make a v<span class="_ _4"></span>ariable or utility function protected so that it can be</div><div class="t m0 xd h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws52a">accessed b<span class="_ _4"></span>y a test. F<span class="_ _4"></span>or us, tests r<span class="_ _8"></span>ule. If a test in the same package needs to call a function</div><div class="t m0 xd h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws4fd">or access a v<span class="_ _4"></span>ariable, w<span class="_ _4"></span>e’<span class="_ _4"></span>ll make it protected or package scope. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>, w<span class="_ _4"></span>e’ll ﬁrst look for</div><div class="t m0 xd h14 y1bf ff8 fs3 fc0 sc0 ls0 ws0">a wa<span class="_ _1"></span>y to maintain priv<span class="_ _4"></span>acy<span class="_ _0"></span>. Loosening encapsulation is al<span class="_ _4"></span>wa<span class="_ _4"></span>ys a last resort.</div><div class="t m0 xd h17 yc60 ff1 fs9 fc0 sc0 ls0 ws0">Classes Should Be Small!</div><div class="t m0 xd h14 y5e0 ff8 fs3 fc0 sc0 ls0 ws336">The ﬁrst rule of classes is that they should be small. <span class="_ _4"></span>The second rule of classes is that they</div><div class="t m0 xd h14 y5e1 ff8 fs3 fc0 sc0 ls0 wsae">should be smaller than that. No, w<span class="_ _4"></span>e’<span class="_ _1"></span>re not going to repeat the exact same te<span class="_ _4"></span>xt from the</div><div class="t m0 xd h14 yc61 ffa fs3 fc0 sc0 ls0 ws0">Functions<span class="_ _15"> </span><span class="ff8 ws591">chapter<span class="_ _1"></span>. But as with functions, smaller is the primar<span class="_ _8"></span>y r<span class="_ _8"></span>ule when it comes to</span></div><div class="t m0 xd h14 yc62 ff8 fs3 fc0 sc0 ls0 ws0">designing classes. <span class="_ _1"></span>As with functions, our immediate question is alw<span class="_ _4"></span>a<span class="_ _4"></span>ys “Ho<span class="_ _4"></span>w small?”</div><div class="t m0 x74 h14 y373 ff8 fs3 fc0 sc0 ls0 ws1b8">W<span class="_ _4"></span>ith functions w<span class="_ _4"></span>e measured size by counting ph<span class="_ _4"></span>ysical lines. <span class="_ _4"></span>With classes w<span class="_ _1"></span>e use a</div><div class="t m0 xd h14 y374 ff8 fs3 fc0 sc0 ls0 ws0">different measure. <span class="_ _1"></span>W<span class="_ _0"></span>e count <span class="ffa">responsibilities.</span></div><div class="t m0 xbe h21 y2c8 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x74 h14 y48e ff8 fs3 fc0 sc0 ls0 ws183">Listing 10-1 outlines a class, </div><div class="t m5 xc h2f y48e ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 xde h14 y48e ff8 fs3 fc0 sc0 ls0 ws183">, that exposes about 70 pub<span class="_ _4"></span>lic methods.</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws5c">Most dev<span class="_ _4"></span>elopers w<span class="_ _4"></span>ould ag<span class="_ _8"></span>ree that it’<span class="_ _2"></span>s a bit too super in size. Some dev<span class="_ _4"></span>elopers might refer</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xcd h2f y37b ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 x6 h14 y37b ff8 fs3 fc0 sc0 ls0 ws0"> as a “God class.<span class="_ _1"></span>”</div><div class="t m0 xd h25 yc63 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[RDD].</div><div class="t m0 x74 h1c y672 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-1 </div><div class="t m0 x74 h36 y5b4 ffc fs3 fc0 sc0 ls0 ws0">Too Many Responsibilities</div><div class="t m5 x74 h2f yb0f ffb fs10 fc0 sc0 ls0 ws0">public class SuperDashboard extends JFrame implements MetaDataUser </div><div class="t m5 x74 h2f yb10 ffb fs10 fc0 sc0 ls0 ws0">   public String getCustomizerLanguagePath() </div><div class="t m5 x74 h2f yc64 ffb fs10 fc0 sc0 ls0 ws0">   public void setSystemConfigPath(String systemConfigPath) </div><div class="t m5 x74 h2f yb11 ffb fs10 fc0 sc0 ls0 ws0">   public String getSystemConfigDocument() </div><div class="t m5 x74 h2f yb12 ffb fs10 fc0 sc0 ls0 ws0">   public void setSystemConfigDocument(String systemConfigDocument) </div><div class="t m5 x74 h2f yb13 ffb fs10 fc0 sc0 ls0 ws0">   public boolean getGuruState() </div><div class="t m5 x74 h2f yc65 ffb fs10 fc0 sc0 ls0 ws0">   public boolean getNoviceState() </div><div class="t m5 x74 h2f yb14 ffb fs10 fc0 sc0 ls0 ws0">   public boolean getOpenSourceState() </div><div class="t m5 x74 h2f yb15 ffb fs10 fc0 sc0 ls0 ws0">   public void showObject(MetaObject object) </div><div class="t m5 x74 h2f yb16 ffb fs10 fc0 sc0 ls0 ws0">   public void showProgress(String s)</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:469.728010px;width:73.356000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:580.945010px;width:114.385000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:367.945010px;width:150.527000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa8" class="pf w1 h2" data-page-no="a8"><div class="pc pca8 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bga8.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">137<span class="_ _10"></span><span class="ff1">Classes Should Be Small!</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">   public boolean isMetadataDirty() </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">   public void setIsMetadataDirty(boolean isMetadataDirty) </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">   public Component getLastFocusedComponent() </div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">   public void setLastFocused(Component lastFocused) </div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">   public void setMouseSelectState(boolean isMouseSelected)</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">   public boolean isMouseSelected() </div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">   public LanguageManager getLanguageManager() </div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">   public Project getProject() </div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">   public Project getFirstProject() </div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">   public Project getLastProject() </div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">   public String getNewProjectName()</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">   public void setComponentSizes(Dimension dim)</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">   public String getCurrentDir() </div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">   public void setCurrentDir(String newDir) </div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">   public void updateStatus(int dotPos, int markPos) </div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">   public Class[] getDataBaseClasses() </div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">   public MetadataFeeder getMetadataFeeder() </div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">   public void addProject(Project project)</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">   public boolean setCurrentProject(Project project)</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">   public boolean removeProject(Project project) </div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">   public MetaProjectHeader getProgramMetadata()</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">   public void resetDashboard()</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">   public Project loadProject(String fileName, String projectName)</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">   public void setCanSaveMetadata(boolean canSave)</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">   public MetaObject getSelectedObject() </div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">   public void deselectObjects() </div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">   public void setProject(Project project) </div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">   public void editorAction(String actionName, ActionEvent event)</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">   public void setMode(int mode) </div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">   public FileManager getFileManager() </div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">   public void setFileManager(FileManager fileManager) </div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">   public ConfigManager getConfigManager() </div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">   public void setConfigManager(ConfigManager configManager) </div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">   public ClassLoader getClassLoader() </div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">   public void setClassLoader(ClassLoader classLoader) </div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">   public Properties getProps() </div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">   public String getUserHome() </div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">   public String getBaseDir() </div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">   public int getMajorVersionNumber() </div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">   public int getMinorVersionNumber() </div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">   public int getBuildNumber() </div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">   public MetaObject pasting(</div><div class="t m5 x5f h2f y6ab ffb fs10 fc0 sc0 ls41 ws0">MetaObject target, MetaObject pasted, MetaProject project)</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">   public void processMenuItems(MetaObject metaObject)</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">   public void processMenuSeparators(MetaObject metaObject)</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">   public void processTabPages(MetaObject metaObject)</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">   public void processPlacement(MetaObject object) </div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">   public void processCreateLayout(MetaObject object) </div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">   public void updateDisplayLayer(MetaObject object, int layerIndex)</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">   public void propertyEditedRepaint(MetaObject object) </div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">   public void processDeleteObject(MetaObject object) </div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">   public boolean getAttachedToDesigner() </div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">   public void processProjectChangedState(boolean hasProjectChanged)</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">   public void processObjectNameChanged(MetaObject object) </div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">   public void runProject() </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Too Many Responsibilities</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfa9" class="pf w1 h2" data-page-no="a9"><div class="pc pca9 w1 h2"><img class="bi xd y3cd wc h75" alt="" src="bga9.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">138<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 x74 h14 ybef ff8 fs3 fc0 sc0 ls0 ws0">But what if </div><div class="t m5 x24 h2f y39d ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 x84 h14 y39d ff8 fs3 fc0 sc0 ls0 ws0"> contained onl<span class="_ _4"></span>y the methods shown in Listing 10-2?</div><div class="t m0 x74 h14 y29e ff8 fs3 fc0 sc0 ls0 ws592">Fi<span class="_ _4"></span>ve methods isn’<span class="_ _1"></span>t too much, is it? In this case it is because despite its small number</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws0">of methods, </div><div class="t m5 xc3 h2f y29f ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 xc7 h14 y29f ff8 fs3 fc0 sc0 ls0 ws0"> has too man<span class="_ _4"></span>y <span class="ffa">responsibilities</span>.</div><div class="t m0 x74 h14 y25d ff8 fs3 fc0 sc0 ls12 ws2e2">The name of a class should describe what responsibilities it fulﬁlls. In fact, naming</div><div class="t m0 xd h14 y25e ff8 fs3 fc0 sc0 ls12 ws593">is probabl<span class="_ _4"></span>y the ﬁrst w<span class="_ _4"></span>ay of helping determine class size. If w<span class="_ _4"></span>e cannot deriv<span class="_ _4"></span>e a concise</div><div class="t m0 xd h14 y25f ff8 fs3 fc0 sc0 ls12 ws53b">name for a class, then it’<span class="_ _2"></span>s likel<span class="_ _4"></span>y too large. <span class="_ _1"></span>The more ambiguous the class name, the more</div><div class="t m0 xd h14 y819 ff8 fs3 fc0 sc0 ls12 ws498">likel<span class="_ _4"></span>y it has too many responsibilities. F<span class="_ _1"></span>or example, class names including w<span class="_ _4"></span>easel w<span class="_ _4"></span>ords</div><div class="t m0 xd h14 yc67 ff8 fs3 fc0 sc0 ls12 ws0">like </div><div class="t m5 xd7 h2f y375 ffb fs10 fc0 sc0 ls5d ws0">Processor</div><div class="t m0 x6 h14 y375 ff8 fs3 fc0 sc0 ls12 ws0">or</div><div class="t m5 xc6 h2f y375 ffb fs10 fc0 sc0 ls5d ws0">Manager</div><div class="t m0 x84 h14 y375 ff8 fs3 fc0 sc0 ls12 ws0">or</div><div class="t m5 x5b h2f y375 ffb fs10 fc0 sc0 ls5d ws0">Super</div><div class="t m0 xc4 h14 y375 ff8 fs3 fc0 sc0 ls5e ws594">often hint at unfortunate agg<span class="_ _8"></span>regation of</div><div class="t m0 xd h14 y376 ff8 fs3 fc0 sc0 ls5e ws0">responsibilities.</div><div class="t m0 x74 h14 y37b ff8 fs3 fc0 sc0 ls0 ws3aa">W<span class="_ _0"></span>e should also be able to write a brief description of the class in about 25 w<span class="_ _1"></span>ords,</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 lsd ws595">without using the w<span class="_ _4"></span>ords “if,<span class="_ _1"></span>” “and<span class="_ _1"></span>,<span class="_ _4"></span>” “or<span class="_ _4"></span>,<span class="_ _1"></span>” or “but.<span class="_ _1"></span>” Ho<span class="_ _4"></span>w w<span class="_ _4"></span>ould we describe the</div><div class="t m5 xd h2f y37d ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 xe h14 y37d ff8 fs3 fc0 sc0 ls0 wsa7">? “The </div><div class="t m5 x4 h2f y37d ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 x31 h14 y37d ff8 fs3 fc0 sc0 ls0 wsa7">pro<span class="_ _4"></span>vides access to the component that last held the</div><div class="t m0 xd h14 y5b4 ff8 fs3 fc0 sc0 lsd ws596">focus, and it also allo<span class="_ _4"></span>ws us to track the version and build numbers.<span class="_ _0"></span>” <span class="_ _4"></span>The ﬁrst “and” is a</div><div class="t m0 xd h14 y42d ff8 fs3 fc0 sc0 ls0 ws0">hint that </div><div class="t m5 x9a h2f y42d ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 x6e h14 y42d ff8 fs3 fc0 sc0 ls0 ws0"> has too man<span class="_ _4"></span>y responsibilities.</div><div class="t m0 xd h11 yc68 ff1 fs7 fc0 sc0 ls0 ws0">The Single Responsibility Principle</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws576">The Single Responsibility Principle (SRP)</div><div class="t m0 x4b h21 y3e5 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x9d h14 y397 ff8 fs3 fc0 sc0 ls0 ws576">states that a class or module should ha<span class="_ _4"></span>ve one,</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws224">and onl<span class="_ _4"></span>y one, <span class="ffa">reason to c<span class="_ _4"></span>hange<span class="ff8">. <span class="_ _1"></span>This principle gives us both a deﬁnition of responsibility<span class="_ _0"></span>,</span></span></div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws597">and a guidelines for class size. Classes should ha<span class="_ _4"></span>ve one responsibility—one reason to</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">change.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">   public void setAçowDragging(boolean allowDragging) </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">   public boolean allowDragging() </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">   public boolean isCustomizing() </div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">   public void setTitle(String title) </div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">   public IdeMenuBar getIdeMenuBar() </div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">   public void showHelper(MetaObject metaObject, String propertyName)</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">   // ... many non-public methods follow ...</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y2ac ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-2 </div><div class="t m0 x74 h36 y27b ffc fs3 fc0 sc0 ls0 ws0">Small Enough?</div><div class="t m5 x74 h2f yc69 ffb fs10 fc0 sc0 ls0 ws0">public class SuperDashboard extends JFrame implements MetaDataUser</div><div class="t m5 x74 h2f yc6a ffb fs10 fc0 sc0 ls0 ws0">    public Component getLastFocusedComponent() </div><div class="t m5 x74 h2f yc6b ffb fs10 fc0 sc0 ls0 ws0">    public void setLastFocused(Component lastFocused) </div><div class="t m5 x74 h2f yc6c ffb fs10 fc0 sc0 ls0 ws0">    public int getMajorVersionNumber() </div><div class="t m5 x74 h2f yc6d ffb fs10 fc0 sc0 ls0 ws0">    public int getMinorVersionNumber() </div><div class="t m5 x74 h2f yc6e ffb fs10 fc0 sc0 ls0 ws0">    public int getBuildNumber() </div><div class="t m5 x74 h2f yc6f ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>Y<span class="_ _2"></span>ou can read much more about this principle in [PPP].</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Too Many Responsibilities</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:169.728010px;width:179.698000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfaa" class="pf w1 h2" data-page-no="aa"><div class="pc pcaa w1 h2"><img class="bi xd yc70 wc h7c" alt="" src="bgaa.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">139<span class="_ _10"></span><span class="ff1">Classes Should Be Small!</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws586">The seemingly small </div><div class="t m5 x7d h2f y194 ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 xdd h14 y194 ff8 fs3 fc0 sc0 ls0 ws586">class in Listing 10-2 has tw<span class="_ _4"></span>o reasons to change.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws4dd">First, it tracks v<span class="_ _4"></span>ersion infor<span class="_ _8"></span>mation that w<span class="_ _4"></span>ould seemingly need to be updated e<span class="_ _4"></span>very time the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws2c8">softw<span class="_ _4"></span>are gets shipped. Second<span class="_ _4"></span>, it manages Ja<span class="_ _4"></span>va Swing components (it is a deri<span class="_ _4"></span>vati<span class="_ _4"></span>ve of</div><div class="t m5 xd h2f y197 ffb fs10 fc0 sc0 ls0 ws0">JFrame</div><div class="t m0 x3e h14 y197 ff8 fs3 fc0 sc0 ls0 ws598">, the Swing representation of a top-le<span class="_ _4"></span>vel GUI windo<span class="_ _4"></span>w). No doubt w<span class="_ _4"></span>e’ll w<span class="_ _4"></span>ant to</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws401">update the version number if w<span class="_ _1"></span>e change any of the Swing code, but the con<span class="_ _4"></span>verse isn’<span class="_ _1"></span>t nec-</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws599">essarily true: <span class="_ _4"></span>W<span class="_ _0"></span>e might change the version information based on changes to other code in</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">the system.</div><div class="t m0 x74 h14 y19b ff8 fs3 fc0 sc0 ls12 ws59a">T<span class="_ _4"></span>r<span class="_ _8"></span>ying to identify responsibilities (reasons to change) often helps us recognize and</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls12 ws59b">create better abstractions in our code. <span class="_ _4"></span>W<span class="_ _0"></span>e can easily extract all three </div><div class="t m5 x6f h2f y19c ffb fs10 fc0 sc0 ls5d ws0">SuperDashboard</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls12 ws59c">methods that deal with version information into a separate class named </div><div class="t m5 xbd h2f y19d ffb fs10 fc0 sc0 ls5d ws0">Version.</div><div class="t m0 x2d h14 y19d ff8 fs3 fc0 sc0 ls12 ws0">(See</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls12 ws468">Listing 10-3.) <span class="_ _1"></span>The </div><div class="t m5 x4d h2f y19e ffb fs10 fc0 sc0 ls5d ws0">Version</div><div class="t m0 xc7 h14 y19e ff8 fs3 fc0 sc0 ls12 ws468">class is a construct that has a high potential for reuse in other</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls12 ws0">applications!</div><div class="t m0 x74 h14 y9d3 ff8 fs3 fc0 sc0 ls0 wsba">SRP is one of the more important concept in OO design. It’<span class="_ _2"></span>s also one of the simpler</div><div class="t m0 xd h14 y9d4 ff8 fs3 fc0 sc0 lsd ws406">concepts to understand and adhere to. <span class="_ _0"></span>Y<span class="_ _2"></span>et oddl<span class="_ _4"></span>y<span class="_ _1"></span>, SRP is often the most abused class design</div><div class="t m0 xd h14 y51f ff8 fs3 fc0 sc0 ls0 ws0">principle. <span class="_ _4"></span>W<span class="_ _0"></span>e regularly encounter classes that do far too man<span class="_ _4"></span>y things. <span class="_ _4"></span>Why?</div><div class="t m0 x74 h14 yc71 ff8 fs3 fc0 sc0 ls0 ws584">Getting software to w<span class="_ _1"></span>ork and making software clean are tw<span class="_ _1"></span>o very different acti<span class="_ _4"></span>vities.</div><div class="t m0 xd h14 yc72 ff8 fs3 fc0 sc0 ls0 ws59d">Most of us ha<span class="_ _4"></span>ve limited room in our heads, so w<span class="_ _4"></span>e focus on getting our code to w<span class="_ _4"></span>ork more</div><div class="t m0 xd h14 y9d5 ff8 fs3 fc0 sc0 lsc ws80">than organization and cleanliness. <span class="_ _1"></span>This is wholl<span class="_ _4"></span>y appropriate. Maintaining a separation of</div><div class="t m0 xd h14 y9d6 ff8 fs3 fc0 sc0 ls0 ws0">concerns is just as impor<span class="_ _8"></span>tant in our programming <span class="ffa">activities</span> as it is in our programs.</div><div class="t m0 x74 h14 y35f ff8 fs3 fc0 sc0 ls0 ws437">The problem is that too man<span class="_ _4"></span>y of us think that w<span class="_ _4"></span>e are done once the program w<span class="_ _4"></span>orks.</div><div class="t m0 xd h14 y360 ff8 fs3 fc0 sc0 ls0 wsdb">W<span class="_ _0"></span>e fail to switch to the <span class="ffa ws0">other </span><span class="lsc ws422">concer<span class="_ _8"></span>n of organization and cleanliness. <span class="_ _4"></span>W<span class="_ _0"></span>e mo<span class="_ _4"></span>ve on to the</span></div><div class="t m0 xd h14 y361 ff8 fs3 fc0 sc0 ls0 ws59e">next prob<span class="_ _4"></span>lem rather than going back and breaking the o<span class="_ _4"></span>verstuf<span class="_ _4"></span>fed classes into decoupled</div><div class="t m0 xd h14 yc73 ff8 fs3 fc0 sc0 ls0 ws0">units with single responsibilities.</div><div class="t m0 x74 h14 yc74 ff8 fs3 fc0 sc0 ls0 ws592">At the same time, many de<span class="_ _1"></span>velopers fear that a large number of small, single-purpose</div><div class="t m0 xd h14 yc75 ff8 fs3 fc0 sc0 ls0 ws3c7">classes makes it more dif<span class="_ _4"></span>ﬁcult to understand the bigger picture. <span class="_ _4"></span>They are concerned that</div><div class="t m0 xd h14 yc76 ff8 fs3 fc0 sc0 lsc ws40">they must na<span class="_ _1"></span>vigate from class to class in order to ﬁgure out how a lar<span class="_ _4"></span>ger piece of w<span class="_ _4"></span>ork gets</div><div class="t m0 xd h14 yc77 ff8 fs3 fc0 sc0 ls0 ws0">accomplished.</div><div class="t m0 x74 h14 y8a6 ff8 fs3 fc0 sc0 ls0 ws3db">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, a system with man<span class="_ _4"></span>y small classes has no more mo<span class="_ _1"></span>ving par<span class="_ _8"></span>ts than a system</div><div class="t m0 xd h14 yc78 ff8 fs3 fc0 sc0 ls0 ws3c4">with a fe<span class="_ _4"></span>w large classes. <span class="_ _1"></span>There is just as much to lear<span class="_ _8"></span>n in the system with a few large</div><div class="t m0 xd h14 y64a ff8 fs3 fc0 sc0 lsc ws531">classes. So the question is: Do you w<span class="_ _4"></span>ant your tools or<span class="_ _4"></span>ganized into toolbox<span class="_ _4"></span>es with man<span class="_ _4"></span>y</div><div class="t m0 xd h14 y8b9 ff8 fs3 fc0 sc0 ls0 ws63">small dra<span class="_ _4"></span>w<span class="_ _4"></span>ers each containing well-deﬁned and w<span class="_ _1"></span>ell-labeled components? Or do you w<span class="_ _4"></span>ant</div><div class="t m0 xd h14 yc79 ff8 fs3 fc0 sc0 ls0 ws0">a fe<span class="_ _4"></span>w draw<span class="_ _1"></span>ers that you just toss e<span class="_ _4"></span>verything into?</div><div class="t m0 x74 h14 yc7a ff8 fs3 fc0 sc0 ls0 ws1fb">Every sizable system will contain a lar<span class="_ _4"></span>ge amount of logic and comple<span class="_ _4"></span>xity<span class="_ _1"></span>. <span class="_ _4"></span>The pri-</div><div class="t m0 xd h14 yc7b ff8 fs3 fc0 sc0 ls0 ws59d">mary goal in managing such complexity is to <span class="ffa ws0">org<span class="_ _4"></span>anize <span class="ff8 ws59d">it so that a developer kno<span class="_ _1"></span>ws where</span></span></div><div class="t m0 x74 h1c ya45 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-3 </div><div class="t m0 x74 h36 y1a2 ffc fs3 fc0 sc0 ls0 ws0">A single-responsibility class</div><div class="t m5 x74 h2f yc7c ffb fs10 fc0 sc0 ls0 ws0">public class Version {</div><div class="t m5 x74 h2f yc7d ffb fs10 fc0 sc0 ls0 ws0">    public int getMajorVersionNumber() </div><div class="t m5 x74 h2f yc7e ffb fs10 fc0 sc0 ls0 ws0">    public int getMinorVersionNumber() </div><div class="t m5 x74 h2f yc7f ffb fs10 fc0 sc0 ls0 ws0">    public int getBuildNumber() </div><div class="t m5 x74 h2f yc80 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfab" class="pf w1 h2" data-page-no="ab"><div class="pc pcab w1 h2"><img class="bi xd yc81 wc h4e" alt="" src="bgab.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">140<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws48">to look to ﬁnd things and need onl<span class="_ _4"></span>y understand the directly af<span class="_ _4"></span>fected complexity at an<span class="_ _4"></span>y</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws56f">gi<span class="_ _4"></span>ven time. In contrast, a system with larger<span class="_ _1"></span>, multipur<span class="_ _8"></span>pose classes alw<span class="_ _4"></span>a<span class="_ _4"></span>ys hampers us by</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">insisting w<span class="_ _4"></span>e wade through lots of things w<span class="_ _1"></span>e don’<span class="_ _4"></span>t need to know right no<span class="_ _1"></span>w<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws46c">T<span class="_ _0"></span>o restate the for<span class="_ _8"></span>mer points for emphasis: W<span class="_ _0"></span>e w<span class="_ _4"></span>ant our systems to be composed of</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 wsaa">many small classes, not a fe<span class="_ _1"></span>w large ones. Each small class encapsulates a single responsi-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws3ed">bility<span class="_ _0"></span>, has a single reason to change, and collaborates with a few others to achie<span class="_ _4"></span>ve the</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">desired system beha<span class="_ _4"></span>viors.</div><div class="t m0 xd h11 yc82 ff1 fs7 fc0 sc0 ls0 ws0">Cohesion</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws98">Classes should ha<span class="_ _4"></span>ve a small number of instance v<span class="_ _4"></span>ariables. Each of the methods of a class</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws2da">should manipulate one or more of those variab<span class="_ _4"></span>les. In general the more v<span class="_ _4"></span>ariables a method</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws30">manipulates the more cohesi<span class="_ _4"></span>ve that method is to its class. <span class="_ _1"></span>A class in which each variab<span class="_ _4"></span>le is</div><div class="t m0 xd h14 y6ce ff8 fs3 fc0 sc0 ls0 ws0">used by each method is maximall<span class="_ _1"></span>y cohesive. </div><div class="t m0 x74 h14 y2af ff8 fs3 fc0 sc0 ls0 ws59f">In general it is neither advisable nor possib<span class="_ _4"></span>le to create such maximally cohesi<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y8fb ff8 fs3 fc0 sc0 ls0 ws5a0">classes; on the other hand<span class="_ _1"></span>, we w<span class="_ _1"></span>ould like cohesion to be high. <span class="_ _4"></span>When cohesion is high, it</div><div class="t m0 xd h14 y8fc ff8 fs3 fc0 sc0 ls0 ws5a1">means that the methods and v<span class="_ _4"></span>ariables of the class are co-dependent and hang to<span class="_ _4"></span>gether as a</div><div class="t m0 xd h14 y9a1 ff8 fs3 fc0 sc0 ls0 ws0">lo<span class="_ _4"></span>gical whole.</div><div class="t m0 x74 h14 ya80 ff8 fs3 fc0 sc0 ls0 ws269">Consider the implementation of a </div><div class="t m5 x31 h2f y2c2 ffb fs10 fc0 sc0 ls0 ws0">Stack</div><div class="t m0 x67 h14 y2c2 ff8 fs3 fc0 sc0 ls0 ws269">in Listing 10-4. <span class="_ _1"></span>This is a ver<span class="_ _8"></span>y cohesiv<span class="_ _4"></span>e class.</div><div class="t m0 xd h14 y2c3 ff8 fs3 fc0 sc0 ls0 ws0">Of the three methods onl<span class="_ _4"></span>y </div><div class="t m5 xa4 h2f y2c3 ffb fs10 fc0 sc0 ls0 ws0">size()</div><div class="t m0 xec h14 y2c3 ff8 fs3 fc0 sc0 ls0 ws0"> fails to use both the variab<span class="_ _4"></span>les. </div><div class="t m0 x74 h14 y67c ff8 fs3 fc0 sc0 ls0 ws5a2">The strategy of keeping functions small and k<span class="_ _4"></span>eeping parameter lists shor<span class="_ _8"></span>t can some-</div><div class="t m0 xd h14 yc83 ff8 fs3 fc0 sc0 ls0 wsd1">times lead to a proliferation of instance variab<span class="_ _4"></span>les that are used b<span class="_ _4"></span>y a subset of methods.</div><div class="t m0 xd h14 yc84 ff8 fs3 fc0 sc0 ls0 ws2e1">When this happens, it almost al<span class="_ _4"></span>wa<span class="_ _1"></span>ys means that there is at least one other class tr<span class="_ _8"></span>ying to</div><div class="t m0 x74 h1c y412 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-4 </div><div class="t m0 x74 h1c y468 ffc fs3 fc0 sc0 ls0 ws0">Stack.java <span class="ff1">A cohesiv<span class="_ _4"></span>e class.</span></div><div class="t m5 x74 h2f yc85 ffb fs10 fc0 sc0 ls0 ws0">public class Stack {</div><div class="t m5 x74 h2f yc86 ffb fs10 fc0 sc0 ls0 ws0">  private int topOfStack = 0;</div><div class="t m5 x74 h2f yc87 ffb fs10 fc0 sc0 ls0 ws0">  List&lt;Integer&gt; elements = new LinkedList&lt;Integer&gt;();</div><div class="t m5 x74 h2f yc88 ffb fs10 fc0 sc0 ls0 ws0">  public int size() {</div><div class="t m5 x74 h2f yc89 ffb fs10 fc0 sc0 ls0 ws0">    return topOfStack;</div><div class="t m5 x74 h2f yc8a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc8b ffb fs10 fc0 sc0 ls0 ws0">  public void push(int element) {</div><div class="t m5 x74 h2f yc8c ffb fs10 fc0 sc0 ls0 ws0">    topOfStack++;</div><div class="t m5 x74 h2f yc8d ffb fs10 fc0 sc0 ls0 ws0">    elements.add(element);</div><div class="t m5 x74 h2f yc8e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc8f ffb fs10 fc0 sc0 ls0 ws0">  public int pop() throws PoppedWhenEmpty {</div><div class="t m5 x74 h2f yc90 ffb fs10 fc0 sc0 ls0 ws0">    if (topOfStack == 0)</div><div class="t m5 x74 h2f yc91 ffb fs10 fc0 sc0 ls0 ws0">      throw new PoppedWhenEmpty();</div><div class="t m5 x74 h2f yc92 ffb fs10 fc0 sc0 ls0 ws0">    int element = elements.get(--topOfStack);</div><div class="t m5 x74 h2f yc93 ffb fs10 fc0 sc0 ls0 ws0">    elements.remove(topOfStack);</div><div class="t m5 x74 h2f yc94 ffb fs10 fc0 sc0 ls0 ws0">    return element;</div><div class="t m5 x74 h2f yc95 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc96 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:483.728010px;width:47.340000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfac" class="pf w1 h2" data-page-no="ac"><div class="pc pcac w1 h2"><img class="bi xd y3cd wc h7d" alt="" src="bgac.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">141<span class="_ _10"></span><span class="ff1">Classes Should Be Small!</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws5a3">get out of the larger class. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should tr<span class="_ _8"></span>y to separate the variab<span class="_ _4"></span>les and methods into tw<span class="_ _4"></span>o or</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">more classes such that the new classes are more cohesi<span class="_ _1"></span>ve.</div><div class="t m0 xd h11 y56c ff1 fs7 fc0 sc0 ls0 ws0">Maintaining Cohesion Results in Man<span class="_ _4"></span>y Small Classes</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws5a4">Just the act of breaking large functions into smaller functions causes a proliferation of</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws102">classes. Consider a large function with man<span class="_ _4"></span>y variab<span class="_ _4"></span>les declared within it. Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y you</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws5a5">w<span class="_ _4"></span>ant to extract one small part of that function into a separate function. How<span class="_ _1"></span>ever<span class="_ _1"></span>, the code</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws3c3">you w<span class="_ _4"></span>ant to extract uses four of the v<span class="_ _4"></span>ariables declared in the function. Must y<span class="_ _4"></span>ou pass all</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws0">four of those v<span class="_ _4"></span>ariables into the ne<span class="_ _4"></span>w function as arguments?</div><div class="t m0 x74 h14 y2ab ff8 fs3 fc0 sc0 ls0 ws5a6">Not at all! If w<span class="_ _4"></span>e promoted those four variab<span class="_ _4"></span>les to instance variab<span class="_ _4"></span>les of the class, then</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws328">w<span class="_ _4"></span>e could extract the code without passing <span class="ffa ws0">any<span class="_ _18"> </span></span>v<span class="_ _4"></span>ariables at all. It w<span class="_ _4"></span>ould be <span class="ffa ws0">easy<span class="_ _18"> </span></span>to break</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc0 sc0 ls0 ws0">the function up into small pieces.</div><div class="t m0 x74 h14 y2ae ff8 fs3 fc0 sc0 ls0 wsdf">Unfortunately<span class="_ _0"></span>, this also means that our classes lose cohesion because they accumulate</div><div class="t m0 xd h14 y2af ff8 fs3 fc0 sc0 ls0 ws584">more and more instance v<span class="_ _4"></span>ariables that exist solel<span class="_ _4"></span>y to allo<span class="_ _4"></span>w a few functions to share them.</div><div class="t m0 xd h14 y8fb ff8 fs3 fc0 sc0 ls0 ws38d">But wait! If there are a fe<span class="_ _1"></span>w functions that want to share certain variab<span class="_ _4"></span>les, doesn’<span class="_ _4"></span>t that</div><div class="t m0 xd h14 y8fc ff8 fs3 fc0 sc0 ls0 ws29c">make them a class in their o<span class="_ _1"></span>wn right? Of course it does. When classes lose cohesion, split</div><div class="t m0 xd h14 y9a1 ff8 fs3 fc0 sc0 ls0 ws0">them!</div><div class="t m0 x74 h14 ya80 ff8 fs3 fc0 sc0 ls0 ws279">So breaking a large function into man<span class="_ _4"></span>y smaller functions often giv<span class="_ _4"></span>es us the oppor<span class="_ _8"></span>tu-</div><div class="t m0 xd h14 yc97 ff8 fs3 fc0 sc0 lsc ws498">nity to split se<span class="_ _4"></span>veral smaller classes out as w<span class="_ _4"></span>ell. <span class="_ _4"></span>This giv<span class="_ _4"></span>es our program a much better orga-</div><div class="t m0 xd h14 yc98 ff8 fs3 fc0 sc0 ls0 ws0">nization and a more transparent structure.</div><div class="t m0 x74 h14 yc99 ff8 fs3 fc0 sc0 ls0 ws4d">As a demonstration of what I mean, let’<span class="_ _3"></span>s use a time-honored example taken from</div><div class="t m0 xd h14 y63b ff8 fs3 fc0 sc0 ls0 ws30">Knuth’<span class="_ _2"></span>s w<span class="_ _4"></span>onderful book <span class="ffa">Liter<span class="_ _4"></span>ate Pr<span class="_ _4"></span>ogr<span class="_ _1"></span>amming.</span></div><div class="t m0 x68 h21 y413 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x42 h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws30">Listing 10-5 sho<span class="_ _4"></span>ws a translation into Ja<span class="_ _4"></span>va</div><div class="t m0 xd h14 y2c7 ff8 fs3 fc0 sc0 ls0 ws35">of Knuth’<span class="_ _2"></span>s </div><div class="t m5 x46 h2f y2c7 ffb fs10 fc0 sc0 ls0 ws0">PrintPrimes</div><div class="t m0 xd0 h14 y2c7 ff8 fs3 fc0 sc0 ls0 ws35"> program. <span class="_ _1"></span>T<span class="_ _1"></span>o be fair to Knuth, this is not the program as he wrote it</div><div class="t m0 xd h14 y2c8 ff8 fs3 fc0 sc0 lsd ws5a7">but rather as it was output b<span class="_ _1"></span>y his WEB tool. I’m using it because it makes a great starting</div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">place for breaking up a big function into man<span class="_ _4"></span>y smaller functions and classes.</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>[Knuth92].</div><div class="t m0 x74 h1c y6d8 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-5 </div><div class="t m0 x74 h36 yc9a ffc fs3 fc0 sc0 ls0 ws0">PrintPrimes.java</div><div class="t m5 x74 h2f yc9b ffb fs10 fc0 sc0 ls0 ws0">package literatePrimes;</div><div class="t m5 x74 h2f yc9c ffb fs10 fc0 sc0 ls0 ws0">public class PrintPrimes {</div><div class="t m5 x74 h2f yc9d ffb fs10 fc0 sc0 ls0 ws0">  public static void main(String[] args) {</div><div class="t m5 x74 h2f yc9e ffb fs10 fc0 sc0 ls0 ws0">    final int M = 1000;</div><div class="t m5 x74 h2f yc9f ffb fs10 fc0 sc0 ls0 ws0">    final int RR = 50;</div><div class="t m5 x74 h2f yca0 ffb fs10 fc0 sc0 ls0 ws0">    final int CC = 4;</div><div class="t m5 x74 h2f yca1 ffb fs10 fc0 sc0 ls0 ws0">    final int WW = 10;</div><div class="t m5 x74 h2f yca2 ffb fs10 fc0 sc0 ls0 ws0">    final int ORDMAX = 30;</div><div class="t m5 x74 h2f yca3 ffb fs10 fc0 sc0 ls0 ws0">    int P[] = new int[M + 1];</div><div class="t m5 x74 h2f yca4 ffb fs10 fc0 sc0 ls0 ws0">    int PAGENUMBER;</div><div class="t m5 x74 h2f yca5 ffb fs10 fc0 sc0 ls0 ws0">    int PAGEOFFSET;</div><div class="t m5 x74 h2f yca6 ffb fs10 fc0 sc0 ls0 ws0">    int ROWOFFSET;</div><div class="t m5 x74 h2f yca7 ffb fs10 fc0 sc0 ls0 ws0">    int C;</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:546.728010px;width:272.220000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfad" class="pf w1 h2" data-page-no="ad"><div class="pc pcad w1 h2"><img class="bi xd yca8 wc h7e" alt="" src="bgad.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">142<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    int J;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    int K;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    boolean JPRIME;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    int ORD;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    int SQUARE;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    int N;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    int MULT[] = new int[ORDMAX + 1];</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    J = 1;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    K = 1;</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    P[1] = 2;</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    ORD = 2;</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    SQUARE = 9;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    while (K &lt; M) {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      do {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">        J = J + 2;</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">        if (J == SQUARE) {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">          ORD = ORD + 1;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">          SQUARE = P[ORD] * P[ORD];</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">          MULT[ORD - 1] = J;</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">        N = 2;</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">        JPRIME = true;</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">        while (N &lt; ORD &amp;&amp; JPRIME) {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">          while (MULT[N] &lt; J)</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">            MULT[N] = MULT[N] + P[N] + P[N];</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">          if (MULT[N] == J)</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">            JPRIME = false;</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">          N = N + 1;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">      } while (!JPRIME);</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      K = K + 1;</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      P[K] = J;</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">      PAGENUMBER = 1;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      PAGEOFFSET = 1;</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">      while (PAGEOFFSET &lt;= M) {</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">        System.out.println(&quot;The First &quot; + M + </div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls3c ws253">                             &quot; Prime Numbers --- Page &quot; + PAGENUMBER);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">        System.out.println(&quot;&quot;);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">        for (ROWOFFSET = PAGEOFFSET; ROWOFFSET &lt; PAGEOFFSET + RR; ROWOFFSET++){</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">          for (C = 0; C &lt; CC;C++)</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">            if (ROWOFFSET + C * RR &lt;= M)</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">              System.out.format(&quot;%10d&quot;, P[ROWOFFSET + C * RR]);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">          System.out.println(&quot;&quot;);</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">        System.out.println(&quot;\f&quot;);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">        PAGENUMBER = PAGENUMBER + 1;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">        PAGEOFFSET = PAGEOFFSET + RR * CC;</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">PrintPrimes.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfae" class="pf w1 h2" data-page-no="ae"><div class="pc pcae w1 h2"><img class="bi xd yca9 wc h7f" alt="" src="bgae.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">143<span class="_ _10"></span><span class="ff1">Classes Should Be Small!</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws239">This program, written as a single function, is a mess. It has a deepl<span class="_ _4"></span>y indented str<span class="_ _8"></span>uc-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws17e">ture, a plethora of odd variab<span class="_ _4"></span>les, and a tightl<span class="_ _4"></span>y coupled str<span class="_ _8"></span>ucture. <span class="_ _4"></span>At the very least, the one</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">big function should be split up into a few smaller functions.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws5a8">Listing 10-6 through Listing 10-8 sho<span class="_ _4"></span>w the result of splitting the code in Listing 10-5</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws5a9">into smaller classes and functions, and choosing meaningful names for those classes, func-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">tions, and variab<span class="_ _4"></span>les.   </div><div class="t m0 x74 h1c ycaa ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-6 </div><div class="t m0 x74 h36 y19c ffc fs3 fc0 sc0 ls0 ws0">PrimePrinter.java (refactored)</div><div class="t m5 x74 h2f y7e4 ffb fs10 fc0 sc0 ls0 ws0">package literatePrimes;</div><div class="t m5 x74 h2f y7e6 ffb fs10 fc0 sc0 ls0 ws0">public class PrimePrinter {</div><div class="t m5 x74 h2f y7e7 ffb fs10 fc0 sc0 ls0 ws0">  public static void main(String[] args) {</div><div class="t m5 x74 h2f y7e8 ffb fs10 fc0 sc0 ls0 ws0">    final int NUMBER_OF_PRIMES = 1000;</div><div class="t m5 x74 h2f y7e9 ffb fs10 fc0 sc0 ls0 ws0">    int[] primes = PrimeGenerator.generate(NUMBER_OF_PRIMES);</div><div class="t m5 x74 h2f y7eb ffb fs10 fc0 sc0 ls0 ws0">    final int ROWS_PER_PAGE = 50;</div><div class="t m5 x74 h2f y7ec ffb fs10 fc0 sc0 ls0 ws0">    final int COLUMNS_PER_PAGE = 4;</div><div class="t m5 x74 h2f y7ed ffb fs10 fc0 sc0 ls0 ws0">    RowColumnPagePrinter tablePrinter =</div><div class="t m5 x74 h2f y7ee ffb fs10 fc0 sc0 ls0 ws0">      new RowColumnPagePrinter(ROWS_PER_PAGE,</div><div class="t m5 x74 h2f y7ef ffb fs10 fc0 sc0 ls0 ws0">                               COLUMNS_PER_PAGE,</div><div class="t m5 x32 h2f y7f0 ffb fs10 fc0 sc0 ls43 ws0">&quot;The First &quot; + NUMBER_OF_PRIMES + </div><div class="t m5 x74 h2f y7f1 ffb fs10 fc0 sc0 ls4c ws423">                                 &quot; Prime Numbers&quot;);</div><div class="t m5 x74 h2f y7f3 ffb fs10 fc0 sc0 ls0 ws0">    tablePrinter.print(primes);</div><div class="t m5 x74 h2f y7f4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y7f6 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y74f ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-7 </div><div class="t m0 x74 h36 y59f ffc fs3 fc0 sc0 ls0 ws0">RowColumnPagePrinter.java</div><div class="t m5 x74 h2f y750 ffb fs10 fc0 sc0 ls0 ws0">package literatePrimes;</div><div class="t m5 x74 h2f ycab ffb fs10 fc0 sc0 ls0 ws0">import java.io.PrintStream;</div><div class="t m5 x74 h2f ycac ffb fs10 fc0 sc0 ls0 ws0">public class RowColumnPagePrinter {</div><div class="t m5 x74 h2f ycad ffb fs10 fc0 sc0 ls0 ws0">  private int rowsPerPage;</div><div class="t m5 x74 h2f ycae ffb fs10 fc0 sc0 ls0 ws0">  private int columnsPerPage;</div><div class="t m5 x74 h2f ycaf ffb fs10 fc0 sc0 ls0 ws0">  private int numbersPerPage;</div><div class="t m5 x74 h2f ycb0 ffb fs10 fc0 sc0 ls0 ws0">  private String pageHeader;</div><div class="t m5 x74 h2f ycb1 ffb fs10 fc0 sc0 ls0 ws0">  private PrintStream printStream;</div><div class="t m5 x74 h2f ycb2 ffb fs10 fc0 sc0 ls0 ws0">  public RowColumnPagePrinter(int rowsPerPage,</div><div class="t m5 x74 h2f ycb3 ffb fs10 fc0 sc0 ls0 ws0">                              int columnsPerPage,</div><div class="t m5 x74 h2f ycb4 ffb fs10 fc0 sc0 ls0 ws0">                              String pageHeader) {</div><div class="t m5 x74 h2f ycb5 ffb fs10 fc0 sc0 ls0 ws0">    this.rowsPerPage = rowsPerPage;</div><div class="t m5 x74 h2f ycb6 ffb fs10 fc0 sc0 ls0 ws0">    this.columnsPerPage = columnsPerPage;</div><div class="t m5 x74 h2f ycb7 ffb fs10 fc0 sc0 ls0 ws0">    this.pageHeader = pageHeader;</div><div class="t m5 x74 h2f ycb8 ffb fs10 fc0 sc0 ls0 ws0">    numbersPerPage = rowsPerPage * columnsPerPage;</div><div class="t m5 x74 h2f ycb9 ffb fs10 fc0 sc0 ls0 ws0">    printStream = System.out;</div><div class="t m5 x74 h2f ycba ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfaf" class="pf w1 h2" data-page-no="af"><div class="pc pcaf w1 h2"><img class="bi xd ycbb wc h80" alt="" src="bgaf.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">144<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public void print(int data[]) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    int pageNumber = 1;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    for (int firstIndexOnPage = 0;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">         firstIndexOnPage &lt; data.length;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">         firstIndexOnPage += numbersPerPage) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      int lastIndexOnPage = </div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">        Math.min(firstIndexOnPage + numbersPerPage - 1, </div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">                 data.length - 1);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      printPageHeader(pageHeader, pageNumber);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      printPage(firstIndexOnPage, lastIndexOnPage, data);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      printStream.println(&quot;\f&quot;);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      pageNumber++;</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  private void printPage(int firstIndexOnPage,</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">                         int lastIndexOnPage,</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">                         int[] data) {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    int firstIndexOfLastRowOnPage = </div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      firstIndexOnPage + rowsPerPage - 1;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    for (int firstIndexInRow = firstIndexOnPage; </div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">         firstIndexInRow &lt;= firstIndexOfLastRowOnPage; </div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">         firstIndexInRow++) {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      printRow(firstIndexInRow, lastIndexOnPage, data);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      printStream.println(&quot;&quot;);</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  private void printRow(int firstIndexInRow, </div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">                        int lastIndexOnPage, </div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">                        int[] data) {</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    for (int column = 0; column &lt; columnsPerPage; column++) {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      int index = firstIndexInRow + column * rowsPerPage;</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      if (index &lt;= lastIndexOnPage)</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">        printStream.format(&quot;%10d&quot;, data[index]);</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  private void printPageHeader(String pageHeader, </div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">                               int pageNumber) {</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">    printStream.println(pageHeader + &quot; --- Page &quot; + pageNumber);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    printStream.println(&quot;&quot;);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  public void setOutput(PrintStream printStream) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    this.printStream = printStream;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">RowColumnPagePrinter.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb0" class="pf w1 h2" data-page-no="b0"><div class="pc pcb0 w1 h2"><img class="bi xd y3e9 wc h62" alt="" src="bgb0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">145<span class="_ _10"></span><span class="ff1">Classes Should Be Small!</span></div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-8 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">PrimeGenerator.java</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">package literatePrimes;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">import java.util.ArrayList;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">public class PrimeGenerator {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  private static int[] primes;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  private static ArrayList&lt;Integer&gt; multiplesOfPrimeFactors;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  protected static int[] generate(int n) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    primes = new int[n];</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    multiplesOfPrimeFactors = new ArrayList&lt;Integer&gt;();</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    set2AsFirstPrime();</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    checkOddNumbersForSubsequentPrimes();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    return primes;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  private static void set2AsFirstPrime() {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    primes[0] = 2;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    multiplesOfPrimeFactors.add(2);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  private static void checkOddNumbersForSubsequentPrimes() {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    int primeIndex = 1;</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    for (int candidate = 3;</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">         primeIndex &lt; primes.length;</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">         candidate += 2) {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      if (isPrime(candidate))</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">        primes[primeIndex++] = candidate;</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  private static boolean isPrime(int candidate) {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    if (isLeastRelevantMultipleOfNextLargerPrimeFactor(candidate)) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      multiplesOfPrimeFactors.add(candidate);</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    return isNotMultipleOfAnyPreviousPrimeFactor(candidate);</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">  private static boolean</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  isLeastRelevantMultipleOfNextLargerPrimeFactor(int candidate) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    int nextLargerPrimeFactor = primes[multiplesOfPrimeFactors.size()];</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    int leastRelevantMultiple = nextLargerPrimeFactor * nextLargerPrimeFactor;</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">    return candidate == leastRelevantMultiple;</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  private static boolean </div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">  isNotMultipleOfAnyPreviousPrimeFactor(int candidate) {</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">    for (int n = 1; n &lt; multiplesOfPrimeFactors.size(); n++) {</div><div class="t m5 x74 h2f y8ca ffb fs10 fc0 sc0 ls0 ws0">      if (isMultipleOfNthPrimeFactor(candidate, n))</div><div class="t m5 x74 h2f y8cb ffb fs10 fc0 sc0 ls0 ws0">        return false;</div><div class="t m5 x74 h2f y8cc ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb1" class="pf w1 h2" data-page-no="b1"><div class="pc pcb1 w1 h2"><img class="bi xd ycbc wc h81" alt="" src="bgb1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">146<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 x74 h14 ycbd ff8 fs3 fc0 sc0 ls12 ws291">The ﬁrst thing you might notice is that the pro<span class="_ _4"></span>gram got a lot longer<span class="_ _4"></span>. It w<span class="_ _4"></span>ent from a</div><div class="t m0 xd h14 ycbe ff8 fs3 fc0 sc0 ls12 ws2c8">little o<span class="_ _4"></span>ver one page to nearl<span class="_ _4"></span>y three pages in length. <span class="_ _4"></span>There are se<span class="_ _4"></span>veral reasons for this</div><div class="t m0 xd h14 ycbf ff8 fs3 fc0 sc0 ls12 ws5aa">growth. F<span class="_ _4"></span>irst, the refactored program uses longer<span class="_ _4"></span>, more descriptiv<span class="_ _4"></span>e variab<span class="_ _4"></span>le names.</div><div class="t m0 xd h14 ycc0 ff8 fs3 fc0 sc0 ls12 ws5ab">Second<span class="_ _1"></span>, the refactored program uses function and class declarations as a wa<span class="_ _4"></span>y to add</div><div class="t m0 xd h14 ycc1 ff8 fs3 fc0 sc0 ls12 ws186">commentary to the code. <span class="_ _4"></span>Third<span class="_ _4"></span>, w<span class="_ _4"></span>e used whitespace and formatting techniques to keep</div><div class="t m0 xd h14 ycc2 ff8 fs3 fc0 sc0 ls12 ws0">the program readable. </div><div class="t m0 x74 h14 ycc3 ff8 fs3 fc0 sc0 ls12 ws3d3">Notice ho<span class="_ _4"></span>w the program has been split into three main responsibilities. <span class="_ _1"></span>The main</div><div class="t m0 xd h14 ycc4 ff8 fs3 fc0 sc0 ls12 ws14b">program is contained in the </div><div class="t m5 x9b h2f ycc4 ffb fs10 fc0 sc0 ls5d ws0">PrimePrinter</div><div class="t m0 xb8 h14 ycc4 ff8 fs3 fc0 sc0 ls12 ws14b">class all by itself. Its responsibility is to handle</div><div class="t m0 xd h14 yb43 ff8 fs3 fc0 sc0 ls12 ws5ac">the ex<span class="_ _4"></span>ecution en<span class="_ _4"></span>vironment. It will change if the method of in<span class="_ _4"></span>vocation changes. F<span class="_ _1"></span>or</div><div class="t m0 xd h14 yb44 ff8 fs3 fc0 sc0 ls12 ws5ad">example, if this pro<span class="_ _4"></span>gram were con<span class="_ _1"></span>ver<span class="_ _8"></span>ted to a SO<span class="_ _1"></span>AP ser<span class="_ _8"></span>vice, this is the class that w<span class="_ _4"></span>ould</div><div class="t m0 xd h14 ycc5 ff8 fs3 fc0 sc0 ls12 ws0">be af<span class="_ _4"></span>fected.</div><div class="t m0 x74 h14 ycc6 ff8 fs3 fc0 sc0 ls16 ws0">The</div><div class="t m5 x8a h2f y37b ffb fs10 fc0 sc0 ls31 ws0">RowColumnPagePrinter</div><div class="t m0 x1c h14 y37b ff8 fs3 fc0 sc0 ls16 ws322">kno<span class="_ _4"></span>ws all about ho<span class="_ _4"></span>w to for<span class="_ _8"></span>mat a list of numbers into</div><div class="t m0 xd h14 y37c ff8 fs3 fc0 sc0 ls16 ws15e">pages with a certain number of rows and columns. If the formatting of the output needed</div><div class="t m0 xd h14 y37d ff8 fs3 fc0 sc0 ls16 ws0">changing, then this is the class that w<span class="_ _4"></span>ould be affected.</div><div class="t m0 x74 h14 y2cd ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y2cd ffb fs10 fc0 sc0 ls0 ws0">PrimeGenerator</div><div class="t m0 x15 h14 y2cd ff8 fs3 fc0 sc0 ls0 ws5ae">class kno<span class="_ _4"></span>ws ho<span class="_ _4"></span>w to generate a list prime numbers. Notice that it</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 ws5af">is <span class="_ _3"></span>not meant to be instantiated as an object. <span class="_ _4"></span>The class is just a useful scope in which</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 ws5b0">its <span class="_ _1"></span>variab<span class="_ _4"></span>les can be declared and kept hidden. <span class="_ _1"></span>This class will change if the algorithm for</div><div class="t m0 xd h14 y5d6 ff8 fs3 fc0 sc0 ls0 ws0">computing prime numbers changes. </div><div class="t m0 x74 h14 y2d1 ff8 fs3 fc0 sc0 ls0 wsc0">This w<span class="_ _4"></span>as not a rewrite! <span class="_ _4"></span>W<span class="_ _0"></span>e did not star<span class="_ _8"></span>t o<span class="_ _4"></span>ver from scratch and write the pro<span class="_ _4"></span>g<span class="_ _8"></span>ram o<span class="_ _4"></span>ver</div><div class="t m0 xd h14 y2d2 ff8 fs3 fc0 sc0 lsc ws5b1">again. Indeed<span class="_ _1"></span>, if you look closel<span class="_ _4"></span>y at the tw<span class="_ _4"></span>o different pro<span class="_ _4"></span>g<span class="_ _8"></span>rams, you’<span class="_ _1"></span>ll see that they use the</div><div class="t m0 xd h14 yaef ff8 fs3 fc0 sc0 ls0 ws0">same algorithm and mechanics to get their w<span class="_ _4"></span>ork done. </div><div class="t m0 x74 h14 ycc7 ff8 fs3 fc0 sc0 ls0 wsb5">The change was made b<span class="_ _1"></span>y writing a test suite that veriﬁed the <span class="ffa ws0">pr<span class="_ _4"></span>ecise<span class="_ _18"> </span><span class="ff8 wsb5">beha<span class="_ _4"></span>vior of the</span></span></div><div class="t m0 xd h14 ycc8 ff8 fs3 fc0 sc0 ls0 ws5b2">ﬁrst pro<span class="_ _4"></span>g<span class="_ _8"></span>ram. <span class="_ _4"></span>Then a m<span class="_ _4"></span>yriad of tiny little changes w<span class="_ _1"></span>ere made, one at a time. <span class="_ _4"></span>After each</div><div class="t m0 xd h14 ycc9 ff8 fs3 fc0 sc0 ls0 ws5b3">change the program w<span class="_ _4"></span>as ex<span class="_ _4"></span>ecuted to ensure that the behavior had not changed. One tin<span class="_ _4"></span>y</div><div class="t m0 xd h14 ycca ff8 fs3 fc0 sc0 ls0 ws0">step after another<span class="_ _4"></span>, the ﬁrst program w<span class="_ _4"></span>as cleaned up and transfor<span class="_ _8"></span>med into the second.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private static boolean </div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  isMultipleOfNthPrimeFactor(int candidate, int n) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return </div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls18 ws241">      candidate == smallestOddNthMultipleNotLessThanCandidate(candidate, n);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private static int </div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  smallestOddNthMultipleNotLessThanCandidate(int candidate, int n) {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    int multiple = multiplesOfPrimeFactors.get(n);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    while (multiple &lt; candidate)</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      multiple += 2 * primes[n];</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    multiplesOfPrimeFactors.set(n, multiple);</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    return multiple;</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">PrimeGenerator.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb2" class="pf w1 h2" data-page-no="b2"><div class="pc pcb2 w1 h2"><img class="bi xd yccb wc h82" alt="" src="bgb2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">147<span class="_ _10"></span><span class="ff1">Organizing f<span class="_ _1"></span>or Change</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Org<span class="_ _4"></span>anizing f<span class="_ _4"></span>or Change</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws5b4">F<span class="_ _1"></span>or most systems, change is continual. Ever<span class="_ _8"></span>y change subjects us to the risk that the</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 lsc ws4b8">remainder of the system no longer w<span class="_ _4"></span>orks as intended. In a clean system w<span class="_ _4"></span>e organize our</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws0">classes so as to reduce the risk of change.</div><div class="t m0 x74 h14 y460 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y460 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x41 h14 y460 ff8 fs3 fc0 sc0 ls0 ws25c">class in Listing 10-9 is used to generate properly formed SQL strings gi<span class="_ _4"></span>ven</div><div class="t m0 xd h14 y461 ff8 fs3 fc0 sc0 ls0 ws318">appropriate metadata. It’<span class="_ _2"></span>s a w<span class="_ _4"></span>ork in progress and<span class="_ _1"></span>, as such, doesn’<span class="_ _4"></span>t yet support SQL func-</div><div class="t m0 xd h14 y462 ff8 fs3 fc0 sc0 ls0 ws5b5">tionality like </div><div class="t m5 x28 h2f y462 ffb fs10 fc0 sc0 ls0 ws0">update</div><div class="t m0 x9 h14 y462 ff8 fs3 fc0 sc0 ls0 ws5b5">statements. <span class="_ _4"></span>When the time comes for the </div><div class="t m5 xb5 h2f y462 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x59 h14 y462 ff8 fs3 fc0 sc0 ls0 ws5b5">class to support an</div><div class="t m5 xd h2f y39c ffb fs10 fc0 sc0 ls0 ws0">update</div><div class="t m0 x1a h14 y39c ff8 fs3 fc0 sc0 ls0 ws48b">statement, w<span class="_ _4"></span>e’<span class="_ _4"></span>ll hav<span class="_ _4"></span>e to “open up” this class to make modiﬁcations. <span class="_ _1"></span>The problem</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws5b6">with opening a class is that it introduces risk. <span class="_ _1"></span>Any modiﬁcations to the class ha<span class="_ _4"></span>ve the</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls0 ws0">potential of breaking other code in the class. It must be fully retested.</div><div class="t m0 x74 h14 y827 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y608 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x41 h14 y608 ff8 fs3 fc0 sc0 ls0 ws1a">class must change when w<span class="_ _1"></span>e add a new type of statement. It also must change</div><div class="t m0 xd h14 y609 ff8 fs3 fc0 sc0 ls0 ws5b7">when w<span class="_ _1"></span>e alter the details of a single statement type—for example, if w<span class="_ _4"></span>e need to modify</div><div class="t m0 xd h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y81b ffb fs10 fc0 sc0 ls0 ws0">select</div><div class="t m0 x5f h14 y81b ff8 fs3 fc0 sc0 ls0 ws37f">functionality to support subselects. <span class="_ _4"></span>These tw<span class="_ _4"></span>o reasons to change mean that the</div><div class="t m5 xd h2f y419 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x3b h14 y419 ff8 fs3 fc0 sc0 ls0 ws0"> class violates the SRP<span class="_ _3"></span>.</div><div class="t m0 x74 h14 y3fc ff8 fs3 fc0 sc0 lsc ws51f">W<span class="_ _0"></span>e can spot this SRP violation from a simple organizational standpoint. <span class="_ _1"></span>The method</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls0 ws5b8">outline of </div><div class="t m5 xb3 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x39 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws5b8">sho<span class="_ _4"></span>ws that there are priv<span class="_ _4"></span>ate methods, such as </div><div class="t m5 xa0 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">selectWithCriteria</div><div class="t m0 xd8 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws5b8">, that</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">appear to relate only to </div><div class="t m5 x2e h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">select</div><div class="t m0 x1 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0"> statements.</div><div class="t m0 x74 h14 y73a ff8 fs3 fc0 sc0 ls0 ws5b9">Pri<span class="_ _4"></span>vate method beha<span class="_ _4"></span>vior that applies only to a small subset of a class can be a useful</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws2b9">heuristic for spotting potential areas for impro<span class="_ _4"></span>vement. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, the primar<span class="_ _8"></span>y spur for tak-</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls0 ws5ba">ing action should be system change itself. If the </div><div class="t m5 xc0 h2f y470 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x40 h14 y470 ff8 fs3 fc0 sc0 ls0 ws5ba">class is deemed lo<span class="_ _4"></span>gically complete,</div><div class="t m0 xd h14 y401 ff8 fs3 fc0 sc0 ls0 ws598">then w<span class="_ _4"></span>e need not w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y about separating the responsibilities. If we w<span class="_ _1"></span>on’<span class="_ _4"></span>t need </div><div class="t m5 xa8 h2f y401 ffb fs10 fc0 sc0 ls0 ws0">update</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws5bb">functionality for the foreseeable future, then w<span class="_ _1"></span>e should leav<span class="_ _4"></span>e </div><div class="t m5 x7f h2f y402 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x49 h14 y402 ff8 fs3 fc0 sc0 ls0 ws5bb">alone. But as soon as w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws0">ﬁnd ourselves opening up a class, w<span class="_ _1"></span>e should consider ﬁxing our design.</div><div class="t m0 x74 h14 y60e ff8 fs3 fc0 sc0 ls0 ws5bc">What if w<span class="_ _4"></span>e considered a solution like that in Listing 10-10? Each public interface</div><div class="t m0 xd h14 y482 ff8 fs3 fc0 sc0 ls0 ws284">method deﬁned in the previous </div><div class="t m5 x84 h2f y482 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x76 h14 y482 ff8 fs3 fc0 sc0 ls0 ws284">from Listing 10-9 is refactored out to its o<span class="_ _4"></span>wn deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>e</div><div class="t m0 xd h14 y483 ff8 fs3 fc0 sc0 ls0 ws245">of the </div><div class="t m5 x52 h2f y483 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x5f h14 y483 ff8 fs3 fc0 sc0 ls0 ws245">class. Note that the pri<span class="_ _4"></span>vate methods, such as </div><div class="t m5 x89 h2f y483 ffb fs10 fc0 sc0 ls0 ws0">valuesList</div><div class="t m0 x82 h14 y483 ff8 fs3 fc0 sc0 ls0 ws245">, mo<span class="_ _4"></span>ve directl<span class="_ _4"></span>y where</div><div class="t m0 x74 h1c yccc ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-9 </div><div class="t m0 x74 h36 yccd ffc fs3 fc0 sc0 ls0 ws0">A class that must be opened for change</div><div class="t m5 x74 h2f ycce ffb fs10 fc0 sc0 ls0 ws0">public class Sql {</div><div class="t m5 x74 h2f yccf ffb fs10 fc0 sc0 ls0 ws0">   public Sql(String table, Column[] columns)</div><div class="t m5 x74 h2f ycd0 ffb fs10 fc0 sc0 ls0 ws0">   public String create()</div><div class="t m5 x74 h2f ycd1 ffb fs10 fc0 sc0 ls0 ws0">   public String insert(Object[] fields)</div><div class="t m5 x74 h2f ycd2 ffb fs10 fc0 sc0 ls0 ws0">   public String selectAll()</div><div class="t m5 x74 h2f ycd3 ffb fs10 fc0 sc0 ls0 ws0">   public String findByKey(String keyColumn, String keyValue)</div><div class="t m5 x74 h2f ycd4 ffb fs10 fc0 sc0 ls0 ws0">   public String select(Column column, String pattern)</div><div class="t m5 x74 h2f ycd5 ffb fs10 fc0 sc0 ls0 ws0">   public String select(Criteria criteria)</div><div class="t m5 x74 h2f ycd6 ffb fs10 fc0 sc0 ls0 ws0">   public String preparedInsert()</div><div class="t m5 x74 h2f ycd7 ffb fs10 fc0 sc0 ls0 ws0">   private String columnList(Column[] columns)</div><div class="t m5 x74 h2f ycd8 ffb fs10 fc0 sc0 ls0 ws0">   private String valuesList(Object[] fields, final Column[] columns)</div><div class="t m5 x74 h2f ycd9 ffb fs10 fc0 sc0 ls0 ws0">   private String selectWithCriteria(String criteria)</div><div class="t m5 x74 h2f ycda ffb fs10 fc0 sc0 ls0 ws0">   private String placeholderList(Column[] columns)</div><div class="t m5 x74 h2f ycdb ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:580.945010px;width:137.475000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb3" class="pf w1 h2" data-page-no="b3"><div class="pc pcb3 w1 h2"><img class="bi xd ycdc wc h83" alt="" src="bgb3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">148<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws305">they are needed. <span class="_ _1"></span>The common priv<span class="_ _4"></span>ate beha<span class="_ _4"></span>vior is isolated to a pair of utility classes, </div><div class="t m5 xd8 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">Where</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">ColumnList</div><div class="t m0 xe h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1c yc08 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-10 </div><div class="t m0 x74 h36 y198 ffc fs3 fc0 sc0 ls0 ws0">A set of closed classes</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">abstract public class Sql {</div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">   public Sql(String table, Column[] columns)</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">   abstract public String generate();</div><div class="t m5 x74 h2f y55d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y55f ffb fs10 fc0 sc0 ls0 ws0">public class CreateSql extends Sql {</div><div class="t m5 x74 h2f y58f ffb fs10 fc0 sc0 ls0 ws0">   public CreateSql(String table, Column[] columns)</div><div class="t m5 x74 h2f y590 ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f y591 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y593 ffb fs10 fc0 sc0 ls0 ws0">public class SelectSql extends Sql {</div><div class="t m5 x74 h2f y594 ffb fs10 fc0 sc0 ls0 ws0">   public SelectSql(String table, Column[] columns)</div><div class="t m5 x74 h2f y595 ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f yc09 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yc0b ffb fs10 fc0 sc0 ls0 ws0">public class InsertSql extends Sql {</div><div class="t m5 x74 h2f yc0c ffb fs10 fc0 sc0 ls0 ws0">   public InsertSql(String table, Column[] columns, Object[] fields)</div><div class="t m5 x74 h2f ycdd ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f yc0d ffb fs10 fc0 sc0 ls0 ws0">   private String valuesList(Object[] fields, final Column[] columns)</div><div class="t m5 x74 h2f yc0e ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yc10 ffb fs10 fc0 sc0 ls0 ws0">public class SelectWithCriteriaSql extends Sql {</div><div class="t m5 x74 h2f yc11 ffb fs10 fc0 sc0 ls0 ws0">   public SelectWithCriteriaSql(</div><div class="t m5 x74 h2f ycde ffb fs10 fc0 sc0 ls0 ws0">      String table, Column[] columns, Criteria criteria)</div><div class="t m5 x74 h2f ycdf ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f yce0 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yce1 ffb fs10 fc0 sc0 ls0 ws0">public class SelectWithMatchSql extends Sql {</div><div class="t m5 x74 h2f yce2 ffb fs10 fc0 sc0 ls0 ws0">   public SelectWithMatchSql(</div><div class="t m5 x74 h2f yce3 ffb fs10 fc0 sc0 ls0 ws0">      String table, Column[] columns, Column column, String pattern)</div><div class="t m5 x74 h2f yce4 ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f yce5 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yce6 ffb fs10 fc0 sc0 ls0 ws0">public class FindByKeySql extends Sql</div><div class="t m5 x74 h2f yce7 ffb fs10 fc0 sc0 ls0 ws0">   public FindByKeySql(</div><div class="t m5 x74 h2f yce8 ffb fs10 fc0 sc0 ls0 ws0">      String table, Column[] columns, String keyColumn, String keyValue)</div><div class="t m5 x74 h2f yce9 ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate()</div><div class="t m5 x74 h2f ycea ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yceb ffb fs10 fc0 sc0 ls0 ws0">public class PreparedInsertSql extends Sql {</div><div class="t m5 x74 h2f ycec ffb fs10 fc0 sc0 ls0 ws0">   public PreparedInsertSql(String table, Column[] columns)</div><div class="t m5 x74 h2f yced ffb fs10 fc0 sc0 ls0 ws0">   @Override public String generate() {</div><div class="t m5 x74 h2f ycee ffb fs10 fc0 sc0 ls0 ws0">   private String placeholderList(Column[] columns)</div><div class="t m5 x74 h2f ycef ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f ycf0 ffb fs10 fc0 sc0 ls0 ws0">public class Where {</div><div class="t m5 x74 h2f ycf1 ffb fs10 fc0 sc0 ls0 ws0">   public Where(String criteria)</div><div class="t m5 x74 h2f ycf2 ffb fs10 fc0 sc0 ls0 ws0">   public String generate()</div><div class="t m5 x74 h2f ycf3 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb4" class="pf w1 h2" data-page-no="b4"><div class="pc pcb4 w1 h2"><img class="bi xd ycf4 wc h84" alt="" src="bgb4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">149<span class="_ _10"></span><span class="ff1">Organizing f<span class="_ _1"></span>or Change</span></div><div class="t m0 x74 h14 ycf5 ff8 fs3 fc0 sc0 ls0 ws438">The code in each class becomes excruciatingly simple. Our required comprehension</div><div class="t m0 xd h14 ycf6 ff8 fs3 fc0 sc0 ls0 ws5bd">time to understand any class decreases to almost nothing. <span class="_ _1"></span>The risk that one function could</div><div class="t m0 xd h14 ycf7 ff8 fs3 fc0 sc0 ls0 ws5be">break another becomes vanishingl<span class="_ _1"></span>y small. From a test standpoint, it becomes an easier</div><div class="t m0 xd h14 ybef ff8 fs3 fc0 sc0 ls0 ws3b3">task to pro<span class="_ _4"></span>ve all bits of lo<span class="_ _4"></span>gic in this solution, as the classes are all isolated from one</div><div class="t m0 xd h14 ycf8 ff8 fs3 fc0 sc0 ls0 ws0">another<span class="_ _1"></span>.</div><div class="t m0 x74 h14 ycf9 ff8 fs3 fc0 sc0 ls0 ws5bf">Equally important, when it’<span class="_ _3"></span>s time to add the </div><div class="t m5 x3c h2f y253 ffb fs10 fc0 sc0 ls0 ws0">update</div><div class="t m0 xdb h14 y253 ff8 fs3 fc0 sc0 ls0 ws5bf">statements, none of the existing</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 lsd ws3e3">classes need change! <span class="_ _4"></span>W<span class="_ _0"></span>e code the logic to build </div><div class="t m5 xcf h2f y254 ffb fs10 fc0 sc0 ls0 ws0">update</div><div class="t m0 xb7 h14 y254 ff8 fs3 fc0 sc0 ls0 ws2fa">statements in a ne<span class="_ _4"></span>w subclass of </div><div class="t m5 x25 h2f y254 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">named</div><div class="t m5 x1a h2f y255 ffb fs10 fc0 sc0 ls0 ws0">UpdateSql</div><div class="t m0 x3a h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">. No other code in the system will break because of this change. </div><div class="t m0 x74 h14 y256 ff8 fs3 fc0 sc0 ls0 ws147">Our restructured </div><div class="t m5 x9 h2f y256 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 xb1 h14 y256 ff8 fs3 fc0 sc0 ls0 ws147">lo<span class="_ _4"></span>gic represents the best of all worlds. It supports the SRP<span class="_ _3"></span>. It also</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws28b">supports another key OO class design principle kno<span class="_ _4"></span>wn as the Open-Closed Principle, or</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">OCP:</div><div class="t m0 x7c h21 y848 ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x52 h14 y465 ff8 fs3 fc0 sc0 lsd wsa2">Classes should be open for extension but closed for modiﬁcation. Our restructured</div><div class="t m5 xd h2f y466 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 xe7 h14 y466 ff8 fs3 fc0 sc0 lsd ws422">class is open to allo<span class="_ _4"></span>w new functionality via subclassing, but w<span class="_ _1"></span>e can make this change</div><div class="t m0 xd h14 y539 ff8 fs3 fc0 sc0 ls0 ws0">while k<span class="_ _4"></span>eeping ev<span class="_ _4"></span>er<span class="_ _8"></span>y other class closed. W<span class="_ _2"></span>e simply drop our </div><div class="t m5 x21 h2f y539 ffb fs10 fc0 sc0 ls0 ws0">UpdateSql</div><div class="t m0 x97 h14 y539 ff8 fs3 fc0 sc0 ls0 ws0"> class in place.</div><div class="t m0 x74 h14 y487 ff8 fs3 fc0 sc0 ls0 ws278">W<span class="_ _0"></span>e want to structure our systems so that w<span class="_ _4"></span>e muck with as little as possible w<span class="_ _4"></span>hen w<span class="_ _4"></span>e</div><div class="t m0 xd h14 y488 ff8 fs3 fc0 sc0 ls0 ws58c">update them with new or changed features. In an ideal system, w<span class="_ _1"></span>e incor<span class="_ _8"></span>porate new fea-</div><div class="t m0 xd h14 y489 ff8 fs3 fc0 sc0 ls0 ws0">tures by e<span class="_ _4"></span>xtending the system, not by making modiﬁcations to e<span class="_ _4"></span>xisting code. </div><div class="t m0 xd h11 ycfa ff1 fs7 fc0 sc0 ls0 ws0">Isolating fr<span class="_ _4"></span>om Change</div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws430">Needs will change, therefore code will change. <span class="_ _4"></span>W<span class="_ _0"></span>e lear<span class="_ _8"></span>ned in OO 101 that there are con-</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls0 ws5c0">crete classes, which contain implementation details (code), and abstract classes, w<span class="_ _4"></span>hich</div><div class="t m0 xd h14 y609 ff8 fs3 fc0 sc0 ls0 ws34c">represent concepts onl<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>A client class depending upon concrete details is at risk when</div><div class="t m0 xd h14 y60a ff8 fs3 fc0 sc0 ls0 ws526">those details change. <span class="_ _4"></span>W<span class="_ _0"></span>e can introduce interf<span class="_ _8"></span>aces and abstract classes to help isolate the</div><div class="t m0 xd h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">impact of those details.</div><div class="t m0 x74 h14 ycfc ff8 fs3 fc0 sc0 ls0 ws5c1">Dependencies upon concrete details create challenges for testing our system. If w<span class="_ _4"></span>e’<span class="_ _1"></span>re</div><div class="t m0 xd h14 ycfd ff8 fs3 fc0 sc0 ls48 wsf0">building a </div><div class="t m5 xb3 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">Portfolio</div><div class="t m0 xed h14 y3fd ff8 fs3 fc0 sc0 ls0 ws5c2">class and it depends upon an external </div><div class="t m5 x53 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">TokyoStockExchange</div><div class="t m0 xe6 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws5c2">API to</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws152">deriv<span class="_ _4"></span>e the portfolio’<span class="_ _0"></span>s v<span class="_ _4"></span>alue, our test cases are impacted by the v<span class="_ _4"></span>olatility of such a lookup.</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">It’<span class="_ _2"></span>s hard to write a test when w<span class="_ _1"></span>e get a different answ<span class="_ _1"></span>er ev<span class="_ _4"></span>er<span class="_ _8"></span>y ﬁve minutes!</div><div class="t m0 x74 h14 y46f ff8 fs3 fc0 sc0 ls0 ws5c3">Instead of designing </div><div class="t m5 x7 h2f y46f ffb fs10 fc0 sc0 ls0 ws0">Portfolio</div><div class="t m0 x43 h14 y46f ff8 fs3 fc0 sc0 ls0 ws5c3">so that it directl<span class="_ _4"></span>y depends upon </div><div class="t m5 x59 h2f y46f ffb fs10 fc0 sc0 ls0 ws0">TokyoStockExchange</div><div class="t m0 x56 h14 y46f ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>e create an interface, </div><div class="t m5 xd0 h2f y470 ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 x26 h14 y470 ff8 fs3 fc0 sc0 ls0 ws0">, that declares a single method:</div><div class="t m5 x74 h2f y471 ffb fs10 fc0 sc0 ls0 ws0">public interface StockExchange {</div><div class="t m5 x74 h2f ycfe ffb fs10 fc0 sc0 ls0 ws0">   Money currentPrice(String symbol);</div><div class="t m5 x74 h2f ycff ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yd00 ffb fs10 fc0 sc0 ls0 ws0">public class ColumnList {</div><div class="t m5 x74 h2f yd01 ffb fs10 fc0 sc0 ls0 ws0">   public ColumnList(Column[] columns)</div><div class="t m5 x74 h2f yd02 ffb fs10 fc0 sc0 ls0 ws0">   public String generate()</div><div class="t m5 x74 h2f yd03 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 yd04 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>[PPP].</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 10-10 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">A set of closed classes</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:292.728010px;width:114.738000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb5" class="pf w1 h2" data-page-no="b5"><div class="pc pcb5 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bgb5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">150<span class="_ _2f"> </span><span class="ff1 wsa0">Chapter 10:<span class="_ _4"></span> Classes</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e design</div><div class="t m5 x39 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">TokyoStockExchange</div><div class="t m0 x20 h14 y194 ff8 fs3 fc0 sc0 ls0 ws321">to implement this interface. W<span class="_ _2"></span>e also make sure that the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">constructor of </div><div class="t m5 x86 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Portfolio</div><div class="t m0 x6e h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> takes a </div><div class="t m5 x1c h2f y195 ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 xee h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> reference as an argument:</div><div class="t m5 x74 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">public Portfolio {</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">   private StockExchange exchange;</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls0 ws0">   public Portfolio(StockExchange exchange) {</div><div class="t m5 x74 h2f yae1 ffb fs10 fc0 sc0 ls0 ws0">      this.exchange = exchange;</div><div class="t m5 x74 h2f yae2 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f yae3 ffb fs10 fc0 sc0 ls0 ws0">   // ...</div><div class="t m5 x74 h2f yae4 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y19c ff8 fs3 fc0 sc0 ls0 ws107">No<span class="_ _4"></span>w our test can create a testable implementation of the </div><div class="t m5 x62 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 xa6 h14 y19c ff8 fs3 fc0 sc0 ls0 ws107">interface that</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws454">emulates the </div><div class="t m5 x91 h2f y19d ffb fs10 fc0 sc0 ls0 ws0">TokyoStockExchange</div><div class="t m0 xdf h14 y19d ff8 fs3 fc0 sc0 ls0 ws454">. <span class="_ _1"></span>This test implementation will ﬁx the cur<span class="_ _5"></span>rent value for</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws440">an<span class="_ _4"></span>y symbol we use in testing. If our test demonstrates purchasing ﬁv<span class="_ _4"></span>e shares of Microsoft</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws5c4">for our portfolio, we code the test implementation to al<span class="_ _1"></span>wa<span class="_ _4"></span>ys retur<span class="_ _8"></span>n $100 per share of</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws5c5">Microsoft. Our test implementation of the </div><div class="t m5 x67 h2f y1a0 ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 x21 h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws5c5">interface reduces to a simple</div><div class="t m0 xd h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws0">table lookup. <span class="_ _1"></span>W<span class="_ _0"></span>e can then write a test that expects $500 for our o<span class="_ _4"></span>verall portfolio value.</div><div class="t m5 x74 h2f yd05 ffb fs10 fc0 sc0 ls0 ws0">public class PortfolioTest {</div><div class="t m5 x74 h2f yd06 ffb fs10 fc0 sc0 ls0 ws0">  private FixedStockExchangeStub exchange;</div><div class="t m5 x74 h2f yd07 ffb fs10 fc0 sc0 ls0 ws0">  private Portfolio portfolio;</div><div class="t m5 x74 h2f yd08 ffb fs10 fc0 sc0 ls0 ws0">  @Before</div><div class="t m5 x74 h2f yd09 ffb fs10 fc0 sc0 ls0 ws0">  protected void setUp() throws Exception {</div><div class="t m5 x74 h2f yd0a ffb fs10 fc0 sc0 ls0 ws0">    exchange = new FixedStockExchangeStub();</div><div class="t m5 x74 h2f yd0b ffb fs10 fc0 sc0 ls0 ws0">    exchange.fix(&quot;MSFT&quot;, 100);</div><div class="t m5 x74 h2f yd0c ffb fs10 fc0 sc0 ls0 ws0">    portfolio = new Portfolio(exchange);</div><div class="t m5 x74 h2f yd0d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yd0e ffb fs10 fc0 sc0 ls0 ws0">  @Test</div><div class="t m5 x74 h2f yd0f ffb fs10 fc0 sc0 ls0 ws0">  public void GivenFiveMSFTTotalShouldBe500() throws Exception {</div><div class="t m5 x74 h2f yd10 ffb fs10 fc0 sc0 ls0 ws0">    portfolio.add(5, &quot;MSFT&quot;);</div><div class="t m5 x74 h2f yd11 ffb fs10 fc0 sc0 ls0 ws0">    Assert.assertEquals(500, portfolio.value());</div><div class="t m5 x74 h2f yd12 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yd13 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y9f8 ff8 fs3 fc0 sc0 ls0 ws441">If a system is decoupled enough to be tested in this wa<span class="_ _1"></span>y<span class="_ _1"></span>, it will also be more ﬂexib<span class="_ _4"></span>le</div><div class="t m0 xd h14 y9f9 ff8 fs3 fc0 sc0 ls0 ws4b3">and promote more reuse. <span class="_ _1"></span>The lack of coupling means that the elements of our system are</div><div class="t m0 xd h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws356">better isolated from each other and from change. <span class="_ _1"></span>This isolation makes it easier to under-</div><div class="t m0 xd h14 yb0e ff8 fs3 fc0 sc0 ls0 ws0">stand each element of the system.</div><div class="t m0 x74 h14 y9fb ff8 fs3 fc0 sc0 ls0 ws2f5">By minimizing coupling in this w<span class="_ _4"></span>ay<span class="_ _0"></span>, our classes adhere to another class design princi-</div><div class="t m0 xd h14 y9fc ff8 fs3 fc0 sc0 ls0 ws26c">ple kno<span class="_ _4"></span>wn as the Dependency In<span class="_ _1"></span>version Principle (DIP).</div><div class="t m0 x85 h21 yd14 ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 x89 h14 y3fe ff8 fs3 fc0 sc0 ls22 ws36f"> In essence, the DIP sa<span class="_ _4"></span>ys that our</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">classes should depend upon abstractions, not on concrete details.</div><div class="t m0 x74 h14 y46f ff8 fs3 fc0 sc0 ls0 ws5c6">Instead of being dependent upon the implementation details of the </div><div class="t m5 x63 h2f y46f ffb fs10 fc0 sc0 ls0 ws0">TokyoStock-</div><div class="t m5 xd h2f yd15 ffb fs10 fc0 sc0 ls0 ws0">Exchange</div><div class="t m0 x8a h14 y470 ff8 fs3 fc0 sc0 ls0 ws5c7">class, our </div><div class="t m5 xd6 h2f y470 ffb fs10 fc0 sc0 ls0 ws0">Portfolio</div><div class="t m0 x38 h14 y470 ff8 fs3 fc0 sc0 ls0 ws5c7">class is no<span class="_ _4"></span>w dependent upon the </div><div class="t m5 xef h2f y470 ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 x99 h14 y470 ff8 fs3 fc0 sc0 ls0 ws0">interface.</div><div class="t m0 xd h14 y401 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x2b h2f y401 ffb fs10 fc0 sc0 ls0 ws0">StockExchange</div><div class="t m0 x4d h14 y401 ff8 fs3 fc0 sc0 ls0 ws56a">interface represents the abstract concept of asking for the cur<span class="_ _8"></span>rent price</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws248">of a symbol. <span class="_ _1"></span>This abstraction isolates all of the speciﬁc details of obtaining such a price,</div><div class="t m0 xd h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws0">including from where that price is obtained.</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>[PPP].</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb6" class="pf w1 h2" data-page-no="b6"><div class="pc pcb6 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">151<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 yd16 ff1 fs3 fc0 sc0 ls0 wsa0">[RDD]:<span class="_ _4"></span>  <span class="ffa ws5c8">Object Design: Roles, Responsibilities, and Collabor<span class="_ _1"></span>ations<span class="ff8">, Rebecca Wirfs-</span></span></div><div class="t m0 xd h14 yd17 ff8 fs3 fc0 sc0 ls0 ws0">Brock et al., <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2002.</div><div class="t m0 xd h14 ya6a ff1 fs3 fc0 sc0 ls0 wsa0">[PPP]:<span class="_ _4"></span>  <span class="ffa ls10 ws2a5">Agile Softwar<span class="_ _4"></span>e Development: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>actices<span class="ff8">, Rober<span class="_ _8"></span>t C. Martin,</span></span></div><div class="t m0 xd h14 ya6b ff8 fs3 fc0 sc0 ls0 ws0">Prentice Hall, 2002.</div><div class="t m0 xd h14 y5db ff1 fs3 fc0 sc0 ls0 wsa0">[Knuth92]:<span class="_ _1"></span>  <span class="ffa ws57f">Literate Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>amming, <span class="ff8">Donald E. Knuth, Center for the Study of language</span></span></div><div class="t m0 xd h14 y5dc ff8 fs3 fc0 sc0 ls0 ws0">and Information, Leland Stanford Junior University<span class="_ _0"></span>, 1992.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:580.945010px;width:77.392000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb7" class="pf w1 h2" data-page-no="b7"><div class="pc pcb7 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb8" class="pf w1 h2" data-page-no="b8"><div class="pc pcb8 w1 h2"><img class="bi xd yd18 w4 h85" alt="" src="bgb8.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">153</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">11</div><div class="t m0 xeb h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Systems</div><div class="t m0 xe8 h14 y636 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y Dr<span class="_ _4"></span>. Ke<span class="_ _4"></span>vin Dean <span class="_ _4"></span>W<span class="_ _1"></span>ampler</div><div class="t m0 x32 h1d yd19 ffa fs3 fc0 sc0 ls0 ws0">“Complexity kills. It sucks the lif<span class="_ _4"></span>e out of developers,</div><div class="t m0 x33 h1d yd1a ffa fs3 fc0 sc0 lsc ws3f">it makes pr<span class="_ _4"></span>oducts difﬁcult to plan, build, and test.<span class="_ _2c"></span>”</div><div class="t m0 x23 h14 yd1b ff8 fs3 fc0 sc0 ls0 ws0">—Ra<span class="_ _4"></span>y Ozzie, CT<span class="_ _4"></span>O<span class="_ _4"></span>, Microsoft Cor<span class="_ _8"></span>poration</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:356.243000px;bottom:440.027010px;width:82.655000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfb9" class="pf w1 h2" data-page-no="b9"><div class="pc pcb9 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">154<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Ho<span class="_ _1"></span>w <span class="_ _0"></span>W<span class="_ _2"></span>ould <span class="_ _2"></span>Y<span class="_ _3"></span>ou Build a City?</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws5c9">Could you manage all the details y<span class="_ _4"></span>ourself? Probabl<span class="_ _4"></span>y not. Even managing an e<span class="_ _4"></span>xisting city</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws33b">is too much for one person. <span class="_ _0"></span>Y<span class="_ _2"></span>et, cities w<span class="_ _4"></span>ork (most of the time). <span class="_ _1"></span>They w<span class="_ _4"></span>ork because cities</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws558">ha<span class="_ _4"></span>ve teams of people w<span class="_ _4"></span>ho manage par<span class="_ _8"></span>ticular par<span class="_ _8"></span>ts of the city<span class="_ _0"></span>, the water systems, po<span class="_ _4"></span>w<span class="_ _4"></span>er</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 lsd ws5ca">systems, traf<span class="_ _4"></span>ﬁc, law enforcement, building codes, and so forth. Some of those people are</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws0">responsible for the <span class="ffa">big pictur<span class="_ _1"></span>e<span class="ff8">, while others focus on the details.</span></span></div><div class="t m0 x74 h14 y462 ff8 fs3 fc0 sc0 ls0 ws1e5">Cities also w<span class="_ _4"></span>ork because they ha<span class="_ _4"></span>ve e<span class="_ _4"></span>volv<span class="_ _4"></span>ed appropriate lev<span class="_ _4"></span>els of abstraction and mod-</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls0 ws5cb">ularity that make it possib<span class="_ _4"></span>le for individuals and the “components” the<span class="_ _4"></span>y manage to work</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws0">ef<span class="_ _4"></span>fectivel<span class="_ _4"></span>y<span class="_ _0"></span>, ev<span class="_ _4"></span>en without understanding the big picture.</div><div class="t m0 x74 h14 y252 ff8 fs3 fc0 sc0 lsc ws5cc">Although softw<span class="_ _4"></span>are teams are often organized like that too, the systems they w<span class="_ _1"></span>ork on</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws5cd">often don’<span class="_ _1"></span>t hav<span class="_ _4"></span>e the same separation of concer<span class="_ _8"></span>ns and lev<span class="_ _4"></span>els of abstraction. Clean code</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws4f6">helps us achie<span class="_ _4"></span>ve this at the lo<span class="_ _4"></span>w<span class="_ _4"></span>er levels of abstraction. In this chapter let us consider ho<span class="_ _1"></span>w</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">to sta<span class="_ _4"></span>y clean at higher lev<span class="_ _4"></span>els of abstraction, the <span class="ffa">system</span> lev<span class="_ _4"></span>el.</div><div class="t m0 xd h17 yd1c ff1 fs9 fc0 sc0 ls0 ws0">Separate Constructing a System fr<span class="_ _1"></span>om Using It</div><div class="t m0 xd h14 y2d9 ff8 fs3 fc0 sc0 ls12 ws5cd">First, consider that <span class="ffa ws0">construction<span class="_ _16"> </span></span>is a ver<span class="_ _8"></span>y different process from <span class="_ _4"></span><span class="ffa ws0">use<span class="ff8 ws5cd">. <span class="_ _4"></span>As I write this,</span></span></div><div class="t m0 xd h14 y2da ff8 fs3 fc0 sc0 ls12 ws305">there is a ne<span class="_ _4"></span>w hotel under constr<span class="_ _8"></span>uction that I see out m<span class="_ _4"></span>y window in Chicago. <span class="_ _1"></span>T<span class="_ _0"></span>oday it is</div><div class="t m0 xd h14 y2db ff8 fs3 fc0 sc0 ls12 ws5ce">a bare concrete box with a construction crane and elev<span class="_ _1"></span>ator bolted to the outside. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc0 sc0 ls12 ws15c">busy people there all w<span class="_ _4"></span>ear hard hats and w<span class="_ _4"></span>ork clothes. In a year or so the hotel will be</div><div class="t m0 xd h14 y3a6 ff8 fs3 fc0 sc0 ls12 ws449">ﬁnished. <span class="_ _1"></span>The crane and elev<span class="_ _4"></span>ator will be gone. <span class="_ _4"></span>The building will be clean, encased in</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc0 sc0 ls12 ws2d1">glass windo<span class="_ _4"></span>w walls and attracti<span class="_ _4"></span>ve paint. <span class="_ _1"></span>The people w<span class="_ _4"></span>orking and staying there will look</div><div class="t m0 xd h14 y3a8 ff8 fs3 fc0 sc0 ls12 ws0">a lot different too.</div><div class="t m0 x74 h29 yb7a ffa fsf fc0 sc0 ls0 ws5cf">Softwar<span class="_ _4"></span>e systems should separ<span class="_ _4"></span>ate the startup pr<span class="_ _4"></span>ocess, when the application objects ar<span class="_ _4"></span>e</div><div class="t m0 x74 h29 yd1d ffa fsf fc0 sc0 ls0 ws7b">constructed and the dependencies ar<span class="_ _4"></span>e <span class="_ _4"></span>“wir<span class="_ _4"></span>ed” together<span class="_ _2"></span>, from the runtime lo<span class="_ _4"></span>gic that takes</div><div class="t m0 x74 h29 yd1e ffa fsf fc0 sc0 ls0 ws0">o<span class="_ _4"></span>ver after startup.</div><div class="t m0 x74 h14 y5cc ff8 fs3 fc0 sc0 ls0 ws5d0">The startup process is a <span class="ffa ws0">concern<span class="_ _18"> </span></span>that any application must address. It is the ﬁrst <span class="_ _4"></span><span class="ffa ws0">con-</span></div><div class="t m0 xd h14 y5cd ffa fs3 fc0 sc0 ls0 ws0">cern<span class="_ _a"> </span><span class="ff8 ws5d1">that we will e<span class="_ _4"></span>xamine in this chapter<span class="_ _4"></span>. <span class="_ _4"></span>The <span class="ffa">separ<span class="_ _1"></span>ation of concerns <span class="ff8">is one of the oldest</span></span></span></div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">and most important design techniques in our craft. </div><div class="t m0 x74 h14 y674 ff8 fs3 fc0 sc0 ls0 ws5d2">Unfortunately<span class="_ _0"></span>, most applications don’<span class="_ _4"></span>t separate this concer<span class="_ _8"></span>n. <span class="_ _1"></span>The code for the star<span class="_ _8"></span>tup</div><div class="t m0 xd h14 y675 ff8 fs3 fc0 sc0 ls0 ws0">process is ad hoc and it is mix<span class="_ _4"></span>ed in with the r<span class="_ _8"></span>untime logic. Here is a typical e<span class="_ _4"></span>xample:</div><div class="t m5 x74 h2f yd1f ffb fs10 fc0 sc0 ls0 ws0">public Service getService() {</div><div class="t m5 x74 h2f yd20 ffb fs10 fc0 sc0 ls0 ws0">  if (service == null)</div><div class="t m5 x74 h2f yd21 ffb fs10 fc0 sc0 ls0 ws0">    service = new MyServiceImpl(...);  // Good enough default for most cases?</div><div class="t m5 x74 h2f yd22 ffb fs10 fc0 sc0 ls0 ws0">  return service;</div><div class="t m5 x74 h2f yd23 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y5ed ff8 fs3 fc0 sc0 ls0 ws2b7">This is the <span class="fsb ws0">LAZY<span class="_ _15"> </span>INITIALIZATION<span class="fs3">/</span>EVALUATION<span class="_ _15"> </span></span>idiom, and it has se<span class="_ _4"></span>veral merits. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y5ee ff8 fs3 fc0 sc0 ls0 ws29c">don’<span class="_ _1"></span>t incur the ov<span class="_ _4"></span>erhead of constr<span class="_ _8"></span>uction unless w<span class="_ _4"></span>e actually use the object, and our startup</div><div class="t m0 xd h14 y5ef ff8 fs3 fc0 sc0 ls0 ws0">times can be faster as a result. W<span class="_ _2"></span>e also ensure that </div><div class="t m5 x3c h2f y5ef ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x27 h14 y5ef ff8 fs3 fc0 sc0 ls0 ws0"> is nev<span class="_ _4"></span>er returned.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:580.945010px;width:176.774000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:386.946010px;width:275.522000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfba" class="pf w1 h2" data-page-no="ba"><div class="pc pcba w1 h2"><img class="bi x37 yd24 w8 h27" alt="" src="bgba.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">155<span class="_ _10"></span><span class="ff1">Separate Constructing a System fr<span class="_ _4"></span>om Using It</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws433">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, w<span class="_ _1"></span>e now ha<span class="_ _1"></span>ve a hard-coded dependency on </div><div class="t m5 xdb h2f y194 ffb fs10 fc0 sc0 ls0 ws0">MyServiceImpl</div><div class="t m0 x8d h14 y194 ff8 fs3 fc0 sc0 ls0 ws433">and ev<span class="_ _4"></span>erything its</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws5d3">constructor requires (which I ha<span class="_ _4"></span>ve elided). <span class="_ _4"></span>W<span class="_ _0"></span>e can’<span class="_ _4"></span>t compile without resolving these</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">dependencies, ev<span class="_ _4"></span>en if w<span class="_ _4"></span>e nev<span class="_ _4"></span>er actually use an object of this type at runtime! </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws251">T<span class="_ _0"></span>esting can be a problem. If </div><div class="t m5 x81 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">MyServiceImpl</div><div class="t m0 xd5 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws251">is a hea<span class="_ _4"></span>vyw<span class="_ _4"></span>eight object, we will need to</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 wse5">make sure that an appropriate T<span class="fsb ws0">EST<span class="fs3 ls5f"> D<span class="_ _0"></span><span class="fsb ls0">OUBLE</span></span></span></div><div class="t m0 x78 h21 y2f1 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x66 h14 y1bd ff8 fs3 fc0 sc0 ls0 wse5">or M<span class="fsb ws0">OCK<span class="fs3 ls5f"> O<span class="_ _1"></span><span class="fsb ls0">BJECT<span class="_ _16"> </span><span class="fs3 wse5">gets assigned to the ser<span class="_ _4"></span>-</span></span></span></span></div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws5d4">vice ﬁeld before this method is called during unit testing. Because w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve construction</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws2d2">logic mix<span class="_ _1"></span>ed in with nor<span class="_ _8"></span>mal r<span class="_ _8"></span>untime processing, w<span class="_ _4"></span>e should test all ex<span class="_ _4"></span>ecution paths (for</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">example, the</div><div class="t m5 x6d h2f y19b ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xe2 h14 y19b ff8 fs3 fc0 sc0 ls0 ws1d5">test and its block). Ha<span class="_ _1"></span>ving both of these responsibilities means that the</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls10 ws564">method is doing more than one thing, so w<span class="_ _4"></span>e are breaking the <span class="ffa">Single Responsibility Principle</span></div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">in a small wa<span class="_ _1"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y208 ff8 fs3 fc0 sc0 ls0 ws5d5">P<span class="_ _4"></span>erhaps w<span class="_ _4"></span>orst of all, w<span class="_ _4"></span>e do not know w<span class="_ _4"></span>hether </div><div class="t m5 x7e h2f y208 ffb fs10 fc0 sc0 ls0 ws0">MyServiceImpl</div><div class="t m0 xb9 h14 y208 ff8 fs3 fc0 sc0 ls0 ws5d5">is the right object in all</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws16a">cases. I implied as much in the comment. <span class="_ _4"></span>Why does the class with this method ha<span class="_ _1"></span>ve to</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws55a">kno<span class="_ _4"></span>w the global context? Can w<span class="_ _4"></span>e <span class="ffa ws0">ever </span>really kno<span class="_ _4"></span>w the right object to use here? Is it e<span class="_ _4"></span>ven</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">possible for one type to be right for all possib<span class="_ _4"></span>le contexts?</div><div class="t m0 x74 h14 y20c ff8 fs3 fc0 sc0 ls0 ws440">One occur<span class="_ _8"></span>rence of </div><div class="t m0 x9e h14 yd25 ff8 fsb fc0 sc0 ls0 ws0">LAZY<span class="fs3">-</span>INITIALIZATION<span class="_ _a"> </span><span class="fs3 ws440">isn’<span class="_ _1"></span>t a serious problem, of course. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>,</span></div><div class="t m0 xd h14 yd26 ff8 fs3 fc0 sc0 ls0 ws2ac">there are normally man<span class="_ _4"></span>y instances of little setup idioms like this in applications. Hence,</div><div class="t m0 xd h14 yd27 ff8 fs3 fc0 sc0 ls0 ws5d6">the global setup <span class="ffa ws0">str<span class="_ _4"></span>ategy<span class="_ _15"> </span><span class="ff8 ws5d6">(if there is one) is </span>scatter<span class="_ _4"></span>ed<span class="_ _15"> </span><span class="ff8 ws5d6">across the application, with little</span></span></div><div class="t m0 xd h14 y567 ff8 fs3 fc0 sc0 ls0 ws0">modularity and often signiﬁcant duplication. </div><div class="t m0 x74 h14 yd28 ff8 fs3 fc0 sc0 ls57 ws35c">If w<span class="_ _4"></span>e are <span class="ffa ls0 ws0">diligent </span><span class="ls2b ws4e">about building w<span class="_ _4"></span>ell-formed and robust systems, we should ne<span class="_ _4"></span>ver let</span></div><div class="t m0 xd h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">little, <span class="ffa">con<span class="_ _4"></span>venient <span class="ff8 ws1f7">idioms lead to modularity breakdown. <span class="_ _1"></span>The star<span class="_ _8"></span>tup process of object con-</span></span></div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws124">struction and wiring is no exception. W<span class="_ _2"></span>e should modularize this process separately from</div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws5d7">the normal r<span class="_ _8"></span>untime logic and w<span class="_ _4"></span>e should make sure that w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve a global, consistent strat-</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">egy for resolving our major dependencies.</div><div class="t m0 xd h11 yd2b ff1 fs7 fc0 sc0 ls0 ws0">Separation of Main</div><div class="t m0 xd h14 yd2c ff8 fs3 fc0 sc0 ls0 ws5d8">One wa<span class="_ _1"></span>y to separate constr<span class="_ _8"></span>uction from use is simply to mo<span class="_ _1"></span>ve all aspects of construction to</div><div class="t m5 xd h2f yd2d ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 x74 h14 yd2d ff8 fs3 fc0 sc0 ls0 ws5d9">, or modules called b<span class="_ _4"></span>y </div><div class="t m5 x9b h2f yd2d ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 x92 h14 yd2d ff8 fs3 fc0 sc0 ls0 ws5d9">, and to design the rest of the system assuming that all</div><div class="t m0 xd h14 yd2e ff8 fs3 fc0 sc0 ls0 ws0">objects ha<span class="_ _4"></span>ve been constructed and wired up appropriately<span class="_ _0"></span>. (See Figure 11-1.)</div><div class="t m0 x74 h14 y5cd ff8 fs3 fc0 sc0 ls0 ws182">The ﬂo<span class="_ _4"></span>w of control is easy to follo<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>The </div><div class="t m5 x68 h2f y5cd ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 xd2 h14 y5cd ff8 fs3 fc0 sc0 lsd ws191">function builds the objects necessary</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws187">for the system, then passes them to the application, which simpl<span class="_ _4"></span>y uses them. Notice the</div><div class="t m0 xd h14 y2e6 ff8 fs3 fc0 sc0 ls0 ws520">direction of the dependency arro<span class="_ _4"></span>ws crossing the bar<span class="_ _8"></span>rier between </div><div class="t m5 xa0 h2f yc1c ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 x59 h14 yc1c ff8 fs3 fc0 sc0 ls0 ws520">and the application.</div><div class="t m0 xd h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws2d7">They all go one direction, pointing a<span class="_ _1"></span>wa<span class="_ _4"></span>y from main. <span class="_ _4"></span>This means that the application has no</div><div class="t m0 xd h14 y2e9 ff8 fs3 fc0 sc0 ls0 ws1e">kno<span class="_ _4"></span>wledge of </div><div class="t m5 x86 h2f y2e9 ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 xba h14 y2e9 ff8 fs3 fc0 sc0 ls0 ws1e">or of the construction process. It simply expects that e<span class="_ _4"></span>verything has</div><div class="t m0 xd h14 y2ea ff8 fs3 fc0 sc0 ls2b ws167">been built properl<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 xd h11 y95c ff1 fs7 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>actories</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 wsb7">Sometimes, of course, w<span class="_ _4"></span>e need to make the application responsible for <span class="_ _4"></span><span class="ffa ws0">when <span class="ff8 wsb7">an object gets</span></span></div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws5da">created. F<span class="_ _1"></span>or example, in an order processing system the application must create the</div><div class="t m0 xd h25 yd2f ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[Mezzaros07].</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:282.728010px;width:99.219000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:137.728010px;width:46.598000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfbb" class="pf w1 h2" data-page-no="bb"><div class="pc pcbb w1 h2"><img class="bi x37 y961 w14 h86" alt="" src="bgbb.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">156<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m5 xd h2f yd30 ffb fs10 fc0 sc0 ls0 ws0">LineItem</div><div class="t m0 xdc h14 yd30 ff8 fs3 fc0 sc0 ls0 ws58c">instances to add to an </div><div class="t m5 x92 h2f yd30 ffb fs10 fc0 sc0 ls0 ws0">Order</div><div class="t m0 x32 h14 yd30 ff8 fs3 fc0 sc0 ls0 ws58c">. In this case w<span class="_ _4"></span>e can use the A<span class="fsb ws0">BSTRACT<span class="fs3 ls60"> F<span class="_ _1"></span><span class="fsb ls0">ACTORY</span></span></span></div><div class="t m0 x56 h21 yd31 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xd h14 yd32 ff8 fs3 fc0 sc0 ls0 ws5db">pattern to give the application control of <span class="ffa ws0">w<span class="_ _4"></span>hen<span class="_ _a"> </span><span class="ff8 ls48 ws584">to build the </span></span></div><div class="t m5 x69 h2f yd32 ffb fs10 fc0 sc0 ls0 ws0">LineItems</div><div class="t m0 xeb h14 yd32 ff8 fs3 fc0 sc0 ls11 ws12e">, but keep the details</div><div class="t m0 xd h14 yd33 ff8 fs3 fc0 sc0 ls0 ws0">of that construction separate from the application code. (See Figure 11-2.)</div><div class="t m0 x74 h14 yd34 ff8 fs3 fc0 sc0 ls61 ws36f">Again notice that all the dependencies point from </div><div class="t m5 xb6 h2f yd34 ffb fs10 fc0 sc0 ls62 ws0">main</div><div class="t m0 x6a h14 yd34 ff8 fs3 fc0 sc0 ls63 ws583"> to<span class="_ _4"></span>ward the </div><div class="t m5 x60 h2f yd34 ffb fs10 fc0 sc0 ls62 ws0">OrderProcessing</div><div class="t m0 xd h14 yd35 ff8 fs3 fc0 sc0 ls5a ws5dc">application. <span class="_ _1"></span>This means that the application is decoupled from the details of how to</div><div class="t m0 xd h14 yd36 ff8 fs3 fc0 sc0 ls64 ws232">build a </div><div class="t m5 x75 h2f yd36 ffb fs10 fc0 sc0 ls62 ws0">LineItem</div><div class="t m0 xbc h14 yd36 ff8 fs3 fc0 sc0 ls5a ws191">. <span class="_ _1"></span>That capability is held in the </div><div class="t m5 xde h2f yd36 ffb fs10 fc0 sc0 ls62 ws0">LineItemFactoryImplementation</div><div class="t m0 x64 h14 yd36 ff8 fs3 fc0 sc0 ls5a ws191">, which</div><div class="t m0 xd h14 yd37 ff8 fs3 fc0 sc0 ls5a ws346">is on the </div><div class="t m5 xcb h2f yd37 ffb fs10 fc0 sc0 ls62 ws0">main</div><div class="t m0 xe h14 yd37 ff8 fs3 fc0 sc0 ls5a ws346">side of the line. <span class="_ _1"></span>And yet the application is in complete control of when</div><div class="t m0 xd h14 yd38 ff8 fs3 fc0 sc0 ls5a ws0">the</div><div class="t m5 xe7 h2f yd38 ffb fs10 fc0 sc0 ls62 ws0">LineItem</div><div class="t m0 x91 h14 yd38 ff8 fs3 fc0 sc0 ls65 ws5dd">instances get built and can e<span class="_ _4"></span>ven pro<span class="_ _4"></span>vide application-speciﬁc constructor</div><div class="t m0 xd h14 yd39 ff8 fs3 fc0 sc0 ls65 ws0">arguments. </div><div class="t m0 x5c h1c yd3a ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 11-1</div><div class="t m0 x9b h14 yd3b ff8 fs3 fc0 sc0 ls0 ws0">Separating construction in </div><div class="t m5 xb7 h2f yd3c ffb fs10 fc0 sc0 ls0 ws0">main()</div><div class="t m0 xd h25 yd3d ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>[GOF].</div><div class="t m0 x5c h1c yd3e ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 11-2</div><div class="t m0 xa4 h14 yd3f ff8 fs3 fc0 sc0 ls0 ws0">Separation construction with f<span class="_ _8"></span>actory</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfbc" class="pf w1 h2" data-page-no="bc"><div class="pc pcbc w1 h2"><img class="bi x37 yd40 w8 h27" alt="" src="bgbc.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">157<span class="_ _10"></span><span class="ff1">Scaling Up</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Dependency Injection</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws1bb">A po<span class="_ _4"></span>w<span class="_ _4"></span>erful mechanism for separating constr<span class="_ _8"></span>uction from use is <span class="ffa">Dependency Injection </span><span class="ws0">(DI),</span></div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws72">the application of <span class="ffa">In<span class="_ _4"></span>version of Contr<span class="_ _1"></span>ol <span class="ff8">(IoC) to dependency management.</span></span></div><div class="t m0 xbb h21 y5cf ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xa5 h14 y272 ff8 fs3 fc0 sc0 ls0 ws72">In<span class="_ _4"></span>version of</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws2b2">Control mo<span class="_ _4"></span>ves secondary responsibilities from an object to other objects that are dedicated</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws560">to the pur<span class="_ _8"></span>pose, thereby supporting the <span class="ffa">Single Responsibility Principle. </span>In the conte<span class="_ _4"></span>xt of</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws23c">dependency management, an object should not tak<span class="_ _4"></span>e responsibility for instantiating depen-</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws5de">dencies itself. Instead<span class="_ _1"></span>, it should pass this responsibility to another “authoritativ<span class="_ _4"></span>e” mecha-</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws5cb">nism, thereby in<span class="_ _1"></span>verting the control. Because setup is a global concer<span class="_ _8"></span>n, this authoritativ<span class="_ _4"></span>e</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws0">mechanism will usually be either the “main” routine or a special-purpose <span class="ffa">container<span class="_ _0"></span>.</span></div><div class="t m0 x74 h14 y2ab ff8 fs3 fc0 sc0 ls0 ws5df">JNDI lookups are a “partial” implementation of DI, where an object asks a directory</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws0">server to pro<span class="_ _4"></span>vide a “service” matching a par<span class="_ _8"></span>ticular name. </div><div class="t m5 x74 h2f yd41 ffb fs10 fc0 sc0 ls0 ws0">MyService myService = (MyService)(jndiContext.lookup(“NameOfMyService”));</div><div class="t m0 x74 h14 yd42 ff8 fs3 fc0 sc0 ls0 ws406">The in<span class="_ _4"></span>voking object doesn’<span class="_ _1"></span>t control what kind of object is actuall<span class="_ _4"></span>y retur<span class="_ _8"></span>ned (as long it</div><div class="t m0 xd h14 y6fa ff8 fs3 fc0 sc0 lsd ws5e0">implements the appropriate interface, of course), but the in<span class="_ _4"></span>voking object still acti<span class="_ _4"></span>vel<span class="_ _4"></span>y</div><div class="t m0 xd h14 y6fb ff8 fs3 fc0 sc0 ls0 ws0">resolves the dependenc<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y9d1 ff8 fs3 fc0 sc0 ls0 ws5e1">T<span class="_ _4"></span>r<span class="_ _8"></span>ue Dependency Injection goes one step further<span class="_ _4"></span>. <span class="_ _1"></span>The class takes no direct steps to</div><div class="t m0 xd h14 y51b ff8 fs3 fc0 sc0 ls0 ws2b">resolve its dependencies; it is completel<span class="_ _4"></span>y passiv<span class="_ _4"></span>e. Instead<span class="_ _1"></span>, it provides setter methods or</div><div class="t m0 xd h14 y51c ff8 fs3 fc0 sc0 ls0 wsbb">constructor arguments (or both) that are used to <span class="ffa ws0">inject<span class="_ _a"> </span></span>the dependencies. During the con-</div><div class="t m0 xd h14 y51d ff8 fs3 fc0 sc0 ls0 ws342">struction process, the DI container instantiates the required objects (usually on demand)</div><div class="t m0 xd h14 y51e ff8 fs3 fc0 sc0 ls0 ws4e">and uses the constructor arguments or setter methods pro<span class="_ _4"></span>vided to wire together the depen-</div><div class="t m0 xd h14 yd43 ff8 fs3 fc0 sc0 ls0 ws1ba">dencies. <span class="_ _4"></span>Which dependent objects are actually used is speciﬁed through a conﬁguration</div><div class="t m0 xd h14 yd44 ff8 fs3 fc0 sc0 ls0 ws0">ﬁle or programmaticall<span class="_ _4"></span>y in a special-pur<span class="_ _8"></span>pose constr<span class="_ _8"></span>uction module. </div><div class="t m0 x74 h14 y521 ff8 fs3 fc0 sc0 ls0 ws445">The Spring Frame<span class="_ _4"></span>w<span class="_ _4"></span>ork pro<span class="_ _4"></span>vides the best kno<span class="_ _4"></span>wn DI container for Ja<span class="_ _4"></span>va.</div><div class="t m0 xa5 h21 ybfd ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x93 h14 y3a8 ff8 fs3 fc0 sc0 ls0 ws445">Y<span class="_ _3"></span>ou deﬁne</div><div class="t m0 xd h14 y38d ff8 fs3 fc0 sc0 ls0 ws20a">which objects to wire to<span class="_ _4"></span>gether in an XML conﬁguration ﬁle, then you ask for particular</div><div class="t m0 xd h14 y38e ff8 fs3 fc0 sc0 ls0 ws0">objects by name in Ja<span class="_ _1"></span>va code. <span class="_ _4"></span>W<span class="_ _0"></span>e will look at an example shortly<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y3ab ff8 fs3 fc0 sc0 ls0 ws104">But what about the virtues of <span class="fsb ws0">LAZY<span class="fs3">-</span>INITIALIZATION</span>? <span class="_ _4"></span>This idiom is still sometimes</div><div class="t m0 xd h14 y390 ff8 fs3 fc0 sc0 ls0 wsee">useful with DI. First, most DI containers w<span class="_ _1"></span>on’<span class="_ _4"></span>t constr<span class="_ _8"></span>uct an object until needed. Second<span class="_ _1"></span>,</div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 ws5e2">many of these containers pro<span class="_ _1"></span>vide mechanisms for in<span class="_ _4"></span>voking factories or for constructing</div><div class="t m0 xd h14 y47a ff8 fs3 fc0 sc0 ls0 ws0">proxies, w<span class="_ _4"></span>hich could be used for <span class="fsb">LAZY</span>-<span class="fsb">EVALUATION</span> and similar <span class="ffa">optimizations.</span></div><div class="t m0 x70 h21 y3fb ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 xd h17 yba5 ff1 fs9 fc0 sc0 ls0 ws0">Scaling Up</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws23a">Cities grow from to<span class="_ _1"></span>wns, which gro<span class="_ _4"></span>w from settlements. <span class="_ _4"></span>At ﬁrst the roads are nar<span class="_ _8"></span>ro<span class="_ _4"></span>w and</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 lsd ws5e3">practically none<span class="_ _4"></span>xistent, then they are pa<span class="_ _4"></span>ved<span class="_ _0"></span>, then widened ov<span class="_ _4"></span>er time. Small buildings and</div><div class="t m0 xd h25 yd45 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>See, for e<span class="_ _4"></span>xample, [Fo<span class="_ _1"></span>wler].</div><div class="t m0 xd h25 yd46 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>See [Spring]. <span class="_ _1"></span>There is also a Spring.NET framew<span class="_ _4"></span>ork.</div><div class="t m0 xd h25 yd47 ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>Don’<span class="_ _1"></span>t forget that lazy instantiation/ev<span class="_ _4"></span>aluation is just an optimization and perhaps premature!</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:111.658000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:183.946010px;width:64.960000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfbd" class="pf w1 h2" data-page-no="bd"><div class="pc pcbd w1 h2"><img class="bi xd yd48 wc h87" alt="" src="bgbd.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">158<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 lsd ws5e4">empty plots are ﬁlled with larger buildings, some of w<span class="_ _4"></span>hich will ev<span class="_ _4"></span>entually be replaced</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">with skyscrapers.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 lsc ws22c">At ﬁrst there are no services like po<span class="_ _4"></span>wer<span class="_ _1"></span>, water<span class="_ _1"></span>, sew<span class="_ _4"></span>age, and the Inter<span class="_ _8"></span>net (gasp!). <span class="_ _4"></span>These</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 lsd wsef">services are also added as the population and building densities increase.</div><div class="t m0 x74 h14 y56d ff8 fs3 fc0 sc0 lsd ws208">This growth is not without pain. Ho<span class="_ _1"></span>w many times ha<span class="_ _4"></span>ve y<span class="_ _4"></span>ou driv<span class="_ _4"></span>en, bumper to bumper</div><div class="t m0 xd h14 y41c ff8 fs3 fc0 sc0 lsd ws496">through a road “impro<span class="_ _4"></span>vement” project and ask<span class="_ _4"></span>ed yourself, “Wh<span class="_ _4"></span>y didn’<span class="_ _4"></span>t they build it wide</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws0">enough the ﬁrst time!?”</div><div class="t m0 x74 h14 y408 ff8 fs3 fc0 sc0 ls0 ws1ed">But it couldn’<span class="_ _1"></span>t hav<span class="_ _4"></span>e happened any other w<span class="_ _4"></span>ay<span class="_ _0"></span>. <span class="_ _4"></span>Who can justify the expense of a six-</div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws18d">lane highw<span class="_ _4"></span>ay through the middle of a small to<span class="_ _1"></span>wn that anticipates g<span class="_ _8"></span>ro<span class="_ _4"></span>wth? Who w<span class="_ _1"></span>ould</div><div class="t m0 xd h14 y846 ffa fs3 fc0 sc0 ls0 ws0">want<span class="ff8"> such a road through their to<span class="_ _1"></span>wn? </span></div><div class="t m0 x74 h14 y1df ff8 fs3 fc0 sc0 ls0 ws2fe">It is a m<span class="_ _4"></span>yth that w<span class="_ _4"></span>e can get systems “right the ﬁrst time.<span class="_ _1"></span>” Instead<span class="_ _4"></span>, w<span class="_ _4"></span>e should imple-</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws5e5">ment only toda<span class="_ _1"></span>y’<span class="_ _2"></span>s <span class="ffa ws0">stories,<span class="_ _16"> </span></span>then refactor and expand the system to implement ne<span class="_ _4"></span>w stories</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws436">tomor<span class="_ _8"></span>ro<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>This is the essence of iterativ<span class="_ _4"></span>e and incremental agility<span class="_ _1"></span>. T<span class="_ _0"></span>est-driv<span class="_ _4"></span>en dev<span class="_ _4"></span>elop-</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">ment, refactoring, and the clean code they produce make this w<span class="_ _1"></span>ork at the code level.</div><div class="t m0 x74 h14 y1bf ff8 fs3 fc0 sc0 ls0 ws2b5">But what about at the system le<span class="_ _4"></span>vel? Doesn’<span class="_ _1"></span>t the system architecture require preplan-</div><div class="t m0 xd h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws0">ning? Certainly<span class="_ _0"></span>, <span class="ffa">it</span> can’<span class="_ _4"></span>t grow incrementall<span class="_ _4"></span>y from simple to complex<span class="ffa">, </span>can it?</div><div class="t m0 x74 h29 yd49 ffa fsf fc0 sc0 ls0 ws5e6">Softwar<span class="_ _4"></span>e systems ar<span class="_ _4"></span>e unique compar<span class="_ _4"></span>ed to physical systems. <span class="_ _1"></span>Their arc<span class="_ _4"></span>hitectures can gr<span class="_ _1"></span>ow</div><div class="t m0 x74 h29 yd4a ffa fsf fc0 sc0 ls0 ws0">incr<span class="_ _4"></span>ementally<span class="_ _4"></span>, <span class="ff5">if</span> w<span class="_ _4"></span>e maintain the pr<span class="_ _4"></span>oper separation of concerns.</div><div class="t m0 xd h14 y2c4 ff8 fs3 fc0 sc0 ls0 wsdd">The ephemeral nature of softw<span class="_ _4"></span>are systems makes this possible, as w<span class="_ _4"></span>e will see. Let us ﬁrst</div><div class="t m0 xd h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws0">consider a counterexample of an architecture that doesn’<span class="_ _1"></span>t separate concer<span class="_ _8"></span>ns adequately<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws3e">The original EJB1 and EJB2 architectures did not separate concerns appropriately and</div><div class="t m0 xd h14 y2c7 ff8 fs3 fc0 sc0 lsc ws5e7">thereby imposed unnecessary barriers to organic g<span class="_ _8"></span>ro<span class="_ _4"></span>wth. Consider an <span class="ffa ls0">Entity Bean <span class="ff8">for a</span></span></div><div class="t m0 xd h14 y2c8 ff8 fs3 fc0 sc0 ls0 ws0">persistent</div><div class="t m5 x80 h2f y2c8 ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x39 h14 y2c8 ff8 fs3 fc0 sc0 ls0 ws4a3">class. <span class="_ _1"></span>An entity bean is an in-memor<span class="_ _8"></span>y representation of relational data, in</div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">other w<span class="_ _4"></span>ords, a table ro<span class="_ _1"></span>w<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws3ef">First, y<span class="_ _4"></span>ou had to deﬁne a local (in process) or remote (separate JVM) interface, which</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws0">clients w<span class="_ _4"></span>ould use. Listing 11-1 sho<span class="_ _4"></span>ws a possible local interface:</div><div class="t m0 x74 h1c ycfb ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-1 </div><div class="t m0 x74 h36 y2e5 ffc fs3 fc0 sc0 ls0 ws0">An EJB2 local interface for a Bank EJB</div><div class="t m5 x74 h2f ya75 ffb fs10 fc0 sc0 ls0 ws0">package com.example.banking;</div><div class="t m5 x74 h2f ya76 ffb fs10 fc0 sc0 ls0 ws0">import java.util.Collections;</div><div class="t m5 x74 h2f ya77 ffb fs10 fc0 sc0 ls0 ws0">import javax.ejb.*;</div><div class="t m5 x74 h2f yd4b ffb fs10 fc0 sc0 ls0 ws0">public interface BankLocal extends java.ejb.EJBLocalObject {</div><div class="t m5 x74 h2f yd4c ffb fs10 fc0 sc0 ls0 ws0">  String getStreetAddr1() throws EJBException;</div><div class="t m5 x74 h2f yd4d ffb fs10 fc0 sc0 ls0 ws0">  String getStreetAddr2() throws EJBException;</div><div class="t m5 x74 h2f yd4e ffb fs10 fc0 sc0 ls0 ws0">  String getCity() throws EJBException;</div><div class="t m5 x74 h2f yd4f ffb fs10 fc0 sc0 ls0 ws0">  String getState() throws EJBException;</div><div class="t m5 x74 h2f yd50 ffb fs10 fc0 sc0 ls0 ws0">  String getZipCode() throws EJBException;</div><div class="t m5 x74 h2f yd51 ffb fs10 fc0 sc0 ls0 ws0">  void setStreetAddr1(String street1) throws EJBException;</div><div class="t m5 x74 h2f yd52 ffb fs10 fc0 sc0 ls0 ws0">  void setStreetAddr2(String street2) throws EJBException;</div><div class="t m5 x74 h2f yd53 ffb fs10 fc0 sc0 ls0 ws0">  void setCity(String city) throws EJBException;</div><div class="t m5 x74 h2f yd54 ffb fs10 fc0 sc0 ls0 ws0">  void setState(String state) throws EJBException;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfbe" class="pf w1 h2" data-page-no="be"><div class="pc pcbe w1 h2"><img class="bi xd yd55 wc h88" alt="" src="bgbe.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">159<span class="_ _10"></span><span class="ff1">Scaling Up</span></div><div class="t m0 x74 h14 ycaa ff8 fs3 fc0 sc0 ls32 ws2d8">I ha<span class="_ _4"></span>ve sho<span class="_ _4"></span>wn se<span class="_ _4"></span>veral attributes for the </div><div class="t m5 xc4 h2f y276 ffb fs10 fc0 sc0 ls31 ws0">Bank</div><div class="t m0 x68 h14 y276 ff8 fs3 fc0 sc0 ls16 ws194">’<span class="_ _2"></span>s address and a collection of accounts that</div><div class="t m0 xd h14 y277 ff8 fs3 fc0 sc0 ls16 ws5e8">the bank o<span class="_ _4"></span>wns, each of which w<span class="_ _1"></span>ould hav<span class="_ _4"></span>e its data handled by a separate </div><div class="t m5 xa6 h2f y277 ffb fs10 fc0 sc0 ls31 ws0">Account</div><div class="t m0 x30 h14 y277 ff8 fs3 fc0 sc0 ls16 ws0">EJB<span class="_ _4"></span>.</div><div class="t m0 xd h14 y278 ff8 fs3 fc0 sc0 ls16 ws0">Listing 11-2 sho<span class="_ _4"></span>ws the cor<span class="_ _8"></span>responding implementation class for the </div><div class="t m5 x58 h2f y278 ffb fs10 fc0 sc0 ls31 ws0">Bank</div><div class="t m0 xaf h14 y278 ff8 fs3 fc0 sc0 ls16 ws0"> bean.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  void setZipCode(String zip) throws EJBException;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  Collection getAccounts() throws EJBException;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  void setAccounts(Collection accounts) throws EJBException;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  void addAccount(AccountDTO accountDTO) throws EJBException;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y570 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-2 </div><div class="t m0 x74 h36 y387 ffc fs3 fc0 sc0 ls0 ws0">The corresponding EJB2 Entity Bean Implementation</div><div class="t m5 x74 h2f yd56 ffb fs10 fc0 sc0 ls0 ws0">package com.example.banking;</div><div class="t m5 x74 h2f yd57 ffb fs10 fc0 sc0 ls0 ws0">import java.util.Collections;</div><div class="t m5 x74 h2f yd58 ffb fs10 fc0 sc0 ls0 ws0">import javax.ejb.*;</div><div class="t m5 x74 h2f yd59 ffb fs10 fc0 sc0 ls0 ws0">public abstract class Bank implements javax.ejb.EntityBean {</div><div class="t m5 x74 h2f yd5a ffb fs10 fc0 sc0 ls0 ws0">  // Business logic...</div><div class="t m5 x74 h2f yd5b ffb fs10 fc0 sc0 ls0 ws0">  public abstract String getStreetAddr1();</div><div class="t m5 x74 h2f yd5c ffb fs10 fc0 sc0 ls0 ws0">  public abstract String getStreetAddr2();</div><div class="t m5 x74 h2f yd5d ffb fs10 fc0 sc0 ls0 ws0">  public abstract String getCity();</div><div class="t m5 x74 h2f yd5e ffb fs10 fc0 sc0 ls0 ws0">  public abstract String getState();</div><div class="t m5 x74 h2f yd5f ffb fs10 fc0 sc0 ls0 ws0">  public abstract String getZipCode();</div><div class="t m5 x74 h2f yd60 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setStreetAddr1(String street1);</div><div class="t m5 x74 h2f yd61 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setStreetAddr2(String street2);</div><div class="t m5 x74 h2f yd62 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setCity(String city);</div><div class="t m5 x74 h2f yd63 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setState(String state);</div><div class="t m5 x74 h2f yd64 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setZipCode(String zip);</div><div class="t m5 x74 h2f yd65 ffb fs10 fc0 sc0 ls0 ws0">  public abstract Collection getAccounts();</div><div class="t m5 x74 h2f yd66 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setAccounts(Collection accounts);</div><div class="t m5 x74 h2f yd67 ffb fs10 fc0 sc0 ls0 ws0">  public void addAccount(AccountDTO accountDTO) {</div><div class="t m5 x74 h2f yd68 ffb fs10 fc0 sc0 ls0 ws0">    InitialContext context = new InitialContext();</div><div class="t m5 x74 h2f yd69 ffb fs10 fc0 sc0 ls0 ws0">    AccountHomeLocal accountHome = context.lookup(&quot;AccountHomeLocal&quot;);</div><div class="t m5 x74 h2f yd6a ffb fs10 fc0 sc0 ls0 ws0">    AccountLocal account = accountHome.create(accountDTO);</div><div class="t m5 x74 h2f yd6b ffb fs10 fc0 sc0 ls0 ws0">    Collection accounts = getAccounts();</div><div class="t m5 x74 h2f yd6c ffb fs10 fc0 sc0 ls0 ws0">    accounts.add(account);</div><div class="t m5 x74 h2f yd6d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yd6e ffb fs10 fc0 sc0 ls0 ws0">  // EJB container logic</div><div class="t m5 x74 h2f yd6f ffb fs10 fc0 sc0 ls0 ws0">  public abstract void setId(Integer id);</div><div class="t m5 x74 h2f yd70 ffb fs10 fc0 sc0 ls0 ws0">  public abstract Integer getId();</div><div class="t m5 x74 h2f yd71 ffb fs10 fc0 sc0 ls0 ws0">  public Integer ejbCreate(Integer id) { ... }</div><div class="t m5 x74 h2f yd72 ffb fs10 fc0 sc0 ls0 ws0">  public void ejbPostCreate(Integer id) { ... }</div><div class="t m5 x74 h2f yd73 ffb fs10 fc0 sc0 ls0 ws0">  // The rest had to be implemented but were usually empty:</div><div class="t m5 x74 h2f yd74 ffb fs10 fc0 sc0 ls0 ws0">  public void setEntityContext(EntityContext ctx) {} </div><div class="t m5 x74 h2f yd75 ffb fs10 fc0 sc0 ls0 ws0">  public void unsetEntityContext() {}</div><div class="t m5 x74 h2f yd76 ffb fs10 fc0 sc0 ls0 ws0">  public void ejbActivate() {}</div><div class="t m5 x74 h2f yd77 ffb fs10 fc0 sc0 ls0 ws0">  public void ejbPassivate() {}</div><div class="t m5 x74 h2f yd78 ffb fs10 fc0 sc0 ls0 ws0">  public void ejbLoad() {}</div><div class="t m5 x74 h2f yd79 ffb fs10 fc0 sc0 ls0 ws0">  public void ejbStore() {}</div><div class="t m5 x74 h2f yd7a ffb fs10 fc0 sc0 ls0 ws0">  public void ejbRemove() {}</div><div class="t m5 x74 h2f yd7b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">An EJB2 local interface for a Bank EJB</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfbf" class="pf w1 h2" data-page-no="bf"><div class="pc pcbf w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bgbf.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">160<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws5e9">I ha<span class="_ _4"></span>ven’<span class="_ _1"></span>t shown the corresponding <span class="ffa ws0">LocalHome </span>interf<span class="_ _8"></span>ace, essentially a factory used to</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">create objects, nor an<span class="_ _4"></span>y of the possible </div><div class="t m5 x32 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x4b h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> ﬁnder (query) methods you might add. </div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws5e">Finall<span class="_ _4"></span>y<span class="_ _0"></span>, you had to write one or more XML deplo<span class="_ _1"></span>yment descriptors that specify the</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws75">object-relational mapping details to a persistence store, the desired transactional beha<span class="_ _4"></span>vior<span class="_ _4"></span>,</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">security constraints, and so on<span class="ffa">.</span></div><div class="t m0 x74 h14 y41c ff8 fs3 fc0 sc0 lsd ws378">The business lo<span class="_ _4"></span>gic is tightly coupled to the EJB2 application “container<span class="_ _1"></span>.<span class="_ _1"></span>” <span class="_ _1"></span>Y<span class="_ _3"></span>ou must</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws5ba">subclass container types and you must pro<span class="_ _1"></span>vide many lifec<span class="_ _4"></span>ycle methods that are required</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws0">by the container<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y409 ff8 fs3 fc0 sc0 ls0 ws66">Because of this coupling to the hea<span class="_ _4"></span>vyw<span class="_ _4"></span>eight container, isolated unit testing is dif<span class="_ _4"></span>ﬁcult.</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws559">It is necessary to mock out the container, w<span class="_ _4"></span>hich is hard<span class="_ _1"></span>, or waste a lot of time deplo<span class="_ _1"></span>ying</div><div class="t m0 xd h14 y92b ff8 fs3 fc0 sc0 ls0 ws4fd">EJBs and tests to a real server<span class="_ _1"></span>. Reuse outside of the EJB2 architecture is effecti<span class="_ _4"></span>vely impos-</div><div class="t m0 xd h14 y209 ff8 fs3 fc0 sc0 ls0 ws0">sible, due to the tight coupling. </div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws395">Finall<span class="_ _4"></span>y<span class="_ _0"></span>, even object-oriented pro<span class="_ _1"></span>g<span class="_ _8"></span>ramming is under<span class="_ _8"></span>mined. One bean cannot inherit</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws494">from another bean. Notice the lo<span class="_ _4"></span>gic for adding a new account. It is common in EJB2 beans</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws3c4">to deﬁne “data transfer objects” (DT<span class="_ _4"></span>Os) that are essentially “structs” with no beha<span class="_ _4"></span>vior<span class="_ _4"></span>.</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws28a">This usuall<span class="_ _4"></span>y leads to redundant types holding essentially the same data, and it requires</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">boiler<span class="_ _8"></span>plate code to cop<span class="_ _4"></span>y data from one object to another<span class="_ _4"></span>.</div><div class="t m0 xd h11 y63a ff1 fs7 fc0 sc0 ls0 ws0">Cr<span class="_ _4"></span>oss-Cutting Concerns</div><div class="t m0 xd h14 y5c3 ff8 fs3 fc0 sc0 ls0 ws5ea">The EJB2 architecture comes close to true separation of concer<span class="_ _8"></span>ns in some areas. F<span class="_ _4"></span>or</div><div class="t m0 xd h14 y5c4 ff8 fs3 fc0 sc0 ls0 ws5eb">example, the desired transactional, security<span class="_ _0"></span>, and some of the persistence beha<span class="_ _4"></span>viors are</div><div class="t m0 xd h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws0">declared in the deplo<span class="_ _4"></span>yment descriptors, independentl<span class="_ _4"></span>y of the source code. </div><div class="t m0 x74 h14 y5c5 ff8 fs3 fc0 sc0 ls0 wsa3">Note that <span class="ffa ws0">concerns </span>like persistence tend to cut across the natural object boundaries of</div><div class="t m0 xd h14 y5c7 ff8 fs3 fc0 sc0 ls0 ws7d">a domain. <span class="_ _0"></span>Y<span class="_ _2"></span>ou w<span class="_ _4"></span>ant to persist all your objects using generall<span class="_ _4"></span>y the same strategy<span class="_ _0"></span>, for exam-</div><div class="t m0 xd h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws0">ple<span class="ffa">,<span class="_ _18"> </span></span><span class="ws42b">using a particular DBMS</span></div><div class="t m0 x1 h21 y416 ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 x84 h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws42b">versus ﬂat ﬁles, follo<span class="_ _1"></span>wing cer<span class="_ _8"></span>tain naming con<span class="_ _4"></span>ventions for</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws0">tables and columns, using consistent transactional semantics, and so on<span class="ffa">.</span></div><div class="t m0 x74 h14 y670 ff8 fs3 fc0 sc0 ls10 ws2be">In principle, you can reason about y<span class="_ _4"></span>our persistence strategy in a modular<span class="_ _1"></span>, encapsulated</div><div class="t m0 xd h14 y671 ff8 fs3 fc0 sc0 ls10 ws49f">w<span class="_ _4"></span>ay<span class="_ _0"></span>.<span class="_ _d"> </span>Y<span class="_ _3"></span>et, in practice, you ha<span class="_ _4"></span>ve to spread essentiall<span class="_ _4"></span>y the same code that implements the persis-</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls10 ws540">tence strategy across man<span class="_ _4"></span>y objects. <span class="_ _4"></span>W<span class="_ _0"></span>e use the ter<span class="_ _8"></span>m <span class="ffa ws583">cr<span class="_ _4"></span>oss-cutting concerns <span class="ff8">for concerns like</span></span></div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls10 ws58c">these. <span class="_ _1"></span>Again, the persistence framew<span class="_ _4"></span>ork might be modular and our domain lo<span class="_ _4"></span>gic, in isola-</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls10 ws0">tion, might be modular<span class="_ _1"></span>. <span class="_ _4"></span>The problem is the ﬁne-grained <span class="ffa">intersection </span>of these domains.</div><div class="t m0 x74 h14 yd7c ff8 fs3 fc0 sc0 ls0 ws5ec">In fact, the wa<span class="_ _1"></span>y the EJB architecture handled persistence, security<span class="_ _1"></span>, and transactions<span class="ffa ws0">,</span></div><div class="t m0 xd h14 y676 ff8 fs3 fc0 sc0 ls0 ws0">“anticipated”<span class="_ _a"> </span><span class="ffa ws179">aspect-oriented pr<span class="_ _4"></span>ogr<span class="_ _1"></span>amming <span class="ff8 ws0">(A<span class="_ _4"></span>OP),</span></span></div><div class="t m0 x7e h21 y3ff ff8 fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 x96 h14 y6da ff8 fs3 fc0 sc0 ls0 ws179">which is a general-purpose approach</div><div class="t m0 xd h14 y6db ff8 fs3 fc0 sc0 ls0 ws0">to restoring modularity for cross-cutting concerns.</div><div class="t m0 x74 h14 y6dc ff8 fs3 fc0 sc0 ls0 ws4b3">In <span class="_ _1"></span>A<span class="_ _4"></span>OP<span class="_ _3"></span>, modular constr<span class="_ _8"></span>ucts called <span class="ffa ws0">aspects<span class="_ _18"> </span></span>specify which points in the system should</div><div class="t m0 xd h14 y6dd ff8 fs3 fc0 sc0 ls0 ws5ed">ha<span class="_ _4"></span>ve their beha<span class="_ _4"></span>vior modiﬁed in some consistent wa<span class="_ _1"></span>y to suppor<span class="_ _8"></span>t a par<span class="_ _8"></span>ticular concern. <span class="_ _4"></span>This</div><div class="t m0 xd h14 y6de ff8 fs3 fc0 sc0 ls0 ws0">speciﬁcation is done using a succinct declarativ<span class="_ _4"></span>e or programmatic mechanism. </div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _17"> </span>Database management system.</div><div class="t m0 xd h25 y39b ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _17"> </span>See [A<span class="_ _1"></span>OSD] for general infor<span class="_ _8"></span>mation on aspects and [AspectJ]] and [Coly<span class="_ _4"></span>er] for AspectJ-speciﬁc information.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:354.728010px;width:123.783000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc0" class="pf w1 h2" data-page-no="c0"><div class="pc pcc0 w1 h2"><img class="bi xd yd7d wc h89" alt="" src="bgc0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">161<span class="_ _10"></span><span class="ff1">Ja<span class="_ _1"></span>va Pr<span class="_ _1"></span>oxies</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 lsd ws46d">Using persistence as an example, y<span class="_ _4"></span>ou w<span class="_ _4"></span>ould declare which objects and attributes (or</div><div class="t m0 xd h14 y195 ffa fs3 fc0 sc0 ls0 ws0">patterns <span class="ff8 lsc ws568">thereof) should be persisted and then dele<span class="_ _4"></span>gate the persistence tasks to your persis-</span></div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws69">tence framew<span class="_ _1"></span>ork. <span class="_ _4"></span>The beha<span class="_ _4"></span>vior modiﬁcations are made <span class="ffa ws0">nonin<span class="_ _4"></span>vasively</span></div><div class="t m0 x6b h21 y560 ff8 fsc fc0 sc0 ls0 ws0">8</div><div class="t m0 x8d h14 y196 ff8 fs3 fc0 sc0 ls0 ws69">to the target code</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">by the <span class="_ _0"></span>A<span class="_ _4"></span>OP framew<span class="_ _1"></span>ork. Let us look at three aspects or aspect-like mechanisms in Ja<span class="_ _4"></span>va.</div><div class="t m0 xd h17 yc56 ff1 fs9 fc0 sc0 ls0 ws0">Ja<span class="_ _0"></span>v<span class="_ _4"></span>a Pr<span class="_ _4"></span>o<span class="_ _1"></span>xies</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws1a6">Ja<span class="_ _4"></span>va pro<span class="_ _4"></span>xies are suitable for simple situations, such as wrapping method calls in indi<span class="_ _4"></span>vidual</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws2e6">objects or classes. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the dynamic pro<span class="_ _4"></span>xies pro<span class="_ _4"></span>vided in the JDK onl<span class="_ _4"></span>y w<span class="_ _4"></span>ork with</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws5ee">interfaces. <span class="_ _4"></span>T<span class="_ _1"></span>o proxy classes, y<span class="_ _4"></span>ou ha<span class="_ _4"></span>ve to use a b<span class="_ _4"></span>yte-code manipulation librar<span class="_ _8"></span>y<span class="_ _0"></span>, such as</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws0">CGLIB<span class="_ _4"></span>, ASM, or Jav<span class="_ _4"></span>assist.</div><div class="t m0 x1f h21 y5dd ff8 fsc fc0 sc0 ls0 ws0">9</div><div class="t m0 x74 h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws41b">Listing 11-3 sho<span class="_ _4"></span>ws the skeleton for a JDK pro<span class="_ _4"></span>xy to pro<span class="_ _4"></span>vide persistence suppor<span class="_ _8"></span>t for</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">our</div><div class="t m5 xe7 h2f y536 ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x9a h14 y536 ff8 fs3 fc0 sc0 ls0 ws2a0">application, co<span class="_ _4"></span>vering onl<span class="_ _4"></span>y the methods for getting and setting the list of accounts.</div><div class="t m0 xd h25 yd7e ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _17"> </span>Meaning no manual editing of the tar<span class="_ _4"></span>get source code is required.</div><div class="t m0 xd h25 yd7f ff8 fse fc0 sc0 ls0 ws0">9.<span class="_ _17"> </span>See [CGLIB], [ASM], and [Ja<span class="_ _4"></span>vassist].</div><div class="t m0 x74 h1c yc1f ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-3 </div><div class="t m0 x74 h36 yc20 ffc fs3 fc0 sc0 ls0 ws0">JDK Proxy Example</div><div class="t m5 x74 h2f yc21 ffb fs10 fc0 sc0 ls0 ws0">// Bank.java (suppressing package names...)</div><div class="t m5 x74 h2f yc22 ffb fs10 fc0 sc0 ls0 ws0">import java.utils.*;</div><div class="t m5 x74 h2f yc23 ffb fs10 fc0 sc0 ls0 ws0">// The abstraction of a bank.</div><div class="t m5 x74 h2f yd80 ffb fs10 fc0 sc0 ls0 ws0">public interface Bank {</div><div class="t m5 x74 h2f yc24 ffb fs10 fc0 sc0 ls0 ws0">  Collection&lt;Account&gt; getAccounts();</div><div class="t m5 x74 h2f yc25 ffb fs10 fc0 sc0 ls0 ws0">  void setAccounts(Collection&lt;Account&gt; accounts);</div><div class="t m5 x74 h2f yd81 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yd82 ffb fs10 fc0 sc0 ls0 ws0">// BankImpl.java</div><div class="t m5 x74 h2f yd83 ffb fs10 fc0 sc0 ls0 ws0">import java.utils.*;</div><div class="t m5 x74 h2f yd84 ffb fs10 fc0 sc0 ls0 ws0">// The “Plain Old Java Object” (POJO) implementing the abstraction.</div><div class="t m5 x74 h2f yd85 ffb fs10 fc0 sc0 ls0 ws0">public class BankImpl implements Bank {</div><div class="t m5 x74 h2f yd86 ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;Account&gt; accounts;</div><div class="t m5 x74 h2f yd87 ffb fs10 fc0 sc0 ls0 ws0">  public Collection&lt;Account&gt; getAccounts() { </div><div class="t m5 x74 h2f yd88 ffb fs10 fc0 sc0 ls0 ws0">    return accounts; </div><div class="t m5 x74 h2f yd89 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yd8a ffb fs10 fc0 sc0 ls0 ws0">  public void setAccounts(Collection&lt;Account&gt; accounts) { </div><div class="t m5 x74 h2f yd8b ffb fs10 fc0 sc0 ls0 ws0">    this.accounts = new ArrayList&lt;Account&gt;(); </div><div class="t m5 x74 h2f yd8c ffb fs10 fc0 sc0 ls0 ws0">    for (Account account: accounts) {</div><div class="t m5 x74 h2f yd8d ffb fs10 fc0 sc0 ls1a ws2f6">      this.accounts.add(account);</div><div class="t m5 x74 h2f yd8e ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yd8f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yd90 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yd91 ffb fs10 fc0 sc0 ls0 ws0">// BankProxyHandler.java</div><div class="t m5 x74 h2f yd92 ffb fs10 fc0 sc0 ls0 ws0">import java.lang.reflect.*;</div><div class="t m5 x74 h2f yd93 ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:514.945010px;width:73.455000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc1" class="pf w1 h2" data-page-no="c1"><div class="pc pcc1 w1 h2"><img class="bi xd yd94 wc h8a" alt="" src="bgc1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">162<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 x74 h14 y7bd ff8 fs3 fc0 sc0 ls0 ws154">W<span class="_ _0"></span>e deﬁned an interface </div><div class="t m5 x5a h2f y7bd ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x8 h14 y7bd ff8 fs3 fc0 sc0 ls0 ws154">, which will be <span class="ffa ws0">wr<span class="_ _1"></span>apped <span class="_ _6"></span><span class="ff8 ws154">b<span class="_ _4"></span>y the proxy<span class="_ _0"></span>, and a <span class="ffa ws0">Plain-Old</span></span></span></div><div class="t m0 xd h14 yd95 ffa fs3 fc0 sc0 ls0 wse0">J<span class="_ _4"></span>ava Object<span class="ff8 ls58 ws3f3"> (POJO), </span></div><div class="t m5 x9 h2f yd95 ffb fs10 fc0 sc0 ls0 ws0">BankImpl</div><div class="t m0 x1 h14 yd95 ff8 fs3 fc0 sc0 lsd ws4ba">, that implements the business lo<span class="_ _4"></span>gic. (W<span class="_ _0"></span>e will revisit POJOs</div><div class="t m0 xd h14 yd96 ff8 fs3 fc0 sc0 ls0 ws0">shortly<span class="_ _0"></span>.)</div><div class="t m0 x74 h14 yd14 ff8 fs3 fc0 sc0 ls34 ws570">The Proxy <span class="_ _1"></span>API requires an </div><div class="t m5 x92 h2f yd14 ffb fs10 fc0 sc0 ls66 ws0">InvocationHandler</div><div class="t m0 xb4 h14 yd14 ff8 fs3 fc0 sc0 ls34 ws570">object that it calls to implement an<span class="_ _4"></span>y</div><div class="t m5 xd h2f yd97 ffb fs10 fc0 sc0 ls66 ws0">Bank</div><div class="t m0 x7c h14 yd97 ff8 fs3 fc0 sc0 ls34 ws5ef">method calls made to the proxy<span class="_ _0"></span>. Our </div><div class="t m5 x65 h2f yd97 ffb fs10 fc0 sc0 ls66 ws0">BankProxyHandler</div><div class="t m0 xa0 h14 yd97 ff8 fs3 fc0 sc0 ls34 ws5ef">uses the Ja<span class="_ _4"></span>va reﬂection</div><div class="t m0 xd h14 y97b ff8 fs3 fc0 sc0 ls34 ws3f8">API to map the generic method in<span class="_ _4"></span>vocations to the corresponding methods in </div><div class="t m5 x99 h2f y97b ffb fs10 fc0 sc0 ls66 ws0">BankImpl</div><div class="t m0 x56 h14 y97b ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 xd h14 y97c ff8 fs3 fc0 sc0 ls34 ws0">and so on.</div><div class="t m0 x74 h14 y87d ff8 fs3 fc0 sc0 ls0 ws2df">There is a <span class="ffa ws0">lot </span>of code here and it is relativ<span class="_ _4"></span>ely complicated<span class="_ _1"></span>, ev<span class="_ _4"></span>en for this simple case.</div><div class="t m0 x50 h21 y710 ff8 fsc fc0 sc0 ls0 ws0">10</div><div class="t m0 xd h14 y87e ff8 fs3 fc0 sc0 ls0 ws3d1">Using one of the b<span class="_ _4"></span>yte-manipulation libraries is similarly challenging. <span class="_ _1"></span>This code “volume”</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">// “InvocationHandler” required by the proxy API.</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">public class BankProxyHandler implements InvocationHandler {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  private Bank bank;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  public BankHandler (Bank bank) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    this.bank = bank;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  // Method defined in InvocationHandler</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  public Object invoke(Object proxy, Method method, Object[] args) </div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      throws Throwable {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    String methodName = method.getName();</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    if (methodName.equals(&quot;getAccounts&quot;)) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      bank.setAccounts(getAccountsFromDatabase());</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      return bank.getAccounts();</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    } else if (methodName.equals(&quot;setAccounts&quot;)) {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      bank.setAccounts((Collection&lt;Account&gt;) args[0]);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      setAccountsToDatabase(bank.getAccounts());</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      return null;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">      ...</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  // Lots of details here:</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  protected Collection&lt;Account&gt; getAccountsFromDatabase() { ... }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  protected void setAccountsToDatabase(Collection&lt;Account&gt; accounts) { ... }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">// Somewhere else...</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">Bank bank = (Bank) Proxy.newProxyInstance(</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  Bank.class.getClassLoader(), </div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  new Class[] { Bank.class },</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  new BankProxyHandler(new BankImpl()));</div><div class="t m0 xd h25 y200 ff8 fse fc0 sc0 ls0 ws0">10.<span class="_ _16"> </span>F<span class="_ _4"></span>or more detailed examples of the Proxy <span class="_ _1"></span>API and examples of its use, see, for example, [Goetz].</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-3 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">JDK Proxy Example</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc2" class="pf w1 h2" data-page-no="c2"><div class="pc pcc2 w1 h2"><img class="bi xd yd98 wc h8b" alt="" src="bgc2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">163<span class="_ _10"></span><span class="ff1">Pur<span class="_ _4"></span>e Ja<span class="_ _1"></span>va <span class="_ _0"></span>A<span class="_ _4"></span>OP F<span class="_ _4"></span>ramew<span class="_ _1"></span>orks</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws5f0">and complexity are tw<span class="_ _1"></span>o of the drawbacks of pro<span class="_ _4"></span>xies. <span class="_ _4"></span>They mak<span class="_ _4"></span>e it hard to create clean</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws59f">code! <span class="_ _1"></span>Also, proxies don’<span class="_ _1"></span>t provide a mechanism for specifying system-wide e<span class="_ _4"></span>xecution</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">“points” of interest, which is needed for a true <span class="_ _1"></span>A<span class="_ _4"></span>OP solution.</div><div class="t m0 x6a h21 y560 ff8 fsc fc0 sc0 ls0 ws0">11</div><div class="t m0 xd h17 y680 ff1 fs9 fc0 sc0 ls0 ws0">Pur<span class="_ _4"></span>e Ja<span class="_ _0"></span>v<span class="_ _4"></span>a <span class="_ _0"></span>A<span class="_ _1"></span>OP F<span class="_ _1"></span>ramew<span class="_ _1"></span>orks</div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws47a">F<span class="_ _1"></span>or<span class="_ _8"></span>tunately<span class="_ _0"></span>, most of the proxy boilerplate can be handled automatically b<span class="_ _4"></span>y tools. Proxies</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws4ac">are used internally in se<span class="_ _4"></span>veral Ja<span class="_ _4"></span>va frame<span class="_ _4"></span>w<span class="_ _4"></span>orks, for example, Spring <span class="_ _1"></span>A<span class="_ _1"></span>OP and JBoss <span class="_ _4"></span>A<span class="_ _4"></span>OP<span class="_ _3"></span>,</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws2e2">to implement aspects in pure Ja<span class="_ _4"></span>va.</div><div class="t m0 xc h21 y5db ff8 fsc fc0 sc0 ls0 ws0">12</div><div class="t m0 xd1 h14 y29b ff8 fs3 fc0 sc0 lsd ws5f1">In Spring, you write y<span class="_ _4"></span>our business logic as <span class="ffa ls0 ws0">Plain-Old</span></div><div class="t m0 xd h14 y251 ffa fs3 fc0 sc0 ls0 ws5f2">J<span class="_ _4"></span>ava Objects<span class="ff8">. POJOs are purely focused on their domain. <span class="_ _1"></span>They ha<span class="_ _4"></span>ve no dependencies on</span></div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws328">enter<span class="_ _8"></span>prise framew<span class="_ _1"></span>orks (or any other domains). Hence, the<span class="_ _4"></span>y are conceptually simpler and</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws5f3">easier to test dri<span class="_ _4"></span>ve. <span class="_ _4"></span>The relati<span class="_ _4"></span>ve simplicity makes it easier to ensure that y<span class="_ _4"></span>ou are imple-</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws5f4">menting the cor<span class="_ _8"></span>responding user stories cor<span class="_ _8"></span>rectly and to maintain and e<span class="_ _4"></span>volv<span class="_ _4"></span>e the code for</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">future stories. </div><div class="t m0 x74 h14 y256 ff8 fs3 fc0 sc0 ls12 ws209">Y<span class="_ _3"></span>ou incor<span class="_ _8"></span>porate the required application infrastr<span class="_ _8"></span>ucture, including cross-cutting con-</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls12 ws5f5">cerns like persistence, transactions, security<span class="_ _1"></span>, caching, failo<span class="_ _4"></span>ver<span class="_ _4"></span>, and so on, using declara-</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls12 ws5f6">ti<span class="_ _4"></span>ve conﬁguration ﬁles or <span class="_ _1"></span>APIs. In many cases, you are actuall<span class="_ _4"></span>y specifying Spring or</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls12 ws493">JBoss library aspects, where the framew<span class="_ _1"></span>ork handles the mechanics of using Ja<span class="_ _4"></span>va pro<span class="_ _4"></span>xies</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls12 wsc0">or b<span class="_ _4"></span>yte-code libraries transparently to the user<span class="_ _1"></span>. <span class="_ _4"></span>These declarations driv<span class="_ _4"></span>e the dependency</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 ls12 ws2a2">injection (DI) container<span class="_ _4"></span>, which instantiates the major objects and wires them to<span class="_ _4"></span>gether on</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls12 ws0">demand<span class="ffa ls0">.</span></div><div class="t m0 x74 h14 y25d ff8 fs3 fc0 sc0 ls0 ws0">Listing 11-4 sho<span class="_ _4"></span>ws a typical fragment of a Spring <span class="_ _4"></span>V2.5 conﬁguration ﬁle, app.xml</div><div class="t m0 x25 h21 y5c4 ff8 fsc fc0 sc0 ls0 ws0">13</div><div class="t m0 x1d h14 yd99 ff8 fs3 fc0 sc0 ls0 ws0">:</div><div class="t m0 xd h25 yd9a ff8 fse fc0 sc0 ls0 ws0">11.<span class="_ _16"> </span>A<span class="_ _4"></span>OP is sometimes confused with techniques used to implement it, such as method interception and “wrapping” through </div><div class="t m0 x3b h25 yd9b ff8 fse fc0 sc0 ls0 ws0">proxies. <span class="_ _1"></span>The real value of an <span class="_ _4"></span>A<span class="_ _4"></span>OP system is the ability to specify systemic behaviors in a concise and modular wa<span class="_ _4"></span>y<span class="_ _1"></span>. </div><div class="t m0 xd h25 yd9c ff8 fse fc0 sc0 ls0 ws0">12.<span class="_ _16"> </span>See [Spring] and [JBoss]. “Pure Ja<span class="_ _4"></span>va” means without the use of <span class="_ _4"></span>AspectJ<span class="_ _4"></span>.</div><div class="t m0 x74 h1c y5c5 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-4 </div><div class="t m0 x74 h36 y374 ffc fs3 fc0 sc0 ls0 ws0">Spring 2.X configuration file</div><div class="t m5 x74 h2f y58a ffb fs10 fc0 sc0 ls0 ws0">&lt;beans&gt;</div><div class="t m5 x74 h2f yd9d ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f yd9e ffb fs10 fc0 sc0 ls0 ws0">  &lt;bean id=&quot;appDataSource&quot;</div><div class="t m5 x52 h2f yd9f ffb fs10 fc0 sc0 ls0 ws0">class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;</div><div class="t m5 x52 h2f yda0 ffb fs10 fc0 sc0 ls0 ws0">destroy-method=&quot;close&quot;</div><div class="t m5 x52 h2f yda1 ffb fs10 fc0 sc0 ls0 ws0">p:driverClassName=&quot;com.mysql.jdbc.Driver&quot;</div><div class="t m5 x52 h2f yda2 ffb fs10 fc0 sc0 ls0 ws0">p:url=&quot;jdbc:mysql://localhost:3306/mydb&quot;</div><div class="t m5 x52 h2f yda3 ffb fs10 fc0 sc0 ls0 ws0">p:username=&quot;me&quot;/&gt;</div><div class="t m5 x74 h2f yda4 ffb fs10 fc0 sc0 ls0 ws0">  &lt;bean id=&quot;bankDataAccessObject&quot;</div><div class="t m5 x52 h2f yda5 ffb fs10 fc0 sc0 ls0 ws0">class=&quot;com.example.banking.persistence.BankDataAccessObject&quot;</div><div class="t m5 x52 h2f yda6 ffb fs10 fc0 sc0 ls0 ws0">p:dataSource-ref=&quot;appDataSource&quot;/&gt;</div><div class="t m5 x74 h2f yda7 ffb fs10 fc0 sc0 ls0 ws0">  &lt;bean id=&quot;bank&quot; </div><div class="t m0 xd h25 yda8 ff8 fse fc0 sc0 ls0 ws0">13.<span class="_ _16"> </span>Adapted from http://www<span class="_ _1"></span>.theserverside.com/tt/articles/ar<span class="_ _8"></span>ticle.tss?l=IntrotoSpring25</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:526.945010px;width:167.799000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.theserverside.com/tt/articles/article.tss?l=IntrotoSpring25"><div class="d m1" style="border-style:none;position:absolute;left:131.658000px;bottom:86.949110px;width:194.364000px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc3" class="pf w1 h2" data-page-no="c3"><div class="pc pcc3 w1 h2"><img class="bi xd yda9 wc h8c" alt="" src="bgc3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">164<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 x74 h14 ydaa ff8 fs3 fc0 sc0 ls0 ws409">Each “bean” is like one part of a nested “Russian doll,<span class="_ _1"></span>” with a domain object for a</div><div class="t m5 xd h2f y2a9 ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x8e h14 y2a9 ff8 fs3 fc0 sc0 ls0 ws5f7">proxied (wrapped) b<span class="_ _4"></span>y a data accessor object (D<span class="_ _4"></span>A<span class="_ _1"></span>O), which is itself proxied b<span class="_ _4"></span>y a</div><div class="t m0 xd h14 y2aa ff8 fs3 fc0 sc0 ls0 ws0">JDBC driv<span class="_ _4"></span>er data source. (See Figure 11-3.)</div><div class="t m0 x74 h14 ydab ff8 fs3 fc0 sc0 ls0 ws15d">The client belie<span class="_ _4"></span>ves it is in<span class="_ _4"></span>voking </div><div class="t m5 x26 h2f ydac ffb fs10 fc0 sc0 ls0 ws0">getAccounts()</div><div class="t m0 xb2 h14 ydac ff8 fs3 fc0 sc0 ls0 ws15d">on a </div><div class="t m5 x9f h2f ydac ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 xe8 h14 ydac ff8 fs3 fc0 sc0 ls11 ws1a6">object, but it is actuall<span class="_ _4"></span>y talk-</div><div class="t m0 xd h14 ydad ff8 fs3 fc0 sc0 ls0 ws3e3">ing to the outermost of a set of nested D<span class="fsb ws0">ECORATOR</span></div><div class="t m0 x4f h21 ydae ff8 fsc fc0 sc0 ls0 ws0">14</div><div class="t m0 xb4 h14 ydad ff8 fs3 fc0 sc0 ls0 ws3e3">objects that extend the basic beha<span class="_ _1"></span>vior</div><div class="t m0 xd h14 ydaf ff8 fs3 fc0 sc0 ls0 ws0">of the </div><div class="t m5 x3e h2f ydb0 ffb fs10 fc0 sc0 ls0 ws0">Bank</div><div class="t m0 x5f h14 ydb0 ff8 fs3 fc0 sc0 ls0 ws0"> POJO<span class="_ _4"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>e could add other decorators for transactions, caching, and so for<span class="_ _8"></span>th<span class="ffa">.</span></div><div class="t m0 x74 h14 ydb1 ff8 fs3 fc0 sc0 ls0 ws5f8">In the application, a fe<span class="_ _4"></span>w lines are needed to ask the DI container for the top-level</div><div class="t m0 xd h14 ydb2 ff8 fs3 fc0 sc0 ls0 ws0">objects in the system, as speciﬁed in the XML ﬁle.</div><div class="t m5 x74 h2f ydb3 ffb fs10 fc0 sc0 ls0 ws0">XmlBeanFactory bf =</div><div class="t m5 x52 h2f ydb4 ffb fs10 fc0 sc0 ls0 ws0">new XmlBeanFactory(new ClassPathResource(&quot;app.xml&quot;, getClass()));</div><div class="t m5 x74 h2f ydb5 ffb fs10 fc0 sc0 ls0 ws0">Bank bank = (Bank) bf.getBean(&quot;bank&quot;);</div><div class="t m0 xd h14 ydb6 ff8 fs3 fc0 sc0 ls0 ws5f9">Because so fe<span class="_ _4"></span>w lines of Spring-speciﬁc Jav<span class="_ _4"></span>a code are required<span class="_ _1"></span>, <span class="ffa">the application is almost</span></div><div class="t m0 xd h14 ydb7 ffa fs3 fc0 sc0 ls0 ws44a">completely decoupled fr<span class="_ _1"></span>om Spring<span class="ff8">, eliminating all the tight-coupling problems of systems</span></div><div class="t m0 xd h14 ydb8 ff8 fs3 fc0 sc0 ls0 ws0">like EJB2.</div><div class="t m0 x74 h14 ydb9 ff8 fs3 fc0 sc0 ls16 ws5fa">Although XML can be verbose and hard to read<span class="_ _1"></span>,</div><div class="t m0 xb4 h21 ydba ff8 fsc fc0 sc0 ls67 ws0">15</div><div class="t m0 x27 h14 ydbb ff8 fs3 fc0 sc0 ls16 ws5fa">the “policy” speciﬁed in these con-</div><div class="t m0 xd h14 ydbc ff8 fs3 fc0 sc0 ls16 ws360">ﬁguration ﬁles is simpler than the complicated proxy and aspect lo<span class="_ _4"></span>gic that is hidden from</div><div class="t m0 xd h14 ydbd ff8 fs3 fc0 sc0 ls16 ws5fb">view and created automaticall<span class="_ _1"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>This type of architecture is so compelling that frame-</div><div class="t m0 xd h14 ydbe ff8 fs3 fc0 sc0 ls16 ws5fc">w<span class="_ _4"></span>orks like Spring led to a complete o<span class="_ _1"></span>verhaul of the EJB standard for version 3. EJB3</div><div class="t m5 x52 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">class=&quot;com.example.banking.model.Bank&quot;</div><div class="t m5 x52 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">p:dataAccessObject-ref=&quot;bankDataAccessObject&quot;/&gt;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">&lt;/beans&gt;</div><div class="t m0 x5c h1c ydbf ff1 fs3 fc0 sc0 ls0 ws0">Figur<span class="_ _4"></span>e 11-3</div><div class="t m0 x9b h14 ydc0 ff8 fs3 fc0 sc0 ls0 ws0">The “Russian doll” of decorators</div><div class="t m0 xd h25 yc1e ff8 fse fc0 sc0 ls0 ws0">14.<span class="_ _16"> </span>[GOF].</div><div class="t m0 xd h25 ydc1 ff8 fse fc0 sc0 ls0 ws5fd">15.<span class="_ _16"> </span>The example can be simpliﬁed using mechanisms that e<span class="_ _4"></span>xploit <span class="ffa">con<span class="_ _4"></span>vention over conﬁgur<span class="_ _4"></span>ation <span class="ff8">and Ja<span class="_ _4"></span>va 5 annotations to reduce </span></span></div><div class="t m0 x3b h25 ydc2 ff8 fse fc0 sc0 ls0 ws0">the amount of explicit “wiring” lo<span class="_ _4"></span>gic required.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-4 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Spring 2.X configuration file</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc4" class="pf w1 h2" data-page-no="c4"><div class="pc pcc4 w1 h2"><img class="bi xd y2f0 wc h8d" alt="" src="bgc4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">165<span class="_ _10"></span><span class="ff1">Pur<span class="_ _4"></span>e Ja<span class="_ _1"></span>va <span class="_ _0"></span>A<span class="_ _4"></span>OP F<span class="_ _4"></span>ramew<span class="_ _1"></span>orks</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws5fe">largel<span class="_ _4"></span>y follo<span class="_ _4"></span>ws the Spring model of declarativ<span class="_ _4"></span>ely supporting cross-cutting concerns using</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws0">XML conﬁguration ﬁles and/or Ja<span class="_ _4"></span>va 5 annotations. </div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws0">Listing 11-5 sho<span class="_ _4"></span>ws our Bank object rewritten in EJB3</div><div class="t m0 xa1 h21 ydc3 ff8 fsc fc0 sc0 ls0 ws0">16</div><div class="t m0 x21 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1c ydc4 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-5 </div><div class="t m0 x74 h36 y1be ffc fs3 fc0 sc0 ls0 ws0">An EBJ3 Bank EJB</div><div class="t m5 x74 h2f y714 ffb fs10 fc0 sc0 ls0 ws0">package com.example.banking.model;</div><div class="t m5 x74 h2f y715 ffb fs10 fc0 sc0 ls0 ws0">import javax.persistence.*;</div><div class="t m5 x74 h2f y716 ffb fs10 fc0 sc0 ls0 ws0">import java.util.ArrayList;</div><div class="t m5 x74 h2f y717 ffb fs10 fc0 sc0 ls0 ws0">import java.util.Collection;</div><div class="t m5 x74 h2f y9b4 ffb fs10 fc0 sc0 ls0 ws0">@Entity</div><div class="t m5 x74 h2f y719 ffb fs10 fc0 sc0 ls0 ws0">@Table(name = &quot;BANKS&quot;)</div><div class="t m5 x74 h2f y71a ffb fs10 fc0 sc0 ls0 ws0">public class Bank implements java.io.Serializable {</div><div class="t m5 x74 h2f y71b ffb fs10 fc0 sc0 ls0 ws0">   @Id @GeneratedValue(strategy=GenerationType.AUTO)</div><div class="t m5 x74 h2f y71c ffb fs10 fc0 sc0 ls0 ws0">   private int id;</div><div class="t m5 x74 h2f y71e ffb fs10 fc0 sc0 ls0 ws0">   @Embeddable // An object “inlined” in Bank’s DB row</div><div class="t m5 x74 h2f ydc5 ffb fs10 fc0 sc0 ls0 ws0">   public class Address { </div><div class="t m5 x74 h2f y9b5 ffb fs10 fc0 sc0 ls0 ws0">      protected String streetAddr1; </div><div class="t m5 x74 h2f y9b6 ffb fs10 fc0 sc0 ls0 ws0">      protected String streetAddr2; </div><div class="t m5 x74 h2f y9b7 ffb fs10 fc0 sc0 ls0 ws0">      protected String city; </div><div class="t m5 x74 h2f y9b8 ffb fs10 fc0 sc0 ls0 ws0">      protected String state; </div><div class="t m5 x74 h2f y9b9 ffb fs10 fc0 sc0 ls0 ws0">      protected String zipCode; </div><div class="t m5 x74 h2f y9ba ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y9bc ffb fs10 fc0 sc0 ls0 ws0">   @Embedded</div><div class="t m5 x74 h2f y9bd ffb fs10 fc0 sc0 ls0 ws0">   private Address address;</div><div class="t m5 x74 h2f ydc6 ffb fs10 fc0 sc0 ls0 ws0">   @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER, </div><div class="t m5 x74 h2f ydc7 ffb fs10 fc0 sc0 ls0 ws0">              mappedBy=&quot;bank&quot;)</div><div class="t m5 x74 h2f ydc8 ffb fs10 fc0 sc0 ls0 ws0">   private Collection&lt;Account&gt; accounts = new ArrayList&lt;Account&gt;();</div><div class="t m5 x74 h2f ydc9 ffb fs10 fc0 sc0 ls0 ws0">   public int getId() {</div><div class="t m5 x74 h2f ydca ffb fs10 fc0 sc0 ls0 ws0">      return id;</div><div class="t m5 x74 h2f ydcb ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f ydcc ffb fs10 fc0 sc0 ls0 ws0">   public void setId(int id) {</div><div class="t m5 x74 h2f ydcd ffb fs10 fc0 sc0 ls0 ws0">      this.id = id;</div><div class="t m5 x74 h2f ydce ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f ydcf ffb fs10 fc0 sc0 ls0 ws0">   public void addAccount(Account account) {</div><div class="t m5 x74 h2f ydd0 ffb fs10 fc0 sc0 ls0 ws0">      account.setBank(this);</div><div class="t m5 x74 h2f ydd1 ffb fs10 fc0 sc0 ls0 ws0">      accounts.add(account);</div><div class="t m5 x74 h2f ydd2 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f ydd3 ffb fs10 fc0 sc0 ls0 ws0">   public Collection&lt;Account&gt; getAccounts() {</div><div class="t m5 x74 h2f ydd4 ffb fs10 fc0 sc0 ls0 ws0">      return accounts;</div><div class="t m5 x74 h2f ydd5 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">16.<span class="_ _16"> </span>Adapted from http://www<span class="_ _1"></span>.onjav<span class="_ _4"></span>a.com/pub/a/onjav<span class="_ _4"></span>a/2006/05/17/standardizing-with-ejb3-jav<span class="_ _4"></span>a-persistence-api.html</div><a class="l" href="http://www.onjava.com/pub/a/onjava/2006/05/17/standardizing-with-ejb3-java-persistence-api.html"><div class="d m1" style="border-style:none;position:absolute;left:131.658000px;bottom:67.249110px;width:277.891000px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc5" class="pf w1 h2" data-page-no="c5"><div class="pc pcc5 w1 h2"><img class="bi xd y2f0 wc h8e" alt="" src="bgc5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">166<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 x74 h14 ydaa ff8 fs3 fc0 sc0 ls0 wsa5">This code is much cleaner than the original EJB2 code. Some of the entity details are</div><div class="t m0 xd h14 ydd6 ff8 fs3 fc0 sc0 ls0 ws5ed">still here, contained in the annotations. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, because none of that information is out-</div><div class="t m0 xd h14 ydd7 ff8 fs3 fc0 sc0 ls0 ws3a7">side of the annotations, the code is clean, clear<span class="_ _4"></span>, and hence easy to test driv<span class="_ _4"></span>e, maintain, and</div><div class="t m0 xd h14 ydd8 ff8 fs3 fc0 sc0 ls0 ws0">so on.</div><div class="t m0 x74 h14 ydd9 ff8 fs3 fc0 sc0 ls0 ws5ff">Some or all of the persistence information in the annotations can be mo<span class="_ _4"></span>ved to XML</div><div class="t m0 xd h14 ydda ff8 fs3 fc0 sc0 ls0 ws28d">deplo<span class="_ _4"></span>yment descriptors, if desired<span class="_ _1"></span>, leaving a trul<span class="_ _4"></span>y pure POJO. If the persistence mapping</div><div class="t m0 xd h14 y72f ff8 fs3 fc0 sc0 lsd ws53">details w<span class="_ _4"></span>on’<span class="_ _4"></span>t change frequentl<span class="_ _4"></span>y<span class="_ _1"></span>, many teams ma<span class="_ _1"></span>y choose to keep the annotations, but with</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls0 ws0">far few<span class="_ _1"></span>er har<span class="_ _8"></span>mful drawbacks compared to the EJB2 in<span class="_ _1"></span>vasi<span class="_ _4"></span>veness. </div><div class="t m0 xd h17 yddb ff1 fs9 fc0 sc0 ls0 ws20d">AspectJ Aspects</div><div class="t m0 xd h14 y3f3 ff8 fs3 fc0 sc0 ls0 ws293">Finall<span class="_ _4"></span>y<span class="_ _0"></span>, the most full-featured tool for separating concer<span class="_ _8"></span>ns through aspects is the <span class="_ _4"></span>AspectJ</div><div class="t m0 xd h14 y3f4 ff8 fs3 fc0 sc0 ls0 ws0">language,</div><div class="t m0 x8a h21 y29e ff8 fsc fc0 sc0 ls0 ws0">17</div><div class="t m0 x4c h14 y3f4 ff8 fs3 fc0 sc0 ls0 ws489">an extension of Ja<span class="_ _1"></span>va that pro<span class="_ _4"></span>vides “ﬁrst-class” support for aspects as modular-</div><div class="t m0 xd h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws2df">ity constructs. <span class="_ _4"></span>The pure Jav<span class="_ _4"></span>a approaches pro<span class="_ _4"></span>vided b<span class="_ _4"></span>y Spring <span class="_ _4"></span>A<span class="_ _1"></span>OP and JBoss <span class="_ _4"></span>A<span class="_ _4"></span>OP are suf-</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws600">ﬁcient for 80–90 percent of the cases where aspects are most useful. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, <span class="_ _4"></span>AspectJ</div><div class="t m0 xd h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws601">pro<span class="_ _4"></span>vides a very rich and po<span class="_ _4"></span>w<span class="_ _4"></span>erful tool set for separating concer<span class="_ _8"></span>ns. <span class="_ _4"></span>The dra<span class="_ _4"></span>wback of</div><div class="t m0 xd h14 yddc ff8 fs3 fc0 sc0 ls0 ws370">AspectJ is the need to adopt se<span class="_ _4"></span>veral new tools and to learn ne<span class="_ _4"></span>w language constr<span class="_ _8"></span>ucts and</div><div class="t m0 xd h14 ybfe ff8 fs3 fc0 sc0 ls0 ws0">usage idioms. </div><div class="t m0 x74 h14 yddd ff8 fs3 fc0 sc0 lsc ws20a">The adoption issues ha<span class="_ _4"></span>ve been partially mitigated b<span class="_ _4"></span>y a recently introduced “annota-</div><div class="t m0 xd h14 y58b ff8 fs3 fc0 sc0 ls0 ws602">tion form” of <span class="_ _4"></span>AspectJ<span class="_ _1"></span>, where Ja<span class="_ _4"></span>va 5 annotations are used to deﬁne aspects using pure Ja<span class="_ _4"></span>v<span class="_ _4"></span>a</div><div class="t m0 xd h14 ydde ff8 fs3 fc0 sc0 ls0 ws603">code. <span class="_ _1"></span>Also, the Spring Frame<span class="_ _4"></span>work has a number of features that mak<span class="_ _4"></span>e incor<span class="_ _8"></span>poration of</div><div class="t m0 xd h14 yddf ff8 fs3 fc0 sc0 ls0 ws0">annotation-based aspects much easier for a team with limited <span class="_ _1"></span>AspectJ experience.</div><div class="t m0 x74 h14 yde0 ff8 fs3 fc0 sc0 ls0 ws53b">A full discussion of <span class="_ _1"></span>AspectJ is beyond the scope of this book. See [AspectJ], [Col<span class="_ _4"></span>yer],</div><div class="t m0 xd h14 yde1 ff8 fs3 fc0 sc0 ls0 ws0">and [Spring] for more information. </div><div class="t m0 xd h17 y551 ff1 fs9 fc0 sc0 ls0 ws0">T<span class="_ _2"></span>est Driv<span class="_ _4"></span>e the System <span class="_ _2"></span>Architectur<span class="_ _1"></span>e</div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws59c">The po<span class="_ _4"></span>w<span class="_ _4"></span>er of separating concer<span class="_ _8"></span>ns through aspect-like approaches can’<span class="_ _1"></span>t be ov<span class="_ _4"></span>erstated. If</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 ws226">you can write y<span class="_ _4"></span>our application’<span class="_ _2"></span>s domain logic using POJOs, decoupled from an<span class="_ _4"></span>y architec-</div><div class="t m0 xd h14 yde2 ff8 fs3 fc0 sc0 ls0 ws5c">ture concerns at the code level, then it is possib<span class="_ _4"></span>le to truly <span class="ffa">test drive </span>y<span class="_ _4"></span>our architecture. <span class="_ _1"></span>Y<span class="_ _3"></span>ou</div><div class="t m0 xd h14 yb4c ff8 fs3 fc0 sc0 ls0 ws3d0">can ev<span class="_ _4"></span>olve it from simple to sophisticated<span class="_ _1"></span>, as needed<span class="_ _1"></span>, by adopting ne<span class="_ _4"></span>w technologies on</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">   public void setAccounts(Collection&lt;Account&gt; accounts) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      this.accounts = accounts;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">17.<span class="_ _16"> </span>See [AspectJ] and [Col<span class="_ _4"></span>yer].</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 11-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">An EBJ3 Bank EJB</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:375.945010px;width:95.620000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:169.945010px;width:206.848000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc6" class="pf w1 h2" data-page-no="c6"><div class="pc pcc6 w1 h2"><img class="bi x37 yde3 w8 h27" alt="" src="bgc6.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">167<span class="_ _10"></span><span class="ff1">Optimize Decision Making</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws46">demand. It is not necessary to do a <span class="ffa">Big Design Up F<span class="_ _4"></span>r<span class="_ _4"></span>ont</span></div><div class="t m0 xb6 h21 y4ea ff8 fsc fc0 sc0 ls0 ws0">18</div><div class="t m0 xae h14 y194 ff8 fs3 fc0 sc0 ls0 ws46">(BDUF). In fact, BDUF is ev<span class="_ _4"></span>en</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws604">harmful because it inhibits adapting to change, due to the psychological resistance to dis-</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws605">carding prior effort and because of the w<span class="_ _4"></span>ay architecture choices inﬂuence subsequent</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">thinking about the design. </div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws153">Building architects ha<span class="_ _4"></span>ve to do BDUF because it is not feasib<span class="_ _4"></span>le to make radical archi-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws606">tectural changes to a large ph<span class="_ _4"></span>ysical structure once constr<span class="_ _8"></span>uction is w<span class="_ _4"></span>ell underwa<span class="_ _4"></span>y<span class="_ _0"></span>.</div><div class="t m0 x50 h21 y4eb ff8 fsc fc0 sc0 ls0 ws0">19</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws607">Although softw<span class="_ _4"></span>are has its own <span class="ffa ws0">ph<span class="_ _4"></span>ysics<span class="ff8">,</span></span></div><div class="t m0 xdd h21 yde4 ff8 fsc fc0 sc0 ls0 ws0">20</div><div class="t m0 xbe h14 y19a ff8 fs3 fc0 sc0 ls0 ws607">it is economicall<span class="_ _4"></span>y feasible to make radical</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">change, <span class="ffa">if </span>the structure of the software separates its concerns effecti<span class="_ _4"></span>vel<span class="_ _4"></span>y<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 lsd ws2fb">This means w<span class="_ _4"></span>e can star<span class="_ _8"></span>t a software project with a “nai<span class="_ _4"></span>vel<span class="_ _4"></span>y simple” but nicely decou-</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws216">pled architecture, deli<span class="_ _4"></span>vering w<span class="_ _4"></span>orking user stories quickly<span class="_ _0"></span>, then adding more infrastructure</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws5a7">as w<span class="_ _4"></span>e scale up. Some of the w<span class="_ _4"></span>orld’<span class="_ _2"></span>s largest <span class="_ _4"></span>W<span class="_ _0"></span>eb sites hav<span class="_ _4"></span>e achiev<span class="_ _4"></span>ed very high av<span class="_ _4"></span>ailability</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws58c">and performance, using sophisticated data caching, security<span class="_ _1"></span>, vir<span class="_ _8"></span>tualization, and so forth,</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 wsb8">all done ef<span class="_ _4"></span>ﬁciently and ﬂexib<span class="_ _4"></span>ly because the minimall<span class="_ _4"></span>y coupled designs are appropriatel<span class="_ _4"></span>y</div><div class="t m0 xd h14 y21c ffa fs3 fc0 sc0 ls0 ws0">simple<span class="ff8"> at each le<span class="_ _4"></span>vel of abstraction and scope.</span></div><div class="t m0 x74 h14 y20c ff8 fs3 fc0 sc0 ls0 ws3c7">Of course, this does not mean that w<span class="_ _4"></span>e go into a project “r<span class="_ _8"></span>udderless.<span class="_ _1"></span>” W<span class="_ _2"></span>e hav<span class="_ _4"></span>e some</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 ls0 ws52d">expectations of the general scope, goals, and schedule for the project, as w<span class="_ _1"></span>ell as the gen-</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 ws608">eral structure of the resulting system. How<span class="_ _1"></span>ever<span class="_ _1"></span>, we must maintain the ability to change</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 ws0">course in response to e<span class="_ _4"></span>volving circumstances.   </div><div class="t m0 x74 h14 y54c ff8 fs3 fc0 sc0 lsd ws609">The earl<span class="_ _4"></span>y EJB architecture is but one of many w<span class="_ _4"></span>ell-kno<span class="_ _4"></span>wn <span class="_ _4"></span>APIs that are o<span class="_ _1"></span>ver-engi-</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws53a">neered and that compromise separation of concerns. Even w<span class="_ _4"></span>ell-designed <span class="_ _4"></span>APIs can be o<span class="_ _4"></span>ver<span class="_ _4"></span>-</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws298">kill when the<span class="_ _4"></span>y aren’<span class="_ _4"></span>t really needed. <span class="_ _0"></span>A good <span class="_ _4"></span>API should largel<span class="_ _4"></span>y <span class="ffa ws0">disappear<span class="_ _a"> </span></span>from view most</div><div class="t m0 xd h14 yde5 ff8 fs3 fc0 sc0 ls0 ws1a6">of the time, so the team expends the majority of its creati<span class="_ _4"></span>ve ef<span class="_ _4"></span>for<span class="_ _8"></span>ts focused on the user sto-</div><div class="t m0 xd h14 yde6 ff8 fs3 fc0 sc0 ls0 ws60a">ries being implemented. If not, then the architectural constraints will inhibit the ef<span class="_ _4"></span>ﬁcient</div><div class="t m0 xd h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">deliv<span class="_ _4"></span>ery of optimal value to the customer<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y1e9 ff8 fs3 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>o recap this long discussion,</div><div class="t m0 x74 h29 y91d ffa fsf fc0 sc0 ls0 ws60b">An optimal system ar<span class="_ _4"></span>chitectur<span class="_ _4"></span>e consists of modularized domains of concern, each of whic<span class="_ _4"></span>h</div><div class="t m0 x74 h29 yde8 ffa fsf fc0 sc0 ls0 ws60c">is implemented with Plain Old J<span class="_ _4"></span>ava (or other) Objects. <span class="_ _4"></span>The differ<span class="_ _1"></span>ent domains are inte-</div><div class="t m0 x74 h29 yde9 ffa fsf fc0 sc0 ls0 ws60d">gr<span class="_ _4"></span>ated tog<span class="_ _4"></span>ether with minimally in<span class="_ _4"></span>vasive <span class="_ _4"></span>Aspects or <span class="_ _1"></span>Aspect-like tools. <span class="_ _4"></span>This arc<span class="_ _4"></span>hitecture can</div><div class="t m0 x74 h29 ydea ffa fsf fc0 sc0 ls0 ws0">be test-driven, just like the code.</div><div class="t m0 xd h17 ydeb ff1 fs9 fc0 sc0 ls0 ws0">Optimize Decision Making</div><div class="t m0 xd h14 y7fb ff8 fs3 fc0 sc0 ls0 ws60e">Modularity and separation of concerns make decentralized management and decision</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 ls0 ws209">making possible. In a suf<span class="_ _4"></span>ﬁcientl<span class="_ _4"></span>y large system, whether it is a city or a softw<span class="_ _4"></span>are project, no</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws0">one person can make all the decisions.</div><div class="t m0 xd h25 ydec ff8 fse fc0 sc0 ls0 ws0">18.<span class="_ _16"> </span>Not to be confused with the good practice of up-front design, BDUF is the practice of designing <span class="_ _4"></span><span class="ffa">everything<span class="ff8"> up front before </span></span></div><div class="t m0 x3b h25 yded ff8 fse fc0 sc0 ls0 ws0">implementing anything at all. </div><div class="t m0 xd h25 ydee ff8 fse fc0 sc0 ls0 ws0">19.<span class="_ _16"> </span>There is still a signiﬁcant amount of iterati<span class="_ _4"></span>ve exploration and discussion of details, ev<span class="_ _4"></span>en after constr<span class="_ _8"></span>uction starts.</div><div class="t m0 xd h25 ydef ff8 fse fc0 sc0 ls0 ws0">20.<span class="_ _16"> </span>The term <span class="ffa">softwar<span class="_ _4"></span>e physics<span class="ff8"> w<span class="_ _4"></span>as ﬁrst used by [K<span class="_ _4"></span>olence].</span></span></div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:194.945010px;width:159.444000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc7" class="pf w1 h2" data-page-no="c7"><div class="pc pcc7 w1 h2"><img class="bi x37 y3e9 w8 h27" alt="" src="bgc7.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">168<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws3c8">W<span class="_ _0"></span>e all kno<span class="_ _4"></span>w it is best to giv<span class="_ _4"></span>e responsibilities to the most qualiﬁed persons. W<span class="_ _2"></span>e often</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws60f">forget that it is also best to <span class="ffa">postpone decisions until the last possib<span class="_ _4"></span>le moment<span class="ff8 ws5ad">. This <span class="_ _8"></span>isn’<span class="_ _4"></span>t</span></span></div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws610">lazy or ir<span class="_ _8"></span>responsible; it lets us mak<span class="_ _4"></span>e infor<span class="_ _8"></span>med choices with the best possible information.</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws4e2">A premature decision is a decision made with suboptimal kno<span class="_ _4"></span>wledge. <span class="_ _4"></span>W<span class="_ _0"></span>e will hav<span class="_ _4"></span>e that</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws5c3">much less customer feedback, mental reﬂection on the project, and experience with our</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">implementation choices if w<span class="_ _4"></span>e decide too soon. </div><div class="t m0 x74 h29 y3ce ffa fsf fc0 sc0 ls0 ws1b1">The agility pr<span class="_ _1"></span>ovided by a POJO system with modularized concerns allo<span class="_ _4"></span>ws us to make opti-</div><div class="t m0 x74 h29 ydf0 ffa fsf fc0 sc0 ls0 ws611">mal, just-in-time decisions, based on the most r<span class="_ _4"></span>ecent knowledge<span class="_ _4"></span>. <span class="_ _4"></span>The complexity of these</div><div class="t m0 x74 h29 ydf1 ffa fsf fc0 sc0 ls0 ws0">decisions is also r<span class="_ _4"></span>educed.</div><div class="t m0 xd h17 ydf2 ff1 fs9 fc0 sc0 ls0 ws2e4">Use <span class="_ _6"></span>Standards W<span class="_ _4"></span>isely<span class="_ _2"></span>,<span class="_ _4"></span> When They <span class="_ _4"></span>Add <span class="_ _5"></span><span class="ff5 ws0">Demonstrab<span class="_ _4"></span>le<span class="_ _e"> </span><span class="ff1">V<span class="_ _3"></span>alue</span></span></div><div class="t m0 xd h14 ydf3 ff8 fs3 fc0 sc0 lsd ws3e6">Building construction is a mar<span class="_ _8"></span>vel to w<span class="_ _4"></span>atch because of the pace at which ne<span class="_ _4"></span>w buildings are</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 lsd ws418">built (ev<span class="_ _4"></span>en in the dead of winter) and because of the extraordinary designs that are possi-</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 wscb">ble with toda<span class="_ _1"></span>y’<span class="_ _2"></span>s technology<span class="_ _0"></span>. Constr<span class="_ _8"></span>uction is a mature industr<span class="_ _8"></span>y with highl<span class="_ _4"></span>y optimized par<span class="_ _8"></span>ts,</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws0">methods, and standards that ha<span class="_ _4"></span>ve e<span class="_ _4"></span>volved under pressure for centuries. </div><div class="t m0 x74 h14 y280 ff8 fs3 fc0 sc0 ls0 ws612">Many teams used the EJB2 architecture because it w<span class="_ _1"></span>as a standard<span class="_ _4"></span>, ev<span class="_ _4"></span>en when lighter<span class="_ _4"></span>-</div><div class="t m0 xd h14 y281 ff8 fs3 fc0 sc0 ls0 ws613">w<span class="_ _4"></span>eight and more straightforward designs w<span class="_ _1"></span>ould hav<span class="_ _4"></span>e been sufﬁcient. I ha<span class="_ _4"></span>ve seen teams</div><div class="t m0 xd h14 y2a ff8 fs3 fc0 sc0 ls0 ws277">become obsessed with v<span class="_ _4"></span>arious <span class="ffa">str<span class="_ _4"></span>ongly hyped <span class="ff8">standards and lose focus on implementing</span></span></div><div class="t m0 xd h14 y2b ff8 fs3 fc0 sc0 ls0 ws0">v<span class="_ _4"></span>alue for their customers.</div><div class="t m0 x74 h29 ydf4 ffa fsf fc0 sc0 ls0 ws614">Standar<span class="_ _4"></span>ds make it easier to reuse ideas and components, r<span class="_ _1"></span>ecruit people with rele<span class="_ _4"></span>vant expe-</div><div class="t m0 x74 h29 ydf5 ffa fsf fc0 sc0 ls0 ws615">rience, encapsulate g<span class="_ _4"></span>ood ideas, and wire components to<span class="_ _4"></span>gether<span class="_ _0"></span>. Ho<span class="_ _4"></span>wever<span class="_ _0"></span>, the pr<span class="_ _4"></span>ocess of</div><div class="t m0 x74 h29 ydf6 ffa fsf fc0 sc0 ls0 ws616">cr<span class="_ _4"></span>eating standards can sometimes take too long f<span class="_ _4"></span>or industry to wait, and some standar<span class="_ _4"></span>ds</div><div class="t m0 x74 h29 ydf7 ffa fsf fc0 sc0 ls0 ws0">lose touch with the r<span class="_ _4"></span>eal needs of the adopters they ar<span class="_ _1"></span>e intended to serve.</div><div class="t m0 xd h17 ydf8 ff1 fs9 fc0 sc0 ls0 ws0">Systems Need Domain-Speciﬁc Languag<span class="_ _4"></span>es</div><div class="t m0 xd h14 ydf9 ff8 fs3 fc0 sc0 lsd ws363">Building construction, like most domains, has dev<span class="_ _4"></span>eloped a rich language with a vocabu-</div><div class="t m0 xd h14 ydfa ff8 fs3 fc0 sc0 ls0 ws587">lary<span class="_ _1"></span>, idioms, and patter<span class="_ _8"></span>ns</div><div class="t m0 x15 h21 y313 ff8 fsc fc0 sc0 ls0 ws0">21</div><div class="t m0 x1f h14 ydfa ff8 fs3 fc0 sc0 ls0 ws587">that con<span class="_ _4"></span>ve<span class="_ _4"></span>y essential infor<span class="_ _8"></span>mation clearly and concisel<span class="_ _4"></span>y<span class="_ _0"></span>. In soft-</div><div class="t m0 xd h14 ydfb ff8 fs3 fc0 sc0 ls0 ws617">w<span class="_ _4"></span>are, there has been renew<span class="_ _4"></span>ed interest recently in creating <span class="_ _4"></span><span class="ffa">Domain-Speciﬁc Languages</span></div><div class="t m0 xd h14 yb77 ff8 fs3 fc0 sc0 ls0 ws0">(DSLs),</div><div class="t m0 xc5 h21 y315 ff8 fsc fc0 sc0 ls0 ws0">22</div><div class="t m0 xdc h14 yb77 ff8 fs3 fc0 sc0 ls0 ws55e"> which are separate, small scripting languages or <span class="_ _1"></span>APIs in standard languages that</div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 ls0 ws618">permit code to be written so that it reads like a str<span class="_ _8"></span>uctured form of prose that a domain</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 ls0 ws0">expert might write. </div><div class="t m0 x74 h14 y95b ff8 fs3 fc0 sc0 ls68 ws178">A good DSL minimizes the “communication gap” betw<span class="_ _4"></span>een a domain concept and the</div><div class="t m0 xd h14 ya1e ff8 fs3 fc0 sc0 ls68 ws2f">code that implements it, just as agile practices optimize the communications within a</div><div class="t m0 xd h14 yb78 ff8 fs3 fc0 sc0 ls68 ws619">team and with the project’<span class="_ _2"></span>s stakeholders. If y<span class="_ _4"></span>ou are implementing domain logic in the</div><div class="t m0 xd h25 ya78 ff8 fse fc0 sc0 ls0 ws0">21.<span class="_ _16"> </span>The w<span class="_ _4"></span>ork of [Alexander] has been particularly inﬂuential on the software community<span class="_ _0"></span>.</div><div class="t m0 xd h25 ydfc ff8 fse fc0 sc0 ls0 ws0">22.<span class="_ _16"> </span>See, for example,<span class="_ _d"> </span>[DSL]. [JMock] is a good example of a Jav<span class="_ _4"></span>a API that creates a DSL.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:448.945010px;width:349.076000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:252.945010px;width:251.328000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc8" class="pf w1 h2" data-page-no="c8"><div class="pc pcc8 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">169<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws3f8">same language that a domain expert uses, there is less risk that you will incorrectly trans-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws0">late the domain into the implementation.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls22 ws401">DSLs, when used ef<span class="_ _4"></span>fecti<span class="_ _4"></span>vely<span class="_ _0"></span>, raise the abstraction le<span class="_ _4"></span>vel abo<span class="_ _4"></span>ve code idioms and design</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws87">patterns. <span class="_ _4"></span>They allo<span class="_ _4"></span>w the dev<span class="_ _4"></span>eloper to rev<span class="_ _4"></span>eal the intent of the code at the appropriate lev<span class="_ _4"></span>el</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">of abstraction. </div><div class="t m0 x74 h29 ydfd ffa fsf fc0 sc0 ls0 ws2a5">Domain-Speciﬁc Languag<span class="_ _4"></span>es allow all levels of a<span class="_ _4"></span>bstr<span class="_ _4"></span>action and all domains in the applica-</div><div class="t m0 x74 h29 ydfe ffa fsf fc0 sc0 ls0 ws0">tion to be expr<span class="_ _4"></span>essed as POJOs, fr<span class="_ _4"></span>om high-level policy to low-le<span class="_ _4"></span>vel details. </div><div class="t m0 xd h17 ydff ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws61a">Systems must be clean too. <span class="_ _1"></span>An inv<span class="_ _4"></span>asi<span class="_ _4"></span>ve architecture o<span class="_ _4"></span>verw<span class="_ _4"></span>helms the domain logic and</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 lsd ws61b">impacts agility<span class="_ _0"></span>. When the domain lo<span class="_ _4"></span>gic is obscured<span class="_ _1"></span>, quality suffers because bugs ﬁnd it</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws5c">easier to hide and stories become harder to implement. If agility is compromised<span class="_ _1"></span>, produc-</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws0">ti<span class="_ _4"></span>vity suffers and the beneﬁts of <span class="_ _1"></span>TDD are lost. </div><div class="t m0 x74 h14 y21d ff8 fs3 fc0 sc0 ls0 ws5c3">At all le<span class="_ _4"></span>vels of abstraction, the intent should be clear<span class="_ _1"></span>. <span class="_ _4"></span>This will only happen if y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 ws61c">write POJOs and you use aspect-lik<span class="_ _4"></span>e mechanisms to incor<span class="_ _8"></span>porate other implementation</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 ws0">concerns noninv<span class="_ _4"></span>asi<span class="_ _4"></span>vely<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y54c ff8 fs3 fc0 sc0 ls0 ws474">Whether you are designing systems or indi<span class="_ _4"></span>vidual modules, ne<span class="_ _4"></span>ver forget to <span class="ffa">use the</span></div><div class="t m0 xd h14 y6c2 ffa fs3 fc0 sc0 ls0 ws0">simplest thing that can possib<span class="_ _4"></span>ly wor<span class="_ _4"></span>k<span class="ff8">.</span></div><div class="t m0 xd h17 ye00 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y2c8 ff1 fs3 fc0 sc0 ls0 wsa0">[Alexander]:<span class="_ _1"></span>  <span class="ff8 ws61d">Christopher Alexander<span class="_ _4"></span>, <span class="ffa ws353">A T<span class="_ _4"></span>imeless W<span class="_ _0"></span>ay <span class="_ _5"></span>of <span class="_ _5"></span>Building,<span class="_ _1d"> </span><span class="ff8 ws61e">Oxford Univ<span class="_ _4"></span>ersity</span></span></span></div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">Press, New <span class="_ _0"></span>Y<span class="_ _3"></span>ork, 1979.</div><div class="t m0 xd h14 yd2d ff1 fs3 fc0 sc0 ls0 wsa0">[A<span class="_ _4"></span>OSD]:<span class="_ _4"></span>  <span class="ff8 ws0">Aspect-Oriented Software De<span class="_ _4"></span>velopment port, http://aosd.net</span></div><div class="t m0 xd h14 y2f8 ff1 fs3 fc0 sc0 ls0 wsa0">[ASM]:<span class="_ _4"></span>  <span class="ff8 ws0">ASM Home Page, http://asm.objectw<span class="_ _4"></span>eb<span class="_ _4"></span>.org/</span></div><div class="t m0 xd h14 y2fa ff1 fs3 fc0 sc0 ls0 wsa0">[AspectJ]:<span class="_ _4"></span>  <span class="ff8 ws0">http://eclipse.org/aspectj</span></div><div class="t m0 xd h14 y2fc ff1 fs3 fc0 sc0 ls0 wsa0">[CGLIB]:<span class="_ _4"></span>  <span class="ff8 ws0">Code Generation Librar<span class="_ _8"></span>y<span class="_ _0"></span>, http://cglib.sourcefor<span class="_ _4"></span>ge.net/</span></div><div class="t m0 xd h14 y2fe ff1 fs3 fc0 sc0 ls0 wsa0">[Coly<span class="_ _4"></span>er]:<span class="_ _4"></span>  <span class="ff8 ws61f">Adrian Coly<span class="_ _4"></span>er<span class="_ _4"></span>, <span class="_ _4"></span>Andy Clement, George Hurle<span class="_ _4"></span>y<span class="_ _1"></span>, Mathew <span class="_ _1"></span>W<span class="_ _0"></span>ebster, <span class="ffa ws0">Ec<span class="_ _4"></span>lipse</span></span></div><div class="t m0 xd h14 ye01 ffa fs3 fc0 sc0 ls0 ws0">AspectJ<span class="_ _1"></span>, <span class="ff8">P<span class="_ _4"></span>erson Education, Inc., Upper Saddle Riv<span class="_ _4"></span>er<span class="_ _4"></span>, NJ<span class="_ _1"></span>, 2005.</span></div><div class="t m0 xd h14 ye02 ff1 fs3 fc0 sc0 ls0 wsa0">[DSL]:<span class="_ _4"></span>  <span class="ff8 ws620">Domain-speciﬁc programming language, http://en.wikipedia.org/wiki/Domain-</span></div><div class="t m0 xd h14 ye03 ff8 fs3 fc0 sc0 ls0 ws0">speciﬁc_pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming_language</div><div class="t m0 xd h14 y67d ff1 fs3 fc0 sc0 ls0 wsa0">[F<span class="_ _1"></span>o<span class="_ _4"></span>wler]:  <span class="ff8 ls69 ws621">In<span class="_ _1"></span>version of Control Containers and the Dependency Injection pattern,</span></div><div class="t m0 xd h14 y67e ff8 fs3 fc0 sc0 ls0 ws0">http://martinfowler<span class="_ _1"></span>.com/articles/injection.html</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:468.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:310.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://aosd.net"><div class="d m1" style="border-style:none;position:absolute;left:305.364000px;bottom:250.602010px;width:56.949000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://asm.objectweb.org/"><div class="d m1" style="border-style:none;position:absolute;left:191.425000px;bottom:226.602010px;width:101.294000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://eclipse.org/aspectj"><div class="d m1" style="border-style:none;position:absolute;left:127.680000px;bottom:202.602010px;width:97.871000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://cglib.sourceforge.net/"><div class="d m1" style="border-style:none;position:absolute;left:230.911000px;bottom:178.602010px;width:110.523000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Domainspecific_programming_language"><div class="d m1" style="border-style:none;position:absolute;left:288.815000px;bottom:117.401010px;width:151.750000px;height:12.588000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Domainspecific_programming_language"><div class="d m1" style="border-style:none;position:absolute;left:79.022100px;bottom:106.912010px;width:132.169900px;height:10.489000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://martinfowler.com/articles/injection.html"><div class="d m1" style="border-style:none;position:absolute;left:78.824900px;bottom:70.602810px;width:185.557100px;height:10.939800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfc9" class="pf w1 h2" data-page-no="c9"><div class="pc pcc9 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">170<span class="_ _30"> </span><span class="ff1 wsa0">Chapter 11:<span class="_ _4"></span> Systems</span></div><div class="t m0 xd h14 y194 ff1 fs3 fc0 sc0 ls0 wsa0">[Goetz]:<span class="_ _4"></span>  <span class="ff8 ls12 ws622">Brian Goetz, <span class="ffa">Java <span class="_ _0"></span>Theory and Pr<span class="_ _4"></span>actice: Decor<span class="_ _4"></span>ating with Dynamic <span class="_ _2"></span>Pr<span class="_ _1"></span>oxie<span class="ff8 ws0">s,</span></span></span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">http://www<span class="_ _0"></span>.ibm.com/dev<span class="_ _4"></span>eloperworks/ja<span class="_ _1"></span>va/library/j-jtp08305.html</div><div class="t m0 xd h14 y197 ff1 fs3 fc0 sc0 ls0 wsa0">[Ja<span class="_ _1"></span>vassist]:<span class="_ _1"></span>  <span class="ff8 ws0">Jav<span class="_ _4"></span>assist Home Page, http://www<span class="_ _0"></span>.csg.is.titech.ac.jp/~chiba/ja<span class="_ _4"></span>vassist/</span></div><div class="t m0 xd h14 y199 ff1 fs3 fc0 sc0 ls0 wsa0">[JBoss]:<span class="_ _4"></span>  <span class="ff8 ws0">JBoss Home Page, http://jboss.org</span></div><div class="t m0 xd h14 y1db ff1 fs3 fc0 sc0 ls0 wsa0">[JMock]:<span class="_ _4"></span>  <span class="ff8 ws0">JMock—A Lightweight Mock Object Library for Ja<span class="_ _4"></span>va, http://jmock.or<span class="_ _4"></span>g</span></div><div class="t m0 xd h14 y1dd ff1 fs3 fc0 sc0 ls0 wsa0">[Kolence]:<span class="_ _1"></span>  <span class="ff8 ws623">Kenneth <span class="_ _4"></span>W<span class="_ _2"></span>. K<span class="_ _4"></span>olence, Software ph<span class="_ _4"></span>ysics and computer performance measure-</span></div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">ments,<span class="_ _31"> </span><span class="ffa ws19b">Pr<span class="_ _4"></span>oceedings of the <span class="_ _1"></span>A<span class="_ _4"></span>CM annual confer<span class="_ _1"></span>ence—V<span class="_ _2"></span>olume 2<span class="ff8">, Boston, Massachusetts,</span></span></div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">pp. 1024–1040, 1972. </div><div class="t m0 xd h14 y1e1 ff1 fs3 fc0 sc0 ls0 wsa0">[Spring]:<span class="_ _4"></span>  <span class="ffa ws0">The Spring F<span class="_ _4"></span>r<span class="_ _4"></span>amewor<span class="_ _1"></span>k<span class="ff8">, http://www<span class="_ _1"></span>.springframe<span class="_ _4"></span>work.or<span class="_ _4"></span>g</span></span></div><div class="t m0 xd h14 y1e3 ff1 fs3 fc0 sc0 ls0 wsa0">[Mezzar<span class="_ _4"></span>os07]:  <span class="ffa ws0">XUnit P<span class="_ _0"></span>atterns<span class="ff8">, Gerard Mezzaros, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2007.</span></span></div><div class="t m0 xd h14 y54a ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa ws421">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e<span class="ff8">, Gamma et <span class="_ _4"></span>al.,</span></span></div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><a class="l" href="http://www.ibm.com/developerworks/java/library/j-jtp08305.html"><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:572.601010px;width:262.058000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.csg.is.titech.ac.jp/~chiba/javassist/"><div class="d m1" style="border-style:none;position:absolute;left:218.766000px;bottom:548.601010px;width:184.737000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://jboss.org"><div class="d m1" style="border-style:none;position:absolute;left:195.325000px;bottom:524.601010px;width:60.110000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://jmock.org"><div class="d m1" style="border-style:none;position:absolute;left:345.232000px;bottom:500.601010px;width:64.549000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.springframework.org"><div class="d m1" style="border-style:none;position:absolute;left:219.426000px;bottom:428.601010px;width:131.028000px;height:10.940000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfca" class="pf w1 h2" data-page-no="ca"><div class="pc pcca w1 h2"><img class="bi xd yca9 w4 h8f" alt="" src="bgca.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">171</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">12</div><div class="t m0 x7f h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Emerg<span class="_ _1"></span>ence</div><div class="t m0 xa6 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y Jeff Langr</div><div class="t m0 xd h17 ye04 ff1 fs9 fc0 sc0 ls0 ws0">Getting Clean via Emerg<span class="_ _4"></span>ent Design</div><div class="t m0 xd h14 ye05 ff8 fs3 fc0 sc0 ls0 wscb">What if there w<span class="_ _4"></span>ere four simple r<span class="_ _8"></span>ules that you could follo<span class="_ _1"></span>w that would help y<span class="_ _4"></span>ou create good</div><div class="t m0 xd h14 ye06 ff8 fs3 fc0 sc0 lsc ws40f">designs as you w<span class="_ _1"></span>orked? <span class="_ _4"></span>What if by follo<span class="_ _4"></span>wing these rules you gained insights into the struc-</div><div class="t m0 xd h14 ye07 ff8 fs3 fc0 sc0 ls0 ws2e3">ture and design of your code, making it easier to appl<span class="_ _4"></span>y principles such as SRP and DIP?</div><div class="t m0 xd h14 ye08 ff8 fs3 fc0 sc0 ls0 ws0">What if these four rules f<span class="_ _8"></span>acilitated the <span class="ffa">emer<span class="_ _4"></span>gence<span class="ff8"> of good designs?</span></span></div><div class="t m0 x74 h14 ye09 ff8 fs3 fc0 sc0 ls0 ws624">Many of us feel that K<span class="_ _1"></span>ent Beck’<span class="_ _0"></span>s four rules of <span class="ffa">Simple Design</span></div><div class="t m0 xa3 h21 ye0a ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 xb5 h14 ye09 ff8 fs3 fc0 sc0 ls0 ws624">are of signiﬁcant help in</div><div class="t m0 xd h14 ye0b ff8 fs3 fc0 sc0 ls0 ws0">creating w<span class="_ _4"></span>ell-designed software.</div><div class="t m0 xd h25 ye0c ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[XPE].</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:325.010000px;bottom:440.027010px;width:113.911000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:167.545010px;width:211.123000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfcb" class="pf w1 h2" data-page-no="cb"><div class="pc pccb w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">172<span class="_ _32"> </span><span class="ff1 wsa0">Chapter 12:<span class="_ _4"></span> Emergence</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">According to K<span class="_ _4"></span>ent, a design is “simple” if it follows these rules:</div><div class="t m0 x2c h14 yc41 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Runs all the tests</div><div class="t m0 x2c h14 ya67 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Contains no duplication</div><div class="t m0 x2c h14 ye0d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Expresses the intent of the pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer</div><div class="t m0 x2c h14 yb6b ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Minimizes the number of classes and methods</div><div class="t m0 x74 h14 y206 ff8 fs3 fc0 sc0 ls0 ws0">The rules are given in order of importance.</div><div class="t m0 xd h17 ye0e ff1 fs9 fc0 sc0 ls0 ws0">Simple Design Rule 1:<span class="_ _4"></span> Runs <span class="_ _2"></span>All the <span class="_ _1"></span>T<span class="_ _0"></span>ests</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws58f">First and foremost, a design must produce a system that acts as intended. <span class="_ _1"></span>A system might</div><div class="t m0 xd h14 ydf3 ff8 fs3 fc0 sc0 ls0 ws129">ha<span class="_ _4"></span>ve a perfect design on paper<span class="_ _4"></span>, but if there is no simple w<span class="_ _4"></span>ay to v<span class="_ _4"></span>erify that the system actu-</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 ls0 ws0">all<span class="_ _4"></span>y works as intended<span class="_ _0"></span>, then all the paper effort is questionable.</div><div class="t m0 x74 h14 y27e ff8 fs3 fc0 sc0 ls10 ws538">A system that is comprehensi<span class="_ _4"></span>vely tested and passes all of its tests all of the time is a test-</div><div class="t m0 xd h14 y27f ff8 fs3 fc0 sc0 ls10 ws7b">able system. <span class="_ _1"></span>That’<span class="_ _2"></span>s an obvious statement, but an important one. Systems that aren’<span class="_ _1"></span>t testable</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls10 ws0">aren’<span class="_ _1"></span>t veriﬁable. <span class="_ _1"></span>Arguab<span class="_ _4"></span>ly<span class="_ _0"></span>, a system that cannot be veriﬁed should ne<span class="_ _4"></span>ver be deplo<span class="_ _1"></span>yed.</div><div class="t m0 x74 h14 y38a ff8 fs3 fc0 sc0 ls0 ws1e2">F<span class="_ _1"></span>or<span class="_ _8"></span>tunately<span class="_ _0"></span>, making our systems testable pushes us to<span class="_ _1"></span>ward a design where our classes</div><div class="t m0 xd h14 y38b ff8 fs3 fc0 sc0 ls0 ws625">are small and single pur<span class="_ _8"></span>pose. It’<span class="_ _2"></span>s just easier to test classes that confor<span class="_ _8"></span>m to the SRP<span class="_ _3"></span>. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y282 ff8 fs3 fc0 sc0 ls11 ws23e">more tests w<span class="_ _4"></span>e write, the more w<span class="_ _4"></span>e’ll continue to push to<span class="_ _1"></span>ward things that are simpler to test.</div><div class="t m0 xd h14 y283 ff8 fs3 fc0 sc0 ls0 ws0">So making sure our system is full<span class="_ _4"></span>y testable helps us create better designs.</div><div class="t m0 x74 h14 y2a1 ff8 fs3 fc0 sc0 ls0 ws4d7">T<span class="_ _4"></span>ight coupling makes it dif<span class="_ _4"></span>ﬁcult to write tests. So, similarly<span class="_ _0"></span>, the more tests w<span class="_ _4"></span>e write,</div><div class="t m0 xd h14 y437 ff8 fs3 fc0 sc0 ls0 ws23a">the more w<span class="_ _4"></span>e use principles like DIP and tools like dependenc<span class="_ _4"></span>y injection, interf<span class="_ _8"></span>aces, and</div><div class="t m0 xd h14 y438 ff8 fs3 fc0 sc0 ls0 ws0">abstraction to minimize coupling. Our designs impro<span class="_ _4"></span>ve e<span class="_ _4"></span>ven more.</div><div class="t m0 x74 h14 yc67 ff8 fs3 fc0 sc0 ls0 ws413">Remarkabl<span class="_ _4"></span>y<span class="_ _0"></span>, following a simple and ob<span class="_ _1"></span>vious r<span class="_ _8"></span>ule that says w<span class="_ _1"></span>e need to hav<span class="_ _4"></span>e tests and</div><div class="t m0 xd h14 ye0f ff8 fs3 fc0 sc0 ls0 ws613">run them continuously impacts our system’<span class="_ _2"></span>s adherence to the primary OO goals of low</div><div class="t m0 xd h14 ye10 ff8 fs3 fc0 sc0 ls0 ws0">coupling and high cohesion. <span class="_ _4"></span>Writing tests leads to better designs.</div><div class="t m0 xd h17 ye11 ff1 fs9 fc0 sc0 ls0 ws0">Simple Design Rules 2–4:<span class="_ _4"></span> Refactoring</div><div class="t m0 xd h14 y47c ff8 fs3 fc0 sc0 ls0 ws222">Once w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve tests, w<span class="_ _4"></span>e are empo<span class="_ _4"></span>wered to k<span class="_ _4"></span>eep our code and classes clean. W<span class="_ _0"></span>e do this b<span class="_ _4"></span>y</div><div class="t m0 xd h14 y47e ff8 fs3 fc0 sc0 ls0 ws3e">incrementall<span class="_ _4"></span>y ref<span class="_ _8"></span>actoring the code. F<span class="_ _4"></span>or each fe<span class="_ _4"></span>w lines of code we add<span class="_ _0"></span>, we pause and reﬂect</div><div class="t m0 xd h14 y47f ff8 fs3 fc0 sc0 ls0 ws78">on the new design. Did w<span class="_ _1"></span>e just degrade it? If so, we clean it up and run our tests to demon-</div><div class="t m0 xd h14 y480 ff8 fs3 fc0 sc0 ls0 ws155">strate that w<span class="_ _4"></span>e ha<span class="_ _4"></span>ven’<span class="_ _4"></span>t broken an<span class="_ _4"></span>ything. <span class="_ _1"></span><span class="ffa">The fact that we have these tests eliminates the fear</span></div><div class="t m0 xd h1d y6dc ffa fs3 fc0 sc0 ls0 ws0">that cleaning up the code will br<span class="_ _1"></span>eak it!</div><div class="t m0 x74 h14 y554 ff8 fs3 fc0 sc0 ls30 ws426">During this refactoring step, w<span class="_ _4"></span>e can apply an<span class="_ _4"></span>ything from the entire body of kno<span class="_ _4"></span>wledge</div><div class="t m0 xd h14 y5ed ff8 fs3 fc0 sc0 ls30 ws503">about good softw<span class="_ _4"></span>are design. W<span class="_ _0"></span>e can increase cohesion, decrease coupling, separate con-</div><div class="t m0 xd h14 y5ee ff8 fs3 fc0 sc0 ls30 ws22d">cerns, modularize system concer<span class="_ _8"></span>ns, shrink our functions and classes, choose better names,</div><div class="t m0 xd h14 y5ef ff8 fs3 fc0 sc0 ls30 ws626">and so on. <span class="_ _1"></span>This is also where w<span class="_ _4"></span>e apply the ﬁnal three rules of simple design: Eliminate</div><div class="t m0 xd h14 ye12 ff8 fs3 fc0 sc0 ls30 ws0">duplication, ensure expressi<span class="_ _4"></span>veness, and minimize the number of classes and methods.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:460.945010px;width:240.891000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:212.945010px;width:225.120000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfcc" class="pf w1 h2" data-page-no="cc"><div class="pc pccc w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">173<span class="_ _10"></span><span class="ff1">No Duplication</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">No Duplication</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls2d ws627">Duplication is the primary enemy of a w<span class="_ _1"></span>ell-designed system. It represents additional</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls2d ws628">w<span class="_ _4"></span>ork, additional risk, and additional unnecessary complexity<span class="_ _1"></span>. Duplication manifests</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls2d ws43b">itself in man<span class="_ _4"></span>y for<span class="_ _8"></span>ms. Lines of code that look exactl<span class="_ _4"></span>y alike are, of course, duplication.</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls2d ws629">Lines of code that are similar can often be massaged to look ev<span class="_ _4"></span>en more alike so that</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls2d ws62a">they can be more easil<span class="_ _4"></span>y refactored. <span class="_ _4"></span>And duplication can exist in other forms such as</div><div class="t m0 xd h14 y276 ff8 fs3 fc0 sc0 ls2d wsb1">duplication of implementation. F<span class="_ _1"></span>or example, w<span class="_ _4"></span>e might hav<span class="_ _4"></span>e tw<span class="_ _4"></span>o methods in a collection</div><div class="t m0 xd h14 y277 ff8 fs3 fc0 sc0 ls2d ws0">class:</div><div class="t m5 x74 h2f ye13 ffb fs10 fc0 sc0 ls0 ws0">int size() {}</div><div class="t m5 x74 h2f ye14 ffb fs10 fc0 sc0 ls0 ws0">boolean isEmpty() {}</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws2b3">W<span class="_ _0"></span>e could ha<span class="_ _4"></span>ve separate implementations for each method. <span class="_ _1"></span>The </div><div class="t m5 x53 h2f y253 ffb fs10 fc0 sc0 ls0 ws0">isEmpty</div><div class="t m0 xac h14 y253 ff8 fs3 fc0 sc0 ls0 ws2b3">method could track</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws226">a boolean, while </div><div class="t m5 xbc h2f y254 ffb fs10 fc0 sc0 ls0 ws0">size</div><div class="t m0 xed h14 y254 ff8 fs3 fc0 sc0 ls0 ws226">could track a counter<span class="_ _1"></span>. Or, w<span class="_ _1"></span>e can eliminate this duplication by tying</div><div class="t m5 xd h2f y463 ffb fs10 fc0 sc0 ls0 ws0">isEmpty</div><div class="t m0 x95 h14 y463 ff8 fs3 fc0 sc0 ls0 ws0"> to the deﬁnition of </div><div class="t m5 xc7 h2f y463 ffb fs10 fc0 sc0 ls0 ws0">size</div><div class="t m0 xa2 h14 y463 ff8 fs3 fc0 sc0 ls0 ws0">:</div><div class="t m5 x74 h2f ye15 ffb fs10 fc0 sc0 ls0 ws0">boolean isEmpty() {</div><div class="t m5 x74 h2f ye16 ffb fs10 fc0 sc0 ls0 ws0">   return 0 == size();</div><div class="t m5 x74 h2f ye17 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y466 ff8 fs3 fc0 sc0 ls0 ws4fe">Creating a clean system requires the will to eliminate duplication, ev<span class="_ _4"></span>en in just a few</div><div class="t m0 xd h14 y539 ff8 fs3 fc0 sc0 ls0 ws0">lines of code. F<span class="_ _1"></span>or example, consider the follo<span class="_ _4"></span>wing code:</div><div class="t m5 x74 h2f y901 ffb fs10 fc0 sc0 ls19 ws237">    public void scaleToOneDimension(</div><div class="t m5 x74 h2f ye18 ffb fs10 fc0 sc0 ls0 ws0">         float desiredDimension, float imageDimension) {</div><div class="t m5 x74 h2f y902 ffb fs10 fc0 sc0 ls0 ws0">      if (Math.abs(desiredDimension - imageDimension) &lt; errorThreshold)</div><div class="t m5 x74 h2f ye19 ffb fs10 fc0 sc0 ls0 ws0">         return;</div><div class="t m5 x74 h2f y903 ffb fs10 fc0 sc0 ls0 ws0">      float scalingFactor = desiredDimension / imageDimension;</div><div class="t m5 x74 h2f y904 ffb fs10 fc0 sc0 ls0 ws0">      scalingFactor = (float)(Math.floor(scalingFactor * 100) * 0.01f);</div><div class="t m5 x74 h2f y906 ffb fs10 fc0 sc0 ls0 ws0">      RenderedOp newImage = ImageUtilities.getScaledImage(</div><div class="t m5 x74 h2f y907 ffb fs10 fc0 sc0 ls0 ws0">         image, scalingFactor, scalingFactor);</div><div class="t m5 x74 h2f ye1a ffb fs10 fc0 sc0 ls0 ws0">      image.dispose();</div><div class="t m5 x74 h2f y908 ffb fs10 fc0 sc0 ls0 ws0">      System.gc();</div><div class="t m5 x74 h2f y909 ffb fs10 fc0 sc0 ls0 ws0">      image = newImage;</div><div class="t m5 x74 h2f y90a ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y90b ffb fs10 fc0 sc0 ls0 ws0">   public synchronized void rotate(int degrees) {</div><div class="t m5 x74 h2f ye1b ffb fs10 fc0 sc0 ls0 ws0">      RenderedOp newImage = ImageUtilities.getRotatedImage(</div><div class="t m5 x74 h2f ye1c ffb fs10 fc0 sc0 ls0 ws0">         image, degrees);</div><div class="t m5 x74 h2f ye1d ffb fs10 fc0 sc0 ls0 ws0">      image.dispose();</div><div class="t m5 x74 h2f ye1e ffb fs10 fc0 sc0 ls0 ws0">      System.gc();</div><div class="t m5 x74 h2f ye1f ffb fs10 fc0 sc0 ls0 ws0">      image = newImage;</div><div class="t m5 x74 h2f ye20 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 ls0 ws537">T<span class="_ _0"></span>o keep this system clean, we should eliminate the small amount of duplication betw<span class="_ _1"></span>een</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y8e1 ffb fs10 fc0 sc0 ls0 ws0">scaleToOneDimension</div><div class="t m0 x6e h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 x5d h2f y8e1 ffb fs10 fc0 sc0 ls0 ws0">rotate</div><div class="t m0 x5b h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws0"> methods:</div><div class="t m5 x74 h2f ye21 ffb fs10 fc0 sc0 ls19 ws237">    public void scaleToOneDimension(</div><div class="t m5 x74 h2f ye22 ffb fs10 fc0 sc0 ls0 ws0">         float desiredDimension, float imageDimension) {</div><div class="t m5 x74 h2f ye23 ffb fs10 fc0 sc0 ls0 ws0">      if (Math.abs(desiredDimension - imageDimension) &lt; errorThreshold)</div><div class="t m5 x74 h2f ye24 ffb fs10 fc0 sc0 ls0 ws0">         return;</div><div class="t m5 x74 h2f ye25 ffb fs10 fc0 sc0 ls0 ws0">      float scalingFactor = desiredDimension / imageDimension;</div><div class="t m5 x74 h2f ye26 ffb fs10 fc0 sc0 ls0 ws0">      scalingFactor = (float)(Math.floor(scalingFactor * 100) * 0.01f);</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:90.621000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfcd" class="pf w1 h2" data-page-no="cd"><div class="pc pccd w1 h2"><img class="bi x37 ye27 w8 h27" alt="" src="bgcd.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">174<span class="_ _32"> </span><span class="ff1 wsa0">Chapter 12:<span class="_ _4"></span> Emergence</span></div><div class="t m5 x74 h46 y345 ffc fs10 fc0 sc0 ls0 ws0">      replaceImage(ImageUtilities.getScaledImage(</div><div class="t m5 x74 h46 y627 ffc fs10 fc0 sc0 ls0 ws0">         image, scalingFactor, scalingFactor));</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">   public synchronized void rotate(int degrees) {</div><div class="t m5 x74 h46 y62b ffc fs10 fc0 sc0 ls0 ws0">      replaceImage(ImageUtilities.getRotatedImage(image, degrees));</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h46 y861 ffc fs10 fc0 sc0 ls0 ws0">   private void replaceImage(RenderedOp newImage) {</div><div class="t m5 x74 h46 y62e ffc fs10 fc0 sc0 ls0 ws0">      image.dispose();</div><div class="t m5 x74 h46 y62f ffc fs10 fc0 sc0 ls0 ws0">      System.gc();</div><div class="t m5 x74 h46 y630 ffc fs10 fc0 sc0 ls0 ws0">      image = newImage;</div><div class="t m5 x74 h46 y631 ffc fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws2eb">As w<span class="_ _4"></span>e extract commonality at this very tin<span class="_ _4"></span>y level, w<span class="_ _1"></span>e star<span class="_ _8"></span>t to recognize violations of SRP<span class="_ _3"></span>.</div><div class="t m0 xd h14 y386 ff8 fs3 fc0 sc0 ls0 ws508">So w<span class="_ _4"></span>e might mo<span class="_ _4"></span>ve a ne<span class="_ _4"></span>wly e<span class="_ _4"></span>xtracted method to another class. <span class="_ _4"></span>That elev<span class="_ _4"></span>ates its visibility<span class="_ _0"></span>.</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws21a">Someone else on the team ma<span class="_ _4"></span>y recognize the opportunity to further abstract the new</div><div class="t m0 xd h14 ydf3 ff8 fs3 fc0 sc0 ls0 ws38">method and reuse it in a dif<span class="_ _4"></span>ferent context. <span class="_ _4"></span>This “reuse in the small” can cause system com-</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 ls0 ws3d4">plexity to shrink dramaticall<span class="_ _4"></span>y<span class="_ _0"></span>. Understanding how to achie<span class="_ _4"></span>ve reuse in the small is essential</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws0">to achieving reuse in the lar<span class="_ _4"></span>ge.</div><div class="t m0 x74 h14 y27f ff8 fs3 fc0 sc0 ls0 ws62b">The T<span class="fsb ws0">EMPLATE<span class="fs3 ls6a"> M<span class="_ _0"></span><span class="fsb ls0">ETHOD</span></span></span></div><div class="t m0 xcc h21 y9d0 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x84 h14 y27f ff8 fs3 fc0 sc0 ls0 ws62b">pattern is a common technique for remo<span class="_ _4"></span>ving higher-le<span class="_ _4"></span>vel</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls0 ws0">duplication. F<span class="_ _1"></span>or example: </div><div class="t m5 x74 h2f yb2d ffb fs10 fc0 sc0 ls0 ws0">public class VacationPolicy {</div><div class="t m5 x74 h2f yb2e ffb fs10 fc0 sc0 ls0 ws0">   public void accrueUSDivisionVacation() {</div><div class="t m5 x74 h2f yb2f ffb fs10 fc0 sc0 ls0 ws0">      // code to calculate vacation based on hours worked to date</div><div class="t m5 x74 h2f yb30 ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f yb31 ffb fs10 fc0 sc0 ls0 ws0">      // code to ensure vacation meets US minimums</div><div class="t m5 x74 h2f yb32 ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f yb33 ffb fs10 fc0 sc0 ls0 ws0">      // code to apply vaction to payroll record</div><div class="t m5 x74 h2f yb34 ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f yb35 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f yb37 ffb fs10 fc0 sc0 ls0 ws0">   public void accrueEUDivisionVacation() {</div><div class="t m5 x74 h2f ye28 ffb fs10 fc0 sc0 ls0 ws0">      // code to calculate vacation based on hours worked to date</div><div class="t m5 x74 h2f ye29 ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f ye2a ffb fs10 fc0 sc0 ls0 ws0">      // code to ensure vacation meets EU minimums</div><div class="t m5 x74 h2f ye2b ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f ye2c ffb fs10 fc0 sc0 ls0 ws0">      // code to apply vaction to payroll record</div><div class="t m5 x74 h2f ye2d ffb fs10 fc0 sc0 ls0 ws0">      // ...</div><div class="t m5 x74 h2f ye2e ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f ye2f ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 ye30 ff8 fs3 fc0 sc0 ls0 ws57a">The code across </div><div class="t m5 x3a h2f ye30 ffb fs10 fc0 sc0 ls0 ws0">accrueUSDivisionVacation</div><div class="t m0 xad h14 ye30 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xcf h2f ye30 ffb fs10 fc0 sc0 ls0 ws0">accrueEuropeanDivision<span class="_ _4"></span>Vacation</div><div class="t m0 x94 h14 ye30 ff8 fs3 fc0 sc0 ls0 ws57a">is largel<span class="_ _4"></span>y</div><div class="t m0 xd h14 ye31 ff8 fs3 fc0 sc0 lsc ws62c">the same, with the exception of calculating le<span class="_ _4"></span>gal minimums. <span class="_ _4"></span>That bit of the algorithm</div><div class="t m0 xd h14 ye32 ff8 fs3 fc0 sc0 ls0 ws0">changes based on the emplo<span class="_ _4"></span>yee type.</div><div class="t m0 x74 h14 y367 ff8 fs3 fc0 sc0 ls10 ws0">W<span class="_ _0"></span>e can eliminate the ob<span class="_ _4"></span>vious duplication by appl<span class="_ _4"></span>ying the T</div><div class="t m0 xca h14 y3e6 ff8 fsb fc0 sc0 ls10 ws0">EMPLATE<span class="fs3"> M</span>ETHOD<span class="fs3"> patter<span class="_ _8"></span>n.</span></div><div class="t m5 x74 h2f ye33 ffb fs10 fc0 sc0 ls0 ws0">abstract public class VacationPolicy {</div><div class="t m5 x74 h2f ye34 ffb fs10 fc0 sc0 ls0 ws0">   public void accrueVacation() {</div><div class="t m5 x74 h46 ye35 ffc fs10 fc0 sc0 ls0 ws0">      calculateBaseVacationHours();</div><div class="t m0 xd h25 ye36 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>[GOF].</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfce" class="pf w1 h2" data-page-no="ce"><div class="pc pcce w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">175<span class="_ _10"></span><span class="ff1">Expr<span class="_ _4"></span>essiv<span class="_ _4"></span>e</span></div><div class="t m5 x74 h46 y345 ffc fs10 fc0 sc0 ls0 ws0">      alterForLegalMinimums();</div><div class="t m5 x74 h46 y627 ffc fs10 fc0 sc0 ls0 ws0">      applyToPayroll();</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">   private void calculateBaseVacationHours() { /* ... */ };</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">   abstract protected void alterForLegalMinimums();</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">   private void applyToPayroll() { /* ... */ };</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">public class USVacationPolicy extends VacationPolicy {</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">   @Override protected void alterForLegalMinimums() {</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">      // US specific logic</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">public class EUVacationPolicy extends VacationPolicy {</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">   @Override protected void alterForLegalMinimums() {</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">      // EU specific logic</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y27e ff8 fs3 fc0 sc0 ls0 ws209">The subclasses ﬁll in the “hole” in the </div><div class="t m5 x32 h2f y27e ffb fs10 fc0 sc0 ls0 ws0">accrueVacation</div><div class="t m0 x40 h14 y27e ff8 fs3 fc0 sc0 ls0 ws209">algorithm, suppl<span class="_ _4"></span>ying the only bits of</div><div class="t m0 xd h14 y27f ff8 fs3 fc0 sc0 ls0 ws0">information that are not duplicated.</div><div class="t m0 xd h17 ye38 ff1 fs9 fc0 sc0 ls0 ws0">Expr<span class="_ _4"></span>essiv<span class="_ _1"></span>e</div><div class="t m0 xd h14 y51e ff8 fs3 fc0 sc0 ls0 ws612">Most of us ha<span class="_ _4"></span>ve had the experience of w<span class="_ _1"></span>orking on con<span class="_ _4"></span>voluted code. Man<span class="_ _4"></span>y of us hav<span class="_ _4"></span>e pro-</div><div class="t m0 xd h14 yd43 ff8 fs3 fc0 sc0 ls0 ws3eb">duced some con<span class="_ _4"></span>voluted code ourselv<span class="_ _4"></span>es. It’<span class="_ _2"></span>s easy to write code that <span class="ffa ls15 ws0">we<span class="_ _8"></span></span><span class="ls49 ws360"> understand<span class="_ _1"></span>, because</span></div><div class="t m0 xd h14 yd44 ff8 fs3 fc0 sc0 ls0 ws35f">at the time w<span class="_ _4"></span>e write it w<span class="_ _4"></span>e’<span class="_ _1"></span>re deep in an understanding of the problem w<span class="_ _4"></span>e’<span class="_ _0"></span>re tr<span class="_ _8"></span>ying to solve.</div><div class="t m0 xd h14 y332 ff8 fs3 fc0 sc0 ls0 ws0">Other maintainers of the code aren’<span class="_ _1"></span>t going to hav<span class="_ _4"></span>e so deep an understanding.</div><div class="t m0 x74 h14 ya0e ff8 fs3 fc0 sc0 ls0 ws401">The majority of the cost of a softw<span class="_ _4"></span>are project is in long-ter<span class="_ _8"></span>m maintenance. In order to</div><div class="t m0 xd h14 ye39 ff8 fs3 fc0 sc0 ls0 ws497">minimize the potential for defects as w<span class="_ _4"></span>e introduce change, it’<span class="_ _2"></span>s critical for us to be able to</div><div class="t m0 xd h14 ye3a ff8 fs3 fc0 sc0 ls0 ws5f3">understand what a system does. <span class="_ _1"></span>As systems become more complex, the<span class="_ _4"></span>y take more and</div><div class="t m0 xd h14 y7dd ff8 fs3 fc0 sc0 ls0 ws1bb">more time for a de<span class="_ _4"></span>veloper to understand<span class="_ _1"></span>, and there is an ever greater opportunity for a mis-</div><div class="t m0 xd h14 y7de ff8 fs3 fc0 sc0 ls0 ws24">understanding. <span class="_ _1"></span>Therefore, code should clearly express the intent of its author<span class="_ _1"></span>. <span class="_ _4"></span>The clearer</div><div class="t m0 xd h14 y7df ff8 fs3 fc0 sc0 ls0 ws62d">the author can make the code, the less time others will ha<span class="_ _4"></span>ve to spend understanding it. <span class="_ _1"></span>This</div><div class="t m0 xd h14 y8d1 ff8 fs3 fc0 sc0 ls0 ws0">will reduce defects and shrink the cost of maintenance.</div><div class="t m0 x74 h14 ye3b ff8 fs3 fc0 sc0 ls0 ws2e7">Y<span class="_ _3"></span>ou can express yourself b<span class="_ _4"></span>y choosing good names. <span class="_ _4"></span>W<span class="_ _0"></span>e want to be ab<span class="_ _4"></span>le to hear a class</div><div class="t m0 xd h14 ye3c ff8 fs3 fc0 sc0 ls0 ws0">or function name and not be sur<span class="_ _8"></span>prised when w<span class="_ _1"></span>e discov<span class="_ _4"></span>er its responsibilities. </div><div class="t m0 x74 h14 y70e ff8 fs3 fc0 sc0 ls0 ws62e">Y<span class="_ _3"></span>ou can also express yourself b<span class="_ _4"></span>y keeping y<span class="_ _4"></span>our functions and classes small. Small</div><div class="t m0 xd h14 y70f ff8 fs3 fc0 sc0 ls0 ws0">classes and functions are usuall<span class="_ _4"></span>y easy to name, easy to write, and easy to understand. </div><div class="t m0 x74 h14 ye3d ff8 fs3 fc0 sc0 ls12 ws62f">Y<span class="_ _3"></span>ou can also express yourself b<span class="_ _4"></span>y using standard nomenclature. Design patterns, for</div><div class="t m0 xd h14 ye3e ff8 fs3 fc0 sc0 ls12 ws54">example, are lar<span class="_ _4"></span>gely about communication and e<span class="_ _4"></span>xpressiveness. By using the standard</div><div class="t m0 xd h14 ye3f ff8 fs3 fc0 sc0 ls12 ws630">pattern names, such as C</div><div class="t m0 x7 h14 y5ed ff8 fsb fc0 sc0 ls12 ws0">OMMAND<span class="_ _16"> </span><span class="fs3 ws630">or V</span>ISITOR<span class="_ _4"></span><span class="fs3 ws630">, in the names of the classes that imple-</span></div><div class="t m0 xd h14 y5ee ff8 fs3 fc0 sc0 ls12 ws0">ment those patterns, you can succinctly describe y<span class="_ _4"></span>our design to other de<span class="_ _4"></span>velopers. </div><div class="t m0 x74 h14 ya5d ff8 fs3 fc0 sc0 ls0 ws452">W<span class="_ _0"></span>ell-written unit tests are also expressi<span class="_ _4"></span>ve. <span class="_ _1"></span>A primar<span class="_ _8"></span>y goal of tests is to act as docu-</div><div class="t m0 xd h14 ye40 ff8 fs3 fc0 sc0 ls0 ws631">mentation b<span class="_ _4"></span>y example. Someone reading our tests should be able to get a quick under<span class="_ _4"></span>-</div><div class="t m0 xd h14 ye41 ff8 fs3 fc0 sc0 ls0 ws0">standing of what a class is all about.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:353.945010px;width:63.581000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfcf" class="pf w1 h2" data-page-no="cf"><div class="pc pccf w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">176<span class="_ _32"> </span><span class="ff1 wsa0">Chapter 12:<span class="_ _4"></span> Emergence</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws3fb">But the most important wa<span class="_ _4"></span>y to be expressi<span class="_ _4"></span>ve is to <span class="ffa ws0">try<span class="_ _0"></span><span class="ff8 ws3fb">. <span class="_ _1"></span>All too often we get our code</span></span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 wsf8">w<span class="_ _4"></span>orking and then mo<span class="_ _4"></span>ve on to the ne<span class="_ _4"></span>xt problem without gi<span class="_ _4"></span>ving sufﬁcient thought to making</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws2fb">that code easy for the next person to read. Remember<span class="_ _1"></span>, the most likely ne<span class="_ _4"></span>xt person to read</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">the code will be you. </div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws167">So take a little pride in y<span class="_ _4"></span>our w<span class="_ _4"></span>orkmanship. Spend a little time with each of your func-</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws3f5">tions and classes. Choose better names, split large functions into smaller functions, and</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">generally just tak<span class="_ _4"></span>e care of what y<span class="_ _4"></span>ou’<span class="_ _4"></span>ve created. Care is a precious resource.</div><div class="t m0 xd h17 ye42 ff1 fs9 fc0 sc0 ls0 ws0">Minimal Classes and Methods</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls0 ws5c1">Even concepts as fundamental as elimination of duplication, code e<span class="_ _4"></span>xpressiv<span class="_ _4"></span>eness, and the</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws163">SRP can be taken too far<span class="_ _1"></span>. In an effort to make our classes and methods small, w<span class="_ _4"></span>e might</div><div class="t m0 xd h14 y27b ff8 fs3 fc0 sc0 ls0 ws4c">create too man<span class="_ _4"></span>y tiny classes and methods. So this rule suggests that we also k<span class="_ _4"></span>eep our func-</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws0">tion and class counts lo<span class="_ _4"></span>w<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y29c ff8 fs3 fc0 sc0 ls0 ws632">High class and method counts are sometimes the result of pointless dogmatism. Con-</div><div class="t m0 xd h14 ya7f ff8 fs3 fc0 sc0 ls0 ws2a1">sider<span class="_ _4"></span>, for example, a coding standard that insists on creating an interface for each and</div><div class="t m0 xd h14 y388 ff8 fs3 fc0 sc0 ls0 ws17c">e<span class="_ _4"></span>very class. Or consider developers w<span class="_ _4"></span>ho insist that ﬁelds and beha<span class="_ _4"></span>vior must alw<span class="_ _4"></span>a<span class="_ _4"></span>ys be sep-</div><div class="t m0 xd h14 y389 ff8 fs3 fc0 sc0 ls0 ws633">arated into data classes and beha<span class="_ _4"></span>vior classes. Such dogma should be resisted and a more</div><div class="t m0 xd h14 y38a ff8 fs3 fc0 sc0 ls0 ws0">pragmatic approach adopted. </div><div class="t m0 x74 h14 y29e ff8 fs3 fc0 sc0 ls0 ws307">Our goal is to keep our o<span class="_ _1"></span>verall system small while w<span class="_ _1"></span>e are also keeping our functions</div><div class="t m0 xd h14 y29f ff8 fs3 fc0 sc0 ls0 ws493">and classes small. Remember<span class="_ _4"></span>, ho<span class="_ _4"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>, that this r<span class="_ _8"></span>ule is the lo<span class="_ _4"></span>w<span class="_ _4"></span>est priority of the four r<span class="_ _8"></span>ules</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 ls0 ws634">of Simple Design. So, although it’<span class="_ _2"></span>s important to keep class and function count lo<span class="_ _4"></span>w<span class="_ _1"></span>, it’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y2a1 ff8 fs3 fc0 sc0 ls0 ws0">more important to hav<span class="_ _4"></span>e tests, eliminate duplication, and express yourself.</div><div class="t m0 xd h17 ye43 ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws635">Is there a set of simple practices that can replace experience? Clearl<span class="_ _4"></span>y not. On the other</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws394">hand<span class="_ _1"></span>, the practices described in this chapter and in this book are a cr<span class="_ _8"></span>ystallized for<span class="_ _8"></span>m of the</div><div class="t m0 xd h14 y5cc ff8 fs3 fc0 sc0 ls0 ws636">many decades of e<span class="_ _4"></span>xperience enjo<span class="_ _4"></span>yed b<span class="_ _4"></span>y the authors. F<span class="_ _4"></span>ollo<span class="_ _4"></span>wing the practice of simple</div><div class="t m0 xd h14 y5cd ff8 fs3 fc0 sc0 ls0 ws55">design can and does encourage and enable de<span class="_ _4"></span>velopers to adhere to good principles and</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">patterns that otherwise take years to learn. </div><div class="t m0 xd h17 yba5 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y3ae ff1 fs3 fc0 sc0 ls0 wsa0">[XPE]:<span class="_ _4"></span>  <span class="ffa ws637">Extreme Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>amming Explained: Embr<span class="_ _4"></span>ace Change, <span class="ff8">K<span class="_ _4"></span>ent Beck, <span class="_ _1"></span>Addison-</span></span></div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1999.</div><div class="t m0 xd h14 yde2 ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa ws422">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e, <span class="ff8">Gamma et <span class="_ _4"></span>al.,</span></span></div><div class="t m0 xd h14 yb4c ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:481.945010px;width:180.066000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:281.946010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:183.946010px;width:77.392000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd0" class="pf w1 h2" data-page-no="d0"><div class="pc pcd0 w1 h2"><img class="bi xd ye44 w4 h90" alt="" src="bgd0.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">177</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">13</div><div class="t m0 xb6 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Concurr<span class="_ _1"></span>ency</div><div class="t m0 x58 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">b<span class="_ _4"></span>y Brett L. Schucher<span class="_ _8"></span>t</div><div class="t m0 x46 h1d ye45 ffa fs3 fc0 sc0 ls0 ws0">“Objects ar<span class="_ _4"></span>e abstr<span class="_ _1"></span>actions of pr<span class="_ _4"></span>ocessing. <span class="_ _1"></span>Threads ar<span class="_ _1"></span>e abstr<span class="_ _1"></span>actions of schedule.<span class="_ _2c"></span>”</div><div class="t m0 xeb h14 ye46 ff8 fs3 fc0 sc0 ls0 ws0">—James O<span class="_ _4"></span>. Coplien</div><div class="t m0 x56 h21 ye47 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x11 h25 ye48 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _18"> </span>Priv<span class="_ _4"></span>ate cor<span class="_ _8"></span>respondence.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:305.013000px;bottom:440.027010px;width:133.923000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd1" class="pf w1 h2" data-page-no="d1"><div class="pc pcd1 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">178<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws2f5">Writing clean concur<span class="_ _8"></span>rent programs is hard—very hard. It is much easier to write code that</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws47c">ex<span class="_ _4"></span>ecutes in a single thread. It is also easy to write multithreaded code that looks ﬁne on the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 lsd ws638">surface but is broken at a deeper le<span class="_ _4"></span>vel. Such code w<span class="_ _4"></span>orks ﬁne until the system is placed</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">under stress.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls6b ws129">In this chapter w<span class="_ _4"></span>e discuss the need for concur<span class="_ _8"></span>rent programming, and the difﬁculties</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls6b ws7d">it presents. <span class="_ _4"></span>W<span class="_ _0"></span>e then present several recommendations for dealing with those dif<span class="_ _1"></span>ﬁculties,</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls6b ws626">and writing clean concur<span class="_ _8"></span>rent code. Finall<span class="_ _4"></span>y<span class="_ _0"></span>, we conclude with issues related to testing</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls6b ws0">concur<span class="_ _8"></span>rent code. </div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 ls59 ws639">Clean Concur<span class="_ _8"></span>rency is a comple<span class="_ _4"></span>x topic, worth<span class="_ _4"></span>y of a book by itself. Our strate<span class="_ _4"></span>gy in <span class="ffa ls0 ws0">this</span></div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls59 ws48d">book is to present an o<span class="_ _4"></span>verview here and pro<span class="_ _1"></span>vide a more detailed tutorial in “Concur<span class="_ _8"></span>rency II”</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls59 ws63a">on page 317. If you are just curious about concurrency<span class="_ _0"></span>, then this chapter will sufﬁce for y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls59 ws3a">no<span class="_ _4"></span>w<span class="_ _0"></span>. If you ha<span class="_ _4"></span>ve a need to understand concurrency at a deeper lev<span class="_ _4"></span>el, then you should read</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls59 ws0">through the tutorial as w<span class="_ _4"></span>ell. </div><div class="t m0 xd h17 ye49 ff1 fs9 fc0 sc0 ls0 ws0">Wh<span class="_ _1"></span>y Concurr<span class="_ _4"></span>ency?</div><div class="t m0 xd h14 ye4a ff8 fs3 fc0 sc0 ls0 ws3b6">Concur<span class="_ _8"></span>rency is a decoupling strate<span class="_ _4"></span>gy<span class="_ _1"></span>. It helps us decouple <span class="ffa ws0">what<span class="_ _18"> </span></span>gets done from <span class="ffa ws0">when<span class="_ _16"> </span><span class="ff8">it</span></span></div><div class="t m0 xd h14 ye4b ff8 fs3 fc0 sc0 ls0 ws63b">gets done. In single-threaded applications <span class="ffa ws0">what <span class="ff8">and<span class="_ _a"> </span></span>when<span class="_ _a"> </span></span>are so strongly coupled that the</div><div class="t m0 xd h14 ye4c ff8 fs3 fc0 sc0 ls0 ws63c">state of the entire application can often be determined by looking at the stack backtrace. <span class="_ _1"></span>A</div><div class="t m0 xd h14 ye4d ff8 fs3 fc0 sc0 lsd ws570">programmer who debugs such a system can set a breakpoint, or a sequence of breakpoints,</div><div class="t m0 xd h14 ye4e ff8 fs3 fc0 sc0 ls0 ws0">and <span class="ffa">know</span> the state of the system b<span class="_ _4"></span>y which breakpoints are hit. </div><div class="t m0 x74 h14 ye4f ff8 fs3 fc0 sc0 ls0 ws0">Decoupling <span class="ffa">what </span>from <span class="ffa">when </span><span class="ws2f9">can dramaticall<span class="_ _4"></span>y impro<span class="_ _4"></span>ve both the throughput and struc-</span></div><div class="t m0 xd h14 ye50 ff8 fs3 fc0 sc0 ls0 ws2e8">tures of an application. From a structural point of view the application looks lik<span class="_ _4"></span>e many lit-</div><div class="t m0 xd h14 ye51 ff8 fs3 fc0 sc0 ls0 ws624">tle collaborating computers rather than one big main loop. <span class="_ _1"></span>This can make the system easier</div><div class="t m0 xd h14 ye52 ff8 fs3 fc0 sc0 ls0 ws0">to understand and of<span class="_ _4"></span>fers some pow<span class="_ _1"></span>erful wa<span class="_ _4"></span>ys to separate concerns. </div><div class="t m0 x74 h14 ye53 ff8 fs3 fc0 sc0 ls0 ws43d">Consider<span class="_ _4"></span>, for example, the standard “Servlet” model of W<span class="_ _2"></span>eb applications. <span class="_ _4"></span>These sys-</div><div class="t m0 xd h14 ye54 ff8 fs3 fc0 sc0 ls0 ws5e8">tems run under the umbrella of a W<span class="_ _0"></span>eb or EJB container that <span class="ffa ws0">partially<span class="_ _16"> </span></span>manages concur-</div><div class="t m0 xd h14 ye55 ff8 fs3 fc0 sc0 ls0 ws44">rency for y<span class="_ _4"></span>ou. <span class="_ _4"></span>The servlets are executed asynchronousl<span class="_ _4"></span>y whene<span class="_ _4"></span>ver <span class="_ _1"></span>W<span class="_ _1"></span>eb requests come in.</div><div class="t m0 xd h14 ye56 ff8 fs3 fc0 sc0 ls0 ws63d">The servlet programmer does not hav<span class="_ _4"></span>e to manage all the incoming requests. <span class="ffa">In principle,</span></div><div class="t m0 xd h14 ye57 ff8 fs3 fc0 sc0 ls0 ws11b">each servlet execution li<span class="_ _1"></span>ves in its o<span class="_ _4"></span>wn little w<span class="_ _4"></span>orld and is decoupled from all the other ser<span class="_ _8"></span>v-</div><div class="t m0 xd h14 ye58 ff8 fs3 fc0 sc0 ls0 ws0">let ex<span class="_ _4"></span>ecutions. </div><div class="t m0 x74 h14 y3ad ff8 fs3 fc0 sc0 ls0 ws30f">Of course if it w<span class="_ _4"></span>ere that easy<span class="_ _1"></span>, this chapter w<span class="_ _4"></span>ouldn’<span class="_ _4"></span>t be necessary<span class="_ _1"></span>. In fact, the decou-</div><div class="t m0 xd h14 y544 ff8 fs3 fc0 sc0 ls0 ws533">pling pro<span class="_ _4"></span>vided b<span class="_ _4"></span>y W<span class="_ _0"></span>eb containers is far less than perfect. Servlet programmers hav<span class="_ _4"></span>e to be</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls0 ws336">very a<span class="_ _4"></span>ware, and v<span class="_ _4"></span>er<span class="_ _8"></span>y careful, to make sure their concur<span class="_ _8"></span>rent programs are cor<span class="_ _8"></span>rect. Still, the</div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 ws0">structural beneﬁts of the ser<span class="_ _8"></span>vlet model are signiﬁcant. </div><div class="t m0 x74 h14 y42e ff8 fs3 fc0 sc0 ls0 ws26e">But structure is not the only moti<span class="_ _4"></span>ve for adopting concur<span class="_ _8"></span>rency<span class="_ _0"></span>. Some systems ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws63e">response time and throughput constraints that require hand-coded concur<span class="_ _8"></span>rent solutions.</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 lsc ws496">F<span class="_ _1"></span>or example, consider a single-threaded infor<span class="_ _8"></span>mation aggregator that acquires infor<span class="_ _8"></span>mation</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws22b">from many dif<span class="_ _1"></span>ferent W<span class="_ _0"></span>eb sites and merges that information into a dail<span class="_ _4"></span>y summar<span class="_ _8"></span>y<span class="_ _1"></span>. Because</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:394.945010px;width:116.777000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd2" class="pf w1 h2" data-page-no="d2"><div class="pc pcd2 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">179<span class="_ _10"></span><span class="ff1">Wh<span class="_ _4"></span>y Concurr<span class="_ _4"></span>ency?</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws63f">this system is single threaded<span class="_ _1"></span>, it hits each W<span class="_ _0"></span>eb site in turn, al<span class="_ _4"></span>wa<span class="_ _4"></span>ys ﬁnishing one before</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws2e9">starting the next. <span class="_ _4"></span>The dail<span class="_ _4"></span>y r<span class="_ _8"></span>un needs to ex<span class="_ _4"></span>ecute in less than 24 hours. Ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, as more</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 lsc ws55c">and more <span class="_ _4"></span>W<span class="_ _0"></span>eb sites are added<span class="_ _4"></span>, the time grows until it tak<span class="_ _4"></span>es more than 24 hours to gather</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws23d">all the data. <span class="_ _1"></span>The single-thread inv<span class="_ _4"></span>olves a lot of w<span class="_ _4"></span>aiting at W<span class="_ _2"></span>eb sockets for I/O to complete.</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws640">W<span class="_ _0"></span>e could impro<span class="_ _4"></span>ve the performance by using a multithreaded algorithm that hits more than</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">one <span class="_ _4"></span>W<span class="_ _0"></span>eb site at a time.</div><div class="t m0 x74 h14 y19a ff8 fs3 fc0 sc0 ls2d ws5e3">Or consider a system that handles one user at a time and requires only one second</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls2d ws5de">of time per user<span class="_ _1"></span>. <span class="_ _4"></span>This system is fairly responsi<span class="_ _4"></span>ve for a few users, but as the number of</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls2d ws113">users increases, the system’<span class="_ _2"></span>s response time increases. No user wants to get in line</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls2d ws641">behind 150 others! <span class="_ _4"></span>W<span class="_ _0"></span>e could impro<span class="_ _4"></span>ve the response time of this system b<span class="_ _4"></span>y handling</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls2d ws0">many users concurrently<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y21a ff8 fs3 fc0 sc0 lsd ws5bd">Or consider a system that inter<span class="_ _8"></span>prets large data sets but can onl<span class="_ _4"></span>y giv<span class="_ _4"></span>e a complete solu-</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws5ff">tion after processing all of them. P<span class="_ _4"></span>erhaps each data set could be processed on a different</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">computer<span class="_ _4"></span>, so that many data sets are being processed in parallel.</div><div class="t m0 xd h11 ye59 ff1 fs7 fc0 sc0 ls0 ws0">Myths and Misconceptions</div><div class="t m0 xd h14 y5c0 ff8 fs3 fc0 sc0 ls0 ws642">And so there are compelling reasons to adopt concur<span class="_ _8"></span>rency<span class="_ _0"></span>. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>, as we said before,</div><div class="t m0 xd h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws416">concur<span class="_ _8"></span>rency is <span class="ffa ws0">har<span class="_ _1"></span>d<span class="ff8 ws416">. If you aren’<span class="_ _4"></span>t very careful, you can create some v<span class="_ _4"></span>er<span class="_ _8"></span>y nasty situations.</span></span></div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls0 ws0">Consider these common m<span class="_ _4"></span>yths and misconceptions:</div><div class="t m0 x2c h14 y2c5 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa ws1e3">Concurr<span class="_ _4"></span>ency always impr<span class="_ _1"></span>oves perf<span class="_ _4"></span>ormance.</span></div><div class="t m0 x74 h14 y468 ff8 fs3 fc0 sc0 ls0 ws643">Concur<span class="_ _8"></span>rency can <span class="ffa ws0">sometimes<span class="_ _b"> </span></span><span class="lsd ws644">impro<span class="_ _4"></span>ve performance, but only w<span class="_ _4"></span>hen there is a lot of wait </span></div><div class="t m0 x74 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">time that can be shared betw<span class="_ _4"></span>een multiple threads or multiple processors. Neither situ-</div><div class="t m0 x74 h14 y46a ff8 fs3 fc0 sc0 ls0 ws0">ation is tri<span class="_ _4"></span>vial.</div><div class="t m0 x2c h14 y310 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Design does not chang<span class="_ _4"></span>e when writing concurr<span class="_ _4"></span>ent pr<span class="_ _4"></span>ogr<span class="_ _1"></span>ams.</span></div><div class="t m0 x74 h14 y311 ff8 fs3 fc0 sc0 ls0 ws0">In fact, the design of a concur<span class="_ _8"></span>rent algorithm can be remarkabl<span class="_ _4"></span>y different from the </div><div class="t m0 x74 h14 y2ba ff8 fs3 fc0 sc0 ls0 ws0">design of a single-threaded system. <span class="_ _1"></span>The decoupling of <span class="ffa">what</span> from <span class="ffa">when</span> usuall<span class="_ _4"></span>y has a </div><div class="t m0 x74 h14 y226 ff8 fs3 fc0 sc0 ls0 ws0">huge ef<span class="_ _4"></span>fect on the str<span class="_ _8"></span>ucture of the system. </div><div class="t m0 x2c h14 ye5a ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Understanding concurr<span class="_ _4"></span>ency issues is not important when w<span class="_ _4"></span>orking with a container </span></div><div class="t m0 x74 h1d ycfc ffa fs3 fc0 sc0 ls0 ws0">such as a <span class="_ _1"></span>W<span class="_ _2"></span>eb or EJB container<span class="_ _0"></span>.</div><div class="t m0 x74 h14 ycfd ff8 fs3 fc0 sc0 lsc ws3f">In fact, you’<span class="_ _3"></span>d better know just w<span class="_ _4"></span>hat your container is doing and ho<span class="_ _1"></span>w to guard against </div><div class="t m0 x74 h14 ye5b ff8 fs3 fc0 sc0 ls0 ws0">the issues of concur<span class="_ _8"></span>rent update and deadlock described later in this chapter<span class="_ _1"></span>. </div><div class="t m0 x74 h14 ye5c ff8 fs3 fc0 sc0 lsc ws3f">Here are a fe<span class="_ _4"></span>w more balanced sound bites regarding writing concur<span class="_ _8"></span>rent software:</div><div class="t m0 x2c h14 ye5d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa ws645">Concurr<span class="_ _4"></span>ency incurs some o<span class="_ _4"></span>verhead, <span class="ff8">both in perfor<span class="_ _8"></span>mance as w<span class="_ _4"></span>ell as writing additional </span></span></div><div class="t m0 x74 h14 ye5e ff8 fs3 fc0 sc0 ls0 ws0">code.</div><div class="t m0 x2c h14 y301 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Corr<span class="_ _4"></span>ect concurr<span class="_ _4"></span>ency is complex,<span class="ff8"> ev<span class="_ _4"></span>en for simple problems.</span></span></div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:390.728010px;width:137.339000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd3" class="pf w1 h2" data-page-no="d3"><div class="pc pcd3 w1 h2"><img class="bi x37 ye5f w8 h27" alt="" src="bgd3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">180<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 x2c h14 ye60 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa lsc ws3f">Concurr<span class="_ _4"></span>ency bugs ar<span class="_ _4"></span>en’<span class="_ _1"></span>t usually r<span class="_ _4"></span>epeatab<span class="_ _4"></span>le,<span class="ff8 ls0 ws0"> so they are often ignored as one-of<span class="_ _1"></span>fs</span></span></div><div class="t m0 xbf h21 ye61 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x74 h14 ye62 ff8 fs3 fc0 sc0 ls0 ws0">instead of the true defects they are.</div><div class="t m0 x2c h14 ye63 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Concurr<span class="_ _4"></span>ency often r<span class="_ _4"></span>equires a fundamental c<span class="_ _4"></span>hange in design str<span class="_ _1"></span>ategy<span class="_ _1"></span><span class="ff8">.</span></span></div><div class="t m0 xd h17 ye64 ff1 fs9 fc0 sc0 ls0 ws0">Challeng<span class="_ _4"></span>es</div><div class="t m0 xd h14 ye65 ff8 fs3 fc0 sc0 ls0 ws0">What makes concurrent programming so difﬁcult? Consider the follo<span class="_ _1"></span>wing trivial class:</div><div class="t m5 x74 h2f ye66 ffb fs10 fc0 sc0 ls0 ws0">public class X {</div><div class="t m5 x74 h2f ye67 ffb fs10 fc0 sc0 ls0 ws0">   private int lastIdUsed;</div><div class="t m5 x74 h2f ye68 ffb fs10 fc0 sc0 ls0 ws0">   public int getNextId() {</div><div class="t m5 x74 h2f ye69 ffb fs10 fc0 sc0 ls0 ws0">        return ++lastIdUsed;</div><div class="t m5 x74 h2f ye6a ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ye6b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws107">Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y we create an instance of </div><div class="t m5 x5c h2f y5d2 ffb fs10 fc0 sc0 ls0 ws0">X</div><div class="t m0 x48 h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws107">, set the </div><div class="t m5 xce h2f y5d2 ffb fs10 fc0 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x21 h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws107">ﬁeld to 42, and then share the</div><div class="t m0 xd h14 y2d7 ff8 fs3 fc0 sc0 ls0 ws646">instance betw<span class="_ _4"></span>een tw<span class="_ _4"></span>o threads. No<span class="_ _4"></span>w suppose that both of those threads call the method</div><div class="t m5 xd h2f y2d8 ffb fs10 fc0 sc0 ls0 ws0">getNextId()</div><div class="t m0 x4c h14 y2d8 ff8 fs3 fc0 sc0 ls0 ws0">; there are three possible outcomes:</div><div class="t m0 x2c h14 y3a2 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Thread one gets the v<span class="_ _4"></span>alue 43, thread two gets the v<span class="_ _4"></span>alue 44, </div><div class="t m5 x55 h2f y3a2 ffb fs10 fc0 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x6f h14 y3a2 ff8 fs3 fc0 sc0 ls0 ws0"> is 44.</div><div class="t m0 x2c h14 ye6c ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Thread one gets the value 44, thread tw<span class="_ _1"></span>o gets the value 43, </div><div class="t m5 x55 h2f y7a2 ffb fs10 fc0 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x6f h14 y7a2 ff8 fs3 fc0 sc0 ls0 ws0"> is 44.</div><div class="t m0 x2c h14 ye6d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Thread one gets the value 43, thread tw<span class="_ _1"></span>o gets the value 43, </div><div class="t m5 x55 h2f ye6e ffb fs10 fc0 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x6f h14 ye6e ff8 fs3 fc0 sc0 ls0 ws0"> is 43.</div><div class="t m0 x74 h14 y413 ff8 fs3 fc0 sc0 ls0 ws17d">The sur<span class="_ _8"></span>prising third result</div><div class="t m0 x38 h21 yd99 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 xa2 h14 y413 ff8 fs3 fc0 sc0 ls0 ws17d">occurs when the tw<span class="_ _1"></span>o threads step on each other<span class="_ _4"></span>. <span class="_ _4"></span>This hap-</div><div class="t m0 xd h14 y414 ff8 fs3 fc0 sc0 ls0 ws5c1">pens because there are many possib<span class="_ _4"></span>le paths that the tw<span class="_ _4"></span>o threads can take through that one</div><div class="t m0 xd h14 y42a ff8 fs3 fc0 sc0 ls0 wsa2">line of Ja<span class="_ _4"></span>va code, and some of those paths generate incorrect results. Ho<span class="_ _4"></span>w many dif<span class="_ _4"></span>ferent</div><div class="t m0 xd h14 y42b ff8 fs3 fc0 sc0 ls0 ws647">paths are there? <span class="_ _1"></span>T<span class="_ _1"></span>o really ans<span class="_ _4"></span>wer that question, w<span class="_ _1"></span>e need to understand what the Just-In-</div><div class="t m0 xd h14 yddd ff8 fs3 fc0 sc0 ls0 ws4c6">T<span class="_ _4"></span>ime Compiler does with the generated byte-code, and understand w<span class="_ _4"></span>hat the Ja<span class="_ _4"></span>va memory</div><div class="t m0 xd h14 y58b ff8 fs3 fc0 sc0 ls0 ws0">model considers to be atomic.</div><div class="t m0 x74 h14 y58c ff8 fs3 fc0 sc0 ls0 ws274">A quick answ<span class="_ _1"></span>er, w<span class="_ _1"></span>orking with just the generated byte-code, is that there are 12,870</div><div class="t m0 xd h14 ye6f ff8 fs3 fc0 sc0 ls0 ws648">dif<span class="_ _4"></span>ferent possible ex<span class="_ _4"></span>ecution paths</div><div class="t m0 x81 h21 y37c ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x77 h14 y43a ff8 fs3 fc0 sc0 ls0 ws648">for those tw<span class="_ _4"></span>o threads ex<span class="_ _4"></span>ecuting within the </div><div class="t m5 x99 h2f y43a ffb fs10 fc0 sc0 ls0 ws0">getNextId</div><div class="t m0 xd h14 y43b ff8 fs3 fc0 sc0 ls0 ws649">method. If the type of </div><div class="t m5 x9e h2f y43b ffb fs10 fc0 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x5b h14 y43b ff8 fs3 fc0 sc0 ls0 ws649">is changed from </div><div class="t m5 x96 h2f y43b ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 xdb h14 y43b ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xc9 h2f y43b ffb fs10 fc0 sc0 ls0 ws0">long</div><div class="t m0 xa3 h14 y43b ff8 fs3 fc0 sc0 ls0 ws649">, the number of possible</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws64a">paths increases to 2,704,156. Of course most of those paths generate valid results. <span class="_ _1"></span>The</div><div class="t m0 xd h14 y43c ff8 fs3 fc0 sc0 ls0 ws0">problem is that <span class="ffa">some of them don’<span class="_ _0"></span>t<span class="ff8">.</span></span></div><div class="t m0 xd h17 ye70 ff1 fs9 fc0 sc0 ls0 ws0">Concurr<span class="_ _4"></span>ency Defense Principles</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 ws4">What follo<span class="_ _4"></span>ws is a series of principles and techniques for defending your systems from the</div><div class="t m0 xd h14 yde2 ff8 fs3 fc0 sc0 ls0 ws0">problems of concurrent code. </div><div class="t m0 x11 h25 ye71 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _18"> </span>Cosmic-rays, glitches, and so on.</div><div class="t m0 x11 h25 ye72 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _18"> </span>See “Digging Deeper” on page 323.</div><div class="t m0 x11 h25 ye73 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _18"> </span>See “Possib<span class="_ _4"></span>le Paths of Execution” on page 321.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:521.945010px;width:65.060000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:157.945010px;width:191.660000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd4" class="pf w1 h2" data-page-no="d4"><div class="pc pcd4 w1 h2"><img class="bi x37 yb86 w8 h27" alt="" src="bgd4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">181<span class="_ _10"></span><span class="ff1">Concurr<span class="_ _4"></span>ency Defense Principles</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Single Responsibility Principle</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws5b8">The SRP</div><div class="t m0 xdc h21 y9b3 ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 xb3 h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws5b8">states that a gi<span class="_ _4"></span>ven method/class/component should ha<span class="_ _4"></span>ve a single reason to</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws90">change. Concur<span class="_ _8"></span>rency design is comple<span class="_ _4"></span>x enough to be a reason to change in it’<span class="_ _2"></span>s own right</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws360">and therefore deserves to be separated from the rest of the code. Unfortunately<span class="_ _0"></span>, it is all too</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws509">common for concur<span class="_ _8"></span>rency implementation details to be embedded directl<span class="_ _4"></span>y into other pro-</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0">duction code. Here are a fe<span class="_ _4"></span>w things to consider:</div><div class="t m0 x2c h14 y602 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Concurr<span class="_ _4"></span>ency-r<span class="_ _4"></span>elated code has its own lif<span class="_ _4"></span>e cycle of development,<span class="ff8"> change, and tuning.</span></span></div><div class="t m0 x2c h14 ye74 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ffa">Concurr<span class="_ _4"></span>ency-r<span class="_ _4"></span>elated code has its own challeng<span class="_ _4"></span>es,<span class="ff8"> which are dif<span class="_ _4"></span>ferent from and often </span></span></div><div class="t m0 x74 h14 y385 ff8 fs3 fc0 sc0 ls0 ws0">more dif<span class="_ _4"></span>ﬁcult than nonconcur<span class="_ _8"></span>rency-related code.</div><div class="t m0 x2c h14 ye75 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>The number of w<span class="_ _4"></span>ays in w<span class="_ _4"></span>hich miswritten concurrency-based code can fail makes it </div><div class="t m0 x74 h14 ye76 ff8 fs3 fc0 sc0 lsd wsef">challenging enough without the added burden of sur<span class="_ _8"></span>rounding application code.</div><div class="t m0 x74 h14 y636 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">K<span class="_ _4"></span>eep your concurr<span class="_ _4"></span>ency-related code separ<span class="_ _1"></span>ate fr<span class="_ _4"></span>om other code<span class="ff8">.</span></span></span></div><div class="t m0 x16 h21 y255 ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 xd h11 ye59 ff1 fs7 fc0 sc0 ls0 ws0">Cor<span class="_ _4"></span>ollary:<span class="_ _4"></span> Limit the Scope of Data</div><div class="t m0 xd h14 y5c0 ff8 fs3 fc0 sc0 ls0 ws11b">As w<span class="_ _4"></span>e sa<span class="_ _4"></span>w<span class="_ _0"></span>, two threads modifying the same ﬁeld of a shared object can interfere with each</div><div class="t m0 xd h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws31b">other<span class="_ _4"></span>, causing unexpected beha<span class="_ _4"></span>vior<span class="_ _1"></span>. One solution is to use the </div><div class="t m5 xa3 h2f y5c1 ffb fs10 fc0 sc0 ls0 ws0">synchronized</div><div class="t m0 x98 h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws31b">ke<span class="_ _4"></span>yword to</div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls0 ws5de">protect a <span class="ffa">critical section </span>in the code that uses the shared object. It is important to restrict</div><div class="t m0 xd h14 y5c3 ff8 fs3 fc0 sc0 ls0 ws569">the number of such critical sections. <span class="_ _1"></span>The more places shared data can get updated<span class="_ _4"></span>, the</div><div class="t m0 xd h14 y5c4 ff8 fs3 fc0 sc0 ls0 ws0">more likel<span class="_ _4"></span>y:</div><div class="t m0 x2c h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Y<span class="_ _3"></span>ou will forget to protect one or more of those places—ef<span class="_ _4"></span>fectivel<span class="_ _4"></span>y breaking all code </div><div class="t m0 x74 h14 y46a ff8 fs3 fc0 sc0 ls0 ws0">that modiﬁes that shared data.</div><div class="t m0 x2c h14 y310 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>There will be duplication of effort required to make sure e<span class="_ _4"></span>verything is effecti<span class="_ _4"></span>vel<span class="_ _4"></span>y </div><div class="t m0 x74 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">guarded (violation of DR<span class="_ _2"></span>Y</div><div class="t m0 x84 h21 y2b9 ff8 fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 xa2 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">).</div><div class="t m0 x2c h14 y670 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>It will be dif<span class="_ _4"></span>ﬁcult to deter<span class="_ _8"></span>mine the source of failures, which are already hard enough </div><div class="t m0 x74 h14 y671 ff8 fs3 fc0 sc0 ls0 ws0">to ﬁnd.</div><div class="t m0 x74 h14 y2e5 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _b"> </span><span class="ffa ws44a">T<span class="_ _0"></span>ake data encapsulation to heart; sever<span class="_ _4"></span>ely limit the access of any</span></span></div><div class="t m0 xd h1d y2e6 ffa fs3 fc0 sc0 ls0 ws0">data that may be shar<span class="_ _4"></span>ed.</div><div class="t m0 xd h11 ye77 ff1 fs7 fc0 sc0 ls0 ws0">Cor<span class="_ _4"></span>ollary:<span class="_ _4"></span> Use Copies of Data</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 wsa3">A good wa<span class="_ _1"></span>y to av<span class="_ _4"></span>oid shared data is to a<span class="_ _4"></span>void sharing the data in the ﬁrst place. In some sit-</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws114">uations it is possible to cop<span class="_ _1"></span>y objects and treat them as read-only<span class="_ _0"></span>. In other cases it might be</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws64b">possible to cop<span class="_ _1"></span>y objects, collect results from multiple threads in these copies and then</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws0">merge the results in a single thread.</div><div class="t m0 x11 h25 ye78 ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _18"> </span>[PPP]</div><div class="t m0 x11 h25 ye79 ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _18"> </span>See “Client/Server Example” on page 317.</div><div class="t m0 x11 h25 ye7a ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _18"> </span>[PRAG].</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:390.728010px;width:177.593000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:156.695000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:173.729010px;width:153.257000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd5" class="pf w1 h2" data-page-no="d5"><div class="pc pcd5 w1 h2"><img class="bi x37 ycf4 w8 h27" alt="" src="bgd5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">182<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls10 ws62f">If there is an easy w<span class="_ _4"></span>ay to a<span class="_ _1"></span>void sharing objects, the resulting code will be far less likely</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls10 ws2d7">to cause problems. <span class="_ _0"></span>Y<span class="_ _3"></span>ou might be concer<span class="_ _8"></span>ned about the cost of all the extra object creation. It is</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls10 ws64c">w<span class="_ _4"></span>orth experimenting to ﬁnd out if this is in fact a problem. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, if using copies of</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls10 ws6b">objects allo<span class="_ _4"></span>ws the code to a<span class="_ _4"></span>void synchronizing, the sa<span class="_ _4"></span>vings in a<span class="_ _4"></span>voiding the intrinsic lock will</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls10 ws3f">likel<span class="_ _4"></span>y make up for the additional creation and garbage collection o<span class="_ _4"></span>verhead.</div><div class="t m0 xd h11 ye7b ff1 fs7 fc0 sc0 ls0 ws0">Cor<span class="_ _4"></span>ollary:<span class="_ _4"></span> <span class="_ _1"></span>Threads Should Be as Independent as P<span class="_ _0"></span>ossible</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws46">Consider writing your threaded code such that each thread e<span class="_ _4"></span>xists in its o<span class="_ _4"></span>wn w<span class="_ _4"></span>orld<span class="_ _4"></span>, sharing</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws3de">no data with an<span class="_ _4"></span>y other thread. Each thread processes one client request, with all of its</div><div class="t m0 xd h14 ye7c ff8 fs3 fc0 sc0 ls0 ws354">required data coming from an unshared source and stored as local variab<span class="_ _4"></span>les. <span class="_ _1"></span>This makes</div><div class="t m0 xd h14 y444 ff8 fs3 fc0 sc0 ls0 ws59e">each of those threads beha<span class="_ _4"></span>ve as if it w<span class="_ _4"></span>ere the only thread in the w<span class="_ _1"></span>orld and there were no</div><div class="t m0 xd h14 y445 ff8 fs3 fc0 sc0 ls0 ws0">synchronization requirements.</div><div class="t m0 x74 h14 y6ce ff8 fs3 fc0 sc0 ls2d ws53f">F<span class="_ _1"></span>or example, classes that subclass from </div><div class="t m5 x1b h2f y6ce ffb fs10 fc0 sc0 ls2e ws0">HttpServlet</div><div class="t m0 xae h14 y6ce ff8 fs3 fc0 sc0 ls2d ws53f">receiv<span class="_ _4"></span>e all of their information</div><div class="t m0 xd h14 y6cf ff8 fs3 fc0 sc0 ls2d ws47a">as parameters passed in to the </div><div class="t m5 x1c h2f ye7d ffb fs10 fc0 sc0 ls2e ws0">doGet</div><div class="t m0 x31 h14 ye7d ff8 fs3 fc0 sc0 ls2d ws0">and</div><div class="t m5 xc4 h2f ye7d ffb fs10 fc0 sc0 ls2e ws0">doPost</div><div class="t m0 x3c h14 ye7d ff8 fs3 fc0 sc0 ls2d ws47a">methods. <span class="_ _1"></span>This makes each </div><div class="t m5 x98 h2f ye7d ffb fs10 fc0 sc0 ls2e ws0">Servlet</div><div class="t m0 xf0 h14 ye7d ff8 fs3 fc0 sc0 ls2d ws0">act</div><div class="t m0 xd h14 ye7e ff8 fs3 fc0 sc0 ls2d ws4dd">as if it has its o<span class="_ _4"></span>wn machine. So long as the code in the </div><div class="t m5 xe3 h2f ye7e ffb fs10 fc0 sc0 ls2e ws0">Servlet</div><div class="t m0 x51 h14 ye7e ff8 fs3 fc0 sc0 ls2d ws4dd">uses only local v<span class="_ _1"></span>ariables,</div><div class="t m0 xd h14 y3a0 ff8 fs3 fc0 sc0 ls2d ws64d">there is no chance that the </div><div class="t m5 xcc h2f y3a0 ffb fs10 fc0 sc0 ls2e ws0">Servlet</div><div class="t m0 x31 h14 y3a0 ff8 fs3 fc0 sc0 ls2d ws64d">will cause synchronization problems. Of course,</div><div class="t m0 xd h14 y3a1 ff8 fs3 fc0 sc0 ls2d ws64e">most applications using </div><div class="t m5 x15 h2f y3a1 ffb fs10 fc0 sc0 ls2e ws0">Servlets</div><div class="t m0 x76 h14 y3a1 ff8 fs3 fc0 sc0 ls2d ws64e">e<span class="_ _4"></span>ventually run into shared resources such as database</div><div class="t m0 xd h14 y3a2 ff8 fs3 fc0 sc0 ls2d ws0">connections.</div><div class="t m0 x74 h14 y2da ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _18"> </span><span class="ffa ws3ce">Attempt to partition data into independent subsets than can be</span></span></div><div class="t m0 xd h1d y2db ffa fs3 fc0 sc0 ls0 ws0">oper<span class="_ _4"></span>ated on by independent thr<span class="_ _4"></span>eads, possibl<span class="_ _4"></span>y in differ<span class="_ _1"></span>ent processor<span class="_ _4"></span>s.</div><div class="t m0 xd h17 ye7f ff1 fs9 fc0 sc0 ls0 ws4ee">Kno<span class="_ _1"></span>w Y<span class="_ _3"></span>our <span class="_ _d"></span>Library</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls10 ws5d2">Ja<span class="_ _4"></span>va 5 of<span class="_ _4"></span>fers many impro<span class="_ _1"></span>vements for concurrent development o<span class="_ _1"></span>ver pre<span class="_ _4"></span>vious versions. <span class="_ _1"></span>There</div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls10 ws0">are sev<span class="_ _4"></span>eral things to consider when writing threaded code in Ja<span class="_ _1"></span>va 5:</div><div class="t m0 x2c h14 y98e ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Use the pro<span class="_ _4"></span>vided thread-safe collections.</div><div class="t m0 x2c h14 y5cc ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Use the ex<span class="_ _4"></span>ecutor frame<span class="_ _4"></span>work for e<span class="_ _4"></span>xecuting unrelated tasks.</div><div class="t m0 x2c h14 y37d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Use nonblocking solutions w<span class="_ _4"></span>hen possible.</div><div class="t m0 x2c h14 yde1 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Se<span class="_ _4"></span>veral library classes are not thread safe.</div><div class="t m0 xd h11 ye80 ff1 fs7 fc0 sc0 ls0 ws0">Thr<span class="_ _4"></span>ead-Safe Collections</div><div class="t m0 xd h14 y6db ff8 fs3 fc0 sc0 ls0 ws64f">When Ja<span class="_ _4"></span>va w<span class="_ _4"></span>as young, Doug Lea wrote the seminal book</div><div class="t m0 xf1 h21 y400 ff8 fsc fc0 sc0 ls0 ws0">8</div><div class="t m0 x7f h1d y6db ffa fs3 fc0 sc0 ls0 ws64f">Concurr<span class="_ _4"></span>ent Pr<span class="_ _4"></span>ogr<span class="_ _1"></span>amming in</div><div class="t m0 xd h14 ybf7 ffa fs3 fc0 sc0 ls0 ws0">J<span class="_ _4"></span>ava<span class="ff8 ws650">. <span class="_ _4"></span>Along with the book he de<span class="_ _4"></span>veloped sev<span class="_ _4"></span>eral thread-safe collections, which later</span></div><div class="t m0 xd h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws651">became part of the JDK in the </div><div class="t m5 x1 h2f y3e7 ffb fs10 fc0 sc0 ls0 ws0">java.util.concurrent</div><div class="t m0 xd2 h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws651">package. <span class="_ _1"></span>The collections in that pack-</div><div class="t m0 xd h14 ybf8 ff8 fs3 fc0 sc0 ls0 ws652">age are safe for multithreaded situations and they perform w<span class="_ _4"></span>ell. In fact, the</div><div class="t m0 x11 h25 ye81 ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _18"> </span>[Lea99].</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:510.728010px;width:291.748000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:306.945010px;width:117.147000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:177.728010px;width:123.302000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd6" class="pf w1 h2" data-page-no="d6"><div class="pc pcd6 w1 h2"><img class="bi xd ye82 wc h91" alt="" src="bgd6.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">183<span class="_ _10"></span><span class="ff1">Kno<span class="_ _1"></span>w <span class="_ _0"></span>Y<span class="_ _0"></span>our Ex<span class="_ _4"></span>ecution Models</span></div><div class="t m5 xd h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ConcurrentHashMap</div><div class="t m0 xf2 h14 y194 ff8 fs3 fc0 sc0 ls0 ws5ad">implementation performs better than </div><div class="t m5 xb6 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">HashMap</div><div class="t m0 xa0 h14 y194 ff8 fs3 fc0 sc0 ls0 ws5ad">in nearly all situations. It</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws653">also allo<span class="_ _4"></span>ws for simultaneous concur<span class="_ _8"></span>rent reads and writes, and it has methods suppor<span class="_ _8"></span>ting</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws3cb">common composite operations that are otherwise not thread safe. If Ja<span class="_ _4"></span>va 5 is the deplo<span class="_ _1"></span>y-</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">ment en<span class="_ _4"></span>vironment, start with </div><div class="t m5 x5a h2f y197 ffb fs10 fc0 sc0 ls0 ws0">ConcurrentHashMap</div><div class="t m0 xcf h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws654">There are se<span class="_ _4"></span>veral other kinds of classes added to support advanced concur<span class="_ _8"></span>rency</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">design. Here are a fe<span class="_ _4"></span>w examples:</div><div class="t m0 x74 h14 y1a1 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _18"> </span><span class="ffa ws655">Revie<span class="_ _4"></span>w the classes availab<span class="_ _4"></span>le to you. In the case of J<span class="_ _4"></span>ava, become</span></span></div><div class="t m0 xd h1d y1a2 ffa fs3 fc0 sc0 ls0 ws0">familiar with java.util.concurr<span class="_ _4"></span>ent, java.util.concurr<span class="_ _4"></span>ent.atomic, java.util.concurrent.loc<span class="_ _4"></span>ks.</div><div class="t m0 xd h17 ye83 ff1 fs9 fc0 sc0 ls0 ws0">Kno<span class="_ _1"></span>w <span class="_ _2"></span>Y<span class="_ _3"></span>our Ex<span class="_ _4"></span>ecution Models</div><div class="t m0 xd h14 y539 ff8 fs3 fc0 sc0 ls0 wsbe">There are se<span class="_ _4"></span>veral different w<span class="_ _4"></span>a<span class="_ _4"></span>ys to par<span class="_ _8"></span>tition beha<span class="_ _4"></span>vior in a concur<span class="_ _8"></span>rent application. <span class="_ _4"></span>T<span class="_ _1"></span>o dis-</div><div class="t m0 xd h14 ye84 ff8 fs3 fc0 sc0 ls0 ws0">cuss them w<span class="_ _4"></span>e need to understand some basic deﬁnitions.</div><div class="t m0 x74 h14 y73c ff8 fs3 fc0 sc0 ls0 ws656">Giv<span class="_ _4"></span>en these deﬁnitions, w<span class="_ _4"></span>e can no<span class="_ _4"></span>w discuss the various ex<span class="_ _1"></span>ecution models used in</div><div class="t m0 xd h14 y3cb ff8 fs3 fc0 sc0 ls0 ws0">concur<span class="_ _8"></span>rent programming.</div><div class="t m7 x47 h36 y56e ffc fs3 fc0 sc0 ls0 ws0">ReentrantLock</div><div class="t m0 x4 h14 y56e ff8 fs3 fc0 sc0 ls0 ws657">A lock that can be acquired in one method and released in another<span class="_ _1"></span>. </div><div class="t m7 x47 h36 y277 ffc fs3 fc0 sc0 ls0 ws0">Semaphore</div><div class="t m0 x4 h14 y277 ff8 fs3 fc0 sc0 ls0 ws0">An implementation of the classic semaphore, a lock with a count. </div><div class="t m7 x47 h36 y1fc ffc fs3 fc0 sc0 ls0 ws0">CountDownLatch</div><div class="t m0 x4 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws658">A lock that w<span class="_ _4"></span>aits for a number of events before releasing all</div><div class="t m0 x4 h14 y208 ff8 fs3 fc0 sc0 ls0 ws413">threads waiting on it. <span class="_ _1"></span>This allo<span class="_ _4"></span>ws all threads to ha<span class="_ _4"></span>ve a fair chance</div><div class="t m0 x4 h14 y21a ff8 fs3 fc0 sc0 ls0 ws0">of starting at about the same time.</div><div class="t m0 x47 h14 y1c5 ff8 fs3 fc0 sc0 ls0 ws336">Bound Resources<span class="_ _34"> </span>Resources of a ﬁx<span class="_ _4"></span>ed size or number used in a concur<span class="_ _8"></span>rent environ-</div><div class="t m0 x2e h14 y1c6 ff8 fs3 fc0 sc0 ls0 ws40f">ment. Examples include database connections and ﬁx<span class="_ _4"></span>ed-size read/</div><div class="t m0 x2e h14 y1c7 ff8 fs3 fc0 sc0 ls48 ws4e9">write buffers.</div><div class="t m0 x47 h14 y35c ff8 fs3 fc0 sc0 ls0 ws509">Mutual <span class="_ _1"></span>Exclusion<span class="_ _35"> </span>Only one thread can access shared data or a shared resource at a</div><div class="t m0 x2e h14 y35d ff8 fs3 fc0 sc0 ls0 ws0">time.</div><div class="t m0 x47 h14 ycc5 ff8 fs3 fc0 sc0 ls0 ws659">Starvation<span class="_ _36"> </span>One thread or a group of threads is prohibited from proceeding</div><div class="t m0 x2e h14 y874 ff8 fs3 fc0 sc0 ls0 ws2c5">for an excessi<span class="_ _4"></span>vel<span class="_ _4"></span>y long time or forev<span class="_ _4"></span>er<span class="_ _4"></span>. F<span class="_ _1"></span>or example, al<span class="_ _4"></span>wa<span class="_ _4"></span>ys let-</div><div class="t m0 x2e h14 y875 ff8 fs3 fc0 sc0 ls0 ws4fd">ting fast-r<span class="_ _8"></span>unning threads through ﬁrst could starve out longer r<span class="_ _8"></span>un-</div><div class="t m0 x2e h14 y876 ff8 fs3 fc0 sc0 ls0 ws0">ning threads if there is no end to the fast-r<span class="_ _8"></span>unning threads.</div><div class="t m0 x47 h14 ye85 ff8 fs3 fc0 sc0 ls0 ws44">Deadlock<span class="_ _37"> </span>T<span class="_ _2"></span>wo or more threads w<span class="_ _4"></span>aiting for each other to ﬁnish. Each thread</div><div class="t m0 x2e h14 y1f0 ff8 fs3 fc0 sc0 ls0 ws4e9">has a resource that the other thread requires and neither can ﬁnish</div><div class="t m0 x2e h14 y1f1 ff8 fs3 fc0 sc0 ls0 ws0">until it gets the other resource.</div><div class="t m0 x47 h14 y70e ff8 fs3 fc0 sc0 ls0 ws0">Li<span class="_ _4"></span>velock<span class="_ _38"> </span><span class="ls65 ws65a">Threads in lockstep, each trying to do work but ﬁnding another</span></div><div class="t m0 x2e h14 y70f ff8 fs3 fc0 sc0 ls65 ws25f">“in the w<span class="_ _4"></span>ay<span class="_ _0"></span>.<span class="_ _1"></span>” Due to resonance, threads continue trying to</div><div class="t m0 x2e h14 y710 ff8 fs3 fc0 sc0 ls65 ws35">make pro<span class="_ _4"></span>g<span class="_ _8"></span>ress but are unable to for an e<span class="_ _4"></span>xcessiv<span class="_ _4"></span>ely long time—</div><div class="t m0 x2e h14 y711 ff8 fs3 fc0 sc0 ls65 ws0">or forev<span class="_ _4"></span>er<span class="_ _1"></span>.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:379.946010px;width:176.506000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd7" class="pf w1 h2" data-page-no="d7"><div class="pc pcd7 w1 h2"><img class="bi x37 ye86 w8 h27" alt="" src="bgd7.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">184<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 xd h11 ye87 ff1 fs7 fc0 sc0 ls0 ws0">Pr<span class="_ _4"></span>oducer<span class="_ _1"></span>-Consumer</div><div class="t m0 x7d h92 ye88 ff1 fs16 fc0 sc0 ls0 ws0">9</div><div class="t m0 xd h14 ye89 ff8 fs3 fc0 sc0 lsd ws65b">One or more producer threads create some w<span class="_ _4"></span>ork and place it in a buffer or queue. One or</div><div class="t m0 xd h14 ye8a ff8 fs3 fc0 sc0 ls0 ws65c">more consumer threads acquire that w<span class="_ _4"></span>ork from the queue and complete it. <span class="_ _4"></span>The queue</div><div class="t m0 xd h14 ye8b ff8 fs3 fc0 sc0 ls0 ws54">betw<span class="_ _4"></span>een the producers and consumers is a <span class="ffa">bound r<span class="_ _4"></span>esource<span class="_ _4"></span><span class="ff8">. <span class="_ _4"></span>This means producers must</span></span></div><div class="t m0 xd h14 ye8c ff8 fs3 fc0 sc0 ls0 ws65d">w<span class="_ _4"></span>ait for free space in the queue before writing and consumers must wait until there is</div><div class="t m0 xd h14 ye8d ff8 fs3 fc0 sc0 ls0 ws65e">something in the queue to consume. Coordination betw<span class="_ _4"></span>een the producers and consumers</div><div class="t m0 xd h14 ye8e ff8 fs3 fc0 sc0 ls0 ws3e4">via the queue in<span class="_ _4"></span>volv<span class="_ _4"></span>es producers and consumers signaling each other<span class="_ _4"></span>. <span class="_ _4"></span>The producers write</div><div class="t m0 xd h14 ye8f ff8 fs3 fc0 sc0 ls0 ws63a">to the queue and signal that the queue is no longer empty<span class="_ _0"></span>. Consumers read from the queue</div><div class="t m0 xd h14 ye90 ff8 fs3 fc0 sc0 ls0 ws36c">and signal that the queue is no longer full. Both potentially w<span class="_ _1"></span>ait to be notiﬁed when they</div><div class="t m0 xd h14 ye91 ff8 fs3 fc0 sc0 ls0 ws0">can continue.</div><div class="t m0 xd h11 ye92 ff1 fs7 fc0 sc0 ls0 ws0">Readers-Writers</div><div class="t m0 x5 h92 ye93 ff1 fs16 fc0 sc0 ls0 ws0">10</div><div class="t m0 xd h14 ye94 ff8 fs3 fc0 sc0 ls0 ws65f">When you ha<span class="_ _1"></span>ve a shared resource that primarily serves as a source of information for read-</div><div class="t m0 xd h14 ye95 ff8 fs3 fc0 sc0 lsd ws38d">ers, but which is occasionall<span class="_ _4"></span>y updated b<span class="_ _4"></span>y writers, throughput is an issue. Emphasizing</div><div class="t m0 xd h14 ye96 ff8 fs3 fc0 sc0 ls0 ws660">throughput can cause starvation and the accumulation of stale information. <span class="_ _4"></span>Allo<span class="_ _4"></span>wing</div><div class="t m0 xd h14 ye97 ff8 fs3 fc0 sc0 ls0 ws661">updates can impact throughput. Coordinating readers so they do not read something a</div><div class="t m0 xd h14 ye98 ff8 fs3 fc0 sc0 ls0 ws2b3">writer is updating and vice versa is a tough balancing act. <span class="_ _4"></span>Writers tend to block man<span class="_ _4"></span>y read-</div><div class="t m0 xd h14 ye99 ff8 fs3 fc0 sc0 ls0 ws0">ers for a long period of time, thus causing throughput issues. </div><div class="t m0 x74 h14 ye9a ff8 fs3 fc0 sc0 ls0 ws29">The challenge is to balance the needs of both readers and writers to satisfy cor<span class="_ _8"></span>rect</div><div class="t m0 xd h14 ye9b ff8 fs3 fc0 sc0 ls0 ws662">operation, pro<span class="_ _4"></span>vide reasonable throughput and a<span class="_ _1"></span>voiding starvation. <span class="_ _1"></span>A simple strategy</div><div class="t m0 xd h14 ye9c ff8 fs3 fc0 sc0 ls0 ws663">makes writers w<span class="_ _4"></span>ait until there are no readers before allo<span class="_ _4"></span>wing the writer to perfor<span class="_ _8"></span>m an</div><div class="t m0 xd h14 ye9d ff8 fs3 fc0 sc0 ls0 wsfd">update. If there are continuous readers, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the writers will be starved. On the other</div><div class="t m0 xd h14 ye9e ff8 fs3 fc0 sc0 ls0 ws226">hand<span class="_ _1"></span>, if there are frequent writers and they are gi<span class="_ _4"></span>ven priority<span class="_ _0"></span>, throughput will suffer<span class="_ _1"></span>. Find-</div><div class="t m0 xd h14 ye9f ff8 fs3 fc0 sc0 ls0 ws0">ing that balance and a<span class="_ _4"></span>voiding concurrent update issues is what the problem addresses.</div><div class="t m0 xd h11 yea0 ff1 fs7 fc0 sc0 ls0 ws0">Dining Philosophers</div><div class="t m0 x7d h92 yea1 ff1 fs16 fc0 sc0 ls0 ws0">11</div><div class="t m0 xd h14 yea2 ff8 fs3 fc0 sc0 ls12 ws2f9">Imagine a number of philosophers sitting around a circular table. <span class="_ _1"></span>A fork is placed to the</div><div class="t m0 xd h14 yea3 ff8 fs3 fc0 sc0 ls12 ws664">left of each philosopher<span class="_ _1"></span>. <span class="_ _4"></span>There is a big bo<span class="_ _4"></span>wl of spaghetti in the center of the table. <span class="_ _1"></span>The</div><div class="t m0 xd h14 yea4 ff8 fs3 fc0 sc0 ls12 ws2ab">philosophers spend their time thinking unless they get hungry<span class="_ _1"></span>. Once hung<span class="_ _8"></span>r<span class="_ _8"></span>y<span class="_ _0"></span>, they pick</div><div class="t m0 xd h14 yea5 ff8 fs3 fc0 sc0 ls12 ws3e">up the forks on either side of them and eat. <span class="_ _1"></span>A philosopher cannot eat unless he is holding</div><div class="t m0 xd h14 yea6 ff8 fs3 fc0 sc0 ls12 ws588">tw<span class="_ _4"></span>o forks. If the philosopher to his right or left is already using one of the forks he</div><div class="t m0 xd h14 yea7 ff8 fs3 fc0 sc0 ls12 ws216">needs, he must w<span class="_ _4"></span>ait until that philosopher ﬁnishes eating and puts the forks back down.</div><div class="t m0 xd h14 yea8 ff8 fs3 fc0 sc0 ls12 ws665">Once a philosopher eats, he puts both his forks back do<span class="_ _4"></span>wn on the table and w<span class="_ _4"></span>aits until he</div><div class="t m0 xd h14 yea9 ff8 fs3 fc0 sc0 ls40 ws448">is hungr<span class="_ _8"></span>y again.</div><div class="t m0 x74 h14 yeaa ff8 fs3 fc0 sc0 ls0 ws298">Replace philosophers with threads and forks with resources and this problem is simi-</div><div class="t m0 xd h14 yeab ff8 fs3 fc0 sc0 ls0 ws666">lar to man<span class="_ _4"></span>y enter<span class="_ _8"></span>prise applications in which processes compete for resources. Unless care-</div><div class="t m0 xd h14 yeac ff8 fs3 fc0 sc0 ls0 ws667">fully designed<span class="_ _0"></span>, systems that compete in this wa<span class="_ _4"></span>y can experience deadlock, li<span class="_ _4"></span>velock,</div><div class="t m0 xd h14 yead ff8 fs3 fc0 sc0 ls0 ws0">throughput, and ef<span class="_ _4"></span>ﬁciency degradation. </div><div class="t m0 x11 h25 yeae ff8 fse fc0 sc0 ls0 ws0">9.<span class="_ _18"> </span>http://en.wikipedia.org/wiki/Producer-consumer</div><div class="t m0 xd h25 yeaf ff8 fse fc0 sc0 ls0 ws0">10.<span class="_ _18"> </span>http://en.wikipedia.org/wiki/Readers-writers_problem</div><div class="t m0 xd h25 yeb0 ff8 fse fc0 sc0 ls0 ws0">11.<span class="_ _18"> </span>http://en.wikipedia.org/wiki/Dining_philosophers_problem</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:438.328010px;width:92.256000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:581.528010px;width:107.323000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:256.128010px;width:110.086000px;height:13.369000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Producer-consumer"><div class="d m1" style="border-style:none;position:absolute;left:90.831200px;bottom:62.416110px;width:134.667800px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Readers-writers_problem"><div class="d m1" style="border-style:none;position:absolute;left:90.835400px;bottom:54.415810px;width:150.997600px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Dining_philosophers_problem"><div class="d m1" style="border-style:none;position:absolute;left:90.835400px;bottom:46.414810px;width:165.404600px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd8" class="pf w1 h2" data-page-no="d8"><div class="pc pcd8 w1 h2"><img class="bi x37 yeb1 w8 h27" alt="" src="bgd8.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">185<span class="_ _10"></span><span class="ff1">Keep Synchr<span class="_ _1"></span>onized Sections Small</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls12 ws305">Most concur<span class="_ _8"></span>rent problems y<span class="_ _4"></span>ou will likel<span class="_ _4"></span>y encounter will be some variation of these</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls12 ws668">three problems. Study these algorithms and write solutions using them on y<span class="_ _4"></span>our o<span class="_ _4"></span>wn so</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls12 ws10c">that when y<span class="_ _4"></span>ou come across concur<span class="_ _8"></span>rent problems, y<span class="_ _4"></span>ou’<span class="_ _4"></span>ll be more prepared to solve the</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls12 ws0">problem.</div><div class="t m0 x74 h14 y1bd ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">Learn these basic alg<span class="_ _4"></span>orithms and understand their solutions.</span></span></div><div class="t m0 xd h17 yeb2 ff1 fs9 fc0 sc0 ls0 ws0">Be<span class="_ _4"></span>w<span class="_ _4"></span>are Dependencies Betw<span class="_ _1"></span>een Synchr<span class="_ _4"></span>onized Methods</div><div class="t m0 xd h14 ye74 ff8 fs3 fc0 sc0 lsd ws363">Dependencies betw<span class="_ _4"></span>een synchronized methods cause subtle bugs in concur<span class="_ _8"></span>rent code. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y385 ff8 fs3 fc0 sc0 ls0 ws476">Ja<span class="_ _4"></span>va language has the notion of </div><div class="t m5 x1c h2f y385 ffb fs10 fc0 sc0 ls0 ws0">synchronized</div><div class="t m0 x78 h14 y385 ff8 fs3 fc0 sc0 ls0 ws476">, which protects an indi<span class="_ _4"></span>vidual method. Ho<span class="_ _4"></span>w-</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 wsa4">ev<span class="_ _4"></span>er<span class="_ _4"></span>, if there is more than one synchronized method on the same shared class, then your</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">system ma<span class="_ _4"></span>y be written incor<span class="_ _8"></span>rectly<span class="_ _0"></span>.</div><div class="t m0 xc h21 y5ba ff8 fsc fc0 sc0 ls0 ws0">12</div><div class="t m0 x74 h14 yeb3 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _b"> </span><span class="ffa">A<span class="_ _1"></span>void using mor<span class="_ _4"></span>e than one method on a shared object.</span></span></div><div class="t m0 x74 h14 y499 ff8 fs3 fc0 sc0 ls0 wsd1">There will be times when y<span class="_ _4"></span>ou must use more than one method on a shared object.</div><div class="t m0 xd h14 yeb4 ff8 fs3 fc0 sc0 ls0 ws0">When this is the case, there are three w<span class="_ _4"></span>ays to mak<span class="_ _4"></span>e the code cor<span class="_ _8"></span>rect:</div><div class="t m0 x2c h14 y7a1 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ff1">Client-Based Locking</span>—Ha<span class="_ _4"></span>ve the client lock the server before calling the ﬁrst </div><div class="t m0 x74 h14 y485 ff8 fs3 fc0 sc0 ls0 ws0">method and make sure the lock’<span class="_ _2"></span>s extent includes code calling the last method.</div><div class="t m0 x2c h14 yafc ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ff1 ws669">Serv<span class="_ _4"></span>er<span class="_ _1"></span>-Based Locking<span class="ff8">—W<span class="_ _4"></span>ithin the ser<span class="_ _8"></span>ver create a method that locks the server<span class="_ _4"></span>, calls </span></span></div><div class="t m0 x74 h14 yeb5 ff8 fs3 fc0 sc0 ls0 ws0">all the methods, and then unlocks. Ha<span class="_ _4"></span>ve the client call the ne<span class="_ _4"></span>w method.</div><div class="t m0 x2c h14 yeb6 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span><span class="ff1">Adapted Serv<span class="_ _4"></span>er<span class="ff8">—create an intermediar<span class="_ _8"></span>y that perfor<span class="_ _8"></span>ms the locking. <span class="_ _4"></span>This is an exam-</span></span></div><div class="t m0 x74 h14 yeb7 ff8 fs3 fc0 sc0 ls0 ws0">ple of server-based locking, w<span class="_ _4"></span>here the original ser<span class="_ _8"></span>ver cannot be changed.</div><div class="t m0 xd h17 yeb8 ff1 fs9 fc0 sc0 ls0 ws0">K<span class="_ _4"></span>eep Synchr<span class="_ _4"></span>onized Sections Small</div><div class="t m0 xd h14 y58b ff8 fs3 fc0 sc0 ls6c ws0">The</div><div class="t m5 x8e h2f y58b ffb fs10 fc0 sc0 ls6d ws0">synchronized</div><div class="t m0 xba h14 y58b ff8 fs3 fc0 sc0 ls6c ws66a">ke<span class="_ _4"></span>yword introduces a lock. <span class="_ _1"></span>All sections of code guarded b<span class="_ _4"></span>y the</div><div class="t m0 xd h14 ydde ff8 fs3 fc0 sc0 ls6c ws657">same lock are guaranteed to ha<span class="_ _4"></span>ve onl<span class="_ _4"></span>y one thread ex<span class="_ _4"></span>ecuting through them at any gi<span class="_ _4"></span>ven</div><div class="t m0 xd h14 yddf ff8 fs3 fc0 sc0 ls6c wsb9">time. Locks are expensi<span class="_ _4"></span>ve because the<span class="_ _4"></span>y create delays and add o<span class="_ _1"></span>verhead. So w<span class="_ _4"></span>e don’<span class="_ _4"></span>t</div><div class="t m0 xd h14 yeb9 ff8 fs3 fc0 sc0 ls6c ws46d">w<span class="_ _4"></span>ant to litter our code with </div><div class="t m5 x1 h2f ydfa ffb fs10 fc0 sc0 ls6d ws0">synchronized</div><div class="t m0 xbe h14 ydfa ff8 fs3 fc0 sc0 ls6c ws46d">statements. On the other hand<span class="_ _1"></span>, critical sec-</div><div class="t m0 xd h14 ydfb ff8 fs3 fc0 sc0 ls6c ws0">tions</div><div class="t m0 x8e h21 y314 ff8 fsc fc0 sc0 ls6e ws0">13</div><div class="t m0 x1a h14 ydfb ff8 fs3 fc0 sc0 ls6c ws66b">must be guarded. So w<span class="_ _4"></span>e want to design our code with as fe<span class="_ _4"></span>w critical sections as</div><div class="t m0 xd h14 yb77 ff8 fs3 fc0 sc0 ls6c ws0">possible.</div><div class="t m0 x74 h14 y959 ff8 fs3 fc0 sc0 ls0 ws3de">Some naiv<span class="_ _4"></span>e programmers try to achieve this b<span class="_ _4"></span>y making their critical sections very</div><div class="t m0 xd h14 y95a ff8 fs3 fc0 sc0 ls0 ws51c">large. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, extending synchronization bey<span class="_ _4"></span>ond the minimal critical section increases</div><div class="t m0 xd h14 y95b ff8 fs3 fc0 sc0 ls0 ws0">contention and degrades performance.</div><div class="t m0 x32 h21 y3ae ff8 fsc fc0 sc0 ls0 ws0">14</div><div class="t m0 x74 h14 y43e ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">K<span class="_ _4"></span>eep your synchr<span class="_ _1"></span>onized sections as small as possible.</span></span></div><div class="t m0 xd h25 yeba ff8 fse fc0 sc0 ls0 ws0">12.<span class="_ _18"> </span>See “Dependencies Between Methods Can Break Concurrent Code” on page 329.</div><div class="t m0 xd h25 yebb ff8 fse fc0 sc0 ls0 ws0">13.<span class="_ _18"> </span>A critical section is any section of code that must be protected from simultaneous use for the pro<span class="_ _4"></span>g<span class="_ _8"></span>ram to be correct.</div><div class="t m0 xd h25 yebc ff8 fse fc0 sc0 ls0 ws0">14.<span class="_ _18"> </span>See “Increasing <span class="_ _4"></span>Throughput” on page 333.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.826000px;bottom:499.945010px;width:323.195000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:276.945010px;width:205.746000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfd9" class="pf w1 h2" data-page-no="d9"><div class="pc pcd9 w1 h2"><img class="bi x37 yd48 w8 h27" alt="" src="bgd9.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">186<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Writing Corr<span class="_ _4"></span>ect Shut-Do<span class="_ _1"></span>wn Code Is Hard</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws3c5">Writing a system that is meant to sta<span class="_ _4"></span>y liv<span class="_ _4"></span>e and r<span class="_ _8"></span>un forev<span class="_ _4"></span>er is different from writing some-</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws0">thing that w<span class="_ _4"></span>orks for a<span class="_ _4"></span>while and then shuts do<span class="_ _1"></span>wn g<span class="_ _8"></span>racefully<span class="_ _0"></span>.</div><div class="t m0 x74 h14 yebd ff8 fs3 fc0 sc0 ls0 ws3fe">Graceful shutdo<span class="_ _4"></span>wn can be hard to get cor<span class="_ _8"></span>rect. Common problems in<span class="_ _1"></span>volve deadlock,</div><div class="t m0 x50 h21 yebe ff8 fsc fc0 sc0 ls0 ws0">15</div><div class="t m0 xd h14 y460 ff8 fs3 fc0 sc0 ls0 ws0">with threads w<span class="_ _4"></span>aiting for a signal to continue that never comes. </div><div class="t m0 x74 h14 y299 ff8 fs3 fc0 sc0 ls0 ws127">F<span class="_ _1"></span>or example, imagine a system with a parent thread that spa<span class="_ _4"></span>wns sev<span class="_ _4"></span>eral child threads</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 ls0 ws94">and then w<span class="_ _4"></span>aits for them all to ﬁnish before it releases its resources and shuts down. <span class="_ _1"></span>What if</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws66c">one of the spa<span class="_ _4"></span>wned threads is deadlocked? <span class="_ _1"></span>The parent will wait fore<span class="_ _4"></span>ver<span class="_ _4"></span>, and the system</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws0">will nev<span class="_ _4"></span>er shut do<span class="_ _4"></span>wn. </div><div class="t m0 x74 h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws53b">Or consider a similar system that has been <span class="ffa ws0">instructed </span>to shut do<span class="_ _1"></span>wn. <span class="_ _4"></span>The parent tells all</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws45d">the spa<span class="_ _4"></span>wned children to abandon their tasks and ﬁnish. But what if tw<span class="_ _1"></span>o of the children</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws66d">w<span class="_ _4"></span>ere operating as a producer/consumer pair<span class="_ _4"></span>. Suppose the producer recei<span class="_ _4"></span>ves the signal</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws3af">from the parent and quickl<span class="_ _4"></span>y shuts down. <span class="_ _1"></span>The consumer might ha<span class="_ _4"></span>ve been expecting a mes-</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls0 ws30">sage from the producer and be block<span class="_ _4"></span>ed in a state where it cannot recei<span class="_ _4"></span>ve the shutdo<span class="_ _4"></span>wn sig-</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws343">nal. It could get stuck w<span class="_ _4"></span>aiting for the producer and never ﬁnish, pre<span class="_ _4"></span>venting the parent from</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">ﬁnishing as w<span class="_ _4"></span>ell.</div><div class="t m0 x74 h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws4d1">Situations like this are not at all uncommon. So if y<span class="_ _4"></span>ou must write concur<span class="_ _8"></span>rent code that</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 ls0 ws66e">in<span class="_ _4"></span>volv<span class="_ _4"></span>es shutting do<span class="_ _4"></span>wn g<span class="_ _8"></span>racefully<span class="_ _0"></span>, expect to spend much of y<span class="_ _4"></span>our time getting the shut-</div><div class="t m0 xd h14 y25b ff8 fs3 fc0 sc0 ls0 ws0">do<span class="_ _4"></span>wn to happen cor<span class="_ _8"></span>rectly<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y2c ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _c"> </span><span class="ffa ws11b">Think about shut-down ear<span class="_ _1"></span>ly and get it wor<span class="_ _4"></span>king ear<span class="_ _4"></span>ly<span class="_ _1"></span>. It’<span class="_ _0"></span>s g<span class="_ _4"></span>oing to</span></span></div><div class="t m0 xd h1d y2d ffa fs3 fc0 sc0 ls0 ws522">take longer than you expect. Re<span class="_ _4"></span>view existing algorithms because this is pr<span class="_ _1"></span>obab<span class="_ _4"></span>ly har<span class="_ _4"></span>der</div><div class="t m0 xd h1d y4e3 ffa fs3 fc0 sc0 ls0 ws0">than you think.</div><div class="t m0 xd h17 yebf ff1 fs9 fc0 sc0 ls0 ws4db">T<span class="_ _2"></span>esting Thr<span class="_ _4"></span>eaded <span class="_ _6"></span>Code</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws2f3">Pro<span class="_ _4"></span>ving that code is cor<span class="_ _8"></span>rect is impractical. <span class="_ _4"></span>T<span class="_ _0"></span>esting does not guarantee cor<span class="_ _8"></span>rectness. Ho<span class="_ _4"></span>w-</div><div class="t m0 xd h14 y5cc ff8 fs3 fc0 sc0 ls0 ws35">e<span class="_ _4"></span>ver<span class="_ _4"></span>, good testing can minimize risk. <span class="_ _4"></span>This is all true in a single-threaded solution. <span class="_ _4"></span>As soon</div><div class="t m0 xd h14 y5cd ff8 fs3 fc0 sc0 ls0 ws6c">as there are tw<span class="_ _4"></span>o or more threads using the same code and w<span class="_ _4"></span>orking with shared data, things</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">get substantiall<span class="_ _4"></span>y more complex.</div><div class="t m0 x74 h14 y674 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _a"> </span><span class="ffa ws66f">Write tests that have the potential to expose prob<span class="_ _4"></span>lems and then</span></span></div><div class="t m0 xd h1d y675 ffa fs3 fc0 sc0 ls0 ws670">run them fr<span class="_ _4"></span>equently<span class="_ _1"></span>, with differ<span class="_ _1"></span>ent pro<span class="_ _4"></span>gr<span class="_ _4"></span>amatic conﬁgur<span class="_ _1"></span>ations and system conﬁgurations</div><div class="t m0 xd h1d y491 ffa fs3 fc0 sc0 ls0 ws2b5">and load. If tests ever fail, tr<span class="_ _1"></span>ack do<span class="_ _4"></span>wn the failure<span class="_ _4"></span>. Don’<span class="_ _1"></span>t ignor<span class="_ _4"></span>e a failur<span class="_ _4"></span>e just because the</div><div class="t m0 xd h1d y492 ffa fs3 fc0 sc0 ls0 ws0">tests pass on a subsequent run.</div><div class="t m0 x74 h14 y678 ff8 fs3 fc0 sc0 ls0 ws671">That is a whole lot to tak<span class="_ _4"></span>e into consideration. Here are a few more ﬁne-grained</div><div class="t m0 xd h14 y679 ff8 fs3 fc0 sc0 ls0 ws0">recommendations:</div><div class="t m0 x2c h14 yec0 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>T<span class="_ _4"></span>reat spurious failures as candidate threading issues.</div><div class="t m0 x2c h14 yec1 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Get your nonthreaded code w<span class="_ _1"></span>orking ﬁrst.</div><div class="t m0 xd h25 yec2 ff8 fse fc0 sc0 ls0 ws0">15.<span class="_ _18"> </span>See “Deadlock” on page 335.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:251.822000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:269.945010px;width:138.243000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfda" class="pf w1 h2" data-page-no="da"><div class="pc pcda w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">187<span class="_ _10"></span><span class="ff1 wse1">T<span class="_ _0"></span>esting Threaded <span class="_ _8"></span>Code</span></div><div class="t m0 x2c h14 y194 ff8 fs3 fc0 sc0 ls22 ws429">•<span class="_ _27"> </span>Make y<span class="_ _4"></span>our threaded code pluggable.</div><div class="t m0 x2c h14 y4b8 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Make y<span class="_ _4"></span>our threaded code tunable.</div><div class="t m0 x2c h14 yec3 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Run with more threads than processors.</div><div class="t m0 x2c h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Run on dif<span class="_ _4"></span>ferent platfor<span class="_ _8"></span>ms.</div><div class="t m0 x2c h14 ya69 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Instrument your code to try and force f<span class="_ _8"></span>ailures.</div><div class="t m0 xd h11 yec4 ff1 fs7 fc0 sc0 ls0 ws0">T<span class="_ _0"></span>reat Spurious F<span class="_ _0"></span>ailur<span class="_ _4"></span>es as Candidate <span class="_ _1"></span>Threading Issues</div><div class="t m0 xd h14 y278 ff8 fs3 fc0 sc0 ls0 ws5d8">Threaded code causes things to fail that “simply cannot fail.<span class="_ _1"></span>” Most de<span class="_ _4"></span>velopers do not ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws59c">an intuitiv<span class="_ _4"></span>e feel for ho<span class="_ _4"></span>w threading interacts with other code (authors included). Bugs in</div><div class="t m0 xd h14 y386 ff8 fs3 fc0 sc0 ls0 ws229">threaded code might exhibit their symptoms once in a thousand<span class="_ _1"></span>, or a million, ex<span class="_ _4"></span>ecutions.</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws5a9">Attempts to repeat the systems can be frustratingly<span class="_ _0"></span>. <span class="_ _4"></span>This often leads dev<span class="_ _4"></span>elopers to write off</div><div class="t m0 xd h14 ydf3 ff8 fs3 fc0 sc0 ls0 ws440">the failure as a cosmic ra<span class="_ _4"></span>y<span class="_ _1"></span>, a hardware glitch, or some other kind of “one-of<span class="_ _4"></span>f.<span class="_ _1"></span>” It is best to</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 ls0 ws672">assume that one-of<span class="_ _4"></span>fs do not exist. <span class="_ _4"></span>The longer these “one-of<span class="_ _4"></span>fs” are ignored<span class="_ _4"></span>, the more code</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 lsd wsef">is built on top of a potentiall<span class="_ _4"></span>y f<span class="_ _8"></span>aulty approach.</div><div class="t m0 x74 h14 y27f ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">Do not ignor<span class="_ _4"></span>e system failur<span class="_ _4"></span>es as one-offs.</span></span></div><div class="t m0 xd h11 yec5 ff1 fs7 fc0 sc0 ls0 ws0">Get <span class="_ _2"></span>Y<span class="_ _2"></span>our Nonthr<span class="_ _4"></span>eaded Code <span class="_ _0"></span>W<span class="_ _0"></span>orking Fir<span class="_ _4"></span>st</div><div class="t m0 xd h14 y3f4 ff8 fs3 fc0 sc0 lsd ws5ae">This ma<span class="_ _4"></span>y seem obvious, but it doesn’<span class="_ _1"></span>t hurt to reinforce it. Make sure code w<span class="_ _4"></span>orks outside</div><div class="t m0 xd h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws2c1">of its use in threads. Generall<span class="_ _4"></span>y<span class="_ _1"></span>, this means creating POJOs that are called by y<span class="_ _4"></span>our threads.</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws10d">The POJOs are not thread a<span class="_ _4"></span>ware, and can therefore be tested outside of the threaded en<span class="_ _1"></span>vi-</div><div class="t m0 xd h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws0">ronment. <span class="_ _1"></span>The more of your system you can place in such POJOs, the better<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y42a ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _a"> </span><span class="ffa ls22 ws673">Do not try to chase down nonthr<span class="_ _1"></span>eading bugs and threading bugs</span></span></div><div class="t m0 xd h14 y42b ffa fs3 fc0 sc0 ls0 ws0">at the same time. Make sur<span class="_ _1"></span>e your code works outside of thr<span class="_ _1"></span>eads<span class="ff8">.</span></div><div class="t m0 xd h11 yec6 ff1 fs7 fc0 sc0 ls0 ws0">Make <span class="_ _2"></span>Y<span class="_ _3"></span>our <span class="_ _1"></span>Threaded Code Plugg<span class="_ _4"></span>ab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y671 ff8 fs3 fc0 sc0 ls0 ws0">Write the concur<span class="_ _8"></span>rency-supporting code such that it can be r<span class="_ _8"></span>un in sev<span class="_ _4"></span>eral conﬁgurations:</div><div class="t m0 x2c h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>One thread<span class="_ _1"></span>, sev<span class="_ _4"></span>eral threads, varied as it ex<span class="_ _1"></span>ecutes</div><div class="t m0 x2c h14 y42d ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Threaded code interacts with something that can be both real or a test double.</div><div class="t m0 x2c h14 yec7 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Ex<span class="_ _4"></span>ecute with test doubles that run quickly<span class="_ _0"></span>, slo<span class="_ _4"></span>wly<span class="_ _0"></span>, variab<span class="_ _4"></span>le.</div><div class="t m0 x2c h14 y5ec ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Conﬁgure tests so they can run for a number of iterations.</div><div class="t m0 x74 h14 ye01 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">:<span class="_ _15"> </span><span class="ffa ws674">Make your thr<span class="_ _4"></span>ead-based code especially plugga<span class="_ _4"></span>ble so that you</span></span></div><div class="t m0 xd h1d yec8 ffa fs3 fc0 sc0 ls0 ws0">can run it in various conﬁgur<span class="_ _4"></span>ations.</div><div class="t m0 xd h11 yec9 ff1 fs7 fc0 sc0 ls0 ws18">Make <span class="_ _1"></span>Y<span class="_ _3"></span>our Threaded <span class="_ _5"></span>Code T<span class="_ _0"></span>unab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y5ce ff8 fs3 fc0 sc0 ls0 ws10d">Getting the right balance of threads typically requires trial an error<span class="_ _1"></span>. Early on, ﬁnd w<span class="_ _4"></span>ays to</div><div class="t m0 xd h14 y85f ff8 fs3 fc0 sc0 ls0 ws5b">time the performance of your system under different conﬁgurations. <span class="_ _0"></span>Allow the number of</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:494.728010px;width:279.973000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:361.728010px;width:219.422000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:252.728010px;width:190.736000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:104.728010px;width:181.103000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfdb" class="pf w1 h2" data-page-no="db"><div class="pc pcdb w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bgdb.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">188<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws5d9">threads to be easil<span class="_ _4"></span>y tuned. Consider allowing it to change w<span class="_ _4"></span>hile the system is running.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">Consider allo<span class="_ _4"></span>wing self-tuning based on throughput and system utilization.</div><div class="t m0 xd h11 y56c ff1 fs7 fc0 sc0 ls0 ws0">Run with Mor<span class="_ _4"></span>e <span class="_ _1"></span>Thr<span class="_ _4"></span>eads <span class="_ _1"></span>Than Processor<span class="_ _4"></span>s</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws557">Things happen when the system s<span class="_ _4"></span>witches betw<span class="_ _4"></span>een tasks. <span class="_ _4"></span>T<span class="_ _1"></span>o encourage task sw<span class="_ _4"></span>apping, run</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws50f">with more threads than processors or cores. <span class="_ _1"></span>The more frequently your tasks s<span class="_ _4"></span>wap, the more</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">likel<span class="_ _4"></span>y you’<span class="_ _1"></span>ll encounter code that is missing a critical section or causes deadlock.</div><div class="t m0 xd h11 yeca ff1 fs7 fc0 sc0 ls0 ws0">Run on Differ<span class="_ _4"></span>ent Platforms</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws3bb">In the middle of 2007 w<span class="_ _4"></span>e dev<span class="_ _4"></span>eloped a course on concur<span class="_ _8"></span>rent programming. <span class="_ _4"></span>The course</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws128">de<span class="_ _4"></span>velopment ensued primarily under OS X. <span class="_ _1"></span>The class was presented using <span class="_ _1"></span>Windo<span class="_ _1"></span>ws XP</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws63f">running under a <span class="_ _4"></span>VM. <span class="_ _4"></span>T<span class="_ _0"></span>ests written to demonstrate failure conditions did not f<span class="_ _8"></span>ail as fre-</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">quently in an XP en<span class="_ _1"></span>vironment as they did running on OS X. </div><div class="t m0 x74 h14 y256 ff8 fs3 fc0 sc0 ls0 wsf8">In all cases the code under test w<span class="_ _4"></span>as known to be incorrect. <span class="_ _4"></span>This just reinforced the fact</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws670">that different operating systems ha<span class="_ _1"></span>ve dif<span class="_ _4"></span>ferent threading policies, each of which impacts</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws4b">the code’<span class="_ _2"></span>s ex<span class="_ _4"></span>ecution. Multithreaded code beha<span class="_ _4"></span>ves dif<span class="_ _4"></span>ferently in dif<span class="_ _4"></span>ferent en<span class="_ _4"></span>vironments.</div><div class="t m0 x50 h21 y848 ff8 fsc fc0 sc0 ls0 ws0">16</div><div class="t m0 xd h14 y466 ff8 fs3 fc0 sc0 ls0 ws0">Y<span class="_ _3"></span>ou should r<span class="_ _8"></span>un your tests in e<span class="_ _4"></span>very potential deplo<span class="_ _4"></span>yment en<span class="_ _4"></span>vironment.</div><div class="t m0 x74 h14 y486 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">Run your thr<span class="_ _4"></span>eaded code on all targ<span class="_ _4"></span>et platforms ear<span class="_ _4"></span>ly and often.</span></span></div><div class="t m0 xd h11 yecb ff1 fs7 fc0 sc0 ls0 ws0">Instrument <span class="_ _2"></span>Y<span class="_ _2"></span>our Code to <span class="_ _0"></span>T<span class="_ _1"></span>ry and F<span class="_ _1"></span>orce F<span class="_ _0"></span>ailur<span class="_ _4"></span>es</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls0 ws675">It is normal for ﬂaws in concurrent code to hide. Simple tests often don’<span class="_ _4"></span>t expose them.</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws4cb">Indeed<span class="_ _1"></span>, they often hide during normal processing. <span class="_ _4"></span>They might sho<span class="_ _4"></span>w up once ev<span class="_ _4"></span>er<span class="_ _8"></span>y fe<span class="_ _4"></span>w</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">hours, or da<span class="_ _4"></span>ys, or w<span class="_ _4"></span>eeks! </div><div class="t m0 x74 h14 y57e ff8 fs3 fc0 sc0 lsd ws181">The reason that threading bugs can be infrequent, sporadic, and hard to repeat, is that</div><div class="t m0 xd h14 y57f ff8 fs3 fc0 sc0 ls0 ws3d8">only a v<span class="_ _4"></span>ery few pathw<span class="_ _4"></span>ays out of the man<span class="_ _4"></span>y thousands of possible pathw<span class="_ _4"></span>a<span class="_ _4"></span>ys through a vul-</div><div class="t m0 xd h14 y580 ff8 fs3 fc0 sc0 ls0 ws676">nerable section actuall<span class="_ _4"></span>y fail. So the probability that a failing pathwa<span class="_ _4"></span>y is taken can be star<span class="_ _4"></span>-</div><div class="t m0 xd h14 yecc ff8 fs3 fc0 sc0 lsd wsef">tlingly lo<span class="_ _1"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>This makes detection and debugging very difﬁcult.</div><div class="t m0 x74 h14 yeb9 ff8 fs3 fc0 sc0 ls0 ws34c">Ho<span class="_ _4"></span>w might you increase y<span class="_ _4"></span>our chances of catching such rare occur<span class="_ _8"></span>rences? <span class="_ _0"></span>Y<span class="_ _2"></span>ou can</div><div class="t m0 xd h14 yecd ff8 fs3 fc0 sc0 ls0 ws36e">instrument your code and force it to run in different orderings b<span class="_ _4"></span>y adding calls to methods</div><div class="t m0 xd h14 yece ff8 fs3 fc0 sc0 ls10 ws0">like </div><div class="t m5 x74 h2f yb77 ffb fs10 fc0 sc0 ls0 ws0">Object.wait()</div><div class="t m0 xe4 h14 yb77 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x4d h2f yb77 ffb fs10 fc0 sc0 ls0 ws0">Object.sleep()</div><div class="t m0 xc h14 yb77 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x5b h2f yb77 ffb fs10 fc0 sc0 ls0 ws0">Object.yield()</div><div class="t m0 x4f h14 yb77 ff8 fs3 fc0 sc0 ls10 ws0"> and </div><div class="t m5 x17 h2f yb77 ffb fs10 fc0 sc0 ls0 ws0">Object.priority()</div><div class="t m0 xa7 h14 yb77 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y959 ff8 fs3 fc0 sc0 ls0 ws255">Each of these methods can af<span class="_ _4"></span>fect the order of ex<span class="_ _4"></span>ecution, thereby increasing the odds</div><div class="t m0 xd h14 y95a ff8 fs3 fc0 sc0 ls0 ws0">of detecting a ﬂa<span class="_ _4"></span>w<span class="_ _0"></span>. It’<span class="_ _2"></span>s better when broken code fails as earl<span class="_ _4"></span>y and as often as possible.</div><div class="t m0 x74 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">There are tw<span class="_ _4"></span>o options for code instrumentation:</div><div class="t m0 x2c h14 yb78 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Hand-coded</div><div class="t m0 x2c h14 y5ed ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Automated</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">16.<span class="_ _18"> </span> Did you kno<span class="_ _4"></span>w that the threading model in Jav<span class="_ _4"></span>a does not guarantee preemptive threading? Modern OS’<span class="_ _0"></span>s support preemptive </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">threading, so you get that “for free.<span class="_ _1"></span>” Even so, it not guaranteed by the JVM.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:476.728010px;width:140.319000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:546.728010px;width:209.704000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:328.728010px;width:245.679000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfdc" class="pf w1 h2" data-page-no="dc"><div class="pc pcdc w1 h2"><img class="bi x37 y384 w8 h27" alt="" src="bgdc.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">189<span class="_ _10"></span><span class="ff1 wse1">T<span class="_ _0"></span>esting Threaded <span class="_ _8"></span>Code</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">Hand-Coded</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws5b7">Y<span class="_ _3"></span>ou can inser<span class="_ _8"></span>t calls to </div><div class="t m5 x2e h2f y2a4 ffb fs10 fc0 sc0 ls0 ws0">wait()</div><div class="t m0 x1 h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x84 h2f y2a4 ffb fs10 fc0 sc0 ls0 ws0">sleep()</div><div class="t m0 x5c h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xe0 h2f y2a4 ffb fs10 fc0 sc0 ls0 ws0">yield()</div><div class="t m0 xcf h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws5b7">, and </div><div class="t m5 x40 h2f y2a4 ffb fs10 fc0 sc0 ls0 ws0">priority()</div><div class="t m0 x49 h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws5b7">in your code b<span class="_ _4"></span>y hand. It</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">might be just the thing to do when y<span class="_ _4"></span>ou’<span class="_ _1"></span>re testing a particularly thorny piece of code. </div><div class="t m0 x74 h14 yebe ff8 fs3 fc0 sc0 ls0 ws0">Here is an example of doing just that:</div><div class="t m5 x74 h2f yecf ffb fs10 fc0 sc0 ls0 ws0">public synchronized String nextUrlOrNull() {</div><div class="t m5 x74 h2f yed0 ffb fs10 fc0 sc0 ls0 ws0">    if(hasNext()) {</div><div class="t m5 x74 h2f yed1 ffb fs10 fc0 sc0 ls0 ws0">        String url = urlGenerator.next();</div><div class="t m5 x74 h2f yed2 ffb fs10 fc0 sc0 ls0 ws0">        Thread.yield();<span class="_ _4"></span> // inserted for testing.</div><div class="t m5 x74 h2f yed3 ffb fs10 fc0 sc0 ls0 ws0">        updateHasNext();</div><div class="t m5 x74 h2f yed4 ffb fs10 fc0 sc0 ls0 ws0">        return url;</div><div class="t m5 x74 h2f yed5 ffb fs10 fc0 sc0 ls0 ws0">    } </div><div class="t m5 x74 h2f yed6 ffb fs10 fc0 sc0 ls0 ws0">    return null;</div><div class="t m5 x74 h2f yed7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y446 ff8 fs3 fc0 sc0 ls0 ws2a0">The inserted call to </div><div class="t m5 x6e h2f y446 ffb fs10 fc0 sc0 ls0 ws0">yield()</div><div class="t m0 x1c h14 y446 ff8 fs3 fc0 sc0 ls0 ws2a0">will change the ex<span class="_ _4"></span>ecution pathw<span class="_ _4"></span>ays tak<span class="_ _4"></span>en by the code and</div><div class="t m0 xd h14 ybaa ff8 fs3 fc0 sc0 ls0 ws3a">possibl<span class="_ _4"></span>y cause the code to fail where it did not fail before. If the code does break, it w<span class="_ _4"></span>as</div><div class="t m0 xd h14 ybab ff8 fs3 fc0 sc0 ls0 ws290">not because you added a call to </div><div class="t m5 xdf h2f y6fa ffb fs10 fc0 sc0 ls0 ws0">yield()</div><div class="t m0 xe0 h14 y6fa ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x4e h21 y564 ff8 fsc fc0 sc0 ls0 ws0">17</div><div class="t m0 xad h14 y6fa ff8 fs3 fc0 sc0 ls0 ws290">Rather<span class="_ _4"></span>, your code w<span class="_ _4"></span>as broken and this simpl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y6fb ff8 fs3 fc0 sc0 ls0 ws0">made the failure evident.</div><div class="t m0 x74 h14 y9d1 ff8 fs3 fc0 sc0 ls0 ws0">There are man<span class="_ _4"></span>y problems with this approach:</div><div class="t m0 x2c h14 y32e ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Y<span class="_ _3"></span>ou hav<span class="_ _4"></span>e to manually ﬁnd appropriate places to do this.</div><div class="t m0 x2c h14 yed8 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Ho<span class="_ _4"></span>w do you kno<span class="_ _1"></span>w where to put the call and what kind of call to use?</div><div class="t m0 x2c h14 y1c5 ff8 fs3 fc0 sc0 ls0 ws0">•<span class="_ _27"> </span>Lea<span class="_ _4"></span>ving such code in a production en<span class="_ _4"></span>vironment unnecessarily slo<span class="_ _1"></span>ws the code down.</div><div class="t m0 x2c h14 y331 ff8 fs3 fc0 sc0 ls10 wsf8">•<span class="_ _27"> </span>It’<span class="_ _2"></span>s a shotgun approach. <span class="_ _0"></span>Y<span class="_ _2"></span>ou ma<span class="_ _4"></span>y or may not ﬁnd ﬂa<span class="_ _1"></span>ws. Indeed<span class="_ _4"></span>, the odds aren’<span class="_ _1"></span>t with you.</div><div class="t m0 x74 h14 yc72 ff8 fs3 fc0 sc0 lsd ws3e3">What w<span class="_ _4"></span>e need is a wa<span class="_ _1"></span>y to do this during testing but not in production. W<span class="_ _0"></span>e also need to</div><div class="t m0 xd h14 y9d5 ff8 fs3 fc0 sc0 ls0 ws4c1">easil<span class="_ _4"></span>y mix up conﬁgurations between dif<span class="_ _4"></span>ferent runs, which results in increased chances of</div><div class="t m0 xd h14 y9d6 ff8 fs3 fc0 sc0 ls22 ws429">ﬁnding er<span class="_ _8"></span>rors in the aggregate.</div><div class="t m0 x74 h14 y35f ff8 fs3 fc0 sc0 ls0 ws471">Clearl<span class="_ _4"></span>y<span class="_ _1"></span>, if w<span class="_ _4"></span>e divide our system up into POJOs that kno<span class="_ _4"></span>w nothing of threading and</div><div class="t m0 xd h14 y360 ff8 fs3 fc0 sc0 ls0 ws677">classes that control the threading, it will be easier to ﬁnd appropriate places to instrument</div><div class="t m0 xd h14 y361 ff8 fs3 fc0 sc0 ls0 ws111">the code. Moreo<span class="_ _4"></span>ver<span class="_ _1"></span>, we could create man<span class="_ _4"></span>y different test jigs that in<span class="_ _1"></span>voke the POJOs under</div><div class="t m0 xd h14 yc73 ff8 fs3 fc0 sc0 ls0 ws0">different re<span class="_ _4"></span>gimes of calls to </div><div class="t m5 x57 h2f y2f9 ffb fs10 fc0 sc0 ls0 ws0">sleep</div><div class="t m0 x8 h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x76 h2f y2f9 ffb fs10 fc0 sc0 ls0 ws0">yield</div><div class="t m0 x83 h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws0">, and so on. </div><div class="t m0 xd h11 yed9 ff1 fs7 fc0 sc0 ls0 ws0">A<span class="_ _1"></span>utomated</div><div class="t m0 xd h14 y3e4 ff8 fs3 fc0 sc0 ls0 ws2ca">Y<span class="_ _3"></span>ou could use tools like an <span class="_ _1"></span>Aspect-Oriented Framew<span class="_ _1"></span>ork, CGLIB, or <span class="_ _1"></span>ASM to programmat-</div><div class="t m0 xd h14 yeda ff8 fs3 fc0 sc0 ls0 ws0">ically instrument your code. F<span class="_ _1"></span>or example, y<span class="_ _4"></span>ou could use a class with a single method:</div><div class="t m5 x74 h2f yedb ffb fs10 fc0 sc0 ls0 ws0">public class ThreadJigglePoint {</div><div class="t m5 x74 h2f yedc ffb fs10 fc0 sc0 ls0 ws0">    public static void jiggle() {</div><div class="t m5 x74 h2f yedd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yede ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">17.<span class="_ _18"> </span>This is not strictly the case. Since the JVM does not guarantee preempti<span class="_ _4"></span>ve threading, a particular algorithm might alwa<span class="_ _1"></span>ys </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls13 ws162">w<span class="_ _4"></span>ork on an OS that does not preempt threads. The re<span class="_ _4"></span>verse is also possible but for dif<span class="_ _4"></span>ferent reasons.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:66.012000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:188.728010px;width:56.726000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfdd" class="pf w1 h2" data-page-no="dd"><div class="pc pcdd w1 h2"><img class="bi x37 yedf w8 h27" alt="" src="bgdd.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">190<span class="_ _33"> </span><span class="ff1 wsa0">Chapter 13:<span class="_ _4"></span> Concurrency</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Y<span class="_ _3"></span>ou can add calls to this in various places within y<span class="_ _4"></span>our code:</div><div class="t m5 x74 h2f ya7a ffb fs10 fc0 sc0 ls0 ws0">public synchronized String nextUrlOrNull() {</div><div class="t m5 x74 h2f yee0 ffb fs10 fc0 sc0 ls0 ws0">    if(hasNext()) {</div><div class="t m5 x74 h2f yee1 ffb fs10 fc0 sc0 ls0 ws0">        ThreadJiglePoint.jiggle();</div><div class="t m5 x74 h2f yee2 ffb fs10 fc0 sc0 ls0 ws0">        String url = urlGenerator.next();</div><div class="t m5 x74 h2f yee3 ffb fs10 fc0 sc0 ls0 ws0">        ThreadJiglePoint.jiggle();</div><div class="t m5 x74 h2f yee4 ffb fs10 fc0 sc0 ls0 ws0">        updateHasNext();</div><div class="t m5 x74 h2f yee5 ffb fs10 fc0 sc0 ls0 ws0">        ThreadJiglePoint.jiggle();</div><div class="t m5 x74 h2f yee6 ffb fs10 fc0 sc0 ls0 ws0">        return url;</div><div class="t m5 x74 h2f yee7 ffb fs10 fc0 sc0 ls0 ws0">    } </div><div class="t m5 x74 h2f yee8 ffb fs10 fc0 sc0 ls0 ws0">    return null;</div><div class="t m5 x74 h2f yee9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y19e ff8 fs3 fc0 sc0 ls0 ws468">No<span class="_ _4"></span>w you use a simple aspect that randoml<span class="_ _4"></span>y selects among doing nothing, sleeping, or</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">yielding.</div><div class="t m0 x74 h14 y21b ff8 fs3 fc0 sc0 ls0 wsca">Or imagine that the </div><div class="t m5 x6e h2f y21b ffb fs10 fc0 sc0 ls0 ws0">ThreadJigglePoint</div><div class="t m0 xc4 h14 y21b ff8 fs3 fc0 sc0 ls0 wsca">class has tw<span class="_ _4"></span>o implementations. <span class="_ _4"></span>The ﬁrst imple-</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">ments</div><div class="t m5 x52 h2f y9f5 ffb fs10 fc0 sc0 ls0 ws0">jiggle</div><div class="t m0 x14 h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws210">to do nothing and is used in production. <span class="_ _1"></span>The second generates a random</div><div class="t m0 xd h14 y564 ff8 fs3 fc0 sc0 ls0 wsf5">number to choose betw<span class="_ _4"></span>een sleeping, yielding, or just falling through. If you run your tests</div><div class="t m0 xd h14 y9f6 ff8 fs3 fc0 sc0 ls0 wsa7">a thousand times with random jiggling, you ma<span class="_ _1"></span>y root out some ﬂaws. If the tests pass, at</div><div class="t m0 xd h14 y9f7 ff8 fs3 fc0 sc0 ls0 wsbb">least you can sa<span class="_ _1"></span>y you’<span class="_ _1"></span>ve done due diligence. <span class="_ _4"></span>Though a bit simplistic, this could be a rea-</div><div class="t m0 xd h14 yeea ff8 fs3 fc0 sc0 ls0 ws0">sonable option in lieu of a more sophisticated tool.</div><div class="t m0 x74 h14 y749 ff8 fs3 fc0 sc0 ls0 ws4a5">There is a tool called ConT<span class="_ _0"></span>est,</div><div class="t m0 x76 h21 y281 ff8 fsc fc0 sc0 ls0 ws0">18</div><div class="t m0 x77 h14 y749 ff8 fs3 fc0 sc0 lsc ws3e6"> dev<span class="_ _4"></span>eloped by IBM that does something similar<span class="_ _1"></span>, but it</div><div class="t m0 xd h14 y74a ff8 fs3 fc0 sc0 ls0 ws0">does so with quite a bit more sophistication.</div><div class="t m0 x74 h14 y579 ff8 fs3 fc0 sc0 ls0 wsc9">The point is to jiggle the code so that threads run in different orderings at dif<span class="_ _4"></span>ferent</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws389">times. <span class="_ _1"></span>The combination of well-written tests and jiggling can dramaticall<span class="_ _4"></span>y increase the</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls0 ws0">chance ﬁnding er<span class="_ _8"></span>rors.</div><div class="t m0 x74 h14 y951 ff1 fs3 fc0 sc0 ls0 ws0">Recommendation<span class="ff8">: <span class="ffa">Use jiggling str<span class="_ _1"></span>ategies to ferr<span class="_ _1"></span>et out err<span class="_ _4"></span>ors.</span></span></div><div class="t m0 xd h17 yeeb ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 ws678">Concur<span class="_ _8"></span>rent code is difﬁcult to get right. Code that is simple to follo<span class="_ _1"></span>w can become night-</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws433">marish when multiple threads and shared data get into the mix. If y<span class="_ _4"></span>ou are faced with writ-</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws679">ing concur<span class="_ _8"></span>rent code, you need to write clean code with rigor or else face subtle and</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws0">infrequent failures.</div><div class="t m0 x74 h14 y22a ff8 fs3 fc0 sc0 ls0 ws67a">First and foremost, follo<span class="_ _1"></span>w the Single Responsibility Principle. Break your system into</div><div class="t m0 xd h14 y22b ff8 fs3 fc0 sc0 ls0 ws3f6">POJOs that separate thread-a<span class="_ _4"></span>ware code from thread-ignorant code. Mak<span class="_ _4"></span>e sure when y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws443">are testing your thread-a<span class="_ _1"></span>ware code, y<span class="_ _4"></span>ou are only testing it and nothing else. <span class="_ _1"></span>This suggests</div><div class="t m0 xd h14 y22d ff8 fs3 fc0 sc0 ls0 ws0">that your thread-a<span class="_ _1"></span>ware code should be small and focused.</div><div class="t m0 x74 h14 y2bc ff8 fs3 fc0 sc0 ls0 ws67b">Kno<span class="_ _4"></span>w the possible sources of concurrency issues: multiple threads operating on</div><div class="t m0 xd h14 y2bd ff8 fs3 fc0 sc0 ls0 ws263">shared data, or using a common resource pool. Boundary cases, such as shutting down</div><div class="t m0 xd h14 y2be ff8 fs3 fc0 sc0 ls0 ws0">cleanly or ﬁnishing the iteration of a loop, can be especiall<span class="_ _1"></span>y thor<span class="_ _8"></span>ny<span class="_ _0"></span>.</div><div class="t m0 xd h25 yeec ff8 fse fc0 sc0 ls0 ws0">18.<span class="_ _18"> </span>http://www<span class="_ _1"></span>.alphaw<span class="_ _4"></span>orks.ibm.com/tech/contest</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:259.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.alphaworks.ibm.com/tech/contest"><div class="d m1" style="border-style:none;position:absolute;left:90.835200px;bottom:64.749110px;width:126.554800px;height:7.657800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfde" class="pf w1 h2" data-page-no="de"><div class="pc pcde w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">191<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws135">Learn your library and know the fundamental algorithms. Understand ho<span class="_ _1"></span>w some of</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws250">the features offered b<span class="_ _1"></span>y the librar<span class="_ _8"></span>y suppor<span class="_ _8"></span>t solving problems similar to the fundamental</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">algorithms.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws638">Learn how to ﬁnd re<span class="_ _4"></span>gions of code that must be locked and lock them. Do not lock</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws67c">regions of code that do not need to be lock<span class="_ _4"></span>ed. <span class="_ _4"></span>A<span class="_ _0"></span>void calling one lock<span class="_ _4"></span>ed section from</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws1e5">another<span class="_ _1"></span>. <span class="_ _4"></span>This requires a deep understanding of whether something is or is not shared. K<span class="_ _4"></span>eep</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws3a">the amount of shared objects and the scope of the sharing as nar<span class="_ _8"></span>ro<span class="_ _4"></span>w as possible. Change</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws324">designs of the objects with shared data to accommodate clients rather than forcing clients</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">to manage shared state.</div><div class="t m0 x74 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws67d">Issues will crop up. <span class="_ _1"></span>The ones that do not crop up early are often written of<span class="_ _4"></span>f as a one-</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws67e">time occur<span class="_ _8"></span>rence. <span class="_ _4"></span>These so-called one-of<span class="_ _4"></span>fs typically onl<span class="_ _4"></span>y happen under load or at seem-</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws2e6">ingly random times. <span class="_ _1"></span>Therefore, you need to be ab<span class="_ _4"></span>le to run your thread-related code in</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws5ee">many conﬁgurations on man<span class="_ _1"></span>y platfor<span class="_ _8"></span>ms repeatedly and continuousl<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _1"></span>T<span class="_ _1"></span>estability<span class="_ _0"></span>, which</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls17 ws24c">comes naturally from follo<span class="_ _1"></span>wing the <span class="_ _4"></span>Three La<span class="_ _4"></span>ws of <span class="_ _4"></span>TDD<span class="_ _1"></span>, implies some lev<span class="_ _4"></span>el of plug-ability<span class="_ _1"></span>,</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws0">which of<span class="_ _4"></span>fers the support necessar<span class="_ _8"></span>y to r<span class="_ _8"></span>un code in a wider range of conﬁgurations.</div><div class="t m0 x74 h14 y21d ff8 fs3 fc0 sc0 ls0 ws610">Y<span class="_ _3"></span>ou will g<span class="_ _8"></span>reatly impro<span class="_ _1"></span>ve your chances of ﬁnding erroneous code if you take the time</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 ws625">to instrument your code. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can either do so b<span class="_ _4"></span>y hand or using some kind of automated</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 ws2fb">technology<span class="_ _0"></span>. In<span class="_ _1"></span>vest in this early<span class="_ _0"></span>. <span class="_ _0"></span>Y<span class="_ _2"></span>ou w<span class="_ _4"></span>ant to be r<span class="_ _8"></span>unning your thread-based code as long as</div><div class="t m0 xd h14 y220 ff8 fs3 fc0 sc0 ls0 ws0">possible before y<span class="_ _4"></span>ou put it into production.</div><div class="t m0 x74 h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">If you tak<span class="_ _4"></span>e a clean approach, your chances of getting it right increase drasticall<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 xd h17 ye00 ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y2c8 ff1 fs3 fc0 sc0 ls0 wsa0">[Lea99]:<span class="_ _4"></span>  <span class="ffa ws67f">Concurrent Pr<span class="_ _1"></span>ogr<span class="_ _1"></span>amming in J<span class="_ _4"></span>ava: Design Principles and P<span class="_ _1"></span>atterns<span class="ff8">, 2d. ed.,</span></span></div><div class="t m0 xd h14 y2c9 ff8 fs3 fc0 sc0 ls0 ws0">Doug Lea, Prentice Hall, 1999.</div><div class="t m0 xd h14 yd2d ff1 fs3 fc0 sc0 ls0 wsa0">[PPP]:<span class="_ _4"></span>  <span class="ffa ls10 ws2a5">Agile Softwar<span class="_ _4"></span>e Development: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>actices<span class="ff8">, Rober<span class="_ _8"></span>t C. Martin,</span></span></div><div class="t m0 xd h14 yd2e ff8 fs3 fc0 sc0 ls0 ws0">Prentice Hall, 2002.</div><div class="t m0 xd h14 y2f9 ff1 fs3 fc0 sc0 ls0 wsa0">[PRA<span class="_ _1"></span>G]:  <span class="ffa ws680">The Pr<span class="_ _1"></span>agmatic Pr<span class="_ _4"></span>o<span class="_ _4"></span>gr<span class="_ _4"></span>ammer<span class="_ _4"></span><span class="ff8 ls3d ws681">, <span class="_ _4"></span>Andrew Hunt, Da<span class="_ _1"></span>ve <span class="_ _4"></span>Thomas, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>,</span></span></div><div class="t m0 xd h14 y2fa ff8 fs3 fc0 sc0 ls3d ws0">2000.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:310.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfdf" class="pf w1 h2" data-page-no="df"><div class="pc pcdf w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe0" class="pf w1 h2" data-page-no="e0"><div class="pc pce0 w1 h2"><img class="bi xd yeed w4 h93" alt="" src="bge0.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">193</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">14</div><div class="t m0 x92 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Successiv<span class="_ _0"></span>e Reﬁnement</div><div class="t m0 xd6 h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">Case Study of a Command-Line <span class="_ _1"></span>Argument Parser</div><div class="t m0 xd h1d yeee ffd fs3 fc0 sc0 ls0 ws334">This chapter is a case study in successi<span class="_ _4"></span>ve reﬁnement. <span class="_ _0"></span>Y<span class="_ _0"></span>ou will see a module that started</div><div class="t m0 xd h1d yeef ffd fs3 fc0 sc0 ls0 ws0">well but did not scale. <span class="_ _4"></span>Then you will see how the module w<span class="_ _4"></span>as refactored and cleaned. </div><div class="t m0 x74 h1d yef0 ffd fs3 fc0 sc0 ls12 wsf2">Most of us hav<span class="_ _4"></span>e had to parse command-line arguments from time to time. If we</div><div class="t m0 xd h1d yef1 ffd fs3 fc0 sc0 ls12 ws331">don’t ha<span class="_ _4"></span>ve a con<span class="_ _1"></span>venient utility<span class="_ _1"></span>, then we simply walk the array of strings that is passed</div><div class="t m0 xd h1d yef2 ffd fs3 fc0 sc0 ls12 ws682">into the </div><div class="t m5 x9a h2f yef3 ffb fs10 fc0 sc0 ls5d ws0">main</div><div class="t m0 x28 h1d yef3 ffd fs3 fc0 sc0 ls12 ws682">function. There are se<span class="_ _4"></span>veral good utilities a<span class="_ _4"></span>vailable from v<span class="_ _4"></span>arious sources,</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:210.016000px;bottom:440.027010px;width:229.014000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe1" class="pf w1 h2" data-page-no="e1"><div class="pc pce1 w1 h2"><img class="bi xd yef4 wc h94" alt="" src="bge1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">194<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 xd h1d y194 ffd fs3 fc0 sc0 ls12 ws22">but none of them do exactly what I w<span class="_ _4"></span>ant. So, of course, I decided to write my own. I call</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls12 ws0">it:</div><div class="t m5 xcd h2f y195 ffb fs10 fc0 sc0 ls5d ws0">Args</div><div class="t m0 x1a h1d y195 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x8a h1d y1fa ffd fs3 fc0 sc0 ls0 ws59c">is very simple to use. <span class="_ _0"></span>Y<span class="_ _0"></span>ou simply construct the </div><div class="t m5 xae h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x55 h1d y1fa ffd fs3 fc0 sc0 ls0 ws59c">class with the input argu-</div><div class="t m0 xd h1d y1fb ffd fs3 fc0 sc0 ls0 ws627">ments and a format string, and then query the </div><div class="t m5 xce h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x40 h1d y1fb ffd fs3 fc0 sc0 ls0 ws627">instance for the v<span class="_ _4"></span>alues of the argu-</div><div class="t m0 xd h1d y1bd ffd fs3 fc0 sc0 ls0 ws0">ments. Consider the follo<span class="_ _4"></span>wing simple example:</div><div class="t m0 x74 h1d y21f ffd fs3 fc0 sc0 ls0 ws431">Y<span class="_ _0"></span>ou can see ho<span class="_ _4"></span>w simple this is. W<span class="_ _0"></span>e just create an instance of the </div><div class="t m5 x6b h2f y3d7 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xbd h1d y3d7 ffd fs3 fc0 sc0 ls0 ws431">class with two</div><div class="t m0 xd h1d y749 ffd fs3 fc0 sc0 ls0 ws7e">parameters. The ﬁrst parameter is the format, or <span class="ffa ws0">sc<span class="_ _4"></span>hema,<span class="ffd ls48 ws2ca"> string: </span></span></div><div class="t m5 x51 h2f y749 ffb fs10 fc0 sc0 ls0 ws0">&quot;l,p#,d*</div><div class="t m0 x4a h1d y749 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x60 h2f y749 ffb fs10 fc0 sc0 ls0 ws0">&quot;</div><div class="t m0 x6f h1d y749 ffd fs3 fc0 sc0 ls11 ws518"> It deﬁnes three</div><div class="t m0 xd h1d y74a ffd fs3 fc0 sc0 ls10 ws111">command-line arguments. <span class="_ _4"></span>The ﬁrst, </div><div class="t m5 x5b h2f y74a ffb fs10 fc0 sc0 ls45 ws0">–l</div><div class="t m0 x32 h1d y74a ffd fs3 fc0 sc0 ls10 ws111">, is a boolean argument. <span class="_ _4"></span>The second, </div><div class="t m5 x6f h2f y74a ffb fs10 fc0 sc0 ls45 ws0">-p</div><div class="t m0 xa6 h1d y74a ffd fs3 fc0 sc0 ls10 ws111">, is an integer</div><div class="t m0 xd h1d y74b ffd fs3 fc0 sc0 ls0 ws683">argument. The third, </div><div class="t m5 xb h2f y74b ffb fs10 fc0 sc0 ls0 ws0">-d</div><div class="t m0 xd0 h1d y74b ffd fs3 fc0 sc0 ls0 ws38">, is a string argument. <span class="_ _4"></span>The second parameter to the </div><div class="t m5 xa7 h2f y74b ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x70 h1d y74b ffd fs3 fc0 sc0 ls0 ws0">constructor</div><div class="t m0 xd h1d y74c ffd fs3 fc0 sc0 ls0 ws0">is simply the array of command-line argument passed into </div><div class="t m5 xae h2f yc58 ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 xab h1d yc58 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1d ybfc ffd fs3 fc0 sc0 ls16 ws684">If the constructor returns without thro<span class="_ _4"></span>wing an </div><div class="t m5 x27 h2f ybfc ffb fs10 fc0 sc0 ls31 ws0">ArgsException</div><div class="t m0 x73 h1d ybfc ffd fs3 fc0 sc0 ls16 ws684">, then the incoming</div><div class="t m0 xd h1d ybfd ffd fs3 fc0 sc0 ls6f ws685">command-line was parsed, and the </div><div class="t m5 x26 h2f ybfd ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x4b h1d ybfd ffd fs3 fc0 sc0 ls0 ws5eb">instance is ready to be queried. Methods like</div><div class="t m5 xd h2f y3df ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 x5f h1d y3df ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x6c h2f y3df ffb fs10 fc0 sc0 ls0 ws0">getInteger</div><div class="t m0 xd0 h1d y3df ffd fs3 fc0 sc0 ls0 ws51a">, and </div><div class="t m5 x5d h2f y3df ffb fs10 fc0 sc0 ls0 ws0">getString</div><div class="t m0 xe9 h1d y3df ffd fs3 fc0 sc0 ls0 ws51a">allow us to access the v<span class="_ _1"></span>alues of the arguments by</div><div class="t m0 xd h1d y3e0 ffd fs3 fc0 sc0 ls0 ws0">their names.</div><div class="t m0 x74 h1d y57f ffd fs3 fc0 sc0 ls0 ws686">If there is a problem, either in the format string or in the command-line arguments</div><div class="t m0 xd h1d y580 ffd fs3 fc0 sc0 ls0 ws687">themselves, an </div><div class="t m5 x24 h2f yef5 ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x84 h1d yef5 ffd fs3 fc0 sc0 ls0 ws687">will be thro<span class="_ _4"></span>wn. <span class="_ _4"></span>A con<span class="_ _4"></span>venient description of what went</div><div class="t m0 xd h1d y3fa ffd fs3 fc0 sc0 ls0 ws0">wrong can be retrie<span class="_ _4"></span>ved from the </div><div class="t m5 x92 h2f y3fa ffb fs10 fc0 sc0 ls0 ws0">errorMessage</div><div class="t m0 x1b h1d y3fa ffd fs3 fc0 sc0 ls0 ws0"> method of the exception.</div><div class="t m0 xd h17 yef6 ff1 fs9 fc0 sc0 ls0 ws0">Args Implementation</div><div class="t m0 xd h14 y584 ff8 fs3 fc0 sc0 ls0 ws2a0">Listing 14-2 is the implementation of the </div><div class="t m5 x22 h2f y584 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x65 h14 y584 ff8 fs3 fc0 sc0 ls0 ws2a0">class. Please read it very carefully<span class="_ _0"></span>. I w<span class="_ _4"></span>orked</div><div class="t m0 xd h14 y585 ff8 fs3 fc0 sc0 ls0 ws0">hard on the style and structure and hope it is worth emulating.</div><div class="t m0 x74 h1c yef7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-1</div><div class="t m0 x74 h36 yef8 ffc fs3 fc0 sc0 ls0 ws0">Simple use of Args</div><div class="t m5 x74 h2f y6e2 ffb fs10 fc0 sc0 ls14 ws253">  public static void main(String[] args) {</div><div class="t m5 x74 h2f y6e3 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yef9 ffb fs10 fc0 sc0 ls0 ws0">      Args arg = new Args(&quot;l,p#,d*&quot;, args);</div><div class="t m5 x74 h2f yefa ffb fs10 fc0 sc0 ls0 ws0">      boolean logging = arg.getBoolean(&apos;l&apos;);</div><div class="t m5 x74 h2f yefb ffb fs10 fc0 sc0 ls0 ws0">      int port = arg.getInt(&apos;p&apos;);</div><div class="t m5 x74 h2f yefc ffb fs10 fc0 sc0 ls0 ws0">      String directory = arg.getString(&apos;d&apos;);</div><div class="t m5 x74 h2f yefd ffb fs10 fc0 sc0 ls0 ws0">      executeApplication(logging, port, directory);</div><div class="t m5 x74 h2f yefe ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f yeff ffb fs10 fc0 sc0 ls0 ws0">      System.out.printf(&quot;Argument error: %s\n&quot;, e.errorMessage());</div><div class="t m5 x74 h2f yf00 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yf01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y6dc ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-2</div><div class="t m0 x74 h36 y3c9 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div><div class="t m5 x74 h2f yf02 ffb fs10 fc0 sc0 ls0 ws0">package com.objectmentor.utilities.args;</div><div class="t m5 x74 h2f yf03 ffb fs10 fc0 sc0 ls0 ws0">import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;</div><div class="t m5 x74 h2f yf04 ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f yf05 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f yf06 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; marshalers;</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:199.945010px;width:127.793000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe2" class="pf w1 h2" data-page-no="e2"><div class="pc pce2 w1 h2"><img class="bi xd yf07 wc h95" alt="" src="bge2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">195<span class="_ _10"></span><span class="ff1">Args Implementation</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  private ListIterator&lt;String&gt; currentArgument;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ArgsException {</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    marshalers = new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    parseSchema(schema);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    parseArgumentStrings(Arrays.asList(args));</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchema(String schema) throws ArgsException {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;))</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      if (element.length() &gt; 0)</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">        parseSchemaElement(element.trim());</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws ArgsException {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    if (elementTail.length() == 0)</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new BooleanArgumentMarshaler());</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;*&quot;))</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArgumentMarshaler());</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;#&quot;))</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new IntegerArgumentMarshaler());</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;##&quot;))</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new DoubleArgumentMarshaler());</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;[*]&quot;))</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArrayArgumentMarshaler());</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(INVALID_ARGUMENT_FORMAT, elementId, elementTail);</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws ArgsException {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId))</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(INVALID_ARGUMENT_NAME, elementId, null);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x3e h2f y6a9 ffb fs10 fc0 sc0 ls0 ws688">private void parseArgumentStrings(List&lt;String&gt; argsList) throws ArgsException </div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">  {</div><div class="t m5 x9a h2f y6ab ffb fs10 fc0 sc0 ls0 ws689">for (currentArgument = argsList.listIterator(); currentArgument.hasNext();) </div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">      String argString = currentArgument.next();</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">      if (argString.startsWith(&quot;-&quot;)) {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">        parseArgumentCharacters(argString.substring(1));</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      } else {</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">        currentArgument.previous();</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-2  (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe3" class="pf w1 h2" data-page-no="e3"><div class="pc pce3 w1 h2"><img class="bi xd ycbb wc h80" alt="" src="bge3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">196<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d yf08 ffd fs3 fc0 sc0 ls0 ws68a">Notice that you can read this code from the top to the bottom without a lot of jumping</div><div class="t m0 xd h1d ybcb ffd fs3 fc0 sc0 ls0 ws27">around or looking ahead. The one thing you may ha<span class="_ _4"></span>ve had to look ahead for is the deﬁni-</div><div class="t m0 xd h1d yf09 ffd fs3 fc0 sc0 ls0 ws200">tion of </div><div class="t m5 x95 h2f yf0a ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x7d h1d yf0a ffd fs3 fc0 sc0 ls0 ws200">, which I left out intentionally<span class="_ _1"></span>. Having read this code carefully<span class="_ _0"></span>,</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgumentCharacters(String argChars) throws ArgsException {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 0; i &lt; argChars.length(); i++)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      parseArgumentCharacter(argChars.charAt(i));</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgumentCharacter(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    if (m == null) {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(UNEXPECTED_ARGUMENT, argChar, null);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">        m.set(currentArgument);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">        e.setErrorArgumentId(argChar);</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">        throw e;</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  public boolean has(char arg) {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.contains(arg);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  public int nextArgument() {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    return currentArgument.nextIndex();</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    return BooleanArgumentMarshaler.getValue(marshalers.get(arg));</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    return StringArgumentMarshaler.getValue(marshalers.get(arg));</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    return IntegerArgumentMarshaler.getValue(marshalers.get(arg));</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  public double getDouble(char arg) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    return DoubleArgumentMarshaler.getValue(marshalers.get(arg));</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  public String[] getStringArray(char arg) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return StringArrayArgumentMarshaler.getValue(marshalers.get(arg));</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-2  (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe4" class="pf w1 h2" data-page-no="e4"><div class="pc pce4 w1 h2"><img class="bi xd yf0b wc h96" alt="" src="bge4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">197<span class="_ _10"></span><span class="ff1">Args Implementation</span></div><div class="t m0 xd h1d y194 ffd fs3 fc0 sc0 ls0 ws3f8">you should understand what the </div><div class="t m5 x1c h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x54 h1d y194 ffd fs3 fc0 sc0 ls0 ws3f8">interface is and what its deri<span class="_ _4"></span>vati<span class="_ _4"></span>ves do.</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws0">I’ll sho<span class="_ _4"></span>w a few of them to you no<span class="_ _4"></span>w (Listing 14-3 through Listing 14-6).</div><div class="t m0 x74 h1c yc08 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-3 </div><div class="t m0 x74 h36 y198 ffc fs3 fc0 sc0 ls0 ws0">ArgumentMarshaler.java</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">public interface ArgumentMarshaler {</div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">  void set(Iterator&lt;String&gt; currentArgument) throws ArgsException;</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y19d ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-4 </div><div class="t m0 x74 h36 yf0c ffc fs3 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler.java</div><div class="t m5 x74 h2f yf0d ffb fs10 fc0 sc0 ls0 ws0">public class BooleanArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f yf0e ffb fs10 fc0 sc0 ls0 ws0">  private boolean booleanValue = false;</div><div class="t m5 x74 h2f yf0f ffb fs10 fc0 sc0 ls0 ws0">  public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f yf10 ffb fs10 fc0 sc0 ls0 ws0">    booleanValue = true;</div><div class="t m5 x74 h2f yf11 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf12 ffb fs10 fc0 sc0 ls0 ws0">  public static boolean getValue(ArgumentMarshaler am) {</div><div class="t m5 x74 h2f yf13 ffb fs10 fc0 sc0 ls0 ws0">    if (am != null &amp;&amp; am instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f yf14 ffb fs10 fc0 sc0 ls0 ws0">      return ((BooleanArgumentMarshaler) am).booleanValue;</div><div class="t m5 x74 h2f yf15 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f yf16 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f yf17 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf18 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y63c ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-5 </div><div class="t m0 x74 h36 y438 ffc fs3 fc0 sc0 ls0 ws0">StringArgumentMarshaler.java</div><div class="t m5 x74 h2f y63d ffb fs10 fc0 sc0 ls0 ws0">import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;</div><div class="t m5 x74 h2f ya48 ffb fs10 fc0 sc0 ls0 ws0">public class StringArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f yf19 ffb fs10 fc0 sc0 ls0 ws0">  private String stringValue = &quot;&quot;;</div><div class="t m5 x74 h2f ya4a ffb fs10 fc0 sc0 ls0 ws0">  public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f ya4b ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f ya4c ffb fs10 fc0 sc0 ls0 ws0">      stringValue = currentArgument.next();</div><div class="t m5 x74 h2f yf1a ffb fs10 fc0 sc0 ls0 ws0">    } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f ya4d ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(MISSING_STRING);</div><div class="t m5 x74 h2f ya4e ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ya4f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf1b ffb fs10 fc0 sc0 ls0 ws0">  public static String getValue(ArgumentMarshaler am) {</div><div class="t m5 x74 h2f ya51 ffb fs10 fc0 sc0 ls0 ws0">    if (am != null &amp;&amp; am instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f ya52 ffb fs10 fc0 sc0 ls0 ws0">      return ((StringArgumentMarshaler) am).stringValue;</div><div class="t m5 x74 h2f ya53 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f ya54 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f yf1c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf1d ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe5" class="pf w1 h2" data-page-no="e5"><div class="pc pce5 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bge5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">198<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y59c ffd fs3 fc0 sc0 ls0 ws52d">The other </div><div class="t m5 xe h2f y2c ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x81 h1d y2c ffd fs3 fc0 sc0 ls0 ws52d">deriv<span class="_ _1"></span>atives simply replicate this pattern for </div><div class="t m5 x63 h2f y2c ffb fs10 fc0 sc0 ls0 ws0">doubles</div><div class="t m0 x8c h1d y2c ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y2d ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x3e h1d y2d ffd fs3 fc0 sc0 ls0 ws0"> arrays and would serv<span class="_ _4"></span>e to clutter this chapter<span class="_ _4"></span>. I’ll leav<span class="_ _4"></span>e them to you as an exercise.</div><div class="t m0 x74 h1d y285 ffd fs3 fc0 sc0 ls0 ws364">One other bit of information might be troubling you: the deﬁnition of the error code</div><div class="t m0 xd h1d y286 ffd fs3 fc0 sc0 ls0 ws0">constants. The<span class="_ _4"></span>y are in the </div><div class="t m5 x7 h2f yf1f ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x83 h1d yf1f ffd fs3 fc0 sc0 ls0 ws0"> class (Listing 14-7).</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-6 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">IntegerArgumentMarshaler.java</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">public class IntegerArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private int intValue = 0;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      parameter = currentArgument.next();</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      intValue = Integer.parseInt(parameter);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(MISSING_INTEGER);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(INVALID_INTEGER, parameter);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  public static int getValue(ArgumentMarshaler am) {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    if (am != null &amp;&amp; am instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      return ((IntegerArgumentMarshaler) am).intValue;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">      return 0;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c yf20 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-7 </div><div class="t m0 x74 h36 yf21 ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div><div class="t m5 x74 h2f y92c ffb fs10 fc0 sc0 ls0 ws0">import static com.objectmentor.utilities.args.ArgsException.ErrorCode.*;</div><div class="t m5 x74 h2f y92e ffb fs10 fc0 sc0 ls0 ws0">public class ArgsException extends Exception {</div><div class="t m5 x74 h2f y92f ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f y930 ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = null;</div><div class="t m5 x74 h2f y931 ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = OK;</div><div class="t m5 x74 h2f y933 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException() {}</div><div class="t m5 x74 h2f y935 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(String message) {super(message);}</div><div class="t m5 x74 h2f y937 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode) {</div><div class="t m5 x74 h2f y938 ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y939 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf22 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode, String errorParameter) {</div><div class="t m5 x74 h2f yf23 ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f yf24 ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f yf25 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe6" class="pf w1 h2" data-page-no="e6"><div class="pc pce6 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bge6.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">199<span class="_ _10"></span><span class="ff1">Args Implementation</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode, </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">                       char errorArgumentId, String errorParameter) {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    this.errorArgumentId = errorArgumentId;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public char getErrorArgumentId() {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    return errorArgumentId;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorArgumentId(char errorArgumentId) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    this.errorArgumentId = errorArgumentId;</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  public String getErrorParameter() {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    return errorParameter;</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorParameter(String errorParameter) {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  public ErrorCode getErrorCode() {</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    return errorCode;</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorCode(ErrorCode errorCode) {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    switch (errorCode) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      case OK:</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">        return &quot;TILT: Should not get here.&quot;;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      case UNEXPECTED_ARGUMENT:</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c unexpected.&quot;, errorArgumentId);</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_STRING:</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_INTEGER:</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects an integer but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_INTEGER:</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find integer parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_DOUBLE:</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects a double but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_DOUBLE:</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find double parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_ARGUMENT_NAME:</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;&apos;%c&apos; is not a valid argument name.&quot;, </div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe7" class="pf w1 h2" data-page-no="e7"><div class="pc pce7 w1 h2"><img class="bi xd yf26 wc h98" alt="" src="bge7.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">200<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d ya45 ffd fs3 fc0 sc0 ls0 wsdb">It’<span class="_ _1"></span>s remarkable how much code is required to ﬂesh out the details of this simple con-</div><div class="t m0 xd h1d ya46 ffd fs3 fc0 sc0 ls0 ws68b">cept. One of the reasons for this is that we are using a particularly wordy language. Ja<span class="_ _4"></span>va,</div><div class="t m0 xd h1d yf27 ffd fs3 fc0 sc0 ls0 ws26a">being a statically typed language, requires a lot of words in order to satisfy the type sys-</div><div class="t m0 xd h1d y914 ffd fs3 fc0 sc0 ls0 ws0">tem. In a language like Ruby<span class="_ _1"></span>, Python, or Smalltalk, this program is much smaller<span class="_ _1"></span>.</div><div class="t m0 xd9 h99 y6fb ffd fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x74 h1d y280 ffd fs3 fc0 sc0 ls0 ws145">Please read the code ov<span class="_ _4"></span>er one more time. Pay special attention to the way things are</div><div class="t m0 xd h1d y281 ffd fs3 fc0 sc0 ls0 ws4ba">named, the size of the functions, and the formatting of the code. If you are an experienced</div><div class="t m0 xd h1d y2a ffd fs3 fc0 sc0 ls0 ws207">programmer<span class="_ _4"></span>, you may hav<span class="_ _4"></span>e some quibbles here and there with various parts of the style or</div><div class="t m0 xd h1d y2b ffd fs3 fc0 sc0 ls0 ws54c">structure. Overall, ho<span class="_ _4"></span>wev<span class="_ _4"></span>er<span class="_ _4"></span>, I hope you conclude that this program is nicely written and</div><div class="t m0 xd h1d y2c ffd fs3 fc0 sc0 ls0 ws0">has a clean structure. </div><div class="t m0 x74 h1d y284 ffd fs3 fc0 sc0 ls0 ws68c">For e<span class="_ _4"></span>xample, it should be obvious ho<span class="_ _4"></span>w you would add a new ar<span class="_ _4"></span>gument type, such as a</div><div class="t m0 xd h1d y285 ffd fs3 fc0 sc0 ls0 ws4ab">date argument or a comple<span class="_ _4"></span>x number argument, and that such an addition would require a</div><div class="t m0 xd h1d y286 ffd fs3 fc0 sc0 ls0 ws30e">tri<span class="_ _4"></span>vial amount of effort. In short, it would simply require a ne<span class="_ _4"></span>w deriv<span class="_ _4"></span>ati<span class="_ _4"></span>ve of </div><div class="t m5 x99 h2f y2b7 ffb fs10 fc0 sc0 ls0 ws0">Argument-</div><div class="t m5 xd h2f yf28 ffb fs10 fc0 sc0 ls0 ws0">Marshaler</div><div class="t m0 x8a h1d y2b8 ffd fs3 fc0 sc0 ls0 ws68d">, a new </div><div class="t m5 xe2 h2f y2b8 ffb fs10 fc0 sc0 ls0 ws0">getXXX</div><div class="t m0 x7d h1d y2b8 ffd fs3 fc0 sc0 ls0 ws68d">function, and a ne<span class="_ _4"></span>w case statement in the </div><div class="t m5 x6b h2f y2b8 ffb fs10 fc0 sc0 ls0 ws0">parseSchemaElement</div><div class="t m0 xd h1d y2b9 ffd fs3 fc0 sc0 ls0 ws46c">function. There w<span class="_ _4"></span>ould also probably be a new </div><div class="t m5 xce h2f y2b9 ffb fs10 fc0 sc0 ls0 ws0">ArgsException.Error<span class="_ _4"></span>Code</div><div class="t m0 xa7 h1d y2b9 ffd fs3 fc0 sc0 ls0 ws46c">and a new error</div><div class="t m0 xd h1d y54f ffd fs3 fc0 sc0 ls0 ws0">message.</div><div class="t m0 xd h11 yf29 ff1 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _1"></span>w Did I Do <span class="_ _1"></span>This?</div><div class="t m0 xd h14 ydfb ff8 fs3 fc0 sc0 ls0 ws39c">Let me set your mind at rest. I did not simpl<span class="_ _4"></span>y write this pro<span class="_ _4"></span>g<span class="_ _8"></span>ram from beginning to end in</div><div class="t m0 xd h14 yb77 ff8 fs3 fc0 sc0 ls0 ws68e">its cur<span class="_ _8"></span>rent form. More impor<span class="_ _8"></span>tantly<span class="_ _0"></span>, I am not expecting y<span class="_ _4"></span>ou to be able to write clean and</div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 lsc ws384">elegant pro<span class="_ _4"></span>grams in one pass. If we ha<span class="_ _4"></span>ve learned anything o<span class="_ _1"></span>ver the last couple of decades,</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 ls0 ws68f">it is that pro<span class="_ _4"></span>g<span class="_ _8"></span>ramming is a craft more than it is a science. <span class="_ _4"></span>T<span class="_ _1"></span>o write clean code, you must</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws0">ﬁrst write dirty code <span class="ffa">and then clean it</span>.</div><div class="t m0 x74 h1d ya1e ffd fs3 fc0 sc0 ls0 ws46d">This should not be a surprise to you. <span class="_ _4"></span>W<span class="_ _1"></span>e learned this truth in grade school when our</div><div class="t m0 xd h1d yb78 ffd fs3 fc0 sc0 ls0 ws495">teachers tried (usually in v<span class="_ _4"></span>ain) to get us to write rough drafts of our compositions. The</div><div class="t m0 xd h1d yb79 ffd fs3 fc0 sc0 ls0 ws406">process, they told us, was that we should write a rough draft, then a second draft, then se<span class="_ _1"></span>v-</div><div class="t m0 xd h1d y60d ffd fs3 fc0 sc0 ls0 ws210">eral subsequent drafts until we had our ﬁnal version. <span class="_ _4"></span>Writing clean compositions, they</div><div class="t m0 xd h1d y60e ffd fs3 fc0 sc0 ls0 ws0">tried to tell us, is a matter of successi<span class="_ _4"></span>ve reﬁnement.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_ARGUMENT_FORMAT:</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;&apos;%s&apos; is not a valid argument format.&quot;, </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">                             errorParameter);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public enum ErrorCode {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    OK, INVALID_ARGUMENT_FORMAT, UNEXPECTED_ARGUMENT, INVALID_ARGUMENT_NAME,</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_STRING,</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_INTEGER, INVALID_INTEGER,</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_DOUBLE, INVALID_DOUBLE}</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 yd2f ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>I recentl<span class="_ _4"></span>y rewrote this module in Rub<span class="_ _4"></span>y<span class="_ _4"></span>. It was 1/7th the size and had a subtl<span class="_ _4"></span>y better structure.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-7 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:226.728010px;width:101.368000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe8" class="pf w1 h2" data-page-no="e8"><div class="pc pce8 w1 h2"><img class="bi xd ycdc wc h9a" alt="" src="bge8.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">201<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws5fe">Most freshman programmers (like most grade-schoolers) don’<span class="_ _4"></span>t follow this advice par<span class="_ _4"></span>-</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws298">ticularly well. The<span class="_ _4"></span>y believ<span class="_ _4"></span>e that the primary goal is to get the program working. Once it’<span class="_ _1"></span>s</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 wsf9">“working,<span class="_ _0"></span>” they move on to the ne<span class="_ _4"></span>xt task, leaving the “working” program in whate<span class="_ _1"></span>ver state</div><div class="t m0 xd h1d y197 ffd fs3 fc0 sc0 ls0 ws342">they ﬁnally got it to “w<span class="_ _4"></span>ork.<span class="_ _1"></span>” Most seasoned programmers know that this is professional</div><div class="t m0 xd h1d y198 ffd fs3 fc0 sc0 ls0 ws0">suicide.</div><div class="t m0 xd h17 y8dc ff1 fs9 fc0 sc0 ls0 ws0">Args:<span class="_ _1"></span> <span class="_ _1"></span>The Rough Draft</div><div class="t m0 x74 h1d y29b ffd fs3 fc0 sc0 ls0 ws0">Listing 14-8 sho<span class="_ _4"></span>ws an earlier version of the </div><div class="t m5 x42 h2f y29b ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xb4 h1d y29b ffd fs3 fc0 sc0 ls0 ws0"> class. It “works.<span class="_ _0"></span>” <span class="_ _4"></span>And it’<span class="_ _4"></span>s messy<span class="_ _1"></span>.</div><div class="t m0 x74 h1c y5b9 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-8 </div><div class="t m0 x74 h36 y253 ffc fs3 fc0 sc0 ls0 ws0">Args.java (first draft)</div><div class="t m5 x74 h2f y97e ffb fs10 fc0 sc0 ls0 ws0">import java.text.ParseException;</div><div class="t m5 x74 h2f y97f ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f y981 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y982 ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h2f yf2a ffb fs10 fc0 sc0 ls0 ws0">  private String[] args;</div><div class="t m5 x74 h2f y983 ffb fs10 fc0 sc0 ls0 ws0">  private boolean valid = true;</div><div class="t m5 x74 h2f y984 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; unexpectedArguments = new TreeSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y985 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, Boolean&gt; booleanArgs = </div><div class="t m5 x74 h2f yf2b ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, Boolean&gt;();</div><div class="t m5 x74 h2f y986 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, String&gt; stringArgs = new HashMap&lt;Character, String&gt;();</div><div class="t m5 x74 h2f y987 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, Integer&gt; intArgs = new HashMap&lt;Character, Integer&gt;();</div><div class="t m5 x74 h2f y988 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f yf2c ffb fs10 fc0 sc0 ls0 ws0">  private int currentArgument;</div><div class="t m5 x74 h2f y989 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f y98a ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h2f y98b ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x74 h2f yf2d ffb fs10 fc0 sc0 ls0 ws0">  private enum ErrorCode {</div><div class="t m5 x74 h2f yf2e ffb fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT}</div><div class="t m5 x74 h2f yf2f ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ParseException {</div><div class="t m5 x74 h2f yf30 ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f yf31 ffb fs10 fc0 sc0 ls0 ws0">    this.args = args;</div><div class="t m5 x74 h2f yf32 ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f yf33 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf34 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() throws ParseException {</div><div class="t m5 x74 h2f yf35 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; args.length == 0)</div><div class="t m5 x74 h2f yf36 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f yf37 ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f yf38 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yf39 ffb fs10 fc0 sc0 ls0 ws0">      parseArguments();</div><div class="t m5 x74 h2f yf3a ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f yf3b ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yf3c ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f yf3d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf3e ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() throws ParseException {</div><div class="t m5 x74 h2f yf3f ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;)) {</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:502.945010px;width:138.063000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfe9" class="pf w1 h2" data-page-no="e9"><div class="pc pce9 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bge9.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">202<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      if (element.length() &gt; 0) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">        String trimmedElement = element.trim();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">        parseSchemaElement(trimmedElement);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws ParseException {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanSchemaElement(elementTail))</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      parseBooleanSchemaElement(elementId);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringSchemaElement(elementTail))</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      parseStringSchemaElement(elementId);</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    else if (isIntegerSchemaElement(elementTail)) {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      parseIntegerSchemaElement(elementId);</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">        String.format(&quot;Argument: %c has invalid format: %s.&quot;, </div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">                      elementId, elementTail), 0);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws ParseException {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId)) {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">        &quot;Bad character:&quot; + elementId + &quot;in Args format: &quot; + schema, 0);</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(elementId, false);</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  private void parseIntegerSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    intArgs.put(elementId, 0);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  private void parseStringSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    stringArgs.put(elementId, &quot;&quot;);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.equals(&quot;*&quot;);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBooleanSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.length() == 0;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isIntegerSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.equals(&quot;#&quot;);</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (first draft)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfea" class="pf w1 h2" data-page-no="ea"><div class="pc pcea w1 h2"><img class="bi xd yf07 wc h95" alt="" src="bgea.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">203<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseArguments() throws ArgsException {</div><div class="t m5 x9a h2f y4ba ffb fs10 fc0 sc0 ls0 ws690">for (currentArgument = 0; currentArgument &lt; args.length; currentArgument++) </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      String arg = args[currentArgument];</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgument(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    if (arg.startsWith(&quot;-&quot;))</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      parseElements(arg);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElements(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 1; i &lt; arg.length(); i++)</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      parseElement(arg.charAt(i));</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    if (setArgument(argChar))</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    else {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      unexpectedArguments.add(argChar);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.UNEXPECTED_ARGUMENT;</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanArg(argChar))</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(argChar, true);</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringArg(argChar))</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      setStringArg(argChar);</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    else if (isIntArg(argChar))</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      setIntArg(argChar);</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  private boolean isIntArg(char argChar) {return intArgs.containsKey(argChar);}</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">      parameter = args[currentArgument];</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">      intArgs.put(argChar, new Integer(parameter));</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (first draft)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfeb" class="pf w1 h2" data-page-no="eb"><div class="pc pceb w1 h2"><img class="bi xd yf07 wc h95" alt="" src="bgeb.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">204<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      stringArgs.put(argChar, args[currentArgument]);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringArg(char argChar) {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    return stringArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(char argChar, boolean value) {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(argChar, value);</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBooleanArg(char argChar) {</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  public int cardinality() {</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.size();</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  public String usage() {</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() &gt; 0)</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;-[&quot; + schema + &quot;]&quot;;</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() throws Exception {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    switch (errorCode) {</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      case OK:</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">        throw new Exception(&quot;TILT: Should not get here.&quot;);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">      case UNEXPECTED_ARGUMENT:</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">        return unexpectedArgumentMessage();</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_STRING:</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (first draft)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfec" class="pf w1 h2" data-page-no="ec"><div class="pc pcec w1 h2"><img class="bi xd yca8 wc h7e" alt="" src="bgec.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">205<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_INTEGER:</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects an integer but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_INTEGER:</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find integer parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  private String unexpectedArgumentMessage() {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer message = new StringBuffer(&quot;Argument(s) -&quot;);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    for (char c : unexpectedArguments) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      message.append(c);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    message.append(&quot; unexpected.&quot;);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    return message.toString();</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  private boolean falseIfNull(Boolean b) {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    return b != null &amp;&amp; b;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  private int zeroIfNull(Integer i) {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    return i == null ? 0 : i;</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  private String blankIfNull(String s) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    return s == null ? &quot;&quot; : s;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    return blankIfNull(stringArgs.get(arg));</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    return zeroIfNull(intArgs.get(arg));</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    return falseIfNull(booleanArgs.get(arg));</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  public boolean has(char arg) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.contains(arg);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  public boolean isValid() {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  private class ArgsException extends Exception {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-8 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (first draft)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfed" class="pf w1 h2" data-page-no="ed"><div class="pc pced w1 h2"><img class="bi xd ybda wc h9b" alt="" src="bged.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">206<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws1ff">I hope your initial reaction to this mass of code is “I’m certainly glad he didn’t lea<span class="_ _4"></span>ve it</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws691">like that!” If you feel like this, then remember that’<span class="_ _1"></span>s ho<span class="_ _4"></span>w other people are going to feel</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws0">about code that you leav<span class="_ _4"></span>e in rough-draft form. </div><div class="t m0 x74 h1d y1fb ffd fs3 fc0 sc0 ls0 ws40b">Actually “rough draft” is probably the kindest thing you can say about this code. It’<span class="_ _1"></span>s</div><div class="t m0 xd h1d y1bd ffd fs3 fc0 sc0 ls0 ws10c">clearly a work in progress. <span class="_ _4"></span>The sheer number of instance variables is daunting. <span class="_ _4"></span>The odd</div><div class="t m0 xd h1d y1be ffd fs3 fc0 sc0 ls0 ws4d1">strings like </div><div class="t m5 xb3 h2f y1be ffb fs10 fc0 sc0 ls19 ws0">“TILT</div><div class="t m0 x3a h1d y1be ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x6 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">”</div><div class="t m0 xf2 h1d y1be ffd fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x4 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">HashSets</div><div class="t m0 xa2 h1d y1be ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x77 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">TreeSets</div><div class="t m0 x67 h1d y1be ffd fs3 fc0 sc0 ls0 ws4d1">, and the </div><div class="t m5 x40 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">try-catch-catch</div><div class="t m0 x6b h1d y1be ffd fs3 fc0 sc0 ls0 ws4d1">blocks all add up to</div><div class="t m0 xd h1d y19a ffd fs3 fc0 sc0 ls0 ws0">a festering pile.</div><div class="t m0 x74 h1d y206 ffd fs3 fc0 sc0 ls0 ws67">I had not wanted to write a festering pile. Indeed, I was trying to k<span class="_ _4"></span>eep things reason-</div><div class="t m0 xd h1d y207 ffd fs3 fc0 sc0 lsc ws334">ably well organized. <span class="_ _0"></span>Y<span class="_ _0"></span>ou can probably tell that from my choice of function and v<span class="_ _4"></span>ariable</div><div class="t m0 xd h1d y1fc ffd fs3 fc0 sc0 ls0 ws692">names and the fact that there is a crude structure to the program. But, clearly<span class="_ _1"></span>, I had let the</div><div class="t m0 xd h1d y208 ffd fs3 fc0 sc0 ls0 ws0">problem get aw<span class="_ _4"></span>ay from me. </div><div class="t m0 x74 h1d y209 ffd fs3 fc0 sc0 ls0 ws3a0">The mess built gradually<span class="_ _0"></span>. Earlier versions had not been nearly so nasty<span class="_ _1"></span>. For example,</div><div class="t m0 xd h1d y20a ffd fs3 fc0 sc0 ls0 ws0">Listing 14-9 shows an earlier v<span class="_ _4"></span>ersion in which only </div><div class="t m5 xea h2f yf40 ffb fs10 fc0 sc0 ls0 ws0">Boolean</div><div class="t m0 xf1 h1d yf40 ffd fs3 fc0 sc0 ls0 ws0"> arguments were w<span class="_ _4"></span>orking.</div><div class="t m0 x74 h1c ybba ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-9 </div><div class="t m0 x74 h36 yd26 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean only)</div><div class="t m5 x74 h2f yf41 ffb fs10 fc0 sc0 ls0 ws0">package com.objectmentor.utilities.getopts;</div><div class="t m5 x74 h2f yf42 ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f yf43 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f yf44 ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h2f yf45 ffb fs10 fc0 sc0 ls0 ws0">  private String[] args;</div><div class="t m5 x74 h2f yf46 ffb fs10 fc0 sc0 ls0 ws0">  private boolean valid;</div><div class="t m5 x74 h2f yf47 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; unexpectedArguments = new TreeSet&lt;Character&gt;();</div><div class="t m5 x74 h2f yf48 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, Boolean&gt; booleanArgs = </div><div class="t m5 x74 h2f yf49 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, Boolean&gt;();</div><div class="t m5 x74 h2f yf4a ffb fs10 fc0 sc0 ls0 ws0">  private int numberOfArguments = 0;</div><div class="t m5 x74 h2f yf4b ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) {</div><div class="t m5 x74 h2f yf4c ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f yf4d ffb fs10 fc0 sc0 ls0 ws0">    this.args = args;</div><div class="t m5 x74 h2f yf4e ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f yf4f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf50 ffb fs10 fc0 sc0 ls0 ws0">  public boolean isValid() {</div><div class="t m5 x74 h2f yf51 ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f yf52 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf53 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() {</div><div class="t m5 x74 h2f yf54 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; args.length == 0)</div><div class="t m5 x74 h2f yf55 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f yf56 ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f yf57 ffb fs10 fc0 sc0 ls0 ws0">    parseArguments();</div><div class="t m5 x74 h2f yf58 ffb fs10 fc0 sc0 ls0 ws0">    return unexpectedArguments.size() == 0;</div><div class="t m5 x74 h2f yf59 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf5a ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() {</div><div class="t m5 x74 h2f yf5b ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;)) {</div><div class="t m5 x74 h2f yf5c ffb fs10 fc0 sc0 ls0 ws0">      parseSchemaElement(element);</div><div class="t m5 x74 h2f yf5d ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfee" class="pf w1 h2" data-page-no="ee"><div class="pc pcee w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bgee.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">207<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) {</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    if (element.length() == 1) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      parseBooleanSchemaElement(element);</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private void parseBooleanSchemaElement(String element) {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    char c = element.charAt(0);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    if (Character.isLetter(c)) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      booleanArgs.put(c, false);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseArguments() {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    for (String arg : args)</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgument(String arg) {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    if (arg.startsWith(&quot;-&quot;))</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      parseElements(arg);</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  private void parseElements(String arg) {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 1; i &lt; arg.length(); i++)</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      parseElement(arg.charAt(i));</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    if (isBoolean(argChar)) {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">      numberOfArguments++;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(argChar, true);</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    } else</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      unexpectedArguments.add(argChar);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(char argChar, boolean value) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(argChar, value);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBoolean(char argChar) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  public int cardinality() {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    return numberOfArguments;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  public String usage() {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() &gt; 0)</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">       return &quot;-[&quot;+schema+&quot;]&quot;;</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-9 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean only)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfef" class="pf w1 h2" data-page-no="ef"><div class="pc pcef w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bgef.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">208<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d yf5e ffd fs3 fc0 sc0 ls0 ws255">Although you can ﬁnd plenty to complain about in this code, it’<span class="_ _1"></span>s really not that bad.</div><div class="t m0 xd h1d ycc3 ffd fs3 fc0 sc0 ls0 ws89">It’<span class="_ _1"></span>s compact and simple and easy to understand. Howe<span class="_ _4"></span>ver<span class="_ _4"></span>, within this code it is easy to see</div><div class="t m0 xd h1d ycc4 ffd fs3 fc0 sc0 ls0 ws0">the seeds of the later festering pile. It’<span class="_ _1"></span>s quite clear how this gre<span class="_ _4"></span>w into the latter mess.</div><div class="t m0 x74 h1d y807 ffd fs3 fc0 sc0 ls0 ws693">Notice that the latter mess has only two more ar<span class="_ _4"></span>gument types than this: </div><div class="t m5 x93 h2f y807 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x8c h1d y807 ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y808 ffb fs10 fc0 sc0 ls0 ws0">integer</div><div class="t m0 x95 h1d y808 ffd fs3 fc0 sc0 lsc ws202">. The addition of just tw<span class="_ _4"></span>o more argument types had a massi<span class="_ _4"></span>vely negati<span class="_ _4"></span>ve impact on</div><div class="t m0 xd h1d yf5f ffd fs3 fc0 sc0 ls0 ws393">the code. It con<span class="_ _4"></span>verted it from something that would ha<span class="_ _4"></span>ve been reasonably maintainable</div><div class="t m0 xd h1d ycc6 ffd fs3 fc0 sc0 ls0 ws0">into something that I would e<span class="_ _4"></span>xpect to become riddled with bugs and warts. </div><div class="t m0 x74 h1d y7bd ffd fs3 fc0 sc0 ls0 ws4e6">I added the two ar<span class="_ _4"></span>gument types incrementally<span class="_ _1"></span>. First, I added the </div><div class="t m5 xaf h2f y7bd ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 xd3 h1d y7bd ffd fs3 fc0 sc0 ls0 ws0">argument,</div><div class="t m0 xd h1d yd95 ffd fs3 fc0 sc0 ls0 ws0">which yielded this: </div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    if (unexpectedArguments.size() &gt; 0) {</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">      return unexpectedArgumentMessage();</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    } else</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  private String unexpectedArgumentMessage() {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer message = new StringBuffer(&quot;Argument(s) -&quot;);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    for (char c : unexpectedArguments) {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      message.append(c);</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    message.append(&quot; unexpected.&quot;);</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    return message.toString();</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.get(arg);</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y583 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-10 </div><div class="t m0 x74 h36 y3e3 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean and String)</div><div class="t m5 x74 h2f yf60 ffb fs10 fc0 sc0 ls0 ws0">package com.objectmentor.utilities.getopts;</div><div class="t m5 x74 h2f yf61 ffb fs10 fc0 sc0 ls0 ws0">import java.text.ParseException;</div><div class="t m5 x74 h2f yf62 ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f yf63 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f yf64 ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h2f yf65 ffb fs10 fc0 sc0 ls0 ws0">  private String[] args;</div><div class="t m5 x74 h2f yf66 ffb fs10 fc0 sc0 ls0 ws0">  private boolean valid = true;</div><div class="t m5 x74 h2f yf67 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; unexpectedArguments = new TreeSet&lt;Character&gt;();</div><div class="t m5 x74 h2f yf68 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, Boolean&gt; booleanArgs = </div><div class="t m5 x74 h2f yf69 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, Boolean&gt;();</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-9 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean only)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff0" class="pf w1 h2" data-page-no="f0"><div class="pc pcf0 w1 h2"><img class="bi xd yf6a wc h9c" alt="" src="bgf0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">209<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, String&gt; stringArgs = </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, String&gt;();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  private int currentArgument;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgument = &apos;\0&apos;;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  enum ErrorCode {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING}</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ParseException {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    this.args = args;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() throws ParseException {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; args.length == 0)</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    parseArguments();</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() throws ParseException {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;)) {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">      if (element.length() &gt; 0) {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">        String trimmedElement = element.trim();</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">        parseSchemaElement(trimmedElement);</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws ParseException {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanSchemaElement(elementTail))</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      parseBooleanSchemaElement(elementId);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringSchemaElement(elementTail))</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      parseStringSchemaElement(elementId);</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws ParseException {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId)) {</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">        &quot;Bad character:&quot; + elementId + &quot;in Args format: &quot; + schema, 0);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  private void parseStringSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">    stringArgs.put(elementId, &quot;&quot;);</div><div class="t m5 x74 h2f y6b5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-10 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean and String)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff1" class="pf w1 h2" data-page-no="f1"><div class="pc pcf1 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bgf1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">210<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.equals(&quot;*&quot;);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBooleanSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.length() == 0;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(elementId, false);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseArguments() {</div><div class="t m5 x9a h2f y4c4 ffb fs10 fc0 sc0 ls0 ws690">for (currentArgument = 0; currentArgument &lt; args.length; currentArgument++) </div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      String arg = args[currentArgument];</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgument(String arg) {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    if (arg.startsWith(&quot;-&quot;))</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      parseElements(arg);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElements(String arg) {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 1; i &lt; arg.length(); i++)</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">      parseElement(arg.charAt(i));</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    if (setArgument(argChar))</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    else {</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      unexpectedArguments.add(argChar);</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  private boolean setArgument(char argChar) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    boolean set = true;</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    if (isBoolean(argChar))</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(argChar, true);</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    else if (isString(argChar))</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">      setStringArg(argChar, &quot;&quot;);</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      set = false;</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    return set;</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(char argChar, String s) {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-10 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean and String)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff2" class="pf w1 h2" data-page-no="f2"><div class="pc pcf2 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bgf2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">211<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      stringArgs.put(argChar, args[currentArgument]);</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      errorArgument = argChar;</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isString(char argChar) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    return stringArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(char argChar, boolean value) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(argChar, value);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBoolean(char argChar) {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  public int cardinality() {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.size();</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  public String usage() {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() &gt; 0)</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;-[&quot; + schema + &quot;]&quot;;</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() throws Exception {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    if (unexpectedArguments.size() &gt; 0) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      return unexpectedArgumentMessage();</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    } else</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      switch (errorCode) {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">        case MISSING_STRING:</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">          return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">                               errorArgument);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">        case OK:</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">          throw new Exception(&quot;TILT: Should not get here.&quot;);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  private String unexpectedArgumentMessage() {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer message = new StringBuffer(&quot;Argument(s) -&quot;);</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">    for (char c : unexpectedArguments) {</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">      message.append(c);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    message.append(&quot; unexpected.&quot;);</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    return message.toString();</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-10 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean and String)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff3" class="pf w1 h2" data-page-no="f3"><div class="pc pcf3 w1 h2"><img class="bi xd y59b wc h3d" alt="" src="bgf3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">212<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y59c ffd fs3 fc0 sc0 ls0 wscd">Y<span class="_ _0"></span>ou can see that this is starting to get out of hand. It’<span class="_ _1"></span>s still not horrible, but the mess is</div><div class="t m0 xd h1d y59d ffd fs3 fc0 sc0 ls0 ws694">certainly starting to gro<span class="_ _4"></span>w<span class="_ _4"></span>. It’<span class="_ _1"></span>s a pile, but it’<span class="_ _1"></span>s not festering quite yet. It took the addition of</div><div class="t m0 xd h1d yf6b ffd fs3 fc0 sc0 ls0 ws0">the integer ar<span class="_ _4"></span>gument type to get this pile really fermenting and festering.</div><div class="t m0 xd h11 yf6c ff1 fs7 fc0 sc0 ls0 ws0">So I Stopped</div><div class="t m0 xd h14 yf6d ff8 fs3 fc0 sc0 ls0 ws2a0">I had at least tw<span class="_ _4"></span>o more argument types to add<span class="_ _1"></span>, and I could tell that they w<span class="_ _1"></span>ould make things</div><div class="t m0 xd h14 yf6e ff8 fs3 fc0 sc0 lsd ws695">much w<span class="_ _4"></span>orse. If I bulldozed m<span class="_ _4"></span>y wa<span class="_ _1"></span>y forward<span class="_ _1"></span>, I could probabl<span class="_ _4"></span>y get them to w<span class="_ _4"></span>ork, but I’<span class="_ _2"></span>d</div><div class="t m0 xd h14 yf6f ff8 fs3 fc0 sc0 ls0 ws498">lea<span class="_ _4"></span>ve behind a mess that w<span class="_ _4"></span>as too large to ﬁx. If the structure of this code was e<span class="_ _4"></span>ver going to</div><div class="t m0 xd h14 yf70 ff8 fs3 fc0 sc0 ls0 ws0">be maintainable, no<span class="_ _1"></span>w was the time to ﬁx it.</div><div class="t m0 x74 h14 yf71 ff8 fs3 fc0 sc0 ls0 ws22">So I stopped adding features and started ref<span class="_ _8"></span>actoring. Ha<span class="_ _4"></span>ving just added the </div><div class="t m5 x7a h2f yf71 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x8c h14 yf71 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">integer</div><div class="t m0 x9a h14 y1f0 ff8 fs3 fc0 sc0 ls0 ws5c4">arguments, I kne<span class="_ _4"></span>w that each argument type required ne<span class="_ _4"></span>w code in three major</div><div class="t m0 xd h14 y1f1 ff8 fs3 fc0 sc0 ls0 ws301">places. First, each ar<span class="_ _4"></span>gument type required some wa<span class="_ _1"></span>y to parse its schema element in order</div><div class="t m0 xd h14 y1f2 ff8 fs3 fc0 sc0 ls0 ws54b">to select the </div><div class="t m5 x41 h2f y73a ffb fs10 fc0 sc0 ls0 ws0">HashMap</div><div class="t m0 x9 h14 y73a ff8 fs3 fc0 sc0 ls0 ws54b">for that type. Next, each ar<span class="_ _4"></span>gument type needed to be parsed in the</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws2d1">command-line strings and con<span class="_ _4"></span>verted to its tr<span class="_ _8"></span>ue type. Finall<span class="_ _4"></span>y<span class="_ _0"></span>, each argument type needed a</div><div class="t m5 xd h2f y470 ffb fs10 fc0 sc0 ls0 ws0">getXXX</div><div class="t m0 x3e h14 y470 ff8 fs3 fc0 sc0 ls0 ws0"> method so that it could be returned to the caller as its tr<span class="_ _8"></span>ue type. </div><div class="t m0 x74 h14 yb78 ff8 fs3 fc0 sc0 ls0 ws92">Many dif<span class="_ _1"></span>ferent types, all with similar methods—that sounds like a class to me. <span class="_ _4"></span>And so</div><div class="t m0 xd h14 yb79 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f yb79 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xed h14 yb79 ff8 fs3 fc0 sc0 ls0 ws0"> concept w<span class="_ _4"></span>as bor<span class="_ _8"></span>n.</div><div class="t m0 xd h11 yf72 ff1 fs7 fc0 sc0 ls0 ws0">On Incr<span class="_ _4"></span>ementalism</div><div class="t m0 xd h1d ye40 ffd fs3 fc0 sc0 ls70 ws53a">One of the best ways to ruin a program is to make massi<span class="_ _4"></span>ve changes to its structure in the name of</div><div class="t m0 xd h1d ye41 ffd fs3 fc0 sc0 ls70 ws696">improv<span class="_ _4"></span>ement. Some programs nev<span class="_ _4"></span>er recover from such “impro<span class="_ _4"></span>vements.<span class="_ _1"></span>” The problem is that</div><div class="t m0 xd h1d yf73 ffd fs3 fc0 sc0 ls70 ws0">it’<span class="_ _1"></span>s very hard to get the program working the same way it w<span class="_ _4"></span>orked before the “improvement.<span class="_ _0"></span>” </div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return falseIfNull(booleanArgs.get(arg));</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private boolean falseIfNull(Boolean b) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return b == null ? false : b;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    return blankIfNull(stringArgs.get(arg));</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  private String blankIfNull(String s) {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    return s == null ? &quot;&quot; : s;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  public boolean has(char arg) {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.contains(arg);</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  public boolean isValid() {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-10 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (Boolean and String)</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:277.728010px;width:65.352000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:96.728110px;width:99.302000px;height:13.367900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff4" class="pf w1 h2" data-page-no="f4"><div class="pc pcf4 w1 h2"><img class="bi xd yf74 wc h55" alt="" src="bgf4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">213<span class="_ _10"></span><span class="ff1">Args:<span class="_ _4"></span> <span class="_ _1"></span>The Rough Draft</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws3ee">T<span class="_ _0"></span>o avoid this, I use the discipline of T<span class="_ _0"></span>est-Driv<span class="_ _4"></span>en Development (TDD). One of the cen-</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws59e">tral doctrines of this approach is to keep the system running at all times. In other words,</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws697">using TDD, I am not allo<span class="_ _4"></span>wed to make a change to the system that breaks that system.</div><div class="t m0 xd h1d y197 ffd fs3 fc0 sc0 ls0 ws0">Every change I mak<span class="_ _4"></span>e must keep the system working as it worked before.</div><div class="t m0 x74 h1d y1bd ffd fs3 fc0 sc0 ls0 ws40">T<span class="_ _0"></span>o achieve this, I need a suite of automated tests that I can run on a whim and that v<span class="_ _4"></span>er-</div><div class="t m0 xd h1d y1be ffd fs3 fc0 sc0 ls0 ws48f">iﬁes that the behavior of the system is unchanged. F<span class="_ _4"></span>or the </div><div class="t m5 x69 h2f y1be ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x51 h1d y1be ffd fs3 fc0 sc0 ls0 ws48f">class I had created a suite</div><div class="t m0 xd h1d y19a ffd fs3 fc0 sc0 ls0 ws618">of unit and acceptance tests while I was b<span class="_ _4"></span>uilding the festering pile. The unit tests were</div><div class="t m0 xd h1d y19b ffd fs3 fc0 sc0 ls0 ws698">written in </div><div class="t m5 x80 h2f y19b ffb fs10 fc0 sc0 ls0 ws0">Java</div><div class="t m0 xe h1d y19b ffd fs3 fc0 sc0 ls0 ws698">and administered by </div><div class="t m5 x77 h2f y19b ffb fs10 fc0 sc0 ls0 ws0">JUnit</div><div class="t m0 x22 h1d y19b ffd fs3 fc0 sc0 ls0 ws698">. The acceptance tests were written as wiki pages</div><div class="t m0 xd h1d y19c ffd fs3 fc0 sc0 ls0 ws0">in</div><div class="t m5 xcd h2f y19c ffb fs10 fc0 sc0 ls0 ws0">FitNesse</div><div class="t m0 xb3 h1d y19c ffd fs3 fc0 sc0 ls0 ws441">. I could run these tests any time I w<span class="_ _4"></span>anted, and if they passed, I was conﬁdent</div><div class="t m0 xd h1d y19d ffd fs3 fc0 sc0 ls0 ws0">that the system was working as I speciﬁed.</div><div class="t m0 x74 h1d y208 ffd fs3 fc0 sc0 ls0 ws692">So I proceeded to make a lar<span class="_ _4"></span>ge number of very tiny changes. Each change mo<span class="_ _4"></span>ved the</div><div class="t m0 xd h1d y21a ffd fs3 fc0 sc0 ls0 ws156">structure of the system to<span class="_ _4"></span>ward the </div><div class="t m5 x20 h2f y3ea ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x27 h1d y3ea ffd fs3 fc0 sc0 ls0 ws156">concept. <span class="_ _1"></span>And yet each change kept</div><div class="t m0 xd h1d y3eb ffd fs3 fc0 sc0 ls0 ws699">the system working. <span class="_ _4"></span>The ﬁrst change I made was to add the skeleton of the</div><div class="t m5 xd h2f y3ed ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 x4d h1d y3ed ffd fs3 fc0 sc0 ls0 ws0"> to the end of the festering pile (Listing 14-11).</div><div class="t m0 x74 h1d yf75 ffd fs3 fc0 sc0 ls0 ws35f">Clearly<span class="_ _1"></span>, this wasn’t going to break an<span class="_ _4"></span>ything. So then I made the simplest modiﬁcation</div><div class="t m0 xd h1d yf76 ffd fs3 fc0 sc0 ls0 ws522">I could, one that would break as little as possible. I changed the </div><div class="t m5 xb9 h2f y395 ffb fs10 fc0 sc0 ls0 ws0">HashMap</div><div class="t m0 xa9 h1d y395 ffd fs3 fc0 sc0 ls0 ws522">for the </div><div class="t m5 x64 h2f y395 ffb fs10 fc0 sc0 ls0 ws0">Boolean</div><div class="t m0 xd h1d y396 ffd fs3 fc0 sc0 ls0 ws0">arguments to tak<span class="_ _4"></span>e an </div><div class="t m5 x5 h2f y396 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x33 h1d y396 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f yf77 ffb fs10 fc0 sc0 ls0 ws0">private Map&lt;Character, <span class="_ _4"></span><span class="ffc">ArgumentMarshaler<span class="ffb">&gt; booleanArgs = </span></span></div><div class="t m5 x74 h2f yf78 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, <span class="_ _4"></span><span class="ffc">ArgumentMarshaler<span class="ffb">&gt;();</span></span></div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">This broke a fe<span class="_ _4"></span>w statements, which I quickl<span class="_ _4"></span>y ﬁxed.</div><div class="t m5 x74 h2f yec9 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f yf79 ffb fs10 fc0 sc0 ls0 ws0">private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x74 h2f yf7a ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(elementId, <span class="_ _4"></span><span class="ffc">new BooleanArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f yf7b ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf7c ffb fs10 fc0 sc0 ls0 ws0">..</div><div class="t m0 x74 h1c yeb4 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-11</div><div class="t m0 x74 h36 yf7d ffc fs3 fc0 sc0 ls0 ws0">ArgumentMarshaller appended to Args.java</div><div class="t m5 x74 h2f yf7e ffb fs10 fc0 sc0 ls0 ws0">private class ArgumentMarshaler {</div><div class="t m5 x74 h2f yf7f ffb fs10 fc0 sc0 ls0 ws0">    private boolean booleanValue = false;</div><div class="t m5 x74 h2f yf80 ffb fs10 fc0 sc0 ls0 ws0">    public void setBoolean(boolean value) {</div><div class="t m5 x74 h2f yf81 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = value;</div><div class="t m5 x74 h2f yf82 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yf83 ffb fs10 fc0 sc0 ls0 ws0">    public boolean getBoolean() {return booleanValue;}</div><div class="t m5 x74 h2f yf84 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf85 ffb fs10 fc0 sc0 ls0 ws0">  private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yf86 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf87 ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yf88 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf89 ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yf8a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf8b ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff5" class="pf w1 h2" data-page-no="f5"><div class="pc pcf5 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">214<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(char argChar, boolean value) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.<span class="ffc">get</span>(argChar)<span class="_ _4"></span><span class="ffc">.setBoolean<span class="ffb">(value);</span></span></div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    return falseIfNull(booleanArgs.get(arg).<span class="_ _1"></span><span class="ffc">getBoolean()<span class="ffb">);</span></span></div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d yb6b ffd fs3 fc0 sc0 ls0 ws81">Notice how these changes are in e<span class="_ _4"></span>xactly the areas that I mentioned before: the </div><div class="t m5 x36 h2f yb6b ffb fs10 fc0 sc0 ls0 ws0">parse</div><div class="t m0 x56 h1d yb6b ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y681 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x3b h1d y681 ffd fs3 fc0 sc0 ls0 wsf1">, and </div><div class="t m5 x3f h2f y681 ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x41 h1d y681 ffd fs3 fc0 sc0 ls0 wsf1">for the argument type. Unfortunately<span class="_ _0"></span>, small as this change was, some of the</div><div class="t m0 xd h1d y408 ffd fs3 fc0 sc0 ls0 ws69a">tests started failing. If you look carefully at </div><div class="t m5 x67 h2f y408 ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 x17 h1d y408 ffd fs3 fc0 sc0 ls0 ws69a">, you’ll see that if you call it with</div><div class="t m5 xd h2f y409 ffb fs10 fc0 sc0 ls0 ws0">&apos;y</div><div class="t m0 x37 h1d y409 ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xcd h2f y409 ffb fs10 fc0 sc0 ls0 ws0">&apos;</div><div class="t m0 x2b h1d y409 ffd fs3 fc0 sc0 ls0 ws69b">but there is no </div><div class="t m5 xba h2f y409 ffb fs10 fc0 sc0 ls0 ws0">y</div><div class="t m0 x9 h1d y409 ffd fs3 fc0 sc0 ls0 ws69b">argument, then </div><div class="t m5 x26 h2f y409 ffb fs10 fc0 sc0 ls0 ws0">booleanArgs.get(&apos;y&apos;)</div><div class="t m0 xf1 h1d y409 ffd fs3 fc0 sc0 ls0 ws69b">will return </div><div class="t m5 xac h2f y409 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x5e h1d y409 ffd fs3 fc0 sc0 ls0 ws69b">, and the func-</div><div class="t m0 xd h1d y846 ffd fs3 fc0 sc0 ls0 ws69c">tion will throw a </div><div class="t m5 xbc h2f y846 ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 x31 h1d y846 ffd fs3 fc0 sc0 ls0 ws2b2">. The </div><div class="t m5 xbe h2f y846 ffb fs10 fc0 sc0 ls0 ws0">falseIfNull</div><div class="t m0 x9f h1d y846 ffd fs3 fc0 sc0 ls0 ws69c">function had been used to protect</div><div class="t m0 xd h1d y92b ffd fs3 fc0 sc0 lsc ws3f">against this, but the change I made caused that function to become irrele<span class="_ _4"></span>v<span class="_ _4"></span>ant.</div><div class="t m0 x74 h1d y1e0 ffd fs3 fc0 sc0 ls0 ws69d">Incrementalism demanded that I get this working quickly before making an<span class="_ _4"></span>y other</div><div class="t m0 xd h1d y1e1 ffd fs3 fc0 sc0 ls0 wsaa">changes. Indeed, the ﬁx was not too dif<span class="_ _4"></span>ﬁcult. I just had to move the check for </div><div class="t m5 x63 h2f y1e1 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 x71 h1d y1e1 ffd fs3 fc0 sc0 ls0 wsaa">. It was</div><div class="t m0 xd h1d y1e2 ffd fs3 fc0 sc0 ls0 ws0">no longer the </div><div class="t m5 x28 h2f y636 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 xed h1d y636 ffd fs3 fc0 sc0 ls0 ws0">being</div><div class="t m5 x57 h2f y636 ffb fs10 fc0 sc0 ls0 ws0"> null </div><div class="t m0 xc h1d y636 ffd fs3 fc0 sc0 ls0 ws0">that I needed to check; it was the </div><div class="t m5 x79 h2f y636 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 x16 h1d y636 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1d y40b ffd fs3 fc0 sc0 ls0 ws299">First, I remov<span class="_ _4"></span>ed the </div><div class="t m5 xa h2f y40b ffb fs10 fc0 sc0 ls0 ws0">falseIfNull</div><div class="t m0 x26 h1d y40b ffd fs3 fc0 sc0 ls0 ws299">call in the </div><div class="t m5 x68 h2f y40b ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 xae h1d y40b ffd fs3 fc0 sc0 ls0 ws299">function. It was useless no<span class="_ _4"></span>w<span class="_ _1"></span>, so</div><div class="t m0 xd h1d y40c ffd fs3 fc0 sc0 ls0 ws1b">I also eliminated the function itself. The tests still f<span class="_ _4"></span>ailed in the same way<span class="_ _1"></span>, so I was conﬁ-</div><div class="t m0 xd h1d yb6f ffd fs3 fc0 sc0 ls0 ws0">dent that I hadn’t introduced an<span class="_ _4"></span>y new errors. </div><div class="t m5 x52 h2f yf8c ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f yf8d ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.get(arg).getBoolean();</div><div class="t m5 x74 h2f yf8e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y412 ff8 fs3 fc0 sc0 ls0 ws446">Next, I split the function into tw<span class="_ _1"></span>o lines and put the </div><div class="t m5 xd2 h2f y412 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 xaf h14 y412 ff8 fs3 fc0 sc0 ls0 ws446">into its o<span class="_ _4"></span>wn vari-</div><div class="t m0 xd h14 y413 ff8 fs3 fc0 sc0 ls0 ws3b3">able named </div><div class="t m5 x1e h2f y413 ffb fs10 fc0 sc0 ls0 ws0">argumentMarshaller</div><div class="t m0 x1c h14 y413 ff8 fs3 fc0 sc0 ls0 ws3b3">. I didn’<span class="_ _1"></span>t care for the long variable name; it w<span class="_ _4"></span>as badl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y414 ff8 fs3 fc0 sc0 ls0 ws0">redundant and cluttered up the function. So I shortened it to </div><div class="t m5 xc9 h2f y414 ffb fs10 fc0 sc0 ls0 ws0">am</div><div class="t m0 xca h14 y414 ff8 fs3 fc0 sc0 ls0 ws0"> [N5]. </div><div class="t m5 x52 h2f yf8f ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f yf90 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler <span class="_ _4"></span><span class="ffc">am<span class="ffb"> = booleanArgs.get(arg);</span></span></div><div class="t m5 x74 h2f yf91 ffb fs10 fc0 sc0 ls0 ws0">    return <span class="ffc">am</span>.getBoolean();</div><div class="t m5 x74 h2f yf92 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yf93 ff8 fs3 fc0 sc0 ls0 ws0">And then I put in the null detection lo<span class="_ _4"></span>gic.</div><div class="t m5 x52 h2f yf94 ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f yf95 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = booleanArgs.get(arg);</div><div class="t m5 x74 h2f yf96 ffb fs10 fc0 sc0 ls0 ws0">    return <span class="ffc">am != null &amp;&amp;<span class="_ _4"></span><span class="ffb"> am.getBoolean();</span></span></div><div class="t m5 x74 h2f yf97 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h17 yf98 ff1 fs9 fc0 sc0 ls0 ws20d">String Arguments</div><div class="t m0 xd h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">Adding</div><div class="t m5 x75 h2f y5b6 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x39 h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws402">arguments w<span class="_ _4"></span>as very similar to adding </div><div class="t m5 x88 h2f y5b6 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 xca h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws402">arguments. I had to change</div><div class="t m0 xd h14 y42e ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y42e ffb fs10 fc0 sc0 ls0 ws0">HashMap</div><div class="t m0 x4c h14 y42e ff8 fs3 fc0 sc0 ls0 ws300">and get the </div><div class="t m5 x9e h2f y42e ffb fs10 fc0 sc0 ls0 ws0">parse</div><div class="t m0 x5d h14 y42e ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x8f h2f y42e ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x8 h14 y42e ff8 fs3 fc0 sc0 ls0 ws300">, and </div><div class="t m5 x5c h2f y42e ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 xc4 h14 y42e ff8 fs3 fc0 sc0 ls0 ws300">functions w<span class="_ _4"></span>orking. <span class="_ _4"></span>There shouldn’<span class="_ _1"></span>t be any sur-</div><div class="t m0 xd h14 y31b ff8 fs3 fc0 sc0 ls0 ws5a1">prises in what follo<span class="_ _1"></span>ws except, perhaps, that I seem to be putting all the marshalling imple-</div><div class="t m0 xd h14 y31c ff8 fs3 fc0 sc0 ls0 ws0">mentation in the </div><div class="t m5 x3a h2f y31c ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 x77 h14 y31c ff8 fs3 fc0 sc0 lsd wsef"> base class instead of distributing it to the deriv<span class="_ _1"></span>atives.</div><div class="t m5 x52 h2f yf99 ffb fs10 fc0 sc0 ls0 ws0">private Map&lt;Character<span class="_ _4"></span><span class="ffc">, ArgumentMarshaler<span class="ffb">&gt; stringArgs = </span></span></div><div class="t m5 x74 h2f yf9a ffb fs10 fc0 sc0 ls0 ws0">      new HashMap&lt;Character<span class="_ _4"></span><span class="ffc">, ArgumentMarshaler<span class="ffb">&gt;();</span></span></div><div class="t m5 x74 h2f yf9b ffb fs10 fc0 sc0 ls0 ws0">...</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:166.945010px;width:106.389000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff6" class="pf w1 h2" data-page-no="f6"><div class="pc pcf6 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">215<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private void parseStringSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    stringArgs.put(elementId<span class="_ _4"></span><span class="ffc">, new StringArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">      stringArgs<span class="ffc">.get<span class="_ _4"></span><span class="ffb">(argChar)<span class="ffc">.setString</span>(args[currentArgument]);</span></span></div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x9a h2f y635 ffc fs10 fc0 sc0 ls0 ws0">Args.ArgumentMarshaler am =<span class="_ _4"></span><span class="ffb"> stringArgs.get(arg);</span></div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">    return <span class="ffc">am == null ? &quot;&quot;<span class="_ _4"></span><span class="ffb"> : am.getString();</span></span></div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">  private class ArgumentMarshaler {</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">    private boolean booleanValue = false;</div><div class="t m5 x74 h46 yf9f ffc fs10 fc0 sc0 ls0 ws0">    private String stringValue;</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">    public void setBoolean(boolean value) {</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = value;</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">    public boolean getBoolean() {</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x9a h46 yfa6 ffc fs10 fc0 sc0 ls0 ws0">public void setString(String s) {</div><div class="t m5 x74 h46 yfa7 ffc fs10 fc0 sc0 ls0 ws0">      stringValue = s;</div><div class="t m5 x74 h46 yfa8 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 yfa9 ffc fs10 fc0 sc0 ls0 ws0">    public String getString() {</div><div class="t m5 x74 h46 yfaa ffc fs10 fc0 sc0 ls0 ws0">      return stringValue == null ? &quot;&quot; : stringValue;</div><div class="t m5 x74 h46 yfab ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y9fa ffd fs3 fc0 sc0 lsc ws26f">Again, these changes were made one at a time and in such a way that the tests kept</div><div class="t m0 xd h1d y9fb ffd fs3 fc0 sc0 lsc ws676">running, if not passing. <span class="_ _4"></span>When a test broke, I made sure to get it passing again before con-</div><div class="t m0 xd h1d y9fc ffd fs3 fc0 sc0 ls0 ws0">tinuing with the next change. </div><div class="t m0 x74 h1d yfad ffd fs3 fc0 sc0 ls0 ws154">By now you should be able to see my intent. Once I get all the current marshalling</div><div class="t m0 xd h1d yfae ffd fs3 fc0 sc0 ls0 ws69e">behavior into the </div><div class="t m5 xe4 h2f y1f3 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x26 h1d y1f3 ffd fs3 fc0 sc0 ls0 ws69e">base class, I’m going to start pushing that behavior</div><div class="t m0 xd h1d y1f4 ffd fs3 fc0 sc0 ls0 ws6c">do<span class="_ _4"></span>wn into the deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>es. This will allo<span class="_ _4"></span>w me to keep ev<span class="_ _4"></span>erything running while I gradually</div><div class="t m0 xd h1d y1f5 ffd fs3 fc0 sc0 ls0 ws0">change the shape of this program.</div><div class="t m0 x74 h1d y1d6 ffd fs3 fc0 sc0 ls0 ws69f">The obvious ne<span class="_ _4"></span>xt step was to mov<span class="_ _4"></span>e the </div><div class="t m5 x7e h2f y1d6 ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 x85 h1d y1d6 ffd fs3 fc0 sc0 ls0 ws69f">argument functionality into the</div><div class="t m5 xd h2f yfaf ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xe4 h1d yfaf ffd fs3 fc0 sc0 lsc ws3f">. <span class="_ _1"></span>Again, there weren’t any surprises.</div><div class="t m5 x74 h2f yfb0 ffb fs10 fc0 sc0 ls0 ws0">private Map&lt;Character<span class="_ _4"></span><span class="ffc">, ArgumentMarshaler<span class="ffb">&gt; intArgs = </span></span></div><div class="t m5 x74 h2f yfb1 ffb fs10 fc0 sc0 ls0 ws0">     new HashMap&lt;Character<span class="_ _4"></span><span class="ffc">, ArgumentMarshaler<span class="ffb">&gt;();</span></span></div><div class="t m5 x74 h2f yfb2 ffb fs10 fc0 sc0 ls0 ws0">...</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff7" class="pf w1 h2" data-page-no="f7"><div class="pc pcf7 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">216<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private void parseIntegerSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    intArgs.put(elementId, <span class="_ _4"></span><span class="ffc">new IntegerArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">      parameter = args[currentArgument];</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">      intArgs<span class="ffc">.get</span>(argChar)<span class="_ _4"></span><span class="ffc">.setInteger<span class="ffb">(Integer.parseInt(parameter));</span></span></div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">    } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf9f ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x9a h2f yfa0 ffc fs10 fc0 sc0 ls0 ws0">Args.ArgumentMarshaler am = <span class="_ _4"></span><span class="ffb">intArgs.get(arg);</span></div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">    return <span class="ffc">am == null ? 0<span class="_ _4"></span><span class="ffb"> : am.getInteger();</span></span></div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">  private class ArgumentMarshaler {</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">    private boolean booleanValue = false;</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue;</div><div class="t m5 x9a h46 yfb5 ffc fs10 fc0 sc0 ls0 ws0">private int integerValue;</div><div class="t m5 x74 h2f yfa7 ffb fs10 fc0 sc0 ls0 ws0">    public void setBoolean(boolean value) {</div><div class="t m5 x74 h2f yfa8 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = value;</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfaa ffb fs10 fc0 sc0 ls0 ws0">    public boolean getBoolean() {</div><div class="t m5 x74 h2f yfab ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb7 ffb fs10 fc0 sc0 ls0 ws0">    public void setString(String s) {</div><div class="t m5 x74 h2f yfb8 ffb fs10 fc0 sc0 ls0 ws0">      stringValue = s;</div><div class="t m5 x74 h2f yfb9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfba ffb fs10 fc0 sc0 ls0 ws0">    public String getString() {</div><div class="t m5 x74 h2f yfbb ffb fs10 fc0 sc0 ls0 ws0">      return stringValue == null ? &quot;&quot; : stringValue;</div><div class="t m5 x74 h2f yfbc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 yfbd ffc fs10 fc0 sc0 ls0 ws0">    public void setInteger(int i) {</div><div class="t m5 x74 h46 yfbe ffc fs10 fc0 sc0 ls0 ws0">      integerValue = i;</div><div class="t m5 x74 h46 yfbf ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 yfc0 ffc fs10 fc0 sc0 ls0 ws0">    public int getInteger() {</div><div class="t m5 x74 h46 yfc1 ffc fs10 fc0 sc0 ls0 ws0">      return integerValue;</div><div class="t m5 x74 h46 yfc2 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfc3 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff8" class="pf w1 h2" data-page-no="f8"><div class="pc pcf8 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">217<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws194">W<span class="_ _4"></span>ith all the marshalling mov<span class="_ _4"></span>ed to the </div><div class="t m5 xb8 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x6a h1d y194 ffd fs3 fc0 sc0 ls0 ws194">, I started pushing functional-</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws6a0">ity into the deriv<span class="_ _1"></span>atives. <span class="_ _4"></span>The ﬁrst step was to mov<span class="_ _4"></span>e the </div><div class="t m5 xc9 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">setBoolean</div><div class="t m0 x8d h1d y195 ffd fs3 fc0 sc0 ls0 ws6a0">function into the</div><div class="t m5 xd h2f y196 ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaller</div><div class="t m0 x2f h1d y196 ffd fs3 fc0 sc0 ls0 ws51">and make sure it got called correctly<span class="_ _1"></span>. So I created an abstract</div><div class="t m5 xd h2f y197 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x3b h1d y197 ffd fs3 fc0 sc0 ls0 ws0"> method.</div><div class="t m5 x52 h2f y25 ffb fs10 fc0 sc0 ls0 ws0">private <span class="ffc">abstract</span> class ArgumentMarshaler {</div><div class="t m5 x9a h2f yfc4 ffc fs10 fc0 sc0 ls0 ws0">protected<span class="ffb"> boolean booleanValue = false;</span></div><div class="t m5 x74 h2f yfc5 ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue;</div><div class="t m5 x74 h2f yfc6 ffb fs10 fc0 sc0 ls0 ws0">    private int integerValue;</div><div class="t m5 x74 h2f yfc7 ffb fs10 fc0 sc0 ls0 ws0">    public void setBoolean(boolean value) {</div><div class="t m5 x74 h2f yfc8 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = value;</div><div class="t m5 x74 h2f yfc9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfca ffb fs10 fc0 sc0 ls0 ws0">    public boolean getBoolean() {</div><div class="t m5 x74 h2f yfcb ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f yfcc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfcd ffb fs10 fc0 sc0 ls0 ws0">    public void setString(String s) {</div><div class="t m5 x74 h2f yfce ffb fs10 fc0 sc0 ls0 ws0">      stringValue = s;</div><div class="t m5 x74 h2f yfcf ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfd0 ffb fs10 fc0 sc0 ls0 ws0">    public String getString() {</div><div class="t m5 x74 h2f yfd1 ffb fs10 fc0 sc0 ls0 ws0">      return stringValue == null ? &quot;&quot; : stringValue;</div><div class="t m5 x74 h2f yfd2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfd3 ffb fs10 fc0 sc0 ls0 ws0">    public void setInteger(int i) {</div><div class="t m5 x74 h2f yfd4 ffb fs10 fc0 sc0 ls0 ws0">      integerValue = i;</div><div class="t m5 x74 h2f yfd5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfd6 ffb fs10 fc0 sc0 ls0 ws0">    public int getInteger() {</div><div class="t m5 x74 h2f yfd7 ffb fs10 fc0 sc0 ls0 ws0">      return integerValue;</div><div class="t m5 x74 h2f yfd8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x9a h46 yfd9 ffc fs10 fc0 sc0 ls0 ws0">public abstract void set(String s);</div><div class="t m5 x74 h46 yfda ffc fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yf6e ff8 fs3 fc0 sc0 ls0 ws0">Then I implemented the </div><div class="t m5 xa h2f yf6e ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x2f h14 yf6e ff8 fs3 fc0 sc0 ls0 ws0"> method in </div><div class="t m5 x5c h2f yf6e ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaller</div><div class="t m0 xb5 h14 yf6e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f yfdb ffb fs10 fc0 sc0 ls0 ws0">private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x9a h46 yfdc ffc fs10 fc0 sc0 ls0 ws0">public void set(String s) {</div><div class="t m5 x74 h46 yfdd ffc fs10 fc0 sc0 ls0 ws0">      booleanValue = true;</div><div class="t m5 x74 h46 yfde ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfdf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y211 ff8 fs3 fc0 sc0 ls0 ws0">And ﬁnall<span class="_ _4"></span>y I replaced the call to </div><div class="t m5 xdf h2f y211 ffb fs10 fc0 sc0 ls0 ws0">setBoolean</div><div class="t m0 xaa h14 y211 ff8 fs3 fc0 sc0 ls0 ws0"> with a call to </div><div class="t m5 x61 h2f y211 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x7f h14 y211 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f yfe0 ffb fs10 fc0 sc0 ls0 ws0">private void setBooleanArg(char argChar, boolean value) {</div><div class="t m5 x74 h2f yfe1 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.get(argChar)<span class="_ _4"></span><span class="ffc">.set(&quot;true&quot;);</span></div><div class="t m5 x74 h2f yfe2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws6a1">The tests all still passed. Because this change caused </div><div class="t m5 xb7 h2f y4b4 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 xc2 h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws6a1">to be deplo<span class="_ _4"></span>yed to the </div><div class="t m5 xd9 h2f y4b4 ffb fs10 fc0 sc0 ls0 ws0">Boolean-</div><div class="t m5 xd h2f yfe3 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xe4 h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws6a2">, I remo<span class="_ _4"></span>ved the </div><div class="t m5 x5b h2f y4b5 ffb fs10 fc0 sc0 ls0 ws0">setBoolean</div><div class="t m0 x68 h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws6a2">method from the </div><div class="t m5 xb5 h2f y4b5 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x2d h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws0">base</div><div class="t m0 xd h14 y217 ff8 fs3 fc0 sc0 ls0 ws0">class.</div><div class="t m0 x74 h1d y1f9 ffd fs3 fc0 sc0 ls0 wsdd">Notice that the abstract </div><div class="t m5 x9b h2f y1f9 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x1c h1d y1f9 ffd fs3 fc0 sc0 ls0 wsdd">function takes a </div><div class="t m5 xd5 h2f y1f9 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x85 h1d y1f9 ffd fs3 fc0 sc0 ls0 wsdd">argument, b<span class="_ _4"></span>ut the implementation</div><div class="t m0 xd h1d y39a ffd fs3 fc0 sc0 ls0 ws5c3">in the </div><div class="t m5 x3e h2f y39a ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaller</div><div class="t m0 xc h1d y39a ffd fs3 fc0 sc0 ls0 ws5c3">does not use it. I put that argument in there because I</div><div class="t m0 xd h1d y4b6 ffd fs3 fc0 sc0 ls0 ws0">kne<span class="_ _4"></span>w that the </div><div class="t m5 x28 h2f yba6 ffb fs10 fc0 sc0 ls0 ws0">StringArgumentMarshaller</div><div class="t m0 x48 h1d yba6 ffd fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 x67 h2f yba6 ffb fs10 fc0 sc0 ls0 ws0">IntegerArgumentMarshaller</div><div class="t m0 x8d h1d yba6 ffa fs3 fc0 sc0 ls0 ws0">would<span class="ffd"> use it. </span></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pff9" class="pf w1 h2" data-page-no="f9"><div class="pc pcf9 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">218<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws345">Next, I wanted to deplo<span class="_ _4"></span>y the </div><div class="t m5 x76 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x5c h1d y194 ffd fs3 fc0 sc0 ls0 ws345">method into </div><div class="t m5 xea h2f y194 ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 x63 h1d y194 ffd fs3 fc0 sc0 ls0 ws345">. Deploying</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x74 h1d y195 ffd fs3 fc0 sc0 ls0 ws6a3">functions is always ugly because the return type has to be </div><div class="t m5 xef h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Object</div><div class="t m0 x8d h1d y195 ffd fs3 fc0 sc0 ls0 ws6a3">, and in this case</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws0">needs to be cast to a </div><div class="t m5 xb h2f y196 ffb fs10 fc0 sc0 ls0 ws0">Boolean</div><div class="t m0 x57 h1d y196 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y404 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = booleanArgs.get(arg);</div><div class="t m5 x74 h2f y405 ffb fs10 fc0 sc0 ls0 ws0">    return am != null &amp;&amp; <span class="_ _4"></span><span class="ffc">(Boolean)<span class="ffb">am.</span>get<span class="ffb">();</span></span></div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">Just to get this to compile, I added the </div><div class="t m5 x31 h2f y1db ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 xdd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0"> function to the </div><div class="t m5 xdb h2f y1db ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xbb h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y941 ffb fs10 fc0 sc0 ls0 ws0">private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h2f y942 ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x9a h46 y944 ffc fs10 fc0 sc0 ls0 ws0">public Object get() {</div><div class="t m5 x74 h46 y945 ffc fs10 fc0 sc0 ls0 ws0">      return null;</div><div class="t m5 x74 h46 yfe4 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y946 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y40a ff8 fs3 fc0 sc0 lsc ws63a">This compiled and ob<span class="_ _4"></span>viously failed the tests. Getting the tests w<span class="_ _4"></span>orking again was simpl<span class="_ _4"></span>y a</div><div class="t m0 xd h14 y40b ff8 fs3 fc0 sc0 ls0 ws0">matter of making </div><div class="t m5 x87 h2f y40b ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x5 h14 y40b ff8 fs3 fc0 sc0 ls0 ws0"> abstract and implementing it in </div><div class="t m5 x2a h2f y40b ffb fs10 fc0 sc0 ls0 ws0">BooleanAgumentMarshaler</div><div class="t m0 x63 h14 y40b ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f yfe5 ffb fs10 fc0 sc0 ls0 ws0">private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h2f yfe6 ffb fs10 fc0 sc0 ls0 ws0">    protected boolean booleanValue = false;</div><div class="t m5 x74 h2f yfe7 ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x74 h2f yfe8 ffb fs10 fc0 sc0 ls0 ws0">    public <span class="ffc">abstract<span class="_ _4"></span><span class="ffb"> Object get();</span></span></div><div class="t m5 x74 h2f yfe9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfea ffb fs10 fc0 sc0 ls0 ws0">  private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yfeb ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f yfec ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = true;</div><div class="t m5 x74 h2f yfed ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x9a h46 yfee ffc fs10 fc0 sc0 ls0 ws0">public Object get() {</div><div class="t m5 x74 h46 yfef ffc fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h46 yff0 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yff1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yf6f ff8 fs3 fc0 sc0 lsc ws64e">Once again the tests passed. So both </div><div class="t m5 x26 h2f yf6f ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x22 h14 yf6f ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x1b h2f yf6f ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x3d h14 yf6f ff8 fs3 fc0 sc0 ls0 ws4b2">deplo<span class="_ _4"></span>y to the </div><div class="t m5 xab h2f yf6f ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 x56 h14 yf6f ff8 fs3 fc0 sc0 ls0 ws0">!</div><div class="t m0 xd h14 yf70 ff8 fs3 fc0 sc0 ls0 ws23c">This allo<span class="_ _4"></span>w<span class="_ _4"></span>ed me to remo<span class="_ _4"></span>ve the old </div><div class="t m5 x20 h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 x66 h14 yf70 ff8 fs3 fc0 sc0 ls0 ws23c">function from </div><div class="t m5 x7f h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xd3 h14 yf70 ff8 fs3 fc0 sc0 ls0 ws23c">, mo<span class="_ _4"></span>ve the</div><div class="t m0 xd h14 y9fa ff8 fs3 fc0 sc0 ls0 ws0">protected</div><div class="t m5 xcb h2f y9fa ffb fs10 fc0 sc0 ls0 ws0">booleanValue</div><div class="t m0 x4 h14 y9fa ff8 fs3 fc0 sc0 ls0 ws0"> v<span class="_ _4"></span>ariable do<span class="_ _4"></span>wn to </div><div class="t m5 xe0 h2f y9fa ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 xb9 h14 y9fa ff8 fs3 fc0 sc0 ls0 ws0">, and make it </div><div class="t m5 xda h2f y9fa ffb fs10 fc0 sc0 ls0 ws0">private</div><div class="t m0 xc8 h14 y9fa ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1d y970 ffd fs3 fc0 sc0 ls0 ws134">I did the same pattern of changes for </div><div class="t m5 x44 h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">Strings</div><div class="t m0 xd5 h1d y1f0 ffd fs3 fc0 sc0 ls0 ws134">. I deployed both </div><div class="t m5 xb9 h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x6b h1d y1f0 ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x6f h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x63 h1d y1f0 ffd fs3 fc0 sc0 ls0 ws134">, deleted the</div><div class="t m0 xd h1d y1f1 ffd fs3 fc0 sc0 ls0 ws0">unused functions, and mov<span class="_ _4"></span>ed the variables.</div><div class="t m5 x52 h2f yff2 ffb fs10 fc0 sc0 ls0 ws0">private void setStringArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f yff3 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f yff4 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yff5 ffb fs10 fc0 sc0 ls0 ws0">      stringArgs.get(argChar).<span class="_ _4"></span><span class="ffc">set<span class="ffb">(args[currentArgument]);</span></span></div><div class="t m5 x74 h2f yff6 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f yff7 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f yff8 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f yff9 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f yffa ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f yffb ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yffc ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pffa" class="pf w1 h2" data-page-no="fa"><div class="pc pcfa w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">219<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = stringArgs.get(arg);</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">    return am == null ? &quot;&quot; : <span class="_ _4"></span><span class="ffc">(String)<span class="ffb"> am.</span>get<span class="ffb">();</span></span></div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x52 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    private int integerValue;</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    public void setInteger(int i) {</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">      integerValue = i;</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">    public int getInteger() {</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">      return integerValue;</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">    public abstract void set(String s);</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">    public abstract Object get();</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">  private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x9a h46 yf9f ffc fs10 fc0 sc0 ls0 ws0">private boolean booleanValue = false;</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = true;</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfa7 ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x9a h46 yfa8 ffc fs10 fc0 sc0 ls0 ws0">private String stringValue = &quot;&quot;;</div><div class="t m5 x74 h2f yfa9 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x5f h46 yfaa ffc fs10 fc0 sc0 ls0 ws0">stringValue = s;</div><div class="t m5 x74 h2f yfab ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yffd ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x5f h46 yfb7 ffc fs10 fc0 sc0 ls0 ws0">return stringValue;</div><div class="t m5 x74 h2f yfb8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfba ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yfbc ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f yfbd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfbf ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f yffe ffb fs10 fc0 sc0 ls0 ws0">      return null;</div><div class="t m5 x74 h2f yfc0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfc1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfc2 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pffb" class="pf w1 h2" data-page-no="fb"><div class="pc pcfb w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">220<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws6a4">Finally<span class="_ _1"></span>, I repeated the process for </div><div class="t m5 x48 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">integers</div><div class="t m0 xce h1d y194 ffd fs3 fc0 sc0 ls0 ws6a4">. This w<span class="_ _4"></span>as just a little more complicated</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws0">because</div><div class="t m5 x9a h2f y195 ffb fs10 fc0 sc0 ls0 ws0">integers</div><div class="t m0 x6 h1d y195 ffd fs3 fc0 sc0 ls0 ws20b">needed to be parsed, and the </div><div class="t m5 x65 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">parse</div><div class="t m0 xea h1d y195 ffd fs3 fc0 sc0 ls0 ws20b">operation can thro<span class="_ _4"></span>w an exception. But</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws51">the result is better because the whole concept of </div><div class="t m5 xde h2f y196 ffb fs10 fc0 sc0 ls0 ws0">NumberFormatException</div><div class="t m0 x60 h1d y196 ffd fs3 fc0 sc0 ls0 ws51">got buried in the</div><div class="t m5 xd h2f y197 ffb fs10 fc0 sc0 ls0 ws0">IntegerArgumentMarshaler</div><div class="t m0 x7d h1d y197 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y25 ffb fs10 fc0 sc0 ls0 ws0">private boolean isIntArg(char argChar) {return intArgs.containsKey(argChar);}</div><div class="t m5 x74 h2f yfc5 ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f yfc6 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f yfff ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f yfc7 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yfc8 ffb fs10 fc0 sc0 ls0 ws0">      parameter = args[currentArgument];</div><div class="t m5 x74 h2f yfc9 ffb fs10 fc0 sc0 ls0 ws0">      intArgs.get(argChar).<span class="_ _4"></span><span class="ffc">set<span class="ffb">(parameter);</span></span></div><div class="t m5 x74 h2f y1000 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f yfca ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f yfcb ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f yfcc ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f y1001 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f yfcd ffb fs10 fc0 sc0 ls0 ws0">    } catch (<span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb"> e) {</span></span></div><div class="t m5 x74 h2f yfce ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f yfcf ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y1002 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f yfd0 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f yfd1 ffb fs10 fc0 sc0 ls0 ws0">      throw <span class="ffc">e</span>;</div><div class="t m5 x74 h2f yfd2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1003 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfd3 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yfd4 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(char argChar) {</div><div class="t m5 x9a h46 yfd5 ffc fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h2f y1004 ffb fs10 fc0 sc0 ls0 ws0">      booleanArgs.get(argChar).set(&quot;true&quot;);</div><div class="t m5 x9a h46 yfd6 ffc fs10 fc0 sc0 ls0 ws0">} catch (ArgsException e) {</div><div class="t m5 x74 h46 yfd7 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfd8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1005 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yfd9 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f yfda ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = intArgs.get(arg);</div><div class="t m5 x74 h2f y1006 ffb fs10 fc0 sc0 ls0 ws0">    return am == null ? 0 : <span class="_ _4"></span><span class="ffc">(Integer)<span class="ffb"> am.</span>get<span class="ffb">();</span></span></div><div class="t m5 x74 h2f y1007 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1008 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y1009 ffb fs10 fc0 sc0 ls0 ws0">  private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h2f y100a ffb fs10 fc0 sc0 ls0 ws0">    public abstract void set(String s) throws ArgsException;</div><div class="t m5 x74 h2f y100b ffb fs10 fc0 sc0 ls0 ws0">    public abstract Object get();</div><div class="t m5 x74 h2f y100c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y100d ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y100e ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x9a h46 y100f ffc fs10 fc0 sc0 ls0 ws0">private int intValue = 0;</div><div class="t m5 x74 h2f y1010 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) <span class="_ _4"></span><span class="ffc">throws ArgsException {</span></div><div class="t m5 x5f h46 y1011 ffc fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h46 y1012 ffc fs10 fc0 sc0 ls0 ws0">        intValue = Integer.parseInt(s);</div><div class="t m5 x74 h46 y1013 ffc fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h46 y1014 ffc fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h46 y1015 ffc fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y1016 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1017 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x5f h46 y1018 ffc fs10 fc0 sc0 ls0 ws0">return intValue;</div><div class="t m5 x74 h2f y1019 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y101a ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pffc" class="pf w1 h2" data-page-no="fc"><div class="pc pcfc w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">221<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws2d3">Of course, the tests continued to pass. Next, I got rid of the three dif<span class="_ _4"></span>ferent maps up at</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws4ad">the top of the algorithm. This made the whole system much more generic. Ho<span class="_ _4"></span>wev<span class="_ _4"></span>er<span class="_ _4"></span>, I</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws6a5">couldn’t get rid of them just by deleting them because that w<span class="_ _4"></span>ould break the system.</div><div class="t m0 xd h1d y197 ffd fs3 fc0 sc0 ls0 ws6a6">Instead, I added a new </div><div class="t m5 x6e h2f y197 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x9b h1d y197 ffd fs3 fc0 sc0 ls0 ws6a6">for the </div><div class="t m5 x77 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x17 h1d y197 ffd fs3 fc0 sc0 ls0 ws6a6">and then one by one changed the</div><div class="t m0 xd h1d y198 ffd fs3 fc0 sc0 ls0 ws0">methods to use it instead of the three original maps.</div><div class="t m5 x74 h2f y101b ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y101c ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y101d ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; booleanArgs = </div><div class="t m5 x74 h2f y101e ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y101f ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; stringArgs = </div><div class="t m5 x74 h2f y1020 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1021 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; intArgs = </div><div class="t m5 x74 h2f y1022 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x3e h46 y1023 ffc fs10 fc0 sc0 ls0 ws0">private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x9a h46 y1024 ffc fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1025 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y1026 ffb fs10 fc0 sc0 ls0 ws0">  private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x9a h46 y1027 ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler m = new BooleanArgumentMarshaler();</div><div class="t m5 x74 h2f y1028 ffb fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(elementId, m);</div><div class="t m5 x74 h46 y1029 ffc fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, m);</div><div class="t m5 x74 h2f y102a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y102b ffb fs10 fc0 sc0 ls0 ws0">  private void parseIntegerSchemaElement(char elementId) {</div><div class="t m5 x74 h46 y102c ffc fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = new IntegerArgumentMarshaler();</div><div class="t m5 x74 h2f y102d ffb fs10 fc0 sc0 ls0 ws0">    intArgs.put(elementId, m);</div><div class="t m5 x74 h46 y102e ffc fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, m);</div><div class="t m5 x74 h2f y102f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1030 ffb fs10 fc0 sc0 ls0 ws0">  private void parseStringSchemaElement(char elementId) {</div><div class="t m5 x74 h46 y1031 ffc fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = new StringArgumentMarshaler();</div><div class="t m5 x74 h2f y1032 ffb fs10 fc0 sc0 ls0 ws0">    stringArgs.put(elementId, m);</div><div class="t m5 x74 h46 y1033 ffc fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, m);</div><div class="t m5 x74 h2f y1034 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y827 ff8 fs3 fc0 sc0 ls0 ws0">Of course the tests all still passed. Next, I changed </div><div class="t m5 x54 h2f y827 ffb fs10 fc0 sc0 ls0 ws0">isBooleanArg</div><div class="t m0 xf3 h14 y827 ff8 fs3 fc0 sc0 ls0 ws0"> from this:</div><div class="t m5 x52 h2f y828 ffb fs10 fc0 sc0 ls0 ws0">private boolean isBooleanArg(char argChar) {</div><div class="t m5 x74 h2f y829 ffb fs10 fc0 sc0 ls0 ws0">    return booleanArgs.containsKey(argChar);</div><div class="t m5 x74 h2f y82a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y9fa ff8 fs3 fc0 sc0 ls0 ws0">to this:</div><div class="t m5 x52 h2f y46c ffb fs10 fc0 sc0 ls0 ws0">private boolean isBooleanArg(char argChar) {</div><div class="t m5 x9a h46 y46d ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h46 y46e ffc fs10 fc0 sc0 ls0 ws0">    return m instanceof BooleanArgumentMarshaler;</div><div class="t m5 x74 h2f y1035 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0">The tests still passed. So I made the same change to </div><div class="t m5 xd2 h2f y4b2 ffb fs10 fc0 sc0 ls0 ws0">isIntArg</div><div class="t m0 x6a h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 xef h2f y4b2 ffb fs10 fc0 sc0 ls0 ws0">isStringArg</div><div class="t m0 xa5 h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f y1036 ffb fs10 fc0 sc0 ls0 ws0">private boolean isIntArg(char argChar) {</div><div class="t m5 x9a h46 y1037 ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h46 y1038 ffc fs10 fc0 sc0 ls0 ws0">    return m instanceof IntegerArgumentMarshaler;</div><div class="t m5 x74 h2f y1039 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y103a ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringArg(char argChar) {</div><div class="t m5 x9a h46 y103b ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h46 y103c ffc fs10 fc0 sc0 ls0 ws0">    return m instanceof StringArgumentMarshaler;</div><div class="t m5 x74 h2f y103d ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pffd" class="pf w1 h2" data-page-no="fd"><div class="pc pcfd w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">222<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">The tests still passed. So I eliminated all the duplicate calls to </div><div class="t m5 x62 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">marshalers.get</div><div class="t m0 xf4 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0"> as follo<span class="_ _4"></span>ws:</div><div class="t m5 x52 h2f ya7a ffb fs10 fc0 sc0 ls71 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x9a h46 yee0 ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f yee1 ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanArg(<span class="_ _4"></span><span class="ffc">m<span class="ffb">))</span></span></div><div class="t m5 x74 h2f yee2 ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(argChar);</div><div class="t m5 x74 h2f yee3 ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringArg(<span class="_ _4"></span><span class="ffc">m<span class="ffb">))</span></span></div><div class="t m5 x74 h2f yee4 ffb fs10 fc0 sc0 ls0 ws0">      setStringArg(argChar);</div><div class="t m5 x74 h2f yee5 ffb fs10 fc0 sc0 ls0 ws0">    else if (isIntArg(<span class="_ _4"></span><span class="ffc">m<span class="ffb">))</span></span></div><div class="t m5 x74 h2f yee6 ffb fs10 fc0 sc0 ls0 ws0">      setIntArg(argChar);</div><div class="t m5 x74 h2f yee7 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f yee8 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y103e ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y103f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1040 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isIntArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) {</span></span></div><div class="t m5 x74 h2f y1041 ffb fs10 fc0 sc0 ls0 ws0">    return m instanceof IntegerArgumentMarshaler;</div><div class="t m5 x74 h2f y1042 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1043 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) {</span></span></div><div class="t m5 x74 h2f y1044 ffb fs10 fc0 sc0 ls0 ws0">    return m instanceof StringArgumentMarshaler;</div><div class="t m5 x74 h2f y1045 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1046 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBooleanArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) {</span></span></div><div class="t m5 x74 h2f y1047 ffb fs10 fc0 sc0 ls0 ws0">    return m instanceof BooleanArgumentMarshaler;</div><div class="t m5 x74 h2f y1048 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws0">This left no good reason for the three </div><div class="t m5 x9c h2f y74b ffb fs10 fc0 sc0 ls0 ws0">isxxxArg</div><div class="t m0 xee h14 y74b ff8 fs3 fc0 sc0 ls0 ws0"> methods. So I inlined them:</div><div class="t m5 x52 h2f y1049 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y104a ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y104b ffb fs10 fc0 sc0 ls0 ws0">    if (<span class="ffc">m instanceof BooleanArgumentMarshaler<span class="_ _1"></span><span class="ffb">)</span></span></div><div class="t m5 x74 h2f y104c ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(argChar);</div><div class="t m5 x74 h2f y104d ffb fs10 fc0 sc0 ls0 ws0">    else if (<span class="ffc">m instanceof StringArgumentMarshaler<span class="_ _1"></span><span class="ffb">)</span></span></div><div class="t m5 x74 h2f y104e ffb fs10 fc0 sc0 ls0 ws0">      setStringArg(argChar);</div><div class="t m5 x74 h2f y104f ffb fs10 fc0 sc0 ls0 ws0">    else if (<span class="ffc">m instanceof IntegerArgumentMarshaler<span class="_ _1"></span><span class="ffb">)</span></span></div><div class="t m5 x74 h2f y1050 ffb fs10 fc0 sc0 ls0 ws0">      setIntArg(argChar);</div><div class="t m5 x74 h2f y1051 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y1052 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y1053 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y1054 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1f0 ff8 fs3 fc0 sc0 ls0 ws2e8">Next, I started using the </div><div class="t m5 xa h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">marshalers</div><div class="t m0 x20 h14 y1f0 ff8 fs3 fc0 sc0 ls49 ws63c"> map in the </div><div class="t m5 x23 h2f y1f0 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x3c h14 y1f0 ff8 fs3 fc0 sc0 ls22 ws133"> functions, breaking the use of the other</div><div class="t m0 xd h14 y1f1 ff8 fs3 fc0 sc0 ls0 ws0">three maps. I started with the </div><div class="t m5 xcc h2f y1f1 ffb fs10 fc0 sc0 ls0 ws0">booleans</div><div class="t m0 x32 h14 y1f1 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f yff2 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f yff3 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f yff4 ffb fs10 fc0 sc0 ls0 ws0">    if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f yff5 ffb fs10 fc0 sc0 ls0 ws0">      setBooleanArg(<span class="_ _4"></span><span class="ffc">m<span class="ffb">);</span></span></div><div class="t m5 x74 h2f yff6 ffb fs10 fc0 sc0 ls0 ws0">    else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f yff7 ffb fs10 fc0 sc0 ls0 ws0">      setStringArg(argChar);</div><div class="t m5 x74 h2f yff8 ffb fs10 fc0 sc0 ls0 ws0">    else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f yff9 ffb fs10 fc0 sc0 ls0 ws0">      setIntArg(argChar);</div><div class="t m5 x74 h2f yffa ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f yffb ffb fs10 fc0 sc0 ls0 ws0">      return false;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pffe" class="pf w1 h2" data-page-no="fe"><div class="pc pcfe w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">223<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) {</span></span></div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x5f h2f y62b ffc fs10 fc0 sc0 ls0 ws0">m<span class="ffb">.set(&quot;true&quot;); </span>// was: booleanArgs.get(argChar).set(&quot;true&quot;);</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws17c">The tests still passed<span class="_ _1"></span>, so I did the same with </div><div class="t m5 xaa h2f y19b ffb fs10 fc0 sc0 ls0 ws0">Strings</div><div class="t m0 xea h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x85 h2f y19b ffb fs10 fc0 sc0 ls0 ws0">Integers</div><div class="t m0 xa0 h14 y19b ff8 fs3 fc0 sc0 ls0 ws17c">. <span class="_ _1"></span>This allow<span class="_ _1"></span>ed me to inte-</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">grate some of the ugly exception management code into the </div><div class="t m5 xc9 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 x8d h14 y19c ff8 fs3 fc0 sc0 ls0 ws0"> function.</div><div class="t m5 x52 h2f ya99 ffb fs10 fc0 sc0 ls71 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y1055 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x9a h46 y1056 ffc fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h2f y1057 ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f y1058 ffb fs10 fc0 sc0 ls0 ws0">        setBooleanArg(m);</div><div class="t m5 x74 h2f y1059 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f y105a ffb fs10 fc0 sc0 ls0 ws0">        setStringArg(<span class="_ _4"></span><span class="ffc">m<span class="ffb">);</span></span></div><div class="t m5 x74 h2f y105b ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y105c ffb fs10 fc0 sc0 ls0 ws0">        setIntArg(<span class="ffc">m</span>);</div><div class="t m5 x74 h2f y105d ffb fs10 fc0 sc0 ls0 ws0">      else</div><div class="t m5 x74 h2f y105e ffb fs10 fc0 sc0 ls0 ws0">        return false;</div><div class="t m5 x9a h46 y105f ffc fs10 fc0 sc0 ls0 ws0">} catch (ArgsException e) {</div><div class="t m5 x5f h46 y1060 ffc fs10 fc0 sc0 ls0 ws0">valid = false;</div><div class="t m5 x74 h46 y1061 ffc fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h46 y1062 ffc fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h46 y1063 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1064 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y1065 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1066 ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) throws ArgsException {</span></span></div><div class="t m5 x74 h2f y1067 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y1068 ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f y1069 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y106a ffb fs10 fc0 sc0 ls0 ws0">      parameter = args[currentArgument];</div><div class="t m5 x5f h2f y106b ffc fs10 fc0 sc0 ls0 ws0">m<span class="ffb">.set(parameter);</span></div><div class="t m5 x74 h2f y106c ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y106d ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f y106e ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y106f ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y1070 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f y1071 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f y1072 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y1073 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1074 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1075 ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(<span class="_ _4"></span><span class="ffc">ArgumentMarshaler m<span class="ffb">) throws ArgsException {</span></span></div><div class="t m5 x74 h2f y1076 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y1077 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x5f h2f y1078 ffc fs10 fc0 sc0 ls0 ws0">m<span class="ffb">.set(args[currentArgument]);</span></div><div class="t m5 x74 h2f y1079 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y107a ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f y107b ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y107c ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y107d ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pfff" class="pf w1 h2" data-page-no="ff"><div class="pc pcff w1 h2"><img class="bi x37 y107e w15 h9d" alt="" src="bgff.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">224<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws6a7">I was close to being ab<span class="_ _4"></span>le to remo<span class="_ _4"></span>ve the three old maps. F<span class="_ _4"></span>irst, I needed to change the</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 x5f h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> function from this:</div><div class="t m5 x52 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = booleanArgs.get(arg);</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls0 ws0">    return am != null &amp;&amp; (Boolean) am.get();</div><div class="t m5 x74 h2f yae1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">to this:</div><div class="t m5 x74 h2f yec4 ffb fs10 fc0 sc0 ls0 ws0">public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y107f ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x9a h46 y1080 ffc fs10 fc0 sc0 ls0 ws0">boolean b = false;</div><div class="t m5 x95 h46 y1081 ffc fs10 fc0 sc0 ls0 ws0"> try {</div><div class="t m5 x74 h2f y1082 ffc fs10 fc0 sc0 ls0 ws0">      b = <span class="ffb">am != null &amp;&amp; (Boolean) am.get();</span></div><div class="t m5 x9a h46 y1083 ffc fs10 fc0 sc0 ls0 ws0">} catch (ClassCastException e) {</div><div class="t m5 x74 h46 y1084 ffc fs10 fc0 sc0 ls0 ws0">      b = false;</div><div class="t m5 x74 h46 y1085 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 y1086 ffc fs10 fc0 sc0 ls0 ws0">    return b;</div><div class="t m5 x74 h2f y1087 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y40b ffd fs3 fc0 sc0 lsc ws6a8">This last change might hav<span class="_ _4"></span>e been a surprise. Why did I suddenly decide to deal with</div><div class="t m0 xd h1d y40c ffd fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y40c ffb fs10 fc0 sc0 ls0 ws0">ClassCastException</div><div class="t m0 x2e h1d y40c ffd fs3 fc0 sc0 ls0 ws2f0">? The reason is that I ha<span class="_ _4"></span>ve a set of unit tests and a separate set of</div><div class="t m0 xd h1d yb6f ffd fs3 fc0 sc0 ls0 ws28c">acceptance tests written in FitNesse. It turns out that the FitNesse tests made sure that if</div><div class="t m0 xd h1d y8ff ffd fs3 fc0 sc0 ls0 ws404">you called </div><div class="t m5 x46 h2f y8ff ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 x4 h1d y8ff ffd fs3 fc0 sc0 ls0 ws404">on a nonboolean argument, you got a </div><div class="t m5 x7f h2f y8ff ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 xb9 h1d y8ff ffd fs3 fc0 sc0 ls0 ws404">. The unit tests did not.</div><div class="t m0 xd h1d yb03 ffd fs3 fc0 sc0 ls0 ws0">Up to this point I had only been running the unit tests.</div><div class="t m0 x40 h99 y29d ffd fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x74 h1d yb41 ffd fs3 fc0 sc0 ls0 ws0">This last change allo<span class="_ _4"></span>wed me to pull out another use of the </div><div class="t m5 x53 h2f yb41 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 x6b h1d yb41 ffd fs3 fc0 sc0 ls0 ws0"> map:</div><div class="t m5 x52 h2f yb70 ffb fs10 fc0 sc0 ls0 ws0">private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x74 h2f yb71 ffb fs10 fc0 sc0 ls14 ws237">    ArgumentMarshaler m = new BooleanArgumentMarshaler();</div><div class="t m5 x74 h46 y1088 ffc fs10 fc0 sc0 ls0 ws0">    booleanArgs.put(elementId, m);</div><div class="t m5 x74 h2f y9e3 ffb fs10 fc0 sc0 ls19 ws2f1">    marshalers.put(elementId, m);</div><div class="t m5 x74 h2f y9e4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y524 ff8 fs3 fc0 sc0 ls0 ws0">And no<span class="_ _4"></span>w w<span class="_ _4"></span>e can delete the </div><div class="t m5 xc7 h2f y524 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 x20 h14 y524 ff8 fs3 fc0 sc0 ls0 ws0"> map.</div><div class="t m5 x74 h2f y1089 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y108a ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x3e h46 y108b ffc fs10 fc0 sc0 ls0 ws0">private Map&lt;Character, ArgumentMarshaler&gt; booleanArgs = </div><div class="t m5 x52 h46 yf94 ffc fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x52 h2f y108c ffb fs10 fc0 sc0 ls0 ws0">private Map&lt;Character, ArgumentMarshaler&gt; stringArgs = </div><div class="t m5 x52 h2f y108d ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y108e ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; intArgs = </div><div class="t m5 x52 h2f y108f ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1090 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x52 h2f y1091 ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1092 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m0 xd h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws66e">Next, I migrated the </div><div class="t m5 xc6 h2f y1f4 ffb fs10 fc0 sc0 ls0 ws0">String</div><div class="t m0 x5a h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x8 h2f y1f4 ffb fs10 fc0 sc0 ls0 ws0">Integer</div><div class="t m0 xb8 h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws66e">arguments in the same manner and did a little</div><div class="t m0 xd h14 y1f5 ff8 fs3 fc0 sc0 ls0 ws0">cleanup with the </div><div class="t m5 xbc h2f y401 ffb fs10 fc0 sc0 ls0 ws0">booleans</div><div class="t m0 xb1 h14 y401 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f yf02 ffb fs10 fc0 sc0 ls0 ws0">private void parseBooleanSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y1093 ffb fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, <span class="_ _4"></span><span class="ffc">new BooleanArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f yf03 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y1094 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>T<span class="_ _1"></span>o prev<span class="_ _4"></span>ent fur<span class="_ _8"></span>ther surprises of this kind, I added a ne<span class="_ _4"></span>w unit test that inv<span class="_ _4"></span>oked all the FitNesse tests.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf100" class="pf w1 h2" data-page-no="100"><div class="pc pc100 w1 h2"><img class="bi x74 y1095 w16 h9e" alt="" src="bg100.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">225<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private void parseIntegerSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, <span class="_ _4"></span><span class="ffc">new IntegerArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private void parseStringSchemaElement(char elementId) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    marshalers.put(elementId, <span class="_ _4"></span><span class="ffc">new StringArgumentMarshaler()<span class="_ _4"></span><span class="ffb">);</span></span></div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = <span class="_ _4"></span><span class="ffc">marshalers<span class="ffb">.get(arg);</span></span></div><div class="t m5 x9a h46 y62f ffc fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? &quot;&quot; : (String) am.get();</div><div class="t m5 x9a h46 y631 ffc fs10 fc0 sc0 ls0 ws0">} catch (ClassCastException e) {</div><div class="t m5 x7c h46 y632 ffc fs10 fc0 sc0 ls0 ws0">     return &quot;&quot;;</div><div class="t m5 x74 h46 y9cc ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = <span class="_ _4"></span><span class="ffc">marshalers<span class="ffb">.get(arg);</span></span></div><div class="t m5 x74 h46 ye37 ffc fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? 0 : (Integer) am.get();</div><div class="t m5 x74 h46 yf9d ffc fs10 fc0 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h46 yf9e ffc fs10 fc0 sc0 ls0 ws0">      return 0;</div><div class="t m5 x74 h46 yf9f ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h46 yfb4 ffc fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; stringArgs = </div><div class="t m5 x52 h46 y737 ffc fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h46 y6c4 ffc fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; intArgs = </div><div class="t m5 x52 h46 y1096 ffc fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x52 h2f y6e8 ffb fs10 fc0 sc0 ls0 ws0">private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x52 h2f y1097 ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1098 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m0 x74 h1d y1099 ffd fs3 fc0 sc0 ls0 ws0">Next, I inlined the three </div><div class="t m5 x5d h2f y1099 ffb fs10 fc0 sc0 ls0 ws0">parse</div><div class="t m0 xc h1d y1099 ffd fs3 fc0 sc0 ls0 ws0"> methods because they didn’<span class="_ _4"></span>t do much anymore:</div><div class="t m5 x52 h2f y109a ffb fs10 fc0 sc0 ls0 ws0">private void parseSchemaElement(String element) throws ParseException {</div><div class="t m5 x74 h2f y109b ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y109c ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y109d ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y109e ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanSchemaElement(elementTail))</div><div class="t m5 x5f h46 y109f ffc fs10 fc0 sc0 ls0 ws0">marshalers.put(elementId, new BooleanArgumentMarshaler());</div><div class="t m5 x74 h2f y10a0 ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringSchemaElement(elementTail))</div><div class="t m5 x74 h46 y10a1 ffc fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArgumentMarshaler());</div><div class="t m5 x74 h2f y10a2 ffb fs10 fc0 sc0 ls0 ws0">    else if (isIntegerSchemaElement(elementTail)) {</div><div class="t m5 x74 h46 y10a3 ffc fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new IntegerArgumentMarshaler());</div><div class="t m5 x74 h2f y10a4 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y10a5 ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(String.format(</div><div class="t m5 x52 h2f y10a6 ffb fs10 fc0 sc0 ls0 ws0">    &quot;Argument: %c has invalid format: %s.&quot;, elementId, elementTail), 0);</div><div class="t m5 x74 h2f y10a7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y1d7 ffd fs3 fc0 sc0 lsc ws1df">Okay<span class="_ _1"></span>, so now let’<span class="_ _1"></span>s look at the whole picture again. Listing 14-12 shows the current</div><div class="t m0 xd h1d y1d8 ffd fs3 fc0 sc0 ls0 ws0">form of the </div><div class="t m5 x4c h2f y1d8 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x24 h1d y1d8 ffd fs3 fc0 sc0 ls0 ws0"> class. </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf101" class="pf w1 h2" data-page-no="101"><div class="pc pc101 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg101.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">226<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">package com.objectmentor.utilities.getopts;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">import java.text.ParseException;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">import java.util.*;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  private String[] args;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private boolean valid = true;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; unexpectedArguments = new TreeSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x52 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  private int currentArgument;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  private enum ErrorCode {</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT}</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ParseException {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    this.args = args;</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() throws ParseException {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; args.length == 0)</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      parseArguments();</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() throws ParseException {</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;)) {</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      if (element.length() &gt; 0) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">        String trimmedElement = element.trim();</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">        parseSchemaElement(trimmedElement);</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws ParseException {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    if (isBooleanSchemaElement(elementTail))</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new BooleanArgumentMarshaler());</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">    else if (isStringSchemaElement(elementTail))</div><div class="t m5 x74 h2f y6b5 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArgumentMarshaler());</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf102" class="pf w1 h2" data-page-no="102"><div class="pc pc102 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg102.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">227<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    else if (isIntegerSchemaElement(elementTail)) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new IntegerArgumentMarshaler());</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(String.format(</div><div class="t m5 x52 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    &quot;Argument: %c has invalid format: %s.&quot;, elementId, elementTail), 0);</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws ParseException {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId)) {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(</div><div class="t m5 x52 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    &quot;Bad character:&quot; + elementId + &quot;in Args format: &quot; + schema, 0);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  private boolean isStringSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.equals(&quot;*&quot;);</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  private boolean isBooleanSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.length() == 0;</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  private boolean isIntegerSchemaElement(String elementTail) {</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    return elementTail.equals(&quot;#&quot;);</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseArguments() throws ArgsException {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    for (currentArgument=0; currentArgument&lt;args.length; currentArgument++) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      String arg = args[currentArgument];</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgument(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    if (arg.startsWith(&quot;-&quot;))</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      parseElements(arg);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElements(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 1; i &lt; arg.length(); i++)</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      parseElement(arg.charAt(i));</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    if (setArgument(argChar))</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">    else {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">      unexpectedArguments.add(argChar);</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.UNEXPECTED_ARGUMENT;</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf103" class="pf w1 h2" data-page-no="103"><div class="pc pc103 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg103.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">228<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">        setBooleanArg(m);</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">        setStringArg(m);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">        setIntArg(m);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      else</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">        return false;</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(ArgumentMarshaler m) throws ArgsException {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      parameter = args[currentArgument];</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      m.set(parameter);</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(ArgumentMarshaler m) throws ArgsException {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    currentArgument++;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">      m.set(args[currentArgument]);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArrayIndexOutOfBoundsException e) {</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(ArgumentMarshaler m) {</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      m.set(&quot;true&quot;);</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">  public int cardinality() {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.size();</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf104" class="pf w1 h2" data-page-no="104"><div class="pc pc104 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg104.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">229<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public String usage() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() &gt; 0)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      return &quot;-[&quot; + schema + &quot;]&quot;;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() throws Exception {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    switch (errorCode) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      case OK:</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">        throw new Exception(&quot;TILT: Should not get here.&quot;);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      case UNEXPECTED_ARGUMENT:</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">        return unexpectedArgumentMessage();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_STRING:</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_INTEGER:</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects an integer but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_INTEGER:</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find integer parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  private String unexpectedArgumentMessage() {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    StringBuffer message = new StringBuffer(&quot;Argument(s) -&quot;);</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    for (char c : unexpectedArguments) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      message.append(c);</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">    message.append(&quot; unexpected.&quot;);</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    return message.toString();</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    boolean b = false;</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      b = am != null &amp;&amp; (Boolean) am.get();</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    } catch (ClassCastException e) {</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      b = false;</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    return b;</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? &quot;&quot; : (String) am.get();</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ClassCastException e) {</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf105" class="pf w1 h2" data-page-no="105"><div class="pc pc105 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg105.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">230<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? 0 : (Integer) am.get();</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      return 0;</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  public boolean has(char arg) {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.contains(arg);</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  public boolean isValid() {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  private class ArgsException extends Exception {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    public abstract void set(String s) throws ArgsException;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    public abstract Object get();</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    private boolean booleanValue = false;</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      booleanValue = true;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue = &quot;&quot;;</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">      stringValue = s;</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">      return stringValue;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    private int intValue = 0;</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) throws ArgsException {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">        intValue = Integer.parseInt(s);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf106" class="pf w1 h2" data-page-no="106"><div class="pc pc106 w1 h2"><img class="bi xd y10a9 wc h9f" alt="" src="bg106.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">231<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m0 x74 h1d ybdc ffd fs3 fc0 sc0 ls0 ws44d">After all that work, this is a bit disappointing. <span class="_ _4"></span>The structure is a bit better, b<span class="_ _4"></span>ut we still</div><div class="t m0 xd h1d y10aa ffd fs3 fc0 sc0 ls0 ws3a8">hav<span class="_ _4"></span>e all those variables up at the top; there’<span class="_ _1"></span>s still a horrible type-case in </div><div class="t m5 x60 h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 xb0 h1d y3b7 ffd fs3 fc0 sc0 ls0 ws3a8">; and</div><div class="t m0 xd h1d y4dd ffd fs3 fc0 sc0 ls0 ws54d">all those </div><div class="t m5 x8a h2f y4dd ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x91 h1d y4dd ffd fs3 fc0 sc0 ls0 ws54d">functions are really ugly<span class="_ _1"></span>. Not to mention all the error processing. W<span class="_ _0"></span>e still</div><div class="t m0 xd h1d y3b1 ffd fs3 fc0 sc0 ls0 ws0">hav<span class="_ _4"></span>e a lot of work ahead of us.</div><div class="t m0 x74 h1d y4df ffd fs3 fc0 sc0 ls0 ws596">I’<span class="_ _1"></span>d really like to get rid of that type-case up in </div><div class="t m5 x96 h2f y4df ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 xb9 h1d y4df ffd fs3 fc0 sc0 ls0 ws596">[G23]. <span class="_ _4"></span>What I’<span class="_ _4"></span>d like in</div><div class="t m5 xd h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 x6d h1d y4e0 ffd fs3 fc0 sc0 ls0 ws6a9">is a single call to </div><div class="t m5 x76 h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler.set</div><div class="t m0 xdb h1d y4e0 ffd fs3 fc0 sc0 ls0 ws6a9">. This means I need to push</div><div class="t m5 xd h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">setIntArg</div><div class="t m0 x8a h1d y4e1 ffd fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x46 h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">setStringArg</div><div class="t m0 x6e h1d y4e1 ffd fs3 fc0 sc0 ls0 ws57d">, and </div><div class="t m5 xcc h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x67 h1d y4e1 ffd fs3 fc0 sc0 ls0 ws57d">do<span class="_ _4"></span>wn into the appropriate </div><div class="t m5 xc1 h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xd h1d y4e2 ffd fs3 fc0 sc0 ls0 ws0">deriv<span class="_ _1"></span>atives. But there is a problem.</div><div class="t m0 x74 h1d y2a ffd fs3 fc0 sc0 ls0 ws226">If you look closely at </div><div class="t m5 x7 h2f y2a ffb fs10 fc0 sc0 ls0 ws0">setIntArg</div><div class="t m0 x77 h1d y2a ffd fs3 fc0 sc0 ls0 ws226">, you’ll notice that it uses two instance v<span class="_ _4"></span>ariables: </div><div class="t m5 xbf h2f y2a ffb fs10 fc0 sc0 ls0 ws0">args</div><div class="t m0 xd h1d yb1e ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">currentArg</div><div class="t m0 xe h1d yb1e ffd fs3 fc0 sc0 ls0 ws23e">. T<span class="_ _0"></span>o <span class="_ _8"></span>move </div><div class="t m5 xb1 h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">setIntArg</div><div class="t m0 x77 h1d yb1e ffd fs3 fc0 sc0 ls0 ws234">do<span class="_ _4"></span>wn into </div><div class="t m5 x66 h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 xaf h1d yb1e ffd fs3 fc0 sc0 ls0 ws234">, I’ll ha<span class="_ _4"></span>ve to pass</div><div class="t m0 xd h1d yb1f ffd fs3 fc0 sc0 ls0 ws0">both</div><div class="t m5 x8e h2f yb1f ffb fs10 fc0 sc0 ls0 ws0">args</div><div class="t m0 x5f h1d yb1f ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xe h2f yb1f ffb fs10 fc0 sc0 ls0 ws0">currentArgs</div><div class="t m0 x2f h1d yb1f ffd fs3 fc0 sc0 ls0 ws6aa">as function arguments. <span class="_ _4"></span>That’<span class="_ _4"></span>s dirty [F1]. I’<span class="_ _1"></span>d rather pass one</div><div class="t m0 xd h1d yb20 ffd fs3 fc0 sc0 ls0 ws2e3">argument instead of tw<span class="_ _4"></span>o. Fortunately<span class="_ _1"></span>, there is a simple solution. W<span class="_ _0"></span>e can con<span class="_ _4"></span>vert the </div><div class="t m5 xbf h2f yb20 ffb fs10 fc0 sc0 ls0 ws0">args</div><div class="t m0 xd h1d y48b ffd fs3 fc0 sc0 ls0 ws3cb">array into a </div><div class="t m5 xc3 h2f y48b ffb fs10 fc0 sc0 ls0 ws0">list</div><div class="t m0 xbc h1d y48b ffd fs3 fc0 sc0 ls0 ws3cb">and pass an </div><div class="t m5 x1 h2f y48b ffb fs10 fc0 sc0 ls0 ws0">Iterator</div><div class="t m0 xe9 h1d y48b ffd fs3 fc0 sc0 ls0 ws3cb">do<span class="_ _4"></span>wn to the </div><div class="t m5 xea h2f y48b ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x85 h1d y48b ffd fs3 fc0 sc0 ls0 ws3cb">functions. The follo<span class="_ _4"></span>wing took me</div><div class="t m0 xd h1d y48c ffd fs3 fc0 sc0 ls0 ws3cb">ten steps, passing all the tests after each. But I’ll just sho<span class="_ _4"></span>w you the result. <span class="_ _0"></span>Y<span class="_ _0"></span>ou should be</div><div class="t m0 xd h1d y48d ffd fs3 fc0 sc0 ls0 ws0">able to ﬁgure out what most of the tiny little steps were.</div><div class="t m5 x74 h2f y10ab ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y10ac ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h46 y10ad ffc fs10 fc0 sc0 ls0 ws0">  private String[] args;</div><div class="t m5 x74 h2f y10ae ffb fs10 fc0 sc0 ls14 ws253">  private boolean valid = true;</div><div class="t m5 x74 h2f y10af ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; unexpectedArguments = new TreeSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y10b0 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x52 h2f y10b1 ffb fs10 fc0 sc0 ls0 ws0">new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y10b2 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y10b3 ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">Iterator&lt;String&gt;<span class="_ _4"></span><span class="ffb"> currentArgument;</span></span></div><div class="t m5 x74 h2f y10b4 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f y10b5 ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h2f y10b6 ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x3e h46 y10b7 ffc fs10 fc0 sc0 ls0 ws0">private List&lt;String&gt; argsList;</div><div class="t m5 x74 h2f y10b8 ffb fs10 fc0 sc0 ls0 ws0">  private enum ErrorCode {</div><div class="t m5 x74 h2f y10b9 ffb fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT}</div><div class="t m5 x74 h2f y10ba ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ParseException {</div><div class="t m5 x74 h2f y10bb ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x9a h46 y10bc ffc fs10 fc0 sc0 ls0 ws0">argsList = Arrays.asList(args);</div><div class="t m5 x74 h2f y10bd ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f y10be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y10bf ffb fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f y10c0 ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f y10c1 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y10c2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10c3 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y10c4 ffb fs10 fc0 sc0 ls0 ws0">      return intValue;</div><div class="t m5 x74 h2f y10c5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y10c7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-12 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java (After first refactoring)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf107" class="pf w1 h2" data-page-no="107"><div class="pc pc107 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">232<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() throws ParseException {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; <span class="_ _4"></span><span class="ffc">argsList.size()<span class="ffb"> == 0)</span></span></div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">      parseArguments();</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">---</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseArguments() throws ArgsException {</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">    for (currentArgument = <span class="_ _4"></span><span class="ffc">argsList.iterator()<span class="ffb">; currentArgument.<span class="_ _4"></span><span class="ffc">hasNext()<span class="ffb">;) {</span></span></span></span></div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      String arg = currentArgument.<span class="_ _4"></span><span class="ffc">next()<span class="ffb">;</span></span></div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">---</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">  private void setIntArg(ArgumentMarshaler m) throws ArgsException {</div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">    String parameter = null;</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yf9f ffb fs10 fc0 sc0 ls0 ws0">      parameter = currentArgument.<span class="_ _4"></span><span class="ffc">next()<span class="ffb">;</span></span></div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">      m.set(parameter);</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">    } catch (<span class="ffc">NoSuchElementException<span class="_ _4"></span><span class="ffb"> e) {</span></span></div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfa8 ffb fs10 fc0 sc0 ls0 ws0">  private void setStringArg(ArgumentMarshaler m) throws ArgsException {</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yfa9 ffb fs10 fc0 sc0 ls0 ws0">      m.set(currentArgument<span class="_ _4"></span><span class="ffc">.next()<span class="ffb">);</span></span></div><div class="t m5 x74 h2f yfaa ffb fs10 fc0 sc0 ls0 ws0">    } catch (<span class="ffc">NoSuchElementException<span class="_ _4"></span><span class="ffb"> e) {</span></span></div><div class="t m5 x74 h2f yfab ffb fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_STRING;</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h2f yffd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1d0 ff8 fs3 fc0 sc0 ls0 ws6ab">These w<span class="_ _4"></span>ere simple changes that kept all the tests passing. No<span class="_ _4"></span>w w<span class="_ _4"></span>e can star<span class="_ _8"></span>t mo<span class="_ _4"></span>ving the </div><div class="t m5 x25 h2f y1d0 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 xd h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws412">functions do<span class="_ _4"></span>wn into the appropriate deriv<span class="_ _4"></span>ati<span class="_ _4"></span>ves. First, I need to mak<span class="_ _4"></span>e the following change</div><div class="t m0 xd h14 y1d2 ff8 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m5 xcd h2f y1d2 ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 x14 h14 y1d2 ff8 fs3 fc0 sc0 ls0 ws0">:</div><div class="t m5 x52 h2f y10c8 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y10c9 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h46 y10ca ffc fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h46 y10cb ffc fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y10cc ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y10cd ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f y10ce ffb fs10 fc0 sc0 ls0 ws0">        setBooleanArg(m);</div><div class="t m5 x74 h2f y10cf ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f y10d0 ffb fs10 fc0 sc0 ls0 ws0">        setStringArg(m);</div><div class="t m5 x74 h2f y10d1 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y10d2 ffb fs10 fc0 sc0 ls0 ws0">        setIntArg(m);</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf108" class="pf w1 h2" data-page-no="108"><div class="pc pc108 w1 h2"><img class="bi x74 y10d3 w17 ha0" alt="" src="bg108.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">233<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h46 y345 ffc fs10 fc0 sc0 ls0 ws0">      else</div><div class="t m5 x74 h46 y10d4 ffc fs10 fc0 sc0 ls0 ws0">        return false;</div><div class="t m5 x74 h2f ya7a ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f yee0 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f yee1 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f yee2 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f yee3 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yee4 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f yee5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws6ac">This change is important because we w<span class="_ _4"></span>ant to completely eliminate the </div><div class="t m5 x5e h2f y19b ffb fs10 fc0 sc0 ls0 ws0">if-else</div><div class="t m0 x36 h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">chain.</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">Therefore, w<span class="_ _4"></span>e needed to get the er<span class="_ _8"></span>ror condition out of it. </div><div class="t m0 x74 h1d y1fc ffd fs3 fc0 sc0 ls0 ws67">Now we can start to mo<span class="_ _4"></span>ve the </div><div class="t m5 x20 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 xe9 h1d y1fc ffd fs3 fc0 sc0 ls0 ws266">functions. The </div><div class="t m5 x88 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 xeb h1d y1fc ffd fs3 fc0 sc0 ls0 ws67">function is tri<span class="_ _4"></span>vial, so</div><div class="t m0 xd h1d y208 ffd fs3 fc0 sc0 ls0 ws9">we’ll prepare that one ﬁrst. Our goal is to change the </div><div class="t m5 xb4 h2f y208 ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x82 h1d y208 ffd fs3 fc0 sc0 ls0 ws9">function to simply for-</div><div class="t m0 xd h1d y21a ffd fs3 fc0 sc0 ls0 ws0">ward to the </div><div class="t m5 x4c h2f y21a ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 x9c h1d y21a ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y41d ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y41e ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y41f ffb fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h2f y420 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y421 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y422 ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f y10d5 ffb fs10 fc0 sc0 ls0 ws0">        setBooleanArg(m, <span class="_ _4"></span><span class="ffc">currentArgument<span class="ffb">);</span></span></div><div class="t m5 x74 h2f y10d6 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f y10d7 ffb fs10 fc0 sc0 ls0 ws0">        setStringArg(m);</div><div class="t m5 x74 h2f y10d8 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y10d9 ffb fs10 fc0 sc0 ls0 ws0">        setIntArg(m);</div><div class="t m5 x74 h2f y10da ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y10db ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y10dc ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y10dd ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y10de ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10df ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y10e0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y10e1 ffb fs10 fc0 sc0 ls0 ws0">---</div><div class="t m5 x74 h2f y10e2 ffb fs10 fc0 sc0 ls0 ws0">  private void setBooleanArg(ArgumentMarshaler m, </div><div class="t m5 x5b h46 y10e3 ffc fs10 fc0 sc0 ls0 ws0">Iterator&lt;String&gt; currentArgument) </div><div class="t m5 x74 h2f y10e4 ffb fs10 fc0 sc0 ls0 ws0">                             throws ArgsException {</div><div class="t m5 x52 h46 y10e5 ffc fs10 fc0 sc0 ls0 ws0">try {</div><div class="t m5 x74 h2f y10e6 ffb fs10 fc0 sc0 ls0 ws0">      m.set(&quot;true&quot;);</div><div class="t m5 x52 h46 y10e7 ffc fs10 fc0 sc0 ls0 ws0">catch (ArgsException e) {</div><div class="t m5 x74 h46 yb0f ffc fs10 fc0 sc0 ls0 ws0">   }</div><div class="t m5 x74 h2f y10e8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y1f2 ffd fs3 fc0 sc0 ls0 ws51b">Didn’t we just put that e<span class="_ _4"></span>xception processing in? Putting things in so you can take</div><div class="t m0 xd h1d y1f3 ffd fs3 fc0 sc0 lsc ws2a0">them out again is pretty common in refactoring. <span class="_ _4"></span>The smallness of the steps and the need to</div><div class="t m0 xd h1d y1f4 ffd fs3 fc0 sc0 ls0 ws56f">keep the tests running means that you mo<span class="_ _4"></span>ve things around a lot. Refactoring is a lot like</div><div class="t m0 xd h1d y1f5 ffd fs3 fc0 sc0 ls0 ws56a">solving a Rubik’<span class="_ _1"></span>s cube. There are lots of little steps required to achiev<span class="_ _4"></span>e a large goal. Each</div><div class="t m0 xd h1d y1f6 ffd fs3 fc0 sc0 ls0 ws0">step enables the next.</div><div class="t m0 x74 h1d yfaf ffd fs3 fc0 sc0 ls22 ws1ff">Why did we pass that </div><div class="t m5 x7 h2f yfaf ffb fs10 fc0 sc0 ls0 ws0">iterator</div><div class="t m0 x5b h1d yfaf ffd fs3 fc0 sc0 ls0 ws0">when</div><div class="t m5 x44 h2f yfaf ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x85 h1d yfaf ffd fs3 fc0 sc0 ls0 ws2c2">certainly doesn’t need it? Because</div><div class="t m5 xd h2f y60e ffb fs10 fc0 sc0 ls0 ws0">setIntArg</div><div class="t m0 x80 h1d y60e ffd fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x86 h2f y60e ffb fs10 fc0 sc0 ls0 ws0">setStringArg</div><div class="t m0 x57 h1d y60e ffd fs3 fc0 sc0 ls0 ws6ad">will! <span class="_ _1"></span>And because I want to deploy all three of these functions</div><div class="t m0 xd h1d y482 ffd fs3 fc0 sc0 ls0 ws0">through an abstract method in </div><div class="t m5 x8f h2f y482 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 xde h1d y482 ffd fs3 fc0 sc0 ls0 ws0">, I need to pass it to </div><div class="t m5 x59 h2f y482 ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x36 h1d y482 ffd fs3 fc0 sc0 ls0 ws0">.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf109" class="pf w1 h2" data-page-no="109"><div class="pc pc109 w1 h2"><img class="bi x74 y10e9 w18 h27" alt="" src="bg109.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">234<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws6ae">So no<span class="_ _4"></span>w </div><div class="t m5 xc3 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x1f h1d y194 ffd fs3 fc0 sc0 ls0 ws6ae">is useless. If there were a </div><div class="t m5 xd2 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x85 h1d y194 ffd fs3 fc0 sc0 ls0 ws6ae">function in </div><div class="t m5 x82 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xbf h1d y194 ffd fs3 fc0 sc0 ls0 ws6ae">, we</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws3b5">could call it directly<span class="_ _1"></span>. So it’<span class="_ _4"></span>s time to make that function! <span class="_ _4"></span>The ﬁrst step is to add the new</div><div class="t m0 xd h1d y196 ffd fs3 fc0 sc0 ls0 ws0">abstract method to </div><div class="t m5 xf2 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x26 h1d y196 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">private abstract class ArgumentMarshaler {</div><div class="t m5 x74 h46 y404 ffc fs10 fc0 sc0 ls0 ws0">    public abstract void set(Iterator&lt;String&gt; currentArgument) </div><div class="t m5 x74 h46 y405 ffc fs10 fc0 sc0 ls0 ws0">                         throws ArgsException;</div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls0 ws0">    public abstract void set(String s) throws ArgsException;</div><div class="t m5 x74 h2f y407 ffb fs10 fc0 sc0 ls0 ws0">    public abstract Object get();</div><div class="t m5 x74 h2f y73f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">Of course this breaks all the deri<span class="_ _4"></span>vati<span class="_ _4"></span>ves. So let’<span class="_ _2"></span>s implement the ne<span class="_ _4"></span>w method in each.</div><div class="t m5 x52 h2f yb38 ffb fs10 fc0 sc0 ls0 ws0">private class BooleanArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yb39 ffb fs10 fc0 sc0 ls0 ws0">    private boolean booleanValue = false;</div><div class="t m5 x9a h46 yb3b ffc fs10 fc0 sc0 ls0 ws0">public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x5f h46 y10ea ffc fs10 fc0 sc0 ls0 ws0">booleanValue = true;</div><div class="t m5 x74 h2f y10eb ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10ec ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h46 y10ed ffc fs10 fc0 sc0 ls0 ws0">      booleanValue = true;</div><div class="t m5 x74 h2f yfe5 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfe7 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y10ee ffb fs10 fc0 sc0 ls0 ws0">      return booleanValue;</div><div class="t m5 x74 h2f yfe8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfe9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfea ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f yfeb ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue = &quot;&quot;;</div><div class="t m5 x9a h46 yfed ffc fs10 fc0 sc0 ls0 ws0">public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h46 y10ef ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfef ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f yff0 ffb fs10 fc0 sc0 ls0 ws0">      stringValue = s;</div><div class="t m5 x74 h2f yff1 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10f0 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y10f1 ffb fs10 fc0 sc0 ls0 ws0">      return stringValue;</div><div class="t m5 x74 h2f y10f2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10f3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y10f4 ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y10f5 ffb fs10 fc0 sc0 ls0 ws0">    private int intValue = 0;</div><div class="t m5 x9a h46 y10f6 ffc fs10 fc0 sc0 ls0 ws0">public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h46 y10f7 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y10f8 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) throws ArgsException {</div><div class="t m5 x74 h2f y10f9 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f y10fa ffb fs10 fc0 sc0 ls0 ws0">        intValue = Integer.parseInt(s);</div><div class="t m5 x74 h2f y10fb ffb fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f y10fc ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f y10fd ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y10fe ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10a" class="pf w1 h2" data-page-no="10a"><div class="pc pc10a w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">235<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">      return intValue;</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">And no<span class="_ _4"></span>w w<span class="_ _4"></span>e can eliminate </div><div class="t m5 x1f h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">setBooleanArg</div><div class="t m0 x22 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">!</div><div class="t m5 x74 h2f yba8 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y10ff ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y1100 ffb fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h2f y1101 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y1102 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1103 ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x41 h2f y1104 ffc fs10 fc0 sc0 ls0 ws0">m.set<span class="ffb ls14">(currentArgument)<span class="_ _4"></span>;</span></div><div class="t m5 x74 h2f y1105 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h2f y1106 ffb fs10 fc0 sc0 ls0 ws0">        setStringArg(m);</div><div class="t m5 x74 h2f y1107 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h2f y1108 ffb fs10 fc0 sc0 ls0 ws0">        setIntArg(m);</div><div class="t m5 x74 h2f y1109 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y110a ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y110b ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y110c ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y110d ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y110e ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y110f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yb40 ff8 fs3 fc0 sc0 ls0 ws0">The tests all pass, and the </div><div class="t m5 x7 h2f yb40 ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x5a h14 yb40 ff8 fs3 fc0 sc0 ls0 ws0"> function is deplo<span class="_ _4"></span>ying to </div><div class="t m5 x88 h2f yb40 ffb fs10 fc0 sc0 ls0 ws0">BooleanArgumentMarshaler</div><div class="t m0 xda h14 yb40 ff8 fs3 fc0 sc0 ls0 ws0">!</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws0">No<span class="_ _4"></span>w w<span class="_ _4"></span>e can do the same for </div><div class="t m5 x5d h2f y74b ffb fs10 fc0 sc0 ls0 ws0">Strings</div><div class="t m0 x43 h14 y74b ff8 fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 x22 h2f y74b ffb fs10 fc0 sc0 ls0 ws0">Integers</div><div class="t m0 xc0 h14 y74b ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f y1049 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y104a ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y104b ffb fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h2f y104c ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y104d ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y104e ffb fs10 fc0 sc0 ls0 ws0">      if (m instanceof BooleanArgumentMarshaler)</div><div class="t m5 x74 h2f y104f ffb fs10 fc0 sc0 ls0 ws0">        m.set(currentArgument);</div><div class="t m5 x74 h2f y1050 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof StringArgumentMarshaler)</div><div class="t m5 x74 h46 y1051 ffc fs10 fc0 sc0 ls0 ws0">        m.set(currentArgument);</div><div class="t m5 x74 h2f y1052 ffb fs10 fc0 sc0 ls0 ws0">      else if (m instanceof IntegerArgumentMarshaler)</div><div class="t m5 x74 h46 y1110 ffc fs10 fc0 sc0 ls0 ws0">        m.set(currentArgument);</div><div class="t m5 x74 h2f y1054 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y1111 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y1112 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y1113 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y1114 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1115 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y1116 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1117 ffb fs10 fc0 sc0 ls0 ws0">---</div><div class="t m5 x74 h2f y1118 ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y1119 ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue = &quot;&quot;;</div><div class="t m5 x74 h2f y111a ffb fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 xcb h46 y111b ffc fs10 fc0 sc0 ls0 ws0"> try {</div><div class="t m5 x74 h46 y111c ffc fs10 fc0 sc0 ls0 ws0">        stringValue = currentArgument.next();</div><div class="t m5 x74 h46 y111d ffc fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h46 y111e ffc fs10 fc0 sc0 ls0 ws0">        errorCode = ErrorCode.MISSING_STRING;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10b" class="pf w1 h2" data-page-no="10b"><div class="pc pc10b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">236<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 xcb h46 y345 ffc fs10 fc0 sc0 ls0 ws0">   throw new ArgsException();</div><div class="t m5 x74 h46 y627 ffc fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">      return stringValue;</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">    private int intValue = 0;</div><div class="t m5 x52 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x3e h46 y634 ffc fs10 fc0 sc0 ls0 ws0">  String parameter = null;</div><div class="t m5 x74 h46 y635 ffc fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h46 y9e2 ffc fs10 fc0 sc0 ls0 ws0">      parameter = currentArgument.next();</div><div class="t m5 x74 h46 ye37 ffc fs10 fc0 sc0 ls0 ws0">      set(parameter);</div><div class="t m5 x74 h46 yf9c ffc fs10 fc0 sc0 ls0 ws0">    } catch (NoSuchElementException e) {</div><div class="t m5 x74 h46 yf9d ffc fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h46 yf9e ffc fs10 fc0 sc0 ls0 ws0">      throw new ArgsException();</div><div class="t m5 x74 h46 yf9f ffc fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h46 yfb3 ffc fs10 fc0 sc0 ls0 ws0">      errorParameter = parameter;</div><div class="t m5 x74 h46 yfa0 ffc fs10 fc0 sc0 ls0 ws0">      errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h46 yfa1 ffc fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h46 yfa2 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x52 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">    public void set(String s) throws ArgsException {</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">        intValue = Integer.parseInt(s);</div><div class="t m5 x74 h2f yfa6 ffb fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f yfa7 ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f yfa8 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfaa ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f yfab ffb fs10 fc0 sc0 ls0 ws0">      return intValue;</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yffd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y111f ff8 fs3 fc0 sc0 ls0 ws0">And so the <span class="ffa">coup de gr<span class="_ _4"></span>ace<span class="ff8">: <span class="_ _1"></span>The type-case can be remov<span class="_ _4"></span>ed! <span class="_ _4"></span>T<span class="_ _0"></span>ouche!</span></span></div><div class="t m5 x52 h2f y1120 ffb fs10 fc0 sc0 ls0 ws0">private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y1121 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y1122 ffb fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h2f y1123 ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y1124 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1125 ffb fs10 fc0 sc0 ls0 ws0">      m.set(currentArgument);</div><div class="t m5 x74 h2f y1126 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y1127 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y1128 ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f y1129 ffb fs10 fc0 sc0 ls0 ws0">      errorArgumentId = argChar;</div><div class="t m5 x74 h2f y112a ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f y112b ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y112c ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10c" class="pf w1 h2" data-page-no="10c"><div class="pc pc10c w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">237<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws91">No<span class="_ _4"></span>w w<span class="_ _4"></span>e can get rid of some cr<span class="_ _8"></span>ufty functions in </div><div class="t m5 x42 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">IntegerArgumentMarshaler</div><div class="t m0 x5e h14 y194 ff8 fs3 fc0 sc0 ls0 ws91">and clean it up</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">a bit.</div><div class="t m5 x52 h2f y431 ffb fs10 fc0 sc0 ls0 ws0">private class IntegerArgumentMarshaler extends ArgumentMarshaler {</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">    private int intValue = 0</div><div class="t m5 x74 h2f yae1 ffb fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f yae2 ffb fs10 fc0 sc0 ls0 ws0">      String parameter = null;</div><div class="t m5 x74 h2f yae3 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f yae4 ffb fs10 fc0 sc0 ls0 ws0">        parameter = currentArgument.next();</div><div class="t m5 x41 h2f yae5 ffc fs10 fc0 sc0 ls0 ws0">intValue = Integer.parseInt<span class="_ _4"></span><span class="ffb">(parameter);</span></div><div class="t m5 x74 h2f yb87 ffb fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f y112d ffb fs10 fc0 sc0 ls0 ws0">        errorCode = ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f y112e ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f y112f ffb fs10 fc0 sc0 ls0 ws0">      } catch (<span class="ffc">NumberFormatException<span class="_ _4"></span><span class="ffb"> e) {</span></span></div><div class="t m5 x74 h2f y1130 ffb fs10 fc0 sc0 ls0 ws0">        errorParameter = parameter;</div><div class="t m5 x74 h2f y1131 ffb fs10 fc0 sc0 ls0 ws0">        errorCode = ErrorCode.INVALID_INTEGER;</div><div class="t m5 x74 h2f y1132 ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f y1133 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y1134 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1135 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y1136 ffb fs10 fc0 sc0 ls0 ws0">      return intValue;</div><div class="t m5 x74 h2f y1137 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1138 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yb40 ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e can also turn </div><div class="t m5 xbc h46 yb40 ffc fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x5b h14 yb40 ff8 fs3 fc0 sc0 ls0 ws0"> into an interface. </div><div class="t m5 x52 h2f y1139 ffb fs10 fc0 sc0 ls0 ws0">private <span class="ffc">interface</span> ArgumentMarshaler {</div><div class="t m5 x74 h2f y113a ffb fs10 fc0 sc0 ls0 ws0">    void set(Iterator&lt;String&gt; currentArgument) throws ArgsException;</div><div class="t m5 x74 h2f y113b ffb fs10 fc0 sc0 ls0 ws0">    Object get();</div><div class="t m5 x74 h2f y113c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y96e ffd fs3 fc0 sc0 ls0 ws677">So now let’<span class="_ _0"></span>s see how easy it is to add a ne<span class="_ _4"></span>w argument type to our structure. It should</div><div class="t m0 xd h1d y952 ffd fs3 fc0 sc0 ls0 ws6af">require very fe<span class="_ _4"></span>w changes, and those changes should be isolated. First, we begin by adding</div><div class="t m0 xd h1d y953 ffd fs3 fc0 sc0 ls0 ws0">a new test case to check that the </div><div class="t m5 x92 h2f y953 ffb fs10 fc0 sc0 ls0 ws0">double</div><div class="t m0 x5c h1d y953 ffd fs3 fc0 sc0 ls0 ws0"> argument w<span class="_ _4"></span>orks correctly<span class="_ _1"></span>.</div><div class="t m5 x52 h2f y2ca ffb fs10 fc0 sc0 ls0 ws0">public void testSimpleDoublePresent() throws Exception {</div><div class="t m5 x74 h2f y113d ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x##&quot;, new String[] {&quot;-x&quot;,&quot;42.3&quot;});</div><div class="t m5 x74 h2f y113e ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.isValid());</div><div class="t m5 x74 h2f y113f ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(1, args.cardinality());</div><div class="t m5 x74 h2f y1140 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f y1141 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(42.3, args.getDouble(&apos;x&apos;), .001);</div><div class="t m5 x74 h2f y1142 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws6b0">No<span class="_ _4"></span>w w<span class="_ _4"></span>e clean up the schema parsing code and add the </div><div class="t m5 x7f h2f y1d1 ffb fs10 fc0 sc0 ls0 ws0">##</div><div class="t m0 xa0 h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws6b0">detection for the </div><div class="t m5 xa8 h2f y1d1 ffb fs10 fc0 sc0 ls0 ws0">double</div><div class="t m0 xd h14 y1d2 ff8 fs3 fc0 sc0 ls0 ws0">argument type.</div><div class="t m5 x52 h2f y10c8 ffb fs10 fc0 sc0 ls0 ws0">private void parseSchemaElement(String element) throws ParseException {</div><div class="t m5 x74 h2f y10c9 ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y10ca ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y10cb ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y10cc ffb fs10 fc0 sc0 ls0 ws0">    if (elementTail.<span class="_ _4"></span><span class="ffc">length() == 0<span class="ffb">)</span></span></div><div class="t m5 x74 h2f y10cd ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new BooleanArgumentMarshaler());</div><div class="t m5 x74 h2f y10ce ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.<span class="_ _4"></span><span class="ffc">equals(&quot;*&quot;)<span class="ffb">)</span></span></div><div class="t m5 x74 h2f y10cf ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArgumentMarshaler());</div><div class="t m5 x74 h2f y10d0 ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.<span class="_ _4"></span><span class="ffc">equals(&quot;#&quot;)<span class="ffb">)</span></span></div><div class="t m5 x74 h2f y10d1 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new IntegerArgumentMarshaler());</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10d" class="pf w1 h2" data-page-no="10d"><div class="pc pc10d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">238<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x9a h46 y345 ffc fs10 fc0 sc0 ls0 ws0">else if (elementTail.equals(&quot;##&quot;))</div><div class="t m5 x74 h46 y627 ffc fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new DoubleArgumentMarshaler());</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">      throw new ParseException(String.format(</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">        &quot;Argument: %c has invalid format: %s.&quot;, elementId, elementTail), 0);</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">Next, w<span class="_ _1"></span>e write the </div><div class="t m5 x18 h2f y199 ffb fs10 fc0 sc0 ls0 ws0">DoubleArgumentMarshaler</div><div class="t m0 xaa h14 y199 ff8 fs3 fc0 sc0 ls0 ws0"> class.</div><div class="t m5 x52 h46 y441 ffc fs10 fc0 sc0 ls0 ws0">private class DoubleArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h46 y442 ffc fs10 fc0 sc0 ls0 ws0">    private double doubleValue = 0;</div><div class="t m5 x74 h46 y1143 ffc fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h46 y1144 ffc fs10 fc0 sc0 ls0 ws0">      String parameter = null;</div><div class="t m5 x74 h46 y1145 ffc fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h46 y1146 ffc fs10 fc0 sc0 ls0 ws0">        parameter = currentArgument.next();</div><div class="t m5 x74 h46 y1147 ffc fs10 fc0 sc0 ls0 ws0">        doubleValue = Double.parseDouble(parameter);</div><div class="t m5 x74 h46 y1148 ffc fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h46 y1149 ffc fs10 fc0 sc0 ls0 ws0">        errorCode = ErrorCode.MISSING_DOUBLE;</div><div class="t m5 x74 h46 y114a ffc fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h46 y114b ffc fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h46 y114c ffc fs10 fc0 sc0 ls0 ws0">        errorParameter = parameter;</div><div class="t m5 x74 h46 y114d ffc fs10 fc0 sc0 ls0 ws0">        errorCode = ErrorCode.INVALID_DOUBLE;</div><div class="t m5 x74 h46 y114e ffc fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h46 y114f ffc fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h46 y1150 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 y1151 ffc fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h46 y1152 ffc fs10 fc0 sc0 ls0 ws0">      return doubleValue;</div><div class="t m5 x74 h46 y1153 ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 y1154 ffc fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y96d ff8 fs3 fc0 sc0 ls0 ws0">This forces us to add a ne<span class="_ _4"></span>w </div><div class="t m5 x2f h2f y96d ffb fs10 fc0 sc0 ls0 ws0">ErrorCode</div><div class="t m0 x9c h14 y96d ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f yf8f ffb fs10 fc0 sc0 ls0 ws0">private enum ErrorCode {</div><div class="t m5 x74 h2f yf90 ffb fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT, </div><div class="t m5 x9a h2f yf91 ffc fs10 fc0 sc0 ls0 ws0">MISSING_DOUBLE, INVALID_DOUBLE<span class="_ _4"></span><span class="ffb">}</span></div><div class="t m0 xd h14 ybf3 ff8 fs3 fc0 sc0 ls0 ws0">And w<span class="_ _4"></span>e need a </div><div class="t m5 x39 h2f ybf3 ffb fs10 fc0 sc0 ls0 ws0">getDouble</div><div class="t m0 x15 h14 ybf3 ff8 fs3 fc0 sc0 ls0 ws0"> function.</div><div class="t m5 x52 h46 y108b ffc fs10 fc0 sc0 ls0 ws0">public double getDouble(char arg) {</div><div class="t m5 x74 h46 y1155 ffc fs10 fc0 sc0 ls0 ws0">    Args.ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h46 y1156 ffc fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h46 y1157 ffc fs10 fc0 sc0 ls0 ws0">      return am == null ? 0 : (Double) am.get();</div><div class="t m5 x74 h46 y1158 ffc fs10 fc0 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h46 y1159 ffc fs10 fc0 sc0 ls0 ws0">      return 0.0;</div><div class="t m5 x74 h46 y115a ffc fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 y115b ffc fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1d y1d3 ffd fs3 fc0 sc0 ls0 ws5ff">And all the tests pass! That w<span class="_ _4"></span>as pretty painless. So now let’<span class="_ _1"></span>s make sure all the error</div><div class="t m0 xd h1d y1d4 ffd fs3 fc0 sc0 ls0 ws6b1">processing works correctly<span class="_ _1"></span>. The ne<span class="_ _4"></span>xt test case checks that an error is declared if an</div><div class="t m0 xd h1d y1d5 ffd fs3 fc0 sc0 ls0 ws0">unparseable string is fed to a </div><div class="t m5 x5a h2f y1d5 ffb fs10 fc0 sc0 ls0 ws0">##</div><div class="t m0 x92 h1d y1d5 ffd fs3 fc0 sc0 ls0 ws0">argument.</div><div class="t m5 x52 h2f y115c ffb fs10 fc0 sc0 ls0 ws0">public void testInvalidDouble() throws Exception {</div><div class="t m5 x74 h2f y115d ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x##&quot;, new String[] {&quot;-x&quot;,&quot;Forty two&quot;});</div><div class="t m5 x74 h2f y115e ffb fs10 fc0 sc0 ls0 ws0">    assertFalse(args.isValid());</div><div class="t m5 x74 h2f y115f ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(0, args.cardinality());</div><div class="t m5 x74 h2f y1160 ffb fs10 fc0 sc0 ls0 ws0">    assertFalse(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f y1161 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(0, args.getInt(&apos;x&apos;));</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10e" class="pf w1 h2" data-page-no="10e"><div class="pc pc10e w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">239<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Argument -x expects a double but was &apos;Forty two&apos;.&quot;, </div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">                 args.errorMessage());</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">---</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() throws Exception {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    switch (errorCode) {</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">      case OK:</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">        throw new Exception(&quot;TILT: Should not get here.&quot;);</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">      case UNEXPECTED_ARGUMENT:</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">        return unexpectedArgumentMessage();</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_STRING:</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_INTEGER:</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects an integer but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_INTEGER:</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find integer parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x9a h46 ye37 ffc fs10 fc0 sc0 ls0 ws0">  case INVALID_DOUBLE:</div><div class="t m5 x74 h46 yf9c ffc fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects a double but was &apos;%s&apos;.&quot;,</div><div class="t m5 x74 h46 yf9d ffc fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h46 yf9e ffc fs10 fc0 sc0 ls0 ws0">      case MISSING_DOUBLE:</div><div class="t m5 x74 h46 yf9f ffc fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find double parameter for -%c.&quot;, </div><div class="t m5 x74 h46 yfb3 ffc fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 yb05 ff8 fs3 fc0 sc0 ls0 ws6b2">And the tests pass. <span class="_ _1"></span>The next test makes sure w<span class="_ _4"></span>e detect a missing </div><div class="t m5 x55 h2f yb05 ffb fs10 fc0 sc0 ls0 ws0">double</div><div class="t m0 x6b h14 yb05 ff8 fs3 fc0 sc0 ls0 ws6b2">argument properl<span class="_ _4"></span>y<span class="_ _0"></span>. </div><div class="t m5 x52 h46 y805 ffc fs10 fc0 sc0 ls0 ws0">public void testMissingDouble() throws Exception {</div><div class="t m5 x74 h46 yb06 ffc fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x##&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h46 yb07 ffc fs10 fc0 sc0 ls0 ws0">    assertFalse(args.isValid());</div><div class="t m5 x74 h46 yb08 ffc fs10 fc0 sc0 ls0 ws0">    assertEquals(0, args.cardinality());</div><div class="t m5 x74 h46 yb09 ffc fs10 fc0 sc0 ls0 ws0">    assertFalse(args.has(&apos;x&apos;));</div><div class="t m5 x74 h46 yb0a ffc fs10 fc0 sc0 ls0 ws0">    assertEquals(0.0, args.getDouble(&apos;x&apos;), 0.01);</div><div class="t m5 x74 h46 yb0b ffc fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Could not find double parameter for -x.&quot;, </div><div class="t m5 x74 h46 yb0c ffc fs10 fc0 sc0 ls0 ws0">                 args.errorMessage());</div><div class="t m5 x74 h46 yb0d ffc fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y9e9 ff8 fs3 fc0 sc0 ls0 ws0">This passes as expected. <span class="_ _4"></span>W<span class="_ _0"></span>e wrote it simply for completeness. </div><div class="t m0 x74 h1d y9fa ffd fs3 fc0 sc0 ls0 ws84">The exception code is pretty ugly and doesn’<span class="_ _4"></span>t really belong in the </div><div class="t m5 xc1 h2f y9fa ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xa6 h1d y9fa ffd fs3 fc0 sc0 ls0 ws1ad">class. W<span class="_ _0"></span>e <span class="_ _5"></span>are</div><div class="t m0 xd h1d y9fb ffd fs3 fc0 sc0 ls0 ws9d">also throwing out </div><div class="t m5 x87 h2f y1162 ffb fs10 fc0 sc0 ls0 ws0">ParseException</div><div class="t m0 xec h1d y1162 ffd fs3 fc0 sc0 ls0 ws9d">, which doesn’t really belong to us. So let’<span class="_ _1"></span>s merge all the</div><div class="t m0 xd h1d y1163 ffd fs3 fc0 sc0 ls0 ws0">exceptions into a single </div><div class="t m5 x6e h2f y1163 ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x32 h1d y1163 ffd fs3 fc0 sc0 ls0 ws0"> class and mov<span class="_ _4"></span>e it into its own module.</div><div class="t m5 x74 h46 yf60 ffc fs10 fc0 sc0 ls0 ws0">public class ArgsException extends Exception {</div><div class="t m5 x74 h46 y1164 ffc fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h46 yf61 ffc fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h46 yf62 ffc fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x74 h46 yf63 ffc fs10 fc0 sc0 ls0 ws0">  public ArgsException() {}</div><div class="t m5 x74 h46 yf65 ffc fs10 fc0 sc0 ls0 ws0">  public ArgsException(String message) {super(message);}</div><div class="t m5 x74 h46 yf67 ffc fs10 fc0 sc0 ls0 ws0">  public enum ErrorCode {</div><div class="t m5 x74 h46 yf68 ffc fs10 fc0 sc0 ls0 ws0">    OK, MISSING_STRING, MISSING_INTEGER, INVALID_INTEGER, UNEXPECTED_ARGUMENT, </div><div class="t m5 x74 h46 yf69 ffc fs10 fc0 sc0 ls0 ws0">    MISSING_DOUBLE, INVALID_DOUBLE}</div><div class="t m5 x74 h46 y1165 ffc fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y1166 ffb fs10 fc0 sc0 ls0 ws0">---</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf10f" class="pf w1 h2" data-page-no="10f"><div class="pc pc10f w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">240<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">.ErrorCode errorCode = <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">.ErrorCode.OK;</span></span></span></span></div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;String&gt; argsList;</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws <span class="_ _1"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    argsList = Arrays.asList(args);</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">    valid = parse();</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parse() throws <span class="_ _4"></span>ArgsException {</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() == 0 &amp;&amp; argsList.size() == 0)</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">      parseArguments();</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">    } catch (<span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb"> e) {</span></span></div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">    return valid;</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() throws <span class="_ _1"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws <span class="_ _1"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">    ...</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">      throw new <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">(</span></span></div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">        String.format(&quot;Argument: %c has invalid format: %s.&quot;, </div><div class="t m5 x74 h2f yfa6 ffb fs10 fc0 sc0 ls0 ws0">                      elementId,elementTail));</div><div class="t m5 x74 h2f yfa7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws <span class="_ _0"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f yfa9 ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId)) {</div><div class="t m5 x74 h2f yfaa ffb fs10 fc0 sc0 ls0 ws0">      throw new <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">(</span></span></div><div class="t m5 x74 h2f yfab ffb fs10 fc0 sc0 ls0 ws0">        &quot;Bad character:&quot; + elementId + &quot;in Args format: &quot; + schema);</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yffd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfb8 ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f y1167 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) throws <span class="_ _1"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f yfba ffb fs10 fc0 sc0 ls0 ws0">    if (setArgument(argChar))</div><div class="t m5 x74 h2f yfbb ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f yfbc ffb fs10 fc0 sc0 ls0 ws0">    else {</div><div class="t m5 x74 h2f y1168 ffb fs10 fc0 sc0 ls0 ws0">      unexpectedArguments.add(argChar);</div><div class="t m5 x74 h2f yfbd ffb fs10 fc0 sc0 ls0 ws0">      errorCode = <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">.ErrorCode.UNEXPECTED_ARGUMENT;</span></span></div><div class="t m5 x74 h2f yfbe ffb fs10 fc0 sc0 ls0 ws0">      valid = false;</div><div class="t m5 x74 h2f yfbf ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yffe ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfc1 ffb fs10 fc0 sc0 ls0 ws0">  ...</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf110" class="pf w1 h2" data-page-no="110"><div class="pc pc110 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">241<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  private class StringArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    private String stringValue = &quot;&quot;;</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">        stringValue = currentArgument.next();</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">        errorCode = <span class="_ _4"></span><span class="ffc">ArgsException<span class="ffb">.ErrorCode.MISSING_STRING;</span></span></div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      return stringValue;</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">  private class IntegerArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">    private int intValue = 0;</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws <span class="_ _0"></span><span class="ffc">ArgsException<span class="ffb"> {</span></span></div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">      String parameter = null;</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f yf9f ffb fs10 fc0 sc0 ls0 ws0">        parameter = currentArgument.next();</div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">        intValue = Integer.parseInt(parameter);</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">        errorCode = <span class="_ _4"></span>ArgsException.ErrorCode.MISSING_INTEGER;</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">        throw new <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">();</span></span></div><div class="t m5 x74 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">        errorParameter = parameter;</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">        errorCode = <span class="_ _4"></span><span class="ffc">ArgsException<span class="ffb">.ErrorCode.INVALID_INTEGER;</span></span></div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">        throw new <span class="ffc">ArgsException<span class="_ _4"></span><span class="ffb">();</span></span></div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yfa6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa8 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">      return intValue;</div><div class="t m5 x74 h2f yfa9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfaa ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yfac ffb fs10 fc0 sc0 ls0 ws0">  private class DoubleArgumentMarshaler implements ArgumentMarshaler {</div><div class="t m5 x74 h2f yffd ffb fs10 fc0 sc0 ls0 ws0">    private double doubleValue = 0;</div><div class="t m5 x74 h2f yfb8 ffb fs10 fc0 sc0 ls0 ws0">    public void set(Iterator&lt;String&gt; currentArgument) throws ArgsException {</div><div class="t m5 x74 h2f yfb9 ffb fs10 fc0 sc0 ls0 ws0">      String parameter = null;</div><div class="t m5 x74 h2f y1167 ffb fs10 fc0 sc0 ls0 ws0">      try {</div><div class="t m5 x74 h2f yfba ffb fs10 fc0 sc0 ls0 ws0">        parameter = currentArgument.next();</div><div class="t m5 x74 h2f yfbb ffb fs10 fc0 sc0 ls0 ws0">        doubleValue = Double.parseDouble(parameter);</div><div class="t m5 x74 h2f yfbc ffb fs10 fc0 sc0 ls0 ws0">      } catch (NoSuchElementException e) {</div><div class="t m5 x74 h2f y1168 ffb fs10 fc0 sc0 ls0 ws0">        errorCode = <span class="_ _4"></span><span class="ffc">ArgsException<span class="ffb">.ErrorCode.MISSING_DOUBLE;</span></span></div><div class="t m5 x74 h2f yfbd ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f yfbe ffb fs10 fc0 sc0 ls0 ws0">      } catch (NumberFormatException e) {</div><div class="t m5 x74 h2f yfbf ffb fs10 fc0 sc0 ls0 ws0">        errorParameter = parameter;</div><div class="t m5 x74 h2f yffe ffb fs10 fc0 sc0 ls0 ws0">        errorCode = <span class="_ _4"></span><span class="ffc">ArgsException<span class="ffb">.ErrorCode.INVALID_DOUBLE;</span></span></div><div class="t m5 x74 h2f yfc0 ffb fs10 fc0 sc0 ls0 ws0">        throw new ArgsException();</div><div class="t m5 x74 h2f yfc1 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yfc2 ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf111" class="pf w1 h2" data-page-no="111"><div class="pc pc111 w1 h2"><img class="bi xd y45f wc ha1" alt="" src="bg111.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">242<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">    public Object get() {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">      return doubleValue;</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1d y1bd ffd fs3 fc0 sc0 ls0 ws6b3">This is nice. No<span class="_ _4"></span>w the only exception thrown by </div><div class="t m5 x61 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xab h1d y1bd ffd fs3 fc0 sc0 ls0 ws0">is</div><div class="t m5 xb5 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 xda h1d y1bd ffd fs3 fc0 sc0 ls0 ws6b3">. Moving</div><div class="t m5 xd h2f y1be ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 xe h1d y1be ffd fs3 fc0 sc0 ls0 ws64a">into its own module means that we can mo<span class="_ _4"></span>ve a lot of the miscellaneous</div><div class="t m0 xd h1d y19a ffd fs3 fc0 sc0 ls0 wsfc">error support code into that module and out of the </div><div class="t m5 x7e h2f y19a ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xb6 h1d y19a ffd fs3 fc0 sc0 ls0 wsfc">module. It provides a natural and</div><div class="t m0 xd h1d y19b ffd fs3 fc0 sc0 ls0 wse8">obvious place to put all that code and will really help us clean up the </div><div class="t m5 xac h2f y19b ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xbb h1d y19b ffd fs3 fc0 sc0 ls0 wse8">module going</div><div class="t m0 xd h1d y19c ffd fs3 fc0 sc0 ls0 ws0">forward.</div><div class="t m0 x74 h1d y1fc ffd fs3 fc0 sc0 ls0 ws5ee">So now we ha<span class="_ _4"></span>ve completely separated the e<span class="_ _4"></span>xception and error code from the </div><div class="t m5 xbf h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xd h1d y208 ffd fs3 fc0 sc0 ls0 ws44a">module. (See Listing 14-13 through Listing 14-16.) This w<span class="_ _4"></span>as achieved through a series of</div><div class="t m0 xd h1d y21a ffd fs3 fc0 sc0 ls0 ws0">about 30 tiny steps, keeping the tests passing between each step. </div><div class="t m0 x74 h1c y1169 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-13 </div><div class="t m0 x74 h36 y36c ffc fs3 fc0 sc0 ls0 ws0">ArgsTest.java</div><div class="t m5 x74 h2f y6d0 ffb fs10 fc0 sc0 ls0 ws0">package com.objectmentor.utilities.args;</div><div class="t m5 x74 h2f y6d2 ffb fs10 fc0 sc0 ls0 ws0">import junit.framework.TestCase;</div><div class="t m5 x74 h2f y116a ffb fs10 fc0 sc0 ls0 ws0">public class ArgsTest extends TestCase {</div><div class="t m5 x74 h2f y116b ffb fs10 fc0 sc0 ls0 ws0">  public void testCreateWithNoSchemaOrArguments() throws Exception {</div><div class="t m5 x74 h2f y116c ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;&quot;, new String[0]);</div><div class="t m5 x74 h2f y116d ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(0, args.cardinality());</div><div class="t m5 x74 h2f y116e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y116f ffb fs10 fc0 sc0 ls0 ws0">  public void testWithNoSchemaButWithOneArgument() throws Exception {</div><div class="t m5 x74 h2f y1170 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1171 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h2f y1172 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y1173 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y1174 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.UNEXPECTED_ARGUMENT, </div><div class="t m5 x74 h2f y1175 ffb fs10 fc0 sc0 ls0 ws0">                   e.getErrorCode());</div><div class="t m5 x74 h2f y1176 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y1177 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1178 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1179 ffb fs10 fc0 sc0 ls0 ws0">  public void testWithNoSchemaButWithMultipleArguments() throws Exception {</div><div class="t m5 x74 h2f y117a ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y117b ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;&quot;, new String[]{&quot;-x&quot;, &quot;-y&quot;});</div><div class="t m5 x74 h2f y117c ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y117d ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y117e ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.UNEXPECTED_ARGUMENT, </div><div class="t m5 x74 h2f y117f ffb fs10 fc0 sc0 ls0 ws0">                   e.getErrorCode());</div><div class="t m5 x74 h2f y1180 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y1181 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1182 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1183 ffb fs10 fc0 sc0 ls0 ws0">  public void testNonLetterSchema() throws Exception {</div><div class="t m5 x74 h2f y1184 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1185 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;*&quot;, new String[]{});</div><div class="t m5 x74 h2f y1186 ffb fs10 fc0 sc0 ls0 ws0">      fail(&quot;Args constructor should have thrown exception&quot;);</div><div class="t m5 x74 h2f y1187 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf112" class="pf w1 h2" data-page-no="112"><div class="pc pc112 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg112.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">243<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.INVALID_ARGUMENT_NAME, </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">                   e.getErrorCode());</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;*&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  public void testInvalidArgumentFormat() throws Exception {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;f~&quot;, new String[]{});</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">      fail(&quot;Args constructor should have throws exception&quot;);</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.INVALID_FORMAT, e.getErrorCode());</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;f&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  public void testSimpleBooleanPresent() throws Exception {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(1, args.cardinality());</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(true, args.getBoolean(&apos;x&apos;));</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  public void testSimpleStringPresent() throws Exception {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x*&quot;, new String[]{&quot;-x&quot;, &quot;param&quot;});</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(1, args.cardinality());</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;param&quot;, args.getString(&apos;x&apos;));</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingStringArgument() throws Exception {</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;x*&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.MISSING_STRING, e.getErrorCode());</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">  public void testSpacesInFormat() throws Exception {</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x, y&quot;, new String[]{&quot;-xy&quot;});</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(2, args.cardinality());</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;y&apos;));</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">  public void testSimpleIntPresent() throws Exception {</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x#&quot;, new String[]{&quot;-x&quot;, &quot;42&quot;});</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(1, args.cardinality());</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(42, args.getInt(&apos;x&apos;));</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  public void testInvalidInteger() throws Exception {</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y6b5 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;x#&quot;, new String[]{&quot;-x&quot;, &quot;Forty two&quot;});</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-13 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf113" class="pf w1 h2" data-page-no="113"><div class="pc pc113 w1 h2"><img class="bi xd ybdb wc h74" alt="" src="bg113.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">244<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.INVALID_INTEGER, e.getErrorCode());</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&quot;Forty two&quot;, e.getErrorParameter());</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingInteger() throws Exception {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;x#&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.MISSING_INTEGER, e.getErrorCode());</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  public void testSimpleDoublePresent() throws Exception {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    Args args = new Args(&quot;x##&quot;, new String[]{&quot;-x&quot;, &quot;42.3&quot;});</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(1, args.cardinality());</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    assertTrue(args.has(&apos;x&apos;));</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(42.3, args.getDouble(&apos;x&apos;), .001);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  public void testInvalidDouble() throws Exception {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;x##&quot;, new String[]{&quot;-x&quot;, &quot;Forty two&quot;});</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.INVALID_DOUBLE, e.getErrorCode());</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&quot;Forty two&quot;, e.getErrorParameter());</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingDouble() throws Exception {</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">      new Args(&quot;x##&quot;, new String[]{&quot;-x&quot;});</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      fail();</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(ArgsException.ErrorCode.MISSING_DOUBLE, e.getErrorCode());</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">      assertEquals(&apos;x&apos;, e.getErrorArgumentId());</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y1188 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-14 </div><div class="t m0 x74 h36 y1ff ffc fs3 fc0 sc0 ls0 ws0">ArgsExceptionTest.java</div><div class="t m5 x74 h2f y1189 ffb fs10 fc0 sc0 ls0 ws0">public class ArgsExceptionTest extends TestCase {</div><div class="t m5 x74 h2f y118a ffb fs10 fc0 sc0 ls0 ws0">  public void testUnexpectedMessage() throws Exception {</div><div class="t m5 x74 h2f y118b ffb fs10 fc0 sc0 ls0 ws0">    ArgsException e = </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-13 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf114" class="pf w1 h2" data-page-no="114"><div class="pc pc114 w1 h2"><img class="bi xd y118c wc ha2" alt="" src="bg114.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">245<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      new ArgsException(ArgsException.ErrorCode.UNEXPECTED_ARGUMENT, </div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">                        &apos;x&apos;, null);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Argument -x unexpected.&quot;, e.errorMessage());</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingStringMessage() throws Exception {</div><div class="t m5 x9a h2f y4be ffb fs10 fc0 sc0 ls0 ws689">ArgsException e = new ArgsException(ArgsException.ErrorCode.MISSING_STRING, </div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">                                        &apos;x&apos;, null);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Could not find string parameter for -x.&quot;, e.errorMessage());</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public void testInvalidIntegerMessage() throws Exception {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    ArgsException e = </div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">      new ArgsException(ArgsException.ErrorCode.INVALID_INTEGER, </div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">                        &apos;x&apos;, &quot;Forty two&quot;);</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Argument -x expects an integer but was &apos;Forty two&apos;.&quot;, </div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">                 e.errorMessage());</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingIntegerMessage() throws Exception {</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    ArgsException e = </div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">      new ArgsException(ArgsException.ErrorCode.MISSING_INTEGER, &apos;x&apos;, null);</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Could not find integer parameter for -x.&quot;, e.errorMessage());</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">  public void testInvalidDoubleMessage() throws Exception {</div><div class="t m5 x9a h2f y4d0 ffb fs10 fc0 sc0 ls0 ws689">ArgsException e = new ArgsException(ArgsException.ErrorCode.INVALID_DOUBLE, </div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">                                        &apos;x&apos;, &quot;Forty two&quot;);</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Argument -x expects a double but was &apos;Forty two&apos;.&quot;, </div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">                 e.errorMessage());</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  public void testMissingDoubleMessage() throws Exception {</div><div class="t m5 x9a h2f y6a8 ffb fs10 fc0 sc0 ls0 ws689">ArgsException e = new ArgsException(ArgsException.ErrorCode.MISSING_DOUBLE, </div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">                                        &apos;x&apos;, null);</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    assertEquals(&quot;Could not find double parameter for -x.&quot;, e.errorMessage());</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y118d ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-15 </div><div class="t m0 x74 h36 y118e ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div><div class="t m5 x74 h2f yff2 ffb fs10 fc0 sc0 ls0 ws0">public class ArgsException extends Exception {</div><div class="t m5 x74 h2f yff3 ffb fs10 fc0 sc0 ls0 ws0">  private char errorArgumentId = &apos;\0&apos;;</div><div class="t m5 x74 h2f yff4 ffb fs10 fc0 sc0 ls0 ws0">  private String errorParameter = &quot;TILT&quot;;</div><div class="t m5 x74 h2f yff5 ffb fs10 fc0 sc0 ls0 ws0">  private ErrorCode errorCode = ErrorCode.OK;</div><div class="t m5 x74 h2f yff7 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException() {}</div><div class="t m5 x74 h2f yff9 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(String message) {super(message);}</div><div class="t m5 x74 h2f yffb ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode) {</div><div class="t m5 x74 h2f yffc ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y118f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-14 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsExceptionTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf115" class="pf w1 h2" data-page-no="115"><div class="pc pc115 w1 h2"><img class="bi xd yf07 wc h95" alt="" src="bg115.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">246<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode, String errorParameter) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  public ArgsException(ErrorCode errorCode, char errorArgumentId, </div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">                       String errorParameter) {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    this.errorArgumentId = errorArgumentId;</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">  public char getErrorArgumentId() {</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    return errorArgumentId;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorArgumentId(char errorArgumentId) {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    this.errorArgumentId = errorArgumentId;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  public String getErrorParameter() {</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">    return errorParameter;</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorParameter(String errorParameter) {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    this.errorParameter = errorParameter;</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  public ErrorCode getErrorCode() {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    return errorCode;</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">  public void setErrorCode(ErrorCode errorCode) {</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    this.errorCode = errorCode;</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">  public String errorMessage() throws Exception {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    switch (errorCode) {</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">      case OK:</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">        throw new Exception(&quot;TILT: Should not get here.&quot;);</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">      case UNEXPECTED_ARGUMENT:</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c unexpected.&quot;, errorArgumentId);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_STRING:</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find string parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_INTEGER:</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects an integer but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_INTEGER:</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find integer parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      case INVALID_DOUBLE:</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Argument -%c expects a double but was &apos;%s&apos;.&quot;, </div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId, errorParameter);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-15 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf116" class="pf w1 h2" data-page-no="116"><div class="pc pc116 w1 h2"><img class="bi xd y1190 wc ha3" alt="" src="bg116.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">247<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">      case MISSING_DOUBLE:</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">        return String.format(&quot;Could not find double parameter for -%c.&quot;, </div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">                             errorArgumentId);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    return &quot;&quot;;</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  public enum ErrorCode {</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    OK, INVALID_FORMAT, UNEXPECTED_ARGUMENT, INVALID_ARGUMENT_NAME,</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_STRING,</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_INTEGER, INVALID_INTEGER,</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">    MISSING_DOUBLE, INVALID_DOUBLE}</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y9ce ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-16 </div><div class="t m0 x74 h36 yf27 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div><div class="t m5 x74 h2f y1191 ffb fs10 fc0 sc0 ls0 ws0">public class Args {</div><div class="t m5 x74 h2f y1192 ffb fs10 fc0 sc0 ls0 ws0">  private String schema;</div><div class="t m5 x74 h2f y1193 ffb fs10 fc0 sc0 ls0 ws0">  private Map&lt;Character, ArgumentMarshaler&gt; marshalers = </div><div class="t m5 x74 h2f y1194 ffb fs10 fc0 sc0 ls0 ws0">    new HashMap&lt;Character, ArgumentMarshaler&gt;();</div><div class="t m5 x74 h2f y1195 ffb fs10 fc0 sc0 ls0 ws0">  private Set&lt;Character&gt; argsFound = new HashSet&lt;Character&gt;();</div><div class="t m5 x74 h2f y1196 ffb fs10 fc0 sc0 ls0 ws0">  private Iterator&lt;String&gt; currentArgument;</div><div class="t m5 x74 h2f y1197 ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;String&gt; argsList;</div><div class="t m5 x74 h2f y1198 ffb fs10 fc0 sc0 ls0 ws0">  public Args(String schema, String[] args) throws ArgsException {</div><div class="t m5 x74 h2f y1199 ffb fs10 fc0 sc0 ls0 ws0">    this.schema = schema;</div><div class="t m5 x74 h2f y119a ffb fs10 fc0 sc0 ls0 ws0">    argsList = Arrays.asList(args);</div><div class="t m5 x74 h2f y119b ffb fs10 fc0 sc0 ls0 ws0">    parse();</div><div class="t m5 x74 h2f y119c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y119d ffb fs10 fc0 sc0 ls0 ws0">  private void parse() throws ArgsException {</div><div class="t m5 x74 h2f y119e ffb fs10 fc0 sc0 ls0 ws0">    parseSchema();</div><div class="t m5 x74 h2f y119f ffb fs10 fc0 sc0 ls0 ws0">    parseArguments();</div><div class="t m5 x74 h2f y11a0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11a1 ffb fs10 fc0 sc0 ls0 ws0">  private boolean parseSchema() throws ArgsException {</div><div class="t m5 x74 h2f y11a2 ffb fs10 fc0 sc0 ls0 ws0">    for (String element : schema.split(&quot;,&quot;)) {</div><div class="t m5 x74 h2f y11a3 ffb fs10 fc0 sc0 ls0 ws0">      if (element.length() &gt; 0) {</div><div class="t m5 x74 h2f y11a4 ffb fs10 fc0 sc0 ls0 ws0">        parseSchemaElement(element.trim());</div><div class="t m5 x74 h2f y11a5 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y11a6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y11a7 ffb fs10 fc0 sc0 ls0 ws0">    return true;</div><div class="t m5 x74 h2f y11a8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11a9 ffb fs10 fc0 sc0 ls0 ws0">  private void parseSchemaElement(String element) throws ArgsException {</div><div class="t m5 x74 h2f y11aa ffb fs10 fc0 sc0 ls0 ws0">    char elementId = element.charAt(0);</div><div class="t m5 x74 h2f y11ab ffb fs10 fc0 sc0 ls0 ws0">    String elementTail = element.substring(1);</div><div class="t m5 x74 h2f y11ac ffb fs10 fc0 sc0 ls0 ws0">    validateSchemaElementId(elementId);</div><div class="t m5 x74 h2f y11ad ffb fs10 fc0 sc0 ls0 ws0">    if (elementTail.length() == 0)</div><div class="t m5 x74 h2f y11ae ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new BooleanArgumentMarshaler());</div><div class="t m5 x74 h2f y11af ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;*&quot;))</div><div class="t m5 x74 h2f y11b0 ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new StringArgumentMarshaler());</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-15 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ArgsException.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf117" class="pf w1 h2" data-page-no="117"><div class="pc pc117 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg117.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">248<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;#&quot;))</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new IntegerArgumentMarshaler());</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    else if (elementTail.equals(&quot;##&quot;))</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">      marshalers.put(elementId, new DoubleArgumentMarshaler());</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(ArgsException.ErrorCode.INVALID_FORMAT, </div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">                              elementId, elementTail);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  private void validateSchemaElementId(char elementId) throws ArgsException {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    if (!Character.isLetter(elementId)) {</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(ArgsException.ErrorCode.INVALID_ARGUMENT_NAME, </div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">                              elementId, null);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">  private void parseArguments() throws ArgsException {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    for (currentArgument = argsList.iterator(); currentArgument.hasNext();) {</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      String arg = currentArgument.next();</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">      parseArgument(arg);</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">  private void parseArgument(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    if (arg.startsWith(&quot;-&quot;))</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">      parseElements(arg);</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElements(String arg) throws ArgsException {</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">    for (int i = 1; i &lt; arg.length(); i++)</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      parseElement(arg.charAt(i));</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  private void parseElement(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    if (setArgument(argChar))</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">      argsFound.add(argChar);</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">    else {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      throw new ArgsException(ArgsException.ErrorCode.UNEXPECTED_ARGUMENT, </div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">                              argChar, null);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">  private boolean setArgument(char argChar) throws ArgsException {</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler m = marshalers.get(argChar);</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    if (m == null)</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">      return false;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">      m.set(currentArgument);</div><div class="t m5 x74 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">      return true;</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ArgsException e) {</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">      e.setErrorArgumentId(argChar);</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">      throw e;</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-16 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf118" class="pf w1 h2" data-page-no="118"><div class="pc pc118 w1 h2"><img class="bi xd y11b1 wc ha4" alt="" src="bg118.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">249<span class="_ _10"></span><span class="ff1 ws1fc">String Arguments</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public int cardinality() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.size();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  public String usage() {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    if (schema.length() &gt; 0)</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">      return &quot;-[&quot; + schema + &quot;]&quot;;</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  public boolean getBoolean(char arg) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">    boolean b = false;</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">      b = am != null &amp;&amp; (Boolean) am.get();</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ClassCastException e) {</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      b = false;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    return b;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  public String getString(char arg) {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? &quot;&quot; : (String) am.get();</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">    } catch (ClassCastException e) {</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">      return &quot;&quot;;</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  public int getInt(char arg) {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? 0 : (Integer) am.get();</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">      return 0;</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11b2 ffb fs10 fc0 sc0 ls0 ws0">  public double getDouble(char arg) {</div><div class="t m5 x74 h2f y11b3 ffb fs10 fc0 sc0 ls0 ws0">    ArgumentMarshaler am = marshalers.get(arg);</div><div class="t m5 x74 h2f y11b4 ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y11b5 ffb fs10 fc0 sc0 ls0 ws0">      return am == null ? 0 : (Double) am.get();</div><div class="t m5 x74 h2f y11b6 ffb fs10 fc0 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h2f y11b7 ffb fs10 fc0 sc0 ls0 ws0">      return 0.0;</div><div class="t m5 x74 h2f y11b8 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y11b9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11ba ffb fs10 fc0 sc0 ls0 ws0">  public boolean has(char arg) {</div><div class="t m5 x74 h2f y11bb ffb fs10 fc0 sc0 ls0 ws0">    return argsFound.contains(arg);</div><div class="t m5 x74 h2f y11bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11bd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 14-16 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Args.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf119" class="pf w1 h2" data-page-no="119"><div class="pc pc119 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">250<span class="_ _39"> </span><span class="ff1 wsf5">Chapter 14:<span class="_ _4"></span> Successiv<span class="_ _4"></span>e Reﬁnement</span></div><div class="t m0 x74 h1d y194 ffd fs3 fc0 sc0 ls0 ws274">The majority of the changes to the </div><div class="t m5 x4e h2f y194 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x65 h1d y194 ffd fs3 fc0 sc0 ls0 ws274">class were deletions. <span class="_ _1"></span>A lot of code just got</div><div class="t m0 xd h1d y195 ffd fs3 fc0 sc0 ls0 ws6b4">mov<span class="_ _4"></span>ed out of </div><div class="t m5 xbc h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x2e h1d y195 ffd fs3 fc0 sc0 ls0 ws6b4">and put into </div><div class="t m5 x33 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x40 h1d y195 ffd fs3 fc0 sc0 ls0 ws6b4">. Nice. <span class="_ _4"></span>W<span class="_ _1"></span>e also moved all the</div><div class="t m5 xd h2f y196 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaller</div><div class="t m0 x4d h1d y196 ffd fs3 fc0 sc0 ls0 ws0">s into their o<span class="_ _4"></span>wn ﬁles. Nicer!</div><div class="t m0 x74 h1d y1fb ffd fs3 fc0 sc0 ls0 ws6b5">Much of good software design is simply about partitioning—creating appropriate</div><div class="t m0 xd h1d y1bd ffd fs3 fc0 sc0 ls0 ws693">places to put different kinds of code. <span class="_ _4"></span>This separation of concerns makes the code much</div><div class="t m0 xd h1d y1be ffd fs3 fc0 sc0 ls0 ws0">simpler to understand and maintain.</div><div class="t m0 x74 h1d y205 ffd fs3 fc0 sc0 ls0 ws3cf">Of special interest is the </div><div class="t m5 x5a h2f y205 ffb fs10 fc0 sc0 ls0 ws0">errorMessage</div><div class="t m0 xc4 h1d y205 ffd fs3 fc0 sc0 ls0 ws3cf">method of </div><div class="t m5 x88 h2f y205 ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x58 h1d y205 ffd fs3 fc0 sc0 ls0 ws3cf">. Clearly it was a vio-</div><div class="t m0 xd h1d y206 ffd fs3 fc0 sc0 ls0 ws109">lation of the SRP to put the error message formatting into </div><div class="t m5 x69 h2f y206 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x55 h1d y206 ffd fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 xa0 h2f y206 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x59 h1d y206 ffd fs3 fc0 sc0 ls0 ws109">should be about the</div><div class="t m0 xd h1d y207 ffd fs3 fc0 sc0 ls0 ws6b6">processing of arguments, not about the format of the error messages. Ho<span class="_ _4"></span>wev<span class="_ _4"></span>er<span class="_ _4"></span>, does it</div><div class="t m0 xd h1d y1fc ffd fs3 fc0 sc0 ls0 ws0">really make sense to put the error message formatting code into </div><div class="t m5 xf3 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x63 h1d y1fc ffd fs3 fc0 sc0 ls0 ws0">?</div><div class="t m0 x74 h1d y92b ffd fs3 fc0 sc0 ls0 ws6b7">Frankly<span class="_ _1"></span>, it’<span class="_ _4"></span>s a compromise. Users who don’t lik<span class="_ _4"></span>e the error messages supplied by</div><div class="t m5 xd h2f y11be ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 xe h1d y11be ffd fs3 fc0 sc0 ls0 ws6b8">will hav<span class="_ _4"></span>e to write their own. But the con<span class="_ _1"></span>venience of having canned error</div><div class="t m0 xd h1d yf40 ffd fs3 fc0 sc0 ls0 ws0">messages already prepared for you is not insigniﬁcant.</div><div class="t m0 x74 h1d y11bf ffd fs3 fc0 sc0 ls10 ws6b9">By now it should be clear that we are within striking distance of the ﬁnal solution that</div><div class="t m0 xd h1d y11c0 ffd fs3 fc0 sc0 ls10 ws3e4">appeared at the start of this chapter<span class="_ _1"></span>. I’ll leav<span class="_ _4"></span>e the ﬁnal transformations to you as an exercise. </div><div class="t m0 xd h17 y11c1 ff1 fs9 fc0 sc0 ls0 ws0"> Conclusion</div><div class="t m0 xd h14 y11c2 ff8 fs3 fc0 sc0 ls0 ws59c">It is not enough for code to w<span class="_ _4"></span>ork. Code that w<span class="_ _4"></span>orks is often badly brok<span class="_ _4"></span>en. Programmers</div><div class="t m0 xd h14 y11c3 ff8 fs3 fc0 sc0 ls0 ws6ba">who satisfy themselv<span class="_ _4"></span>es with merely w<span class="_ _1"></span>orking code are behaving unprofessionall<span class="_ _4"></span>y<span class="_ _0"></span>. <span class="_ _4"></span>They</div><div class="t m0 xd h14 y3c0 ff8 fs3 fc0 sc0 lsd ws677">ma<span class="_ _4"></span>y fear that they don’<span class="_ _1"></span>t hav<span class="_ _4"></span>e time to impro<span class="_ _4"></span>ve the structure and design of their code, but I</div><div class="t m0 xd h14 y3c1 ff8 fs3 fc0 sc0 ls0 ws54b">disagree. Nothing has a more profound and long-ter<span class="_ _8"></span>m degrading effect upon a de<span class="_ _4"></span>velop-</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls0 wsc2">ment project than bad code. Bad schedules can be redone, bad requirements can be rede-</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls0 ws52d">ﬁned. Bad team dynamics can be repaired. But bad code rots and ferments, becoming an</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 lsc ws5a7">inexorab<span class="_ _4"></span>le w<span class="_ _4"></span>eight that drags the team down. <span class="_ _1"></span>T<span class="_ _4"></span>ime and time again I hav<span class="_ _4"></span>e seen teams grind</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws659">to a cra<span class="_ _4"></span>wl because, in their haste, they created a malignant morass of code that fore<span class="_ _4"></span>ver</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 ls0 ws0">thereafter dominated their destin<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h1d y226 ffd fs3 fc0 sc0 ls0 ws6bb">Of course bad code can be cleaned up. But it’<span class="_ _1"></span>s very expensi<span class="_ _4"></span>ve. <span class="_ _1"></span>As code rots, the mod-</div><div class="t m0 xd h1d y227 ffd fs3 fc0 sc0 ls0 ws6bc">ules insinuate themselves into each other<span class="_ _1"></span>, creating lots of hidden and tangled dependen-</div><div class="t m0 xd h1d y228 ffd fs3 fc0 sc0 ls0 ws40">cies. Finding and breaking old dependencies is a long and arduous task. On the other hand,</div><div class="t m0 xd h1d y229 ffd fs3 fc0 sc0 ls0 ws44f">keeping code clean is relati<span class="_ _4"></span>vely easy<span class="_ _1"></span>. If you made a mess in a module in the morning, it is</div><div class="t m0 xd h1d y2bb ffd fs3 fc0 sc0 ls0 ws3c3">easy to clean it up in the afternoon. Better yet, if you made a mess ﬁve minutes ago, it’<span class="_ _1"></span>s</div><div class="t m0 xd h1d y2cf ffd fs3 fc0 sc0 ls0 ws0">very easy to clean it up right no<span class="_ _4"></span>w<span class="_ _1"></span>.</div><div class="t m0 x74 h1d y22c ffd fs3 fc0 sc0 ls0 ws528">So the solution is to continuously keep your code as clean and simple as it can be.</div><div class="t m0 xd h1d y22d ffd fs3 fc0 sc0 ls0 ws0">Nev<span class="_ _4"></span>er let the rot get started.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:82.325000px;bottom:370.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11a" class="pf w1 h2" data-page-no="11a"><div class="pc pc11a w1 h2"><img class="bi xd y11c4 w4 ha5" alt="" src="bg11a.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">251</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">15</div><div class="t m0 x54 h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">JUnit Inter<span class="_ _4"></span>nals</div><div class="t m0 xd h14 y11c5 ff8 fs3 fc0 sc0 ls0 ws39d">JUnit is one of the most famous of all Ja<span class="_ _4"></span>va frame<span class="_ _4"></span>w<span class="_ _4"></span>orks. <span class="_ _4"></span>As framew<span class="_ _1"></span>orks go, it is simple in</div><div class="t m0 xd h14 y11c6 ff8 fs3 fc0 sc0 lsc ws3d2">conception, precise in deﬁnition, and elegant in implementation. But w<span class="_ _4"></span>hat does the code</div><div class="t m0 xd h14 y11c7 ff8 fs3 fc0 sc0 ls0 ws0">look like? In this chapter w<span class="_ _4"></span>e’<span class="_ _4"></span>ll critique an example dra<span class="_ _1"></span>wn from the JUnit framew<span class="_ _4"></span>ork. </div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:282.651000px;bottom:440.027010px;width:156.313000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11b" class="pf w1 h2" data-page-no="11b"><div class="pc pc11b w1 h2"><img class="bi xd yf07 wc ha6" alt="" src="bg11b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">252<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">The JUnit F<span class="_ _1"></span>rame<span class="_ _4"></span>w<span class="_ _4"></span>ork</div><div class="t m0 xd h14 y270 ff8 fs3 fc0 sc0 ls0 ws275">JUnit has had man<span class="_ _4"></span>y authors, but it began with Kent Beck and Eric Gamma to<span class="_ _4"></span>gether on a</div><div class="t m0 xd h14 y271 ff8 fs3 fc0 sc0 ls0 ws90">plane to <span class="_ _1"></span>Atlanta. Kent w<span class="_ _4"></span>anted to lear<span class="_ _8"></span>n Ja<span class="_ _4"></span>va, and Eric w<span class="_ _4"></span>anted to lear<span class="_ _8"></span>n about Kent’<span class="_ _3"></span>s Small-</div><div class="t m0 xd h14 y273 ff8 fs3 fc0 sc0 ls0 ws6bd">talk testing frame<span class="_ _4"></span>work. “What could be more natural to a couple of geeks in cramped</div><div class="t m0 xd h14 y274 ff8 fs3 fc0 sc0 ls0 ws59a">quarters than to pull out our laptops and star<span class="_ _8"></span>t coding?”</div><div class="t m0 xb7 h21 y2a6 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 xb6 h14 y274 ff8 fs3 fc0 sc0 ls0 ws59a">After three hours of high-altitude</div><div class="t m0 xd h14 y275 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>ork, they had written the basics of JUnit.</div><div class="t m0 x74 h14 y462 ff8 fs3 fc0 sc0 ls12 ws6b">The module w<span class="_ _4"></span>e’<span class="_ _4"></span>ll look at is the clev<span class="_ _4"></span>er bit of code that helps identify string compari-</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls12 ws5c4">son er<span class="_ _8"></span>rors. <span class="_ _4"></span>This module is called </div><div class="t m5 xd1 h2f y39c ffb fs10 fc0 sc0 ls5d ws0">ComparisonCompactor</div><div class="t m0 x89 h14 y39c ff8 fs3 fc0 sc0 ls12 ws5c4">. Giv<span class="_ _4"></span>en tw<span class="_ _4"></span>o strings that differ<span class="_ _1"></span>,</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls12 ws6be">such as </div><div class="t m5 x9a h2f y39d ffb fs10 fc0 sc0 ls5d ws0">ABCDE</div><div class="t m0 xe h14 y39d ff8 fs3 fc0 sc0 ls12 ws0">and</div><div class="t m5 xba h2f y39d ffb fs10 fc0 sc0 ls5d ws0">ABXDE,</div><div class="t m0 xc7 h14 y39d ff8 fs3 fc0 sc0 ls12 ws6be">it will expose the dif<span class="_ _4"></span>ference by generating a string such as</div><div class="t m5 xd h2f y39e ffb fs10 fc0 sc0 ls5d ws0">&lt;...B[X]D...&gt;</div><div class="t m0 x14 h14 y39e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y253 ff8 fs3 fc0 sc0 ls72 ws1f1">I could explain it further<span class="_ _4"></span>, but the test cases do a better job<span class="_ _4"></span>. So take a look at Listing 15-1</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws385">and you will understand the requirements of this module in depth. <span class="_ _1"></span>While you are at it,</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws0">critique the structure of the tests. Could they be simpler or more ob<span class="_ _4"></span>vious?</div><div class="t m0 xd h25 y11c8 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span><span class="ffa">JUnit P<span class="_ _0"></span>ocket Guide<span class="ff8">, Kent Beck, O’Reill<span class="_ _4"></span>y<span class="_ _4"></span>, 2004, p. 43.</span></span></div><div class="t m0 x74 h1c y5be ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-1 </div><div class="t m0 x74 h36 y11c9 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactorTest.java</div><div class="t m5 x74 h2f y11ca ffb fs10 fc0 sc0 ls0 ws0">package junit.tests.framework;</div><div class="t m5 x74 h2f y11cb ffb fs10 fc0 sc0 ls0 ws0">import junit.framework.ComparisonCompactor;</div><div class="t m5 x74 h2f y11cc ffb fs10 fc0 sc0 ls0 ws0">import junit.framework.TestCase;</div><div class="t m5 x74 h2f y11cd ffb fs10 fc0 sc0 ls0 ws0">public class ComparisonCompactorTest extends TestCase {</div><div class="t m5 x52 h2f y11ce ffb fs10 fc0 sc0 ls0 ws0">public void testMessage() {</div><div class="t m5 x8a h2f y11cf ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;b&quot;, &quot;c&quot;).compact(&quot;a&quot;);</div><div class="t m5 x8a h2f y11d0 ffb fs10 fc0 sc0 ls0 ws0">assertTrue(&quot;a expected:&lt;[b]&gt; but was:&lt;[c]&gt;&quot;.equals(failure));</div><div class="t m5 x52 h2f y11d1 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y11d2 ffb fs10 fc0 sc0 ls0 ws0">public void testStartSame() {</div><div class="t m5 x8a h2f y11d3 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(1, &quot;ba&quot;, &quot;bc&quot;).compact(null);</div><div class="t m5 x8a h2f y11d4 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;b[a]&gt; but was:&lt;b[c]&gt;&quot;, failure);</div><div class="t m5 x52 h2f y11d5 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y11d6 ffb fs10 fc0 sc0 ls0 ws0">public void testEndSame() {</div><div class="t m5 x8a h2f y11d7 ffb fs10 fc0 sc0 ls0 ws0">String  failure= new ComparisonCompactor(1, &quot;ab&quot;, &quot;cb&quot;).compact(null);</div><div class="t m5 x8a h2f y11d8 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;[a]b&gt; but was:&lt;[c]b&gt;&quot;, failure);</div><div class="t m5 x52 h2f y11d9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y11da ffb fs10 fc0 sc0 ls0 ws0">public void testSame() {</div><div class="t m5 x8a h2f y11db ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(1, &quot;ab&quot;, &quot;ab&quot;).compact(null);</div><div class="t m5 x8a h2f y11dc ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;ab&gt; but was:&lt;ab&gt;&quot;, failure);</div><div class="t m5 x52 h2f y11dd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y11de ffb fs10 fc0 sc0 ls0 ws0">public void testNoContextStartAndEndSame() {</div><div class="t m5 x8a h2f y11df ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;abc&quot;, &quot;adc&quot;).compact(null);</div><div class="t m5 x8a h2f y11e0 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;...[b]...&gt; but was:&lt;...[d]...&gt;&quot;, failure);</div><div class="t m5 x52 h2f y11e1 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:132.869000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11c" class="pf w1 h2" data-page-no="11c"><div class="pc pc11c w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg11c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">253<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m5 x52 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">public void testStartAndEndContext() {</div><div class="t m5 x8a h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(1, &quot;abc&quot;, &quot;adc&quot;).compact(null);</div><div class="t m5 x8a h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;a[b]c&gt; but was:&lt;a[d]c&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">public void testStartAndEndContextWithEllipses() {</div><div class="t m5 x8a h2f y4be ffb fs10 fc0 sc0 ls0 ws0">String failure= </div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls19 ws241">       new ComparisonCompactor(1, &quot;abcde&quot;, &quot;abfde&quot;).compact(null);</div><div class="t m5 x8a h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;...b[c]d...&gt; but was:&lt;...b[f]d...&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorStartSameComplete() {</div><div class="t m5 x8a h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(2, &quot;ab&quot;, &quot;abc&quot;).compact(null);</div><div class="t m5 x8a h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;ab[]&gt; but was:&lt;ab[c]&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorEndSameComplete() {</div><div class="t m5 x8a h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;bc&quot;, &quot;abc&quot;).compact(null);</div><div class="t m5 x8a h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;[]...&gt; but was:&lt;[a]...&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorEndSameCompleteContext() {</div><div class="t m5 x8a h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(2, &quot;bc&quot;, &quot;abc&quot;).compact(null);</div><div class="t m5 x8a h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;[]bc&gt; but was:&lt;[a]bc&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorOverlapingMatches() {</div><div class="t m5 x8a h2f y97d ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;abc&quot;, &quot;abbc&quot;).compact(null);</div><div class="t m5 x8a h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;...[]...&gt; but was:&lt;...[b]...&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorOverlapingMatchesContext() {</div><div class="t m5 x8a h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(2, &quot;abc&quot;, &quot;abbc&quot;).compact(null);</div><div class="t m5 x8a h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;ab[]c&gt; but was:&lt;ab[b]c&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4d8 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorOverlapingMatches2() {</div><div class="t m5 x8a h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;abcdde&quot;, </div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">&quot;abcde&quot;).compact(null);</div><div class="t m5 x8a h2f y4db ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;...[d]...&gt; but was:&lt;...[]...&gt;&quot;, failure);</div><div class="t m5 x52 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y6ab ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorOverlapingMatches2Context() {</div><div class="t m5 x8a h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">String failure= </div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls19 ws241">       new ComparisonCompactor(2, &quot;abcdde&quot;, &quot;abcde&quot;).compact(null);</div><div class="t m5 x8a h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;...cd[d]e&gt; but was:&lt;...cd[]e&gt;&quot;, failure);</div><div class="t m5 x52 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y6af ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorWithActualNull() {</div><div class="t m5 x8a h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, &quot;a&quot;, null).compact(null);</div><div class="t m5 x8a h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;a&gt; but was:&lt;null&gt;&quot;, failure);</div><div class="t m5 x52 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorWithActualNullContext() {</div><div class="t m5 x8a h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(2, &quot;a&quot;, null).compact(null);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactorTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11d" class="pf w1 h2" data-page-no="11d"><div class="pc pc11d w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg11d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">254<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m0 x74 h14 ycbd ff8 fs3 fc0 sc0 ls0 ws62f">I ran a code co<span class="_ _4"></span>verage anal<span class="_ _4"></span>ysis on the </div><div class="t m5 xdd h2f y258 ffb fs10 fc0 sc0 ls0 ws0">ComparisonCompactor</div><div class="t m0 xab h14 y258 ff8 fs3 fc0 sc0 ls0 ws62f">using these tests. <span class="_ _1"></span>The code</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws218">is 100 percent co<span class="_ _4"></span>vered. Ev<span class="_ _4"></span>er<span class="_ _8"></span>y line of code, ev<span class="_ _4"></span>er<span class="_ _8"></span>y </div><div class="t m5 x34 h2f y259 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xea h14 y259 ff8 fs3 fc0 sc0 ls0 ws218">statement and </div><div class="t m5 xb9 h2f y259 ffb fs10 fc0 sc0 ls0 ws0">for</div><div class="t m0 x59 h14 y259 ff8 fs3 fc0 sc0 ls0 ws218">loop, is ex<span class="_ _4"></span>ecuted b<span class="_ _4"></span>y</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls0 ws225">the tests. <span class="_ _1"></span>This gives me a high de<span class="_ _4"></span>g<span class="_ _8"></span>ree of conﬁdence that the code w<span class="_ _4"></span>orks and a high degree</div><div class="t m0 xd h14 y29e ff8 fs3 fc0 sc0 ls0 ws0">of respect for the craftsmanship of the authors.</div><div class="t m0 x74 h14 y25c ff8 fs3 fc0 sc0 ls0 ws2d9">The code for </div><div class="t m5 x87 h2f y25c ffb fs10 fc0 sc0 ls0 ws0">ComparisonCompactor</div><div class="t m0 x5c h14 y25c ff8 fs3 fc0 sc0 ls0 ws2d9">is in Listing 15-2. <span class="_ _1"></span>T<span class="_ _1"></span>ake a moment to look o<span class="_ _4"></span>ver this</div><div class="t m0 xd h14 y25d ff8 fs3 fc0 sc0 ls0 ws693">code. I think you’<span class="_ _1"></span>ll ﬁnd it to be nicely partitioned<span class="_ _1"></span>, reasonably e<span class="_ _4"></span>xpressiv<span class="_ _4"></span>e, and simple in</div><div class="t m0 xd h14 y25e ff8 fs3 fc0 sc0 ls0 ws0">structure. Once you are done, then w<span class="_ _4"></span>e’<span class="_ _4"></span>ll pick the nits together<span class="_ _1"></span>.</div><div class="t m5 x8a h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;a&gt; but was:&lt;null&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorWithExpectedNull() {</div><div class="t m5 x8a h2f y522 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(0, null, &quot;a&quot;).compact(null);</div><div class="t m5 x8a h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;null&gt; but was:&lt;a&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">public void testComparisonErrorWithExpectedNullContext() {</div><div class="t m5 x8a h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(2, null, &quot;a&quot;).compact(null);</div><div class="t m5 x8a h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;null&gt; but was:&lt;a&gt;&quot;, failure);</div><div class="t m5 x52 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">public void testBug609972() {</div><div class="t m5 x8a h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">String failure= new ComparisonCompactor(10, &quot;S&amp;P500&quot;, &quot;0&quot;).compact(null);</div><div class="t m5 x8a h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(&quot;expected:&lt;[S&amp;P50]0&gt; but was:&lt;[]0&gt;&quot;, failure);</div><div class="t m5 x52 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y11e2 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-2 </div><div class="t m0 x74 h36 yc67 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (Original)</div><div class="t m5 x74 h2f y225 ffb fs10 fc0 sc0 ls0 ws0">package junit.framework;</div><div class="t m5 x74 h2f y418 ffb fs10 fc0 sc0 ls0 ws0">public class ComparisonCompactor {</div><div class="t m5 x74 h2f y11e3 ffb fs10 fc0 sc0 ls0 ws0">  private static final String ELLIPSIS = &quot;...&quot;;</div><div class="t m5 x74 h2f y11e4 ffb fs10 fc0 sc0 ls0 ws0">  private static final String DELTA_END = &quot;]&quot;;</div><div class="t m5 x74 h2f y11e5 ffb fs10 fc0 sc0 ls0 ws0">  private static final String DELTA_START = &quot;[&quot;;</div><div class="t m5 x74 h2f y11e6 ffb fs10 fc0 sc0 ls0 ws0">  private int fContextLength;</div><div class="t m5 x74 h2f y11e7 ffb fs10 fc0 sc0 ls0 ws0">  private String fExpected;</div><div class="t m5 x74 h2f y11e8 ffb fs10 fc0 sc0 ls0 ws0">  private String fActual;</div><div class="t m5 x74 h2f y11e9 ffb fs10 fc0 sc0 ls0 ws0">  private int fPrefix;</div><div class="t m5 x74 h2f y11ea ffb fs10 fc0 sc0 ls0 ws0">  private int fSuffix;</div><div class="t m5 x74 h2f y11eb ffb fs10 fc0 sc0 ls0 ws0">  public ComparisonCompactor(int contextLength, </div><div class="t m5 x74 h2f y11ec ffb fs10 fc0 sc0 ls4c ws260">                             String expected, </div><div class="t m5 x74 h2f y11ed ffb fs10 fc0 sc0 ls4c ws423">                               String actual) {</div><div class="t m5 x74 h2f y11ee ffb fs10 fc0 sc0 ls0 ws0">    fContextLength = contextLength;</div><div class="t m5 x74 h2f y11ef ffb fs10 fc0 sc0 ls0 ws0">    fExpected = expected;</div><div class="t m5 x74 h2f y11f0 ffb fs10 fc0 sc0 ls0 ws0">    fActual = actual;</div><div class="t m5 x74 h2f y11f1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactorTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11e" class="pf w1 h2" data-page-no="11e"><div class="pc pc11e w1 h2"><img class="bi xd yf6a wc h9c" alt="" src="bg11e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">255<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  public String compact(String message) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    if (fExpected == null || fActual == null || areStringsEqual())</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, fExpected, fActual);</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">    findCommonPrefix();</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    findCommonSuffix();</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">    String expected = compactString(fExpected);</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    String actual = compactString(fActual);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">    return Assert.format(message, expected, actual);</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  private String compactString(String source) {</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">    String result = DELTA_START + </div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls3c ws236">                      source.substring(fPrefix, source.length() -</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls1b ws253">                        fSuffix + 1) + DELTA_END;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    if (fPrefix &gt; 0)</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">      result = computeCommonPrefix() + result;</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">    if (fSuffix &gt; 0)</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">      result = result + computeCommonSuffix();</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">    return result;</div><div class="t m5 x74 h2f y4cb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonPrefix() {</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">    fPrefix = 0;</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(fExpected.length(), fActual.length());</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">    for (; fPrefix &lt; end; fPrefix++) {</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      if (fExpected.charAt(fPrefix) != fActual.charAt(fPrefix))</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonSuffix() {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc0 sc0 ls0 ws0">    int expectedSuffix = fExpected.length() - 1;</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">    int actualSuffix = fActual.length() - 1;</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    for (; </div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls19 ws236">         actualSuffix &gt;= fPrefix &amp;&amp; expectedSuffix &gt;= fPrefix; </div><div class="t m5 x74 h2f y4d8 ffb fs10 fc0 sc0 ls1a ws241">          actualSuffix--, expectedSuffix--) {</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">      if (fExpected.charAt(expectedSuffix) != fActual.charAt(actualSuffix))</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">    fSuffix = fExpected.length() - expectedSuffix;</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  private String computeCommonPrefix() {</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    return (fPrefix &gt; fContextLength ? ELLIPSIS : &quot;&quot;) + </div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls1f ws241">             fExpected.substring(Math.max(0, fPrefix - fContextLength), </div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls1c ws0">                                    fPrefix);</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">  private String computeCommonSuffix() {</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(fExpected.length() - fSuffix + 1 + fContextLength, </div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls5c ws253">                         fExpected.length());</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">    return fExpected.substring(fExpected.length() - fSuffix + 1, end) + </div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls19 ws236">           (fExpected.length() - fSuffix + 1 &lt; fExpected.length() - </div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls20 ws235">            fContextLength ? ELLIPSIS : &quot;&quot;);</div><div class="t m5 x74 h2f y6b5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-2 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (Original)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf11f" class="pf w1 h2" data-page-no="11f"><div class="pc pc11f w1 h2"><img class="bi xd ybdb wc h74" alt="" src="bg11f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">256<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m0 x74 h14 ycf5 ff8 fs3 fc0 sc0 ls0 ws583">Y<span class="_ _3"></span>ou might hav<span class="_ _4"></span>e a few complaints about this module. <span class="_ _1"></span>There are some long expressions</div><div class="t m0 xd h14 ycf6 ff8 fs3 fc0 sc0 ls0 ws569">and some strange </div><div class="t m5 x18 h2f y462 ffb fs10 fc0 sc0 ls0 ws0">+1</div><div class="t m0 x5 h14 y462 ff8 fs3 fc0 sc0 ls0 ws569">s and so forth. But o<span class="_ _4"></span>verall this module is pretty good. <span class="_ _1"></span>After all, it</div><div class="t m0 xd h14 y39c ff8 fs3 fc0 sc0 ls0 ws0">might ha<span class="_ _4"></span>ve looked lik<span class="_ _4"></span>e Listing 15-3. </div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private boolean areStringsEqual() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return fExpected.equals(fActual);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y5dd ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-3 </div><div class="t m0 x74 h36 y27a ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompator.java (defactored)</div><div class="t m5 x74 h2f y5de ffb fs10 fc0 sc0 ls0 ws0">package junit.framework;</div><div class="t m5 x74 h2f yae7 ffb fs10 fc0 sc0 ls0 ws0">public class ComparisonCompactor {</div><div class="t m5 x74 h2f yae8 ffb fs10 fc0 sc0 ls0 ws0">  private int ctxt;</div><div class="t m5 x74 h2f yae9 ffb fs10 fc0 sc0 ls0 ws0">  private String s1;</div><div class="t m5 x74 h2f yaea ffb fs10 fc0 sc0 ls0 ws0">  private String s2;</div><div class="t m5 x74 h2f yaeb ffb fs10 fc0 sc0 ls0 ws0">  private int pfx;</div><div class="t m5 x74 h2f yaec ffb fs10 fc0 sc0 ls0 ws0">  private int sfx;</div><div class="t m5 x74 h2f y11f2 ffb fs10 fc0 sc0 ls0 ws0">  public ComparisonCompactor(int ctxt, String s1, String s2) {</div><div class="t m5 x74 h2f y11f3 ffb fs10 fc0 sc0 ls0 ws0">    this.ctxt = ctxt;</div><div class="t m5 x74 h2f y11f4 ffb fs10 fc0 sc0 ls0 ws0">    this.s1 = s1;</div><div class="t m5 x74 h2f y11f5 ffb fs10 fc0 sc0 ls0 ws0">    this.s2 = s2;</div><div class="t m5 x74 h2f y11f6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11f7 ffb fs10 fc0 sc0 ls0 ws0">  public String compact(String msg) {</div><div class="t m5 x74 h2f y11f8 ffb fs10 fc0 sc0 ls0 ws0">    if (s1 == null || s2 == null || s1.equals(s2))</div><div class="t m5 x74 h2f y11f9 ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(msg, s1, s2);</div><div class="t m5 x74 h2f y11fa ffb fs10 fc0 sc0 ls0 ws0">    pfx = 0;</div><div class="t m5 x74 h2f y11fb ffb fs10 fc0 sc0 ls0 ws0">    for (; pfx &lt; Math.min(s1.length(), s2.length()); pfx++) {</div><div class="t m5 x74 h2f y11fc ffb fs10 fc0 sc0 ls0 ws0">      if (s1.charAt(pfx) != s2.charAt(pfx))</div><div class="t m5 x74 h2f y11fd ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y11fe ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y11ff ffb fs10 fc0 sc0 ls0 ws0">    int sfx1 = s1.length() - 1;</div><div class="t m5 x74 h2f y1200 ffb fs10 fc0 sc0 ls0 ws0">    int sfx2 = s2.length() - 1;</div><div class="t m5 x74 h2f y1201 ffb fs10 fc0 sc0 ls0 ws0">    for (; sfx2 &gt;= pfx &amp;&amp; sfx1 &gt;= pfx; sfx2--, sfx1--) {</div><div class="t m5 x74 h2f y1202 ffb fs10 fc0 sc0 ls0 ws0">      if (s1.charAt(sfx1) != s2.charAt(sfx2))</div><div class="t m5 x74 h2f y1203 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y1204 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1205 ffb fs10 fc0 sc0 ls0 ws0">    sfx = s1.length() - sfx1;</div><div class="t m5 x74 h2f y1206 ffb fs10 fc0 sc0 ls0 ws0">    String cmp1 = compactString(s1);</div><div class="t m5 x74 h2f y1207 ffb fs10 fc0 sc0 ls0 ws0">    String cmp2 = compactString(s2);</div><div class="t m5 x74 h2f y66b ffb fs10 fc0 sc0 ls0 ws0">    return Assert.format(msg, cmp1, cmp2);</div><div class="t m5 x74 h2f y1208 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1209 ffb fs10 fc0 sc0 ls0 ws0">  private String compactString(String s) {</div><div class="t m5 x74 h2f y120a ffb fs10 fc0 sc0 ls0 ws0">    String result =</div><div class="t m5 x74 h2f y120b ffb fs10 fc0 sc0 ls0 ws0">      &quot;[&quot; + s.substring(pfx, s.length() - sfx + 1) + &quot;]&quot;;</div><div class="t m5 x74 h2f y120c ffb fs10 fc0 sc0 ls0 ws0">    if (pfx &gt; 0)</div><div class="t m5 x74 h2f y120d ffb fs10 fc0 sc0 ls0 ws0">      result = (pfx &gt; ctxt ? &quot;...&quot; : &quot;&quot;) +</div><div class="t m5 x74 h2f y120e ffb fs10 fc0 sc0 ls0 ws0">        s1.substring(Math.max(0, pfx - ctxt), pfx) + result;</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-2 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (Original)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf120" class="pf w1 h2" data-page-no="120"><div class="pc pc120 w1 h2"><img class="bi xd y120f wc ha7" alt="" src="bg120.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">257<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m0 x74 h14 y75e ff8 fs3 fc0 sc0 ls0 ws28">Even though the authors left this module in v<span class="_ _4"></span>er<span class="_ _8"></span>y good shape, the <span class="ffa">Boy Scout Rule</span></div><div class="t m0 xd8 h21 ye7c ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xbf h14 y279 ff8 fs3 fc0 sc0 ls0 ws0">tells</div><div class="t m0 xd h14 y386 ff8 fs3 fc0 sc0 ls0 ws309">us w<span class="_ _4"></span>e should lea<span class="_ _4"></span>ve it cleaner than w<span class="_ _4"></span>e found it. So, ho<span class="_ _4"></span>w can we impro<span class="_ _1"></span>ve on the original</div><div class="t m0 xd h14 y387 ff8 fs3 fc0 sc0 ls0 ws0">code in Listing 15-2? </div><div class="t m0 x74 h14 y27c ff8 fs3 fc0 sc0 ls0 ws6bf">The ﬁrst thing I don’<span class="_ _1"></span>t care for is the </div><div class="t m5 xdd h2f y27c ffb fs10 fc0 sc0 ls0 ws0">f</div><div class="t m0 xaa h14 y27c ff8 fs3 fc0 sc0 ls0 ws6bf">preﬁx for the member v<span class="_ _4"></span>ariables [N6]. <span class="_ _1"></span>T<span class="_ _1"></span>oday’<span class="_ _3"></span>s</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws0">en<span class="_ _4"></span>vironments make this kind of scope encoding redundant. So let’<span class="_ _2"></span>s eliminate all the </div><div class="t m5 x36 h2f y27d ffb fs10 fc0 sc0 ls0 ws0">f</div><div class="t m0 x30 h14 y27d ff8 fs3 fc0 sc0 ls73 ws0">’s<span class="_ _d"> </span>.</div><div class="t m5 x74 h2f ya6d ffb fs10 fc0 sc0 ls14 ws237">  private int contextLength;</div><div class="t m5 x74 h2f ya6e ffb fs10 fc0 sc0 ls0 ws0">  private String expected;</div><div class="t m5 x74 h2f ya6f ffb fs10 fc0 sc0 ls0 ws0">  private String actual;</div><div class="t m5 x74 h2f y1210 ffb fs10 fc0 sc0 ls0 ws0">  private int prefix;</div><div class="t m5 x74 h2f y1211 ffb fs10 fc0 sc0 ls0 ws0">  private int suffix;</div><div class="t m0 x74 h14 y25b ff8 fs3 fc0 sc0 ls0 ws572">Next, w<span class="_ _1"></span>e hav<span class="_ _4"></span>e an unencapsulated conditional at the beginning of the </div><div class="t m5 x60 h2f y25b ffb fs10 fc0 sc0 ls0 ws0">compact</div><div class="t m0 x90 h14 y25b ff8 fs3 fc0 sc0 ls0 ws0">function</div><div class="t m0 xd h14 y25c ff8 fs3 fc0 sc0 ls0 ws0">[G28].</div><div class="t m5 x74 h2f y1212 ffb fs10 fc0 sc0 ls14 ws253">  public String compact(String message) {</div><div class="t m5 x9a h46 y1213 ffc fs10 fc0 sc0 ls41 ws0">if (expected == null || actual == null || areStringsEqual())</div><div class="t m5 x74 h2f y1214 ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, expected, actual);</div><div class="t m5 x74 h2f y1215 ffb fs10 fc0 sc0 ls1a ws2f6">    findCommonPrefix();</div><div class="t m5 x74 h2f y1216 ffb fs10 fc0 sc0 ls0 ws0">    findCommonSuffix();</div><div class="t m5 x74 h2f y1217 ffb fs10 fc0 sc0 ls0 ws0">    String expected = compactString(this.expected);</div><div class="t m5 x74 h2f y1218 ffb fs10 fc0 sc0 ls0 ws0">    String actual = compactString(this.actual);</div><div class="t m5 x74 h2f y1219 ffb fs10 fc0 sc0 ls0 ws0">    return Assert.format(message, expected, actual); </div><div class="t m5 x74 h2f y121a ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m0 xd h14 yd95 ff8 fs3 fc0 sc0 ls0 ws30c">This conditional should be encapsulated to make our intent clear<span class="_ _1"></span>. So let’<span class="_ _2"></span>s extract a method</div><div class="t m0 xd h14 yd96 ff8 fs3 fc0 sc0 ls0 ws0">that explains it.</div><div class="t m5 x74 h2f y121b ffb fs10 fc0 sc0 ls14 ws253">  public String compact(String message) {</div><div class="t m5 x74 h2f y121c ffb fs10 fc0 sc0 ls0 ws0">    if (<span class="ffc">shouldNotCompact()<span class="_ _4"></span><span class="ffb">)</span></span></div><div class="t m5 x74 h2f y121d ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, expected, actual);</div><div class="t m5 x74 h2f y121e ffb fs10 fc0 sc0 ls1a ws2f6">    findCommonPrefix();</div><div class="t m5 x74 h2f y121f ffb fs10 fc0 sc0 ls0 ws0">    findCommonSuffix();</div><div class="t m5 x74 h2f y1220 ffb fs10 fc0 sc0 ls0 ws0">    String expected = compactString(this.expected);</div><div class="t m5 x74 h2f y1221 ffb fs10 fc0 sc0 ls0 ws0">    String actual = compactString(this.actual);</div><div class="t m5 x74 h2f y1222 ffb fs10 fc0 sc0 ls0 ws0">    return Assert.format(message, expected, actual);</div><div class="t m5 x74 h2f y1223 ffb fs10 fc0 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y1224 ffb fs10 fc0 sc0 ls0 ws0">    if (sfx &gt; 0) {</div><div class="t m5 x74 h2f y1225 ffb fs10 fc0 sc0 ls0 ws0">      int end = Math.min(s1.length() - sfx + 1 + ctxt, s1.length());</div><div class="t m5 x74 h2f y1226 ffb fs10 fc0 sc0 ls0 ws0">      result = result + (s1.substring(s1.length() - sfx + 1, end) +</div><div class="t m5 x74 h2f y1227 ffb fs10 fc0 sc0 ls0 ws0">        (s1.length() - sfx + 1 &lt; s1.length() - ctxt ? &quot;...&quot; : &quot;&quot;));</div><div class="t m5 x74 h2f y1228 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1229 ffb fs10 fc0 sc0 ls0 ws0">    return result;</div><div class="t m5 x74 h2f y122a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y122b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y122c ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>See “The Bo<span class="_ _1"></span>y Scout Rule” on page 14.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-3 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompator.java (defactored)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf121" class="pf w1 h2" data-page-no="121"><div class="pc pc121 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">258<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m5 x1a h46 y122d ffc fs10 fc0 sc0 ls0 ws0">private boolean shouldNotCompact() {</div><div class="t m5 xdc h46 y122e ffc fs10 fc0 sc0 ls42 ws0">return expected == null || actual == null || areStringsEqual();</div><div class="t m5 x8e h46 y122f ffc fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x8e h14 y1230 ff8 fs3 fc0 sc0 ls0 ws564">I don’<span class="_ _1"></span>t much care for the </div><div class="t m5 x8f h2f y1230 ffb fs10 fc0 sc0 ls0 ws0">this.expected</div><div class="t m0 x78 h14 y1230 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x3d h2f y1230 ffb fs10 fc0 sc0 ls0 ws0">this.actual</div><div class="t m0 x62 h14 y1230 ff8 fs3 fc0 sc0 ls0 ws564">notation in the </div><div class="t m5 xa6 h2f y1230 ffb fs10 fc0 sc0 ls0 ws0">compact</div><div class="t m0 x30 h14 y1230 ff8 fs3 fc0 sc0 ls0 ws0">func-</div><div class="t m0 x11 h14 y1231 ff8 fs3 fc0 sc0 ls0 ws6c0">tion. <span class="_ _1"></span>This happened when w<span class="_ _4"></span>e changed the name of </div><div class="t m5 x96 h2f y1231 ffb fs10 fc0 sc0 ls0 ws0">fExpected</div><div class="t m0 xf5 h14 y1231 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xb5 h2f y1231 ffb fs10 fc0 sc0 ls0 ws0">expected</div><div class="t m0 xa9 h14 y1231 ff8 fs3 fc0 sc0 ls0 ws6c0">. <span class="_ _4"></span>Why are there</div><div class="t m0 x11 h14 y1232 ff8 fs3 fc0 sc0 ls0 ws48b">variab<span class="_ _4"></span>les in this function that ha<span class="_ _4"></span>ve the same names as the member v<span class="_ _4"></span>ariables? Don’<span class="_ _1"></span>t they</div><div class="t m0 x11 h14 y1233 ff8 fs3 fc0 sc0 ls0 ws0">represent something else [N4]? <span class="_ _4"></span>W<span class="_ _0"></span>e should make the names unambiguous.</div><div class="t m5 x8e h2f y4ed ffb fs10 fc0 sc0 ls0 ws0">    String <span class="ffc">compactExpected<span class="_ _4"></span><span class="ffb"> = compactString(<span class="ffc">expected</span>);</span></span></div><div class="t m5 x8e h2f y4ee ffb fs10 fc0 sc0 ls0 ws0">    String <span class="ffc">compactActual<span class="_ _4"></span><span class="ffb"> = compactString(<span class="ffc">actual</span>);</span></span></div><div class="t m0 x8e h14 y2aa ff8 fs3 fc0 sc0 lsc ws432">Negati<span class="_ _4"></span>ves are slightl<span class="_ _4"></span>y harder to understand than positiv<span class="_ _4"></span>es [G29]. So let’<span class="_ _2"></span>s tur<span class="_ _8"></span>n that </div><div class="t m5 x50 h2f y2aa ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x11 h14 y2ab ff8 fs3 fc0 sc0 ls0 ws0">statement on its head and in<span class="_ _4"></span>vert the sense of the conditional.</div><div class="t m5 x8e h2f y1234 ffb fs10 fc0 sc0 ls0 ws0">  public String compact(String message) {</div><div class="t m5 x8e h2f y1235 ffb fs10 fc0 sc0 ls0 ws0">    if (<span class="ffc">canBeCompacted<span class="_ _4"></span><span class="ffb">()) {</span></span></div><div class="t m5 x8e h2f y1236 ffb fs10 fc0 sc0 ls0 ws0">      findCommonPrefix();</div><div class="t m5 x8e h2f y1237 ffb fs10 fc0 sc0 ls0 ws0">      findCommonSuffix();</div><div class="t m5 x8e h2f y1238 ffb fs10 fc0 sc0 ls0 ws0">      String compactExpected = compactString(expected);</div><div class="t m5 x8e h2f y1239 ffb fs10 fc0 sc0 ls0 ws0">      String compactActual = compactString(actual);</div><div class="t m5 xb3 h2f y123a ffb fs10 fc0 sc0 ls74 ws0">return Assert.format(message, compactExpected, compactActual);</div><div class="t m5 x8e h2f y123b ffb fs10 fc0 sc0 ls0 ws0">    } else {</div><div class="t m5 x8e h2f y123c ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, expected, actual);</div><div class="t m5 x8e h2f y123d ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x8e h2f y123e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x8e h2f y123f ffb fs10 fc0 sc0 ls0 ws0">  private boolean <span class="ffc">canBeCompacted<span class="_ _4"></span><span class="ffb">() {</span></span></div><div class="t m5 xdc h2f y1240 ffb fs10 fc0 sc0 ls75 ws0">return expected <span class="ffc">!=</span> null <span class="_ _4"></span><span class="ffc">&amp;&amp;<span class="ffb"> actual </span>!=<span class="ffb"> null </span>&amp;&amp; !<span class="ffb">areStringsEqual();</span></span></div><div class="t m5 x8e h2f y1241 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x8e h14 y9be ff8 fs3 fc0 sc0 ls0 ws38e">The name of the function is strange [N7]. <span class="_ _1"></span>Although it does compact the strings, it</div><div class="t m0 x11 h14 y9bf ff8 fs3 fc0 sc0 ls0 ws2a1">actuall<span class="_ _4"></span>y might not compact the strings if </div><div class="t m5 xaa h2f y9bf ffb fs10 fc0 sc0 ls0 ws0">canBeCompacted</div><div class="t m0 x21 h14 y9bf ff8 fs3 fc0 sc0 ls0 ws0">returns </div><div class="t m5 x82 h2f y9bf ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 x60 h14 y9bf ff8 fs3 fc0 sc0 ls0 ws2a1">. So naming this</div><div class="t m0 x11 h14 y454 ff8 fs3 fc0 sc0 ls0 ws0">function</div><div class="t m5 xcb h2f y454 ffb fs10 fc0 sc0 ls0 ws0">compact</div><div class="t m0 xe4 h14 y454 ff8 fs3 fc0 sc0 ls0 ws6c1">hides the side ef<span class="_ _4"></span>fect of the er<span class="_ _8"></span>ror check. Notice also that the function</div><div class="t m0 x11 h14 y455 ff8 fs3 fc0 sc0 ls0 wsbe">returns a for<span class="_ _8"></span>matted message, not just the compacted strings. So the name of the function</div><div class="t m0 x11 h14 y456 ff8 fs3 fc0 sc0 ls0 ws517">should really be </div><div class="t m5 x87 h2f y456 ffb fs10 fc0 sc0 ls0 ws0">formatCompactedComparison</div><div class="t m0 x67 h14 y456 ff8 fs3 fc0 sc0 ls0 ws517">. <span class="_ _1"></span>That makes it read a lot better when taken</div><div class="t m0 x11 h14 y9c0 ff8 fs3 fc0 sc0 ls0 ws0">with the function argument:</div><div class="t m5 x8e h2f yf29 ffb fs10 fc0 sc0 ls0 ws0">  public String formatCompactedComparison(String message) {</div><div class="t m0 x8e h14 y2e5 ff8 fs3 fc0 sc0 ls10 ws22a">The body of the </div><div class="t m5 xc6 h2f y2e5 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xa h14 y2e5 ff8 fs3 fc0 sc0 ls10 ws22a">statement is where the true compacting of the expected and actual</div><div class="t m0 x11 h14 y2e6 ff8 fs3 fc0 sc0 ls10 ws440">strings is done. <span class="_ _4"></span>W<span class="_ _0"></span>e should extract that as a method named </div><div class="t m5 x61 h2f yc1c ffb fs10 fc0 sc0 ls0 ws0">compactExpectedAndActual</div><div class="t m0 xa8 h14 yc1c ff8 fs3 fc0 sc0 ls0 ws692">. Ho<span class="_ _4"></span>w-</div><div class="t m0 x11 h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws6c2">ev<span class="_ _4"></span>er<span class="_ _4"></span>, w<span class="_ _4"></span>e want the </div><div class="t m5 x5 h2f y2e8 ffb fs10 fc0 sc0 ls0 ws0">formatCompactedComparison</div><div class="t m0 x34 h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws6c2">function to do all the formatting. <span class="_ _4"></span>The</div><div class="t m5 x11 h2f y2e9 ffb fs10 fc0 sc0 ls45 ws0">compact...</div><div class="t m0 x46 h14 y2e9 ff8 fs3 fc0 sc0 ls72 wsef"> function should do nothing but compacting [G30]. So let’<span class="_ _2"></span>s split it up as follo<span class="_ _4"></span>ws:</div><div class="t m5 x8e h2f y204 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x8e h46 y9c5 ffc fs10 fc0 sc0 ls0 ws0">  private String compactExpected;</div><div class="t m5 x8e h46 y9c6 ffc fs10 fc0 sc0 ls0 ws0">  private String compactActual;</div><div class="t m5 x8e h2f y9c8 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x8e h2f y1242 ffb fs10 fc0 sc0 ls0 ws0">  public String formatCompactedComparison(String message) {</div><div class="t m5 x8e h2f y1243 ffb fs10 fc0 sc0 ls0 ws0">    if (canBeCompacted()) {</div><div class="t m5 x8e h46 y1244 ffc fs10 fc0 sc0 ls0 ws0">      compactExpectedAndActual();</div><div class="t m5 x8e h2f y1245 ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, compactExpected, compactActual);</div><div class="t m5 x8e h2f y1246 ffb fs10 fc0 sc0 ls0 ws0">    } else {</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf122" class="pf w1 h2" data-page-no="122"><div class="pc pc122 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">259<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">      return Assert.format(message, expected, actual);</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private void <span class="ffc">compactExpectedAndActual<span class="_ _1"></span><span class="ffb">() {</span></span></div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    findCommonPrefix();</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    findCommonSuffix();</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    compactExpected = compactString(expected);</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">    compactActual = compactString(actual);</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws23d">Notice that this required us to promote </div><div class="t m5 xaa h2f y1dc ffb fs10 fc0 sc0 ls0 ws0">compactExpected</div><div class="t m0 xc9 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xa3 h2f y1dc ffb fs10 fc0 sc0 ls0 ws0">compactActual</div><div class="t m0 x93 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws23d">to member</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws287">variab<span class="_ _4"></span>les. I don’<span class="_ _1"></span>t like the wa<span class="_ _4"></span>y that the last tw<span class="_ _4"></span>o lines of the new function return v<span class="_ _4"></span>ariables,</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 lsd ws6c3">but the ﬁrst tw<span class="_ _4"></span>o don’<span class="_ _4"></span>t. <span class="_ _1"></span>They aren’<span class="_ _4"></span>t using consistent con<span class="_ _4"></span>ventions [G11]. So w<span class="_ _4"></span>e should</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">change</div><div class="t m5 x95 h2f y1df ffb fs10 fc0 sc0 ls0 ws0">findCommonPrefix</div><div class="t m0 x15 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0"> and </div><div class="t m5 xcc h2f y1df ffb fs10 fc0 sc0 ls0 ws0">findCommonSuffix</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0"> to return the preﬁx and sufﬁx v<span class="_ _4"></span>alues.</div><div class="t m5 x74 h2f y5de ffb fs10 fc0 sc0 ls0 ws0">  private void compactExpectedAndActual() {</div><div class="t m5 x9a h2f yae6 ffc fs10 fc0 sc0 ls0 ws0">prefixIndex = <span class="ffb">findCommonPrefix();</span></div><div class="t m5 x9a h2f yae7 ffc fs10 fc0 sc0 ls0 ws0">suffixIndex = <span class="ffb">findCommonSuffix();</span></div><div class="t m5 x74 h2f yae8 ffb fs10 fc0 sc0 ls0 ws0">    compactExpected = compactString(expected);</div><div class="t m5 x74 h2f yae9 ffb fs10 fc0 sc0 ls0 ws0">    compactActual = compactString(actual);</div><div class="t m5 x74 h2f yaea ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yaec ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">int</span> findCommonPrefix() {</div><div class="t m5 x9a h2f yaed ffc fs10 fc0 sc0 ls0 ws0">int<span class="ffb"> prefix</span>Index<span class="ffb"> = 0;</span></div><div class="t m5 x74 h2f y11f2 ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(expected.length(), actual.length());</div><div class="t m5 x74 h2f y11f3 ffb fs10 fc0 sc0 ls0 ws0">    for (; prefix<span class="ffc">Index<span class="_ _4"></span><span class="ffb"> &lt; end; prefix<span class="ffc">Index</span>++) {</span></span></div><div class="t m5 x74 h2f y11f4 ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(prefix<span class="_ _4"></span><span class="ffc">Index<span class="ffb">) != actual.charAt(prefix<span class="_ _4"></span><span class="ffc">Index<span class="ffb">))</span></span></span></span></div><div class="t m5 x74 h2f y11f5 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y11f6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h46 y1247 ffc fs10 fc0 sc0 ls0 ws0">    return prefixIndex;</div><div class="t m5 x74 h2f y11f7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y11f9 ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">int</span> findCommonSuffix() {</div><div class="t m5 x74 h2f y1248 ffb fs10 fc0 sc0 ls0 ws0">    int expectedSuffix = expected.length() - 1;</div><div class="t m5 x74 h2f y11fa ffb fs10 fc0 sc0 ls0 ws0">    int actualSuffix = actual.length() - 1;</div><div class="t m5 x74 h2f y11fb ffb fs10 fc0 sc0 ls0 ws0">    for (; actualSuffix &gt;= prefix<span class="_ _4"></span><span class="ffc">Index<span class="ffb"> &amp;&amp; expectedSuffix &gt;= prefixIndex;</span></span></div><div class="t m5 x74 h2f y11fc ffb fs10 fc0 sc0 ls1a ws237">         actualSuffix--, expectedSuffix--) {</div><div class="t m5 x74 h2f y11fd ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))</div><div class="t m5 x74 h2f y11fe ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y11ff ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x9a h2f y1200 ffc fs10 fc0 sc0 ls0 ws0">return <span class="ffb">expected.length() - expectedSuffix;</span></div><div class="t m5 x74 h2f y1201 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y1163 ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e should also change the names of the member variab<span class="_ _4"></span>les to be a little more accurate</div><div class="t m0 xd h14 y1249 ff8 fs3 fc0 sc0 ls0 ws0">[N1]; after all, they are both indices. </div><div class="t m0 x74 h14 y1f3 ff8 fs3 fc0 sc0 ls0 ws12e">Careful inspection of </div><div class="t m5 x7 h2f y1f3 ffb fs10 fc0 sc0 ls0 ws0">findCommonSuffix</div><div class="t m0 xbe h14 y1f3 ff8 fs3 fc0 sc0 ls0 ws12e">exposes a <span class="ffa">hidden tempor<span class="_ _1"></span>al coupling <span class="ff8">[G31]; it</span></span></div><div class="t m0 xd h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws381">depends on the fact that </div><div class="t m5 xa h2f y1f4 ffb fs10 fc0 sc0 ls0 ws0">prefixIndex</div><div class="t m0 x26 h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws381">is calculated b<span class="_ _4"></span>y </div><div class="t m5 x2a h2f y1f4 ffb fs10 fc0 sc0 ls0 ws0">findCommonPrefix</div><div class="t m0 xac h14 y1f4 ff8 fs3 fc0 sc0 ls0 ws381">. If these tw<span class="_ _4"></span>o func-</div><div class="t m0 xd h14 y1f5 ff8 fs3 fc0 sc0 lsd ws248">tions w<span class="_ _4"></span>ere called out of order<span class="_ _4"></span>, there w<span class="_ _4"></span>ould be a difﬁcult debugging session ahead. So, to</div><div class="t m0 xd h14 y1f6 ff8 fs3 fc0 sc0 ls0 ws6c4">expose this temporal coupling, let’<span class="_ _3"></span>s hav<span class="_ _4"></span>e </div><div class="t m5 xaa h2f y1f6 ffb fs10 fc0 sc0 ls0 ws0">findCommonSuffix</div><div class="t m0 x62 h14 y1f6 ff8 fs3 fc0 sc0 ls0 ws6c4">take the </div><div class="t m5 x8b h2f y1f6 ffb fs10 fc0 sc0 ls0 ws0">prefixIndex</div><div class="t m0 xd8 h14 y1f6 ff8 fs3 fc0 sc0 ls0 ws6c4">as an</div><div class="t m0 xd h14 y1f7 ff8 fs3 fc0 sc0 ls0 ws0">argument.</div><div class="t m5 x74 h2f y124a ffb fs10 fc0 sc0 ls0 ws0">  private void compactExpectedAndActual() {</div><div class="t m5 x74 h2f y124b ffb fs10 fc0 sc0 ls0 ws0">    prefixIndex = findCommonPrefix();</div><div class="t m5 x74 h2f y124c ffb fs10 fc0 sc0 ls0 ws0">    suffixIndex = findCommonSuffix(<span class="_ _4"></span><span class="ffc">prefixIndex<span class="ffb">);</span></span></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf123" class="pf w1 h2" data-page-no="123"><div class="pc pc123 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">260<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">    compactExpected = compactString(expected);</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    compactActual = compactString(actual);</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  private int findCommonSuffix(<span class="_ _4"></span><span class="ffc">int prefixIndex<span class="ffb">) {</span></span></div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    int expectedSuffix = expected.length() - 1;</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    int actualSuffix = actual.length() - 1;</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    for (; actualSuffix &gt;= prefixIndex &amp;&amp; expectedSuffix &gt;= prefixIndex; </div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls1a ws237">         actualSuffix--, expectedSuffix--) {</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">    return expected.length() - expectedSuffix;</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws397">I’m not reall<span class="_ _4"></span>y happy with this. <span class="_ _1"></span>The passing of the </div><div class="t m5 x54 h2f y1df ffb fs10 fc0 sc0 ls0 ws0">prefixIndex</div><div class="t m0 xf5 h14 y1df ff8 fs3 fc0 sc0 ls0 ws397">argument is a bit arbitrary</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 lsd ws262">[G32]. It w<span class="_ _4"></span>orks to establish the ordering but does nothing to e<span class="_ _4"></span>xplain the need for that</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws6c5">ordering. <span class="_ _1"></span>Another programmer might undo what w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve done because there’<span class="_ _2"></span>s no indica-</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">tion that the parameter is reall<span class="_ _4"></span>y needed. So let’<span class="_ _2"></span>s take a different tack.</div><div class="t m5 x74 h2f y124d ffb fs10 fc0 sc0 ls0 ws0">  private void compactExpectedAndActual() {</div><div class="t m5 x9a h2f y124e ffc fs10 fc0 sc0 ls0 ws0">findCommonPrefixAndSuffix<span class="_ _4"></span><span class="ffb">();</span></div><div class="t m5 x74 h2f y124f ffb fs10 fc0 sc0 ls0 ws0">    compactExpected = compactString(expected);</div><div class="t m5 x74 h2f y1250 ffb fs10 fc0 sc0 ls0 ws0">    compactActual = compactString(actual);</div><div class="t m5 x74 h2f y1251 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1252 ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">void findCommonPrefixAndSuffix<span class="_ _1"></span><span class="ffb">() {</span></span></div><div class="t m5 x9a h46 y1253 ffc fs10 fc0 sc0 ls0 ws0">findCommonPrefix();</div><div class="t m5 x74 h2f y1254 ffb fs10 fc0 sc0 ls0 ws0">    int expectedSuffix = expected.length() - 1;</div><div class="t m5 x74 h2f y1255 ffb fs10 fc0 sc0 ls0 ws0">    int actualSuffix = actual.length() - 1;</div><div class="t m5 x74 h2f y1256 ffb fs10 fc0 sc0 ls0 ws0">    for (;</div><div class="t m5 x74 h2f y1257 ffb fs10 fc0 sc0 ls0 ws0">         actualSuffix &gt;= prefixIndex &amp;&amp; expectedSuffix &gt;= prefixIndex;</div><div class="t m5 x74 h2f y1258 ffb fs10 fc0 sc0 ls0 ws0">         actualSuffix--, expectedSuffix--</div><div class="t m5 x74 h2f y1259 ffb fs10 fc0 sc0 ls0 ws0">      ) {</div><div class="t m5 x74 h2f y125a ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(expectedSuffix) != actual.charAt(actualSuffix))</div><div class="t m5 x74 h2f y125b ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y125c ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y125d ffb fs10 fc0 sc0 ls0 ws0">    suffixIndex = expected.length() - expectedSuffix;</div><div class="t m5 x74 h2f y125e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y125f ffb fs10 fc0 sc0 ls0 ws0">  private <span class="ffc">void</span> findCommonPrefix() {</div><div class="t m5 x74 h2f y1260 ffb fs10 fc0 sc0 ls0 ws0">    prefixIndex = 0;</div><div class="t m5 x74 h2f y1261 ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(expected.length(), actual.length());</div><div class="t m5 x74 h2f y1262 ffb fs10 fc0 sc0 ls0 ws0">    for (; prefixIndex &lt; end; prefixIndex++)</div><div class="t m5 x74 h2f y1263 ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(prefixIndex) != actual.charAt(prefixIndex))</div><div class="t m5 x74 h2f y1264 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y1265 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"></span>e<span class="_ _9"> </span>put</div><div class="t m5 x9a h2f y4b2 ffb fs10 fc0 sc0 ls0 ws0">findCommonPrefix</div><div class="t m0 xa4 h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xf6 h2f y4b2 ffb fs10 fc0 sc0 ls0 ws0">findCommonSuffix</div><div class="t m0 xde h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws6c6">back the w<span class="_ _4"></span>ay the<span class="_ _4"></span>y were, changing the</div><div class="t m0 xd h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws6c7">name of </div><div class="t m5 x8a h2f y4b3 ffb fs10 fc0 sc0 ls0 ws0">findCommonSuffix</div><div class="t m0 x2f h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 x38 h2f y4b3 ffb fs10 fc0 sc0 ls0 ws0">findCommon<span class="ffc">PrefixAnd</span>Suffix</div><div class="t m0 xae h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws6c7">and ha<span class="_ _4"></span>ving it call </div><div class="t m5 x63 h2f y4b3 ffb fs10 fc0 sc0 ls0 ws0">findCommon-</div><div class="t m5 xd h2f y1266 ffb fs10 fc0 sc0 ls0 ws0">Prefix</div><div class="t m0 x1a h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws138">before doing an<span class="_ _4"></span>ything else. <span class="_ _4"></span>That establishes the temporal nature of the tw<span class="_ _4"></span>o func-</div><div class="t m0 xd h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws17d">tions in a much more dramatic w<span class="_ _4"></span>ay than the pre<span class="_ _4"></span>vious solution. It also points out ho<span class="_ _4"></span>w ugly</div><div class="t m5 xd h2f y217 ffb fs10 fc0 sc0 ls0 ws0">findCommonPrefixAndSuffix</div><div class="t m0 xa4 h14 y217 ff8 fs3 fc0 sc0 ls0 ws0"> is. Let’<span class="_ _2"></span>s clean it up no<span class="_ _4"></span>w<span class="_ _0"></span>.</div><div class="t m5 x74 h2f y1189 ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonPrefixAndSuffix() {</div><div class="t m5 x74 h2f y118a ffb fs10 fc0 sc0 ls0 ws0">    findCommonPrefix();</div><div class="t m5 x74 h2f y118b ffb fs10 fc0 sc0 ls0 ws0">    int suffixLength = 1;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf124" class="pf w1 h2" data-page-no="124"><div class="pc pc124 w1 h2"><img class="bi xd y45f wc ha8" alt="" src="bg124.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">261<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m5 x9a h2f y345 ffb fs10 fc0 sc0 ls43 ws0">for (; !suffixOverlapsPrefix(suffixLength); suffixLength++) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">      if (charFromEnd(expected, suffixLength) != </div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls20 ws241">           charFromEnd(actual, suffixLength))</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    suffixIndex = suffixLength;</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">  private char charFromEnd(String s, int i) {</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    return s.charAt(s.length()-i);}</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">  private boolean suffixOverlapsPrefix(int suffixLength) {</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">    return actual.length() - suffixLength &lt; prefixLength ||</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      expected.length() - suffixLength &lt; prefixLength;</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y209 ff8 fs3 fc0 sc0 ls0 ws442">This is much better<span class="_ _1"></span>. It exposes that the </div><div class="t m5 x78 h2f y209 ffb fs10 fc0 sc0 ls0 ws0">suffixIndex</div><div class="t m0 x61 h14 y209 ff8 fs3 fc0 sc0 ls0 ws442">is really the length of the suf<span class="_ _1"></span>ﬁx</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws20b">and is not w<span class="_ _4"></span>ell named. <span class="_ _4"></span>The same is true of the </div><div class="t m5 x1b h2f y20a ffb fs10 fc0 sc0 ls0 ws0">prefixIndex</div><div class="t m0 xdb h14 y20a ff8 fs3 fc0 sc0 ls0 ws20b">, though in that case “index” and</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 ls0 ws411">“length” are synon<span class="_ _4"></span>ymous. Even so, it is more consistent to use “length.<span class="_ _1"></span>” <span class="_ _4"></span>The problem is</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws1a7">that the </div><div class="t m5 xc5 h2f y748 ffb fs10 fc0 sc0 ls0 ws0">suffixIndex</div><div class="t m0 x7b h14 y748 ff8 fs3 fc0 sc0 ls0 ws1a7">v<span class="_ _4"></span>ariable is not zero based; it is 1 based and so is not a true length. <span class="_ _4"></span>This</div><div class="t m0 xd h14 y3d5 ff8 fs3 fc0 sc0 ls0 ws698">is also the reason that there are all those </div><div class="t m5 x83 h2f y3d5 ffb fs10 fc0 sc0 ls0 ws0">+1</div><div class="t m0 xb8 h14 y3d5 ff8 fs3 fc0 sc0 ls0 ws698">s in </div><div class="t m5 xee h2f y3d5 ffb fs10 fc0 sc0 ls0 ws0">computeCommonSuffix</div><div class="t m0 x82 h14 y3d5 ff8 fs3 fc0 sc0 ls0 ws698">[G33]. So let’<span class="_ _2"></span>s ﬁx that.</div><div class="t m0 xd h14 y3d6 ff8 fs3 fc0 sc0 ls0 ws0">The result is in Listing 15-4.</div><div class="t m0 x74 h1c y38a ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-4 </div><div class="t m0 x74 h36 y74a ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (interim)</div><div class="t m5 x74 h2f y1267 ffb fs10 fc0 sc0 ls0 ws0">public class ComparisonCompactor {</div><div class="t m5 x74 h2f y1268 ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y1269 ffb fs10 fc0 sc0 ls0 ws0">  private int <span class="ffc">suffixLength<span class="_ _4"></span><span class="ffb">;</span></span></div><div class="t m5 x74 h2f y126a ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y126b ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonPrefixAndSuffix() {</div><div class="t m5 x74 h2f y126c ffb fs10 fc0 sc0 ls0 ws0">    findCommonPrefix();</div><div class="t m5 x74 h46 y126d ffc fs10 fc0 sc0 ls0 ws0">    suffixLength = 0;</div><div class="t m5 x74 h2f y126e ffb fs10 fc0 sc0 ls0 ws0">    for (; !suffixOverlapsPrefix(suffixLength); suffixLength++) {</div><div class="t m5 x74 h2f y126f ffb fs10 fc0 sc0 ls0 ws0">      if (charFromEnd(expected, suffixLength) != </div><div class="t m5 x74 h2f y1270 ffb fs10 fc0 sc0 ls0 ws0">          charFromEnd(actual, suffixLength))</div><div class="t m5 x74 h2f y1271 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y1272 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1273 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1274 ffb fs10 fc0 sc0 ls0 ws0">  private char charFromEnd(String s, int i) {</div><div class="t m5 x74 h2f y1275 ffb fs10 fc0 sc0 ls0 ws0">    return s.charAt(s.length() - i <span class="_ _4"></span><span class="ffc">- 1<span class="ffb">);</span></span></div><div class="t m5 x74 h2f y1276 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1277 ffb fs10 fc0 sc0 ls0 ws0">  private boolean suffixOverlapsPrefix(int suffixLength) {</div><div class="t m5 x74 h2f y1278 ffb fs10 fc0 sc0 ls0 ws0">    return actual.length() - suffixLength <span class="_ _1"></span><span class="ffc">&lt;=<span class="ffb"> prefixLength ||</span></span></div><div class="t m5 x74 h2f y1279 ffb fs10 fc0 sc0 ls0 ws0">      expected.length() - suffixLength <span class="_ _1"></span><span class="ffc">&lt;=<span class="ffb"> prefixLength;</span></span></div><div class="t m5 x74 h2f y127a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y127b ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y127c ffb fs10 fc0 sc0 ls0 ws0">  private String compactString(String source) {</div><div class="t m5 x74 h2f y127d ffb fs10 fc0 sc0 ls0 ws0">    String result = </div><div class="t m5 x74 h2f y127e ffb fs10 fc0 sc0 ls0 ws0">      DELTA_START + </div><div class="t m5 x74 h2f y127f ffb fs10 fc0 sc0 ls0 ws0">      source.substring(prefixLength, source.length() - <span class="_ _1"></span><span class="ffc">suffixLength<span class="ffb">) + </span></span></div><div class="t m5 x74 h2f y1280 ffb fs10 fc0 sc0 ls0 ws0">      DELTA_END;</div><div class="t m5 x74 h2f y1281 ffb fs10 fc0 sc0 ls0 ws0">    if (prefixLength &gt; 0)</div><div class="t m5 x74 h2f y1282 ffb fs10 fc0 sc0 ls0 ws0">      result = computeCommonPrefix() + result;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf125" class="pf w1 h2" data-page-no="125"><div class="pc pc125 w1 h2"><img class="bi xd y7b6 wc h4c" alt="" src="bg125.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">262<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m0 x74 h14 y1283 ff8 fs3 fc0 sc0 ls0 ws6c8">W<span class="_ _0"></span>e replaced the </div><div class="t m5 x5 h2f y27e ffb fs10 fc0 sc0 ls0 ws0">+1</div><div class="t m0 x2e h14 y27e ff8 fs3 fc0 sc0 ls0 ws6c8">s in </div><div class="t m5 x2f h2f y27e ffb fs10 fc0 sc0 ls0 ws0">computeCommonSuffix</div><div class="t m0 xd5 h14 y27e ff8 fs3 fc0 sc0 ls0 ws6c8">with a </div><div class="t m5 x85 h2f y27e ffb fs10 fc0 sc0 ls0 ws0">-1</div><div class="t m0 xc2 h14 y27e ff8 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m5 x7f h2f y27e ffb fs10 fc0 sc0 ls0 ws0">charFromEnd</div><div class="t m0 x60 h14 y27e ff8 fs3 fc0 sc0 ls0 ws6c8">, where it mak<span class="_ _4"></span>es</div><div class="t m0 xd h14 y27f ff8 fs3 fc0 sc0 ls0 ws426">perfect sense, and tw<span class="_ _4"></span>o </div><div class="t m5 x4 h2f y27f ffb fs10 fc0 sc0 ls0 ws0">&lt;=</div><div class="t m0 xb1 h14 y27f ff8 fs3 fc0 sc0 ls0 ws426">operators in </div><div class="t m5 x32 h2f y27f ffb fs10 fc0 sc0 ls0 ws0">suffixOverlapsPrefix</div><div class="t m0 xf1 h14 y27f ff8 fs3 fc0 sc0 ls0 ws426">, where the<span class="_ _4"></span>y also make perfect</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls0 ws6c">sense. <span class="_ _1"></span>This allow<span class="_ _1"></span>ed us to change the name of </div><div class="t m5 x78 h2f y280 ffb fs10 fc0 sc0 ls0 ws0">suffixIndex</div><div class="t m0 x61 h14 y280 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xc9 h2f y280 ffb fs10 fc0 sc0 ls0 ws0">suffixLength</div><div class="t m0 x60 h14 y280 ff8 fs3 fc0 sc0 ls0 ws6c">, greatly enhanc-</div><div class="t m0 xd h14 y281 ff8 fs3 fc0 sc0 ls0 ws0">ing the readability of the code.</div><div class="t m0 x74 h14 y38b ff8 fs3 fc0 sc0 ls0 ws323">There is a problem ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>. <span class="_ _1"></span>As I was eliminating the +1s, I noticed the follo<span class="_ _4"></span>wing line</div><div class="t m0 xd h14 y282 ff8 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m5 xcd h2f y282 ffb fs10 fc0 sc0 ls0 ws0">compactString</div><div class="t m0 x3a h14 y282 ff8 fs3 fc0 sc0 ls0 ws0">:</div><div class="t m5 x74 h2f ydf4 ffb fs10 fc0 sc0 ls0 ws0">if (suffixLength &gt; 0)</div><div class="t m0 xd h14 y4e3 ff8 fs3 fc0 sc0 ls0 ws4ef">T<span class="_ _0"></span>ake a look at it in Listing 15-4. By rights, because </div><div class="t m5 x2a h2f y4e3 ffb fs10 fc0 sc0 ls0 ws0">suffixLength</div><div class="t m0 x72 h14 y4e3 ff8 fs3 fc0 sc0 ls0 ws4ef">is no<span class="_ _4"></span>w one less than it</div><div class="t m0 xd h14 y4e4 ff8 fs3 fc0 sc0 ls0 ws18f">used to be, I should change the </div><div class="t m5 xdf h2f y806 ffb fs10 fc0 sc0 ls0 ws0">&gt;</div><div class="t m0 x76 h14 y806 ff8 fs3 fc0 sc0 ls0 ws18f">operator to a </div><div class="t m5 x42 h2f y806 ffb fs10 fc0 sc0 ls0 ws0">&gt;=</div><div class="t m0 xd2 h14 y806 ff8 fs3 fc0 sc0 ls0 ws18f">operator<span class="_ _1"></span>. But that makes no sense. It</div><div class="t m0 xd h14 y807 ff8 fs3 fc0 sc0 ls0 ws6c9">makes sense <span class="ffa ws0">no<span class="_ _4"></span>w! <span class="_ _5"></span><span class="ff8 lsd ws62b">This means that it didn’<span class="_ _4"></span>t use to make sense and w<span class="_ _4"></span>as probabl<span class="_ _4"></span>y a bug.</span></span></div><div class="t m0 xd h14 y808 ff8 fs3 fc0 sc0 lsd ws437">W<span class="_ _0"></span>ell, not quite a bug. Upon further analysis w<span class="_ _4"></span>e see that the </div><div class="t m5 x7f h2f y48e ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x51 h14 y48e ff8 fs3 fc0 sc0 ls0 wsbd">statement no<span class="_ _4"></span>w prev<span class="_ _4"></span>ents a</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws6ca">zero length sufﬁx from being appended. Before w<span class="_ _1"></span>e made the change, the </div><div class="t m5 x60 h2f y37a ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x5e h14 y37a ff8 fs3 fc0 sc0 ls11 ws45b"> statement w<span class="_ _4"></span>as</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws0">nonfunctional because </div><div class="t m5 xd0 h2f y37b ffb fs10 fc0 sc0 ls0 ws0">suffixIndex</div><div class="t m0 x76 h14 y37b ff8 fs3 fc0 sc0 ls0 ws0"> could nev<span class="_ _4"></span>er be less than one!</div><div class="t m0 x74 h14 y2cb ff8 fs3 fc0 sc0 ls0 ws537">This calls into question <span class="ffa ws0">both</span></div><div class="t m5 x81 h2f y2cb ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x26 h14 y2cb ff8 fs3 fc0 sc0 ls0 ws537">statements in </div><div class="t m5 x54 h2f y2cb ffb fs10 fc0 sc0 ls0 ws0">compactString</div><div class="t m0 xa0 h14 y2cb ff8 fs3 fc0 sc0 ls0 ws537">! It looks as though they</div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws6a1">could both be eliminated. So let’<span class="_ _2"></span>s comment them out and run the tests. <span class="_ _4"></span>They passed! So</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws6cb">let’<span class="_ _2"></span>s restructure </div><div class="t m5 x3a h2f y2cd ffb fs10 fc0 sc0 ls0 ws0">compactString</div><div class="t m0 xa2 h14 y2cd ff8 fs3 fc0 sc0 ls0 ws6cb">to eliminate the extraneous </div><div class="t m5 xf7 h2f y2cd ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x51 h14 y2cd ff8 fs3 fc0 sc0 ls0 ws6cb">statements and make the</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 ws0">function much simpler [G9].</div><div class="t m5 x74 h2f y1284 ffb fs10 fc0 sc0 ls0 ws0">private String compactString(String source) {</div><div class="t m5 x74 h2f y1285 ffb fs10 fc0 sc0 ls0 ws0">    return</div><div class="t m5 x74 h2f y1286 ffb fs10 fc0 sc0 ls0 ws0">      computeCommonPrefix() +</div><div class="t m5 x74 h2f y1287 ffb fs10 fc0 sc0 ls0 ws0">      DELTA_START +</div><div class="t m5 x74 h2f y1288 ffb fs10 fc0 sc0 ls0 ws0">      source.substring(prefixLength, source.length() - suffixLength) +</div><div class="t m5 x74 h2f y1289 ffb fs10 fc0 sc0 ls0 ws0">      DELTA_END +</div><div class="t m5 x74 h2f y128a ffb fs10 fc0 sc0 ls0 ws0">      computeCommonSuffix();</div><div class="t m5 x74 h2f y128b ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws694">This is much better! No<span class="_ _4"></span>w w<span class="_ _4"></span>e see that the </div><div class="t m5 xdd h2f y42f ffb fs10 fc0 sc0 ls0 ws0">compactString</div><div class="t m0 xb6 h14 y42f ff8 fs3 fc0 sc0 ls0 ws694">function is simpl<span class="_ _4"></span>y composing the</div><div class="t m0 xd h14 y5ce ff8 fs3 fc0 sc0 ls0 ws130">fragments together<span class="_ _0"></span>. W<span class="_ _0"></span>e can probab<span class="_ _4"></span>ly make this e<span class="_ _4"></span>ven clearer<span class="_ _1"></span>. Indeed<span class="_ _1"></span>, there are lots of little</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">    if (<span class="ffc">suffixLength<span class="_ _4"></span><span class="ffb"> &gt; 0)</span></span></div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">      result = result + computeCommonSuffix();</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">    return result;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">...</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  private String computeCommonSuffix() {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(expected.length() - <span class="_ _1"></span><span class="ffc">suffixLength<span class="ffb"> +</span></span></div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">      contextLength, expected.length()</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">    return </div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">      expected.substring(expected.length() - <span class="_ _1"></span><span class="ffc ls41">suffixLength<span class="ffb ls0">, end) +</span></span></div><div class="t m5 x74 h2f y4c3 ffb fs10 fc0 sc0 ls0 ws0">      (expected.length() - <span class="_ _4"></span><span class="ffc">suffixLength<span class="ffb"> &lt; </span></span></div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">        expected.length() - contextLength ? </div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">        ELLIPSIS : &quot;&quot;);</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-4 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (interim)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf126" class="pf w1 h2" data-page-no="126"><div class="pc pc126 w1 h2"><img class="bi xd ye86 wc ha9" alt="" src="bg126.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">263<span class="_ _10"></span><span class="ff1">The JUnit F<span class="_ _4"></span>rame<span class="_ _4"></span>wor<span class="_ _4"></span>k</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws442">cleanups w<span class="_ _4"></span>e could do. But rather than drag you through the rest of the changes, I’<span class="_ _1"></span>ll just</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">sho<span class="_ _4"></span>w you the result in Listing 15-5. </div><div class="t m0 x74 h1c yc08 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-5 </div><div class="t m0 x74 h36 y198 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (final)</div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">package junit.framework;</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">public class ComparisonCompactor {</div><div class="t m5 x74 h2f y55e ffb fs10 fc0 sc0 ls0 ws0">  private static final String ELLIPSIS = &quot;...&quot;;</div><div class="t m5 x74 h2f y55f ffb fs10 fc0 sc0 ls0 ws0">  private static final String DELTA_END = &quot;]&quot;;</div><div class="t m5 x74 h2f y58f ffb fs10 fc0 sc0 ls0 ws0">  private static final String DELTA_START = &quot;[&quot;;</div><div class="t m5 x74 h2f y591 ffb fs10 fc0 sc0 ls0 ws0">  private int contextLength;</div><div class="t m5 x74 h2f y592 ffb fs10 fc0 sc0 ls0 ws0">  private String expected;</div><div class="t m5 x74 h2f y593 ffb fs10 fc0 sc0 ls0 ws0">  private String actual;</div><div class="t m5 x74 h2f y594 ffb fs10 fc0 sc0 ls0 ws0">  private int prefixLength;</div><div class="t m5 x74 h2f y595 ffb fs10 fc0 sc0 ls0 ws0">  private int suffixLength;</div><div class="t m5 x74 h2f yc0a ffb fs10 fc0 sc0 ls0 ws0">  public ComparisonCompactor(</div><div class="t m5 x74 h2f yc0b ffb fs10 fc0 sc0 ls0 ws0">    int contextLength, String expected, String actual</div><div class="t m5 x74 h2f yc0c ffb fs10 fc0 sc0 ls0 ws0">  ) {</div><div class="t m5 x74 h2f ycdd ffb fs10 fc0 sc0 ls0 ws0">    this.contextLength = contextLength;</div><div class="t m5 x74 h2f yc0d ffb fs10 fc0 sc0 ls0 ws0">    this.expected = expected;</div><div class="t m5 x74 h2f yc0e ffb fs10 fc0 sc0 ls0 ws0">    this.actual = actual;</div><div class="t m5 x74 h2f yc0f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc11 ffb fs10 fc0 sc0 ls0 ws0">  public String formatCompactedComparison(String message) {</div><div class="t m5 x74 h2f ycde ffb fs10 fc0 sc0 ls0 ws0">    String compactExpected = expected;</div><div class="t m5 x74 h2f ycdf ffb fs10 fc0 sc0 ls0 ws0">    String compactActual = actual;</div><div class="t m5 x74 h2f yce0 ffb fs10 fc0 sc0 ls0 ws0">    if (shouldBeCompacted()) {</div><div class="t m5 x74 h2f y128c ffb fs10 fc0 sc0 ls0 ws0">      findCommonPrefixAndSuffix();</div><div class="t m5 x74 h2f yce1 ffb fs10 fc0 sc0 ls0 ws0">      compactExpected = compact(expected);</div><div class="t m5 x74 h2f yce2 ffb fs10 fc0 sc0 ls0 ws0">      compactActual = compact(actual);</div><div class="t m5 x74 h2f yce3 ffb fs10 fc0 sc0 ls0 ws0">    } </div><div class="t m5 x74 h2f yce4 ffb fs10 fc0 sc0 ls0 ws0">    return Assert.format(message, compactExpected, compactActual);</div><div class="t m5 x74 h2f yce5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y128d ffb fs10 fc0 sc0 ls0 ws0">  private boolean shouldBeCompacted() {</div><div class="t m5 x74 h2f y128e ffb fs10 fc0 sc0 ls0 ws0">    return !shouldNotBeCompacted();</div><div class="t m5 x74 h2f y128f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1290 ffb fs10 fc0 sc0 ls0 ws0">  private boolean shouldNotBeCompacted() {</div><div class="t m5 x74 h2f y1291 ffb fs10 fc0 sc0 ls0 ws0">    return expected == null ||</div><div class="t m5 x74 h2f y1292 ffb fs10 fc0 sc0 ls0 ws0">           actual == null ||</div><div class="t m5 x74 h2f y1293 ffb fs10 fc0 sc0 ls0 ws0">           expected.equals(actual);</div><div class="t m5 x74 h2f y1294 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1295 ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonPrefixAndSuffix() {</div><div class="t m5 x74 h2f y1296 ffb fs10 fc0 sc0 ls0 ws0">    findCommonPrefix();</div><div class="t m5 x74 h2f y1297 ffb fs10 fc0 sc0 ls0 ws0">    suffixLength = 0;</div><div class="t m5 x74 h2f y1298 ffb fs10 fc0 sc0 ls0 ws0">    for (; !suffixOverlapsPrefix(); suffixLength++) {</div><div class="t m5 x74 h2f y1299 ffb fs10 fc0 sc0 ls0 ws0">      if (charFromEnd(expected, suffixLength) !=</div><div class="t m5 x74 h2f y129a ffb fs10 fc0 sc0 ls0 ws0">          charFromEnd(actual, suffixLength)</div><div class="t m5 x74 h2f y129b ffb fs10 fc0 sc0 ls0 ws0">      )</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf127" class="pf w1 h2" data-page-no="127"><div class="pc pc127 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg127.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">264<span class="_ _3a"> </span><span class="ff1 wsf5">Chapter 15:<span class="_ _4"></span> JUnit Internals</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y522 ffb fs10 fc0 sc0 ls0 ws0">  private char charFromEnd(String s, int i) {</div><div class="t m5 x74 h2f y4bd ffb fs10 fc0 sc0 ls0 ws0">    return s.charAt(s.length() - i - 1);</div><div class="t m5 x74 h2f y4be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc0 sc0 ls0 ws0">  private boolean suffixOverlapsPrefix() {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc0 sc0 ls0 ws0">    return actual.length() - suffixLength &lt;= prefixLength ||</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc0 sc0 ls0 ws0">      expected.length() - suffixLength &lt;= prefixLength;</div><div class="t m5 x74 h2f y523 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc0 sc0 ls0 ws0">  private void findCommonPrefix() {</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc0 sc0 ls0 ws0">    prefixLength = 0;</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc0 sc0 ls0 ws0">    int end = Math.min(expected.length(), actual.length());</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc0 sc0 ls0 ws0">    for (; prefixLength &lt; end; prefixLength++)</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc0 sc0 ls0 ws0">      if (expected.charAt(prefixLength) != actual.charAt(prefixLength))</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc0 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f y4ca ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y5af ffb fs10 fc0 sc0 ls0 ws0">  private String compact(String s) {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc0 sc0 ls0 ws0">    return new StringBuilder()</div><div class="t m5 x74 h2f y4cd ffb fs10 fc0 sc0 ls0 ws0">      .append(startingEllipsis())</div><div class="t m5 x74 h2f y4ce ffb fs10 fc0 sc0 ls0 ws0">      .append(startingContext())</div><div class="t m5 x74 h2f y4cf ffb fs10 fc0 sc0 ls0 ws0">      .append(DELTA_START)</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc0 sc0 ls0 ws0">      .append(delta(s))</div><div class="t m5 x74 h2f y97d ffb fs10 fc0 sc0 ls0 ws0">      .append(DELTA_END)</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc0 sc0 ls0 ws0">      .append(endingContext())</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc0 sc0 ls0 ws0">      .append(endingEllipsis())</div><div class="t m5 x74 h2f y4d3 ffb fs10 fc0 sc0 ls0 ws0">      .toString();</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc0 sc0 ls0 ws0">  private String startingEllipsis() {</div><div class="t m5 x74 h2f y4d6 ffb fs10 fc0 sc0 ls0 ws0">    return prefixLength &gt; contextLength ? ELLIPSIS : &quot;&quot;;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc0 sc0 ls0 ws0">  private String startingContext() {</div><div class="t m5 x74 h2f y4da ffb fs10 fc0 sc0 ls0 ws0">    int contextStart = Math.max(0, prefixLength - contextLength);</div><div class="t m5 x74 h2f y4db ffb fs10 fc0 sc0 ls0 ws0">    int contextEnd = prefixLength;</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc0 sc0 ls0 ws0">    return expected.substring(contextStart, contextEnd);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ya01 ffb fs10 fc0 sc0 ls0 ws0">  private String delta(String s) {</div><div class="t m5 x74 h2f y6ac ffb fs10 fc0 sc0 ls0 ws0">    int deltaStart = prefixLength;</div><div class="t m5 x74 h2f y6ad ffb fs10 fc0 sc0 ls0 ws0">    int deltaEnd = s.length() - suffixLength;</div><div class="t m5 x74 h2f y6ae ffb fs10 fc0 sc0 ls0 ws0">    return s.substring(deltaStart, deltaEnd);</div><div class="t m5 x74 h2f yc66 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y6b0 ffb fs10 fc0 sc0 ls0 ws0">  private String endingContext() {</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc0 sc0 ls0 ws0">    int contextStart = expected.length() - suffixLength;</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc0 sc0 ls0 ws0">    int contextEnd =</div><div class="t m5 x74 h2f ya02 ffb fs10 fc0 sc0 ls0 ws0">      Math.min(contextStart + contextLength, expected.length());</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc0 sc0 ls0 ws0">    return expected.substring(contextStart, contextEnd);</div><div class="t m5 x74 h2f y6b4 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (final)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf128" class="pf w1 h2" data-page-no="128"><div class="pc pc128 w1 h2"><img class="bi xd y129c wc haa" alt="" src="bg128.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">265<span class="_ _10"></span><span class="ff1">Conclusion</span></div><div class="t m0 x74 h14 ycf5 ff8 fs3 fc0 sc0 ls0 ws6cc">This is actually quite pretty<span class="_ _0"></span>. <span class="_ _1"></span>The module is separated into a g<span class="_ _8"></span>roup of analysis func-</div><div class="t m0 xd h14 ycf6 ff8 fs3 fc0 sc0 ls0 ws6cd">tions and another group of synthesis functions. <span class="_ _4"></span>They are topolo<span class="_ _4"></span>gically sorted so that the</div><div class="t m0 xd h14 ycf7 ff8 fs3 fc0 sc0 ls0 ws122">deﬁnition of each function appears just after it is used. <span class="_ _1"></span>All the analysis functions appear</div><div class="t m0 xd h14 ybef ff8 fs3 fc0 sc0 ls0 ws0">ﬁrst, and all the synthesis functions appear last.</div><div class="t m0 x74 h14 yb9e ff8 fs3 fc0 sc0 ls0 ws43c">If you look carefull<span class="_ _4"></span>y<span class="_ _0"></span>, you will notice that I re<span class="_ _4"></span>versed se<span class="_ _4"></span>veral of the decisions I made</div><div class="t m0 xd h14 ycf9 ff8 fs3 fc0 sc0 ls0 ws6ce">earlier in this chapter<span class="_ _1"></span>. F<span class="_ _4"></span>or example, I inlined some extracted methods back into</div><div class="t m5 xd h2f y254 ffb fs10 fc0 sc0 ls0 ws0">formatCompactedComparison</div><div class="t m0 xa4 h14 y254 ff8 fs3 fc0 sc0 ls3d ws6cf">, and I changed the sense of the </div><div class="t m5 x21 h2f y254 ffb fs10 fc0 sc0 ls0 ws0">shouldNotBeCompacted</div><div class="t m0 x71 h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">expres-</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws3e8">sion. <span class="_ _1"></span>This is typical. Often one ref<span class="_ _8"></span>actoring leads to another that leads to the undoing of the</div><div class="t m0 xd h14 y29c ff8 fs3 fc0 sc0 ls0 ws2b4">ﬁrst. Refactoring is an iterativ<span class="_ _4"></span>e process full of trial and er<span class="_ _8"></span>ror, ine<span class="_ _4"></span>vitabl<span class="_ _4"></span>y con<span class="_ _4"></span>ver<span class="_ _4"></span>ging on</div><div class="t m0 xd h14 ya7f ff8 fs3 fc0 sc0 ls0 ws0">something that w<span class="_ _4"></span>e feel is w<span class="_ _4"></span>or<span class="_ _8"></span>thy of a professional.</div><div class="t m0 xd h17 y129d ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y2db ff8 fs3 fc0 sc0 ls0 ws24">And so w<span class="_ _4"></span>e ha<span class="_ _4"></span>ve satisﬁed the Bo<span class="_ _4"></span>y Scout Rule. <span class="_ _4"></span>W<span class="_ _0"></span>e hav<span class="_ _4"></span>e left this module a bit cleaner than</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws3f8">w<span class="_ _4"></span>e found it. Not that it wasn’<span class="_ _1"></span>t clean already<span class="_ _0"></span>. <span class="_ _4"></span>The authors had done an excellent job with it.</div><div class="t m0 xd h14 y3a6 ff8 fs3 fc0 sc0 ls0 ws238">But no module is immune from impro<span class="_ _4"></span>vement, and each of us has the responsibility to</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc0 sc0 ls0 ws0">lea<span class="_ _4"></span>ve the code a little better than w<span class="_ _4"></span>e found it.</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc0 sc0 ls0 ws0">  private String endingEllipsis() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc0 sc0 ls0 ws0">    return (suffixLength &gt; contextLength ? ELLIPSIS : &quot;&quot;);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y4bc ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 15-5 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">ComparisonCompactor.java (final)</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:362.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf129" class="pf w1 h2" data-page-no="129"><div class="pc pc129 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12a" class="pf w1 h2" data-page-no="12a"><div class="pc pc12a w1 h2"><img class="bi xd y129e w4 hab" alt="" src="bg12a.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">267</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">16</div><div class="t m0 x5a h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Refactoring</div><div class="t m8 xf7 hac y129f ffc fs17 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xd h14 y12a0 ff8 fs3 fc0 sc0 ls0 ws515">If you go to </div><div class="t m5 xc3 h2f y12a0 ffb fs10 fc0 sc0 ls0 ws0">http://www.jfree.org/jcommon/index.php</div><div class="t m0 x2a h14 y12a0 ff8 fs3 fc0 sc0 ls0 ws515">, you will ﬁnd the JCommon library<span class="_ _0"></span>.</div><div class="t m0 xd h14 y12a1 ff8 fs3 fc0 sc0 ls0 ws5ef">Deep within that library there is a package named </div><div class="t m5 xb4 h2f y12a1 ffb fs10 fc0 sc0 ls0 ws0">org.jfree.date</div><div class="t m0 x79 h14 y12a1 ff8 fs3 fc0 sc0 ls0 ws5ef">. <span class="_ _4"></span>W<span class="_ _4"></span>ithin that package</div><div class="t m0 xd h14 y12a2 ff8 fs3 fc0 sc0 ls0 ws0">there is a class named </div><div class="t m5 xed h2f y12a2 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xec h14 y12a2 ff8 fs3 fc0 sc0 ls0 ws0">. <span class="_ _4"></span>W<span class="_ _0"></span>e are going to explore that class.</div><div class="t m0 x74 h14 y12a3 ff8 fs3 fc0 sc0 ls0 ws7b">The author of </div><div class="t m5 xf2 h2f y12a3 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x8f h14 y12a3 ff8 fs3 fc0 sc0 ls0 ws7b">is Da<span class="_ _4"></span>vid Gilber<span class="_ _8"></span>t. Da<span class="_ _4"></span>vid is clearly an e<span class="_ _4"></span>xperienced and com-</div><div class="t m0 xd h14 y12a4 ff8 fs3 fc0 sc0 ls0 ws1eb">petent pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer<span class="_ _4"></span>. <span class="_ _1"></span>As we shall see, he sho<span class="_ _1"></span>ws a signiﬁcant degree of professionalism and</div><div class="t m0 xd h14 y12a5 ff8 fs3 fc0 sc0 ls0 ws2d">discipline within his code. F<span class="_ _1"></span>or all intents and pur<span class="_ _5"></span>poses, this is “good code.<span class="_ _1"></span>” <span class="_ _1"></span>And I am</div><div class="t m0 xd h14 y12a6 ff8 fs3 fc0 sc0 ls0 ws0">going to rip it to pieces.</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:196.357000px;bottom:439.429010px;width:242.460000px;height:130.671000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.jfree.org/jcommon/index.php"><div class="d m1" style="border-style:none;position:absolute;left:128.734000px;bottom:162.893010px;width:166.335000px;height:11.031000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12b" class="pf w1 h2" data-page-no="12b"><div class="pc pc12b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">268<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws270">This is not an acti<span class="_ _4"></span>vity of malice. Nor do I think that I am so much better than David</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws13b">that I someho<span class="_ _4"></span>w ha<span class="_ _4"></span>ve a right to pass judgment on his code. Indeed<span class="_ _1"></span>, if you w<span class="_ _4"></span>ere to ﬁnd some</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">of m<span class="_ _4"></span>y code, I’m sure you could ﬁnd plenty of things to complain about. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 lsc ws2d9">No, this is not an acti<span class="_ _4"></span>vity of nastiness or ar<span class="_ _8"></span>rogance. <span class="_ _4"></span>What I am about to do is nothing</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws4cb">more and nothing less than a professional revie<span class="_ _1"></span>w<span class="_ _1"></span>. It is something that w<span class="_ _4"></span>e should all be</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws49e">comfortable doing. <span class="_ _1"></span>And it is something we should w<span class="_ _1"></span>elcome when it is done for us. It is</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws62f">onl<span class="_ _4"></span>y through critiques like these that w<span class="_ _4"></span>e will lear<span class="_ _8"></span>n. Doctors do it. Pilots do it. La<span class="_ _4"></span>wyers do</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">it. <span class="_ _1"></span>And we pro<span class="_ _4"></span>grammers need to lear<span class="_ _8"></span>n how to do it too.</div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 ls0 ws6d0">One more thing about Da<span class="_ _4"></span>vid Gilber<span class="_ _8"></span>t: Da<span class="_ _4"></span>vid is more than just a good programmer<span class="_ _4"></span>.</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws18e">Da<span class="_ _4"></span>vid had the courage and good will to offer his code to the community at lar<span class="_ _4"></span>ge for free.</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws666">He placed it out in the open for all to see and in<span class="_ _4"></span>vited public usage and pub<span class="_ _4"></span>lic scr<span class="_ _8"></span>utiny<span class="_ _0"></span>. <span class="_ _1"></span>This</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws0">was w<span class="_ _1"></span>ell done!</div><div class="t m5 x74 h2f yf40 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xe5 h14 yf40 ff8 fs3 fc0 sc0 ls0 ws80">(Listing B-1, page <span class="_ _1"></span>349) is a class that represents a date in Jav<span class="_ _4"></span>a. Wh<span class="_ _1"></span>y hav<span class="_ _4"></span>e</div><div class="t m0 xd h14 y12a7 ff8 fs3 fc0 sc0 ls0 ws6d1">a class that represents a date, when Ja<span class="_ _1"></span>va already has </div><div class="t m5 x73 h2f y12a7 ffb fs10 fc0 sc0 ls0 ws0">java.util.Date</div><div class="t m0 x8c h14 y12a7 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f yd25 ffb fs10 fc0 sc0 ls0 ws0">java.util.Calendar</div><div class="t m0 x4d h14 yd25 ff8 fs3 fc0 sc0 ls0 ws371">, and others? <span class="_ _1"></span>The author wrote this class in response to a pain that I</div><div class="t m0 xd h14 yd26 ff8 fs3 fc0 sc0 ls0 ws5c">ha<span class="_ _4"></span>ve often felt m<span class="_ _4"></span>yself. <span class="_ _1"></span>The comment in his opening Jav<span class="_ _4"></span>adoc (line 67) explains it w<span class="_ _4"></span>ell. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 yd27 ff8 fs3 fc0 sc0 lsd ws5c3">could quibble about his intention, but I ha<span class="_ _1"></span>ve certainly had to deal with this issue, and I</div><div class="t m0 xd h14 y567 ff8 fs3 fc0 sc0 ls0 ws0">w<span class="_ _4"></span>elcome a class that is about dates instead of times.</div><div class="t m0 xd h17 y12a8 ff1 fs9 fc0 sc0 ls0 ws0">First,<span class="_ _1"></span> Make It <span class="_ _0"></span>W<span class="_ _2"></span>ork</div><div class="t m0 xd h14 yc62 ff8 fs3 fc0 sc0 ls0 ws5b0">There are some unit tests in a class named </div><div class="t m5 x9d h2f yc62 ffb fs10 fc0 sc0 ls0 ws0">SerialDateTests</div><div class="t m0 xf7 h14 yc62 ff8 fs3 fc0 sc0 ls0 ws0">(Listing B-2, <span class="_ _5"></span>page 366). <span class="_ _8"></span>The</div><div class="t m0 xd h14 y30e ff8 fs3 fc0 sc0 ls0 ws6d2">tests all pass. Unfortunately a quick inspection of the tests sho<span class="_ _4"></span>ws that they don’<span class="_ _1"></span>t test ev<span class="_ _4"></span>er<span class="_ _8"></span>y-</div><div class="t m0 xd h14 y30f ff8 fs3 fc0 sc0 ls0 wsc6">thing [T1]. F<span class="_ _1"></span>or example, doing a “Find Usages” search on the method </div><div class="t m5 x6b h2f y30f ffb fs10 fc0 sc0 ls0 ws0">MonthCodeToQuarter</div><div class="t m0 xd h14 y310 ff8 fs3 fc0 sc0 ls0 ws0">(line 334) indicates that it is not used [F4]. <span class="_ _1"></span>Therefore, the unit tests don’<span class="_ _4"></span>t test it.</div><div class="t m0 x74 h14 y376 ff8 fs3 fc0 sc0 ls0 wsc9">So I ﬁred up Clo<span class="_ _4"></span>ver to see w<span class="_ _4"></span>hat the unit tests co<span class="_ _4"></span>vered and w<span class="_ _4"></span>hat they didn’<span class="_ _1"></span>t. Clov<span class="_ _4"></span>er</div><div class="t m0 xd h14 y377 ff8 fs3 fc0 sc0 ls0 ws4f2">reported that the unit tests executed onl<span class="_ _1"></span>y 91 of the 185 executab<span class="_ _4"></span>le statements in </div><div class="t m5 x93 h2f y377 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xd h14 y312 ff8 fs3 fc0 sc0 ls0 ws2f5">(~50 percent) [T2]. <span class="_ _1"></span>The cov<span class="_ _4"></span>erage map looks like a patchw<span class="_ _4"></span>ork quilt, with big gobs of unex-</div><div class="t m0 xd h14 y313 ff8 fs3 fc0 sc0 ls0 ws0">ecuted code littered all through the class. </div><div class="t m0 x74 h14 y5b4 ff8 fs3 fc0 sc0 ls0 ws321">It was m<span class="_ _1"></span>y goal to completely understand and also refactor this class. I couldn’<span class="_ _1"></span>t do that</div><div class="t m0 xd h14 y42d ff8 fs3 fc0 sc0 ls0 ws1d7">without much greater test co<span class="_ _4"></span>verage. So I wrote m<span class="_ _4"></span>y o<span class="_ _4"></span>wn suite of completely independent</div><div class="t m0 xd h14 y378 ff8 fs3 fc0 sc0 ls0 ws0">unit tests (Listing B-4, page 374). </div><div class="t m0 x74 h14 y5d6 ff8 fs3 fc0 sc0 ls0 ws56a">As you look through these tests, y<span class="_ _4"></span>ou will note that many of them are commented out.</div><div class="t m0 xd h14 y12a9 ff8 fs3 fc0 sc0 ls0 ws225">These tests didn’<span class="_ _1"></span>t pass. <span class="_ _4"></span>They represent beha<span class="_ _4"></span>vior that I think </div><div class="t m5 x21 h2f yeda ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xac h14 yeda ff8 fs3 fc0 sc0 ls44 ws13d"> should ha<span class="_ _4"></span>ve. So as</div><div class="t m0 xd h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">I refactor </div><div class="t m5 xcb h2f y5b6 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xb h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">, I’<span class="_ _4"></span>ll be w<span class="_ _4"></span>orking to make these tests pass too.</div><div class="t m0 x74 h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws34f">Even with some of the tests commented out, Clo<span class="_ _1"></span>ver reports that the new unit tests are</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws38c">ex<span class="_ _4"></span>ecuting 170 (92 percent) out of the 185 ex<span class="_ _4"></span>ecutable statements. <span class="_ _1"></span>This is pretty good<span class="_ _1"></span>, and I</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws0">think w<span class="_ _4"></span>e’<span class="_ _4"></span>ll be able to get this number higher<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y556 ff8 fs3 fc0 sc0 ls0 ws6d3">The ﬁrst few commented-out tests (lines 23-63) w<span class="_ _1"></span>ere a bit of conceit on m<span class="_ _4"></span>y par<span class="_ _8"></span>t. <span class="_ _4"></span>The</div><div class="t m0 xd h14 yb28 ff8 fs3 fc0 sc0 lsd ws2b0">pro<span class="_ _4"></span>g<span class="_ _8"></span>ram was not designed to pass these tests, but the beha<span class="_ _4"></span>vior seemed ob<span class="_ _4"></span>vious [G2] to me.</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:331.946010px;width:118.817000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12c" class="pf w1 h2" data-page-no="12c"><div class="pc pc12c w1 h2"><img class="bi xd y12aa wc had" alt="" src="bg12c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">269<span class="_ _10"></span><span class="ff1">First,<span class="_ _4"></span> Make It <span class="_ _1"></span>W<span class="_ _0"></span>ork</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws6d4">I’m not sure wh<span class="_ _1"></span>y the </div><div class="t m5 xed h2f y194 ffb fs10 fc0 sc0 ls0 ws0">testWeekdayCodeToString</div><div class="t m0 xcf h14 y194 ff8 fs3 fc0 sc0 lsd ws28b">method w<span class="_ _4"></span>as written in the ﬁrst place, but</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws583">because it is there, it seems ob<span class="_ _4"></span>vious that it should not be case sensitiv<span class="_ _4"></span>e. Writing these tests</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws43b">was tri<span class="_ _1"></span>vial [T3]. Making them pass was e<span class="_ _4"></span>ven easier; I just changed lines 259 and 263 to</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">use</div><div class="t m5 xe7 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">equalsIgnoreCase</div><div class="t m0 x5 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws2ed">I left the tests at line 32 and line 45 commented out because it’<span class="_ _2"></span>s not clear to me that</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">the “tues” and “thurs” abbreviations ought to be supported.</div><div class="t m0 x74 h14 y205 ff8 fs3 fc0 sc0 ls0 ws493">The tests on line 153 and line 154 don’<span class="_ _1"></span>t pass. Clearly<span class="_ _0"></span>, they should [G2]. <span class="_ _4"></span>W<span class="_ _0"></span>e can easily</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws360">ﬁx this, and the tests on line 163 through line 213, b<span class="_ _4"></span>y making the following changes to the</div><div class="t m5 xd h2f y207 ffb fs10 fc0 sc0 ls0 ws0">stringToMonthCode</div><div class="t m0 xe4 h14 y207 ff8 fs3 fc0 sc0 ls0 ws0"> function.</div><div class="t m0 x74 h14 y1e5 ff8 fs3 fc0 sc0 lsd ws3d">The commented test on line 318 exposes a bug in the </div><div class="t m5 x69 h2f yb05 ffb fs10 fc0 sc0 ls0 ws0">getFollowingDayOfWeek</div><div class="t m0 x64 h14 yb05 ff8 fs3 fc0 sc0 ls0 ws0">method</div><div class="t m0 xd h14 y94f ff8 fs3 fc0 sc0 ls0 ws35f">(line 672). December 25th, 2004, was a Saturda<span class="_ _1"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>The follo<span class="_ _4"></span>wing Saturda<span class="_ _4"></span>y was January 1st,</div><div class="t m0 xd h14 y950 ff8 fs3 fc0 sc0 ls0 ws402">2005. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, w<span class="_ _4"></span>hen w<span class="_ _4"></span>e r<span class="_ _8"></span>un the test, w<span class="_ _4"></span>e see that </div><div class="t m5 x54 h2f y3f7 ffb fs10 fc0 sc0 ls0 ws0">getFollowingDayOfWeek</div><div class="t m0 x6f h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws402">returns Decem-</div><div class="t m0 xd h14 yddc ff8 fs3 fc0 sc0 ls0 ws2c1">ber 25th as the Saturda<span class="_ _4"></span>y that follo<span class="_ _4"></span>ws December 25th. Clearly<span class="_ _0"></span>, this is wrong [G3],[T1]. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 ybfe ff8 fs3 fc0 sc0 ls0 ws5a1">see the problem in line 685. It is a typical boundary condition er<span class="_ _8"></span>ror [T5]. It should read as</div><div class="t m0 xd h14 y57e ff8 fs3 fc0 sc0 ls0 ws0">follo<span class="_ _4"></span>ws:</div><div class="t m0 x74 h14 ycfb ff8 fs3 fc0 sc0 ls0 ws4f2">It is interesting to note that this function w<span class="_ _4"></span>as the target of an earlier repair<span class="_ _1"></span>. <span class="_ _4"></span>The change</div><div class="t m0 xd h14 y12ab ff8 fs3 fc0 sc0 lsd ws6cb">history (line 43) shows that “bugs” w<span class="_ _1"></span>ere ﬁxed in </div><div class="t m5 xb4 h2f y81c ffb fs10 fc0 sc0 ls0 ws0">getPreviousDayOfWeek</div><div class="t m0 x6f h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xbb h2f y81c ffb fs10 fc0 sc0 ls19 ws0">getFollowing-</div><div class="t m5 xd h2f y12ac ffb fs10 fc0 sc0 ls0 ws0">DayOfWeek</div><div class="t m0 x8a h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">, and </div><div class="t m5 xe h2f y393 ffb fs10 fc0 sc0 ls0 ws0">getNearestDayOfWeek</div><div class="t m0 x5b h14 y393 ff8 fs3 fc0 sc0 ls0 ws0"> [T6]. </div><div class="t m0 x74 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">testGetNearestDayOfWeek</div><div class="t m0 x8 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws35"> unit test (line 329), which tests the </div><div class="t m5 xeb h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">getNearestDayOfWeek</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws98">method (line 705), did not start out as long and exhaustiv<span class="_ _4"></span>e as it cur<span class="_ _8"></span>rently is. I added a lot</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws69c">of test cases to it because m<span class="_ _4"></span>y initial test cases did not all pass [T6]. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can see the pattern</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws4d1">of failure by looking at w<span class="_ _4"></span>hich test cases are commented out. That patter<span class="_ _8"></span>n is rev<span class="_ _4"></span>ealing [T7].</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws5ba">It sho<span class="_ _4"></span>ws that the algorithm fails if the nearest day is in the future. Clearl<span class="_ _4"></span>y there is some</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">kind of boundary condition er<span class="_ _8"></span>ror [T5].</div><div class="t m0 x74 h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws338">The pattern of test co<span class="_ _4"></span>verage reported by Clo<span class="_ _4"></span>ver is also interesting [T8]. Line 719</div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws6d5">ne<span class="_ _4"></span>ver gets ex<span class="_ _4"></span>ecuted! <span class="_ _4"></span>This means that the </div><div class="t m5 xc4 h2f y5e8 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x65 h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws6d5">statement in line 718 is al<span class="_ _4"></span>wa<span class="_ _1"></span>ys f<span class="_ _8"></span>alse. Sure</div><div class="t m0 xd h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws35">enough, a look at the code sho<span class="_ _4"></span>ws that this must be true. <span class="_ _4"></span>The </div><div class="t m5 xc9 h2f y5e9 ffb fs10 fc0 sc0 ls0 ws0">adjust</div><div class="t m0 xb9 h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws35"> v<span class="_ _4"></span>ariable is al<span class="_ _4"></span>wa<span class="_ _1"></span>ys neg-</div><div class="t m0 xd h14 y557 ff8 fs3 fc0 sc0 ls0 ws0">ativ<span class="_ _4"></span>e and so cannot be greater or equal to 4. So this algorithm is just wrong.</div><div class="t m5 x74 h2f y12ad ffb fs10 fc0 sc0 ls0 ws0"> 457         if ((result &lt; 1) || (result &gt; 12)) {</div><div class="t m5 x74 h2f y12ae ffb fs10 fc0 sc0 ls5c ws260">                 result = -1;</div><div class="t m5 x74 h2f y12af ffb fs10 fc0 sc0 ls0 ws0"> 458             for (int i = 0; i &lt; monthNames.length; i++) {</div><div class="t m5 x74 h2f y12b0 ffb fs10 fc0 sc0 ls0 ws0"> 459                 <span class="_ _4"></span>if<span class="_ _1"></span> <span class="ls76">(s.equalsIgnoreCase(shortMonthNames[i])) {</span></div><div class="t m5 x74 h2f y12b1 ffb fs10 fc0 sc0 ls0 ws0"> 460                     result = i + 1;</div><div class="t m5 x74 h2f y12b2 ffb fs10 fc0 sc0 ls0 ws0"> 461                     break;</div><div class="t m5 x74 h2f y12b3 ffb fs10 fc0 sc0 ls0 ws0"> 462                 }</div><div class="t m5 x74 h2f y12b4 ffb fs10 fc0 sc0 ls0 ws0"> 463                 if (s.equalsIgnoreCase(monthNames[i])) {</div><div class="t m5 x74 h2f y12b5 ffb fs10 fc0 sc0 ls0 ws0"> 464                     result = i + 1;</div><div class="t m5 x74 h2f y12b6 ffb fs10 fc0 sc0 ls0 ws0"> 465                     break;</div><div class="t m5 x74 h2f y12b7 ffb fs10 fc0 sc0 ls0 ws0"> 466                 }</div><div class="t m5 x74 h2f y12b8 ffb fs10 fc0 sc0 ls0 ws0"> 467             }</div><div class="t m5 x74 h2f y12b9 ffb fs10 fc0 sc0 ls0 ws0"> 468         }</div><div class="t m5 x74 h2f y12ba ffb fs10 fc0 sc0 ls0 ws0"> 685         if (baseDOW &gt;= targetWeekday) {</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12d" class="pf w1 h2" data-page-no="12d"><div class="pc pc12d w1 h2"><img class="bi xd y3e9 wc ha9" alt="" src="bg12d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">270<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">The right algorithm is sho<span class="_ _4"></span>wn belo<span class="_ _4"></span>w:</div><div class="t m0 x74 h14 y19c ff8 fs3 fc0 sc0 ls0 ws3c8">Finall<span class="_ _4"></span>y<span class="_ _0"></span>, the tests at line 417 and line 429 can be made to pass simply b<span class="_ _4"></span>y thro<span class="_ _4"></span>wing an</div><div class="t m5 xd h2f y19d ffb fs10 fc0 sc0 ls0 ws0">IllegalArgumentException</div><div class="t m0 xa4 h14 y19d ff8 fs3 fc0 sc0 ls0 ws110">instead of returning an er<span class="_ _8"></span>ror string from </div><div class="t m5 xeb h2f y19d ffb fs10 fc0 sc0 ls0 ws0">weekInMonthToString</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x74 h2f y19e ffb fs10 fc0 sc0 ls0 ws0">relativeToString</div><div class="t m0 x9 h14 y19e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y21a ff8 fs3 fc0 sc0 ls0 ws6d6">W<span class="_ _4"></span>ith these changes all the unit tests pass, and I believ<span class="_ _4"></span>e </div><div class="t m5 x69 h2f y21a ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x6b h14 y21a ff8 fs3 fc0 sc0 ls0 ws6d6">no<span class="_ _4"></span>w w<span class="_ _4"></span>orks. So no<span class="_ _4"></span>w</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws0">it’<span class="_ _2"></span>s time to make it “right.<span class="_ _0"></span>”</div><div class="t m0 xd h17 y12bb ff1 fs9 fc0 sc0 ls0 ws0">Then Make It Right</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws6d7">W<span class="_ _0"></span>e are going to walk from the top to the bottom of </div><div class="t m5 x27 h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xef h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws6d7">, impro<span class="_ _4"></span>ving it as w<span class="_ _4"></span>e go</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws501">along. <span class="_ _1"></span>Although you w<span class="_ _4"></span>on’<span class="_ _4"></span>t see this in the discussion, I will be running all of the </div><div class="t m5 x64 h2f y4e2 ffb fs10 fc0 sc0 ls0 ws0">JCommon</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 ls0 ws22f">unit tests, including m<span class="_ _4"></span>y impro<span class="_ _4"></span>ved unit test for </div><div class="t m5 x23 h2f y25a ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xa1 h14 y25a ff8 fs3 fc0 sc0 ls0 ws22f">, after ev<span class="_ _4"></span>ery change I make. So</div><div class="t m0 xd h14 y25b ff8 fs3 fc0 sc0 ls0 ws0">rest assured that ev<span class="_ _4"></span>ery change you see here w<span class="_ _4"></span>orks for all of </div><div class="t m5 xf1 h2f y12bc ffb fs10 fc0 sc0 ls0 ws0">JCommon</div><div class="t m0 x72 h14 y12bc ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 yb1f ff8 fs3 fc0 sc0 ls0 ws6d8">Starting at line 1, we see a ream of comments with license information, cop<span class="_ _4"></span>yrights,</div><div class="t m0 xd h14 yb20 ff8 fs3 fc0 sc0 lsc ws324">authors, and change history<span class="_ _1"></span>. I ackno<span class="_ _4"></span>wledge that there are cer<span class="_ _8"></span>tain legalities that need to be</div><div class="t m0 xd h14 y48b ff8 fs3 fc0 sc0 ls0 ws3e8">addressed<span class="_ _1"></span>, and so the copyrights and licenses must sta<span class="_ _1"></span>y<span class="_ _1"></span>. On the other hand<span class="_ _1"></span>, the change his-</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws494">tory is a lefto<span class="_ _4"></span>ver from the 1960s. <span class="_ _4"></span>W<span class="_ _0"></span>e hav<span class="_ _4"></span>e source code control tools that do this for us no<span class="_ _4"></span>w<span class="_ _1"></span>.</div><div class="t m0 xd h14 y48d ff8 fs3 fc0 sc0 ls0 ws0">This history should be deleted [C1].</div><div class="t m0 x74 h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws6d9">The import list star<span class="_ _8"></span>ting at line 61 could be shor<span class="_ _8"></span>tened by using </div><div class="t m5 x60 h2f y2b9 ffb fs10 fc0 sc0 ls0 ws0">java.text.*</div><div class="t m0 x8c h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y54f ffb fs10 fc0 sc0 ls0 ws0">java.util.*</div><div class="t m0 x4c h14 y54f ff8 fs3 fc0 sc0 ls0 ws0">. [J1]</div><div class="t m0 x74 h14 y226 ff8 fs3 fc0 sc0 ls0 ws5ba">I wince at the HTML formatting in the Jav<span class="_ _4"></span>adoc (line 67). Ha<span class="_ _4"></span>ving a source ﬁle with</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws5a">more than one language in it troubles me. <span class="_ _1"></span>This comment has <span class="ffa ws0">four<span class="_ _16"> </span></span>languages in it: Ja<span class="_ _4"></span>v<span class="_ _4"></span>a,</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws433">English, Ja<span class="_ _4"></span>vadoc, and html [G1]. <span class="_ _4"></span>W<span class="_ _4"></span>ith that many languages in use, it’<span class="_ _3"></span>s hard to keep things</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws129">straight. F<span class="_ _1"></span>or example, the nice positioning of line 71 and line 72 are lost when the Ja<span class="_ _4"></span>v<span class="_ _4"></span>adoc</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws9e">is generated<span class="_ _1"></span>, and yet w<span class="_ _4"></span>ho wants to see </div><div class="t m5 x5c h2f y582 ffb fs10 fc0 sc0 ls0 ws0">&lt;ul&gt;</div><div class="t m0 x9d h14 y582 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xce h2f y582 ffb fs10 fc0 sc0 ls0 ws0">&lt;li&gt;</div><div class="t m0 x96 h14 y582 ff8 fs3 fc0 sc0 ls0 ws9e">in the source code? <span class="_ _1"></span>A better strategy</div><div class="t m0 xd h14 y584 ff8 fs3 fc0 sc0 ls0 ws6da">might be to just sur<span class="_ _8"></span>round the whole comment with </div><div class="t m5 x40 h2f y584 ffb fs10 fc0 sc0 ls0 ws0">&lt;pre&gt;</div><div class="t m0 xc9 h14 y584 ff8 fs3 fc0 sc0 ls0 ws6da">so that the formatting that is</div><div class="t m0 xd h14 y585 ff8 fs3 fc0 sc0 ls0 ws0">apparent in the source code is preserved within the Ja<span class="_ _4"></span>vadoc.</div><div class="t m0 x21 h21 y6da ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x74 h14 y45b ff8 fs3 fc0 sc0 ls0 ws612">Line 86 is the class declaration. <span class="_ _4"></span>Why is this class named </div><div class="t m5 xe8 h2f y45b ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xaf h14 y45b ff8 fs3 fc0 sc0 ls0 ws612">? <span class="_ _4"></span>What is the sig-</div><div class="t m0 xd h14 y45c ff8 fs3 fc0 sc0 ls0 ws37f">niﬁcance of the w<span class="_ _4"></span>orld “serial”? Is it because the class is deriv<span class="_ _4"></span>ed from </div><div class="t m5 x6b h2f y45c ffb fs10 fc0 sc0 ls0 ws0">Serializable</div><div class="t m0 xa8 h14 y45c ff8 fs3 fc0 sc0 ls0 ws1e5">? That</div><div class="t m0 xd h14 y45d ff8 fs3 fc0 sc0 ls0 ws0">doesn’<span class="_ _1"></span>t seem likely<span class="_ _0"></span>. </div><div class="t m5 x74 h2f y12bd ffb fs10 fc0 sc0 ls19 ws235">      int delta = targetDOW - base.getDayOfWeek();</div><div class="t m5 x74 h2f y12be ffb fs10 fc0 sc0 ls0 ws0">      int positiveDelta = delta + 7;</div><div class="t m5 x74 h2f y12bf ffb fs10 fc0 sc0 ls0 ws0">      int adjust = positiveDelta % 7;</div><div class="t m5 x74 h2f y12c0 ffb fs10 fc0 sc0 ls0 ws0">      if (adjust &gt; 3)</div><div class="t m5 x74 h2f y12c1 ffb fs10 fc0 sc0 ls0 ws0">        adjust -= 7;</div><div class="t m5 x74 h2f y12c2 ffb fs10 fc0 sc0 ls0 ws0">      return SerialDate.addDays(adjust, base);</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>An e<span class="_ _4"></span>ven better solution w<span class="_ _4"></span>ould have been for Ja<span class="_ _4"></span>vadoc to present all comments as preformatted<span class="_ _4"></span>, so that comments appear the </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">same in both code and document. </div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:400.945010px;width:119.254000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12e" class="pf w1 h2" data-page-no="12e"><div class="pc pc12e w1 h2"><img class="bi xd y45f wc hae" alt="" src="bg12e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">271<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws3dd">I w<span class="_ _4"></span>on’<span class="_ _4"></span>t keep y<span class="_ _4"></span>ou guessing. I kno<span class="_ _4"></span>w wh<span class="_ _4"></span>y (or at least I think I kno<span class="_ _4"></span>w wh<span class="_ _4"></span>y) the w<span class="_ _4"></span>ord</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws6db">“serial” was used. <span class="_ _1"></span>The clue is in the constants SERIAL_LO<span class="_ _1"></span>WER_BOUND and</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws17f">SERIAL_UPPER_BOUND on line 98 and line 101. <span class="_ _1"></span>An even better clue is in the comment</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws6dc">that begins on line 830. <span class="_ _1"></span>This class is named </div><div class="t m5 xbe h2f y197 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xe3 h14 y197 ff8 fs3 fc0 sc0 ls0 ws6dc">because it is implemented using a</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">“serial number<span class="_ _4"></span>,<span class="_ _1"></span>” which happens to be the number of da<span class="_ _4"></span>ys since December 30th, 1899. </div><div class="t m0 x74 h14 y1be ff8 fs3 fc0 sc0 ls0 ws3a3">I ha<span class="_ _4"></span>ve tw<span class="_ _4"></span>o problems with this. F<span class="_ _4"></span>irst, the term “serial number” is not really cor<span class="_ _8"></span>rect.</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 lsd ws6dd">This ma<span class="_ _4"></span>y be a quibble, but the representation is more of a relati<span class="_ _4"></span>ve of<span class="_ _4"></span>fset than a serial num-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws5e4">ber<span class="_ _1"></span>. <span class="_ _4"></span>The ter<span class="_ _8"></span>m “serial number” has more to do with product identiﬁcation markers than</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws2e6">dates. So I don’<span class="_ _1"></span>t ﬁnd this name par<span class="_ _8"></span>ticularly descripti<span class="_ _4"></span>ve [N1]. <span class="_ _1"></span>A more descriptive term</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">might be “ordinal.<span class="_ _1"></span>”</div><div class="t m0 x74 h14 y208 ff8 fs3 fc0 sc0 ls0 ws82">The second problem is more signiﬁcant. <span class="_ _1"></span>The name </div><div class="t m5 xb7 h2f y208 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xb9 h14 y208 ff8 fs3 fc0 sc0 ls0 ws82">implies an implementa-</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws6de">tion. <span class="_ _1"></span>This class is an abstract class. <span class="_ _4"></span>There is no need to imply an<span class="_ _4"></span>ything at all about the</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 wsd9">implementation. Indeed<span class="_ _1"></span>, there is good reason to hide the implementation! So I ﬁnd this</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws450">name to be at the wrong le<span class="_ _4"></span>vel of abstraction [N2]. In m<span class="_ _4"></span>y opinion, the name of this class</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws0">should simply be </div><div class="t m5 x6 h2f y12c3 ffb fs10 fc0 sc0 ls0 ws0">Date</div><div class="t m0 xc6 h14 y12c3 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 yd26 ff8 fs3 fc0 sc0 ls0 ws62">Unfortunately<span class="_ _0"></span>, there are already too many classes in the Ja<span class="_ _1"></span>va library named </div><div class="t m5 x64 h2f yd26 ffb fs10 fc0 sc0 ls0 ws0">Date</div><div class="t m0 x8c h14 yd26 ff8 fs3 fc0 sc0 ls0 ws62">, so</div><div class="t m0 xd h14 yd27 ff8 fs3 fc0 sc0 ls0 ws38">this is probabl<span class="_ _4"></span>y not the best name to choose. Because this class is all about da<span class="_ _4"></span>ys, instead of</div><div class="t m0 xd h14 y567 ff8 fs3 fc0 sc0 ls0 ws4f5">time, I considered naming it </div><div class="t m5 x5d h2f y567 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x1c h14 y567 ff8 fs3 fc0 sc0 lsd ws584">, but this name is also hea<span class="_ _4"></span>vily used in other places. In the</div><div class="t m0 xd h14 y568 ff8 fs3 fc0 sc0 ls0 ws0">end<span class="_ _1"></span>, I chose </div><div class="t m5 xc3 h2f y568 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xd6 h14 y568 ff8 fs3 fc0 sc0 ls0 ws0"> as the best compromise.</div><div class="t m0 x74 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws498">From no<span class="_ _1"></span>w on in this discussion I will use the ter<span class="_ _8"></span>m </div><div class="t m5 x27 h2f yd29 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xca h14 yd29 ff8 fs3 fc0 sc0 ls0 ws498">. I lea<span class="_ _4"></span>ve it to y<span class="_ _4"></span>ou to remem-</div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">ber that the listings you are looking at still use </div><div class="t m5 x66 h2f yd2a ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xdb h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws2e2">I understand wh<span class="_ _1"></span>y </div><div class="t m5 x4 h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x8f h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws2e2">inherits from </div><div class="t m5 xbe h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">Comparable</div><div class="t m0 xe3 h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x21 h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">Serializable</div><div class="t m0 x4a h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws2e2">. But wh<span class="_ _1"></span>y does it</div><div class="t m0 xd h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws6df">inherit from </div><div class="t m5 x6d h2f y3f7 ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 x9b h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws6e0">? The <span class="_ _8"></span>class </div><div class="t m5 x4e h2f y3f7 ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 x89 h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws6df">(Listing <span class="_ _2"></span>B-3, page <span class="_ _0"></span>372) is just a</div><div class="t m0 xd h14 yddc ff8 fs3 fc0 sc0 lsd ws3be">bunch of static ﬁnal constants that deﬁne the months. Inheriting from classes with con-</div><div class="t m0 xd h14 ybfe ff8 fs3 fc0 sc0 ls0 ws6e1">stants is an old trick that Ja<span class="_ _4"></span>va pro<span class="_ _4"></span>grammers used so that they could a<span class="_ _4"></span>void using expres-</div><div class="t m0 xd h14 y57e ff8 fs3 fc0 sc0 ls0 ws286">sions like </div><div class="t m5 x80 h2f y57e ffb fs10 fc0 sc0 ls0 ws0">MonthConstants.January</div><div class="t m0 x8 h14 y57e ff8 fs3 fc0 sc0 ls11 ws35c">, but it’<span class="_ _2"></span>s a bad idea [J2]. </div><div class="t m5 xa1 h2f y57e ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 x60 h14 y57e ff8 fs3 fc0 sc0 ls48 ws390"> should reall<span class="_ _4"></span>y be</div><div class="t m0 xd h14 y57f ff8 fs3 fc0 sc0 ls0 ws0">an enum.</div><div class="t m5 x74 h2f y12c4 ffb fs10 fc0 sc0 ls0 ws0">public abstract class DayDate implements Comparable,</div><div class="t m5 x74 h2f y12c5 ffb fs10 fc0 sc0 ls0 ws0">                                         Serializable {</div><div class="t m5 x74 h2f y12c6 ffb fs10 fc0 sc0 ls0 ws0">  public static enum Month {</div><div class="t m5 x74 h2f y12c7 ffb fs10 fc0 sc0 ls0 ws0">    JANUARY(1),</div><div class="t m5 x74 h2f y12c8 ffb fs10 fc0 sc0 ls0 ws0">    FEBRUARY(2),</div><div class="t m5 x74 h2f y12c9 ffb fs10 fc0 sc0 ls0 ws0">    MARCH(3),</div><div class="t m5 x74 h2f y12ca ffb fs10 fc0 sc0 ls0 ws0">    APRIL(4),</div><div class="t m5 x74 h2f y12cb ffb fs10 fc0 sc0 ls0 ws0">    MAY(5),</div><div class="t m5 x74 h2f y12cc ffb fs10 fc0 sc0 ls0 ws0">    JUNE(6),</div><div class="t m5 x74 h2f y12cd ffb fs10 fc0 sc0 ls0 ws0">    JULY(7),</div><div class="t m5 x74 h2f y12ce ffb fs10 fc0 sc0 ls0 ws0">    AUGUST(8),</div><div class="t m5 x74 h2f y12cf ffb fs10 fc0 sc0 ls0 ws0">    SEPTEMBER(9),</div><div class="t m5 x74 h2f y12d0 ffb fs10 fc0 sc0 ls0 ws0">    OCTOBER(10),</div><div class="t m5 x74 h2f y12d1 ffb fs10 fc0 sc0 ls0 ws0">    NOVEMBER(11),</div><div class="t m5 x74 h2f y12d2 ffb fs10 fc0 sc0 ls0 ws0">    DECEMBER(12);</div><div class="t m5 x74 h2f y12d3 ffb fs10 fc0 sc0 ls0 ws0">    Month(int index) {</div><div class="t m5 x74 h2f y12d4 ffb fs10 fc0 sc0 ls0 ws0">      this.index = index;</div><div class="t m5 x74 h2f y12d5 ffb fs10 fc0 sc0 ls0 ws0">    }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf12f" class="pf w1 h2" data-page-no="12f"><div class="pc pc12f w1 h2"><img class="bi xd y12d6 wc haf" alt="" src="bg12f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">272<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y12d7 ff8 fs3 fc0 sc0 ls0 ws0">Changing</div><div class="t m5 xe h2f y12d7 ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 x38 h14 y12d7 ff8 fs3 fc0 sc0 ls0 wsfc">to this </div><div class="t m5 x9c h2f y12d7 ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 xc4 h14 y12d7 ff8 fs3 fc0 sc0 ls0 wsfc">forces quite a fe<span class="_ _4"></span>w changes to the </div><div class="t m5 xa6 h2f y12d7 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x30 h14 y12d7 ff8 fs3 fc0 sc0 ls0 ws0">class</div><div class="t m0 xd h14 ye74 ff8 fs3 fc0 sc0 ls0 ws451">and all it’<span class="_ _2"></span>s users. It took me an hour to make all the changes. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er<span class="_ _4"></span>, any function that</div><div class="t m0 xd h14 y385 ff8 fs3 fc0 sc0 ls0 ws573">used to take an </div><div class="t m5 x39 h2f y385 ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 xba h14 y385 ff8 fs3 fc0 sc0 ls0 ws573">for a month, no<span class="_ _4"></span>w takes a </div><div class="t m5 x78 h2f y385 ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x54 h14 y385 ff8 fs3 fc0 sc0 ls0 ws573">enumerator<span class="_ _1"></span>. <span class="_ _4"></span>This means we can get rid</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws676">of the </div><div class="t m5 x3e h2f y3b6 ffb fs10 fc0 sc0 ls0 ws0">isValidMonthCode</div><div class="t m0 x6e h14 y3b6 ff8 fs3 fc0 sc0 ls0 ws676">method (line 326), and all the month code er<span class="_ _8"></span>ror checking such as</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">that in </div><div class="t m5 x52 h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">monthCodeToQuarter</div><div class="t m0 x7 h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0"> (line 356) [G5]. </div><div class="t m0 x74 h14 ydf3 ff8 fs3 fc0 sc0 ls0 ws17f">Next, w<span class="_ _1"></span>e hav<span class="_ _4"></span>e line 91, </div><div class="t m5 x1f h2f ydf3 ffb fs10 fc0 sc0 ls0 ws0">serialVersionUID</div><div class="t m0 xbe h14 ydf3 ff8 fs3 fc0 sc0 ls0 ws17f">. <span class="_ _1"></span>This variable is used to control the serializer<span class="_ _0"></span>.</div><div class="t m0 xd h14 y4de ff8 fs3 fc0 sc0 ls0 ws35a">If w<span class="_ _4"></span>e change it, then any </div><div class="t m5 x7 h2f y4de ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xc h14 y4de ff8 fs3 fc0 sc0 ls0 ws35a">written with an older version of the softw<span class="_ _4"></span>are w<span class="_ _4"></span>on’<span class="_ _4"></span>t be</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws6e2">readable an<span class="_ _4"></span>ymore and will result in an </div><div class="t m5 x4e h2f y4df ffb fs10 fc0 sc0 ls0 ws0">InvalidClassException</div><div class="t m0 x55 h14 y4df ff8 fs3 fc0 sc0 ls0 ws6e2">. If you don’<span class="_ _1"></span>t declare the</div><div class="t m5 xd h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">serialVersionUID</div><div class="t m0 x87 h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws138">v<span class="_ _4"></span>ariable, then the compiler automaticall<span class="_ _4"></span>y generates one for you, and it</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws6e3">will be different e<span class="_ _1"></span>ver<span class="_ _8"></span>y time you mak<span class="_ _4"></span>e a change to the module. I know that all the docu-</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 lsd ws2c7">ments recommend manual control of this v<span class="_ _4"></span>ariable, but it seems to me that automatic con-</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 lsd ws6e4">trol of serialization is a lot safer [G4]. <span class="_ _1"></span>After all, I’<span class="_ _2"></span>d much rather debug an</div><div class="t m5 xd h2f y12bc ffb fs10 fc0 sc0 ls0 ws0">InvalidClassException</div><div class="t m0 x2e h14 y12bc ff8 fs3 fc0 sc0 ls0 ws618">than the odd beha<span class="_ _4"></span>vior that w<span class="_ _4"></span>ould ensue if I forgot to change the</div><div class="t m5 xd h2f y12d8 ffb fs10 fc0 sc0 ls0 ws0">serialVersionUID</div><div class="t m0 xbc h14 y12d8 ff8 fs3 fc0 sc0 ls0 ws0">. So I’m going to delete the v<span class="_ _4"></span>ariable—at least for the time being.</div><div class="t m0 x90 h21 y32f ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 x74 h14 yb20 ff8 fs3 fc0 sc0 ls0 ws180">I ﬁnd the comment on line 93 redundant. Redundant comments are just places to col-</div><div class="t m0 xd h14 y48b ff8 fs3 fc0 sc0 ls0 ws0">lect lies and misinformation [C2]. So I’m going to get rid of it and its ilk.</div><div class="t m0 x74 h14 y2b7 ff8 fs3 fc0 sc0 ls0 ws309">The comments at line 97 and line 100 talk about serial numbers, which I discussed</div><div class="t m0 xd h14 y2b8 ff8 fs3 fc0 sc0 ls0 ws6b7">earlier [C1]. <span class="_ _1"></span>The variables the<span class="_ _4"></span>y describe are the earliest and latest possible dates that</div><div class="t m5 xd h2f y2b9 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x95 h14 y2b9 ff8 fs3 fc0 sc0 ls0 ws0"> can describe. <span class="_ _1"></span>This can be made a bit clearer [N1].</div><div class="t m0 x74 h14 y314 ff8 fs3 fc0 sc0 ls0 ws3fe">It’<span class="_ _2"></span>s not clear to me wh<span class="_ _4"></span>y </div><div class="t m5 x9b h2f y314 ffb fs10 fc0 sc0 ls0 ws0">EARLIEST_DATE_ORDINAL</div><div class="t m0 xea h14 y314 ff8 fs3 fc0 sc0 ls0 ws3fe">is 2 instead of 0. <span class="_ _1"></span>There is a hint in the</div><div class="t m0 xd h14 y315 ff8 fs3 fc0 sc0 ls0 ws320">comment on line 829 that suggests that this has something to do with the w<span class="_ _4"></span>ay dates are</div><div class="t m0 xd h14 y22a ff8 fs3 fc0 sc0 ls0 wsad">represented in Microsoft Excel. <span class="_ _1"></span>There is a much deeper insight provided in a deri<span class="_ _4"></span>v<span class="_ _4"></span>ative of</div><div class="t m5 xd h2f y459 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x75 h14 y459 ff8 fs3 fc0 sc0 ls0 ws0">called</div><div class="t m5 x86 h2f y459 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x84 h14 y459 ff8 fs3 fc0 sc0 ls0 ws209">(Listing B-5, page <span class="_ _8"></span>382). <span class="_ _4"></span>The comment on line 71 describes</div><div class="t m0 xd h14 y45a ff8 fs3 fc0 sc0 ls0 ws0">the issue nicel<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y3af ff8 fs3 fc0 sc0 ls0 ws413">The problem I ha<span class="_ _1"></span>ve with this is that the issue seems to be related to the implementa-</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 wsf0">tion of </div><div class="t m5 xc5 h2f yc00 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x15 h14 yc00 ff8 fs3 fc0 sc0 ls0 wsf0">and has nothing to do with </div><div class="t m5 x27 h2f yc00 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xca h14 yc00 ff8 fs3 fc0 sc0 ls0 wsf0">. I conclude from this that</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">    public static Month make(int monthIndex) {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">      for (Month m : Month.values()) {</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">        if (m.index == monthIndex)</div><div class="t m5 x74 h2f y12db ffb fs10 fc0 sc0 ls0 ws0">          return m;</div><div class="t m5 x74 h2f y12dc ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y12dd ffb fs10 fc0 sc0 ls0 ws0">      throw new IllegalArgumentException(&quot;Invalid month index &quot; + monthIndex);</div><div class="t m5 x74 h2f y12de ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y12df ffb fs10 fc0 sc0 ls0 ws0">    public final int index;</div><div class="t m5 x74 h2f y12e0 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y2d3 ff8 fse fc0 sc0 ls0 ws6e5">2.<span class="_ _17"> </span>Se<span class="_ _4"></span>veral of the revie<span class="_ _4"></span>wers of this te<span class="_ _4"></span>xt have tak<span class="_ _4"></span>en exception to this decision. <span class="_ _4"></span>They contend that in an open source framew<span class="_ _4"></span>ork it <span class="ws0">is</span></div><div class="t m0 x3b h25 y2d4 ff8 fse fc0 sc0 ls0 ws0">better to assert manual control ov<span class="_ _4"></span>er the serial ID so that minor changes to the software don’<span class="_ _4"></span>t cause old serialized dates to be</div><div class="t m0 x3b h25 y12e1 ff8 fse fc0 sc0 ls0 ws6e6">in<span class="_ _4"></span>valid. <span class="_ _4"></span>This is a fair point. How<span class="_ _4"></span>ever<span class="_ _1"></span>, at least the f<span class="_ _8"></span>ailure, inconv<span class="_ _4"></span>enient though it might be, has a clear-cut cause. On the ot<span class="ws0">her</span></div><div class="t m0 x3b h25 y12e2 ff8 fse fc0 sc0 ls0 ws0">hand<span class="_ _4"></span>, if the author of the class forgets to update the ID<span class="_ _1"></span>, then the f<span class="_ _8"></span>ailure mode is undeﬁned and might very well be silent. I </div><div class="t m0 x3b h25 y12e3 ff8 fse fc0 sc0 ls0 ws0">think the real moral of this story is that you should not expect to deserialize across versions.</div><div class="t m5 x74 h2f y828 ffb fs10 fc0 sc0 ls14 ws235">  public static final int EARLIEST_DATE_ORDINAL = 2;  <span class="_ _1"></span>   // 1/1/1900</div><div class="t m5 x74 h2f y829 ffb fs10 fc0 sc0 ls0 ws0">  public static final int LATEST_DATE_ORDINAL = 2958465; // 12/31/9999</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf130" class="pf w1 h2" data-page-no="130"><div class="pc pc130 w1 h2"><img class="bi xd ycdc wc hb0" alt="" src="bg130.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">273<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m5 xd h2f y194 ffb fs10 fc0 sc0 ls0 ws0">EARLIEST_DATE_ORDINAL</div><div class="t m0 x6e h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x5d h2f y194 ffb fs10 fc0 sc0 ls0 ws0">LATEST_DATE_ORDINAL</div><div class="t m0 x4f h14 y194 ff8 fs3 fc0 sc0 ls0 ws6e7">do not reall<span class="_ _4"></span>y belong in </div><div class="t m5 xa5 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x8c h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">should be mo<span class="_ _4"></span>ved to </div><div class="t m5 xd6 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x26 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">[G6].</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws6e8">Indeed<span class="_ _1"></span>, a search of the code sho<span class="_ _4"></span>ws that these variab<span class="_ _4"></span>les are used only within</div><div class="t m5 xd h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x24 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3e7">. Nothing in </div><div class="t m5 x9b h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x77 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3e7">, nor in an<span class="_ _4"></span>y other class in the </div><div class="t m5 x49 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">JCommon</div><div class="t m0 xa7 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws3e7">framew<span class="_ _1"></span>ork, uses</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">them. <span class="_ _1"></span>Therefore, I’ll mo<span class="_ _1"></span>ve them do<span class="_ _4"></span>wn into </div><div class="t m5 xc4 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x69 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y41c ff8 fs3 fc0 sc0 ls0 ws6e9">The next v<span class="_ _4"></span>ariables, </div><div class="t m5 xb1 h2f y41c ffb fs10 fc0 sc0 ls0 ws0">MINIMUM_YEAR_SUPPORTED</div><div class="t m0 x34 h14 y41c ff8 fs3 fc0 sc0 ls0 ws6e9">, and </div><div class="t m5 x17 h2f y41c ffb fs10 fc0 sc0 ls0 ws0">MAXIMUM_YEAR_SUPPORTED</div><div class="t m0 x99 h14 y41c ff8 fs3 fc0 sc0 ls0 ws6e9">(line 104</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws21">and line 107), pro<span class="_ _4"></span>vide something of a dilemma. It seems clear that if </div><div class="t m5 x73 h2f y205 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xe1 h14 y205 ff8 fs3 fc0 sc0 ls77 ws56"> is an abstract</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws6ea">class that pro<span class="_ _4"></span>vides no foreshado<span class="_ _4"></span>wing of implementation, then it should not inform us</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 lsc ws334">about a minimum or maximum year<span class="_ _1"></span>. <span class="_ _1"></span>Again, I am tempted to mo<span class="_ _4"></span>ve these variab<span class="_ _4"></span>les do<span class="_ _4"></span>wn</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0">into</div><div class="t m5 x2b h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x9 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws6eb">[G6]. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, a quick search of the users of these v<span class="_ _4"></span>ariables sho<span class="_ _1"></span>ws</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws15d">that one other class uses them: </div><div class="t m5 x38 h2f y208 ffb fs10 fc0 sc0 ls0 ws0">RelativeDayOfWeekRule</div><div class="t m0 x40 h14 y208 ff8 fs3 fc0 sc0 ls0 ws15d">(Listing B-6, page <span class="_ _8"></span>390). <span class="_ _4"></span>W<span class="_ _0"></span>e see that</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws446">usage at line 177 and line 178 in the </div><div class="t m5 x32 h2f y3ea ffb fs10 fc0 sc0 ls0 ws0">getDate</div><div class="t m0 x65 h14 y3ea ff8 fs3 fc0 sc0 ls0 ws446">function, where the<span class="_ _4"></span>y are used to check that</div><div class="t m0 xd h14 y3eb ff8 fs3 fc0 sc0 ls0 ws32e">the argument to </div><div class="t m5 xbc h2f y3ec ffb fs10 fc0 sc0 ls0 ws0">getDate</div><div class="t m0 xb1 h14 y3ec ff8 fs3 fc0 sc0 ls0 ws32e">is a valid y<span class="_ _4"></span>ear<span class="_ _1"></span>. <span class="_ _4"></span>The dilemma is that a user of an abstract class</div><div class="t m0 xd h14 y3ed ff8 fs3 fc0 sc0 ls0 ws0">needs information about its implementation. </div><div class="t m0 x74 h14 yd25 ff8 fs3 fc0 sc0 ls4b ws6ec">What w<span class="_ _4"></span>e need to do is pro<span class="_ _4"></span>vide this infor<span class="_ _8"></span>mation without polluting </div><div class="t m5 xbd h2f yd25 ffb fs10 fc0 sc0 ls78 ws0">DayDate</div><div class="t m0 x36 h14 yd25 ff8 fs3 fc0 sc0 ls4b ws0">itself.</div><div class="t m0 xd h14 yd26 ff8 fs3 fc0 sc0 ls4b ws6b7">Usually<span class="_ _0"></span>, w<span class="_ _4"></span>e w<span class="_ _4"></span>ould get implementation information from an instance of a deriv<span class="_ _4"></span>ative.</div><div class="t m0 xd h14 yd27 ff8 fs3 fc0 sc0 ls4b ws68e">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the </div><div class="t m5 x14 h2f yd27 ffb fs10 fc0 sc0 ls78 ws0">getDate</div><div class="t m0 x4 h14 yd27 ff8 fs3 fc0 sc0 ls4b ws68e">function is not passed an instance of a </div><div class="t m5 xab h2f yd27 ffb fs10 fc0 sc0 ls78 ws0">DayDate</div><div class="t m0 xac h14 yd27 ff8 fs3 fc0 sc0 ls4b ws68e">. It does, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er,</div><div class="t m0 xd h14 y567 ff8 fs3 fc0 sc0 ls4b ws4de">return such an instance, which means that some<span class="_ _4"></span>where it must be creating it. Line 187</div><div class="t m0 xd h14 y568 ff8 fs3 fc0 sc0 ls4b ws6ed">through line 205 pro<span class="_ _4"></span>vide the hint. <span class="_ _1"></span>The </div><div class="t m5 x4e h2f y568 ffb fs10 fc0 sc0 ls78 ws0">DayDate</div><div class="t m0 x3d h14 y568 ff8 fs3 fc0 sc0 ls4b ws6ed">instance is being created b<span class="_ _4"></span>y one of the</div><div class="t m0 xd h14 y569 ff8 fs3 fc0 sc0 ls4b ws6ee">three functions, </div><div class="t m5 xbc h2f y569 ffb fs10 fc0 sc0 ls78 ws0">getPreviousDayOfWeek</div><div class="t m0 x5c h14 y569 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xe0 h2f y569 ffb fs10 fc0 sc0 ls78 ws0">getNearestDayOfWeek</div><div class="t m0 x7f h14 y569 ff8 fs3 fc0 sc0 ls4b ws6ee">, or </div><div class="t m5 xb9 h2f y569 ffb fs10 fc0 sc0 ls78 ws0">getFollowingDayOfWeek</div><div class="t m0 x56 h14 y569 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 ye6e ff8 fs3 fc0 sc0 ls4b ws5a9">Looking back at the </div><div class="t m5 xb h2f ye6e ffb fs10 fc0 sc0 ls78 ws0">DayDate</div><div class="t m0 x5d h14 ye6e ff8 fs3 fc0 sc0 ls4b ws5a9">listing, w<span class="_ _4"></span>e see that these functions (lines 638–724) all retur<span class="_ _8"></span>n</div><div class="t m0 xd h14 yc58 ff8 fs3 fc0 sc0 ls4b ws6ef">a date created b<span class="_ _4"></span>y </div><div class="t m5 x6 h2f yc58 ffb fs10 fc0 sc0 ls78 ws0">addDays</div><div class="t m0 x7d h14 yc58 ff8 fs3 fc0 sc0 ls4b ws6ef">(line 571), which calls </div><div class="t m5 xd5 h2f yc58 ffb fs10 fc0 sc0 ls78 ws0">createInstance</div><div class="t m0 xa0 h14 yc58 ff8 fs3 fc0 sc0 ls4b ws6ef">(line 808), which creates</div><div class="t m0 xd h14 yc59 ff8 fs3 fc0 sc0 ls0 ws0">a</div><div class="t m5 x2c h2f yc59 ffb fs10 fc0 sc0 ls78 ws0">SpreadsheetDate</div><div class="t m0 xe4 h14 yc59 ff8 fs3 fc0 sc0 ls0 ws0">! [G7].</div><div class="t m0 x74 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws6d2">It’<span class="_ _2"></span>s generally a bad idea for base classes to kno<span class="_ _1"></span>w about their deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>es. <span class="_ _4"></span>T<span class="_ _0"></span>o ﬁx this, we</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls0 ws426">should use the A<span class="fsb ws0">BSTRACT<span class="fs3 ls79"> F</span>ACTORY</span></div><div class="t m0 x5b h21 y2b7 ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x26 h14 y3df ff8 fs3 fc0 sc0 ls0 ws426">pattern and create a </div><div class="t m5 x89 h2f y3df ffb fs10 fc0 sc0 ls0 ws0">DayDateFactory</div><div class="t m0 x8d h14 y3df ff8 fs3 fc0 sc0 ls0 ws426">. <span class="_ _1"></span>This f<span class="_ _8"></span>actor<span class="_ _8"></span>y will</div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws467">create the instances of </div><div class="t m5 xa h2f y3e0 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xdf h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws467">that w<span class="_ _4"></span>e need and can also answ<span class="_ _4"></span>er questions about the</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">implementation, such as the maximum and minimum dates.</div><div class="t m0 xd h25 yec2 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>[GOF].</div><div class="t m5 x74 h2f y336 ffb fs10 fc0 sc0 ls0 ws0">public abstract class DayDateFactory {</div><div class="t m5 x74 h2f y12e4 ffb fs10 fc0 sc0 ls0 ws0">  private static DayDateFactory factory = new SpreadsheetDateFactory();</div><div class="t m5 x74 h2f y12e5 ffb fs10 fc0 sc0 ls0 ws0">  public static void setInstance(DayDateFactory factory) {</div><div class="t m5 x74 h2f y12e6 ffb fs10 fc0 sc0 ls0 ws0">    DayDateFactory.factory = factory;</div><div class="t m5 x74 h2f y12e7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12e8 ffb fs10 fc0 sc0 ls0 ws0">  protected abstract DayDate _makeDate(int ordinal);</div><div class="t m5 x74 h2f y12e9 ffb fs10 fc0 sc0 ls0 ws0">  protected abstract DayDate _makeDate(int day, DayDate.Month month, int year);</div><div class="t m5 x74 h2f y12ea ffb fs10 fc0 sc0 ls0 ws0">  protected abstract DayDate _makeDate(int day, int month, int year);</div><div class="t m5 x74 h2f y12eb ffb fs10 fc0 sc0 ls0 ws0">  protected abstract DayDate _makeDate(java.util.Date date);</div><div class="t m5 x74 h2f y12ec ffb fs10 fc0 sc0 ls0 ws0">  protected abstract int _getMinimumYear();</div><div class="t m5 x74 h2f y12ed ffb fs10 fc0 sc0 ls0 ws0">  protected abstract int _getMaximumYear();</div><div class="t m5 x74 h2f y12ee ffb fs10 fc0 sc0 ls0 ws0">  public static DayDate makeDate(int ordinal) {</div><div class="t m5 x74 h2f y12ef ffb fs10 fc0 sc0 ls0 ws0">    return factory._makeDate(ordinal);</div><div class="t m5 x74 h2f y12f0 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf131" class="pf w1 h2" data-page-no="131"><div class="pc pc131 w1 h2"><img class="bi xd y3e9 wc h62" alt="" src="bg131.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">274<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h1d y4e0 ffd fs3 fc0 sc0 ls0 ws58b">This factory class replaces the </div><div class="t m5 x20 h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">createInstance</div><div class="t m0 x4f h1d y4e0 ffd fs3 fc0 sc0 ls0 ws58b">methods with </div><div class="t m5 xa0 h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">makeDate</div><div class="t m0 x45 h1d y4e0 ffd fs3 fc0 sc0 ls0 ws58b">methods, which</div><div class="t m0 xd h1d y4e1 ffd fs3 fc0 sc0 ls0 ws506">improv<span class="_ _4"></span>es the names quite a bit [N1]. It defaults to a </div><div class="t m5 x27 h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDateFactory</div><div class="t m0 x7a h1d y4e1 ffd fs3 fc0 sc0 ls0 ws506">but can be</div><div class="t m0 xd h1d y4e2 ffd fs3 fc0 sc0 lsc ws42d">changed at any time to use a dif<span class="_ _4"></span>ferent factory<span class="_ _1"></span>. The static methods that dele<span class="_ _4"></span>gate to abstract</div><div class="t m0 xd h1d y25a ffd fs3 fc0 sc0 ls0 ws454">methods use a combination of the S<span class="fsb ws0">INGLETON<span class="fs3">,</span></span></div><div class="t m0 xcf h99 y32e ffd fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 x42 h1d y25a ffd fs3 fc0 sc0 ls7a ws0"> D<span class="_ _0"></span><span class="fsb ls0">ECORATOR<span class="fs3">,</span></span></div><div class="t m0 x53 h99 y32e ffd fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 xf3 h1d y25a ffd fs3 fc0 sc0 ls0 ws454">and A<span class="fsb ws0">BSTRACT<span class="fs3 ls7a"> F<span class="_ _0"></span><span class="fsb ls0">ACTORY</span></span></span></div><div class="t m0 xd h1d y25b ffd fs3 fc0 sc0 ls0 ws0">patterns that I hav<span class="_ _4"></span>e found to be useful.</div><div class="t m0 x74 h1d y2c ffd fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y2c ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDateFactory</div><div class="t m0 x92 h1d y2c ffd fs3 fc0 sc0 ls0 ws0"> looks like this.</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">  public static DayDate makeDate(int day, DayDate.Month month, int year) {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    return factory._makeDate(day, month, year);</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12dc ffb fs10 fc0 sc0 ls0 ws0">  public static DayDate makeDate(int day, int month, int year) {</div><div class="t m5 x74 h2f y12dd ffb fs10 fc0 sc0 ls0 ws0">    return factory._makeDate(day, month, year);</div><div class="t m5 x74 h2f y12de ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12e0 ffb fs10 fc0 sc0 ls0 ws0">  public static DayDate makeDate(java.util.Date date) {</div><div class="t m5 x74 h2f y12f1 ffb fs10 fc0 sc0 ls0 ws0">    return factory._makeDate(date);</div><div class="t m5 x74 h2f y12f2 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12f3 ffb fs10 fc0 sc0 ls0 ws0">  public static int getMinimumYear() {</div><div class="t m5 x74 h2f y12f4 ffb fs10 fc0 sc0 ls0 ws0">    return factory._getMinimumYear();</div><div class="t m5 x74 h2f y12f5 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12f6 ffb fs10 fc0 sc0 ls0 ws0">  public static int getMaximumYear() {</div><div class="t m5 x74 h2f y12f7 ffb fs10 fc0 sc0 ls0 ws0">    return factory._getMaximumYear();</div><div class="t m5 x74 h2f y12f8 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12f9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>Ibid.</div><div class="t m0 xd h25 y39b ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>Ibid.</div><div class="t m5 x74 h2f y1096 ffb fs10 fc0 sc0 ls0 ws0">public class SpreadsheetDateFactory extends DayDateFactory {</div><div class="t m5 x74 h2f y12fa ffb fs10 fc0 sc0 ls0 ws0">  public DayDate _makeDate(int ordinal) {</div><div class="t m5 x74 h2f y12fb ffb fs10 fc0 sc0 ls0 ws0">    return new SpreadsheetDate(ordinal);</div><div class="t m5 x74 h2f y12fc ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12fd ffb fs10 fc0 sc0 ls0 ws0">  public DayDate _makeDate(int day, DayDate.Month month, int year) {</div><div class="t m5 x74 h2f y12fe ffb fs10 fc0 sc0 ls0 ws0">    return new SpreadsheetDate(day, month, year);</div><div class="t m5 x74 h2f y12ff ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1300 ffb fs10 fc0 sc0 ls0 ws0">  public DayDate _makeDate(int day, int month, int year) {</div><div class="t m5 x74 h2f y1301 ffb fs10 fc0 sc0 ls0 ws0">    return new SpreadsheetDate(day, month, year);</div><div class="t m5 x74 h2f y1302 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1303 ffb fs10 fc0 sc0 ls0 ws0">  public DayDate _makeDate(Date date) {</div><div class="t m5 x74 h2f y1304 ffb fs10 fc0 sc0 ls0 ws0">    final GregorianCalendar calendar = new GregorianCalendar();</div><div class="t m5 x74 h2f y1305 ffb fs10 fc0 sc0 ls0 ws0">    calendar.setTime(date);</div><div class="t m5 x74 h2f y1306 ffb fs10 fc0 sc0 ls0 ws0">    return new SpreadsheetDate(</div><div class="t m5 x74 h2f y1307 ffb fs10 fc0 sc0 ls1a ws2f6">      calendar.get(Calendar.DATE),</div><div class="t m5 x74 h2f y1308 ffb fs10 fc0 sc0 ls18 ws2f1">      DayDate.Month.make(calendar.get(Calendar.MONTH) + 1),</div><div class="t m5 x74 h2f y1309 ffb fs10 fc0 sc0 ls1f ws3b8">      calendar.get(Calendar.YEAR));</div><div class="t m5 x74 h2f y130a ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf132" class="pf w1 h2" data-page-no="132"><div class="pc pc132 w1 h2"><img class="bi xd y130b wc hb1" alt="" src="bg132.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">275<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 x74 h14 ycaa ff8 fs3 fc0 sc0 ls0 ws6f0">As you can see, I ha<span class="_ _1"></span>ve already mo<span class="_ _4"></span>ved the </div><div class="t m5 xc9 h2f y276 ffb fs10 fc0 sc0 ls0 ws0">MINIMUM_YEAR_SUPPORTED</div><div class="t m0 x8c h14 y276 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y277 ffb fs10 fc0 sc0 ls0 ws0">MAXIMUM_YEAR_SUPPORTED</div><div class="t m0 x9e h14 y277 ff8 fs3 fc0 sc0 ls0 ws0"> v<span class="_ _4"></span>ariables into </div><div class="t m5 x31 h2f y277 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x27 h14 y277 ff8 fs3 fc0 sc0 ls0 ws0">, where the<span class="_ _4"></span>y belong [G6].</div><div class="t m0 x74 h14 y39d ff8 fs3 fc0 sc0 ls0 ws6e0">The next issue in </div><div class="t m5 xd0 h2f y39d ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x84 h14 y39d ff8 fs3 fc0 sc0 ls0 ws6e0">are the da<span class="_ _4"></span>y constants beginning at line 109. <span class="_ _1"></span>These should</div><div class="t m0 xd h14 y39e ff8 fs3 fc0 sc0 ls0 ws6f1">reall<span class="_ _4"></span>y be another enum [J3]. W<span class="_ _0"></span>e’<span class="_ _1"></span>ve seen this pattern before, so I won’<span class="_ _1"></span>t repeat it here. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws0">see it in the ﬁnal listings.</div><div class="t m0 x74 h14 y254 ff8 fs3 fc0 sc0 ls0 ws14a">Next, w<span class="_ _1"></span>e see a series of tables starting with </div><div class="t m5 xc0 h2f y254 ffb fs10 fc0 sc0 ls0 ws0">LAST_DAY_OF_MONTH</div><div class="t m0 xeb h14 y254 ff8 fs3 fc0 sc0 ls0 ws14a">at line 140. My ﬁrst</div><div class="t m0 xd h14 y255 ff8 fs3 fc0 sc0 ls0 ws6f2">issue with these tables is that the comments that describe them are redundant [C3]. <span class="_ _1"></span>Their</div><div class="t m0 xd h14 y29c ff8 fs3 fc0 sc0 ls0 ws0">names are sufﬁcient. So I’m going to delete the comments.</div><div class="t m0 x74 h14 y257 ff8 fs3 fc0 sc0 ls0 ws5a6">There seems to be no good reason that this table isn’<span class="_ _1"></span>t priv<span class="_ _4"></span>ate [G8], because there is a</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">static function </div><div class="t m5 x86 h2f y258 ffb fs10 fc0 sc0 ls0 ws0">lastDayOfMonth</div><div class="t m0 xcc h14 y258 ff8 fs3 fc0 sc0 ls0 ws0"> that pro<span class="_ _4"></span>vides the same data.</div><div class="t m0 x74 h14 y4e2 ff8 fs3 fc0 sc0 ls0 wsdf">The next tab<span class="_ _4"></span>le, </div><div class="t m5 xba h2f y4e2 ffb fs10 fc0 sc0 ls0 ws0">AGGREGATE_DAYS_TO_END_OF_MONTH</div><div class="t m0 xea h14 y4e2 ff8 fs3 fc0 sc0 ls0 wsdf">, is a bit more m<span class="_ _4"></span>ysterious because it is</div><div class="t m0 xd h14 y25a ff8 fs3 fc0 sc0 ls0 ws0">not used anyw<span class="_ _4"></span>here in the </div><div class="t m5 xb1 h2f y486 ffb fs10 fc0 sc0 ls0 ws0">JCommon</div><div class="t m0 xdf h14 y486 ff8 fs3 fc0 sc0 ls0 ws0"> framew<span class="_ _1"></span>ork [G9]. So I deleted it.</div><div class="t m0 x74 h14 y7a3 ff8 fs3 fc0 sc0 ls0 ws0">The same goes for </div><div class="t m5 x2e h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_MONTH.</div><div class="t m0 x74 h14 y3c0 ff8 fs3 fc0 sc0 ls12 ws6f3">The next tab<span class="_ _4"></span>le, </div><div class="t m5 xb h2f y3c0 ffb fs10 fc0 sc0 ls5d ws0">AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH</div><div class="t m0 xa0 h14 y3c0 ff8 fs3 fc0 sc0 ls12 ws6f3">, is used onl<span class="_ _4"></span>y in </div><div class="t m5 x64 h2f y3c0 ffb fs10 fc0 sc0 ls5d ws0">Spread-</div><div class="t m5 xd h2f y130c ffb fs10 fc0 sc0 ls5d ws0">sheetDate</div><div class="t m0 x5f h14 y3c1 ff8 fs3 fc0 sc0 ls12 ws4f4">(line 434 and line 473). <span class="_ _1"></span>This begs the question of whether it should be mo<span class="_ _1"></span>ved</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls12 ws0">to</div><div class="t m5 xcd h2f y54e ffb fs10 fc0 sc0 ls5d ws0">SpreadsheetDate</div><div class="t m0 xf2 h14 y54e ff8 fs3 fc0 sc0 ls12 wsfa">. <span class="_ _1"></span>The argument for not mo<span class="_ _4"></span>ving it is that the table is not speciﬁc to an<span class="_ _4"></span>y</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls12 ws6f4">particular implementation <span class="ls7b ws4cc">[G6]. On </span>the other hand<span class="_ _4"></span>, no implementation other than</div><div class="t m5 xd h2f y2b8 ffb fs10 fc0 sc0 ls5d ws0">SpreadsheetDate</div><div class="t m0 xbc h14 y2b8 ff8 fs3 fc0 sc0 ls12 ws6f5">actually e<span class="_ _4"></span>xists, and so the table should be mo<span class="_ _1"></span>ved close to where it is</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 ls16 ws0">used [G10].</div><div class="t m0 x74 h14 y2ba ff8 fs3 fc0 sc0 ls0 ws5f4">What settles the argument for me is that to be consistent [G11], w<span class="_ _1"></span>e should make the</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 ws2ad">table pri<span class="_ _4"></span>v<span class="_ _4"></span>ate and expose it through a function like </div><div class="t m5 xd2 h2f y226 ffb fs10 fc0 sc0 ls0 ws0">julianDateOfLastDayOfMonth</div><div class="t m0 x99 h14 y226 ff8 fs3 fc0 sc0 ls0 ws2ad">. Nobody</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws288">seems to need a function like that. Moreo<span class="_ _1"></span>ver<span class="_ _4"></span>, the table can be mo<span class="_ _1"></span>ved back to </div><div class="t m5 xbb h2f y227 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x36 h14 y227 ff8 fs3 fc0 sc0 ls0 ws0">easily</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls0 ws0">if any ne<span class="_ _1"></span>w implementation of </div><div class="t m5 x1 h2f y228 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x9c h14 y228 ff8 fs3 fc0 sc0 ls0 ws0"> needs it. So I mo<span class="_ _4"></span>ved it.</div><div class="t m0 x74 h14 y315 ff8 fs3 fc0 sc0 ls0 ws0">The same goes for the table, </div><div class="t m5 xec h2f y315 ffb fs10 fc0 sc0 ls0 ws0">LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_MONTH</div><div class="t m9 xe1 hb2 y315 ffb fs18 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y3ad ff8 fs3 fc0 sc0 ls0 ws409">Next, w<span class="_ _1"></span>e see three sets of constants that can be tur<span class="_ _8"></span>ned into enums (lines 162–205).</div><div class="t m0 xd h14 y544 ff8 fs3 fc0 sc0 ls0 ws72">The ﬁrst of the three selects a w<span class="_ _4"></span>eek within a month. I changed it into an enum named</div><div class="t m5 xd h2f y3ae ffb fs10 fc0 sc0 ls0 ws0">WeekInMonth</div><div class="t m0 x4c h14 y3ae ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">  protected int _getMinimumYear() {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    return SpreadsheetDate.MINIMUM_YEAR_SUPPORTED;</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12dc ffb fs10 fc0 sc0 ls0 ws0">  protected int _getMaximumYear() {</div><div class="t m5 x74 h2f y12dd ffb fs10 fc0 sc0 ls0 ws0">    return SpreadsheetDate.MAXIMUM_YEAR_SUPPORTED;</div><div class="t m5 x74 h2f y12de ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y12df ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y130d ffb fs10 fc0 sc0 ls0 ws0">public enum WeekInMonth {</div><div class="t m5 x74 h2f y130e ffb fs10 fc0 sc0 ls0 ws0">    FIRST(1), SECOND(2), THIRD(3), FOURTH(4), LAST(0);</div><div class="t m5 x74 h2f y130f ffb fs10 fc0 sc0 ls0 ws0">    public final int index;</div><div class="t m5 x74 h2f y1310 ffb fs10 fc0 sc0 ls0 ws0">    WeekInMonth(int index) {</div><div class="t m5 x74 h2f y1311 ffb fs10 fc0 sc0 ls0 ws0">      this.index = index;</div><div class="t m5 x74 h2f y1312 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1313 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf133" class="pf w1 h2" data-page-no="133"><div class="pc pc133 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg133.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">276<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws425">The second set of constants (lines 177–187) is a bit more obscure. <span class="_ _1"></span>The </div><div class="t m5 xe1 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">INCLUDE_NONE</div><div class="t m0 x56 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">INCLUDE_FIRST</div><div class="t m0 x28 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x39 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">INCLUDE_SECOND</div><div class="t m0 x8f h14 y195 ff8 fs3 fc0 sc0 ls0 ws31b">, and </div><div class="t m5 x43 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">INCLUDE_BOTH</div><div class="t m0 x3c h14 y195 ff8 fs3 fc0 sc0 ls0 ws31b">constants are used to describe whether</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws29b">the deﬁning end-point dates of a range should be included in that range. Mathematicall<span class="_ _4"></span>y<span class="_ _1"></span>,</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws6f6">this is described using the terms “open inter<span class="_ _8"></span>val,<span class="_ _0"></span>” “half-open inter<span class="_ _8"></span>val,<span class="_ _0"></span>” and “closed inter-</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws1b">val.<span class="_ _0"></span>” I think it is clearer using the mathematical nomenclature [N3], so I changed it to an</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">enum named </div><div class="t m5 x6d h2f y199 ffb fs10 fc0 sc0 ls0 ws0">DateInterval</div><div class="t m0 x7 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0"> with </div><div class="t m5 xa2 h2f y199 ffb fs10 fc0 sc0 ls0 ws0">CLOSED</div><div class="t m0 x31 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x48 h2f y199 ffb fs10 fc0 sc0 ls0 ws0">CLOSED_LEFT</div><div class="t m0 x7e h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x96 h2f y199 ffb fs10 fc0 sc0 ls0 ws0">CLOSED_RIGHT</div><div class="t m0 xef h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">, and </div><div class="t m5 x8b h2f y199 ffb fs10 fc0 sc0 ls0 ws0">OPEN</div><div class="t m0 xbd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0"> enumerators. </div><div class="t m0 x74 h14 y19a ff8 fs3 fc0 sc0 ls0 ws495">The third set of constants (lines 18–205) describe whether a search for a particular</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws281">da<span class="_ _4"></span>y of the w<span class="_ _4"></span>eek should result in the last, next, or nearest instance. Deciding what to call</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws156">this is difﬁcult at best. In the end<span class="_ _0"></span>, I settled for </div><div class="t m5 xcf h2f y19c ffb fs10 fc0 sc0 ls0 ws0">WeekdayRange</div><div class="t m0 x7f h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">with</div><div class="t m5 xb9 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">LAST</div><div class="t m0 xac h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x8d h2f y19c ffb fs10 fc0 sc0 ls0 ws0">NEXT</div><div class="t m0 xa6 h14 y19c ff8 fs3 fc0 sc0 ls0 ws156">, and </div><div class="t m5 x64 h2f y19c ffb fs10 fc0 sc0 ls0 ws0">NEAREST</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">enumerators.</div><div class="t m0 x74 h14 y208 ff8 fs3 fc0 sc0 lsd ws6f7">Y<span class="_ _3"></span>ou might not ag<span class="_ _8"></span>ree with the names I’<span class="_ _4"></span>ve chosen. <span class="_ _1"></span>They make sense to me, but the<span class="_ _4"></span>y</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws305">ma<span class="_ _4"></span>y not make sense to you. <span class="_ _1"></span>The point is that they are no<span class="_ _1"></span>w in a for<span class="_ _8"></span>m that makes them easy</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws67">to change [J3]. <span class="_ _1"></span>They aren’<span class="_ _4"></span>t passed as integers an<span class="_ _4"></span>ymore; they are passed as symbols. I can</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws6f8">use the “change name” function of m<span class="_ _4"></span>y IDE to change the names, or the types, without</div><div class="t m0 xd h14 y36c ff8 fs3 fc0 sc0 ls0 ws159">w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>ying that I missed some </div><div class="t m5 x5d h2f y12c3 ffb fs10 fc0 sc0 ls0 ws0">-1</div><div class="t m0 xf6 h14 y12c3 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x81 h2f y12c3 ffb fs10 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5b h14 y12c3 ff8 fs3 fc0 sc0 ls0 ws159">somew<span class="_ _4"></span>here in the code or that some </div><div class="t m5 x8d h2f y12c3 ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 xbd h14 y12c3 ff8 fs3 fc0 sc0 ls0 ws159">argument dec-</div><div class="t m0 xd h14 y565 ff8 fs3 fc0 sc0 ls0 ws0">laration is left poorly described.</div><div class="t m0 x74 h14 yd27 ff8 fs3 fc0 sc0 ls0 ws47c">The description ﬁeld at line 208 does not seem to be used b<span class="_ _4"></span>y any<span class="_ _4"></span>one. I deleted it along</div><div class="t m0 xd h14 y567 ff8 fs3 fc0 sc0 ls0 ws0">with its accessor and mutator [G9].</div><div class="t m0 x74 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws6f9">I also deleted the degenerate default constructor at line 213 [G12]. <span class="_ _4"></span>The compiler will</div><div class="t m0 xd h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">generate it for us. </div><div class="t m0 x74 h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws3af">W<span class="_ _0"></span>e can skip o<span class="_ _4"></span>ver the </div><div class="t m5 x7d h2f y3f5 ffb fs10 fc0 sc0 ls0 ws0">isValidWeekdayCode</div><div class="t m0 x65 h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws3af">method (lines 216–238) because w<span class="_ _4"></span>e deleted</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws0">it when w<span class="_ _1"></span>e created the </div><div class="t m5 xd0 h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x7 h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws0"> enumeration.</div><div class="t m0 x74 h14 y414 ff8 fs3 fc0 sc0 ls0 ws6fa">This brings us to the </div><div class="t m5 x57 h2f y414 ffb fs10 fc0 sc0 ls0 ws0">stringToWeekdayCode</div><div class="t m0 x3d h14 y414 ff8 fs3 fc0 sc0 ls0 ws6fa">method (lines 242–270). Ja<span class="_ _4"></span>vadocs that</div><div class="t m0 xd h14 y42a ff8 fs3 fc0 sc0 ls7c ws6fb">don’<span class="_ _1"></span>t add much to the method signature are just clutter [C3],[G12]. <span class="_ _4"></span>The only v<span class="_ _4"></span>alue this</div><div class="t m0 xd h14 y42b ff8 fs3 fc0 sc0 ls0 ws350">Ja<span class="_ _4"></span>vadoc adds is the description of the </div><div class="t m5 x9c h2f y42b ffb fs10 fc0 sc0 ls0 ws0">-1</div><div class="t m0 xe0 h14 y42b ff8 fs3 fc0 sc0 ls0 ws350">return value. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er<span class="_ _4"></span>, because we changed to the</div><div class="t m5 xd h2f yddd ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x2b h14 yddd ff8 fs3 fc0 sc0 lsd ws6fc">enumeration, the comment is actuall<span class="_ _4"></span>y wrong [C2]. <span class="_ _4"></span>The method no<span class="_ _4"></span>w throws an</div><div class="t m5 xd h2f y58b ffb fs10 fc0 sc0 ls0 ws0">IllegalArgumentException</div><div class="t m0 x7d h14 y58b ff8 fs3 fc0 sc0 ls0 ws0">. So I deleted the Ja<span class="_ _4"></span>vadoc.</div><div class="t m0 x74 h14 y58c ff8 fs3 fc0 sc0 ls0 ws52">I also deleted all the </div><div class="t m5 xf8 h2f y58d ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 x8f h14 y58d ff8 fs3 fc0 sc0 ls0 ws52"> keyw<span class="_ _1"></span>ords in arguments and v<span class="_ _4"></span>ariable declarations. <span class="_ _1"></span>As far as</div><div class="t m0 xd h14 y43a ff8 fs3 fc0 sc0 lsd ws6f6">I could tell, they added no real v<span class="_ _4"></span>alue but did add to the clutter [G12]. Eliminating </div><div class="t m5 xd8 h2f y43a ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 xd h14 y43b ff8 fs3 fc0 sc0 ls0 ws330">ﬂies in the face of some con<span class="_ _4"></span>ventional wisdom. F<span class="_ _1"></span>or example, Rober<span class="_ _8"></span>t Simmons</div><div class="t m0 x99 h21 y37d ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 x90 h14 y43b ff8 fs3 fc0 sc0 ls0 ws0">strongly</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc0 sc0 ls0 wsd3">recommends us to “. . . spread </div><div class="t m5 xa2 h2f y2e7 ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 x32 h14 y2e7 ff8 fs3 fc0 sc0 ls0 wsd3">all o<span class="_ _4"></span>ver y<span class="_ _4"></span>our code.<span class="_ _1"></span>” Clearly I disagree. I think that</div><div class="t m0 xd h14 y43c ff8 fs3 fc0 sc0 ls0 ws1e8">there are a fe<span class="_ _4"></span>w good uses for </div><div class="t m5 x8f h2f y43c ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 x5b h14 y43c ff8 fs3 fc0 sc0 ls0 ws1e8">, such as the occasional </div><div class="t m5 xc9 h2f y43c ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 xb9 h14 y43c ff8 fs3 fc0 sc0 ls11 ws6fd">constant, but otherwise</div><div class="t m0 xd h14 y959 ff8 fs3 fc0 sc0 ls0 wsf9">the ke<span class="_ _4"></span>yword adds little v<span class="_ _4"></span>alue and creates a lot of clutter<span class="_ _1"></span>. Perhaps I feel this w<span class="_ _4"></span>a<span class="_ _4"></span>y because the</div><div class="t m0 xd h14 y95a ff8 fs3 fc0 sc0 ls0 ws0">kinds of er<span class="_ _8"></span>rors that </div><div class="t m5 xba h2f y95a ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 x15 h14 y95a ff8 fs3 fc0 sc0 ls0 ws0"> might catch are already caught b<span class="_ _4"></span>y the unit tests I write.</div><div class="t m0 x74 h14 y43d ff8 fs3 fc0 sc0 ls0 ws6fe">I didn’<span class="_ _1"></span>t care for the duplicate </div><div class="t m5 x5b h2f y43d ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x5c h14 y43d ff8 fs3 fc0 sc0 ls0 ws6fe">statements [G5] inside the </div><div class="t m5 xf9 h2f y43d ffb fs10 fc0 sc0 ls0 ws0">for</div><div class="t m0 xac h14 y43d ff8 fs3 fc0 sc0 ls0 ws6fe">loop (line 259 and</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws62f">line 263), so I connected them into a single </div><div class="t m5 x9d h2f y43e ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x66 h14 y43e ff8 fs3 fc0 sc0 ls0 ws62f">statement using the </div><div class="t m5 xf9 h2f y43e ffb fs10 fc0 sc0 ls0 ws0">||</div><div class="t m0 x97 h14 y43e ff8 fs3 fc0 sc0 ls0 ws62f">operator<span class="_ _1"></span>. I also used</div><div class="t m0 xd h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y1314 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x52 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0"> enumeration to direct the </div><div class="t m5 xec h2f y1314 ffb fs10 fc0 sc0 ls0 ws0">for</div><div class="t m0 xd1 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0"> loop and made a fe<span class="_ _4"></span>w other cosmetic changes.</div><div class="t m0 x74 h14 y3ca ff8 fs3 fc0 sc0 ls0 wsfe">It occur<span class="_ _8"></span>red to me that this method does not really belong in </div><div class="t m5 x82 h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x5e h14 y3ca ff8 fs3 fc0 sc0 ls0 wsfe">. It’<span class="_ _2"></span>s really the</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws676">parse function of </div><div class="t m5 x6 h2f y43f ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 xb h14 y43f ff8 fs3 fc0 sc0 ls0 ws676">. So I mo<span class="_ _4"></span>ved it into the </div><div class="t m5 x67 h2f y43f ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x42 h14 y43f ff8 fs3 fc0 sc0 ls0 ws676">enumeration. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, that made the </div><div class="t m5 x25 h2f y43f ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _17"> </span>[Simmons04], p. 73.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf134" class="pf w1 h2" data-page-no="134"><div class="pc pc134 w1 h2"><img class="bi xd y1315 wc h5a" alt="" src="bg134.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">277<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws223">enumeration pretty large. Because the concept of </div><div class="t m5 x34 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x96 h14 y194 ff8 fs3 fc0 sc0 ls0 ws223">does not depend on </div><div class="t m5 x60 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x99 h14 y194 ff8 fs3 fc0 sc0 ls0 ws223">, I mo<span class="_ _4"></span>ved</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">the</div><div class="t m5 x19 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 x52 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> enumeration outside of the </div><div class="t m5 x76 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xb8 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> class into its o<span class="_ _4"></span>wn source ﬁle [G13].</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws6ff">I also mo<span class="_ _4"></span>ved the ne<span class="_ _4"></span>xt function, </div><div class="t m5 x31 h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">weekdayCodeToString</div><div class="t m0 xc9 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws6ff">(lines 272–286) into the </div><div class="t m5 x25 h2f y1fa ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">enumeration and called it </div><div class="t m5 x7d h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">toString</div><div class="t m0 xc h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1d7 ff8 fs3 fc0 sc0 ls16 ws2ad">There are tw<span class="_ _4"></span>o </div><div class="t m5 xba h2f y1d7 ffb fs10 fc0 sc0 ls31 ws0">getMonths</div><div class="t m0 x8f h14 y1d7 ff8 fs3 fc0 sc0 ls16 ws2ad">functions (lines 288–316). <span class="_ _1"></span>The ﬁrst calls the second. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y1d8 ff8 fs3 fc0 sc0 ls32 ws7e">second is ne<span class="_ _4"></span>ver called by an<span class="_ _4"></span>yone but the ﬁrst. <span class="_ _1"></span>Therefore, I collapsed the tw<span class="_ _4"></span>o into one and</div><div class="t m0 xd h14 y1d9 ff8 fs3 fc0 sc0 ls4d ws360">v<span class="_ _4"></span>astly simpliﬁed them [G9],[G12],[F4]. F<span class="_ _4"></span>inally<span class="_ _0"></span>, I changed the name to be a bit more self-</div><div class="t m0 xd h14 y1316 ff8 fs3 fc0 sc0 ls68 ws0">descripti<span class="_ _4"></span>ve [N1]. </div><div class="t m5 x74 h2f y55a ffb fs10 fc0 sc0 ls0 ws0">public enum Day {</div><div class="t m5 x74 h2f y55b ffb fs10 fc0 sc0 ls0 ws0">  MONDAY(Calendar.MONDAY),</div><div class="t m5 x74 h2f y55c ffb fs10 fc0 sc0 ls0 ws0">  TUESDAY(Calendar.TUESDAY),</div><div class="t m5 x74 h2f y55d ffb fs10 fc0 sc0 ls0 ws0">  WEDNESDAY(Calendar.WEDNESDAY),s</div><div class="t m5 x74 h2f y55e ffb fs10 fc0 sc0 ls0 ws0">  THURSDAY(Calendar.THURSDAY),</div><div class="t m5 x74 h2f y55f ffb fs10 fc0 sc0 ls0 ws0">  FRIDAY(Calendar.FRIDAY),</div><div class="t m5 x74 h2f y58f ffb fs10 fc0 sc0 ls0 ws0">  SATURDAY(Calendar.SATURDAY),</div><div class="t m5 x74 h2f y590 ffb fs10 fc0 sc0 ls0 ws0">  SUNDAY(Calendar.SUNDAY);</div><div class="t m5 x74 h2f y592 ffb fs10 fc0 sc0 ls0 ws0">  public final int index;</div><div class="t m5 x74 h2f y593 ffb fs10 fc0 sc0 ls0 ws0">  private static DateFormatSymbols dateSymbols = new DateFormatSymbols();</div><div class="t m5 x74 h2f y595 ffb fs10 fc0 sc0 ls0 ws0">  Day(int day) {</div><div class="t m5 x74 h2f yc09 ffb fs10 fc0 sc0 ls0 ws0">    index = day;</div><div class="t m5 x74 h2f yc0a ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yc0c ffb fs10 fc0 sc0 ls0 ws0">  public static Day make(int index) throws IllegalArgumentException {</div><div class="t m5 x74 h2f ycdd ffb fs10 fc0 sc0 ls0 ws0">    for (Day d : Day.values())</div><div class="t m5 x74 h2f yc0d ffb fs10 fc0 sc0 ls0 ws0">      if (d.index == index)</div><div class="t m5 x74 h2f yc0e ffb fs10 fc0 sc0 ls0 ws0">        return d;</div><div class="t m5 x74 h2f yc0f ffb fs10 fc0 sc0 ls0 ws0">    throw new IllegalArgumentException(</div><div class="t m5 x74 h2f yc10 ffb fs10 fc0 sc0 ls0 ws0">      String.format(&quot;Illegal day index: %d.&quot;, index));</div><div class="t m5 x74 h2f yc11 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f ycdf ffb fs10 fc0 sc0 ls0 ws0">  public static Day parse(String s) throws IllegalArgumentException {</div><div class="t m5 x74 h2f yce0 ffb fs10 fc0 sc0 ls0 ws0">    String[] shortWeekdayNames =</div><div class="t m5 x74 h2f y128c ffb fs10 fc0 sc0 ls0 ws0">      dateSymbols.getShortWeekdays();</div><div class="t m5 x74 h2f yce1 ffb fs10 fc0 sc0 ls0 ws0">    String[] weekDayNames =</div><div class="t m5 x74 h2f yce2 ffb fs10 fc0 sc0 ls0 ws0">      dateSymbols.getWeekdays();</div><div class="t m5 x74 h2f yce4 ffb fs10 fc0 sc0 ls0 ws0">    s = s.trim();</div><div class="t m5 x74 h2f yce5 ffb fs10 fc0 sc0 ls0 ws0">    for (Day day : Day.values()) {</div><div class="t m5 x74 h2f y1317 ffb fs10 fc0 sc0 ls0 ws0">      if (s.equalsIgnoreCase(shortWeekdayNames[day.index]) ||</div><div class="t m5 x74 h2f yce6 ffb fs10 fc0 sc0 ls0 ws0">          s.equalsIgnoreCase(weekDayNames[day.index])) {</div><div class="t m5 x74 h2f yce7 ffb fs10 fc0 sc0 ls0 ws0">        return day;</div><div class="t m5 x74 h2f yce8 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f yce9 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ycea ffb fs10 fc0 sc0 ls0 ws0">    throw new IllegalArgumentException(</div><div class="t m5 x74 h2f y1318 ffb fs10 fc0 sc0 ls0 ws0">      String.format(&quot;%s is not a valid weekday string&quot;, s));</div><div class="t m5 x74 h2f yceb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yced ffb fs10 fc0 sc0 ls0 ws0">  public String toString() {</div><div class="t m5 x74 h2f ycee ffb fs10 fc0 sc0 ls0 ws0">    return dateSymbols.getWeekdays()[index];</div><div class="t m5 x74 h2f ycef ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1319 ffb fs10 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf135" class="pf w1 h2" data-page-no="135"><div class="pc pc135 w1 h2"><img class="bi xd y3cd wc h75" alt="" src="bg135.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">278<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h1d y131a ffd fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 xdc h2f y131a ffb fs10 fc0 sc0 ls0 ws0">isValidMonthCode</div><div class="t m0 x2f h1d y131a ffd fs3 fc0 sc0 ls0 ws700">function (lines 326–346) was made irrele<span class="_ _4"></span>vant by the </div><div class="t m5 xd8 h2f y131a ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 xd h14 y131b ffd fs3 fc0 sc0 ls0 ws0">enum, so I deleted it <span class="ff8">[G9]</span>.</div><div class="t m0 x74 h1d yde4 ffd fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 xdc h2f yde4 ffb fs10 fc0 sc0 ls0 ws0">monthCodeToQuarter</div><div class="t m0 xcc h1d yde4 ffd fs3 fc0 sc0 ls0 ws24b">function (lines 356–375) smells of F<span class="fsb ws0">EATURE<span class="fs3 ls7d"> E<span class="_ _2"></span><span class="fsb ls0">NVY</span></span></span></div><div class="t m0 x64 h99 y1233 ffd fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 x36 h1d yde4 ffd fs3 fc0 sc0 ls0 ws0">[G14]</div><div class="t m0 xd h1d y131c ffd fs3 fc0 sc0 ls0 ws0">and probably belongs in the </div><div class="t m5 x9b h2f y131c ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x8 h1d y131c ffd fs3 fc0 sc0 ls0 ws0"> enum as a method named </div><div class="t m5 xc9 h2f y131c ffb fs10 fc0 sc0 ls0 ws0">quarter</div><div class="t m0 x79 h1d y131c ffd fs3 fc0 sc0 ls0 ws0">. So I replaced it. </div><div class="t m0 x74 h14 y254 ff8 fs3 fc0 sc0 ls0 ws613">This made the </div><div class="t m5 xd6 h2f y254 ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x7 h14 y254 ff8 fs3 fc0 sc0 ls0 ws613">enum big enough to be in its o<span class="_ _4"></span>wn class. So I mo<span class="_ _4"></span>ved it out of</div><div class="t m5 xd h2f y255 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x95 h14 y255 ff8 fs3 fc0 sc0 ls0 ws0"> to be consistent with the </div><div class="t m5 xdf h2f y255 ffb fs10 fc0 sc0 ls0 ws0">Day</div><div class="t m0 xd1 h14 y255 ff8 fs3 fc0 sc0 ls0 ws0"> enum <span class="ffd">[G11]</span>,<span class="ffd">[G13]</span>.</div><div class="t m0 x74 h14 y256 ff8 fs3 fc0 sc0 ls0 ws5b7">The next tw<span class="_ _1"></span>o methods are named </div><div class="t m5 xe9 h2f y256 ffb fs10 fc0 sc0 ls0 ws0">monthCodeToString</div><div class="t m0 xae h14 y256 ff8 fs3 fc0 sc0 ls22 ws411">(lines 377–426). <span class="_ _1"></span>Again, we see</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws44d">the pattern of one method calling its twin with a ﬂag. It is usually a bad idea to pass a ﬂag</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws40f">as an argument to a function, especiall<span class="_ _4"></span>y when that ﬂag simpl<span class="_ _4"></span>y selects the format of the out-</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws0">put <span class="ffd">[G15]</span><span class="ws479">. I renamed<span class="_ _0"></span>, simpliﬁed<span class="_ _4"></span>, and restr<span class="_ _8"></span>uctured these functions and mo<span class="_ _4"></span>ved them into the</span></div><div class="t m5 xd h2f y29d ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x7c h14 y29d ff8 fs3 fc0 sc0 ls0 ws0"> enum [N1],[N3],[C3],<span class="ffd">[G14]</span>.</div><div class="t m0 x74 h14 yf21 ff8 fs3 fc0 sc0 ls0 ws701">The next method is </div><div class="t m5 x6e h2f y54f ffb fs10 fc0 sc0 ls0 ws0">stringToMonthCode</div><div class="t m0 xc4 h14 y54f ff8 fs3 fc0 sc0 ls0 ws701">(lines 428–472). I renamed it, mo<span class="_ _4"></span>ved it into the</div><div class="t m5 xd h2f y550 ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x7c h14 y550 ff8 fs3 fc0 sc0 ls0 ws0"> enum, and simpliﬁed it [N1],[N3],[C3],<span class="ffd">[G14]</span>,<span class="ffd">[G12]</span>.</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls14 ws253">  public static String[] getMonthNames() {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    return dateFormatSymbols.getMonths();</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _17"> </span>[Refactoring].</div><div class="t m5 x74 h2f yeca ffb fs10 fc0 sc0 ls19 ws236">    public int quarter() {</div><div class="t m5 x74 h2f y131d ffb fs10 fc0 sc0 ls0 ws0">      return 1 + (index-1)/3;</div><div class="t m5 x74 h2f y131e ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y131f ffb fs10 fc0 sc0 ls14 ws235">  public String toString() {</div><div class="t m5 x74 h2f y1320 ffb fs10 fc0 sc0 ls0 ws0">    return dateFormatSymbols.getMonths()[index - 1];</div><div class="t m5 x74 h2f y1321 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1322 ffb fs10 fc0 sc0 ls0 ws0">  public String toShortString() {</div><div class="t m5 x74 h2f y1323 ffb fs10 fc0 sc0 ls0 ws0">    return dateFormatSymbols.getShortMonths()[index - 1];</div><div class="t m5 x74 h2f y1324 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1325 ffb fs10 fc0 sc0 ls14 ws253">  public static Month parse(String s) {</div><div class="t m5 x74 h2f y1326 ffb fs10 fc0 sc0 ls0 ws0">    s = s.trim();</div><div class="t m5 x74 h2f y1327 ffb fs10 fc0 sc0 ls0 ws0">    for (Month m : Month.values())</div><div class="t m5 x74 h2f y1328 ffb fs10 fc0 sc0 ls0 ws0">      if (m.matches(s))</div><div class="t m5 x74 h2f y1329 ffb fs10 fc0 sc0 ls0 ws0">        return m;</div><div class="t m5 x74 h2f y132a ffb fs10 fc0 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y132b ffb fs10 fc0 sc0 ls0 ws0">      return make(Integer.parseInt(s));</div><div class="t m5 x74 h2f y132c ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y132d ffb fs10 fc0 sc0 ls0 ws0">    catch (NumberFormatException e) {}</div><div class="t m5 x74 h2f y132e ffb fs10 fc0 sc0 ls0 ws0">    throw new IllegalArgumentException(&quot;Invalid month &quot; + s);</div><div class="t m5 x74 h2f y132f ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf136" class="pf w1 h2" data-page-no="136"><div class="pc pc136 w1 h2"><img class="bi xd y3cd wc h75" alt="" src="bg136.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">279<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">isLeapYear</div><div class="t m0 xba h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0"> method (lines 495–517) can be made a bit more expressi<span class="_ _4"></span>ve <span class="ffd">[G16]</span>.</div><div class="t m0 x74 h14 y10aa ff8 fs3 fc0 sc0 ls0 ws3fc">The next function, </div><div class="t m5 xa h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">leapYearCount</div><div class="t m0 xe9 h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws3fc">(lines 519–536) doesn’<span class="_ _1"></span>t really belong in </div><div class="t m5 x90 h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x56 h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">Nobody calls it except for tw<span class="_ _1"></span>o methods in </div><div class="t m5 x4b h2f y4dd ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 xae h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">. So I pushed it do<span class="_ _4"></span>wn [G6].</div><div class="t m0 x74 h14 y4de ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 xdc h2f y4de ffb fs10 fc0 sc0 ls0 ws0">lastDayOfMonth</div><div class="t m0 xb1 h14 y4de ff8 fs3 fc0 sc0 ls0 ws702">function (lines 538–560) makes use of the </div><div class="t m5 xc1 h2f y4de ffb fs10 fc0 sc0 ls0 ws0">LAST_DAY_OF_MONTH</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws323">ar<span class="_ _8"></span>ra<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>This ar<span class="_ _8"></span>ra<span class="_ _4"></span>y really belongs in the </div><div class="t m5 x9c h2f y4df ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 xc4 h14 y4df ff8 fs3 fc0 sc0 ls22 ws21"> enum [G17], so I mo<span class="_ _4"></span>ved it there. I also simpli-</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws0">ﬁed the function and made it a bit more expressi<span class="_ _4"></span>ve <span class="ffd">[G16]</span>.</div><div class="t m0 x74 h14 y63c ff8 fs3 fc0 sc0 ls0 wsf6">No<span class="_ _4"></span>w things start to get a bit more interesting. <span class="_ _4"></span>The next function is </div><div class="t m5 x6b h2f y63c ffb fs10 fc0 sc0 ls0 ws0">addDays</div><div class="t m0 x70 h14 y63c ff8 fs3 fc0 sc0 ls0 wsf6">(lines 562–</div><div class="t m0 xd h14 yacb ff8 fs3 fc0 sc0 ls0 ws63d">576). First of all, because this function operates on the v<span class="_ _4"></span>ariables of </div><div class="t m5 x58 h2f yacb ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xbb h14 yacb ff8 fs3 fc0 sc0 ls0 ws63d">, it should not</div><div class="t m0 xd h14 yacc ff8 fs3 fc0 sc0 ls0 ws703">be static [G18]. So I changed it to an instance method. Second<span class="_ _1"></span>, it calls the function</div><div class="t m5 xd h2f ybd7 ffb fs10 fc0 sc0 ls0 ws0">toSerial</div><div class="t m0 x9a h14 ybd7 ff8 fs3 fc0 sc0 ls0 ws6bd">. <span class="_ _1"></span>This function should be renamed </div><div class="t m5 x78 h2f ybd7 ffb fs10 fc0 sc0 ls0 ws0">toOrdinal</div><div class="t m0 xe3 h14 ybd7 ff8 fs3 fc0 sc0 ls0 ws6bd">[N1]. Finall<span class="_ _4"></span>y<span class="_ _0"></span>, the method can be</div><div class="t m0 xd h14 ybd8 ff8 fs3 fc0 sc0 ls0 ws0">simpliﬁed.</div><div class="t m0 x74 h14 y9fc ff8 fs3 fc0 sc0 ls0 ws38c">The same goes for </div><div class="t m5 x2e h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">addMonths</div><div class="t m0 x81 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws38c">(lines 578–602). It should be an instance method [G18].</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws640">The algorithm is a bit complicated<span class="_ _1"></span>, so I used E<span class="fsb ws0">XPLAINING<span class="fs3 ls7e"> T</span>EMPORARY<span class="fs3 ls7e"> V<span class="_ _8"></span></span>ARIABLES</span></div><div class="t m0 x71 h21 yd97 ff8 fsc fc0 sc0 ls0 ws0">8</div><div class="t m0 x36 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">[G19]</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">to make it more transparent. I also renamed the method </div><div class="t m5 xe3 h2f y400 ffb fs10 fc0 sc0 ls0 ws0">getYYY</div><div class="t m0 xca h14 y400 ff8 fs3 fc0 sc0 ls0 ws0"> to </div><div class="t m5 x49 h2f y400 ffb fs10 fc0 sc0 ls0 ws0">getYear</div><div class="t m0 x4a h14 y400 ff8 fs3 fc0 sc0 ls0 ws0"> [N1].</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">  private boolean matches(String s) {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    return s.equalsIgnoreCase(toString()) ||</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">           s.equalsIgnoreCase(toShortString());</div><div class="t m5 x74 h2f y12db ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1330 ffb fs10 fc0 sc0 ls14 ws253">  public static boolean isLeapYear(int year) {</div><div class="t m5 x74 h2f y1331 ffb fs10 fc0 sc0 ls0 ws0">    boolean fourth = year % 4 == 0;</div><div class="t m5 x74 h2f y1332 ffb fs10 fc0 sc0 ls0 ws0">    boolean hundredth = year % 100 == 0;</div><div class="t m5 x74 h2f y1333 ffb fs10 fc0 sc0 ls0 ws0">    boolean fourHundredth = year % 400 == 0;</div><div class="t m5 x74 h2f y1334 ffb fs10 fc0 sc0 ls0 ws0">    return fourth &amp;&amp; (!hundredth || fourHundredth);</div><div class="t m5 x74 h2f y1335 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1336 ffb fs10 fc0 sc0 ls14 ws260">  public static int lastDayOfMonth(Month month, int year) {</div><div class="t m5 x74 h2f y1337 ffb fs10 fc0 sc0 ls0 ws0">    if (month == Month.FEBRUARY &amp;&amp; isLeapYear(year))</div><div class="t m5 x74 h2f y1338 ffb fs10 fc0 sc0 ls0 ws0">      return month.lastDay() + 1;</div><div class="t m5 x74 h2f y1339 ffb fs10 fc0 sc0 ls0 ws0">     else</div><div class="t m5 x74 h2f y133a ffb fs10 fc0 sc0 ls0 ws0">      return month.lastDay();</div><div class="t m5 x74 h2f y133b ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y133c ffb fs10 fc0 sc0 ls14 ws253">  public DayDate addDays(int days) {</div><div class="t m5 x74 h2f y133d ffb fs10 fc0 sc0 ls0 ws0">    return DayDateFactory.makeDate(toOrdinal() + days);</div><div class="t m5 x74 h2f y133e ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _17"> </span>[Beck97].</div><div class="t m5 x74 h2f yedb ffb fs10 fc0 sc0 ls14 ws253">  public DayDate addMonths(int months) {</div><div class="t m5 x9a h2f yedc ffb fs10 fc0 sc0 ls7f ws0">int thisMonthAsOrdinal = 12 * getYear() + getMonth().index - 1;</div><div class="t m5 x74 h2f yedd ffb fs10 fc0 sc0 ls0 ws0">    int resultMonthAsOrdinal = thisMonthAsOrdinal + months;</div><div class="t m5 x74 h2f yede ffb fs10 fc0 sc0 ls0 ws0">    int resultYear = resultMonthAsOrdinal / 12;</div><div class="t m5 x9a h2f y133f ffb fs10 fc0 sc0 ls80 ws0">Month resultMonth = Month.make(resultMonthAsOrdinal % 12 + 1);</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf137" class="pf w1 h2" data-page-no="137"><div class="pc pc137 w1 h2"><img class="bi xd yca9 wc h8f" alt="" src="bg137.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">280<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y273 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y273 ffb fs10 fc0 sc0 ls0 ws0">addYears</div><div class="t m0 x6 h14 y273 ff8 fs3 fc0 sc0 ls0 ws0"> function (lines 604–626) pro<span class="_ _4"></span>vides no sur<span class="_ _8"></span>prises o<span class="_ _4"></span>ver the others.</div><div class="t m0 x74 h14 y2ac ff8 fs3 fc0 sc0 ls12 ws704">There is a little itch at the back of m<span class="_ _4"></span>y mind that is bothering me about changing</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls12 ws705">these methods from static to instance. Does the expression </div><div class="t m5 x51 h2f y2ad ffb fs10 fc0 sc0 ls5d ws0">date.addDays(5)</div><div class="t m0 xfa h14 y2ad ff8 fs3 fc0 sc0 ls12 ws705">make it</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls12 ws299">clear that the </div><div class="t m5 x91 h2f y72f ffb fs10 fc0 sc0 ls5d ws0">date</div><div class="t m0 x18 h14 y72f ff8 fs3 fc0 sc0 ls12 ws299">object does not change and that a ne<span class="_ _4"></span>w instance of </div><div class="t m5 x97 h2f y72f ffb fs10 fc0 sc0 ls5d ws0">DayDate</div><div class="t m0 x63 h14 y72f ff8 fs3 fc0 sc0 ls12 ws299">is returned?</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls12 ws324">Or does it er<span class="_ _8"></span>roneously impl<span class="_ _4"></span>y that w<span class="_ _4"></span>e are adding ﬁve da<span class="_ _4"></span>ys to the </div><div class="t m5 xb9 h2f y730 ffb fs10 fc0 sc0 ls5d ws0">date</div><div class="t m0 x8b h14 y730 ff8 fs3 fc0 sc0 ls12 ws706">object? Y<span class="_ _3"></span>ou <span class="_ _6"></span>might</div><div class="t m0 xd h14 ya2a ff8 fs3 fc0 sc0 ls12 ws8a">not think that is a big problem, but a bit of code that looks lik<span class="_ _4"></span>e the follo<span class="_ _4"></span>wing can be very</div><div class="t m0 xd h14 y28 ff8 fs3 fc0 sc0 ls12 ws0">deceiving [G20].</div><div class="t m5 x74 h2f y1340 ffb fs10 fc0 sc0 ls0 ws0">DayDate date = DateFactory.makeDate(5, Month.DECEMBER, 1952);</div><div class="t m5 x74 h2f y1341 ffb fs10 fc0 sc0 ls0 ws0">date.addDays(7); // bump date by one week.</div><div class="t m0 x74 h14 y6e7 ff8 fs3 fc0 sc0 ls0 ws4b2">Someone reading this code w<span class="_ _4"></span>ould very likel<span class="_ _4"></span>y just accept that </div><div class="t m5 xb9 h2f y6e7 ffb fs10 fc0 sc0 ls0 ws0">addDays</div><div class="t m0 xa9 h14 y6e7 ff8 fs3 fc0 sc0 ls0 ws4b2">is changing the</div><div class="t m5 xd h2f y32f ffb fs10 fc0 sc0 ls0 ws0">date</div><div class="t m0 x8e h14 y32f ff8 fs3 fc0 sc0 ls0 ws1ff">object. So w<span class="_ _4"></span>e need a name that breaks this ambiguity [N4]. So I changed the names to</div><div class="t m5 xd h2f y330 ffb fs10 fc0 sc0 ls0 ws0">plusDays</div><div class="t m0 x9a h14 y330 ff8 fs3 fc0 sc0 ls81 ws133"> and </div><div class="t m5 x6d h2f y330 ffb fs10 fc0 sc0 ls0 ws0">plusMonths</div><div class="t m0 x6e h14 y330 ff8 fs3 fc0 sc0 ls0 ws56">. It seems to me that the intent of the method is captured nicely b<span class="_ _1"></span>y</div><div class="t m5 x74 h2f y1342 ffb fs10 fc0 sc0 ls0 ws0">DayDate date = oldDate.plusDays(5);</div><div class="t m0 xd h14 ybd6 ff8 fs3 fc0 sc0 ls0 ws630">whereas the follo<span class="_ _1"></span>wing doesn’<span class="_ _4"></span>t read ﬂuidly enough for a reader to simpl<span class="_ _4"></span>y accept that the</div><div class="t m5 xd h2f y3a9 ffb fs10 fc0 sc0 ls0 ws0">date</div><div class="t m0 x74 h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws0"> object is changed:</div><div class="t m5 x74 h2f y1343 ffb fs10 fc0 sc0 ls0 ws0">date.plusDays(5);</div><div class="t m0 x74 h14 y670 ff8 fs3 fc0 sc0 ls0 ws707">The algorithms continue to get more interesting. </div><div class="t m5 xe3 h2f y670 ffb fs10 fc0 sc0 ls0 ws0">getPreviousDayOfWeek</div><div class="t m0 x98 h14 y670 ff8 fs3 fc0 sc0 ls0 ws707">(lines 628–</div><div class="t m0 xd h14 y671 ff8 fs3 fc0 sc0 lsd ws124">660) w<span class="_ _4"></span>orks but is a bit complicated. <span class="_ _1"></span>After some thought about what was reall<span class="_ _4"></span>y going on</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls82 ws708">[G21], I w<span class="_ _4"></span><span class="ls0 ws3be">as able to simplify it and use E<span class="fsb ws0">XPLAINING<span class="fs3 ls83"> T<span class="_ _0"></span><span class="fsb ls0">EMPORARY<span class="fs3 ls83"> V<span class="_ _0"></span><span class="fsb ls0">ARIABLES<span class="_ _16"> </span><span class="fs3 ws3be">[G19] to</span></span></span></span></span></span></span></div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls0 ws6c0">make it clearer<span class="_ _1"></span>. I also changed it from a static method to an instance method [G18], and</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls0 ws0">got rid of the duplicate instance method [G5] (lines 997–1008).</div><div class="t m0 x74 h14 ye03 ff8 fs3 fc0 sc0 ls10 ws6b">The exact same anal<span class="_ _4"></span>ysis and result occur<span class="_ _8"></span>red for </div><div class="t m5 x54 h2f y555 ffb fs10 fc0 sc0 ls45 ws0">getFollowingDayOfWeek</div><div class="t m0 x45 h14 y555 ff8 fs3 fc0 sc0 ls10 ws6b">(lines 662–693).</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">    int lastDayOfResultMonth = lastDayOfMonth(resultMonth, resultYear);</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    int resultDay = Math.min(getDayOfMonth(), lastDayOfResultMonth);</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">    return DayDateFactory.makeDate(resultDay, resultMonth, resultYear);</div><div class="t m5 x74 h2f y12db ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1344 ffb fs10 fc0 sc0 ls14 ws253">  public DayDate plusYears(int years) {</div><div class="t m5 x74 h2f y1345 ffb fs10 fc0 sc0 ls0 ws0">    int resultYear = getYear() + years;</div><div class="t m5 x74 h2f y1346 ffb fs10 fc0 sc0 ls0 ws0">    int lastDayOfMonthInResultYear = lastDayOfMonth(getMonth(), resultYear);</div><div class="t m5 x74 h2f y1347 ffb fs10 fc0 sc0 ls0 ws0">    int resultDay = Math.min(getDayOfMonth(), lastDayOfMonthInResultYear);</div><div class="t m5 x74 h2f y1348 ffb fs10 fc0 sc0 ls0 ws0">    return DayDateFactory.makeDate(resultDay, getMonth(), resultYear);</div><div class="t m5 x74 h2f y1349 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y134a ffb fs10 fc0 sc0 ls0 ws235">  public DayDate getPreviousDayOfWeek(Day targetDayOfWeek) {</div><div class="t m5 x74 h2f y134b ffb fs10 fc0 sc0 ls0 ws0">    int offsetToTarget = targetDayOfWeek.index - getDayOfWeek().index;</div><div class="t m5 x74 h2f y134c ffb fs10 fc0 sc0 ls0 ws0">    if (offsetToTarget &gt;= 0)</div><div class="t m5 x74 h2f y134d ffb fs10 fc0 sc0 ls0 ws0">      offsetToTarget -= 7;</div><div class="t m5 x74 h2f y134e ffb fs10 fc0 sc0 ls0 ws0">    return plusDays(offsetToTarget);</div><div class="t m5 x74 h2f y134f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1350 ffb fs10 fc0 sc0 ls0 ws0">public DayDate getFollowingDayOfWeek(Day targetDayOfWeek) {</div><div class="t m5 x74 h2f y1351 ffb fs10 fc0 sc0 ls0 ws0">    int offsetToTarget = targetDayOfWeek.index - getDayOfWeek().index;</div><div class="t m5 x74 h2f y1352 ffb fs10 fc0 sc0 ls0 ws0">    if (offsetToTarget &lt;= 0)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf138" class="pf w1 h2" data-page-no="138"><div class="pc pc138 w1 h2"><img class="bi xd y1353 wc hb3" alt="" src="bg138.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">281<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 x74 h14 y1354 ff8 fs3 fc0 sc0 ls0 ws709">The next function is </div><div class="t m5 x7d h2f y1355 ffb fs10 fc0 sc0 ls0 ws0">getNearestDayOfWeek</div><div class="t m0 x23 h14 y1355 ff8 fs3 fc0 sc0 ls0 ws709">(lines 695–726), which w<span class="_ _1"></span>e cor<span class="_ _8"></span>rected back</div><div class="t m0 xd h14 yebd ff8 fs3 fc0 sc0 ls0 ws82">on page 270. But the changes I made back then aren’<span class="_ _4"></span>t consistent with the cur<span class="_ _8"></span>rent patter<span class="_ _8"></span>n in</div><div class="t m0 xd h14 y460 ff8 fs3 fc0 sc0 ls0 ws90">the last tw<span class="_ _4"></span>o functions [G11]. So I made it consistent and used some E<span class="fsb ws0">XPLAINING<span class="fs3 ls84"> T<span class="_ _4"></span><span class="fsb ls0">EMPO-</span></span></span></div><div class="t m0 xd h14 y461 ff8 fsb fc0 sc0 ls0 ws0">RARY<span class="fs3"> V</span>ARIABLES<span class="fs3 ls85 ws70a"> [G19] </span><span class="fs3">to clarify the algorithm.</span></div><div class="t m0 x74 h14 y258 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y258 ffb fs10 fc0 sc0 ls0 ws0">getEndOfCurrentMonth</div><div class="t m0 x84 h14 y258 ff8 fs3 fc0 sc0 ls0 ws653">method (lines 728–740) is a little strange because it is an</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws39d">instance method that en<span class="_ _4"></span>vies [G14] its o<span class="_ _4"></span>wn class by taking a </div><div class="t m5 xc9 h2f y259 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x58 h14 y259 ff8 fs3 fc0 sc0 ls0 ws39d">argument. I made it a</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls0 ws0">true instance method and clariﬁed a few names.</div><div class="t m0 x74 h14 y261 ff8 fs3 fc0 sc0 ls0 ws0">Refactoring </div><div class="t m5 xbc h2f y808 ffb fs10 fc0 sc0 ls0 ws0">weekInMonthToString</div><div class="t m0 x31 h14 y808 ff8 fs3 fc0 sc0 ls0 ws3b4">(lines 742–761) turned out to be very interesting</div><div class="t m0 xd h14 yf5f ff8 fs3 fc0 sc0 ls0 ws6b">indeed. Using the refactoring tools of m<span class="_ _4"></span>y IDE, I ﬁrst mo<span class="_ _4"></span>ved the method to the </div><div class="t m5 x63 h2f yf5f ffb fs10 fc0 sc0 ls0 ws0">WeekInMonth</div><div class="t m0 xd h14 ycc6 ff8 fs3 fc0 sc0 ls0 ws70b">enum that I created back on page <span class="_ _0"></span>275. <span class="_ _1"></span>Then I renamed the method to </div><div class="t m5 xaf h2f ycc6 ffb fs10 fc0 sc0 ls0 ws0">toString</div><div class="t m0 xd9 h14 ycc6 ff8 fs3 fc0 sc0 ls0 ws70b">. Next, I</div><div class="t m0 xd h14 y58e ff8 fs3 fc0 sc0 ls0 ws2c6">changed it from a static method to an instance method. <span class="_ _1"></span>All the tests still passed. (Can you</div><div class="t m0 xd h14 y1356 ff8 fs3 fc0 sc0 ls0 ws0">guess where I am going?) </div><div class="t m0 x74 h14 yd96 ff8 fs3 fc0 sc0 ls0 ws233">Next, I deleted the method entirel<span class="_ _4"></span>y! Fi<span class="_ _4"></span>ve asserts failed (lines 411–415, Listing <span class="_ _1"></span>B-4,</div><div class="t m0 xd h14 y1357 ff8 fs3 fc0 sc0 ls0 ws70c">page <span class="_ _3c"></span>374). I changed these lines to use the names of the enumerators (</div><div class="t m5 xa8 h2f y2ce ffb fs10 fc0 sc0 ls0 ws0">FIRST,</div><div class="t m5 xd h2f y1358 ffb fs10 fc0 sc0 ls0 ws0">SECOND,</div><div class="t m0 x9a h14 y3e3 ff8 fs3 fc0 sc0 ls0 ws70d">. <span class="_ _4"></span>. <span class="_ _4"></span>.). <span class="_ _1"></span>All the tests passed. Can you see w<span class="_ _4"></span>hy? Can y<span class="_ _4"></span>ou also see wh<span class="_ _4"></span>y each of these</div><div class="t m0 xd h14 y3e4 ff8 fs3 fc0 sc0 ls0 ws70e">steps was necessary? <span class="_ _1"></span>The ref<span class="_ _8"></span>actoring tool made sure that all previous callers of</div><div class="t m5 xd h2f yeda ffb fs10 fc0 sc0 ls0 ws0">weekInMonthToString</div><div class="t m0 x5 h14 yeda ff8 fs3 fc0 sc0 ls0 ws87">no<span class="_ _4"></span>w called </div><div class="t m5 x92 h2f yeda ffb fs10 fc0 sc0 ls0 ws0">toString</div><div class="t m0 xdd h14 yeda ff8 fs3 fc0 sc0 ls0 ws87">on the </div><div class="t m5 xd5 h2f yeda ffb fs10 fc0 sc0 ls0 ws0">weekInMonth</div><div class="t m0 xe8 h14 yeda ff8 fs3 fc0 sc0 ls0 ws87">enumerator because all enu-</div><div class="t m0 xd h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">merators implement </div><div class="t m5 xb h2f y5b6 ffb fs10 fc0 sc0 ls0 ws0">toString</div><div class="t m0 x5a h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0"> to simply return their names. . . .</div><div class="t m0 x74 h14 y3c9 ff8 fs3 fc0 sc0 lsc ws653">Unfortunately<span class="_ _0"></span>, I was a bit too cle<span class="_ _4"></span>ver<span class="_ _1"></span>. <span class="_ _4"></span>As elegant as that w<span class="_ _1"></span>onderful chain of ref<span class="_ _8"></span>actor-</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 ls0 ws47c">ings w<span class="_ _4"></span>as, I ﬁnally realized that the onl<span class="_ _4"></span>y users of this function were the tests I had just mod-</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws0">iﬁed<span class="_ _1"></span>, so I deleted the tests.</div><div class="t m0 x74 h14 y556 ff8 fs3 fc0 sc0 ls0 ws57b">F<span class="_ _1"></span>ool me once, shame on you. F<span class="_ _4"></span>ool me twice, shame on me! So after determining that</div><div class="t m0 xd h14 yb28 ff8 fs3 fc0 sc0 ls0 wsfc">nobody other than the tests called </div><div class="t m5 x76 h2f yb28 ffb fs10 fc0 sc0 ls0 ws0">relativeToString</div><div class="t m0 xb4 h14 yb28 ff8 fs3 fc0 sc0 ls0 wsfc">(lines 765–781), I simpl<span class="_ _4"></span>y deleted the</div><div class="t m0 xd h14 yb29 ff8 fs3 fc0 sc0 ls0 ws0">function and its tests. </div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">      offsetToTarget += 7;</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    return plusDays(offsetToTarget);</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1359 ffb fs10 fc0 sc0 ls0 ws0">public DayDate getNearestDayOfWeek(final Day targetDay) {</div><div class="t m5 x74 h2f y135a ffb fs10 fc0 sc0 ls0 ws0">    int offsetToThisWeeksTarget = targetDay.index - getDayOfWeek().index;</div><div class="t m5 x9a h2f y135b ffb fs10 fc0 sc0 ls41 ws0">int offsetToFutureTarget = (offsetToThisWeeksTarget + 7) % 7;</div><div class="t m5 x74 h2f y135c ffb fs10 fc0 sc0 ls0 ws0">    int offsetToPreviousTarget = offsetToFutureTarget - 7;</div><div class="t m5 x74 h2f y135d ffb fs10 fc0 sc0 ls0 ws0">    if (offsetToFutureTarget &gt; 3)</div><div class="t m5 x74 h2f y135e ffb fs10 fc0 sc0 ls0 ws0">      return plusDays(offsetToPreviousTarget);</div><div class="t m5 x74 h2f y135f ffb fs10 fc0 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y1360 ffb fs10 fc0 sc0 ls0 ws0">      return plusDays(offsetToFutureTarget);</div><div class="t m5 x74 h2f y1361 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1362 ffb fs10 fc0 sc0 ls0 ws0">public DayDate getEndOfMonth() {</div><div class="t m5 x74 h2f y1363 ffb fs10 fc0 sc0 ls0 ws0">    Month month = getMonth();</div><div class="t m5 x74 h2f y1364 ffb fs10 fc0 sc0 ls0 ws0">    int year = getYear();</div><div class="t m5 x74 h2f y1365 ffb fs10 fc0 sc0 ls0 ws0">    int lastDay = lastDayOfMonth(month, year);</div><div class="t m5 x74 h2f y1366 ffb fs10 fc0 sc0 ls0 ws0">    return DayDateFactory.makeDate(lastDay, month, year);</div><div class="t m5 x74 h2f y1367 ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf139" class="pf w1 h2" data-page-no="139"><div class="pc pc139 w1 h2"><img class="bi xd y12aa wc hb4" alt="" src="bg139.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">282<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws23f">W<span class="_ _0"></span>e ha<span class="_ _4"></span>ve ﬁnall<span class="_ _4"></span>y made it to the abstract methods of this abstract class. <span class="_ _4"></span>And the ﬁrst one</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws6c">is as appropriate as they come: </div><div class="t m5 x84 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">toSerial</div><div class="t m0 xe0 h14 y195 ff8 fs3 fc0 sc0 ls0 ws6c">(lines 838–844). Back on page 279 I had changed</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws356">the name to </div><div class="t m5 x1e h2f y196 ffb fs10 fc0 sc0 ls0 ws0">toOrdinal</div><div class="t m0 x4 h14 y196 ff8 fs3 fc0 sc0 ls0 ws356">. Ha<span class="_ _4"></span>ving looked at it in this context, I decided the name should be</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">changed to </div><div class="t m5 xb3 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">getOrdinalDay</div><div class="t m0 xf8 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws70f">The next abstract method is </div><div class="t m5 x77 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">toDate</div><div class="t m0 xaa h14 y1bd ff8 fs3 fc0 sc0 ls0 ws70f">(lines 838–844). It con<span class="_ _4"></span>verts a </div><div class="t m5 xa6 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xbf h14 y1bd ff8 fs3 fc0 sc0 ls0 ws70f">to a</div><div class="t m5 xd h2f y1be ffb fs10 fc0 sc0 ls0 ws0">java.util.Date</div><div class="t m0 xe h14 y1be ff8 fs3 fc0 sc0 ls0 ws710">. <span class="_ _4"></span>Why is this method abstract? If w<span class="_ _1"></span>e look at its implementation in</div><div class="t m5 xd h2f y19a ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x3a h14 y19a ff8 fs3 fc0 sc0 ls0 ws55c">(lines 198–207, Listing <span class="_ _4"></span>B-5, page <span class="_ _1"></span>382), we see that it doesn’<span class="_ _1"></span>t depend on</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">an<span class="_ _4"></span>ything in the implementation of that class [G6]. So I pushed it up.</div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x3f h2f y207 ffb fs10 fc0 sc0 ls0 ws0">getYYYY</div><div class="t m0 x3a h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xe4 h2f y207 ffb fs10 fc0 sc0 ls0 ws0">getMonth</div><div class="t m0 xa4 h14 y207 ff8 fs3 fc0 sc0 ls0 ws442">, and </div><div class="t m5 x92 h2f y207 ffb fs10 fc0 sc0 ls0 ws0">getDayOfMonth</div><div class="t m0 x68 h14 y207 ff8 fs3 fc0 sc0 ls0 ws442">methods are nicel<span class="_ _4"></span>y abstract. How<span class="_ _1"></span>ever<span class="_ _1"></span>, the</div><div class="t m5 xd h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">getDayOfWeek</div><div class="t m0 x14 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws711">method is another one that should be pulled up from </div><div class="t m5 xa7 h2f y1fc ffb fs10 fc0 sc0 ls0 ws0">SpreadSheetDate</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws0">because it doesn’<span class="_ _1"></span>t depend on anything that can’<span class="_ _1"></span>t be found in </div><div class="t m5 x6a h2f y208 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xeb h14 y208 ff8 fs3 fc0 sc0 ls0 ws0">[G6]. Or does it?</div><div class="t m0 x74 h14 y209 ff8 fs3 fc0 sc0 ls0 ws128">If you look carefull<span class="_ _4"></span>y (line 247, Listing <span class="_ _1"></span>B-5, page <span class="_ _0"></span>382), you’<span class="_ _4"></span>ll see that the algorithm</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws632">implicitly depends on the origin of the ordinal da<span class="_ _1"></span>y (in other w<span class="_ _4"></span>ords, the day of the w<span class="_ _1"></span>eek of</div><div class="t m0 xd h14 y20b ff8 fs3 fc0 sc0 ls0 ws2df">da<span class="_ _4"></span>y 0). So ev<span class="_ _4"></span>en though this function has no physical dependencies that couldn’<span class="_ _1"></span>t be mo<span class="_ _4"></span>ved</div><div class="t m0 xd h14 y20c ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xcd h2f yd25 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xcb h14 yd25 ff8 fs3 fc0 sc0 ls0 ws0">, it does ha<span class="_ _4"></span>ve a lo<span class="_ _4"></span>gical dependency<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y1368 ff8 fs3 fc0 sc0 ls12 ws3f7">Logical dependencies lik<span class="_ _4"></span>e this bother me [G22]. If something logical depends on</div><div class="t m0 xd h14 y1369 ff8 fs3 fc0 sc0 ls12 ws43c">the implementation, then something ph<span class="_ _4"></span>ysical should too. <span class="_ _4"></span>Also, it seems to me that the</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls12 ws712">algorithm itself could be generic with a much smaller portion of it dependent on the</div><div class="t m0 xd h14 yd28 ff8 fs3 fc0 sc0 ls12 ws0">implementation <span class="ls0">[G6].</span></div><div class="t m0 x74 h14 y3f4 ff8 fs3 fc0 sc0 ls0 ws713">So I created an abstract method in </div><div class="t m5 x22 h2f y3f4 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xde h14 y3f4 ff8 fs3 fc0 sc0 ls0 ws0">named</div><div class="t m5 x89 h2f y3f4 ffb fs10 fc0 sc0 ls0 ws0">getDayOfWeekForOrdinal<span class="_ _4"></span>Zero</div><div class="t m0 x8c h14 y3f4 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m0 xd h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws714">implemented it in </div><div class="t m5 xe4 h2f y3f5 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x20 h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws714">to return </div><div class="t m5 x67 h2f y3f5 ffb fs10 fc0 sc0 ls0 ws0">Day.SATURDAY</div><div class="t m0 xdb h14 y3f5 ff8 fs3 fc0 sc0 ls0 ws714">. <span class="_ _1"></span>Then I mov<span class="_ _4"></span>ed the </div><div class="t m5 xa6 h2f y3f5 ffb fs10 fc0 sc0 ls0 ws0">getDayOfWeek</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws715">method up to </div><div class="t m5 x14 h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x4 h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws715">and changed it to call </div><div class="t m5 x1b h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">getOrdinalDay</div><div class="t m0 x6a h14 y3f6 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xa0 h2f y3f6 ffb fs10 fc0 sc0 ls0 ws0">getDayOfWeekForOrdinal-</div><div class="t m5 xd h2f y136a ffb fs10 fc0 sc0 ls0 ws0">Zero</div><div class="t m0 x74 h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 ycfb ff8 fs3 fc0 sc0 ls0 wsb9">As a side note, look carefull<span class="_ _4"></span>y at the comment on line 895 through line 899. W<span class="_ _0"></span>as this</div><div class="t m0 xd h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">repetition reall<span class="_ _4"></span>y necessar<span class="_ _8"></span>y? <span class="_ _4"></span>As usual, I deleted this comment along with all the others. </div><div class="t m0 x74 h14 ycfd ff8 fs3 fc0 sc0 ls0 ws125">The next method is </div><div class="t m5 xb1 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">compare</div><div class="t m0 x81 h14 y3fd ff8 fs3 fc0 sc0 lsc ws716">(lines 902–913). <span class="_ _1"></span>Again, this method is inappropriately</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws5d9">abstract [G6], so I pulled the implementation up into </div><div class="t m5 xe3 h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xab h14 y3fe ff8 fs3 fc0 sc0 ls0 ws5d9">. <span class="_ _1"></span>Also, the name does not</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws183">communicate enough [N1]. <span class="_ _1"></span>This method actually returns the difference in da<span class="_ _4"></span>ys since the</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws370">argument. So I changed the name to </div><div class="t m5 x9c h2f y400 ffb fs10 fc0 sc0 ls0 ws0">daysSince</div><div class="t m0 x68 h14 y400 ff8 fs3 fc0 sc0 ls0 ws370">. <span class="_ _1"></span>Also, I noted that there weren’<span class="_ _1"></span>t any tests</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">for this method<span class="_ _1"></span>, so I wrote them.</div><div class="t m0 x74 h14 y401 ff8 fs3 fc0 sc0 ls0 ws44">The next six functions (lines 915–980) are all abstract methods that should be imple-</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">mented in </div><div class="t m5 x5f h2f y402 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xe4 h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">. So I pulled them all up from </div><div class="t m5 xce h2f y402 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 x51 h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h1d y60d ffd fs3 fc0 sc0 ls0 ws717">The last function, </div><div class="t m5 x9e h2f y60d ffb fs10 fc0 sc0 ls0 ws0">isInRange</div><div class="t m0 x81 h1d y60d ffd fs3 fc0 sc0 ls0 ws717">(lines 9<span class="ff13 ws0">8</span>2–995) also needs to be pulled up and refac-</div><div class="t m0 xd h1d y60e ffd fs3 fc0 sc0 ls0 ws718">tored. The </div><div class="t m5 x46 h2f y60e ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xe4 h14 y60e ffd fs3 fc0 sc0 ls0 ws2b8">statement is a bit ugly <span class="ff8 ls12 ws0">[G23]<span class="_ _18"> </span></span>and can be replaced by moving the cases</div><div class="t m0 xd h1d y482 ffd fs3 fc0 sc0 ls0 ws0">into the </div><div class="t m5 x75 h2f y482 ffb fs10 fc0 sc0 ls0 ws0">DateInterval</div><div class="t m0 x5 h1d y482 ffd fs3 fc0 sc0 ls0 ws0"> enum. </div><div class="t m5 x74 h2f y136b ffb fs10 fc0 sc0 ls0 ws0">public Day getDayOfWeek() {</div><div class="t m5 x74 h2f y136c ffb fs10 fc0 sc0 ls0 ws0">    Day startingDay = getDayOfWeekForOrdinalZero();</div><div class="t m5 x74 h2f y136d ffb fs10 fc0 sc0 ls0 ws0">    int startingOffset = startingDay.index - Day.SUNDAY.index;</div><div class="t m5 x95 h2f y136e ffb fs10 fc0 sc0 ls86 ws1d0"> return Day.make((getOrdinalDay() + startingOffset) % 7 + 1);</div><div class="t m5 x74 h2f y136f ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13a" class="pf w1 h2" data-page-no="13a"><div class="pc pc13a w1 h2"><img class="bi xd y1370 wc hb5" alt="" src="bg13a.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">283<span class="_ _10"></span><span class="ff1">Then Make It Right</span></div><div class="t m0 x74 h14 y1c8 ff8 fs3 fc0 sc0 ls0 ws719">That brings us to the end of </div><div class="t m5 x1c h2f y96e ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x48 h14 y96e ff8 fs3 fc0 sc0 ls0 ws719">. So no<span class="_ _4"></span>w w<span class="_ _4"></span>e’<span class="_ _4"></span>ll make one more pass o<span class="_ _4"></span>ver the w<span class="_ _4"></span>hole</div><div class="t m0 xd h14 y952 ff8 fs3 fc0 sc0 ls0 ws0">class to see ho<span class="_ _4"></span>w w<span class="_ _4"></span>ell it ﬂo<span class="_ _4"></span>ws.</div><div class="t m0 x74 h14 y1099 ff8 fs3 fc0 sc0 ls0 ws0">First, the opening comment is long out of date, so I shortened and impro<span class="_ _4"></span>ved it [C2].</div><div class="t m0 x74 h14 y9f8 ff8 fs3 fc0 sc0 ls0 ws0">Next, I mo<span class="_ _1"></span>ved all the remaining enums out into their o<span class="_ _4"></span>wn ﬁles [G12].</div><div class="t m0 x74 h14 yf6f ff8 fs3 fc0 sc0 ls0 ws71a">Next, I mo<span class="_ _1"></span>ved the static v<span class="_ _4"></span>ariable (</div><div class="t m5 xc4 h2f yf6f ffb fs10 fc0 sc0 ls0 ws0">dateFormatSymbols</div><div class="t m0 xf7 h14 yf6f ff8 fs3 fc0 sc0 ls0 ws71a">) and three static methods</div><div class="t m0 xd h14 yf70 ff8 fs3 fc0 sc0 ls0 ws0">(</div><div class="t m5 x11 h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">getMonthNames</div><div class="t m0 x86 h1d yf70 ffa fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 xe5 h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">isLeapYear</div><div class="t m0 xa4 h1d yf70 ffa fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x57 h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">lastDayOfMonth</div><div class="t m0 xc4 h14 yf70 ff8 fs3 fc0 sc0 ls0 ws0">) into a ne<span class="_ _4"></span>w class named </div><div class="t m5 x58 h2f yf70 ffb fs10 fc0 sc0 ls0 ws0">DateUtil</div><div class="t m0 x63 h14 yf70 ff8 fs3 fc0 sc0 ls0 ws0">[G6].</div><div class="t m0 x74 h14 yf71 ff8 fs3 fc0 sc0 ls0 ws0">I mo<span class="_ _4"></span>ved the abstract methods up to the top w<span class="_ _4"></span>here they belong <span class="ls12">[G24].</span></div><div class="t m0 x74 h14 y1371 ff8 fs3 fc0 sc0 ls0 ws2a5">I changed </div><div class="t m5 xe h2f y1d0 ffb fs10 fc0 sc0 ls0 ws0">Month.make</div><div class="t m0 xb1 h14 y1d0 ff8 fs3 fc0 sc0 ls24 ws71b"> to </div><div class="t m5 x5d h2f y1d0 ffb fs10 fc0 sc0 ls0 ws0">Month.fromInt</div><div class="t m0 x9d h14 y1d0 ff8 fs3 fc0 sc0 ls0 ws2a5">[N1] and did the same for all the other enums.</div><div class="t m0 xd h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws0">I also created a </div><div class="t m5 x39 h2f y1d1 ffb fs10 fc0 sc0 ls0 ws0">toInt()</div><div class="t m0 x2e h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws0"> accessor for all the enums and made the </div><div class="t m5 x51 h2f y1d1 ffb fs10 fc0 sc0 ls0 ws0">index</div><div class="t m0 x97 h14 y1d1 ff8 fs3 fc0 sc0 ls0 ws0"> ﬁeld priv<span class="_ _1"></span>ate.</div><div class="t m0 x74 h14 y212 ff8 fs3 fc0 sc0 ls0 ws3a1">There was some interesting duplication [G5] in </div><div class="t m5 x2a h2f y212 ffb fs10 fc0 sc0 ls0 ws0">plusYears</div><div class="t m0 xf3 h14 y212 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x58 h2f y212 ffb fs10 fc0 sc0 ls0 ws0">plusMonths</div><div class="t m0 xd3 h14 y212 ff8 fs3 fc0 sc0 ls0 ws3a1">that I was</div><div class="t m0 xd h14 y213 ff8 fs3 fc0 sc0 ls0 ws6e0">able to eliminate b<span class="_ _4"></span>y extracting a ne<span class="_ _4"></span>w method named </div><div class="t m5 x27 h2f y213 ffb fs10 fc0 sc0 ls0 ws0">correctLastDayOfMonth</div><div class="t m0 xf4 h14 y213 ff8 fs3 fc0 sc0 ls0 ws6e0">, making the</div><div class="t m0 xd h14 y214 ff8 fs3 fc0 sc0 ls0 ws0">all three methods much clearer<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws71c">I got rid of the magic <span class="ls87 ws3c4">number 1 <span class="ls4b">[G25], </span></span>replacing it with </div><div class="t m5 x51 h2f y399 ffb fs10 fc0 sc0 ls0 ws0">Month.JANUARY.toInt()</div><div class="t m0 x1d h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 xd h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">Day.SUNDAY.toInt()</div><div class="t m0 x4d h14 y3ca ff8 fs3 fc0 sc0 ls0 ws38f">, as appropriate. I spent a little time with </div><div class="t m5 x6a h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDate</div><div class="t m0 xa6 h14 y3ca ff8 fs3 fc0 sc0 ls0 ws38f">, cleaning up</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws71d">the algorithms a bit. <span class="_ _1"></span>The end result is contained in Listing <span class="_ _3d"></span>B-7, page <span class="_ _3d"></span>394, through</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">Listing B-16, page 405.</div><div class="t m5 x74 h2f y7a ffb fs10 fc0 sc0 ls0 ws0">public enum DateInterval {</div><div class="t m5 x74 h2f y12d9 ffb fs10 fc0 sc0 ls0 ws0">    OPEN {</div><div class="t m5 x74 h2f y12da ffb fs10 fc0 sc0 ls0 ws0">      public boolean isIn(int d, int left, int right) {</div><div class="t m5 x74 h2f y12db ffb fs10 fc0 sc0 ls0 ws0">        return d &gt; left &amp;&amp; d &lt; right;</div><div class="t m5 x74 h2f y12dc ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y12dd ffb fs10 fc0 sc0 ls0 ws0">    },</div><div class="t m5 x74 h2f y12de ffb fs10 fc0 sc0 ls0 ws0">    CLOSED_LEFT {</div><div class="t m5 x74 h2f y12df ffb fs10 fc0 sc0 ls0 ws0">      public boolean isIn(int d, int left, int right) {</div><div class="t m5 x74 h2f y12e0 ffb fs10 fc0 sc0 ls0 ws0">        return d &gt;= left &amp;&amp; d &lt; right;</div><div class="t m5 x74 h2f y12f1 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y12f2 ffb fs10 fc0 sc0 ls0 ws0">    },</div><div class="t m5 x74 h2f y1372 ffb fs10 fc0 sc0 ls0 ws0">    CLOSED_RIGHT {</div><div class="t m5 x74 h2f y12f3 ffb fs10 fc0 sc0 ls0 ws0">      public boolean isIn(int d, int left, int right) {</div><div class="t m5 x74 h2f y12f4 ffb fs10 fc0 sc0 ls0 ws0">        return d &gt; left &amp;&amp; d &lt;= right;</div><div class="t m5 x74 h2f y12f5 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y1373 ffb fs10 fc0 sc0 ls0 ws0">    },</div><div class="t m5 x74 h2f y12f6 ffb fs10 fc0 sc0 ls0 ws0">    CLOSED {</div><div class="t m5 x74 h2f y12f7 ffb fs10 fc0 sc0 ls0 ws0">      public boolean isIn(int d, int left, int right) {</div><div class="t m5 x74 h2f y12f8 ffb fs10 fc0 sc0 ls0 ws0">        return d &gt;= left &amp;&amp; d &lt;= right;</div><div class="t m5 x74 h2f y12f9 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y1374 ffb fs10 fc0 sc0 ls0 ws0">    };</div><div class="t m5 x74 h2f y1375 ffb fs10 fc0 sc0 ls0 ws0">    public abstract boolean isIn(int d, int left, int right);</div><div class="t m5 x74 h2f y1376 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1377 ffb fs10 fc0 sc0 ls0 ws0">public boolean isInRange(DayDate d1, DayDate d2, DateInterval interval) {</div><div class="t m5 x95 h2f y1378 ffb fs10 fc0 sc0 ls86 ws1d0"> int left = Math.min(d1.getOrdinalDay(), d2.getOrdinalDay());</div><div class="t m5 x9a h2f y1379 ffb fs10 fc0 sc0 ls88 ws0">int right = Math.max(d1.getOrdinalDay(), d2.getOrdinalDay());</div><div class="t m5 x74 h2f y137a ffb fs10 fc0 sc0 ls0 ws0">    return interval.isIn(getOrdinalDay(), left, right);</div><div class="t m5 x74 h2f y137b ffb fs10 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13b" class="pf w1 h2" data-page-no="13b"><div class="pc pc13b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">284<span class="_ _3b"> </span><span class="ff1 wsf5">Chapter 16:<span class="_ _4"></span> Refactoring </span></div><div class="t m7 x63 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws451">Interestingl<span class="_ _4"></span>y the code co<span class="_ _4"></span>verage in </div><div class="t m5 xe9 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xcf h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">has<span class="_ _18"> </span><span class="ffa">decr<span class="_ _4"></span>eased<span class="_ _18"> </span><span class="ff8 ws451">to 84.9 percent! <span class="_ _4"></span>This is not</span></span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws71e">because less functionality is being tested; rather it is because the class has shrunk so much</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws678">that the fe<span class="_ _4"></span>w unco<span class="_ _4"></span>vered lines ha<span class="_ _4"></span>ve a greater weight. </div><div class="t m5 xea h2f y196 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 xc9 h14 y196 ff8 fs3 fc0 sc0 ls0 ws678">no<span class="_ _4"></span>w has 45 out of 53 ex<span class="_ _4"></span>ecut-</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls11 ws3ba">able statements co<span class="_ _1"></span>vered b<span class="_ _4"></span>y tests. <span class="_ _4"></span>The unco<span class="_ _4"></span>vered lines are so tri<span class="_ _4"></span>vial that they w<span class="_ _4"></span>eren’<span class="_ _4"></span>t w<span class="_ _4"></span>orth</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">testing.</div><div class="t m0 xd h17 y8dc ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 lsc ws35f">So once again w<span class="_ _4"></span>e’<span class="_ _4"></span>ve follo<span class="_ _1"></span>wed the Bo<span class="_ _1"></span>y Scout Rule. W<span class="_ _0"></span>e’<span class="_ _1"></span>ve checked the code in a bit cleaner</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 lsd ws71">than when w<span class="_ _1"></span>e checked it out. It took a little time, but it was w<span class="_ _1"></span>or<span class="_ _8"></span>th it. <span class="_ _4"></span>T<span class="_ _0"></span>est co<span class="_ _4"></span>verage w<span class="_ _4"></span>as</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 lsd ws66f">increased<span class="_ _1"></span>, some bugs were ﬁx<span class="_ _1"></span>ed<span class="_ _4"></span>, the code was clariﬁed and shrunk. <span class="_ _4"></span>The next person to</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws53a">look at this code will hopefull<span class="_ _4"></span>y ﬁnd it easier to deal with than we did. <span class="_ _1"></span>That person will also</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">probabl<span class="_ _4"></span>y be able to clean it up a bit more than w<span class="_ _1"></span>e did. </div><div class="t m0 xd h17 y137c ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 y137d ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa wse4">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e<span class="ff8">, Gamma et al.,</span></span></div><div class="t m0 xd h14 y40f ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><div class="t m0 xd h14 y411 ff1 fs3 fc0 sc0 ls0 wsa0">[Simmons04]:<span class="_ _4"></span>  <span class="ffa ws0">Hardcor<span class="_ _1"></span>e Java<span class="ff8">, Robert Simmons, Jr<span class="_ _1"></span>., O’Reilly<span class="_ _0"></span>, 2004.</span></span></div><div class="t m0 xd h14 y413 ff1 fs3 fc0 sc0 ls0 wsa0">[Refactoring]:<span class="_ _4"></span>  <span class="ffa ws32">Refactoring: Impr<span class="_ _4"></span>oving the Design of Existing Code<span class="ff8">, Martin F<span class="_ _1"></span>owler et al.,</span></span></div><div class="t m0 xd h14 y414 ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1999. </div><div class="t m0 xd h14 y42b ff1 fs3 fc0 sc0 ls0 wsa0">[Beck97]:<span class="_ _4"></span>  <span class="ffa ws0">Smalltalk Best Pr<span class="_ _4"></span>actice P<span class="_ _1"></span>atterns<span class="ff8">, Kent Beck, Prentice Hall, 1997.</span></span></div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:502.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:398.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13c" class="pf w1 h2" data-page-no="13c"><div class="pc pc13c w1 h2"><img class="bi xd y3cd w4 h75" alt="" src="bg13c.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">285</div><div class="t m0 x63 h23 y24c ff1 fsd fc0 sc0 ls0 ws0">17</div><div class="t m0 xc h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Smells and Heuristics</div><div class="t m0 xd h14 y137e ff8 fs3 fc0 sc0 ls0 ws71f">In his w<span class="_ _4"></span>onderful book <span class="ffa ws0">Refactoring<span class="ff8">,</span></span></div><div class="t m0 x32 h21 y137f ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x48 h14 y137e ff8 fs3 fc0 sc0 ls0 ws71f">Martin F<span class="_ _4"></span>o<span class="_ _4"></span>wler identiﬁed many dif<span class="_ _4"></span>ferent “Code</div><div class="t m0 xd h14 y1380 ff8 fs3 fc0 sc0 ls0 ws2fa">Smells.<span class="_ _1"></span>” <span class="_ _4"></span>The list that follo<span class="_ _4"></span>ws includes many of Martin’<span class="_ _2"></span>s smells and adds many more of m<span class="_ _1"></span>y</div><div class="t m0 xd h14 y1381 ff8 fs3 fc0 sc0 ls0 ws0">o<span class="_ _4"></span>wn. It also includes other pearls and heuristics that I use to practice m<span class="_ _4"></span>y trade.</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span>[Refactoring].</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:217.679000px;bottom:440.027010px;width:221.350000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13d" class="pf w1 h2" data-page-no="13d"><div class="pc pc13d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">286<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws720">I compiled this list b<span class="_ _4"></span>y walking through se<span class="_ _4"></span>veral dif<span class="_ _4"></span>ferent programs and refactoring</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws278">them. <span class="_ _1"></span>As I made each change, I asked m<span class="_ _4"></span>yself <span class="ffa ls89 ws0">why<span class="_ _18"> </span></span>I made that change and then wrote the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws721">reason do<span class="_ _4"></span>wn here. <span class="_ _4"></span>The result is a rather long list of things that smell bad to me when I read</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">code.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws55f">This list is meant to be read from top to bottom and also to be used as a reference.</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws3fb">There is a cross-reference for each heuristic that sho<span class="_ _4"></span>ws you w<span class="_ _4"></span>here it is referenced in the</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">rest of the text in “<span class="_ _0"></span>Appendix C” on page 409.</div><div class="t m0 xd h17 y4dc ff1 fs9 fc0 sc0 ls0 ws0">Comments</div><div class="t m0 xd h11 y59 ff1 fs7 fc0 sc0 ls0 ws0">C1:<span class="_ _4"></span> <span class="ff5">Inappropriate Inf<span class="_ _4"></span>ormation</span></div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws5a3">It is inappropriate for a comment to hold information better held in a different kind of sys-</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws717">tem such as your source code control system, y<span class="_ _4"></span>our issue tracking system, or any other</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls25 ws722">record-keeping system. Change histories, for e<span class="_ _4"></span>xample, just clutter up source ﬁles with</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws16a">volumes of historical and uninteresting te<span class="_ _4"></span>xt. In general, meta-data such as authors, last-</div><div class="t m0 xd h14 y258 ff8 fs3 fc0 sc0 ls0 ws5f5">modiﬁed-date, SPR number<span class="_ _4"></span>, and so on should not appear in comments. Comments should</div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws0">be reserved for technical notes about the code and design.</div><div class="t m0 xd h11 y6fc ff1 fs7 fc0 sc0 ls0 ws0">C2:<span class="_ _4"></span> <span class="ff5">Obsolete Comment</span></div><div class="t m0 xd h14 yc58 ff8 fs3 fc0 sc0 ls0 ws70b">A comment that has gotten old<span class="_ _1"></span>, ir<span class="_ _8"></span>relev<span class="_ _4"></span>ant, and incor<span class="_ _8"></span>rect is obsolete. Comments get old</div><div class="t m0 xd h14 yc59 ff8 fs3 fc0 sc0 ls0 ws2e5">quickly<span class="_ _0"></span>. It is best not to write a comment that will become obsolete. If y<span class="_ _4"></span>ou ﬁnd an obsolete</div><div class="t m0 xd h14 y1382 ff8 fs3 fc0 sc0 ls0 ws4d7">comment, it is best to update it or get rid of it as quickly as possib<span class="_ _4"></span>le. Obsolete comments</div><div class="t m0 xd h14 y415 ff8 fs3 fc0 sc0 ls0 ws576">tend to migrate aw<span class="_ _4"></span>a<span class="_ _4"></span>y from the code they once described. <span class="_ _1"></span>They become ﬂoating islands of</div><div class="t m0 xd h14 y416 ff8 fs3 fc0 sc0 ls0 ws0">ir<span class="_ _8"></span>relev<span class="_ _4"></span>ance and misdirection in the code. </div><div class="t m0 xd h11 y809 ff1 fs7 fc0 sc0 ls0 ws0">C3:<span class="_ _4"></span> <span class="ff5">Redundant Comment</span></div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 ws723">A comment is redundant if it describes something that adequately describes itself. F<span class="_ _1"></span>or</div><div class="t m0 xd h14 y47a ff8 fs3 fc0 sc0 ls0 ws0">example:</div><div class="t m5 x74 h2f y1383 ffb fs10 fc0 sc0 ls14 ws235">  i++; // increment i</div><div class="t m0 xd h14 y8df ff8 fs3 fc0 sc0 ls0 ws2f8">Another example is a Ja<span class="_ _1"></span>vadoc that sa<span class="_ _4"></span>ys nothing more than (or ev<span class="_ _4"></span>en less than) the function</div><div class="t m0 xd h14 y7fb ff8 fs3 fc0 sc0 ls0 ws0">signature:</div><div class="t m5 x74 h2f yb6a ffb fs10 fc0 sc0 ls0 ws0">  /**</div><div class="t m5 x74 h2f y1384 ffb fs10 fc0 sc0 ls0 ws0">   * @param sellRequest</div><div class="t m5 x74 h2f y1385 ffb fs10 fc0 sc0 ls0 ws0">   * @return</div><div class="t m5 x74 h2f y1386 ffb fs10 fc0 sc0 ls0 ws0">   * @throws ManagedComponentException</div><div class="t m5 x74 h2f y1387 ffb fs10 fc0 sc0 ls0 ws0">   */</div><div class="t m5 x74 h2f y1388 ffb fs10 fc0 sc0 ls0 ws0">  public SellResponse beginSellItem(SellRequest sellRequest) </div><div class="t m5 x74 h2f y1389 ffb fs10 fc0 sc0 ls19 ws2f1">    throws ManagedComponentException</div><div class="t m0 xd h14 y73d ff8 fs3 fc0 sc0 ls0 ws0">Comments should sa<span class="_ _4"></span>y things that the code cannot sa<span class="_ _4"></span>y for itself.</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:475.945010px;width:64.539000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:449.728010px;width:153.166000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:343.728010px;width:114.955000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:249.728010px;width:126.980000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13e" class="pf w1 h2" data-page-no="13e"><div class="pc pc13e w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">287<span class="_ _10"></span><span class="ff1">En<span class="_ _1"></span>vironment</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">C4:<span class="_ _4"></span> <span class="ff5 ws724">P<span class="_ _1"></span>oorly Written <span class="_ _6"></span>Comment</span></div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls12 ws122">A comment w<span class="_ _4"></span>orth writing is worth writing w<span class="_ _4"></span>ell. If you are going to write a comment,</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls12 ws725">take the time to make sure it is the best comment y<span class="_ _4"></span>ou can write. Choose your w<span class="_ _1"></span>ords</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls12 wsa2">carefully<span class="_ _0"></span>. Use correct g<span class="_ _8"></span>rammar and punctuation. Don’<span class="_ _4"></span>t ramble. Don’<span class="_ _1"></span>t state the obvious.</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls12 ws0">Be brief.</div><div class="t m0 xd h11 yec4 ff1 fs7 fc0 sc0 ls0 ws0">C5:<span class="_ _4"></span> <span class="ff5">Commented-Out Code</span></div><div class="t m0 xd h14 y278 ff8 fs3 fc0 sc0 ls0 ws41c">It makes me crazy to see stretches of code that are commented out. <span class="_ _4"></span>Who kno<span class="_ _4"></span>ws ho<span class="_ _4"></span>w old it</div><div class="t m0 xd h14 y279 ff8 fs3 fc0 sc0 ls0 ws3f0">is? <span class="_ _4"></span>Who kno<span class="_ _4"></span>ws whether or not it’<span class="_ _2"></span>s meaningful? <span class="_ _0"></span>Y<span class="_ _2"></span>et no one will delete it because e<span class="_ _4"></span>veryone</div><div class="t m0 xd h14 y386 ff8 fs3 fc0 sc0 ls0 ws0">assumes someone else needs it or has plans for it.</div><div class="t m0 x74 h14 y27b ff8 fs3 fc0 sc0 ls0 ws726">That code sits there and rots, getting less and less relev<span class="_ _1"></span>ant with every passing da<span class="_ _4"></span>y<span class="_ _1"></span>. It</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws16c">calls functions that no longer exist. It uses v<span class="_ _4"></span>ariables w<span class="_ _4"></span>hose names ha<span class="_ _4"></span>ve changed. It follo<span class="_ _4"></span>ws</div><div class="t m0 xd h14 y27d ff8 fs3 fc0 sc0 ls0 ws216">con<span class="_ _4"></span>ventions that are long obsolete. It pollutes the modules that contain it and distracts the</div><div class="t m0 xd h14 y27e ff8 fs3 fc0 sc0 ls0 ws0">people who try to read it. Commented-out code is an <span class="ffa">abomination</span>.</div><div class="t m0 x74 h14 y388 ff8 fs3 fc0 sc0 ls0 ws2c0">When you see commented-out code, <span class="ffa">delete it! </span>Don’<span class="_ _1"></span>t w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y<span class="_ _0"></span>, the source code control</div><div class="t m0 xd h14 y389 ff8 fs3 fc0 sc0 ls0 ws612">system still remembers it. If an<span class="_ _4"></span>yone reall<span class="_ _4"></span>y needs it, he or she can go back and check out a</div><div class="t m0 xd h14 y38a ff8 fs3 fc0 sc0 ls0 ws0">previous v<span class="_ _4"></span>ersion. Don’<span class="_ _4"></span>t suf<span class="_ _4"></span>fer commented-out code to sur<span class="_ _8"></span>viv<span class="_ _4"></span>e.</div><div class="t m0 xd h17 y138a ff1 fs9 fc0 sc0 ls0 ws0">En<span class="_ _1"></span>vir<span class="_ _4"></span>onment</div><div class="t m0 xd h11 y7a6 ff1 fs7 fc0 sc0 ls0 ws0">E1:<span class="_ _4"></span> <span class="ff5">Build Requires Mor<span class="_ _4"></span>e <span class="_ _4"></span>Than One Step</span></div><div class="t m0 xd h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws75">Building a project should be a single tri<span class="_ _4"></span>vial operation. <span class="_ _1"></span>Y<span class="_ _3"></span>ou should not hav<span class="_ _4"></span>e to check many</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws612">little pieces out from source code control. <span class="_ _0"></span>Y<span class="_ _2"></span>ou should not need a sequence of arcane com-</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 lsd ws727">mands or context dependent scripts in order to build the indi<span class="_ _4"></span>vidual elements. <span class="_ _0"></span>Y<span class="_ _2"></span>ou should</div><div class="t m0 xd h14 y5cc ff8 fs3 fc0 sc0 ls0 ws728">not ha<span class="_ _4"></span>ve to search near and far for all the various little e<span class="_ _4"></span>xtra J<span class="_ _4"></span>ARs, XML ﬁles, and other</div><div class="t m0 xd h14 y5cd ff8 fs3 fc0 sc0 ls0 ws6ab">artif<span class="_ _8"></span>acts that the system requires. <span class="_ _0"></span>Y<span class="_ _2"></span>ou <span class="ffa ws0">should<span class="_ _b"> </span></span>be able to check out the system with one sim-</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 lsd wsef">ple command and then issue one other simple command to build it.</div><div class="t m5 x74 h2f y138b ffb fs10 fc0 sc0 ls0 ws0">svn get mySystem</div><div class="t m5 x74 h2f y138c ffb fs10 fc0 sc0 ls0 ws0">cd mySystem</div><div class="t m5 x74 h2f y138d ffb fs10 fc0 sc0 ls0 ws0">ant all</div><div class="t m0 xd h11 yf77 ff1 fs7 fc0 sc0 ls0 ws0">E2:<span class="_ _4"></span> <span class="_ _4"></span><span class="ff5">T<span class="_ _0"></span>ests Require Mor<span class="_ _4"></span>e <span class="_ _4"></span>Than One Step</span></div><div class="t m0 xd h14 y45d ff8 fs3 fc0 sc0 ls16 ws729">Y<span class="_ _3"></span>ou should be able to run <span class="ffa ws0">all<span class="_ _18"> </span></span>the unit tests with just one command. In the best case you</div><div class="t m0 xd h14 y45e ff8 fs3 fc0 sc0 ls32 ws420">can run all the tests by clicking on one button in your IDE. In the w<span class="_ _1"></span>orst case you should</div><div class="t m0 xd h14 yb27 ff8 fs3 fc0 sc0 ls16 ws33b">be able to issue a single simple command in a shell. Being ab<span class="_ _4"></span>le to run all the tests is so</div><div class="t m0 xd h14 y556 ff8 fs3 fc0 sc0 ls16 ws0">fundamental and so important that it should be quick, easy<span class="_ _1"></span>, and obvious to do. </div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:494.728010px;width:131.623000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:143.332000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:320.944010px;width:78.223000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:291.728010px;width:201.481000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:146.728010px;width:193.217000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf13f" class="pf w1 h2" data-page-no="13f"><div class="pc pc13f w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">288<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Functions</div><div class="t m0 xd h11 y138e ff1 fs7 fc0 sc0 ls0 ws0">F1:<span class="_ _4"></span> <span class="_ _4"></span><span class="ff5">T<span class="_ _0"></span>oo Man<span class="_ _4"></span>y <span class="_ _0"></span>Arguments</span></div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws511">Functions should ha<span class="_ _4"></span>ve a small number of arguments. No ar<span class="_ _4"></span>gument is best, follo<span class="_ _4"></span>w<span class="_ _4"></span>ed by</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws4f1">one, tw<span class="_ _4"></span>o, and three. More than three is very questionable and should be a<span class="_ _4"></span>voided with prej-</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">udice. (See “Function <span class="_ _1"></span>Arguments” on page 40.)</div><div class="t m0 xd h11 y862 ff1 fs7 fc0 sc0 ls0 ws0">F2:<span class="_ _4"></span> <span class="ff5 ws72a">Output Arguments</span></div><div class="t m0 xd h14 y863 ff8 fs3 fc0 sc0 ls0 ws72b">Output arguments are counterintuiti<span class="_ _4"></span>ve. Readers e<span class="_ _4"></span>xpect arguments to be inputs, not out-</div><div class="t m0 xd h14 y5b9 ff8 fs3 fc0 sc0 ls0 ws1e8">puts. If your function must change the state of something, ha<span class="_ _1"></span>ve it change the state of the</div><div class="t m0 xd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws0">object it is called on. (See “Output <span class="_ _1"></span>Arguments” on page 45.)</div><div class="t m0 xd h11 yc69 ff1 fs7 fc0 sc0 ls0 ws0">F3:<span class="_ _4"></span> <span class="ff5 ws72a">Flag Arguments</span></div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws72c">Boolean arguments loudl<span class="_ _4"></span>y declare that the function does more than one thing. <span class="_ _1"></span>They are</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws0">confusing and should be eliminated. (See “Flag <span class="_ _1"></span>Arguments” on page 41.)</div><div class="t m0 xd h11 y29 ff1 fs7 fc0 sc0 ls0 ws0">F4:<span class="_ _4"></span> <span class="ff5">Dead Function</span></div><div class="t m0 xd h14 y74a ff8 fs3 fc0 sc0 ls0 ws305">Methods that are ne<span class="_ _4"></span>ver called should be discarded. Keeping dead code around is w<span class="_ _4"></span>asteful.</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws72d">Don’<span class="_ _1"></span>t be afraid to delete the function. Remember, y<span class="_ _4"></span>our source code control system still</div><div class="t m0 xd h14 y74c ff8 fs3 fc0 sc0 ls0 ws0">remembers it.</div><div class="t m0 xd h17 y138f ff1 fs9 fc0 sc0 ls0 ws0">General</div><div class="t m0 xd h11 y58a ff1 fs7 fc0 sc0 ls0 ws0">G1:<span class="_ _4"></span> <span class="ff5">Multiple Languag<span class="_ _4"></span>es in One Source F<span class="_ _1"></span>ile</span></div><div class="t m0 xd h14 y2ba ff8 fs3 fc0 sc0 ls53 ws178">T<span class="_ _0"></span>oday’<span class="_ _3"></span>s moder<span class="_ _8"></span>n programming en<span class="_ _4"></span>vironments make it possible to put man<span class="_ _4"></span>y different languages</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls53 ws72e">into a single source ﬁle. F<span class="_ _1"></span>or example, a Ja<span class="_ _4"></span>va source ﬁle might contain snippets of XML,</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls53 ws53">HTML, Y<span class="_ _2"></span>AML, Jav<span class="_ _4"></span>aDoc, English, Ja<span class="_ _4"></span>vaScript, and so on. F<span class="_ _1"></span>or another example, in addition to</div><div class="t m0 xd h14 y228 ff8 fs3 fc0 sc0 ls53 ws72f">HTML a JSP ﬁle might contain Ja<span class="_ _4"></span>va, a tag library syntax, English comments, Ja<span class="_ _4"></span>vadocs,</div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls53 ws0">XML, Ja<span class="_ _4"></span>vaScript, and so forth. <span class="_ _4"></span>This is confusing at best and carelessl<span class="_ _4"></span>y sloppy at w<span class="_ _1"></span>orst. </div><div class="t m0 x74 h14 y22a ff8 fs3 fc0 sc0 ls0 ws6f9">The ideal is for a source ﬁle to contain one, and only one, language. Realisticall<span class="_ _1"></span>y<span class="_ _1"></span>, we</div><div class="t m0 xd h14 y22b ff8 fs3 fc0 sc0 ls0 ws438">will probabl<span class="_ _4"></span>y ha<span class="_ _4"></span>ve to use more than one. But w<span class="_ _4"></span>e should take pains to minimize both the</div><div class="t m0 xd h14 y22c ff8 fs3 fc0 sc0 ls0 ws0">number and extent of e<span class="_ _4"></span>xtra languages in our source ﬁles.</div><div class="t m0 xd h11 y1390 ff1 fs7 fc0 sc0 ls0 ws0">G2:<span class="_ _4"></span> <span class="ff5">Obvious Behavior Is Unimplemented</span></div><div class="t m0 xd h14 yb79 ff8 fs3 fc0 sc0 ls0 ws15b">F<span class="_ _1"></span>ollowing “The Principle of Least Surprise,<span class="_ _1"></span>”</div><div class="t m0 x78 h21 yde2 ff8 fsc fc0 sc0 ls0 ws0">2</div><div class="t m0 xee h14 yb79 ff8 fs3 fc0 sc0 ls0 ws15b">an<span class="_ _4"></span>y function or class should implement the</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls0 ws730">beha<span class="_ _4"></span>viors that another programmer could reasonabl<span class="_ _4"></span>y expect. F<span class="_ _1"></span>or example, consider a</div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 ls0 ws0">function that translates the name of a da<span class="_ _4"></span>y to an </div><div class="t m5 x23 h2f y60e ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 x7e h14 y60e ff8 fs3 fc0 sc0 ls0 ws0"> that represents the da<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 xd h25 y1391 ff8 fse fc0 sc0 ls0 ws0">2.<span class="_ _17"> </span>Or “The Principle of Least <span class="_ _1"></span>Astonishment”: <span class="ffb">http://en.wikipedia.org/wiki/</span></div><div class="t m0 x3b hb6 y1392 ffb fse fc0 sc0 ls0 ws0">Principle_of_least_astonishment</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.824000px;bottom:580.945010px;width:59.121000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:556.728010px;width:125.883000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:489.728010px;width:111.359000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:422.728010px;width:99.841000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:367.728010px;width:94.965000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:293.945010px;width:48.078000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:269.728010px;width:217.969000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:139.728010px;width:204.670000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Principle_of_least_astonishment"><div class="d m1" style="border-style:none;position:absolute;left:212.368000px;bottom:60.178010px;width:121.798000px;height:7.384900px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://en.wikipedia.org/wiki/Principle_of_least_astonishment"><div class="d m1" style="border-style:none;position:absolute;left:90.825200px;bottom:52.177710px;width:130.197800px;height:7.385000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf140" class="pf w1 h2" data-page-no="140"><div class="pc pc140 w1 h2"><img class="bi x37 yf1e w8 h27" alt="" src="bg140.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">289<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">Day day = DayDate.StringToDay(String dayName);</div><div class="t m0 xd h14 y1393 ff8 fs3 fc0 sc0 ls0 ws5ed">W<span class="_ _0"></span>e w<span class="_ _4"></span>ould expect the string </div><div class="t m5 x57 h2f y1393 ffb fs10 fc0 sc0 ls0 ws0">&quot;Monday&quot;</div><div class="t m0 x26 h14 y1393 ff8 fs3 fc0 sc0 ls0 ws5ed">to be translated to </div><div class="t m5 x85 h2f y1393 ffb fs10 fc0 sc0 ls0 ws0">Day.MONDAY</div><div class="t m0 xf9 h14 y1393 ff8 fs3 fc0 sc0 ls0 ws5ed">. <span class="_ _4"></span>W<span class="_ _0"></span>e would also e<span class="_ _4"></span>xpect</div><div class="t m0 xd h14 y1fa ff8 fs3 fc0 sc0 ls0 ws618">the common abbreviations to be translated<span class="_ _0"></span>, and we w<span class="_ _1"></span>ould expect the function to ignore</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws0">case.</div><div class="t m0 x74 h14 y56d ff8 fs3 fc0 sc0 ls0 ws47a">When an ob<span class="_ _4"></span>vious behavior is not implemented<span class="_ _0"></span>, readers and users of the code can no</div><div class="t m0 xd h14 y41c ff8 fs3 fc0 sc0 ls0 wsf5">longer depend on their intuition about function names. <span class="_ _1"></span>They lose their tr<span class="_ _8"></span>ust in the original</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws0">author and must fall back on reading the details of the code. </div><div class="t m0 xd h11 y1394 ff1 fs7 fc0 sc0 ls0 ws0">G3:<span class="_ _4"></span> <span class="ff5">Incorrect Behavior at the Boundaries</span></div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls0 ws165">It seems ob<span class="_ _4"></span>vious to say that code should beha<span class="_ _1"></span>ve cor<span class="_ _8"></span>rectly<span class="_ _0"></span>. <span class="_ _1"></span>The problem is that w<span class="_ _4"></span>e seldom</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 ls0 ws6ba">realize just ho<span class="_ _4"></span>w complicated cor<span class="_ _8"></span>rect beha<span class="_ _4"></span>vior is. Developers often write functions that</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws2a">they think will w<span class="_ _1"></span>ork, and then tr<span class="_ _8"></span>ust their intuition rather than going to the effort to pro<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws0">that their code w<span class="_ _4"></span>orks in all the corner and boundar<span class="_ _8"></span>y cases.</div><div class="t m0 x74 h14 y605 ff8 fs3 fc0 sc0 ls0 ws731">There is no replacement for due diligence. Every boundary condition, every cor<span class="_ _8"></span>ner</div><div class="t m0 xd h14 y2b0 ff8 fs3 fc0 sc0 lsc ws613">case, ev<span class="_ _4"></span>ery quirk and exception represents something that can confound an elegant and</div><div class="t m0 xd h14 y2b1 ff8 fs3 fc0 sc0 ls0 ws13f">intuitiv<span class="_ _4"></span>e algorithm. <span class="ffa">Don’<span class="_ _0"></span>t rely on your intuition<span class="ff8">. Look for e<span class="_ _1"></span>ver<span class="_ _8"></span>y boundary condition and</span></span></div><div class="t m0 xd h14 y2b2 ff8 fs3 fc0 sc0 ls0 ws0">write a test for it.</div><div class="t m0 xd h11 y1395 ff1 fs7 fc0 sc0 ls0 ws0">G4:<span class="_ _4"></span> <span class="ff5">Overridden Saf<span class="_ _4"></span>eties</span></div><div class="t m0 xd h14 yb1f ff8 fs3 fc0 sc0 ls0 ws54d">Chernobyl melted do<span class="_ _4"></span>wn because the plant manager o<span class="_ _4"></span>verrode each of the safety mecha-</div><div class="t m0 xd h14 yb20 ff8 fs3 fc0 sc0 ls0 ws1ac">nisms one b<span class="_ _4"></span>y one. <span class="_ _4"></span>The safeties were making it incon<span class="_ _1"></span>venient to run an experiment. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y48b ff8 fs3 fc0 sc0 ls0 ws2ac">result was that the e<span class="_ _4"></span>xperiment did not get run, and the world sa<span class="_ _1"></span>w it’<span class="_ _2"></span>s ﬁrst major civilian</div><div class="t m0 xd h14 y48c ff8 fs3 fc0 sc0 ls0 ws0">nuclear catastrophe.</div><div class="t m0 x74 h14 y2b8 ff8 fs3 fc0 sc0 ls0 ws5e9">It is risky to o<span class="_ _1"></span>ver<span class="_ _8"></span>ride safeties. Ex<span class="_ _4"></span>er<span class="_ _8"></span>ting manual control o<span class="_ _4"></span>ver </div><div class="t m5 xa0 h2f y2b8 ffb fs10 fc0 sc0 ls0 ws0">serialVersionUID</div><div class="t m0 x71 h14 y2b8 ff8 fs3 fc0 sc0 ls0 ws5e9">ma<span class="_ _4"></span>y be</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc0 sc0 lsd ws29b">necessary<span class="_ _1"></span>, but it is al<span class="_ _4"></span>wa<span class="_ _4"></span>ys risky<span class="_ _0"></span>. <span class="_ _4"></span>T<span class="_ _0"></span>ur<span class="_ _8"></span>ning off certain compiler warnings (or all w<span class="_ _4"></span>ar<span class="_ _8"></span>nings!)</div><div class="t m0 xd h14 y54f ff8 fs3 fc0 sc0 ls11 ws35c">ma<span class="_ _4"></span>y help you get the build to succeed<span class="_ _1"></span>, but at the risk of endless debugging sessions. <span class="_ _4"></span>T<span class="_ _0"></span>ur<span class="_ _8"></span>n-</div><div class="t m0 xd h14 y550 ff8 fs3 fc0 sc0 ls0 ws350">ing off failing tests and telling y<span class="_ _4"></span>ourself you’<span class="_ _1"></span>ll get them to pass later is as bad as pretending</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws0">your credit cards are free mone<span class="_ _4"></span>y<span class="_ _1"></span>.</div><div class="t m0 xd h11 y1396 ff1 fs7 fc0 sc0 ls0 ws0">G5:<span class="_ _4"></span> <span class="ff5">Duplication</span></div><div class="t m0 xd h14 y739 ff8 fs3 fc0 sc0 ls0 ws732">This is one of the most important r<span class="_ _8"></span>ules in this book, and you should take it v<span class="_ _4"></span>er<span class="_ _8"></span>y seriously<span class="_ _0"></span>.</div><div class="t m0 xd h14 y73a ff8 fs3 fc0 sc0 ls0 wsf5">V<span class="_ _4"></span>irtually e<span class="_ _4"></span>very author who writes about software design mentions this rule. Da<span class="_ _4"></span>ve <span class="_ _1"></span>Thomas</div><div class="t m0 xd h14 y46f ff8 fs3 fc0 sc0 ls0 ws251">and <span class="_ _1"></span>Andy Hunt called it the DR<span class="_ _0"></span>Y</div><div class="t m0 x81 h21 y45a ff8 fsc fc0 sc0 ls0 ws0">3</div><div class="t m0 x5b h14 y46f ff8 fs3 fc0 sc0 ls0 ws251">principle (Don’<span class="_ _1"></span>t Repeat <span class="_ _1"></span>Y<span class="_ _3"></span>ourself). Kent Beck made it</div><div class="t m0 xd h14 y470 ff8 fs3 fc0 sc0 ls0 ws733">one of the core principles of Extreme Programming and called it: “Once, and onl<span class="_ _4"></span>y once.<span class="_ _1"></span>”</div><div class="t m0 xd h14 y401 ff8 fs3 fc0 sc0 ls0 ws0">Ron Jef<span class="_ _4"></span>fries ranks this r<span class="_ _8"></span>ule second<span class="_ _4"></span>, just belo<span class="_ _4"></span>w getting all the tests to pass. </div><div class="t m0 x74 h14 yb79 ff8 fs3 fc0 sc0 ls25 ws734">Every time you see duplication in the code, it represents a missed opportunity for</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls25 ws735">abstraction. <span class="_ _1"></span>That duplication could probably become a subroutine or perhaps another</div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 ls25 wsd0">class outright. By folding the duplication into such an abstraction, you increase the v<span class="_ _4"></span>ocab-</div><div class="t m0 xd h14 y482 ff8 fs3 fc0 sc0 ls25 ws629">ulary of the language of your design. Other pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers can use the abstract facilities</div><div class="t m0 xd h25 y1397 ff8 fse fc0 sc0 ls0 ws0">3.<span class="_ _17"> </span>[PRA<span class="_ _4"></span>G].</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:480.728010px;width:207.009000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:347.728010px;width:119.132000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:202.728010px;width:80.635000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf141" class="pf w1 h2" data-page-no="141"><div class="pc pc141 w1 h2"><img class="bi x37 y1398 w8 h27" alt="" src="bg141.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">290<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls25 ws736">you create. Coding becomes faster and less error prone because you ha<span class="_ _4"></span>ve raised the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls25 ws0">abstraction le<span class="_ _4"></span>vel.</div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws38c">The most ob<span class="_ _4"></span>vious for<span class="_ _8"></span>m of duplication is when y<span class="_ _4"></span>ou hav<span class="_ _4"></span>e clumps of identical code that</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws43c">look like some pro<span class="_ _4"></span>g<span class="_ _8"></span>rammers w<span class="_ _4"></span>ent wild with the mouse, pasting the same code o<span class="_ _4"></span>ver and</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 lsc ws3f">o<span class="_ _4"></span>ver again. <span class="_ _1"></span>These should be replaced with simple methods. </div><div class="t m0 x74 h14 y41c ff8 fs3 fc0 sc0 ls0 wsf6">A more subtle form is the </div><div class="t m5 x8f h2f y41c ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x26 h14 y41c ff8 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m5 x32 h2f y41c ffb fs10 fc0 sc0 ls0 ws0">case</div><div class="t m0 x4b h14 y41c ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x78 h2f y41c ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x68 h14 y41c ff8 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m5 xce h2f y41c ffb fs10 fc0 sc0 ls0 ws0">else</div><div class="t m0 x96 h14 y41c ff8 fs3 fc0 sc0 ls1d ws25a">chain that appears again and again in</div><div class="t m0 xd h14 y205 ff8 fs3 fc0 sc0 ls0 ws737">various modules, al<span class="_ _1"></span>wa<span class="_ _4"></span>ys testing for the same set of conditions. <span class="_ _1"></span>These should be replaced</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 ls0 ws0">with polymorphism.</div><div class="t m0 x74 h14 y409 ff8 fs3 fc0 sc0 lsd ws738">Still more subtle are the modules that ha<span class="_ _4"></span>ve similar algorithms, but that don’<span class="_ _1"></span>t share</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 ws96">similar lines of code. <span class="_ _1"></span>This is still duplication and should be addressed by using the T<span class="fsb ws0">EM-</span></div><div class="t m0 xd h14 y92b ff8 fsb fc0 sc0 ls0 ws0">PLATE<span class="fs3"> M</span>ETHOD<span class="fs3">,</span></div><div class="t m0 xfb h21 y39e ff8 fsc fc0 sc0 ls0 ws0">4</div><div class="t m0 xbc h14 y92b ff8 fs3 fc0 sc0 ls0 ws0"> or S<span class="fsb">TRATEGY</span></div><div class="t m0 x84 h21 y39e ff8 fsc fc0 sc0 ls0 ws0">5</div><div class="t m0 xa2 h14 y92b ff8 fs3 fc0 sc0 ls0 ws0"> pattern. </div><div class="t m0 x74 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws78">Indeed<span class="_ _1"></span>, most of the design patter<span class="_ _8"></span>ns that ha<span class="_ _4"></span>ve appeared in the last ﬁfteen years are sim-</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws42d">pl<span class="_ _4"></span>y well-kno<span class="_ _1"></span>wn wa<span class="_ _4"></span>ys to eliminate duplication. So too the Codd Normal F<span class="_ _4"></span>or<span class="_ _8"></span>ms are a strat-</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 lsc ws525">egy for eliminating duplication in database schemae. OO itself is a strate<span class="_ _4"></span>gy for organizing</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">modules and eliminating duplication. Not sur<span class="_ _8"></span>prisingly<span class="_ _0"></span>, so is structured programming. </div><div class="t m0 x74 h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws0">I think the point has been made. Find and eliminate duplication w<span class="_ _4"></span>herev<span class="_ _4"></span>er you can.</div><div class="t m0 xd h11 y610 ff1 fs7 fc0 sc0 ls0 ws0">G6:<span class="_ _4"></span> <span class="ff5">Code at <span class="_ _0"></span>Wrong Lev<span class="_ _4"></span>el of <span class="_ _0"></span>Abstraction</span></div><div class="t m0 xd h14 y3a4 ff8 fs3 fc0 sc0 ls0 ws31">It is important to create abstractions that separate higher level general concepts from lo<span class="_ _1"></span>wer</div><div class="t m0 xd h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws35b">le<span class="_ _4"></span>vel detailed concepts. Sometimes w<span class="_ _4"></span>e do this by creating abstract classes to hold the</div><div class="t m0 xd h14 y6d5 ff8 fs3 fc0 sc0 ls0 ws221">higher lev<span class="_ _4"></span>el concepts and deriv<span class="_ _4"></span>ati<span class="_ _4"></span>ves to hold the lo<span class="_ _4"></span>w<span class="_ _4"></span>er level concepts. <span class="_ _1"></span>When we do this,</div><div class="t m0 xd h14 y6d6 ff8 fs3 fc0 sc0 ls0 ws23d">w<span class="_ _4"></span>e need to make sure that the separation is complete. <span class="_ _4"></span>W<span class="_ _0"></span>e want <span class="ffa ws0">all </span>the lo<span class="_ _1"></span>wer le<span class="_ _4"></span>vel concepts</div><div class="t m0 xd h14 y5c5 ff8 fs3 fc0 sc0 ls0 ws0">to be in the deri<span class="_ _4"></span>vati<span class="_ _4"></span>ves and <span class="ffa">all</span> the higher le<span class="_ _4"></span>vel concepts to be in the base class.</div><div class="t m0 x74 h14 y38d ff8 fs3 fc0 sc0 ls0 ws6dc">F<span class="_ _1"></span>or example, constants, variab<span class="_ _4"></span>les, or utility functions that per<span class="_ _8"></span>tain only to the detailed</div><div class="t m0 xd h14 y38e ff8 fs3 fc0 sc0 ls0 ws176">implementation should not be present in the base class. <span class="_ _1"></span>The base class should know noth-</div><div class="t m0 xd h14 y38f ff8 fs3 fc0 sc0 ls0 ws0">ing about them. </div><div class="t m0 x74 h14 y390 ff8 fs3 fc0 sc0 ls0 ws317">This rule also per<span class="_ _8"></span>tains to source ﬁles, components, and modules. Good software</div><div class="t m0 xd h14 y479 ff8 fs3 fc0 sc0 ls0 ws49c">design requires that w<span class="_ _4"></span>e separate concepts at different le<span class="_ _4"></span>vels and place them in dif<span class="_ _4"></span>ferent</div><div class="t m0 xd h14 y47a ff8 fs3 fc0 sc0 ls0 ws129">containers. Sometimes these containers are base classes or deriv<span class="_ _1"></span>atives and sometimes the<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1399 ff8 fs3 fc0 sc0 ls0 ws3af">are source ﬁles, modules, or components. <span class="_ _4"></span>Whatev<span class="_ _4"></span>er the case may be, the separation needs</div><div class="t m0 xd h14 y139a ff8 fs3 fc0 sc0 ls0 ws0">to be complete. <span class="_ _4"></span>W<span class="_ _0"></span>e don’<span class="_ _4"></span>t want lo<span class="_ _1"></span>wer and higher le<span class="_ _4"></span>vel concepts mix<span class="_ _4"></span>ed together<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y2fc ff8 fs3 fc0 sc0 ls0 ws0">Consider the follo<span class="_ _4"></span>wing code:</div><div class="t m5 x74 h2f y139b ffb fs10 fc0 sc0 ls0 ws0">public interface Stack {</div><div class="t m5 x74 h2f y139c ffb fs10 fc0 sc0 ls0 ws0">  Object pop() throws EmptyException;</div><div class="t m5 x74 h2f y139d ffb fs10 fc0 sc0 ls0 ws0">  void push(Object o) throws FullException;</div><div class="t m5 x74 h2f y139e ffb fs10 fc0 sc0 ls0 ws0">  double percentFull();</div><div class="t m0 xd h25 y200 ff8 fse fc0 sc0 ls0 ws0">4.<span class="_ _17"> </span>[GOF].</div><div class="t m0 xd h25 y139f ff8 fse fc0 sc0 ls0 ws0">5.<span class="_ _17"> </span>[GOF].</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:363.728010px;width:197.053000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf142" class="pf w1 h2" data-page-no="142"><div class="pc pc142 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">291<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  class EmptyException extends Exception {}</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  class FullException extends Exception {}</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 ya7b ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 xdc h2f ya7b ffb fs10 fc0 sc0 ls0 ws0">percentFull</div><div class="t m0 xed h14 ya7b ff8 fs3 fc0 sc0 ls0 ws739">function is at the wrong le<span class="_ _4"></span>vel of abstraction. <span class="_ _1"></span>Although there are</div><div class="t m0 xd h14 ya7c ff8 fs3 fc0 sc0 ls0 ws701">man<span class="_ _4"></span>y implementations of </div><div class="t m5 x7d h2f ya7c ffb fs10 fc0 sc0 ls0 ws0">Stack</div><div class="t m0 xa2 h14 ya7c ff8 fs3 fc0 sc0 ls0 ws701">where the concept of <span class="ffa ws0">fullness<span class="_ _b"> </span></span>is reasonable, there are other</div><div class="t m0 xd h14 ya7d ff8 fs3 fc0 sc0 ls0 ws73a">implementations that simply <span class="_ _4"></span><span class="ffa">could not know <span class="ff8">ho<span class="_ _4"></span>w full they are. So the function w<span class="_ _1"></span>ould be</span></span></div><div class="t m0 xd h14 yb6b ff8 fs3 fc0 sc0 ls0 ws0">better placed in a deri<span class="_ _4"></span>vati<span class="_ _4"></span>ve interface such as </div><div class="t m5 x1b h2f yb6b ffb fs10 fc0 sc0 ls0 ws0">BoundedStack</div><div class="t m0 xae h14 yb6b ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1db ff8 fs3 fc0 sc0 ls0 ws531">P<span class="_ _4"></span>erhaps you are thinking that the implementation could just return zero if the stack</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws73b">w<span class="_ _4"></span>ere boundless. <span class="_ _4"></span>The problem with that is that no stack is truly boundless. <span class="_ _0"></span>Y<span class="_ _3"></span>ou cannot</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">really pre<span class="_ _1"></span>vent an </div><div class="t m5 xbc h2f y1dd ffb fs10 fc0 sc0 ls0 ws0">OutOfMemoryException</div><div class="t m0 x31 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0"> b<span class="_ _4"></span>y checking for </div><div class="t m5 x74 h2f y13a0 ffb fs10 fc0 sc0 ls0 ws31e">stack.percentFull() &lt; 50.0.</div><div class="t m0 xd h14 y209 ff8 fs3 fc0 sc0 ls0 ws0">Implementing the function to return 0 would be telling a lie.</div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws18e">The point is that you cannot lie or fake y<span class="_ _4"></span>our wa<span class="_ _1"></span>y out of a misplaced abstraction. Iso-</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws4f4">lating abstractions is one of the hardest things that software de<span class="_ _1"></span>velopers do, and there is no</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">quick ﬁx when y<span class="_ _4"></span>ou get it wrong.</div><div class="t m0 xd h11 y13a1 ff1 fs7 fc0 sc0 ls0 ws0">G7:<span class="_ _4"></span> <span class="ff5">Base Classes Depending on <span class="_ _4"></span>Their Derivativ<span class="_ _4"></span>es</span></div><div class="t m0 xd h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws65e">The most common reason for partitioning concepts into base and deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>e classes is so</div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls0 ws50e">that the higher le<span class="_ _4"></span>vel base class concepts can be independent of the lo<span class="_ _4"></span>w<span class="_ _4"></span>er level deri<span class="_ _4"></span>v<span class="_ _4"></span>ative</div><div class="t m0 xd h14 y5c3 ff8 fs3 fc0 sc0 ls0 ws52">class concepts. <span class="_ _1"></span>Therefore, when w<span class="_ _4"></span>e see base classes mentioning the names of their deriv<span class="_ _4"></span>a-</div><div class="t m0 xd h14 y5c4 ff8 fs3 fc0 sc0 ls0 ws73c">ti<span class="_ _4"></span>ves, w<span class="_ _4"></span>e suspect a problem. In general, base classes should kno<span class="_ _4"></span>w nothing about their</div><div class="t m0 xd h14 y2c6 ff8 fs3 fc0 sc0 ls0 ws0">deriv<span class="_ _1"></span>atives.</div><div class="t m0 x74 h14 y5c5 ff8 fs3 fc0 sc0 ls0 ws39f">There are exceptions to this rule, of course. Sometimes the number of deriv<span class="_ _4"></span>ati<span class="_ _4"></span>ves is</div><div class="t m0 xd h14 y5c7 ff8 fs3 fc0 sc0 ls0 ws73d">strictly ﬁx<span class="_ _1"></span>ed<span class="_ _4"></span>, and the base class has code that selects betw<span class="_ _4"></span>een the deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>es. W<span class="_ _2"></span>e see this a</div><div class="t m0 xd h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws217">lot in ﬁnite state machine implementations. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, in that case the deri<span class="_ _4"></span>v<span class="_ _4"></span>atives and base</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws88">class are strongl<span class="_ _4"></span>y coupled and alw<span class="_ _4"></span>a<span class="_ _4"></span>ys deplo<span class="_ _4"></span>y together in the same jar ﬁle. In the general</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws0">case w<span class="_ _4"></span>e want to be ab<span class="_ _4"></span>le to deplo<span class="_ _4"></span>y deriv<span class="_ _4"></span>ativ<span class="_ _4"></span>es and bases in different jar ﬁles. </div><div class="t m0 x74 h14 y671 ff8 fs3 fc0 sc0 ls0 ws68a">Deplo<span class="_ _4"></span>ying deri<span class="_ _4"></span>vati<span class="_ _4"></span>ves and bases in dif<span class="_ _4"></span>ferent jar ﬁles and making sure the base jar ﬁles</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls0 ws2bb">kno<span class="_ _4"></span>w nothing about the contents of the deriv<span class="_ _4"></span>ati<span class="_ _4"></span>ve jar ﬁles allo<span class="_ _4"></span>w us to deplo<span class="_ _4"></span>y our systems</div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls0 ws51d">in discrete and independent components. <span class="_ _4"></span>When such components are modiﬁed<span class="_ _4"></span>, they can</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls0 ws73e">be redeplo<span class="_ _4"></span>yed without ha<span class="_ _1"></span>ving to redeplo<span class="_ _4"></span>y the base components. <span class="_ _4"></span>This means that the</div><div class="t m0 xd h14 y675 ff8 fs3 fc0 sc0 ls0 wsc7">impact of a change is greatly lessened<span class="_ _1"></span>, and maintaining systems in the ﬁeld is made much</div><div class="t m0 xd h14 y491 ff8 fs3 fc0 sc0 ls0 ws0">simpler<span class="_ _1"></span>.</div><div class="t m0 xd h11 yf77 ff1 fs7 fc0 sc0 ls0 ws0">G8:<span class="_ _4"></span> <span class="_ _4"></span><span class="ff5">T<span class="_ _0"></span>oo Much Inf<span class="_ _1"></span>ormation</span></div><div class="t m0 xd h14 y45d ff8 fs3 fc0 sc0 ls0 ws17a">W<span class="_ _0"></span>ell-deﬁned modules ha<span class="_ _4"></span>ve very small interfaces that allo<span class="_ _4"></span>w you to do a lot with a little.</div><div class="t m0 xd h14 y45e ff8 fs3 fc0 sc0 ls0 ws33e">P<span class="_ _4"></span>oorly deﬁned modules ha<span class="_ _1"></span>ve wide and deep interfaces that force you to use man<span class="_ _4"></span>y different</div><div class="t m0 xd h14 yb27 ff8 fs3 fc0 sc0 ls0 ws211">gestures to get simple things done. <span class="_ _1"></span>A well-deﬁned interface does not of<span class="_ _4"></span>fer very many func-</div><div class="t m0 xd h14 y556 ff8 fs3 fc0 sc0 ls0 ws17d">tions to depend upon, so coupling is lo<span class="_ _4"></span>w<span class="_ _0"></span>. <span class="_ _4"></span>A poorly deﬁned interface pro<span class="_ _1"></span>vides lots of func-</div><div class="t m0 xd h14 yb28 ff8 fs3 fc0 sc0 ls0 ws0">tions that you must call, so coupling is high.</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:378.728010px;width:246.117000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:146.728010px;width:135.278000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf143" class="pf w1 h2" data-page-no="143"><div class="pc pc143 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">292<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws57">Good softw<span class="_ _4"></span>are developers learn to limit what the<span class="_ _4"></span>y expose at the interfaces of their</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws17f">classes and modules. <span class="_ _1"></span>The few<span class="_ _4"></span>er methods a class has, the better<span class="_ _4"></span>. <span class="_ _1"></span>The few<span class="_ _4"></span>er variab<span class="_ _4"></span>les a func-</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">tion kno<span class="_ _4"></span>ws about, the better<span class="_ _1"></span>. <span class="_ _4"></span>The few<span class="_ _4"></span>er instance variab<span class="_ _4"></span>les a class has, the better<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws40f">Hide your data. Hide y<span class="_ _4"></span>our utility functions. Hide your constants and y<span class="_ _4"></span>our temporaries.</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws2fc">Don’<span class="_ _1"></span>t create classes with lots of methods or lots of instance variables. Don’<span class="_ _1"></span>t create lots of</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws20a">protected v<span class="_ _4"></span>ariables and functions for your subclasses. Concentrate on k<span class="_ _4"></span>eeping interfaces</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">very tight and very small. Help keep coupling lo<span class="_ _4"></span>w by limiting information.</div><div class="t m0 xd h11 y1394 ff1 fs7 fc0 sc0 ls0 ws0">G9:<span class="_ _4"></span> <span class="ff5">Dead Code</span></div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls0 ws2a2">Dead code is code that isn’<span class="_ _1"></span>t executed. <span class="_ _0"></span>Y<span class="_ _3"></span>ou ﬁnd it in the body of an </div><div class="t m5 xb5 h2f y5dd ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x73 h14 y5dd ff8 fs3 fc0 sc0 ls0 ws2a2">statement that checks</div><div class="t m0 xd h14 y2ac ff8 fs3 fc0 sc0 ls0 ws73f">for a condition that can’<span class="_ _1"></span>t happen. <span class="_ _1"></span>Y<span class="_ _3"></span>ou ﬁnd it in the </div><div class="t m5 x7e h2f y2ac ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 xdb h14 y2ac ff8 fs3 fc0 sc0 ls0 ws73f">block of a </div><div class="t m5 x58 h2f y2ac ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x8d h14 y2ac ff8 fs3 fc0 sc0 ls0 ws73f">that nev<span class="_ _4"></span>er </div><div class="t m5 xe6 h2f y2ac ffb fs10 fc0 sc0 ls0 ws0">throws</div><div class="t m0 x56 h14 y2ac ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y2ad ff8 fs3 fc0 sc0 ls0 ws29d">Y<span class="_ _3"></span>ou ﬁnd it in little utility methods that are never called or </div><div class="t m5 x62 h2f y2ad ffb fs10 fc0 sc0 ls0 ws0">switch/case</div><div class="t m0 xa9 h14 y2ad ff8 fs3 fc0 sc0 ls0 ws29d">conditions that</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws0">nev<span class="_ _4"></span>er occur<span class="_ _1"></span>. </div><div class="t m0 x74 h14 y605 ff8 fs3 fc0 sc0 ls0 ws55c">The problem with dead code is that after a<span class="_ _1"></span>while it starts to smell. <span class="_ _4"></span>The older it is, the</div><div class="t m0 xd h14 y2b0 ff8 fs3 fc0 sc0 ls0 ws740">stronger and sourer the odor becomes. <span class="_ _1"></span>This is because dead code is not completely</div><div class="t m0 xd h14 y2b1 ff8 fs3 fc0 sc0 ls0 ws3e">updated when designs change. It still <span class="ffa ws0">compiles</span><span class="lsd ws2b3">, but it does not follo<span class="_ _1"></span>w new<span class="_ _1"></span>er conv<span class="_ _4"></span>entions or</span></div><div class="t m0 xd h14 y2b2 ff8 fs3 fc0 sc0 ls0 ws741">rules. It was written at a time when the system w<span class="_ _1"></span>as <span class="ffa ws0">differ<span class="_ _4"></span>ent<span class="ff8 ws741">. <span class="_ _4"></span>When you ﬁnd dead code, do</span></span></div><div class="t m0 xd h14 ya80 ff8 fs3 fc0 sc0 lsd wsef">the right thing. Giv<span class="_ _4"></span>e it a decent burial. Delete it from the system.</div><div class="t m0 xd h11 y1139 ff1 fs7 fc0 sc0 ls0 ws0">G10:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5">V<span class="_ _3"></span>er<span class="_ _8"></span>tical Separation</span></div><div class="t m0 xd h14 y3c1 ff8 fs3 fc0 sc0 ls0 ws50d">V<span class="_ _0"></span>ariab<span class="_ _4"></span>les and function should be deﬁned close to where they are used. Local v<span class="_ _4"></span>ariables</div><div class="t m0 xd h14 y54e ff8 fs3 fc0 sc0 ls0 ws91">should be declared just abo<span class="_ _4"></span>ve their ﬁrst usage and should ha<span class="_ _1"></span>ve a small vertical scope. W<span class="_ _2"></span>e</div><div class="t m0 xd h14 y2b7 ff8 fs3 fc0 sc0 ls0 ws0">don’<span class="_ _1"></span>t want local v<span class="_ _4"></span>ariables declared hundreds of lines distant from their usages.</div><div class="t m0 x74 h14 y310 ff8 fs3 fc0 sc0 ls0 ws742">Priv<span class="_ _1"></span>ate functions should be deﬁned just below their ﬁrst usage. Pri<span class="_ _4"></span>vate functions</div><div class="t m0 xd h14 y311 ff8 fs3 fc0 sc0 lsd ws72e">belong to the scope of the whole class, but w<span class="_ _1"></span>e’<span class="_ _2"></span>d still like to limit the vertical distance</div><div class="t m0 xd h14 y2ba ff8 fs3 fc0 sc0 ls0 ws75">betw<span class="_ _4"></span>een the in<span class="_ _4"></span>vocations and deﬁnitions. F<span class="_ _4"></span>inding a priv<span class="_ _4"></span>ate function should just be a matter</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 ws0">of scanning do<span class="_ _4"></span>wnward from the ﬁrst usage.</div><div class="t m0 xd h11 y13a2 ff1 fs7 fc0 sc0 ls0 ws0">G11:<span class="_ _4"></span> <span class="ff5">Inconsistency</span></div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws554">If you do something a certain w<span class="_ _4"></span>ay<span class="_ _0"></span>, do all similar things in the same wa<span class="_ _1"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>This goes back</div><div class="t m0 xd h14 y395 ff8 fs3 fc0 sc0 ls0 ws626">to <span class="_ _0"></span>the principle of least sur<span class="_ _8"></span>prise. Be careful with the con<span class="_ _4"></span>ventions y<span class="_ _4"></span>ou choose, and once</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">chosen, be careful to continue to follo<span class="_ _4"></span>w them. </div><div class="t m0 x74 h14 y397 ff8 fs3 fc0 sc0 ls0 ws743">If within a particular function you use a variab<span class="_ _4"></span>le named </div><div class="t m5 x58 h2f y397 ffb fs10 fc0 sc0 ls0 ws0">response</div><div class="t m0 x98 h14 y397 ff8 fs3 fc0 sc0 ls0 ws743">to hold an</div><div class="t m5 xd h2f y398 ffb fs10 fc0 sc0 ls0 ws0">HttpServletResponse</div><div class="t m0 x7b h14 y398 ff8 fs3 fc0 sc0 ls0 ws69a">, then use the same v<span class="_ _4"></span>ariable name consistentl<span class="_ _4"></span>y in the other functions</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws96">that use </div><div class="t m5 x9a h2f y399 ffb fs10 fc0 sc0 ls0 ws0">HttpServletResponse</div><div class="t m0 xcc h14 y399 ff8 fs3 fc0 sc0 ls0 ws96">objects. If you name a method </div><div class="t m5 x7f h2f y399 ffb fs10 fc0 sc0 ls0 ws0">processVerification<span class="_ _4"></span>Request</div><div class="t m0 x56 h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 wsa9">then use a similar name, such as </div><div class="t m5 x20 h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">processDeletionRequest</div><div class="t m0 xc2 h14 y3ca ff8 fs3 fc0 sc0 ls0 wsa9">, for the methods that process</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">other kinds of requests.</div><div class="t m0 x74 h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws2d2">Simple consistency lik<span class="_ _4"></span>e this, when reliabl<span class="_ _4"></span>y applied<span class="_ _1"></span>, can make code much easier to</div><div class="t m0 xd h14 y557 ff8 fs3 fc0 sc0 ls0 ws0">read and modify<span class="_ _0"></span>. </div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:480.728010px;width:76.279000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:208.728010px;width:95.953000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:332.728010px;width:121.662000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf144" class="pf w1 h2" data-page-no="144"><div class="pc pc144 w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg144.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">293<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">G12:<span class="_ _4"></span> <span class="ff5">Clutter</span></div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws111">Of what use is a default constructor with no implementation? <span class="_ _4"></span>All it serves to do is clutter</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws64e">up the code with meaningless artif<span class="_ _8"></span>acts. <span class="_ _4"></span>V<span class="_ _0"></span>ariab<span class="_ _4"></span>les that aren’<span class="_ _4"></span>t used<span class="_ _1"></span>, functions that are never</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws44b">called<span class="_ _1"></span>, comments that add no infor<span class="_ _8"></span>mation, and so for<span class="_ _8"></span>th. <span class="_ _1"></span>All these things are clutter and</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 lsc ws3f">should be remo<span class="_ _4"></span>ved. K<span class="_ _4"></span>eep your source ﬁles clean, w<span class="_ _1"></span>ell organized<span class="_ _1"></span>, and free of clutter<span class="_ _4"></span>.</div><div class="t m0 xd h11 y882 ff1 fs7 fc0 sc0 ls0 ws0">G13:<span class="_ _4"></span> <span class="ff5">Artiﬁcial Coupling</span></div><div class="t m0 xd h14 y29b ff8 fs3 fc0 sc0 ls0 ws610">Things that don’<span class="_ _1"></span>t depend upon each other should not be ar<span class="_ _8"></span>tiﬁcially coupled. F<span class="_ _1"></span>or example,</div><div class="t m0 xd h14 y251 ff8 fs3 fc0 sc0 ls0 ws0">general</div><div class="t m5 xc5 h2f y251 ffb fs10 fc0 sc0 ls0 ws0">enums</div><div class="t m0 x28 h14 y251 ff8 fs3 fc0 sc0 ls0 ws56a">should not be contained within more speciﬁc classes because this forces the</div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws744">whole application to kno<span class="_ _1"></span>w about these more speciﬁc classes. <span class="_ _4"></span>The same goes for general</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws0">pur<span class="_ _8"></span>pose </div><div class="t m5 x9a h2f y253 ffb fs10 fc0 sc0 ls0 ws0">static</div><div class="t m0 xe h14 y253 ff8 fs3 fc0 sc0 ls0 ws0"> functions being declared in speciﬁc classes.</div><div class="t m0 x74 h14 y4dd ff8 fs3 fc0 sc0 ls0 ws716">In general an artiﬁcial coupling is a coupling between tw<span class="_ _1"></span>o modules that ser<span class="_ _8"></span>ves no</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws3a4">direct pur<span class="_ _8"></span>pose. It is a result of putting a variab<span class="_ _4"></span>le, constant, or function in a temporarily</div><div class="t m0 xd h14 y256 ff8 fs3 fc0 sc0 ls0 ws0">con<span class="_ _4"></span>venient, though inappropriate, location. <span class="_ _1"></span>This is lazy and careless.</div><div class="t m0 x74 h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws745">T<span class="_ _0"></span>ake the time to ﬁgure out where functions, constants, and v<span class="_ _4"></span>ariables ought to be</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws261">declared. Don’<span class="_ _1"></span>t just toss them in the most conv<span class="_ _4"></span>enient place at hand and then leav<span class="_ _4"></span>e them</div><div class="t m0 xd h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws0">there.</div><div class="t m0 xd h11 y917 ff1 fs7 fc0 sc0 ls0 ws0">G14:<span class="_ _4"></span> <span class="ff5">F<span class="_ _2"></span>eature En<span class="_ _1"></span>vy</span></div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws23f">This is one of Martin F<span class="_ _4"></span>o<span class="_ _4"></span>wler’<span class="_ _2"></span>s code smells.</div><div class="t m0 xc4 h21 y283 ff8 fsc fc0 sc0 ls0 ws0">6</div><div class="t m0 x9d h14 ybfb ff8 fs3 fc0 sc0 ls0 ws23f">The methods of a class should be interested in</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls0 ws136">the v<span class="_ _4"></span>ariables and functions of the class they belong to, and not the v<span class="_ _4"></span>ariables and functions</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws746">of other classes. <span class="_ _4"></span>When a method uses accessors and mutators of some other object to</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls0 ws747">manipulate the data within that object, then it <span class="ffa ws0">en<span class="_ _4"></span>vies<span class="_ _16"> </span><span class="ff8 ws747">the scope of the class of that other</span></span></div><div class="t m0 xd h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws412">object. It wishes that it w<span class="_ _4"></span>ere inside that other class so that it could ha<span class="_ _4"></span>ve direct access to the</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">variab<span class="_ _4"></span>les it is manipulating. F<span class="_ _1"></span>or example:</div><div class="t m5 x74 h2f y828 ffb fs10 fc0 sc0 ls0 ws0">public class HourlyPayCalculator {</div><div class="t m5 x52 h2f y829 ffb fs10 fc0 sc0 ls0 ws0">public Money calculateWeeklyPay(HourlyEmployee e) {</div><div class="t m5 x8a h2f y82a ffb fs10 fc0 sc0 ls0 ws0">int tenthRate = e.getTenthRate().getPennies();</div><div class="t m5 x8a h2f y82b ffb fs10 fc0 sc0 ls0 ws0">int tenthsWorked = e.getTenthsWorked();</div><div class="t m5 x8a h2f y82c ffb fs10 fc0 sc0 ls0 ws0">int straightTime = Math.min(400, tenthsWorked);</div><div class="t m5 x8a h2f y13a3 ffb fs10 fc0 sc0 ls0 ws0">int overTime = Math.max(0, tenthsWorked - straightTime);</div><div class="t m5 x8a h2f y13a4 ffb fs10 fc0 sc0 ls0 ws0">int straightPay = straightTime * tenthRate;</div><div class="t m5 x8a h2f y13a5 ffb fs10 fc0 sc0 ls0 ws0">int overtimePay = (int)Math.round(overTime*tenthRate*1.5); </div><div class="t m5 x8a h2f y13a6 ffb fs10 fc0 sc0 ls0 ws0">return new Money(straightPay + overtimePay);</div><div class="t m5 x74 h2f y13a7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13a8 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x2b h2f y398 ffb fs10 fc0 sc0 ls0 ws0">calculateWeeklyPay</div><div class="t m0 xa h14 y398 ff8 fs3 fc0 sc0 ls0 ws6eb">method reaches into the </div><div class="t m5 x3d h2f y398 ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 x49 h14 y398 ff8 fs3 fc0 sc0 ls0 ws6eb">object to get the data on</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws3c7">which it operates. <span class="_ _1"></span>The </div><div class="t m5 x2e h2f y399 ffb fs10 fc0 sc0 ls0 ws0">calculateWeeklyPay</div><div class="t m0 xad h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">method<span class="_ _18"> </span><span class="ffa">envies<span class="_ _18"> </span></span><span class="ws3c7">the scope of </span></div><div class="t m5 x8d h2f y399 ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 xf0 h14 y399 ff8 fs3 fc0 sc0 ls0 ws3c7">. It</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">“wishes” that it could be inside </div><div class="t m5 xf6 h2f y3ca ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 x66 h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">6.<span class="_ _17"> </span>[Refactoring].</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:62.631000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:500.728010px;width:121.165000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:340.728010px;width:93.462000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf145" class="pf w1 h2" data-page-no="145"><div class="pc pc145 w1 h2"><img class="bi x37 y13a9 w8 h27" alt="" src="bg145.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">294<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls8a ws3e">All else being equal, w<span class="_ _4"></span>e want to eliminate F<span class="_ _1"></span>eature En<span class="_ _4"></span>vy because it exposes the internals</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls8a ws525">of one class to another<span class="_ _1"></span>. Sometimes, how<span class="_ _1"></span>ever<span class="_ _1"></span>, F<span class="_ _4"></span>eature En<span class="_ _4"></span>vy is a necessar<span class="_ _8"></span>y evil. Consider the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls8a ws0">follo<span class="_ _4"></span>wing:</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">public class HourlyEmployeeReport {</div><div class="t m5 x74 h2f y404 ffb fs10 fc0 sc0 ls0 ws0">  private HourlyEmployee employee ;</div><div class="t m5 x74 h2f y406 ffb fs10 fc0 sc0 ls0 ws0">  public HourlyEmployeeReport(HourlyEmployee e) {</div><div class="t m5 x74 h2f y407 ffb fs10 fc0 sc0 ls0 ws0">    this.employee = e;</div><div class="t m5 x74 h2f y73f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y741 ffb fs10 fc0 sc0 ls0 ws0">  String reportHours() {</div><div class="t m5 x74 h2f y742 ffb fs10 fc0 sc0 ls0 ws0">    return String.format(</div><div class="t m5 x74 h2f y743 ffb fs10 fc0 sc0 ls0 ws0">      &quot;Name: %s\tHours:%d.%1d\n&quot;,</div><div class="t m5 x74 h2f y744 ffb fs10 fc0 sc0 ls0 ws0">      employee.getName(), </div><div class="t m5 x74 h2f y745 ffb fs10 fc0 sc0 ls0 ws0">      employee.getTenthsWorked()/10,</div><div class="t m5 x74 h2f y746 ffb fs10 fc0 sc0 ls0 ws0">      employee.getTenthsWorked()%10);</div><div class="t m5 x74 h2f yb00 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yb01 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y40b ff8 fs3 fc0 sc0 ls0 ws748">Clearly<span class="_ _0"></span>, the </div><div class="t m5 xc3 h2f y40b ffb fs10 fc0 sc0 ls0 ws0">reportHours</div><div class="t m0 xf8 h14 y40b ff8 fs3 fc0 sc0 ls0 ws748">method en<span class="_ _4"></span>vies the </div><div class="t m5 x67 h2f y40b ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 x6a h14 y40b ff8 fs3 fc0 sc0 ls0 ws748">class. On the other hand<span class="_ _1"></span>, we</div><div class="t m0 xd h14 y40c ff8 fs3 fc0 sc0 ls0 ws1bb">don’<span class="_ _1"></span>t want </div><div class="t m5 x46 h2f y40c ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 xa4 h14 y40c ff8 fs3 fc0 sc0 ls0 ws1bb">to ha<span class="_ _4"></span>ve to kno<span class="_ _4"></span>w about the format of the repor<span class="_ _8"></span>t. Mo<span class="_ _4"></span>ving that for-</div><div class="t m0 xd h14 yb6f ff8 fs3 fc0 sc0 ls0 wsef">mat string into the </div><div class="t m5 x18 h2f yb6f ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 x81 h14 yb6f ff8 fs3 fc0 sc0 ls0 wsef"> class w<span class="_ _4"></span>ould violate sev<span class="_ _4"></span>eral principles of object oriented</div><div class="t m0 xd h14 y8ff ff8 fs3 fc0 sc0 ls0 ws0">design.</div><div class="t m0 x1a h21 y259 ff8 fsc fc0 sc0 ls0 ws0">7</div><div class="t m0 xc5 h14 y8ff ff8 fs3 fc0 sc0 ls48 ws6af"> It w<span class="_ _4"></span>ould couple </div><div class="t m5 xa h2f y8ff ffb fs10 fc0 sc0 ls0 ws0">HourlyEmployee</div><div class="t m0 x48 h14 y8ff ff8 fs3 fc0 sc0 ls11 ws24c"> to the format of the repor<span class="_ _8"></span>t, exposing it to changes</div><div class="t m0 xd h14 yb03 ff8 fs3 fc0 sc0 ls0 ws0">in that format.</div><div class="t m0 xd h11 y13aa ff1 fs7 fc0 sc0 ls0 ws0">G15:<span class="_ _4"></span> <span class="ff5 ws72a">Selector Arguments</span></div><div class="t m0 xd h14 y9be ff8 fs3 fc0 sc0 ls0 ws1f5">There is hardl<span class="_ _4"></span>y anything more abominab<span class="_ _4"></span>le than a dangling </div><div class="t m5 xf1 h2f y9be ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 xef h14 y9be ff8 fs3 fc0 sc0 ls0 ws1f5">argument at the end of a</div><div class="t m0 xd h14 y9bf ff8 fs3 fc0 sc0 ls0 ws519">function call. <span class="_ _4"></span>What does it mean? What w<span class="_ _1"></span>ould it change if it were </div><div class="t m5 x58 h2f y9bf ffb fs10 fc0 sc0 ls0 ws0">true</div><div class="t m0 x4a h14 y9bf ff8 fs3 fc0 sc0 ls0 ws519">? Not only is the</div><div class="t m0 xd h14 y454 ff8 fs3 fc0 sc0 ls0 ws6fe">pur<span class="_ _8"></span>pose of a selector argument dif<span class="_ _4"></span>ﬁcult to remember<span class="_ _4"></span>, each selector argument combines</div><div class="t m0 xd h14 y455 ff8 fs3 fc0 sc0 ls0 ws99">many functions into one. Selector ar<span class="_ _4"></span>guments are just a lazy wa<span class="_ _1"></span>y to av<span class="_ _4"></span>oid splitting a large</div><div class="t m0 xd h14 y456 ff8 fs3 fc0 sc0 ls0 ws0">function into sev<span class="_ _4"></span>eral smaller functions. Consider:</div><div class="t m5 x74 h2f y336 ffb fs10 fc0 sc0 ls14 ws253">  public int calculateWeeklyPay(boolean overtime) {</div><div class="t m5 x74 h2f y12e4 ffb fs10 fc0 sc0 ls0 ws0">    int tenthRate = getTenthRate();</div><div class="t m5 x74 h2f y12e5 ffb fs10 fc0 sc0 ls0 ws0">    int tenthsWorked = getTenthsWorked();</div><div class="t m5 x74 h2f y12e6 ffb fs10 fc0 sc0 ls0 ws0">    int straightTime = Math.min(400, tenthsWorked);</div><div class="t m5 x74 h2f y12e7 ffb fs10 fc0 sc0 ls0 ws0">    int overTime = Math.max(0, tenthsWorked - straightTime);</div><div class="t m5 x74 h2f y13ab ffb fs10 fc0 sc0 ls0 ws0">    int straightPay = straightTime * tenthRate;</div><div class="t m5 x74 h2f y12e8 ffb fs10 fc0 sc0 ls0 ws0">    double overtimeRate = overtime ? 1.5 : 1.0 * tenthRate;</div><div class="t m5 x74 h2f y12e9 ffb fs10 fc0 sc0 ls0 ws0">    int overtimePay = (int)Math.round(overTime*overtimeRate);</div><div class="t m5 x74 h2f y12ea ffb fs10 fc0 sc0 ls0 ws0">    return straightPay + overtimePay;</div><div class="t m5 x74 h2f y12eb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y6dc ff8 fs3 fc0 sc0 ls16 ws5dd">Y<span class="_ _3"></span>ou call this function with a </div><div class="t m5 xc h2f y6dc ffb fs10 fc0 sc0 ls31 ws0">true</div><div class="t m0 x33 h14 y6dc ff8 fs3 fc0 sc0 ls16 ws5dd">if o<span class="_ _4"></span>vertime is paid as time and a half, and with a</div><div class="t m5 xd h2f y6dd ffb fs10 fc0 sc0 ls31 ws0">false</div><div class="t m0 xfc h14 y6dd ff8 fs3 fc0 sc0 ls16 ws446">if o<span class="_ _4"></span>vertime is paid as straight time. It’<span class="_ _2"></span>s bad enough that you must remember w<span class="_ _4"></span>hat</div><div class="t m5 xd h2f y6de ffb fs10 fc0 sc0 ls31 ws0">calculateWeeklyPay(false)</div><div class="t m0 xfd h14 y6de ff8 fs3 fc0 sc0 ls16 ws749">means whene<span class="_ _4"></span>ver y<span class="_ _4"></span>ou happen to stumble across it. But the</div><div class="t m0 xd h25 yaff ff8 fse fc0 sc0 ls0 ws0">7.<span class="_ _17"> </span>Speciﬁcall<span class="_ _4"></span>y<span class="_ _1"></span>, the Single Responsibility Principle, the Open Closed Principle, and the Common Closure Principle. See [PPP].</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:324.728010px;width:124.673000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf146" class="pf w1 h2" data-page-no="146"><div class="pc pc146 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">295<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls16 ws37">real <span class="_ _0"></span>shame of a function like this is that the author missed the oppor<span class="_ _8"></span>tunity to write the</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls16 ws0">follo<span class="_ _4"></span>wing:</div><div class="t m5 x74 h2f y431 ffb fs10 fc0 sc0 ls14 ws235">  public int straightPay() {</div><div class="t m5 x74 h2f y432 ffb fs10 fc0 sc0 ls0 ws0">    return getTenthsWorked() * getTenthRate();</div><div class="t m5 x74 h2f y433 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f yae2 ffb fs10 fc0 sc0 ls0 ws0">  public int overTimePay() {</div><div class="t m5 x74 h2f yae3 ffb fs10 fc0 sc0 ls0 ws0">    int overTimeTenths = Math.max(0, getTenthsWorked() - 400);</div><div class="t m5 x74 h2f yae4 ffb fs10 fc0 sc0 ls0 ws0">    int overTimePay = overTimeBonus(overTimeTenths);</div><div class="t m5 x74 h2f yae5 ffb fs10 fc0 sc0 ls0 ws0">    return straightPay() + overTimePay;</div><div class="t m5 x74 h2f yb87 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y112e ffb fs10 fc0 sc0 ls0 ws0">  private int overTimeBonus(int overTimeTenths) {</div><div class="t m5 x74 h2f y112f ffb fs10 fc0 sc0 ls0 ws0">    double bonus = 0.5 * getTenthRate() * overTimeTenths;</div><div class="t m5 x74 h2f y1130 ffb fs10 fc0 sc0 ls0 ws0">    return (int) Math.round(bonus);</div><div class="t m5 x74 h2f y1131 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws41f">Of course, selectors need not be </div><div class="t m5 x32 h2f y9f5 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 x1b h14 y9f5 ff8 fs3 fc0 sc0 ls0 ws41f">. <span class="_ _1"></span>They can be enums, integers, or an<span class="_ _4"></span>y other</div><div class="t m0 xd h14 y564 ff8 fs3 fc0 sc0 ls0 ws3d4">type of argument that is used to select the beha<span class="_ _1"></span>vior of the function. In general it is better to</div><div class="t m0 xd h14 y9f6 ff8 fs3 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>ve man<span class="_ _4"></span>y functions than to pass some code into a function to select the behavior<span class="_ _0"></span>.</div><div class="t m0 xd h11 yec ff1 fs7 fc0 sc0 ls0 ws0">G16:<span class="_ _4"></span> <span class="ff5">Obscured Intent</span></div><div class="t m0 xd h14 y803 ff8 fs3 fc0 sc0 lsc ws57f">W<span class="_ _0"></span>e want code to be as e<span class="_ _4"></span>xpressiv<span class="_ _4"></span>e as possible. Run-on e<span class="_ _4"></span>xpressions, Hungarian notation,</div><div class="t m0 xd h14 y804 ff8 fs3 fc0 sc0 ls0 ws531">and magic numbers all obscure the author’<span class="_ _2"></span>s intent. F<span class="_ _4"></span>or example, here is the </div><div class="t m5 x63 h2f y804 ffb fs10 fc0 sc0 ls0 ws0">overTimePay</div><div class="t m0 xd h14 y13ac ff8 fs3 fc0 sc0 ls0 ws0">function as it might ha<span class="_ _4"></span>ve appeared:</div><div class="t m5 x74 h2f y9a5 ffb fs10 fc0 sc0 ls14 ws235">  public int m_otCalc() {</div><div class="t m5 x74 h2f y9a6 ffb fs10 fc0 sc0 ls0 ws0">    return iThsWkd * iThsRte +</div><div class="t m5 x74 h2f y9a7 ffb fs10 fc0 sc0 ls0 ws0">      (int) Math.round(0.5 * iThsRte *</div><div class="t m5 x74 h2f y9a8 ffb fs10 fc0 sc0 ls0 ws0">        Math.max(0, iThsWkd - 400)</div><div class="t m5 x74 h2f y9a9 ffb fs10 fc0 sc0 ls0 ws0">      );</div><div class="t m5 x74 h2f y13ad ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y5a0 ff8 fs3 fc0 sc0 ls0 ws111">Small and dense as this might appear<span class="_ _4"></span>, it’<span class="_ _2"></span>s also vir<span class="_ _8"></span>tuall<span class="_ _4"></span>y impenetrable. It is w<span class="_ _4"></span>orth tak-</div><div class="t m0 xd h14 y5a1 ff8 fs3 fc0 sc0 ls0 ws0">ing the time to make the intent of our code visib<span class="_ _4"></span>le to our readers.</div><div class="t m0 xd h11 y9ea ff1 fs7 fc0 sc0 ls0 ws0">G17:<span class="_ _4"></span> <span class="ff5">Misplaced Responsibility</span></div><div class="t m0 xd h14 y7c0 ff8 fs3 fc0 sc0 ls0 ws520">One of the most important decisions a software de<span class="_ _4"></span>veloper can make is w<span class="_ _4"></span>here to put code.</div><div class="t m0 xd h14 y13ae ff8 fs3 fc0 sc0 ls0 ws28c">F<span class="_ _1"></span>or example, where should the </div><div class="t m5 xa2 h2f y459 ffb fs10 fc0 sc0 ls0 ws0">PI</div><div class="t m0 x76 h14 y459 ff8 fs3 fc0 sc0 ls0 ws28c">constant go? Should it be in the </div><div class="t m5 x58 h2f y459 ffb fs10 fc0 sc0 ls0 ws0">Math</div><div class="t m0 x60 h14 y459 ff8 fs3 fc0 sc0 ls0 ws28c">class? P<span class="_ _4"></span>erhaps it</div><div class="t m0 xd h14 y45a ff8 fs3 fc0 sc0 ls0 ws0">belongs in the </div><div class="t m5 x86 h2f y45a ffb fs10 fc0 sc0 ls0 ws0">Trigonometry</div><div class="t m0 xc7 h14 y45a ff8 fs3 fc0 sc0 ls0 ws0"> class? Or ma<span class="_ _4"></span>ybe in the </div><div class="t m5 x7e h2f y45a ffb fs10 fc0 sc0 ls0 ws0">Circle</div><div class="t m0 x61 h14 y45a ff8 fs3 fc0 sc0 ls0 ws0"> class?</div><div class="t m0 x74 h14 y3af ff8 fs3 fc0 sc0 ls0 ws559">The principle of least sur<span class="_ _8"></span>prise comes into pla<span class="_ _4"></span>y here. Code should be placed where a</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 ws15b">reader w<span class="_ _4"></span>ould naturally e<span class="_ _4"></span>xpect it to be. <span class="_ _4"></span>The </div><div class="t m5 xad h2f yc00 ffb fs10 fc0 sc0 ls0 ws0">PI</div><div class="t m0 x65 h14 yc00 ff8 fs3 fc0 sc0 ls0 ws15b">constant should go where the trig functions</div><div class="t m0 xd h14 yde2 ff8 fs3 fc0 sc0 ls0 ws74a">are declared. <span class="_ _1"></span>The O<span class="_ _1"></span>VER<span class="_ _4"></span>TIME_RA<span class="_ _0"></span>TE constant should be declared in the </div><div class="t m5 x93 h2f yde2 ffb fs10 fc0 sc0 ls0 ws0">HourlyPay-</div><div class="t m5 xd h2f y13af ffb fs10 fc0 sc0 ls0 ws0">Calculator</div><div class="t m0 x5f h14 yb4c ff8 fs3 fc0 sc0 ls0 ws0"> class. </div><div class="t m0 x74 h14 y42f ff8 fs3 fc0 sc0 ls0 ws74b">Sometimes w<span class="_ _4"></span>e get “clev<span class="_ _4"></span>er” about where to put certain functionality<span class="_ _1"></span>. <span class="_ _4"></span>W<span class="_ _0"></span>e’ll put it in a</div><div class="t m0 xd h14 y5ce ff8 fs3 fc0 sc0 lsd ws438">function that’<span class="_ _2"></span>s con<span class="_ _4"></span>venient for us, but not necessaril<span class="_ _4"></span>y intuitiv<span class="_ _4"></span>e to the reader<span class="_ _4"></span>. F<span class="_ _4"></span>or example,</div><div class="t m0 xd h14 y85f ff8 fs3 fc0 sc0 ls0 ws292">perhaps w<span class="_ _4"></span>e need to print a repor<span class="_ _8"></span>t with the total of hours that an emplo<span class="_ _4"></span>yee w<span class="_ _1"></span>orked. W<span class="_ _2"></span>e</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:369.728010px;width:108.112000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:206.728010px;width:150.962000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf147" class="pf w1 h2" data-page-no="147"><div class="pc pc147 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">296<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws1f5">could sum up those hours in the code that prints the report, or we could try to keep a run-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">ning total in the code that accepts time cards. </div><div class="t m0 x74 h14 y1fa ff8 fs3 fc0 sc0 ls0 ws59a">One w<span class="_ _4"></span>ay to mak<span class="_ _4"></span>e this decision is to look at the names of the functions. Let’<span class="_ _2"></span>s say that</div><div class="t m0 xd h14 y1fb ff8 fs3 fc0 sc0 ls0 ws43f">our report module has a function named </div><div class="t m5 xe0 h2f y1fb ffb fs10 fc0 sc0 ls0 ws0">getTotalHours</div><div class="t m0 x27 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws43f">. Let’<span class="_ _2"></span>s also sa<span class="_ _4"></span>y that the module that</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws624">accepts time cards has a </div><div class="t m5 x6e h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">saveTimeCard</div><div class="t m0 x32 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws624">function. <span class="_ _4"></span>Which of these tw<span class="_ _4"></span>o functions, by it’<span class="_ _2"></span>s name,</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">implies that it calculates the total? <span class="_ _1"></span>The answ<span class="_ _4"></span>er should be obvious.</div><div class="t m0 x74 h14 y205 ff8 fs3 fc0 sc0 ls0 ws74c">Clearl<span class="_ _4"></span>y<span class="_ _1"></span>, there are sometimes perfor<span class="_ _8"></span>mance reasons wh<span class="_ _4"></span>y the total should be calculated</div><div class="t m0 xd h14 y206 ff8 fs3 fc0 sc0 lsd ws67a">as time cards are accepted rather than when the report is printed. <span class="_ _1"></span>That’<span class="_ _0"></span>s ﬁne, but the names</div><div class="t m0 xd h14 y207 ff8 fs3 fc0 sc0 ls0 ws74d">of the functions ought to reﬂect this. F<span class="_ _1"></span>or example, there should be a </div><div class="t m5 xa7 h2f y207 ffb fs10 fc0 sc0 ls0 ws0">computeRunning-</div><div class="t m5 xd h2f y5b1 ffb fs10 fc0 sc0 ls0 ws0">TotalOfHours</div><div class="t m0 x41 h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0"> function in the timecard module. </div><div class="t m0 xd h11 y847 ff1 fs7 fc0 sc0 ls0 ws0">G18:<span class="_ _4"></span> <span class="ff5">Inappropriate Static</span></div><div class="t m5 xd h2f y329 ffb fs10 fc0 sc0 ls66 ws74e">Math.max(double a,<span class="_ _16"> </span>double b)</div><div class="t m0 xa2 h14 y329 ff8 fs3 fc0 sc0 ls34 ws5ad">is a good static method. It does not operate on a single</div><div class="t m0 xd h14 y32a ff8 fs3 fc0 sc0 ls34 ws74f">instance; indeed<span class="_ _1"></span>, it w<span class="_ _4"></span>ould be silly to ha<span class="_ _4"></span>ve to sa<span class="_ _4"></span>y </div><div class="t m5 x3c h2f y5bd ffb fs10 fc0 sc0 ls66 ws0">new<span class="_ _16"> </span>Math().max(a,b)</div><div class="t m0 x8d h14 y5bd ff8 fs3 fc0 sc0 ls34 ws74f">or ev<span class="_ _4"></span>en </div><div class="t m5 x99 h2f y5bd ffb fs10 fc0 sc0 ls66 ws0">a.max(b)</div><div class="t m0 x56 h14 y5bd ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y5be ff8 fs3 fc0 sc0 ls34 ws109">All the data that </div><div class="t m5 x87 h2f y5be ffb fs10 fc0 sc0 ls66 ws0">max</div><div class="t m0 xed h14 y5be ff8 fs3 fc0 sc0 ls34 ws109">uses comes from its tw<span class="_ _4"></span>o arguments, and not from an<span class="_ _4"></span>y “o<span class="_ _4"></span>wning”</div><div class="t m0 xd h14 y5bf ff8 fs3 fc0 sc0 ls34 ws398">object. More to the point, there is almost <span class="ffa">no chance </span>that w<span class="_ _1"></span>e’<span class="_ _2"></span>d want </div><div class="t m5 x6f h2f y5bf ffb fs10 fc0 sc0 ls66 ws0">Math.max</div><div class="t m0 xd8 h14 y5bf ff8 fs3 fc0 sc0 ls34 ws398">to be</div><div class="t m0 xd h14 y5d3 ff8 fs3 fc0 sc0 ls34 ws0">polymorphic.</div><div class="t m0 x74 h14 y5c1 ff8 fs3 fc0 sc0 ls0 ws5c1">Sometimes, ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, w<span class="_ _1"></span>e write static functions that should not be static. F<span class="_ _4"></span>or example,</div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls0 ws0">consider:</div><div class="t m5 x74 h2f yecb ffb fs10 fc0 sc0 ls0 ws0">HourlyPayCalculator.calculatePay(employee, overtimeRate). </div><div class="t m0 xd h14 y468 ff8 fs3 fc0 sc0 lsc wsc9">Again, this seems like a reasonab<span class="_ _4"></span>le </div><div class="t m5 xfe h2f y468 ffb fs10 fc0 sc0 ls0 ws0">static</div><div class="t m0 x9d h14 y468 ff8 fs3 fc0 sc0 ls0 ws184">function. It doesn’<span class="_ _1"></span>t operate on any particular</div><div class="t m0 xd h14 y469 ff8 fs3 fc0 sc0 ls11 ws225">object and gets all it’<span class="_ _2"></span>s data from it’<span class="_ _2"></span>s arguments. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, there is a reasonable chance that</div><div class="t m0 xd h14 y46a ff8 fs3 fc0 sc0 ls0 ws2c">w<span class="_ _4"></span>e’<span class="_ _4"></span>ll want this function to be pol<span class="_ _4"></span>ymor<span class="_ _8"></span>phic. W<span class="_ _2"></span>e may wish to implement se<span class="_ _4"></span>veral dif<span class="_ _4"></span>ferent</div><div class="t m0 xd h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws750">algorithms for calculating hourl<span class="_ _4"></span>y pay<span class="_ _0"></span>, for example, </div><div class="t m5 xe3 h2f y3a9 ffb fs10 fc0 sc0 ls18 ws0">OvertimeHourlyPayCalculator</div><div class="t m0 x8c h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 xd h2f y3aa ffb fs10 fc0 sc0 ls0 ws0">StraightTimeHourlyPayCalculator</div><div class="t m0 x8 h14 y3aa ff8 fs3 fc0 sc0 ls0 ws751">. So in this case the function should not be static. It</div><div class="t m0 xd h14 y3ab ff8 fs3 fc0 sc0 ls0 ws0">should be a nonstatic member function of </div><div class="t m5 xdd h2f y3ab ffb fs10 fc0 sc0 ls0 ws0">Employee</div><div class="t m0 x4f h14 y3ab ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 yd2e ff8 fs3 fc0 sc0 ls0 ws752">In general you should prefer nonstatic methods to static methods. <span class="_ _1"></span>When in doubt,</div><div class="t m0 xd h14 y2f8 ff8 fs3 fc0 sc0 ls0 ws56">make the function nonstatic. If y<span class="_ _4"></span>ou really w<span class="_ _4"></span>ant a function to be static, make sure that there</div><div class="t m0 xd h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws0">is no chance that you’<span class="_ _1"></span>ll want it to beha<span class="_ _4"></span>ve pol<span class="_ _4"></span>ymor<span class="_ _8"></span>phically<span class="_ _0"></span>.</div><div class="t m0 xd h11 y10e8 ff1 fs7 fc0 sc0 ls0 ws0">G19:<span class="_ _4"></span> <span class="ff5">Use Explanatory <span class="_ _0"></span>V<span class="_ _3"></span>ariables</span></div><div class="t m0 xd h14 y585 ff8 fs3 fc0 sc0 ls0 ws36c">K<span class="_ _4"></span>ent Beck wrote about this in his g<span class="_ _8"></span>reat book <span class="ffa">Smalltalk Best Pr<span class="_ _4"></span>actice P<span class="_ _1"></span>atterns</span></div><div class="t m0 x70 h21 y6da ff8 fsc fc0 sc0 ls0 ws0">8</div><div class="t m0 xda h14 y585 ff8 fs3 fc0 sc0 ls52 ws20f">and again</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc0 sc0 ls0 wsef">more recently in his equall<span class="_ _1"></span>y g<span class="_ _8"></span>reat book <span class="ffa">Implementation P<span class="_ _1"></span>atterns<span class="ff8 ws0">.</span></span></div><div class="t m0 xa0 h21 y6db ff8 fsc fc0 sc0 ls0 ws0">9</div><div class="t m0 xef h14 y3e5 ff8 fs3 fc0 sc0 ls0 wsef"> One of the more po<span class="_ _4"></span>w<span class="_ _4"></span>er-</div><div class="t m0 xd h14 y3e6 ff8 fs3 fc0 sc0 ls0 ws57b">ful wa<span class="_ _1"></span>ys to make a program readable is to break the calculations up into intermediate v<span class="_ _4"></span>al-</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 ws0">ues that are held in variab<span class="_ _4"></span>les with meaningful names. </div><div class="t m0 xd h25 y13b0 ff8 fse fc0 sc0 ls0 ws0">8.<span class="_ _17"> </span>[Beck97], p. 108.</div><div class="t m0 xd h25 y13b1 ff8 fse fc0 sc0 ls0 ws0">9.<span class="_ _17"> </span>[Beck07].</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:441.728010px;width:127.456000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:185.728010px;width:158.479000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf148" class="pf w1 h2" data-page-no="148"><div class="pc pc148 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">297<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Consider this example from F<span class="_ _4"></span>itNesse:</div><div class="t m5 x6c h2f ya7a ffb fs10 fc0 sc0 ls0 ws0">Matcher match = headerPattern.matcher(line);</div><div class="t m5 x6c h2f yee0 ffb fs10 fc0 sc0 ls0 ws0">if(match.find())</div><div class="t m5 x6c h2f yee1 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x6c h2f yee2 ffb fs10 fc0 sc0 ls14 ws235">  String key = match.group(1);</div><div class="t m5 x6c h2f yee3 ffb fs10 fc0 sc0 ls14 ws235">  String value = match.group(2);</div><div class="t m5 x6c h2f yee4 ffb fs10 fc0 sc0 ls14 ws2f1">  headers.put(key.toLowerCase(), value);</div><div class="t m5 x6c h2f yee5 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y19b ff8 fs3 fc0 sc0 ls0 ws130">The simple use of explanatory variab<span class="_ _4"></span>les makes it clear that the ﬁrst matched group is</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">the <span class="ffa">key<span class="_ _1"></span>,<span class="ff8"> and the second matched g<span class="_ _8"></span>roup is the </span>value<span class="ff8">.</span></span></div><div class="t m0 x74 h14 y1fc ff8 fs3 fc0 sc0 ls11 ws225">It is hard to o<span class="_ _4"></span>verdo this. More e<span class="_ _4"></span>xplanator<span class="_ _8"></span>y variab<span class="_ _4"></span>les are generally better than fe<span class="_ _4"></span>w<span class="_ _4"></span>er<span class="_ _4"></span>. It</div><div class="t m0 xd h14 y208 ff8 fs3 fc0 sc0 ls0 ws2e9">is remarkable ho<span class="_ _1"></span>w an opaque module can suddenly become transparent simpl<span class="_ _4"></span>y by break-</div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws0">ing the calculations up into w<span class="_ _4"></span>ell-named inter<span class="_ _8"></span>mediate values.</div><div class="t m0 xd h11 yc69 ff1 fs7 fc0 sc0 ls0 ws0">G20:<span class="_ _4"></span> <span class="ff5">Function Names Should Say <span class="_ _0"></span>What <span class="_ _1"></span>They Do</span></div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 ws0">Look at this code:</div><div class="t m5 x74 h2f y5df ffb fs10 fc0 sc0 ls0 ws0">Date newDate = date.add(5); </div><div class="t m0 xd h14 y259 ff8 fs3 fc0 sc0 ls0 ws3a1">W<span class="_ _0"></span>ould you e<span class="_ _4"></span>xpect this to add ﬁve da<span class="_ _4"></span>ys to the date? Or is it w<span class="_ _4"></span>eeks, or hours? Is the </div><div class="t m5 xbf h2f y259 ffb fs10 fc0 sc0 ls0 ws0">date</div><div class="t m0 xd h14 y29d ff8 fs3 fc0 sc0 ls0 ws82">instance changed or does the function just return a new </div><div class="t m5 xb7 h2f y29d ffb fs10 fc0 sc0 ls0 ws0">Date</div><div class="t m0 x21 h14 y29d ff8 fs3 fc0 sc0 ls0 ws82">without changing the old one?</div><div class="t m0 xd h14 y29e ffa fs3 fc0 sc0 ls0 ws0">Y<span class="_ _0"></span>ou can’<span class="_ _1"></span>t tell fr<span class="_ _4"></span>om the call what the function does<span class="ff8">.</span></div><div class="t m0 x74 h14 y25c ff8 fs3 fc0 sc0 ls0 ws74f">If the function adds ﬁve da<span class="_ _1"></span>ys to the date and changes the date, then it should be called</div><div class="t m5 xd h2f yd99 ffb fs10 fc0 sc0 ls0 ws0">addDaysTo</div><div class="t m0 x80 h14 yd99 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 x6d h2f yd99 ffb fs10 fc0 sc0 ls0 ws0">increaseByDays</div><div class="t m0 xfd h14 yd99 ff8 fs3 fc0 sc0 ls0 ws318">. If, on the other hand<span class="_ _1"></span>, the function retur<span class="_ _8"></span>ns a new date that is</div><div class="t m0 xd h14 y372 ff8 fs3 fc0 sc0 lsd ws555">ﬁve da<span class="_ _1"></span>ys later but does not change the date instance, it should be called </div><div class="t m5 xf4 h2f y372 ffb fs10 fc0 sc0 ls0 ws0">daysLater</div><div class="t m0 x1d h14 y372 ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 xd h2f y373 ffb fs10 fc0 sc0 ls0 ws0">daysSince</div><div class="t m0 x8a h14 y373 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y48d ff8 fs3 fc0 sc0 ls0 ws732">If you ha<span class="_ _1"></span>ve to look at the implementation (or documentation) of the function to kno<span class="_ _4"></span>w</div><div class="t m0 xd h14 y48e ff8 fs3 fc0 sc0 ls0 ws753">what it does, then y<span class="_ _4"></span>ou should w<span class="_ _4"></span>ork to ﬁnd a better name or rear<span class="_ _8"></span>range the functionality so</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws0">that it can be placed in functions with better names.</div><div class="t m0 xd h11 y13b2 ff1 fs7 fc0 sc0 ls0 ws0">G21:<span class="_ _4"></span> <span class="ff5">Understand the Algorithm</span></div><div class="t m0 xd h14 y2e5 ff8 fs3 fc0 sc0 ls0 ws4f3">Lots of very funny code is written because people don’<span class="_ _1"></span>t take the time to understand the</div><div class="t m0 xd h14 y2e6 ff8 fs3 fc0 sc0 ls0 ws72">algorithm. <span class="_ _1"></span>They get something to w<span class="_ _4"></span>ork by plugging in enough </div><div class="t m5 xef h2f yc1c ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x73 h14 yc1c ff8 fs3 fc0 sc0 ls0 ws72">statements and ﬂags,</div><div class="t m0 xd h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws0">without really stopping to consider w<span class="_ _4"></span>hat is reall<span class="_ _4"></span>y going on. </div><div class="t m0 x74 h14 y7fb ff8 fs3 fc0 sc0 ls0 ws617">Programming is often an exploration. <span class="_ _0"></span>Y<span class="_ _3"></span>ou <span class="ffa ws0">think<span class="_ _31"> </span></span>you kno<span class="_ _1"></span>w the right algorithm for</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 lsd ws2ba">something, but then you wind up ﬁddling with it, prodding and poking at it, until y<span class="_ _4"></span>ou get it</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws65a">to “w<span class="_ _4"></span>ork.<span class="_ _1"></span>” Ho<span class="_ _4"></span>w do you kno<span class="_ _4"></span>w it “w<span class="_ _4"></span>orks”? Because it passes the test cases you can think of.</div><div class="t m0 x74 h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws3f6">There is nothing wrong with this approach. Indeed<span class="_ _1"></span>, often it is the only w<span class="_ _4"></span>a<span class="_ _4"></span>y to get a</div><div class="t m0 xd h14 ybf8 ff8 fs3 fc0 sc0 ls0 ws22d">function to do what y<span class="_ _4"></span>ou think it should. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>, it is not sufﬁcient to lea<span class="_ _1"></span>ve the quotation</div><div class="t m0 xd h14 y73c ff8 fs3 fc0 sc0 ls0 ws0">marks around the w<span class="_ _4"></span>ord “w<span class="_ _4"></span>ork.<span class="_ _1"></span>” </div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:422.728010px;width:243.646000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:231.728010px;width:157.804000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf149" class="pf w1 h2" data-page-no="149"><div class="pc pc149 w1 h2"><img class="bi xd y3e9 wc hb7" alt="" src="bg149.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">298<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws220">Before you consider y<span class="_ _4"></span>ourself to be done with a function, make sure y<span class="_ _4"></span>ou <span class="ffa ws0">understand</span></div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws754">ho<span class="_ _4"></span>w it w<span class="_ _4"></span>orks. It is not good enough that it passes all the tests. <span class="_ _0"></span>Y<span class="_ _2"></span>ou must <span class="ffa ws0">know</span></div><div class="t m0 xda h21 y13b3 ff8 fsc fc0 sc0 ls0 ws0">10</div><div class="t m0 x64 h14 y195 ff8 fs3 fc0 sc0 ls0 ws754">that the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">solution is cor<span class="_ _8"></span>rect. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 lsc ws47a">Often the best wa<span class="_ _1"></span>y to gain this kno<span class="_ _4"></span>wledge and understanding is to ref<span class="_ _8"></span>actor the func-</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">tion into something that is so clean and expressi<span class="_ _4"></span>ve that it is <span class="ffa">obvious</span> ho<span class="_ _1"></span>w it works.</div><div class="t m0 xd h11 y13b4 ff1 fs7 fc0 sc0 ls0 ws0">G22:<span class="_ _4"></span> <span class="ff5">Make Logical Dependencies Ph<span class="_ _4"></span>ysical</span></div><div class="t m0 xd h14 y2a9 ff8 fs3 fc0 sc0 ls0 ws4b9">If one module depends upon another<span class="_ _4"></span>, that dependency should be ph<span class="_ _4"></span>ysical, not just logical.</div><div class="t m0 xd h14 y2aa ff8 fs3 fc0 sc0 ls0 ws691">The dependent module should not make assumptions (in other w<span class="_ _1"></span>ords, logical dependen-</div><div class="t m0 xd h14 y2ab ff8 fs3 fc0 sc0 ls0 ws2fc">cies) about the module it depends upon. Rather it should explicitl<span class="_ _4"></span>y ask that module for all</div><div class="t m0 xd h14 y570 ff8 fs3 fc0 sc0 ls0 ws0">the information it depends upon.</div><div class="t m0 x74 h14 y2ad ff8 fs3 fc0 sc0 ls0 ws755">F<span class="_ _1"></span>or example, imagine that you are writing a function that prints a plain te<span class="_ _4"></span>xt repor<span class="_ _8"></span>t of</div><div class="t m0 xd h14 y2ae ff8 fs3 fc0 sc0 ls0 ws5b2">hours w<span class="_ _4"></span>orked b<span class="_ _4"></span>y emplo<span class="_ _4"></span>yees. One class named </div><div class="t m5 xcf h2f y72f ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 x55 h14 y72f ff8 fs3 fc0 sc0 ls22 ws69">gathers all the data into a</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls0 wsbc">con<span class="_ _4"></span>venient form and then passes it to </div><div class="t m5 x9c h2f y5d2 ffb fs10 fc0 sc0 ls0 ws0">HourlyReportFormatter</div><div class="t m0 x6a h14 y5d2 ff8 fs3 fc0 sc0 ls0 wsbc">to print it. (See Listing 17-1.)</div><div class="t m0 xd h25 y39a ff8 fse fc0 sc0 ls0 ws756">10.<span class="_ _16"> </span>There is a dif<span class="_ _4"></span>ference between kno<span class="_ _4"></span>wing how the code w<span class="_ _4"></span>orks and kno<span class="_ _4"></span>wing whether the algorithm will do the job required of it. </div><div class="t m0 x3b h25 y39b ff8 fse fc0 sc0 ls0 ws0">Being unsure that an algorithm is appropriate is often a fact of life. Being unsure what your code does is just laziness.</div><div class="t m0 x74 h1c y40d ff1 fs3 fc0 sc0 ls0 ws0">Listing 17-1 </div><div class="t m0 x74 h36 y13b5 ffc fs3 fc0 sc0 ls0 ws0">HourlyReporter.java</div><div class="t m5 x74 h2f y610 ffb fs10 fc0 sc0 ls0 ws0">public class HourlyReporter {</div><div class="t m5 x74 h2f y611 ffb fs10 fc0 sc0 ls0 ws0">  private HourlyReportFormatter formatter;</div><div class="t m5 x74 h2f y612 ffb fs10 fc0 sc0 ls0 ws0">  private List&lt;LineItem&gt; page;</div><div class="t m5 x74 h2f y613 ffb fs10 fc0 sc0 ls0 ws0">  private final int PAGE_SIZE = 55;</div><div class="t m5 x74 h2f y615 ffb fs10 fc0 sc0 ls0 ws0">  public HourlyReporter(HourlyReportFormatter formatter) {</div><div class="t m5 x74 h2f y616 ffb fs10 fc0 sc0 ls0 ws0">    this.formatter = formatter;</div><div class="t m5 x74 h2f y617 ffb fs10 fc0 sc0 ls0 ws0">    page = new ArrayList&lt;LineItem&gt;();</div><div class="t m5 x74 h2f y618 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y61a ffb fs10 fc0 sc0 ls0 ws0">  public void generateReport(List&lt;HourlyEmployee&gt; employees) {</div><div class="t m5 x74 h2f y61b ffb fs10 fc0 sc0 ls0 ws0">    for (HourlyEmployee e : employees) {</div><div class="t m5 x74 h2f y61c ffb fs10 fc0 sc0 ls0 ws0">      addLineItemToPage(e);</div><div class="t m5 x74 h2f y61d ffb fs10 fc0 sc0 ls0 ws0">      if (page.size() == PAGE_SIZE)</div><div class="t m5 x74 h2f y13b6 ffb fs10 fc0 sc0 ls0 ws0">        printAndClearItemList();</div><div class="t m5 x74 h2f y13b7 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y13b8 ffb fs10 fc0 sc0 ls0 ws0">    if (page.size() &gt; 0)</div><div class="t m5 x74 h2f y13b9 ffb fs10 fc0 sc0 ls0 ws0">      printAndClearItemList();</div><div class="t m5 x74 h2f y13ba ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13bb ffb fs10 fc0 sc0 ls0 ws0">  private void printAndClearItemList() {</div><div class="t m5 x74 h2f y13bc ffb fs10 fc0 sc0 ls0 ws0">    formatter.format(page);</div><div class="t m5 x74 h2f y13bd ffb fs10 fc0 sc0 ls0 ws0">    page.clear();</div><div class="t m5 x74 h2f y13be ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13bf ffb fs10 fc0 sc0 ls0 ws0">  private void addLineItemToPage(HourlyEmployee e) {</div><div class="t m5 x74 h2f y13c0 ffb fs10 fc0 sc0 ls0 ws0">    LineItem item = new LineItem();</div><div class="t m5 x74 h2f y13c1 ffb fs10 fc0 sc0 ls0 ws0">    item.name = e.getName();</div><div class="t m5 x74 h2f y13c2 ffb fs10 fc0 sc0 ls0 ws0">    item.hours = e.getTenthsWorked() / 10;</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:507.728010px;width:212.398000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14a" class="pf w1 h2" data-page-no="14a"><div class="pc pc14a w1 h2"><img class="bi xd y13c3 wc hb8" alt="" src="bg14a.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">299<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 x74 h14 ybdc ff8 fs3 fc0 sc0 ls0 ws4a5">This code has a logical dependenc<span class="_ _4"></span>y that has not been ph<span class="_ _4"></span>ysicalized. Can you spot it? It</div><div class="t m0 xd h14 y10aa ff8 fs3 fc0 sc0 ls0 ws3ba">is the constant </div><div class="t m5 xe h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">PAGE_SIZE</div><div class="t m0 xa h14 y3b7 ff8 fs3 fc0 sc0 ls0 ws3ba">. <span class="_ _4"></span>Why should the </div><div class="t m5 xb8 h2f y3b7 ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 x89 h14 y3b7 ff8 fs3 fc0 sc0 ls2b ws23e"> kno<span class="_ _4"></span>w the size of the page? Page</div><div class="t m0 xd h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">size should be the responsibility of the </div><div class="t m5 x5c h2f y4dd ffb fs10 fc0 sc0 ls0 ws0">HourlyReportFormatter</div><div class="t m0 xe8 h14 y4dd ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y4de ff8 fs3 fc0 sc0 ls0 ws757">The fact that P<span class="_ _0"></span>A<span class="_ _1"></span>GE_SIZE is declared in </div><div class="t m5 x3d h2f y4de ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 xb5 h14 y4de ff8 fs3 fc0 sc0 ls0 ws757">represents a misplaced</div><div class="t m0 xd h14 y4df ff8 fs3 fc0 sc0 ls0 wsaf">responsibility [G17] that causes </div><div class="t m5 x1c h2f y4df ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 xcf h14 y4df ff8 fs3 fc0 sc0 ls0 wsaf">to assume that it kno<span class="_ _4"></span>ws what the page size</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws115">ought to be. Such an assumption is a logical dependenc<span class="_ _4"></span>y<span class="_ _0"></span>. </div><div class="t m5 xc2 h2f y4e0 ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 xa9 h14 y4e0 ff8 fs3 fc0 sc0 ls0 ws115">depends on the</div><div class="t m0 xd h14 y4e1 ff8 fs3 fc0 sc0 ls0 ws23e">fact that </div><div class="t m5 x9a h2f y4e1 ffb fs10 fc0 sc0 ls0 ws0">HourlyReportFormatter</div><div class="t m0 x84 h14 y4e1 ff8 fs3 fc0 sc0 ls11 ws758"> can deal with page sizes of 55. If some implementation of</div><div class="t m5 xd h2f y4e2 ffb fs10 fc0 sc0 ls0 ws0">HourlyReportFormatter</div><div class="t m0 x4 h14 y4e2 ff8 fs3 fc0 sc0 ls0 ws0"> could not deal with such sizes, then there w<span class="_ _4"></span>ould be an er<span class="_ _8"></span>ror<span class="_ _4"></span>.</div><div class="t m0 x74 h14 y2a ff8 fs3 fc0 sc0 ls0 ws759">W<span class="_ _0"></span>e can ph<span class="_ _4"></span>ysicalize this dependency by creating a ne<span class="_ _1"></span>w method in </div><div class="t m5 xbb h2f y2a ffb fs10 fc0 sc0 ls0 ws0">HourlyReport-</div><div class="t m5 xd h2f y13c4 ffb fs10 fc0 sc0 ls0 ws0">Formatter</div><div class="t m0 x80 h14 yb1e ff8 fs3 fc0 sc0 ls0 ws0">named</div><div class="t m5 x6 h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">getMaxPageSize()</div><div class="t m0 x76 h14 yb1e ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x77 h2f yb1e ffb fs10 fc0 sc0 ls0 ws0">HourlyReporter</div><div class="t m0 xea h14 yb1e ff8 fs3 fc0 sc0 ls0 ws214">will then call that function rather than</div><div class="t m0 xd h14 yb1f ff8 fs3 fc0 sc0 ls0 ws0">using the </div><div class="t m5 x8a h2f yb1f ffb fs10 fc0 sc0 ls0 ws0">PAGE_SIZE</div><div class="t m0 x4d h14 yb1f ff8 fs3 fc0 sc0 ls0 ws0"> constant.</div><div class="t m0 xd h11 y13c5 ff1 fs7 fc0 sc0 ls0 ws0">G23:<span class="_ _4"></span> <span class="ff5">Pref<span class="_ _4"></span>er P<span class="_ _1"></span>olymorphism to If/Else or Switch/Case</span></div><div class="t m0 xd h14 ybfe ff8 fs3 fc0 sc0 ls10 ws5d8">This might seem a strange suggestion gi<span class="_ _4"></span>ven the topic of Chapter 6. <span class="_ _4"></span>After all, in that chapter I</div><div class="t m0 xd h14 y57e ff8 fs3 fc0 sc0 ls10 ws75a">make the point that s<span class="_ _4"></span>witch statements are probabl<span class="_ _4"></span>y appropriate in the par<span class="_ _8"></span>ts of the system</div><div class="t m0 xd h14 y57f ff8 fs3 fc0 sc0 ls10 ws0">where adding ne<span class="_ _4"></span>w functions is more likel<span class="_ _4"></span>y than <span class="ws4e9">adding ne<span class="ls8b ws3eb">w types.</span></span></div><div class="t m0 x74 h14 ydde ff8 fs3 fc0 sc0 ls0 ws1f7">First, most people use s<span class="_ _4"></span>witch statements because it’<span class="_ _2"></span>s the obvious brute force solution,</div><div class="t m0 xd h14 yddf ff8 fs3 fc0 sc0 ls0 ws75b">not because it’<span class="_ _2"></span>s the right solution for the situation. So this heuristic is here to remind us to</div><div class="t m0 xd h14 yeb9 ff8 fs3 fc0 sc0 ls0 ws0">consider pol<span class="_ _4"></span>ymor<span class="_ _8"></span>phism before using a switch. </div><div class="t m0 x74 h14 yde1 ff8 fs3 fc0 sc0 ls0 ws497">Second<span class="_ _1"></span>, the cases where functions are more v<span class="_ _4"></span>olatile than types are relativel<span class="_ _4"></span>y rare. So</div><div class="t m0 xd h14 y751 ffa fs3 fc0 sc0 ls0 ws0">every<span class="ff8"> s<span class="_ _4"></span>witch statement should be suspect. </span></div><div class="t m0 x74 h14 yf76 ff8 fs3 fc0 sc0 ls0 ws4c1">I use the follo<span class="_ _4"></span>wing “O</div><div class="t m0 xa4 h14 y395 ff8 fsb fc0 sc0 ls0 ws0">NE<span class="fs3 ls8c"> S</span>WITCH<span class="fs3 ws4c1">” rule: <span class="_ _1"></span><span class="ffa">There may be no mor<span class="_ _1"></span>e than one switch state-</span></span></div><div class="t m0 xd h1d y396 ffa fs3 fc0 sc0 ls0 ws75c">ment for a given type of selection. <span class="_ _0"></span>The cases in that switch statement must cr<span class="_ _4"></span>eate polymor-</div><div class="t m0 xd h1d y43d ffa fs3 fc0 sc0 ls0 ws0">phic objects that take the place of other such switc<span class="_ _4"></span>h statements in the rest of the system.</div><div class="t m0 xd h11 yb4b ff1 fs7 fc0 sc0 ls0 ws0">G24:<span class="_ _4"></span> <span class="ff5">F<span class="_ _2"></span>ollo<span class="_ _4"></span>w Standard Con<span class="_ _4"></span>ventions</span></div><div class="t m0 xd h14 y555 ff8 fs3 fc0 sc0 ls0 ws130">Every team should follo<span class="_ _4"></span>w a coding standard based on common industr<span class="_ _8"></span>y norms. <span class="_ _4"></span>This cod-</div><div class="t m0 xd h14 y13c6 ff8 fs3 fc0 sc0 ls0 ws259">ing standard should specify things like w<span class="_ _4"></span>here to declare instance variab<span class="_ _4"></span>les; ho<span class="_ _4"></span>w to name</div><div class="t m0 xd h14 y13c7 ff8 fs3 fc0 sc0 ls0 ws1ad">classes, methods, and v<span class="_ _4"></span>ariables; where to put braces; and so on. <span class="_ _1"></span>The team should not need</div><div class="t m0 xd h14 y13c8 ff8 fs3 fc0 sc0 ls0 ws0">a document to describe these con<span class="_ _4"></span>ventions because their code pro<span class="_ _1"></span>vides the examples.</div><div class="t m5 x74 h2f ya5e ffb fs10 fc0 sc0 ls0 ws0">    item.tenths = e.getTenthsWorked() % 10;</div><div class="t m5 x74 h2f ya5f ffb fs10 fc0 sc0 ls0 ws0">    page.add(item);</div><div class="t m5 x74 h2f y13c9 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13ca ffb fs10 fc0 sc0 ls0 ws0">  public class LineItem {</div><div class="t m5 x74 h2f ya62 ffb fs10 fc0 sc0 ls0 ws0">    public String name;</div><div class="t m5 x74 h2f ya63 ffb fs10 fc0 sc0 ls0 ws0">    public int hours;</div><div class="t m5 x74 h2f ya64 ffb fs10 fc0 sc0 ls0 ws0">    public int tenths;</div><div class="t m5 x74 h2f ya65 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13cb ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">Listing 17-1 (continued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">HourlyReporter.java</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:301.728010px;width:259.052000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:126.728010px;width:173.423000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14b" class="pf w1 h2" data-page-no="14b"><div class="pc pc14b w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">300<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc0 sc0 ls0 ws75d">Everyone on the team should follo<span class="_ _1"></span>w these conv<span class="_ _4"></span>entions. <span class="_ _4"></span>This means that each team</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws75e">member must be mature enough to realize that it doesn’<span class="_ _1"></span>t matter a whit where y<span class="_ _4"></span>ou put your</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">braces so long as you all agree on where to put them. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws314">If you w<span class="_ _1"></span>ould like to kno<span class="_ _4"></span>w what con<span class="_ _1"></span>ventions I follo<span class="_ _4"></span>w<span class="_ _0"></span>, you’<span class="_ _4"></span>ll see them in the refactored</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">code in Listing B-7 on page 394, through Listing B-14.</div><div class="t m0 xd h11 y13cc ff1 fs7 fc0 sc0 ls0 ws0">G25:<span class="_ _4"></span> <span class="ff5">Replace Magic Numbers with Named Constants</span></div><div class="t m0 xd h14 y5db ff8 fs3 fc0 sc0 ls10 ws2b2">This is probabl<span class="_ _4"></span>y one of the oldest rules in software de<span class="_ _4"></span>velopment. I remember reading it in the</div><div class="t m0 xd h14 y5dc ff8 fs3 fc0 sc0 ls10 ws3bf">late sixties in introductory COBOL, FOR<span class="_ _4"></span>TRAN, and PL/1 manuals. In general it is a bad</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls10 ws75f">idea to ha<span class="_ _4"></span>ve ra<span class="_ _4"></span>w numbers in your code. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should hide them behind w<span class="_ _4"></span>ell-named constants. </div><div class="t m0 x74 h14 y5ba ff8 fs3 fc0 sc0 ls0 ws760">F<span class="_ _1"></span>or example, the number 86,400 should be hidden behind the constant</div><div class="t m5 xd h2f y5bb ffb fs10 fc0 sc0 ls0 ws0">SECONDS_PER_DAY</div><div class="t m0 x24 h14 y5bb ff8 fs3 fc0 sc0 ls0 ws6d">. If you are printing 55 lines per page, then the constant 55 should be hid-</div><div class="t m0 xd h14 y5bc ff8 fs3 fc0 sc0 ls0 ws0">den behind the constant </div><div class="t m5 x6e h2f y329 ffb fs10 fc0 sc0 ls0 ws0">LINES_PER_PAGE</div><div class="t m0 xe9 h14 y329 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y6fa ff8 fs3 fc0 sc0 ls0 ws25a">Some constants are so easy to recognize that the<span class="_ _4"></span>y don’<span class="_ _4"></span>t al<span class="_ _4"></span>wa<span class="_ _1"></span>ys need a named constant</div><div class="t m0 xd h14 y6fb ff8 fs3 fc0 sc0 ls0 ws17c">to hide behind so long as they are used in conjunction with v<span class="_ _4"></span>er<span class="_ _8"></span>y self-explanatory code. F<span class="_ _4"></span>or</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 ls0 ws0">example:</div><div class="t m5 x74 h2f y13cd ffb fs10 fc0 sc0 ls0 ws0">double milesWalked = feetWalked/5280.0;</div><div class="t m5 x74 h2f y13ce ffb fs10 fc0 sc0 ls0 ws0">int dailyPay = hourlyRate * 8;</div><div class="t m5 x74 h2f y13cf ffb fs10 fc0 sc0 ls0 ws0">double circumference = radius * Math.PI * 2;</div><div class="t m0 x74 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws3fc">Do w<span class="_ _4"></span>e really need the constants </div><div class="t m5 x31 h2f y6d4 ffb fs10 fc0 sc0 ls0 ws0">FEET_PER_MILE</div><div class="t m0 xb4 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m5 x88 h2f y6d4 ffb fs10 fc0 sc0 ls0 ws0">WORK_HOURS_PER_DAY</div><div class="t m0 xa7 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws3fc">, and </div><div class="t m5 xd3 h2f y6d4 ffb fs10 fc0 sc0 ls0 ws0">TWO</div><div class="t m0 x36 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws3fc">in the</div><div class="t m0 xd h14 y6d5 ff8 fs3 fc0 sc0 ls0 ws1e8">abo<span class="_ _4"></span>ve e<span class="_ _4"></span>xamples? Clearly<span class="_ _0"></span>, the last case is absurd. <span class="_ _4"></span>There are some formulae in which con-</div><div class="t m0 xd h14 y6d6 ff8 fs3 fc0 sc0 ls0 ws761">stants are simply better written as ra<span class="_ _1"></span>w numbers. <span class="_ _0"></span>Y<span class="_ _2"></span>ou might quibble about the</div><div class="t m5 xd h2f y5c5 ffb fs10 fc0 sc0 ls0 ws0">WORK_HOURS_PER_DAY</div><div class="t m0 x7b h14 y5c5 ff8 fs3 fc0 sc0 ls0 ws762">case because the la<span class="_ _4"></span>ws or con<span class="_ _4"></span>ventions might change. On the other</div><div class="t m0 xd h14 y5c7 ff8 fs3 fc0 sc0 ls0 ws692">hand<span class="_ _1"></span>, that for<span class="_ _8"></span>mula reads so nicely with the 8 in it that I w<span class="_ _1"></span>ould be reluctant to add 17 extra</div><div class="t m0 xd h14 y5c8 ff8 fs3 fc0 sc0 lsd ws647">characters to the readers’<span class="_ _1"></span> burden. <span class="_ _1"></span>And in the </div><div class="t m5 xee h2f y5c8 ffb fs10 fc0 sc0 ls0 ws0">FEET_PER_MILE</div><div class="t m0 xf7 h14 y5c8 ff8 fs3 fc0 sc0 ls0 ws531">case, the number 5280 is so</div><div class="t m0 xd h14 y5c9 ff8 fs3 fc0 sc0 ls0 ws441">very w<span class="_ _4"></span>ell kno<span class="_ _4"></span>wn and so unique a constant that readers would reco<span class="_ _4"></span>gnize it e<span class="_ _4"></span>ven if it stood</div><div class="t m0 xd h14 y5cb ff8 fs3 fc0 sc0 ls0 ws0">alone on a page with no context surrounding it. </div><div class="t m0 x74 h14 y671 ff8 fs3 fc0 sc0 ls0 ws3df">Constants like 3.141592653589793 are also v<span class="_ _4"></span>er<span class="_ _8"></span>y well kno<span class="_ _1"></span>wn and easily reco<span class="_ _4"></span>gnizable.</div><div class="t m0 xd h14 y672 ff8 fs3 fc0 sc0 ls0 ws763">Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er, the chance for error is too g<span class="_ _8"></span>reat to lea<span class="_ _4"></span>ve them ra<span class="_ _4"></span>w<span class="_ _0"></span>. Every time someone sees</div><div class="t m0 xd h14 y673 ff8 fs3 fc0 sc0 ls0 ws55">3.1415927535890793, they kno<span class="_ _1"></span>w that it is <span class="ff14 ws0">p<span class="ffa">,<span class="_ _15"> </span></span></span>and so they fail to scrutinize it. (Did you</div><div class="t m0 xd h14 y674 ff8 fs3 fc0 sc0 ls0 ws321">catch the single-digit er<span class="_ _8"></span>ror?) <span class="_ _4"></span>W<span class="_ _0"></span>e also don’<span class="_ _4"></span>t want people using 3.14, 3.14159, 3.142, and so</div><div class="t m0 xd h14 y675 ff8 fs3 fc0 sc0 ls0 ws0">forth. <span class="_ _4"></span>Therefore, it is a good thing that </div><div class="t m5 x5c h2f y8df ffb fs10 fc0 sc0 ls0 ws0">Math.PI</div><div class="t m0 xee h14 y8df ff8 fs3 fc0 sc0 ls0 ws0"> has already been deﬁned for us. </div><div class="t m0 x74 h14 y6da ff8 fs3 fc0 sc0 ls0 ws456">The term “Magic Number” does not apply onl<span class="_ _4"></span>y to numbers. It applies to any token</div><div class="t m0 xd h14 y6db ff8 fs3 fc0 sc0 ls0 ws0">that has a v<span class="_ _4"></span>alue that is not self-describing. F<span class="_ _4"></span>or example:</div><div class="t m5 x74 h2f y1390 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(7777, Employee.find(“John Doe”).employeeNumber());</div><div class="t m0 x74 h14 y2ed ff8 fs3 fc0 sc0 ls0 ws764">There are tw<span class="_ _4"></span>o magic numbers in this assertion. <span class="_ _4"></span>The ﬁrst is obviousl<span class="_ _4"></span>y 7777, though</div><div class="t m0 xd h14 y2ee ff8 fs3 fc0 sc0 ls0 ws21">what it might mean is not ob<span class="_ _1"></span>vious. <span class="_ _4"></span>The second magic number is </div><div class="t m5 x51 h2f y2ee ffb fs10 fc0 sc0 ls0 ws765">&quot;John Doe,&quot;</div><div class="t m0 xbb h14 y2ee ff8 fs3 fc0 sc0 ls8d ws583"> and again the</div><div class="t m0 xd h14 y2ef ff8 fs3 fc0 sc0 ls0 ws0">intent is not clear<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y73d ff8 fs3 fc0 sc0 ls4b ws2d8">It turns out that </div><div class="t m5 xb h2f y73d ffb fs10 fc0 sc0 ls78 ws766">&quot;John Doe&quot;</div><div class="t m0 xa2 h14 y73d ff8 fs3 fc0 sc0 ls4b ws2d8">is the name of emplo<span class="_ _4"></span>yee #7777 in a w<span class="_ _1"></span>ell-known test data-</div><div class="t m0 xd h14 y13d0 ff8 fs3 fc0 sc0 ls4b ws767">base created b<span class="_ _4"></span>y our team. Everyone in the team kno<span class="_ _4"></span>ws that when y<span class="_ _4"></span>ou connect to this</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:504.728010px;width:264.795000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14c" class="pf w1 h2" data-page-no="14c"><div class="pc pc14c w1 h2"><img class="bi x37 y3cd w8 h27" alt="" src="bg14c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">301<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls4b ws768">database, it will ha<span class="_ _4"></span>ve se<span class="_ _4"></span>veral emplo<span class="_ _4"></span>yees already cook<span class="_ _4"></span>ed into it with well-kno<span class="_ _1"></span>wn values</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls4a ws769">and attributes. It also turns out that </div><div class="t m5 x9c h2f y195 ffb fs10 fc0 sc0 ls78 ws76a">&quot;John Doe&quot;</div><div class="t m0 xde h14 y195 ff8 fs3 fc0 sc0 ls4b ws337">represents the sole hourl<span class="_ _4"></span>y emplo<span class="_ _4"></span>yee in</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls4b ws0">that test database. So this test should really read:</div><div class="t m5 x74 h2f y403 ffb fs10 fc0 sc0 ls0 ws0">assertEquals(</div><div class="t m5 x74 h2f y404 ffb fs10 fc0 sc0 ls18 ws3b9">  HOURLY_EMPLOYEE_ID,</div><div class="t m5 x74 h2f y405 ffb fs10 fc0 sc0 ls14 ws3b9">  Employee.find(HOURLY_EMPLOYEE_NAME).employeeNumber());</div><div class="t m0 xd h11 y13d1 ff1 fs7 fc0 sc0 ls0 ws0">G26:<span class="_ _4"></span> <span class="ff5">Be Precise</span></div><div class="t m0 xd h14 y603 ff8 fs3 fc0 sc0 ls0 ws44f">Expecting the ﬁrst match to be the <span class="ffa ws0">only </span>match to a query is probabl<span class="_ _4"></span>y naiv<span class="_ _4"></span>e. Using ﬂoating</div><div class="t m0 xd h14 y863 ff8 fs3 fc0 sc0 ls0 wse4">point numbers to represent cur<span class="_ _8"></span>rency is almost criminal. <span class="_ _1"></span>A<span class="_ _0"></span>voiding locks and/or transaction</div><div class="t m0 xd h14 y5b9 ff8 fs3 fc0 sc0 ls0 ws5bb">management because you don’<span class="_ _1"></span>t think concur<span class="_ _8"></span>rent update is likel<span class="_ _4"></span>y is lazy at best. Declaring</div><div class="t m0 xd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws1ef">a variab<span class="_ _4"></span>le to be an </div><div class="t m5 xf2 h2f y5ba ffb fs10 fc0 sc0 ls0 ws0">ArrayList</div><div class="t m0 x5a h14 y5ba ff8 fs3 fc0 sc0 ls0 ws1ef">when a </div><div class="t m5 xfe h2f y5ba ffb fs10 fc0 sc0 ls0 ws0">List</div><div class="t m0 xdd h14 y5ba ff8 fs3 fc0 sc0 ls0 ws1ef">will due is o<span class="_ _4"></span>verl<span class="_ _4"></span>y constraining. Making all vari-</div><div class="t m0 xd h14 y5bb ff8 fs3 fc0 sc0 ls0 ws0">ables </div><div class="t m5 x7c h2f y5bb ffb fs10 fc0 sc0 ls0 ws0">protected</div><div class="t m0 x39 h14 y5bb ff8 fs3 fc0 sc0 ls0 ws0"> b<span class="_ _4"></span>y def<span class="_ _8"></span>ault is not constraining enough. </div><div class="t m0 x74 h14 ybaa ff8 fs3 fc0 sc0 ls16 ws53a">When you mak<span class="_ _4"></span>e a decision in your code, make sure y<span class="_ _4"></span>ou make it <span class="ffa ws0">pr<span class="_ _4"></span>ecisely<span class="_ _0"></span><span class="ff8 ws53a">. Kno<span class="_ _4"></span>w wh<span class="_ _4"></span>y</span></span></div><div class="t m0 xd h14 ybab ff8 fs3 fc0 sc0 ls16 ws11b">you ha<span class="_ _1"></span>ve made it and ho<span class="_ _4"></span>w you will deal with an<span class="_ _4"></span>y exceptions. Don’<span class="_ _1"></span>t be lazy about the pre-</div><div class="t m0 xd h14 y13d2 ff8 fs3 fc0 sc0 ls16 ws5fe">cision of your decisions. If y<span class="_ _4"></span>ou decide to call a function that might return </div><div class="t m5 x45 h2f y6fb ffb fs10 fc0 sc0 ls31 ws0">null</div><div class="t m0 x98 h14 y6fb ff8 fs3 fc0 sc0 ls16 ws5fe">, make sure</div><div class="t m0 xd h14 y32c ff8 fs3 fc0 sc0 ls16 ws3b6">you check for </div><div class="t m5 xe h2f y13d3 ffb fs10 fc0 sc0 ls31 ws0">null</div><div class="t m0 x4d h14 y13d3 ff8 fs3 fc0 sc0 ls16 ws3b6">. If you query for what y<span class="_ _4"></span>ou think is the only record in the database,</div><div class="t m0 xd h14 y5c0 ff8 fs3 fc0 sc0 ls16 ws5f2">make sure y<span class="_ _4"></span>our code checks to be sure there aren’<span class="_ _4"></span>t others. If you need to deal with cur<span class="_ _4"></span>-</div><div class="t m0 xd h14 y5c1 ff8 fs3 fc0 sc0 ls16 ws5e8">rency<span class="_ _0"></span>, use integers</div><div class="t m0 xf2 h21 yb88 ff8 fsc fc0 sc0 ls67 ws0">11</div><div class="t m0 x9 h14 y5c1 ff8 fs3 fc0 sc0 ls16 ws5e8">and deal with rounding appropriatel<span class="_ _4"></span>y<span class="_ _1"></span>. If there is the possibility of</div><div class="t m0 xd h14 y5c2 ff8 fs3 fc0 sc0 ls16 ws0">concur<span class="_ _8"></span>rent update, make sure y<span class="_ _4"></span>ou implement some kind of locking mechanism. </div><div class="t m0 x74 h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws431">Ambiguities and imprecision in code are either a result of disagreements or laziness.</div><div class="t m0 xd h14 y6d5 ff8 fs3 fc0 sc0 ls0 ws0">In either case they should be eliminated. </div><div class="t m0 xd h11 y9e3 ff1 fs7 fc0 sc0 ls0 ws0">G27:<span class="_ _4"></span> <span class="ff5">Structure o<span class="_ _4"></span>ver Con<span class="_ _1"></span>vention</span></div><div class="t m0 xd h14 y310 ff8 fs3 fc0 sc0 ls0 ws6f7">Enforce design decisions with structure o<span class="_ _4"></span>ver con<span class="_ _4"></span>vention. Naming con<span class="_ _4"></span>ventions are good<span class="_ _0"></span>,</div><div class="t m0 xd h14 y311 ff8 fs3 fc0 sc0 lsd ws623">but they are inferior to structures that force compliance. F<span class="_ _4"></span>or example, s<span class="_ _4"></span>witch/cases with</div><div class="t m0 xd h14 y2ba ff8 fs3 fc0 sc0 ls0 ws12a">nicely named enumerations are inferior to base classes with abstract methods. No one is</div><div class="t m0 xd h14 y226 ff8 fs3 fc0 sc0 ls0 ws215">forced to implement the </div><div class="t m5 x7 h2f y226 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 xdf h14 y226 ff8 fs3 fc0 sc0 ls0 ws0">/</div><div class="t m5 x8 h2f y226 ffb fs10 fc0 sc0 ls0 ws0">case</div><div class="t m0 x5c h14 y226 ff8 fs3 fc0 sc0 lsd ws119">statement the same w<span class="_ _4"></span>ay each time; but the base</div><div class="t m0 xd h14 y227 ff8 fs3 fc0 sc0 ls0 ws0">classes do enforce that concrete classes ha<span class="_ _4"></span>ve all abstract methods implemented. </div><div class="t m0 xd h11 y1383 ff1 fs7 fc0 sc0 ls0 ws0">G28:<span class="_ _4"></span> <span class="ff5">Encapsulate Conditionals</span></div><div class="t m0 xd h14 y959 ff8 fs3 fc0 sc0 ls0 ws336">Boolean lo<span class="_ _4"></span>gic is hard enough to understand without having to see it in the conte<span class="_ _4"></span>xt of an </div><div class="t m5 xc8 h2f y959 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xd h14 y95a ff8 fs3 fc0 sc0 ls0 ws0">or</div><div class="t m5 xcd h2f y95a ffb fs10 fc0 sc0 ls0 ws0">while</div><div class="t m0 x75 h14 y95a ff8 fs3 fc0 sc0 ls0 ws0"> statement. Extract functions that explain the intent of the conditional.</div><div class="t m0 x74 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>or example:</div><div class="t m5 x74 h2f y82d ffb fs10 fc0 sc0 ls0 ws0">if (shouldBeDeleted(timer))</div><div class="t m0 xd h14 yb79 ff8 fs3 fc0 sc0 ls0 ws0">is preferable to</div><div class="t m5 x74 h2f y13d4 ffb fs10 fc0 sc0 ls0 ws0">if (timer.hasExpired() &amp;&amp; !timer.isRecurrent())</div><div class="t m0 xd h25 y302 ff8 fse fc0 sc0 ls0 ws0">11.<span class="_ _16"> </span>Or better yet, a <span class="_ _4"></span><span class="ffb">Money<span class="ff8"> class that uses integers.</span></span></div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:501.728010px;width:80.092000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:199.728010px;width:155.655000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:293.728010px;width:157.989000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14d" class="pf w1 h2" data-page-no="14d"><div class="pc pc14d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">302<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">G29:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5">A<span class="_ _0"></span>void Negative Conditionals</span></div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 lsc ws589">Negati<span class="_ _4"></span>ves are just a bit harder to understand than positi<span class="_ _4"></span>ves. So, w<span class="_ _4"></span>hen possible, condition-</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">als should be expressed as positi<span class="_ _4"></span>ves. F<span class="_ _1"></span>or example:</div><div class="t m5 x74 h2f y172 ffb fs10 fc0 sc0 ls0 ws0">if (buffer.shouldCompact())</div><div class="t m0 xd h14 y1233 ff8 fs3 fc0 sc0 ls0 ws0">is preferable to</div><div class="t m5 x74 h2f y4ed ffb fs10 fc0 sc0 ls14 ws1d0">if (!buffer.shouldNotCompact())</div><div class="t m0 xd h11 yeca ff1 fs7 fc0 sc0 ls0 ws0">G30:<span class="_ _4"></span> <span class="ff5">Functions Should Do One <span class="_ _4"></span>Thing</span></div><div class="t m0 xd h14 y252 ff8 fs3 fc0 sc0 ls0 ws5d7">It is often tempting to create functions that ha<span class="_ _4"></span>ve multiple sections that perform a series of</div><div class="t m0 xd h14 y253 ff8 fs3 fc0 sc0 ls0 ws2ac">operations. Functions of this kind do more than <span class="ffa">one thing</span>, and should be con<span class="_ _4"></span>verted into</div><div class="t m0 xd h14 y254 ff8 fs3 fc0 sc0 ls0 ws0">many smaller functions, each of w<span class="_ _4"></span>hich does <span class="ffa">one thing</span>.</div><div class="t m0 x74 h14 y3b1 ff8 fs3 fc0 sc0 ls0 ws0">F<span class="_ _1"></span>or example:</div><div class="t m5 x74 h2f yc7c ffb fs10 fc0 sc0 ls14 ws235">  public void pay() {</div><div class="t m5 x74 h2f yc7d ffb fs10 fc0 sc0 ls0 ws0">    for (Employee e : employees) {</div><div class="t m5 x74 h2f yc7e ffb fs10 fc0 sc0 ls0 ws0">      if (e.isPayday()) {</div><div class="t m5 x74 h2f yc7f ffb fs10 fc0 sc0 ls0 ws0">        Money pay = e.calculatePay();</div><div class="t m5 x74 h2f yc80 ffb fs10 fc0 sc0 ls0 ws0">        e.deliverPay(pay);</div><div class="t m5 x74 h2f y13d5 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y13d6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y13d7 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y2a0 ff8 fs3 fc0 sc0 ls0 ws287">This bit of code does three things. It loops o<span class="_ _4"></span>ver all the emplo<span class="_ _1"></span>yees, checks to see w<span class="_ _4"></span>hether</div><div class="t m0 xd h14 y2a1 ff8 fs3 fc0 sc0 ls0 ws522">each emplo<span class="_ _4"></span>yee ought to be paid<span class="_ _0"></span>, and then pays the emplo<span class="_ _1"></span>yee. <span class="_ _1"></span>This code would be better</div><div class="t m0 xd h14 y437 ff8 fs3 fc0 sc0 ls0 ws0">written as:</div><div class="t m5 x74 h2f y7b8 ffb fs10 fc0 sc0 ls14 ws235">  public void pay() {</div><div class="t m5 x74 h2f y7b9 ffb fs10 fc0 sc0 ls0 ws0">    for (Employee e : employees)</div><div class="t m5 x74 h2f y7ba ffb fs10 fc0 sc0 ls0 ws0">      payIfNecessary(e);</div><div class="t m5 x74 h2f y7bb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13d8 ffb fs10 fc0 sc0 ls0 ws0">  private void payIfNecessary(Employee e) {</div><div class="t m5 x74 h2f y13d9 ffb fs10 fc0 sc0 ls0 ws0">    if (e.isPayday())</div><div class="t m5 x74 h2f y13da ffb fs10 fc0 sc0 ls0 ws0">      calculateAndDeliverPay(e);</div><div class="t m5 x74 h2f y13db ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13dc ffb fs10 fc0 sc0 ls0 ws0">  private void calculateAndDeliverPay(Employee e) {</div><div class="t m5 x74 h2f y13dd ffb fs10 fc0 sc0 ls0 ws0">    Money pay = e.calculatePay();</div><div class="t m5 x74 h2f y13de ffb fs10 fc0 sc0 ls0 ws0">    e.deliverPay(pay);</div><div class="t m5 x74 h2f y13df ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h14 y13e0 ff8 fs3 fc0 sc0 ls0 ws0">Each of these functions does one thing. (See “Do One <span class="_ _1"></span>Thing” on page 35.)</div><div class="t m0 xd h11 y13e1 ff1 fs7 fc0 sc0 ls0 ws0">G31:<span class="_ _4"></span> <span class="ff5">Hidden T<span class="_ _0"></span>emporal Couplings</span></div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 lsd ws40d">T<span class="_ _0"></span>emporal couplings are often necessary<span class="_ _1"></span>, but you should not hide the coupling. Structure</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws540">the arguments of y<span class="_ _4"></span>our functions such that the order in which the<span class="_ _4"></span>y should be called is obvi-</div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">ous. Consider the follo<span class="_ _4"></span>wing:</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:476.728010px;width:190.853000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:166.979000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:121.728010px;width:168.030000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14e" class="pf w1 h2" data-page-no="14e"><div class="pc pc14e w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">303<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public class MoogDiver {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  Gradient gradient;</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">  List&lt;Spline&gt; splines;</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  public void dive(String reason) {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    saturateGradient();</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    reticulateSplines();</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    diveForMoog(reason);</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y409 ff8 fs3 fc0 sc0 ls0 ws54c">The order of the three functions is important. <span class="_ _1"></span>Y<span class="_ _3"></span>ou must saturate the g<span class="_ _8"></span>radient before you</div><div class="t m0 xd h14 y846 ff8 fs3 fc0 sc0 ls0 wsb3">can reticulate the splines, and onl<span class="_ _4"></span>y then can you di<span class="_ _4"></span>ve for the moog. Unfortunatel<span class="_ _4"></span>y<span class="_ _1"></span>, the code</div><div class="t m0 xd h14 y92b ff8 fs3 fc0 sc0 ls0 ws76b">does not enforce this temporal coupling. <span class="_ _1"></span>Another programmer could call </div><div class="t m5 x63 h2f y92b ffb fs10 fc0 sc0 ls0 ws0">reticulate-</div><div class="t m5 xd h2f y13e3 ffb fs10 fc0 sc0 ls0 ws0">Splines</div><div class="t m0 x75 h14 y209 ff8 fs3 fc0 sc0 ls0 ws0">before</div><div class="t m5 x39 h2f y209 ffb fs10 fc0 sc0 ls0 ws0">saturateGradient</div><div class="t m0 x8 h14 y209 ff8 fs3 fc0 sc0 ls0 ws3fd">w<span class="_ _4"></span>as called<span class="_ _4"></span>, leading to an </div><div class="t m5 x69 h2f y209 ffb fs10 fc0 sc0 ls0 ws0">UnsaturatedGradientException</div><div class="t m0 x56 h14 y209 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws0">A better solution is:</div><div class="t m5 x74 h2f y13e4 ffb fs10 fc0 sc0 ls0 ws0">public class MoogDiver {</div><div class="t m5 x74 h2f y13e5 ffb fs10 fc0 sc0 ls18 ws241">  Gradient gradient;</div><div class="t m5 x74 h2f y13e6 ffb fs10 fc0 sc0 ls0 ws0">  List&lt;Spline&gt; splines;</div><div class="t m5 x74 h2f y13e7 ffb fs10 fc0 sc0 ls14 ws253">  public void dive(String reason) {</div><div class="t m5 x74 h2f y13e8 ffb fs10 fc0 sc0 ls0 ws0">    Gradient gradient = saturateGradient();</div><div class="t m5 x74 h2f y13e9 ffb fs10 fc0 sc0 ls0 ws0">    List&lt;Spline&gt; splines = reticulateSplines(gradient);</div><div class="t m5 x74 h2f y13ea ffb fs10 fc0 sc0 ls0 ws0">    diveForMoog(splines, reason);</div><div class="t m5 x74 h2f y13eb ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y13ec ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f y13ed ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls10 ws5d1">This exposes the temporal coupling b<span class="_ _4"></span>y creating a bucket brigade. Each function produces a</div><div class="t m0 xd h14 y57c ff8 fs3 fc0 sc0 ls10 ws0">result that the next function needs, so there is no reasonab<span class="_ _4"></span>le wa<span class="_ _1"></span>y to call them out of order<span class="_ _4"></span>.</div><div class="t m0 x74 h14 y57d ff8 fs3 fc0 sc0 ls8e ws30d">Y<span class="_ _3"></span>ou might complain that this increases the complexity of the functions, and you’<span class="_ _3"></span>d be</div><div class="t m0 xd h14 y524 ff8 fs3 fc0 sc0 ls8f ws6ae">right. But that extra syntactic comple<span class="_ _4"></span>xity exposes the true temporal complexity of the situation. </div><div class="t m0 x74 h14 y954 ff8 fs3 fc0 sc0 ls0 ws294">Note that I left the instance v<span class="_ _4"></span>ariables in place. I presume that they are needed b<span class="_ _4"></span>y pri-</div><div class="t m0 xd h14 y955 ff8 fs3 fc0 sc0 ls0 ws95">v<span class="_ _4"></span>ate methods in the class. Even so, I want the ar<span class="_ _4"></span>guments in place to make the temporal</div><div class="t m0 xd h14 y956 ff8 fs3 fc0 sc0 ls0 ws0">coupling explicit.</div><div class="t m0 xd h11 y13ee ff1 fs7 fc0 sc0 ls0 ws0">G32:<span class="_ _4"></span> <span class="ff5">Don’<span class="_ _4"></span>t Be Arbitrary</span></div><div class="t m0 xd h14 y8df ff8 fs3 fc0 sc0 ls10 ws99">Ha<span class="_ _4"></span>ve a reason for the w<span class="_ _4"></span>ay y<span class="_ _4"></span>ou structure your code, and make sure that reason is communi-</div><div class="t m0 xd h14 y7fb ff8 fs3 fc0 sc0 ls10 ws3d4">cated by the structure of the code. If a structure appears arbitrar<span class="_ _8"></span>y<span class="_ _1"></span>, others will feel empo<span class="_ _4"></span>w<span class="_ _4"></span>ered</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc0 sc0 ls0 ws320">to change it. If a structure appears consistently throughout the system, others will use it</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc0 sc0 ls0 ws9">and preserve the con<span class="_ _4"></span>vention. F<span class="_ _1"></span>or example, I was recentl<span class="_ _4"></span>y merging changes to F<span class="_ _4"></span>itNesse and</div><div class="t m0 xd h14 yc1d ff8 fs3 fc0 sc0 ls0 ws0">disco<span class="_ _4"></span>vered that one of our committers had done this:</div><div class="t m5 x74 h2f y13ef ffb fs10 fc0 sc0 ls0 ws0">public class AliasLinkWidget extends ParentWidget</div><div class="t m5 x74 h2f y13f0 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y13f1 ffb fs10 fc0 sc0 ls14 ws253">  public static class VariableExpandingWidgetRoot {</div><div class="t m5 x74 h2f y13f2 ffb fs10 fc0 sc0 ls5c ws253">    ...</div><div class="t m5 x74 h2f y13f3 ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x74 h2f y13f4 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:204.728010px;width:121.338000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf14f" class="pf w1 h2" data-page-no="14f"><div class="pc pc14f w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">304<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls47 ws601">The problem with this w<span class="_ _4"></span>as that </div><div class="t m5 xfe h2f y194 ffb fs10 fc0 sc0 ls90 ws0">VariableExpandingWidgetRoot</div><div class="t m0 x73 h14 y194 ff8 fs3 fc0 sc0 ls47 ws601">had no need to be</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls47 ws14c">inside the scope of </div><div class="t m5 x5 h2f y195 ffb fs10 fc0 sc0 ls90 ws0">AliasLinkWidget</div><div class="t m0 x31 h14 y195 ff8 fs3 fc0 sc0 ls47 ws14c">. Moreo<span class="_ _4"></span>ver<span class="_ _1"></span>, other unrelated classes made use of</div><div class="t m5 xd h2f y196 ffb fs10 fc0 sc0 ls90 ws0">AliasLinkWidget.VariableExpandingWidgetRoot</div><div class="t m0 x34 h14 y196 ff8 fs3 fc0 sc0 ls47 ws76c">. <span class="_ _1"></span>These classes had no need to know</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls47 ws0">about</div><div class="t m5 x3e h2f y197 ffb fs10 fc0 sc0 ls90 ws0">AliasLinkWidget</div><div class="t m0 x9e h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws76d">P<span class="_ _4"></span>erhaps the programmer had plopped the </div><div class="t m5 x27 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">VariableExpandingWidgetRoot</div><div class="t m0 x29 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws0">into</div><div class="t m5 xd h2f y1be ffb fs10 fc0 sc0 ls0 ws0">AliasWidget</div><div class="t m0 x41 h14 y1be ff8 fs3 fc0 sc0 ls0 ws283">as a matter of con<span class="_ _4"></span>venience, or perhaps he thought it reall<span class="_ _4"></span>y needed to be</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws76e">scoped inside </div><div class="t m5 x14 h2f y19a ffb fs10 fc0 sc0 ls0 ws0">AliasWidget</div><div class="t m0 x7d h14 y19a ff8 fs3 fc0 sc0 ls0 ws76e">. <span class="_ _4"></span>Whatev<span class="_ _4"></span>er the reason, the result wound up being arbitrary<span class="_ _0"></span>. Pub-</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws76f">lic classes that are not utilities of some other class should not be scoped inside another</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">class. <span class="_ _1"></span>The conv<span class="_ _4"></span>ention is to make them public at the top le<span class="_ _4"></span>vel of their package.</div><div class="t m0 xd h11 y13f5 ff1 fs7 fc0 sc0 ls0 ws0">G33:<span class="_ _4"></span> <span class="ff5">Encapsulate Boundary Conditions</span></div><div class="t m0 xd h14 y5bb ff8 fs3 fc0 sc0 ls0 ws770">Boundary conditions are hard to keep track of. Put the processing for them in one place.</div><div class="t m0 xd h14 y5bc ff8 fs3 fc0 sc0 ls0 wsce">Don’<span class="_ _1"></span>t let them leak all ov<span class="_ _4"></span>er the code. W<span class="_ _2"></span>e don’<span class="_ _4"></span>t want s<span class="_ _4"></span>warms of </div><div class="t m5 xab h2f y329 ffb fs10 fc0 sc0 ls0 ws0">+1</div><div class="t m0 xa0 h14 y329 ff8 fs3 fc0 sc0 ls0 wsce">s and </div><div class="t m5 xac h2f y329 ffb fs10 fc0 sc0 ls0 ws0">-1</div><div class="t m0 x60 h14 y329 ff8 fs3 fc0 sc0 ls0 wsce">s scattered hither</div><div class="t m0 xd h14 y32a ff8 fs3 fc0 sc0 ls0 ws0">and yon. Consider this simple e<span class="_ _4"></span>xample from FIT:</div><div class="t m5 x74 h2f y13f6 ffb fs10 fc0 sc0 ls0 ws0">if(level + 1 &lt; tags.length)</div><div class="t m5 x74 h2f y13f7 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y13f8 ffb fs10 fc0 sc0 ls0 ws260">  parts = new Parse(body, tags, level + 1, offset + endTag);</div><div class="t m5 x74 h2f y13f9 ffb fs10 fc0 sc0 ls19 ws235">  body = null;</div><div class="t m5 x74 h2f y13fa ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y2db ff8 fs3 fc0 sc0 ls0 ws51c">Notice that </div><div class="t m5 x6c h2f y2db ffb fs10 fc0 sc0 ls0 ws0">level+1</div><div class="t m0 x7b h14 y2db ff8 fs3 fc0 sc0 ls0 ws51c">appears twice. <span class="_ _1"></span>This is a boundar<span class="_ _8"></span>y condition that should be encapsu-</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws0">lated within a variab<span class="_ _4"></span>le named something like </div><div class="t m5 x1b h2f y3a5 ffb fs10 fc0 sc0 ls0 ws0">nextLevel</div><div class="t m0 xb7 h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y13fb ffb fs10 fc0 sc0 ls0 ws0">int nextLevel = level + 1;</div><div class="t m5 x74 h2f y13fc ffb fs10 fc0 sc0 ls0 ws0">if(nextLevel &lt; tags.length)</div><div class="t m5 x74 h2f y13fd ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y13fe ffb fs10 fc0 sc0 ls0 ws0">parts = new Parse(body, tags, nextLevel, offset + endTag);</div><div class="t m5 x52 h2f y13ff ffb fs10 fc0 sc0 ls0 ws0">body = null;</div><div class="t m5 x74 h2f y1400 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y1401 ff1 fs7 fc0 sc0 ls0 ws0">G34:<span class="_ _4"></span> <span class="ff5">Functions Should Descend Only One Level of <span class="_ _0"></span>Abstr<span class="_ _4"></span>action</span></div><div class="t m0 xd h14 y2cc ff8 fs3 fc0 sc0 ls0 ws771">The statements within a function should all be written at the same lev<span class="_ _4"></span>el of abstraction,</div><div class="t m0 xd h14 y2cd ff8 fs3 fc0 sc0 ls0 ws3a5">which should be one le<span class="_ _4"></span>vel belo<span class="_ _1"></span>w the operation described by the name of the function. <span class="_ _1"></span>This</div><div class="t m0 xd h14 y2ce ff8 fs3 fc0 sc0 ls0 ws772">ma<span class="_ _4"></span>y be the hardest of these heuristics to inter<span class="_ _8"></span>pret and follo<span class="_ _4"></span>w<span class="_ _1"></span>. <span class="_ _1"></span>Though the idea is plain</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc0 sc0 ls0 ws323">enough, humans are just far too good at seamlessly mixing le<span class="_ _4"></span>vels of abstraction. Consider<span class="_ _1"></span>,</div><div class="t m0 xd h14 y5d6 ff8 fs3 fc0 sc0 ls0 ws0">for example, the follo<span class="_ _1"></span>wing code taken from FitNesse:</div><div class="t m5 x52 h2f y1402 ffb fs10 fc0 sc0 ls0 ws0">public String render() throws Exception</div><div class="t m5 x52 h2f y1403 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y1404 ffb fs10 fc0 sc0 ls0 ws0">StringBuffer html = new StringBuffer(&quot;&lt;hr&quot;);</div><div class="t m5 x8a h2f y1405 ffb fs10 fc0 sc0 ls0 ws0">if(size &gt; 0)</div><div class="t m5 x8a h2f y1406 ffb fs10 fc0 sc0 ls14 ws235">  html.append(&quot; size=\&quot;&quot;).append(size + 1).append(&quot;\&quot;&quot;);</div><div class="t m5 x8a h2f y1407 ffb fs10 fc0 sc0 ls0 ws0">html.append(&quot;&gt;&quot;);</div><div class="t m5 x8a h2f y1408 ffb fs10 fc0 sc0 ls0 ws0">return html.toString();</div><div class="t m5 x52 h2f y1409 ffb fs10 fc0 sc0 ls0 ws0">}</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:453.728010px;width:198.662000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:236.728010px;width:314.321000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf150" class="pf w1 h2" data-page-no="150"><div class="pc pc150 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">305<span class="_ _10"></span><span class="ff1">General</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws653">A moment’<span class="_ _2"></span>s study and you can see w<span class="_ _4"></span>hat’<span class="_ _2"></span>s going on. <span class="_ _4"></span>This function constructs the HTML</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws5df">tag that dra<span class="_ _4"></span>ws a horizontal rule across the page. <span class="_ _4"></span>The height of that r<span class="_ _8"></span>ule is speciﬁed in the</div><div class="t m5 xd h2f y196 ffb fs10 fc0 sc0 ls0 ws0">size</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> v<span class="_ _4"></span>ariable. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 lsc ws773">No<span class="_ _4"></span>w look again. <span class="_ _4"></span>This method is mixing at least tw<span class="_ _4"></span>o lev<span class="_ _4"></span>els of abstraction. <span class="_ _4"></span>The ﬁrst is</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws744">the notion that a horizontal rule has a size. <span class="_ _4"></span>The second is the syntax of the </div><div class="t m5 xa5 h2f y1bd ffb fs10 fc0 sc0 ls0 ws0">HR</div><div class="t m0 x99 h14 y1bd ff8 fs3 fc0 sc0 ls0 ws744">tag itself.</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws63d">This code comes from the </div><div class="t m5 x1f h2f y1be ffb fs10 fc0 sc0 ls0 ws0">HruleWidget</div><div class="t m0 x33 h14 y1be ff8 fs3 fc0 sc0 ls0 ws63d">module in FitNesse. <span class="_ _1"></span>This module detects a ro<span class="_ _4"></span>w of</div><div class="t m0 xd h14 y19a ff8 fs3 fc0 sc0 ls0 ws774">four or more dashes and con<span class="_ _4"></span>verts it into the appropriate HR tag. <span class="_ _4"></span>The more dashes, the</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">larger the size.</div><div class="t m0 x74 h14 y207 ff8 fs3 fc0 sc0 ls0 wsa5">I refactored this bit of code as follo<span class="_ _4"></span>ws. Note that I changed the name of the </div><div class="t m5 x99 h2f y207 ffb fs10 fc0 sc0 ls0 ws0">size</div><div class="t m0 x2d h14 y207 ff8 fs3 fc0 sc0 ls0 ws0">ﬁeld</div><div class="t m0 xd h14 y1fc ff8 fs3 fc0 sc0 ls0 ws0">to reﬂect its true pur<span class="_ _8"></span>pose. It held the number of extra dashes.</div><div class="t m5 x52 h2f y140a ffb fs10 fc0 sc0 ls0 ws0">public String render() throws Exception</div><div class="t m5 x52 h2f y140b ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y140c ffb fs10 fc0 sc0 ls0 ws0">HtmlTag hr = new HtmlTag(&quot;hr&quot;);</div><div class="t m5 x8a h2f y140d ffb fs10 fc0 sc0 ls0 ws0">if (extraDashes &gt; 0)</div><div class="t m5 x6c h2f y140e ffb fs10 fc0 sc0 ls0 ws0">hr.addAttribute(&quot;size&quot;, hrSize(extraDashes));</div><div class="t m5 x8a h2f y140f ffb fs10 fc0 sc0 ls0 ws0">return hr.html();</div><div class="t m5 x52 h2f y1410 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y1411 ffb fs10 fc0 sc0 ls0 ws0">private String hrSize(int height)</div><div class="t m5 x52 h2f y1412 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y1413 ffb fs10 fc0 sc0 ls0 ws0">int hrSize = height + 1;</div><div class="t m5 x8a h2f y1414 ffb fs10 fc0 sc0 ls0 ws0">return String.format(&quot;%d&quot;, hrSize);</div><div class="t m5 x52 h2f y1415 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 yb05 ff8 fs3 fc0 sc0 ls0 ws1a6">This change separates the tw<span class="_ _4"></span>o lev<span class="_ _4"></span>els of abstraction nicely<span class="_ _0"></span>. <span class="_ _1"></span>The </div><div class="t m5 xca h2f yb05 ffb fs10 fc0 sc0 ls0 ws0">render</div><div class="t m0 xeb h14 yb05 ff8 fs3 fc0 sc0 ls0 ws1a6">function simpl<span class="_ _4"></span>y con-</div><div class="t m0 xd h14 y94f ff8 fs3 fc0 sc0 ls0 ws48b">structs an HR tag, without having to kno<span class="_ _1"></span>w anything about the HTML syntax of that tag.</div><div class="t m0 xd h14 y950 ff8 fs3 fc0 sc0 ls0 ws0">The</div><div class="t m5 x74 h2f y3f7 ffb fs10 fc0 sc0 ls0 ws0">HtmlTag</div><div class="t m0 x6c h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws0"> module takes care of all the nasty syntax issues. </div><div class="t m0 x74 h14 y42a ff8 fs3 fc0 sc0 ls0 ws328">Indeed<span class="_ _1"></span>, by making this change I caught a subtle error<span class="_ _4"></span>. <span class="_ _4"></span>The original code did not put</div><div class="t m0 xd h14 y42b ff8 fs3 fc0 sc0 ls0 ws3f1">the closing slash on the HR tag, as the XHTML standard w<span class="_ _4"></span>ould ha<span class="_ _4"></span>ve it. (In other w<span class="_ _4"></span>ords, it</div><div class="t m0 xd h14 yddd ff8 fs3 fc0 sc0 ls0 ws0">emitted</div><div class="t m5 x9a h2f yddd ffb fs10 fc0 sc0 ls0 ws0">&lt;hr&gt;</div><div class="t m0 x28 h14 yddd ff8 fs3 fc0 sc0 ls0 ws671">instead of </div><div class="t m5 xf8 h2f yddd ffb fs10 fc0 sc0 ls0 ws0">&lt;hr/&gt;</div><div class="t m0 x38 h14 yddd ff8 fs3 fc0 sc0 ls0 ws775">.) The </div><div class="t m5 x32 h2f yddd ffb fs10 fc0 sc0 ls0 ws0">HtmlTag</div><div class="t m0 x66 h14 yddd ff8 fs3 fc0 sc0 ls0 ws671">module had been changed to conform to</div><div class="t m0 xd h14 y58b ff8 fs3 fc0 sc0 ls0 ws0">XHTML long ago.</div><div class="t m0 x74 h14 y58c ff8 fs3 fc0 sc0 ls12 ws776">Separating le<span class="_ _4"></span>vels of abstraction is one of the most important functions of ref<span class="_ _8"></span>actor-</div><div class="t m0 xd h14 ye6f ff8 fs3 fc0 sc0 ls12 ws2e9">ing, and it’<span class="_ _2"></span>s one of the hardest to do w<span class="_ _4"></span>ell. <span class="_ _4"></span>As an example, look at the code belo<span class="_ _1"></span>w<span class="_ _1"></span>. <span class="_ _4"></span>This</div><div class="t m0 xd h14 yde0 ff8 fs3 fc0 sc0 ls12 ws777">was m<span class="_ _1"></span>y ﬁrst attempt at separating the abstraction lev<span class="_ _4"></span>els in the </div><div class="t m5 x59 h2f y43b ffb fs10 fc0 sc0 ls5d ws0">HruleWidget.render</div><div class="t m5 xd h2f y1416 ffb fs10 fc0 sc0 ls5d ws0">method</div><div class="t m0 x3e h14 y2e7 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x52 h2f y10e8 ffb fs10 fc0 sc0 ls0 ws0">public String render() throws Exception</div><div class="t m5 x52 h2f y1417 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x8a h2f y1418 ffb fs10 fc0 sc0 ls0 ws0">HtmlTag hr = new HtmlTag(&quot;hr&quot;);</div><div class="t m5 x8a h2f y1419 ffb fs10 fc0 sc0 ls0 ws0">if (size &gt; 0) {</div><div class="t m5 x6c h2f y141a ffb fs10 fc0 sc0 ls0 ws0">hr.addAttribute(&quot;size&quot;, &quot;&quot;+(size+1));</div><div class="t m5 x8a h2f y141b ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x8a h2f y141c ffb fs10 fc0 sc0 ls0 ws0">return hr.html();</div><div class="t m5 x52 h2f y141d ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y60d ff8 fs3 fc0 sc0 ls0 ws778">My goal, at this point, w<span class="_ _4"></span>as to create the necessar<span class="_ _8"></span>y separation and get the tests to pass.</div><div class="t m0 xd h14 y60e ff8 fs3 fc0 sc0 lsd ws5e8">I <span class="_ _0"></span>accomplished that goal easil<span class="_ _4"></span>y<span class="_ _1"></span>, but the result was a function that <span class="_ _4"></span><span class="ffa ls0 ws0">still<span class="_ _15"> </span><span class="ff8 ws5f0">had mix<span class="_ _4"></span>ed lev<span class="_ _4"></span>els</span></span></div><div class="t m0 xd h14 y482 ff8 fs3 fc0 sc0 ls0 ws20c">of <span class="_ _1"></span>abstraction. In this case the mix<span class="_ _4"></span>ed lev<span class="_ _4"></span>els were the construction of the HR tag and the</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf151" class="pf w1 h2" data-page-no="151"><div class="pc pc151 w1 h2"><img class="bi x37 y141e w8 h27" alt="" src="bg151.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">306<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws5b3">inter<span class="_ _8"></span>pretation and formatting of the </div><div class="t m5 x43 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">size</div><div class="t m0 xdd h14 y194 ff8 fs3 fc0 sc0 ls0 ws5b3">v<span class="_ _4"></span>ariable. <span class="_ _1"></span>This points out that when you break a</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws4fc">function along lines of abstraction, you often unco<span class="_ _1"></span>ver ne<span class="_ _4"></span>w lines of abstraction that were</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">obscured b<span class="_ _4"></span>y the previous structure. </div><div class="t m0 xd h11 y6e1 ff1 fs7 fc0 sc0 ls0 ws0">G35:<span class="_ _4"></span> <span class="ff5">Keep Conﬁgur<span class="_ _4"></span>able Data at High Lev<span class="_ _4"></span>els</span></div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws5e9">If you ha<span class="_ _1"></span>ve a constant such as a default or conﬁguration value that is kno<span class="_ _1"></span>wn and expected</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 lsd ws2fd">at a high le<span class="_ _4"></span>vel of abstraction, do not bury it in a low-le<span class="_ _4"></span>vel function. Expose it as an ar<span class="_ _4"></span>gu-</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws155">ment to that lo<span class="_ _4"></span>w-lev<span class="_ _4"></span>el function called from the high-lev<span class="_ _4"></span>el function. Consider the follo<span class="_ _4"></span>wing</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws0">code from FitNesse:</div><div class="t m5 x52 h2f y12ad ffb fs10 fc0 sc0 ls0 ws0">public static void main(String[] args) throws Exception</div><div class="t m5 x52 h2f y12ae ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y12af ffb fs10 fc0 sc0 ls14 ws235">  Arguments arguments = parseCommandLine(args);</div><div class="t m5 x52 h2f y12b0 ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x52 h2f y12b1 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y12b3 ffb fs10 fc0 sc0 ls0 ws0">public class Arguments</div><div class="t m5 x74 h2f y12b4 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x74 h2f y12b5 ffb fs10 fc0 sc0 ls14 ws260">  public static final String DEFAULT_PATH = &quot;.&quot;;</div><div class="t m5 x74 h2f y12b6 ffb fs10 fc0 sc0 ls0 ws253">  public static final String DEFAULT_ROOT = &quot;FitNesseRoot&quot;;</div><div class="t m5 x74 h2f y12b7 ffb fs10 fc0 sc0 ls14 ws260">  public static final int DEFAULT_PORT = 80;</div><div class="t m5 x74 h2f y12b8 ffb fs10 fc0 sc0 ls14 ws260">  public static final int DEFAULT_VERSION_DAYS = 14;</div><div class="t m5 x74 h2f y12b9 ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x74 h2f y141f ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y9d4 ff8 fs3 fc0 sc0 ls0 ws3cf">The command-line arguments are parsed in the v<span class="_ _4"></span>er<span class="_ _8"></span>y ﬁrst ex<span class="_ _4"></span>ecutable line of F<span class="_ _4"></span>itNesse. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y51f ff8 fs3 fc0 sc0 ls0 ws585">default values of those ar<span class="_ _4"></span>guments are speciﬁed at the top of the </div><div class="t m5 xa0 h2f y1420 ffb fs10 fc0 sc0 ls0 ws0">Argument</div><div class="t m0 x45 h14 y1420 ff8 fs3 fc0 sc0 ls0 ws779">class. Y<span class="_ _3"></span>ou <span class="_ _6"></span>don’<span class="_ _4"></span>t</div><div class="t m0 xd h14 y9be ff8 fs3 fc0 sc0 ls0 ws0">ha<span class="_ _4"></span>ve to go looking in lo<span class="_ _4"></span>w le<span class="_ _4"></span>vels of the system for statements like this one:</div><div class="t m5 x74 h2f y1421 ffb fs10 fc0 sc0 ls0 ws0">if (arguments.port == 0) // use 80 by default</div><div class="t m0 xd h14 y1422 ff8 fs3 fc0 sc0 ls0 ws596">The conﬁguration constants reside at a very high lev<span class="_ _4"></span>el and are easy to change. <span class="_ _4"></span>They get</div><div class="t m0 xd h14 y59f ff8 fs3 fc0 sc0 ls0 ws18e">passed do<span class="_ _4"></span>wn to the rest of the application. <span class="_ _4"></span>The lo<span class="_ _4"></span>w<span class="_ _4"></span>er lev<span class="_ _4"></span>els of the application do not own</div><div class="t m0 xd h14 y5a0 ff8 fs3 fc0 sc0 ls0 ws0">the values of these constants.</div><div class="t m0 xd h11 y1423 ff1 fs7 fc0 sc0 ls0 ws0">G36:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5 ws77a">A<span class="_ _0"></span>void T<span class="_ _1"></span>ransitiv<span class="_ _4"></span>e <span class="_ _5"></span>Navigation</span></div><div class="t m0 xd h14 y229 ff8 fs3 fc0 sc0 ls0 ws6b">In general w<span class="_ _4"></span>e don’<span class="_ _4"></span>t want a single module to kno<span class="_ _1"></span>w much about its collaborators. More spe-</div><div class="t m0 xd h14 y2bb ff8 fs3 fc0 sc0 ls0 ws350">ciﬁcally<span class="_ _0"></span>, if </div><div class="t m5 x46 h2f y582 ffb fs10 fc0 sc0 ls0 ws0">A</div><div class="t m0 x1e h14 y582 ff8 fs3 fc0 sc0 ls0 ws350">collaborates with </div><div class="t m5 x8f h2f y582 ffb fs10 fc0 sc0 ls0 ws0">B</div><div class="t m0 xf6 h14 y582 ff8 fs3 fc0 sc0 ls0 ws350">, and </div><div class="t m5 xfe h2f y582 ffb fs10 fc0 sc0 ls0 ws0">B</div><div class="t m0 x31 h14 y582 ff8 fs3 fc0 sc0 ls0 ws350">collaborates with </div><div class="t m5 xb6 h2f y582 ffb fs10 fc0 sc0 ls0 ws0">C</div><div class="t m0 xdb h14 y582 ff8 fs3 fc0 sc0 ls0 ws350">, w<span class="_ _4"></span>e don’<span class="_ _4"></span>t want modules that use</div><div class="t m5 xd h2f y584 ffb fs10 fc0 sc0 ls0 ws0">A</div><div class="t m0 x47 h14 y584 ff8 fs3 fc0 sc0 ls0 ws0"> to kno<span class="_ _4"></span>w about </div><div class="t m5 xfb h2f y584 ffb fs10 fc0 sc0 ls0 ws0">C</div><div class="t m0 x6 h14 y584 ff8 fs3 fc0 sc0 ls0 ws0">. (F<span class="_ _1"></span>or example, w<span class="_ _4"></span>e don’<span class="_ _4"></span>t want </div><div class="t m5 xcf h2f y584 ffb fs10 fc0 sc0 ls0 ws0">a.getB().getC().doSomething();</div><div class="t m0 x99 h14 y584 ff8 fs3 fc0 sc0 ls0 ws0">.)</div><div class="t m0 x74 h14 y45a ff8 fs3 fc0 sc0 ls0 ws77b">This is sometimes called the La<span class="_ _4"></span>w of Demeter<span class="_ _1"></span>. <span class="_ _4"></span>The Pragmatic Programmers call it</div><div class="t m0 xd h14 y45b ff8 fs3 fc0 sc0 ls0 ws32c">“Writing Sh<span class="_ _4"></span>y Code.<span class="_ _1"></span>”</div><div class="t m0 x5 h21 y480 ff8 fsc fc0 sc0 ls0 ws0">12</div><div class="t m0 x2e h14 y45b ff8 fs3 fc0 sc0 ls0 ws32c">In either case it comes do<span class="_ _4"></span>wn to making sure that modules kno<span class="_ _4"></span>w</div><div class="t m0 xd h14 y45c ff8 fs3 fc0 sc0 lsc wsca">onl<span class="_ _4"></span>y about their immediate collaborators and do not know the na<span class="_ _1"></span>vigation map of the whole</div><div class="t m0 xd h14 y45d ff8 fs3 fc0 sc0 ls0 ws0">system.</div><div class="t m0 x74 h14 yb4c ff8 fs3 fc0 sc0 ls12 ws5a9">If man<span class="_ _4"></span>y modules used some for<span class="_ _8"></span>m of the statement </div><div class="t m5 xe3 h2f yb4c ffb fs10 fc0 sc0 ls5d ws0">a.getB().getC()</div><div class="t m0 xaf h14 yb4c ff8 fs3 fc0 sc0 ls12 ws5a9">, then it w<span class="_ _4"></span>ould be</div><div class="t m0 xd h14 y1424 ff8 fs3 fc0 sc0 ls12 ws14a">difﬁcult to change the design and architecture to interpose a </div><div class="t m5 xf3 h2f y1424 ffb fs10 fc0 sc0 ls0 ws0">Q</div><div class="t m0 xb5 h14 y1424 ff8 fs3 fc0 sc0 ls12 ws0">betw<span class="_ _4"></span>een </div><div class="t m5 x5e h2f y1424 ffb fs10 fc0 sc0 ls0 ws0">B</div><div class="t m0 xf4 h14 y1424 ff8 fs3 fc0 sc0 ls12 ws0">and</div><div class="t m5 x90 h2f y1424 ffb fs10 fc0 sc0 ls0 ws0">C</div><div class="t m0 xe6 h14 y1424 ff8 fs3 fc0 sc0 ls12 ws207">. Y<span class="_ _3"></span>ou’<span class="_ _2"></span>d</div><div class="t m0 xd h25 y1425 ff8 fse fc0 sc0 ls0 ws0">12.<span class="_ _16"> </span>[PRA<span class="_ _4"></span>G], p. 138.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:534.728010px;width:222.127000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:221.728010px;width:163.484000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf152" class="pf w1 h2" data-page-no="152"><div class="pc pc152 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">307<span class="_ _10"></span><span class="ff1 ls15">Ja<span class="_ _4"></span>va</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls12 ws57e">ha<span class="_ _4"></span>ve to ﬁnd e<span class="_ _4"></span>very instance of </div><div class="t m5 x8f h2f y194 ffb fs10 fc0 sc0 ls5d ws0">a.getB().getC()</div><div class="t m0 x23 h14 y194 ff8 fs3 fc0 sc0 ls6b ws4e9"> and con<span class="_ _4"></span>vert it to </div><div class="t m5 xa0 h2f y194 ffb fs10 fc0 sc0 ls5d ws0">a.getB().getQ().getC()</div><div class="t m0 x56 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls12 ws49a">This is ho<span class="_ _4"></span>w architectures become rigid. <span class="_ _4"></span>T<span class="_ _0"></span>oo many modules kno<span class="_ _4"></span>w too much about the</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls12 ws0">architecture.</div><div class="t m0 x74 h14 y1fb ff8 fs3 fc0 sc0 ls0 ws28e">Rather w<span class="_ _4"></span>e want our immediate collaborators to of<span class="_ _4"></span>fer all the services we need. <span class="_ _4"></span>W<span class="_ _0"></span>e</div><div class="t m0 xd h14 y1bd ff8 fs3 fc0 sc0 ls0 ws77c">should not ha<span class="_ _4"></span>ve to roam through the object graph of the system, hunting for the method we</div><div class="t m0 xd h14 y1be ff8 fs3 fc0 sc0 ls0 ws0">want to call. Rather w<span class="_ _1"></span>e should simply be ab<span class="_ _4"></span>le to say:</div><div class="t m5 x74 h2f y3ce ffb fs10 fc0 sc0 ls0 ws0">myCollaborator.doSomething()<span class="_ _4"></span>.</div><div class="t m0 xd h17 y4dc ff1 fs9 fc0 sc0 ls91 ws0">Ja<span class="_ _1"></span>va</div><div class="t m0 xd h11 y549 ff1 fs7 fc0 sc0 ls0 ws0">J1:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5">A<span class="_ _0"></span>void Long Import Lists by Using Wildcards</span></div><div class="t m0 xd h14 y20a ff8 fs3 fc0 sc0 ls0 ws0">If you use tw<span class="_ _1"></span>o or more classes from a package, then impor<span class="_ _8"></span>t the whole package with</div><div class="t m5 x74 h2f y13e4 ffb fs10 fc0 sc0 ls0 ws0">import package.*;</div><div class="t m0 xd h14 y9f6 ff8 fs3 fc0 sc0 ls0 ws63">Long lists of imports are daunting to the reader<span class="_ _4"></span>. W<span class="_ _2"></span>e don’<span class="_ _4"></span>t want to clutter up the tops of our</div><div class="t m0 xd h14 y9f7 ff8 fs3 fc0 sc0 ls0 ws6e">modules with 80 lines of imports. Rather we w<span class="_ _4"></span>ant the imports to be a concise statement</div><div class="t m0 xd h14 yeea ff8 fs3 fc0 sc0 ls0 ws0">about which packages w<span class="_ _1"></span>e collaborate with.</div><div class="t m0 x74 h14 y749 ff8 fs3 fc0 sc0 ls0 ws147">Speciﬁc imports are hard dependencies, whereas wildcard imports are not. If you spe-</div><div class="t m0 xd h14 y74a ff8 fs3 fc0 sc0 ls0 ws581">ciﬁcally import a class, then that class <span class="ffa ws0">must </span>e<span class="_ _4"></span>xist. But if you import a package with a wild-</div><div class="t m0 xd h14 y74b ff8 fs3 fc0 sc0 ls0 ws324">card<span class="_ _1"></span>, no par<span class="_ _8"></span>ticular classes need to exist. <span class="_ _1"></span>The impor<span class="_ _8"></span>t statement simply adds the package to</div><div class="t m0 xd h14 y74c ff8 fs3 fc0 sc0 ls0 ws77d">the search path when hunting for names. So no true dependency is created b<span class="_ _4"></span>y such</div><div class="t m0 xd h14 y74d ff8 fs3 fc0 sc0 ls0 ws0">imports, and they therefore serve to keep our modules less coupled.</div><div class="t m0 x74 h14 y57c ff8 fs3 fc0 sc0 ls0 ws1e8">There are times when the long list of speciﬁc imports can be useful. F<span class="_ _1"></span>or example, if</div><div class="t m0 xd h14 y74e ff8 fs3 fc0 sc0 ls0 ws77e">you are dealing with le<span class="_ _4"></span>gacy code and y<span class="_ _4"></span>ou want to ﬁnd out w<span class="_ _4"></span>hat classes you need to build</div><div class="t m0 xd h14 y74f ff8 fs3 fc0 sc0 ls0 ws365">mocks and stubs for<span class="_ _4"></span>, you can w<span class="_ _4"></span>alk do<span class="_ _4"></span>wn the list of speciﬁc impor<span class="_ _8"></span>ts to ﬁnd out the true</div><div class="t m0 xd h14 y827 ff8 fs3 fc0 sc0 ls0 ws69b">qualiﬁed names of all those classes and then put the appropriate stubs in place. Ho<span class="_ _4"></span>w<span class="_ _4"></span>ev<span class="_ _4"></span>er,</div><div class="t m0 xd h14 y9f8 ff8 fs3 fc0 sc0 ls0 ws20f">this use for speciﬁc imports is very rare. Fur<span class="_ _8"></span>ther<span class="_ _8"></span>more, most moder<span class="_ _8"></span>n IDEs will allo<span class="_ _4"></span>w you</div><div class="t m0 xd h14 y9f9 ff8 fs3 fc0 sc0 ls0 ws37f">to con<span class="_ _4"></span>vert the wildcarded impor<span class="_ _8"></span>ts to a list of speciﬁc imports with a single command. So</div><div class="t m0 xd h14 y9e9 ff8 fs3 fc0 sc0 lsc ws3f">e<span class="_ _4"></span>ven in the legac<span class="_ _4"></span>y case it’<span class="_ _2"></span>s better to impor<span class="_ _8"></span>t wildcards.</div><div class="t m0 x74 h14 y9fa ff8 fs3 fc0 sc0 ls0 ws5ba">W<span class="_ _4"></span>ildcard imports can sometimes cause name conﬂicts and ambiguities. <span class="_ _4"></span>T<span class="_ _0"></span>w<span class="_ _4"></span>o classes</div><div class="t m0 xd h14 y9fb ff8 fs3 fc0 sc0 lsd ws130">with the same name, but in dif<span class="_ _4"></span>ferent packages, will need to be speciﬁcally imported<span class="_ _4"></span>, or at</div><div class="t m0 xd h14 y9fc ff8 fs3 fc0 sc0 lsd ws3f3">least speciﬁcall<span class="_ _4"></span>y qualiﬁed when used. <span class="_ _1"></span>This can be a nuisance but is rare enough that using</div><div class="t m0 xd h14 y9fd ff8 fs3 fc0 sc0 ls0 ws0">wildcard imports is still generally better than speciﬁc imports.</div><div class="t m0 xd h11 y10c8 ff1 fs7 fc0 sc0 ls0 ws0">J2:<span class="_ _4"></span> <span class="ff5">Don’<span class="_ _4"></span>t Inherit Constants</span></div><div class="t m0 xd h14 y3c9 ff8 fs3 fc0 sc0 ls0 wsb9">I ha<span class="_ _4"></span>ve seen this se<span class="_ _4"></span>veral times and it al<span class="_ _4"></span>wa<span class="_ _1"></span>ys makes me g<span class="_ _8"></span>rimace. <span class="_ _1"></span>A programmer puts some</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc0 sc0 lsc ws6f2">constants in an interface and then gains access to those constants by inheriting that inter<span class="_ _4"></span>-</div><div class="t m0 xd h14 y41b ff8 fs3 fc0 sc0 ls0 ws0">face. <span class="_ _4"></span>T<span class="_ _1"></span>ake a look at the follo<span class="_ _1"></span>wing code:</div><div class="t m5 x74 h2f y6ec ffb fs10 fc0 sc0 ls0 ws0">public class HourlyEmployee extends Employee {</div><div class="t m5 x74 h2f y6ed ffb fs10 fc0 sc0 ls0 ws0">  private int tenthsWorked;</div><div class="t m5 x74 h2f y6ee ffb fs10 fc0 sc0 ls0 ws0">  private double hourlyRate;</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:475.945010px;width:26.678000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:451.728010px;width:237.174000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:149.728010px;width:136.884000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf153" class="pf w1 h2" data-page-no="153"><div class="pc pc153 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">308<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">  public Money calculatePay() {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    int straightTime = Math.min(tenthsWorked, TENTHS_PER_WEEK);</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    int overTime = tenthsWorked - straightTime;</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">    return new Money(</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">      hourlyRate * (tenthsWorked + OVERTIME_RATE * overTime)</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">  ...</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 wsad">Where did the constants </div><div class="t m5 xa h2f y19b ffb fs10 fc0 sc0 ls0 ws0">TENTHS_PER_WEEK</div><div class="t m0 x44 h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x1b h2f y19b ffb fs10 fc0 sc0 ls0 ws0">OVERTIME_RATE</div><div class="t m0 x6a h14 y19b ff8 fs3 fc0 sc0 ls0 wsad">come from? <span class="_ _1"></span>They might ha<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">come from class </div><div class="t m5 x3a h2f y19c ffb fs10 fc0 sc0 ls0 ws0">Employee</div><div class="t m0 xb1 h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">; so let’<span class="_ _2"></span>s take a look at that: </div><div class="t m5 x74 h2f ya99 ffb fs10 fc0 sc0 ls0 ws0">public abstract class Employee implements PayrollConstants {</div><div class="t m5 x74 h2f y1055 ffb fs10 fc0 sc0 ls0 ws0">  public abstract boolean isPayday();</div><div class="t m5 x74 h2f y1056 ffb fs10 fc0 sc0 ls0 ws0">  public abstract Money calculatePay();</div><div class="t m5 x74 h2f y1057 ffb fs10 fc0 sc0 ls0 ws0">  public abstract void deliverPay(Money pay);</div><div class="t m5 x74 h2f y1058 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y636 ff8 fs3 fc0 sc0 ls0 ws77f">Nope, not there. But then where? Look closel<span class="_ _4"></span>y at class </div><div class="t m5 x51 h2f y636 ffb fs10 fc0 sc0 ls0 ws0">Employee</div><div class="t m0 x4a h14 y636 ff8 fs3 fc0 sc0 ls0 ws77f">. It implements</div><div class="t m5 xd h2f y637 ffb fs10 fc0 sc0 ls0 ws0">PayrollConstants</div><div class="t m0 xbc h14 y637 ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m5 x74 h2f y1426 ffb fs10 fc0 sc0 ls0 ws0">public interface PayrollConstants {</div><div class="t m5 x74 h2f y1427 ffb fs10 fc0 sc0 ls0 ws0">  public static final int TENTHS_PER_WEEK = 400;</div><div class="t m5 x74 h2f y1428 ffb fs10 fc0 sc0 ls0 ws0">  public static final double OVERTIME_RATE = 1.5;</div><div class="t m5 x74 h2f y1429 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y578 ff8 fs3 fc0 sc0 ls0 ws2e8">This is a hideous practice! <span class="_ _1"></span>The constants are hidden at the top of the inheritance hierarchy<span class="_ _0"></span>.</div><div class="t m0 xd h14 y579 ff8 fs3 fc0 sc0 ls0 ws168">Ick! Don’<span class="_ _1"></span>t use inheritance as a wa<span class="_ _4"></span>y to cheat the scoping r<span class="_ _8"></span>ules of the language. Use a static</div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws0">import instead.</div><div class="t m5 x74 h46 y589 ffc fs10 fc0 sc0 ls0 ws0">import static PayrollConstants.*;</div><div class="t m5 x74 h2f y142a ffb fs10 fc0 sc0 ls0 ws0">public class HourlyEmployee extends Employee {</div><div class="t m5 x74 h2f y142b ffb fs10 fc0 sc0 ls0 ws0">  private int tenthsWorked;</div><div class="t m5 x74 h2f y142c ffb fs10 fc0 sc0 ls0 ws0">  private double hourlyRate;</div><div class="t m5 x74 h2f y142d ffb fs10 fc0 sc0 ls0 ws0">  public Money calculatePay() {</div><div class="t m5 x74 h2f y142e ffb fs10 fc0 sc0 ls0 ws0">    int straightTime = Math.min(tenthsWorked, TENTHS_PER_WEEK);</div><div class="t m5 x74 h2f y142f ffb fs10 fc0 sc0 ls0 ws0">    int overTime = tenthsWorked - straightTime;</div><div class="t m5 x74 h2f y1430 ffb fs10 fc0 sc0 ls0 ws0">    return new Money(</div><div class="t m5 x74 h2f y1431 ffb fs10 fc0 sc0 ls0 ws0">      hourlyRate * (tenthsWorked + OVERTIME_RATE * overTime)</div><div class="t m5 x74 h2f y1432 ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f y1433 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1434 ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x74 h2f y1435 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h11 y1436 ff1 fs7 fc0 sc0 ls0 ws0">J3:<span class="_ _4"></span> <span class="ff5">Constants versus En<span class="_ _4"></span>ums</span></div><div class="t m0 xd h14 y1437 ff8 fs3 fc0 sc0 ls0 ws12e">No<span class="_ _4"></span>w that </div><div class="t m5 xcb h2f y1437 ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 x14 h14 y1437 ff8 fs3 fc0 sc0 ls0 ws12e">s ha<span class="_ _4"></span>ve been added to the language (Ja<span class="_ _4"></span>va 5), use them! Don’<span class="_ _1"></span>t keep using the</div><div class="t m0 xd h14 y1438 ff8 fs3 fc0 sc0 ls0 ws248">old trick of </div><div class="t m5 x6c h2f y1438 ffb fs10 fc0 sc0 ls0 ws780">public static final int</div><div class="t m0 xfe h14 y1438 ff8 fs3 fc0 sc0 ls0 ws248">s. <span class="_ _1"></span>The meaning of </div><div class="t m5 xe3 h2f y1438 ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 x69 h14 y1438 ff8 fs3 fc0 sc0 ls0 ws248">s can get lost. <span class="_ _1"></span>The meaning of</div><div class="t m5 xd h2f y1188 ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 x74 h14 y1188 ff8 fs3 fc0 sc0 ls0 ws0">s cannot, because they belong to an enumeration that is named.</div><div class="t m0 x74 h14 y1439 ff8 fs3 fc0 sc0 ls0 ws3db">What’<span class="_ _2"></span>s more, study the syntax for </div><div class="t m5 xe9 h2f y1439 ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 xaa h14 y1439 ff8 fs3 fc0 sc0 ls0 ws3db">s carefully<span class="_ _0"></span>. <span class="_ _1"></span>They can ha<span class="_ _4"></span>ve methods and ﬁelds.</div><div class="t m0 xd h14 y143a ff8 fs3 fc0 sc0 ls0 ws1f1">This makes them v<span class="_ _4"></span>er<span class="_ _8"></span>y po<span class="_ _4"></span>werful tools that allo<span class="_ _1"></span>w much more expression and ﬂexibility than</div><div class="t m5 xd h2f y67e ffb fs10 fc0 sc0 ls0 ws0">int</div><div class="t m0 x3b h14 y67e ff8 fs3 fc0 sc0 ls0 ws0">s. Consider this v<span class="_ _4"></span>ariation on the payroll code:</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:153.728010px;width:140.126000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf154" class="pf w1 h2" data-page-no="154"><div class="pc pc154 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">309<span class="_ _10"></span><span class="ff1">Names</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public class HourlyEmployee extends Employee {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">  private int tenthsWorked;</div><div class="t m5 x3e h46 y628 ffc fs10 fc0 sc0 ls0 ws0">HourlyPayGrade grade;</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">  public Money calculatePay() {</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">    int straightTime = Math.min(tenthsWorked, TENTHS_PER_WEEK);</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">    int overTime = tenthsWorked - straightTime;</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">    return new Money(</div><div class="t m5 x5f h2f y861 ffc fs10 fc0 sc0 ls0 ws0">grade.rate() <span class="ffb">* (tenthsWorked + OVERTIME_RATE * overTime)</span></div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">    );</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls1b ws236">  ...</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">public enum HourlyPayGrade {</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">  APPRENTICE {</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">    public double rate() {</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">      return 1.0;</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">  },</div><div class="t m5 x74 h2f yf9c ffb fs10 fc0 sc0 ls0 ws0">  LEUTENANT_JOURNEYMAN {</div><div class="t m5 x74 h2f yf9d ffb fs10 fc0 sc0 ls0 ws0">    public double rate() {</div><div class="t m5 x74 h2f yf9e ffb fs10 fc0 sc0 ls0 ws0">      return 1.2;</div><div class="t m5 x74 h2f yf9f ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfb3 ffb fs10 fc0 sc0 ls0 ws0">  },</div><div class="t m5 x74 h2f yfa0 ffb fs10 fc0 sc0 ls0 ws0">  JOURNEYMAN {</div><div class="t m5 x74 h2f yfa1 ffb fs10 fc0 sc0 ls0 ws0">    public double rate() {</div><div class="t m5 x74 h2f yfa2 ffb fs10 fc0 sc0 ls0 ws0">      return 1.5;</div><div class="t m5 x74 h2f yfb4 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa3 ffb fs10 fc0 sc0 ls0 ws0">  },</div><div class="t m5 x74 h2f yfa4 ffb fs10 fc0 sc0 ls0 ws0">  MASTER {</div><div class="t m5 x74 h2f yfa5 ffb fs10 fc0 sc0 ls0 ws0">    public double rate() {</div><div class="t m5 x74 h2f yfb5 ffb fs10 fc0 sc0 ls0 ws0">      return 2.0;</div><div class="t m5 x74 h2f yfa6 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yfa7 ffb fs10 fc0 sc0 ls0 ws0">  };</div><div class="t m5 x74 h2f yfb6 ffb fs10 fc0 sc0 ls0 ws0">  public abstract double rate();</div><div class="t m5 x74 h2f yfa9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h17 y143b ff1 fs9 fc0 sc0 ls0 ws0">Names</div><div class="t m0 xd h11 yb0f ff1 fs7 fc0 sc0 ls0 ws0">N1:<span class="_ _4"></span> <span class="ff5">Choose Descriptive Names</span></div><div class="t m0 xd h14 y13ae ff8 fs3 fc0 sc0 ls0 ws414">Don’<span class="_ _1"></span>t be too quick to choose a name. Make sure the name is descriptiv<span class="_ _4"></span>e. Remember that</div><div class="t m0 xd h14 y143c ff8 fs3 fc0 sc0 ls0 ws44d">meanings tend to drift as softw<span class="_ _4"></span>are ev<span class="_ _4"></span>olves, so frequently ree<span class="_ _4"></span>v<span class="_ _4"></span>aluate the appropriateness of</div><div class="t m0 xd h14 y143d ff8 fs3 fc0 sc0 ls0 ws0">the names you choose. </div><div class="t m0 x74 h14 y143e ff8 fs3 fc0 sc0 ls0 ws74b">This is not just a “feel-good” recommendation. Names in software are 90 percent of</div><div class="t m0 xd h14 y143f ff8 fs3 fc0 sc0 ls0 ws633">what mak<span class="_ _4"></span>e software readab<span class="_ _4"></span>le. <span class="_ _0"></span>Y<span class="_ _2"></span>ou need to take the time to choose them wisel<span class="_ _4"></span>y and keep</div><div class="t m0 xd h14 y1440 ff8 fs3 fc0 sc0 ls0 ws0">them relev<span class="_ _1"></span>ant. Names are too impor<span class="_ _8"></span>tant to treat carelessly<span class="_ _0"></span>.</div><div class="t m0 x74 h14 y1ff ff8 fs3 fc0 sc0 ls0 ws781">Consider the code belo<span class="_ _4"></span>w<span class="_ _0"></span>. What does it do? If I sho<span class="_ _1"></span>w you the code with w<span class="_ _4"></span>ell-chosen</div><div class="t m0 xd h14 y200 ff8 fs3 fc0 sc0 lsd ws508">names, it will make perfect sense to y<span class="_ _4"></span>ou, but like this it’<span class="_ _2"></span>s just a hodge-podge of symbols</div><div class="t m0 xd h14 y201 ff8 fs3 fc0 sc0 ls0 ws0">and magic numbers.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:220.945010px;width:40.431000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:194.728010px;width:153.092000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf155" class="pf w1 h2" data-page-no="155"><div class="pc pc155 w1 h2"><img class="bi x37 y1441 w8 h27" alt="" src="bg155.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">310<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc0 sc0 ls0 ws0">public int x() {</div><div class="t m5 x74 h2f y627 ffb fs10 fc0 sc0 ls0 ws0">    int q = 0;</div><div class="t m5 x74 h2f y628 ffb fs10 fc0 sc0 ls0 ws0">    int z = 0;</div><div class="t m5 x74 h2f y629 ffb fs10 fc0 sc0 ls0 ws0">    for (int kk = 0; kk &lt; 10; kk++) {</div><div class="t m5 x74 h2f y62a ffb fs10 fc0 sc0 ls0 ws0">      if (l[z] == 10)</div><div class="t m5 x74 h2f y62b ffb fs10 fc0 sc0 ls0 ws0">      {</div><div class="t m5 x74 h2f y62c ffb fs10 fc0 sc0 ls0 ws0">        q += 10 + (l[z + 1] + l[z + 2]);</div><div class="t m5 x74 h2f y62d ffb fs10 fc0 sc0 ls0 ws0">        z += 1;</div><div class="t m5 x74 h2f y861 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y62e ffb fs10 fc0 sc0 ls0 ws0">      else if (l[z] + l[z + 1] == 10)</div><div class="t m5 x74 h2f y62f ffb fs10 fc0 sc0 ls0 ws0">      {</div><div class="t m5 x74 h2f y630 ffb fs10 fc0 sc0 ls0 ws0">        q += 10 + l[z + 2];</div><div class="t m5 x74 h2f y631 ffb fs10 fc0 sc0 ls0 ws0">        z += 2;</div><div class="t m5 x74 h2f y632 ffb fs10 fc0 sc0 ls0 ws0">      } else {</div><div class="t m5 x74 h2f y9cc ffb fs10 fc0 sc0 ls0 ws0">        q += l[z] + l[z + 1];</div><div class="t m5 x74 h2f y633 ffb fs10 fc0 sc0 ls0 ws0">        z += 2;</div><div class="t m5 x74 h2f y634 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y635 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y9e2 ffb fs10 fc0 sc0 ls0 ws0">    return q;</div><div class="t m5 x74 h2f ye37 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y9f6 ff8 fs3 fc0 sc0 ls0 ws251">Here is the code the w<span class="_ _4"></span>ay it should be written. <span class="_ _1"></span>This snippet is actually less complete</div><div class="t m0 xd h14 y9f7 ff8 fs3 fc0 sc0 ls0 ws4aa">than the one abo<span class="_ _4"></span>ve. <span class="_ _0"></span>Y<span class="_ _3"></span>et you can infer immediatel<span class="_ _4"></span>y what it is trying to do, and you could</div><div class="t m0 xd h14 yeea ff8 fs3 fc0 sc0 ls0 ws574">very likel<span class="_ _4"></span>y write the missing functions based on that infer<span class="_ _8"></span>red meaning. <span class="_ _4"></span>The magic num-</div><div class="t m0 xd h14 yb88 ff8 fs3 fc0 sc0 ls0 ws0">bers are no longer magic, and the structure of the algorithm is compellingly descripti<span class="_ _4"></span>ve.</div><div class="t m5 x74 h2f y884 ffb fs10 fc0 sc0 ls14 ws235">  public int score() {</div><div class="t m5 x74 h2f y885 ffb fs10 fc0 sc0 ls0 ws0">    int score = 0;</div><div class="t m5 x74 h2f y886 ffb fs10 fc0 sc0 ls0 ws0">    int frame = 0;</div><div class="t m5 x74 h2f y887 ffb fs10 fc0 sc0 ls0 ws0">    for (int frameNumber = 0; frameNumber &lt; 10; frameNumber++) {</div><div class="t m5 x74 h2f y888 ffb fs10 fc0 sc0 ls0 ws0">      if (isStrike(frame)) {</div><div class="t m5 x74 h2f y889 ffb fs10 fc0 sc0 ls0 ws0">        score += 10 + nextTwoBallsForStrike(frame);</div><div class="t m5 x74 h2f y88a ffb fs10 fc0 sc0 ls0 ws0">        frame += 1;</div><div class="t m5 x74 h2f y88b ffb fs10 fc0 sc0 ls0 ws0">      } else if (isSpare(frame)) {</div><div class="t m5 x74 h2f y88c ffb fs10 fc0 sc0 ls0 ws0">        score += 10 + nextBallForSpare(frame);</div><div class="t m5 x74 h2f y88d ffb fs10 fc0 sc0 ls0 ws0">        frame += 2;</div><div class="t m5 x74 h2f y88e ffb fs10 fc0 sc0 ls0 ws0">      } else {</div><div class="t m5 x74 h2f y88f ffb fs10 fc0 sc0 ls0 ws0">        score += twoBallsInFrame(frame);</div><div class="t m5 x74 h2f y890 ffb fs10 fc0 sc0 ls0 ws0">        frame += 2;</div><div class="t m5 x74 h2f y891 ffb fs10 fc0 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y892 ffb fs10 fc0 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y893 ffb fs10 fc0 sc0 ls0 ws0">    return score;</div><div class="t m5 x74 h2f y894 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x74 h14 y1163 ff8 fs3 fc0 sc0 ls0 ws43c">The po<span class="_ _4"></span>w<span class="_ _4"></span>er of carefully chosen names is that the<span class="_ _4"></span>y o<span class="_ _4"></span>verload the structure of the code</div><div class="t m0 xd h14 y1249 ff8 fs3 fc0 sc0 ls0 ws782">with description. <span class="_ _1"></span>That ov<span class="_ _4"></span>erloading sets the readers’<span class="_ _1"></span> expectations about w<span class="_ _4"></span>hat the other</div><div class="t m0 xd h14 y1442 ff8 fs3 fc0 sc0 ls0 ws31a">functions in the module do. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can infer the implementation of </div><div class="t m5 x49 h2f y1442 ffb fs10 fc0 sc0 ls0 ws0">isStrike()</div><div class="t m0 xa6 h14 y1442 ff8 fs3 fc0 sc0 ls0 ws31a">b<span class="_ _4"></span>y looking at</div><div class="t m0 xd h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws783">the code abo<span class="_ _4"></span>ve. <span class="_ _4"></span>When you read the </div><div class="t m5 x26 h2f y4b2 ffb fs10 fc0 sc0 ls0 ws0">isStrike</div><div class="t m0 x23 h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws783">method<span class="_ _1"></span>, it will be “pretty much what y<span class="_ _4"></span>ou</div><div class="t m0 xd h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws0">expected.<span class="_ _0"></span>”</div><div class="t m0 x80 h21 y367 ff8 fsc fc0 sc0 ls0 ws0">13</div><div class="t m5 x74 h2f y1443 ffb fs10 fc0 sc0 ls14 ws253">  private boolean isStrike(int frame) {</div><div class="t m5 x74 h2f y1444 ffb fs10 fc0 sc0 ls0 ws0">    return rolls[frame] == 10;</div><div class="t m5 x74 h2f y1445 ffb fs10 fc0 sc0 ls0 ws0">  }</div><div class="t m0 xd h25 y1446 ff8 fse fc0 sc0 ls0 ws0">13.<span class="_ _16"> </span>See <span class="_ _4"></span>W<span class="_ _4"></span>ard Cunningham’<span class="_ _0"></span>s quote on page 11.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf156" class="pf w1 h2" data-page-no="156"><div class="pc pc156 w1 h2"><img class="bi x37 y1441 w8 h27" alt="" src="bg156.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">311<span class="_ _10"></span><span class="ff1">Names</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">N2:<span class="_ _4"></span> <span class="ff5">Choose Names at the <span class="_ _0"></span>Appropriate Level of <span class="_ _2"></span>Abstraction</span></div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws75f">Don’<span class="_ _1"></span>t pick names that communicate implementation; choose names the reﬂect the level of</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 lsc ws50e">abstraction of the class or function you are w<span class="_ _1"></span>orking in. <span class="_ _4"></span>This is hard to do. <span class="_ _4"></span>Again, people</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws3f6">are just too good at mixing le<span class="_ _4"></span>vels of abstractions. Each time you mak<span class="_ _4"></span>e a pass o<span class="_ _4"></span>ver your</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws776">code, you will lik<span class="_ _4"></span>ely ﬁnd some v<span class="_ _4"></span>ariable that is named at too lo<span class="_ _1"></span>w a level. <span class="_ _0"></span>Y<span class="_ _3"></span>ou should take</div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws784">the opportunity to change those names when you ﬁnd them. Making code readab<span class="_ _4"></span>le</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">requires a dedication to continuous impro<span class="_ _4"></span>vement. Consider the </div><div class="t m5 xab h2f y56e ffb fs10 fc0 sc0 ls0 ws0">Modem</div><div class="t m0 x73 h14 y56e ff8 fs3 fc0 sc0 ls0 ws0"> interface belo<span class="_ _4"></span>w:</div><div class="t m5 x74 h2f y6e2 ffb fs10 fc0 sc0 ls0 ws0">public interface Modem {</div><div class="t m5 x74 h2f y6e3 ffb fs10 fc0 sc0 ls0 ws0">  boolean dial(String phoneNumber);</div><div class="t m5 x74 h2f yef9 ffb fs10 fc0 sc0 ls0 ws0">  boolean disconnect();</div><div class="t m5 x74 h2f yefa ffb fs10 fc0 sc0 ls0 ws0">  boolean send(char c);</div><div class="t m5 x74 h2f yefb ffb fs10 fc0 sc0 ls0 ws0">  char recv();</div><div class="t m5 x74 h2f yefc ffb fs10 fc0 sc0 ls0 ws0">  String getConnectedPhoneNumber();</div><div class="t m5 x74 h2f yefd ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y9ce ff8 fs3 fc0 sc0 ls0 wsbe">At ﬁrst this looks ﬁne. <span class="_ _1"></span>The functions all seem appropriate. Indeed<span class="_ _4"></span>, for many applications</div><div class="t m0 xd h14 y9cf ff8 fs3 fc0 sc0 ls0 ws5d6">they are. But no<span class="_ _1"></span>w consider an application in which some modems aren’<span class="_ _1"></span>t connected by</div><div class="t m0 xd h14 y9d0 ff8 fs3 fc0 sc0 ls0 ws568">dialling. Rather they are connected permanently b<span class="_ _4"></span>y hard wiring them to<span class="_ _4"></span>gether (think of the</div><div class="t m0 xd h14 y9d1 ff8 fs3 fc0 sc0 ls0 ws59c">cable modems that pro<span class="_ _1"></span>vide Inter<span class="_ _8"></span>net access to most homes no<span class="_ _4"></span>wada<span class="_ _1"></span>ys). Perhaps some are</div><div class="t m0 xd h14 y51b ff8 fs3 fc0 sc0 ls0 ws212">connected b<span class="_ _4"></span>y sending a por<span class="_ _8"></span>t number to a switch o<span class="_ _1"></span>ver a USB connection. Clearly the notion</div><div class="t m0 xd h14 y51c ff8 fs3 fc0 sc0 ls0 ws785">of phone numbers is at the wrong le<span class="_ _4"></span>vel of abstraction. <span class="_ _1"></span>A better naming strategy for this</div><div class="t m0 xd h14 y51d ff8 fs3 fc0 sc0 ls0 ws0">scenario might be:</div><div class="t m5 x74 h2f y71f ffb fs10 fc0 sc0 ls0 ws0">public interface Modem {</div><div class="t m5 x74 h2f y720 ffb fs10 fc0 sc0 ls0 ws0">  boolean connect(String connectionLocator);</div><div class="t m5 x74 h2f y721 ffb fs10 fc0 sc0 ls0 ws0">  boolean disconnect();</div><div class="t m5 x74 h2f y722 ffb fs10 fc0 sc0 ls0 ws0">  boolean send(char c);</div><div class="t m5 x74 h2f y723 ffb fs10 fc0 sc0 ls0 ws0">  char recv();</div><div class="t m5 x74 h2f y724 ffb fs10 fc0 sc0 ls0 ws0">  String getConnectedLocator();</div><div class="t m5 x74 h2f y725 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y38f ff8 fs3 fc0 sc0 ls0 ws47c">No<span class="_ _4"></span>w the names don’<span class="_ _4"></span>t make an<span class="_ _4"></span>y commitments about phone numbers. <span class="_ _4"></span>They can still be used</div><div class="t m0 xd h14 y670 ff8 fs3 fc0 sc0 ls0 ws0">for phone numbers, or they could be used for an<span class="_ _4"></span>y other kind of connection strategy<span class="_ _0"></span>. </div><div class="t m0 xd h11 y60b ff1 fs7 fc0 sc0 ls0 ws0">N3:<span class="_ _4"></span> <span class="ff5">Use Standard Nomenclatur<span class="_ _4"></span>e <span class="_ _0"></span>Where P<span class="_ _1"></span>ossible</span></div><div class="t m0 xd h14 y315 ff8 fs3 fc0 sc0 ls3d ws786">Names are easier to understand if they are based on e<span class="_ _4"></span>xisting con<span class="_ _4"></span>vention or usage. F<span class="_ _4"></span>or exam-</div><div class="t m0 xd h14 y22a ff8 fs3 fc0 sc0 ls3d ws540">ple, if you are using the D</div><div class="t m0 xa h14 y458 ff8 fsb fc0 sc0 ls92 ws0">ECORATOR<span class="fs3 ls93 ws787"> pattern, you should use the w<span class="_ _4"></span>ord </span></div><div class="t m5 x82 h2f y458 ffb fs10 fc0 sc0 ls41 ws0">Decorator</div><div class="t m0 xf4 h14 y458 ff8 fs3 fc0 sc0 ls94 ws4a0"> in the names</div><div class="t m0 xd h14 y459 ff8 fs3 fc0 sc0 ls3d ws788">of the decorating classes. F<span class="_ _1"></span>or example, </div><div class="t m5 x48 h2f y459 ffb fs10 fc0 sc0 ls41 ws0">AutoHangupModemDecorator</div><div class="t m0 xb5 h14 y459 ff8 fs3 fc0 sc0 ls3d ws788">might be the name of a</div><div class="t m0 xd h14 y45a ff8 fs3 fc0 sc0 ls3d ws0">class that decorates a </div><div class="t m5 xb h2f y45a ffb fs10 fc0 sc0 ls41 ws0">Modem</div><div class="t m0 x7d h14 y45a ff8 fs3 fc0 sc0 ls3d ws0"> with the ability to automaticall<span class="_ _4"></span>y hang up at the end of a session.</div><div class="t m0 x74 h14 y3af ff8 fs3 fc0 sc0 ls0 ws34b">Patterns are just one kind of standard. In Ja<span class="_ _4"></span>va, for e<span class="_ _4"></span>xample, functions that conv<span class="_ _4"></span>er<span class="_ _8"></span>t</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 ws409">objects to string representations are often named </div><div class="t m5 x4f h2f yc00 ffb fs10 fc0 sc0 ls0 ws0">toString</div><div class="t m0 x69 h14 yc00 ff8 fs3 fc0 sc0 ls0 ws409">. It is better to follo<span class="_ _4"></span>w con<span class="_ _4"></span>ven-</div><div class="t m0 xd h14 yde2 ff8 fs3 fc0 sc0 ls0 ws0">tions like these than to in<span class="_ _1"></span>vent your o<span class="_ _1"></span>wn. </div><div class="t m0 x74 h14 y31c ff8 fs3 fc0 sc0 ls0 ws491">T<span class="_ _0"></span>eams will often in<span class="_ _4"></span>vent their o<span class="_ _1"></span>wn standard system of names for a par<span class="_ _8"></span>ticular project.</div><div class="t m0 xd h14 y42f ff8 fs3 fc0 sc0 ls0 ws559">Eric Evans refers to this as a <span class="_ _4"></span><span class="ffa">ubiquitous language <span class="ff8">for the project.</span></span></div><div class="t m0 xb9 h21 y2ef ff8 fsc fc0 sc0 ls0 ws0">14</div><div class="t m0 x58 h14 y42f ff8 fs3 fc0 sc0 ls0 ws559">Y<span class="_ _3"></span>our code should use</div><div class="t m0 xd h25 y1446 ff8 fse fc0 sc0 ls0 ws0">14.<span class="_ _16"> </span>[DDD].</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:288.506000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:218.728010px;width:238.838000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf157" class="pf w1 h2" data-page-no="157"><div class="pc pc157 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">312<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws789">the terms from this language extensiv<span class="_ _4"></span>ely<span class="_ _0"></span>. In short, the more you can use names that are</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws6d">o<span class="_ _4"></span>verloaded with special meanings that are rele<span class="_ _4"></span>vant to y<span class="_ _4"></span>our project, the easier it will be for</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">readers to kno<span class="_ _4"></span>w what y<span class="_ _4"></span>our code is talking about.</div><div class="t m0 xd h11 y6e1 ff1 fs7 fc0 sc0 ls0 ws0">N4:<span class="_ _4"></span> <span class="ff5">Unambiguous Names</span></div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws456">Choose names that make the w<span class="_ _1"></span>orkings of a function or variable unambiguous. Consider</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">this example from F<span class="_ _4"></span>itNesse:</div><div class="t m5 x52 h2f y6e2 ffb fs10 fc0 sc0 ls0 ws0">private String doRename() throws Exception</div><div class="t m5 x52 h2f y6e3 ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f yef9 ffb fs10 fc0 sc0 ls18 ws3b9">  if(refactorReferences)</div><div class="t m5 x52 h2f yefa ffb fs10 fc0 sc0 ls1a ws2f6">    renameReferences();</div><div class="t m5 x52 h2f yefb ffb fs10 fc0 sc0 ls1f ws3b8">  renamePage();</div><div class="t m5 x52 h2f yefd ffb fs10 fc0 sc0 ls18 ws3b8">  pathToRename.removeNameFromEnd();</div><div class="t m5 x52 h2f yefe ffb fs10 fc0 sc0 ls18 ws3b8">  pathToRename.addNameToEnd(newName);</div><div class="t m5 x52 h2f yeff ffb fs10 fc0 sc0 ls14 ws2f1">  return PathParser.render(pathToRename);</div><div class="t m5 x52 h2f yf00 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y28 ff8 fs3 fc0 sc0 ls0 ws294">The name of this function does not sa<span class="_ _4"></span>y what the function does e<span class="_ _4"></span>xcept in broad and vague</div><div class="t m0 xd h14 ya2b ff8 fs3 fc0 sc0 ls0 ws3a8">terms. <span class="_ _4"></span>This is emphasized by the fact that there is a function named </div><div class="t m5 x73 h2f ya2b ffb fs10 fc0 sc0 ls0 ws0">renamePage</div><div class="t m0 xda h14 ya2b ff8 fs3 fc0 sc0 ls0 ws3a8">inside the</div><div class="t m0 xd h14 ya2c ff8 fs3 fc0 sc0 ls0 ws78a">function named </div><div class="t m5 x3a h2f ya2c ffb fs10 fc0 sc0 ls0 ws0">doRename</div><div class="t m0 xf8 h14 ya2c ff8 fs3 fc0 sc0 ls0 ws78a">! <span class="_ _4"></span>What do the names tell you about the dif<span class="_ _4"></span>ference between the</div><div class="t m0 xd h14 y9d2 ff8 fs3 fc0 sc0 ls0 ws0">tw<span class="_ _4"></span>o functions? Nothing.</div><div class="t m0 x74 h14 y804 ff8 fs3 fc0 sc0 ls0 ws618">A better name for that function is </div><div class="t m5 x83 h2f y804 ffb fs10 fc0 sc0 ls0 ws0">renamePageAndOptionallyAllReferences</div><div class="t m0 x93 h14 y804 ff8 fs3 fc0 sc0 ls0 ws186">. This <span class="_ _8"></span>may</div><div class="t m0 xd h14 y13ac ff8 fs3 fc0 sc0 lsd ws78b">seem long, and it is, but it’<span class="_ _2"></span>s only called from one place in the module, so it’<span class="_ _3"></span>s explanatory</div><div class="t m0 xd h14 y1447 ff8 fs3 fc0 sc0 ls0 ws0">value outw<span class="_ _1"></span>eighs the length. </div><div class="t m0 xd h11 yb5f ff1 fs7 fc0 sc0 ls0 ws0">N5:<span class="_ _4"></span> <span class="ff5">Use Long Names for Long Scopes</span></div><div class="t m0 xd h14 y48e ff8 fs3 fc0 sc0 ls0 ws1d5">The length of a name should be related to the length of the scope. <span class="_ _0"></span>Y<span class="_ _2"></span>ou can use very short</div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 lsd wsef">v<span class="_ _4"></span>ariable names for tin<span class="_ _4"></span>y scopes, but for big scopes you should use longer names.</div><div class="t m0 x74 h14 y550 ff8 fs3 fc0 sc0 ls0 ws214">V<span class="_ _0"></span>ariab<span class="_ _4"></span>le names like </div><div class="t m5 xa h2f y550 ffb fs10 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa4 h14 y550 ff8 fs3 fc0 sc0 ls0 ws0">and</div><div class="t m5 x38 h2f y550 ffb fs10 fc0 sc0 ls0 ws0">j</div><div class="t m0 x92 h14 y550 ff8 fs3 fc0 sc0 ls0 ws214">are just ﬁne if their scope is ﬁve lines long. Consider this</div><div class="t m0 xd h14 y2cb ff8 fs3 fc0 sc0 ls0 ws0">snippet from the old standard “Bo<span class="_ _4"></span>wling Game”:</div><div class="t m5 x52 h2f y7be ffb fs10 fc0 sc0 ls0 ws0">private void rollMany(int n, int pins)</div><div class="t m5 x52 h2f y7bf ffb fs10 fc0 sc0 ls0 ws0">{</div><div class="t m5 x52 h2f y1448 ffb fs10 fc0 sc0 ls14 ws253">  for (int i=0; i&lt;n; i++)</div><div class="t m5 x52 h2f y1449 ffb fs10 fc0 sc0 ls20 ws2f1">    g.roll(pins);</div><div class="t m5 x52 h2f y144a ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y3ae ff8 fs3 fc0 sc0 ls0 ws2e2">This is perfectl<span class="_ _4"></span>y clear and would be obfuscated if the v<span class="_ _4"></span>ariable </div><div class="t m5 xca h2f y3ae ffb fs10 fc0 sc0 ls0 ws0">i</div><div class="t m0 xf3 h14 y3ae ff8 fs3 fc0 sc0 ls0 ws2e2">w<span class="_ _4"></span>ere replaced with some-</div><div class="t m0 xd h14 y3af ff8 fs3 fc0 sc0 ls0 wsd2">thing anno<span class="_ _4"></span>ying like </div><div class="t m5 xba h2f y3af ffb fs10 fc0 sc0 ls0 ws0">rollCount</div><div class="t m0 x5a h14 y3af ff8 fs3 fc0 sc0 ls0 wsd2">. On the other hand<span class="_ _1"></span>, variab<span class="_ _4"></span>les and functions with shor<span class="_ _8"></span>t names</div><div class="t m0 xd h14 yc00 ff8 fs3 fc0 sc0 ls0 ws94">lose their meaning o<span class="_ _4"></span>ver long distances. So the longer the scope of the name, the longer and</div><div class="t m0 xd h14 yde2 ff8 fs3 fc0 sc0 ls0 ws0">more precise the name should be.</div><div class="t m0 xd h11 y144b ff1 fs7 fc0 sc0 ls0 ws0">N6:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5">A<span class="_ _0"></span>void Encodings</span></div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls4b ws463">Names should not be encoded with type or scope information. Preﬁxes such as </div><div class="t m5 xe6 h2f y13e2 ffb fs10 fc0 sc0 ls78 ws0">m_</div><div class="t m0 x29 h14 y13e2 ff8 fs3 fc0 sc0 ls4b ws0">or</div><div class="t m5 x35 h2f y13e2 ffb fs10 fc0 sc0 ls0 ws0">f</div><div class="t m0 xd h14 y144c ff8 fs3 fc0 sc0 ls4b ws2b4">are useless in toda<span class="_ _4"></span>y’<span class="_ _2"></span>s en<span class="_ _4"></span>vironments. <span class="_ _4"></span>Also project and/or subsystem encodings such as</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:534.728010px;width:128.300000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:287.728010px;width:189.308000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:97.728110px;width:103.608000px;height:13.367900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf158" class="pf w1 h2" data-page-no="158"><div class="pc pc158 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">313<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>ests</span></div><div class="t m5 xd h2f y194 ffb fs10 fc0 sc0 ls78 ws0">vis_</div><div class="t m0 x8e h14 y194 ff8 fs3 fc0 sc0 ls85 ws88">(for visual imaging system) are distracting and redundant. <span class="_ _1"></span>Again, today’<span class="_ _3"></span>s environ-</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls85 ws78c">ments pro<span class="_ _4"></span>vide all that information without having to mangle the names. K<span class="_ _4"></span>eep your</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls85 ws3f">names free of Hungarian pollution.</div><div class="t m0 xd h11 y6e1 ff1 fs7 fc0 sc0 ls0 ws0">N7:<span class="_ _4"></span> <span class="ff5">Names Should Describe Side-Eff<span class="_ _4"></span>ects</span></div><div class="t m0 xd h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws5bb">Names should describe e<span class="_ _4"></span>verything that a function, variable, or class is or does. Don’<span class="_ _1"></span>t hide</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 wsc9">side effects with a name. Don’<span class="_ _1"></span>t use a simple verb to describe a function that does more</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws0">than just that simple action. F<span class="_ _1"></span>or example, consider this code from T<span class="_ _0"></span>estNG:</div><div class="t m5 x74 h2f y7e4 ffb fs10 fc0 sc0 ls0 ws0">public ObjectOutputStream getOos() throws IOException {</div><div class="t m5 x52 h2f y7e5 ffb fs10 fc0 sc0 ls0 ws0">if (m_oos == null) {</div><div class="t m5 x8a h2f y7e6 ffb fs10 fc0 sc0 ls0 ws0">m_oos = new ObjectOutputStream(m_socket.getOutputStream());</div><div class="t m5 x52 h2f y7e7 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m5 x52 h2f y7e8 ffb fs10 fc0 sc0 ls0 ws0">return m_oos;</div><div class="t m5 x74 h2f y7e9 ffb fs10 fc0 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y730 ff8 fs3 fc0 sc0 ls0 ws78b">This function does a bit more than get an “oos”; it creates the “oos” if it hasn’<span class="_ _1"></span>t been cre-</div><div class="t m0 xd h14 ya2a ff8 fs3 fc0 sc0 ls0 ws0">ated already<span class="_ _0"></span>. <span class="_ _4"></span>Thus, a better name might be </div><div class="t m5 xc4 h2f ya2a ffb fs10 fc0 sc0 ls0 ws0">createOrReturnOos</div><div class="t m0 xf7 h14 ya2a ff8 fs3 fc0 sc0 ls0 ws0">.</div><div class="t m0 xd h17 y144d ff1 fs9 fc0 sc0 ls0 ws0">T<span class="_ _2"></span>ests</div><div class="t m0 xd h11 y917 ff1 fs7 fc0 sc0 ls0 ws0">T1:<span class="_ _4"></span> <span class="ff5 ws77a">Insufﬁcient T<span class="_ _2"></span>ests</span></div><div class="t m0 xd h14 y57a ff8 fs3 fc0 sc0 ls0 ws20b">Ho<span class="_ _4"></span>w many tests should be in a test suite? Unfortunatel<span class="_ _4"></span>y<span class="_ _1"></span>, the metric many pro<span class="_ _4"></span>grammers use</div><div class="t m0 xd h14 y57b ff8 fs3 fc0 sc0 ls0 ws78d">is “That seems like enough.<span class="_ _0"></span>” <span class="_ _4"></span>A test suite should test ev<span class="_ _4"></span>er<span class="_ _8"></span>ything that could possibl<span class="_ _4"></span>y break.</div><div class="t m0 xd h14 y57c ff8 fs3 fc0 sc0 ls0 wsc8">The tests are insuf<span class="_ _4"></span>ﬁcient so long as there are conditions that hav<span class="_ _4"></span>e not been explored b<span class="_ _4"></span>y the</div><div class="t m0 xd h14 y74e ff8 fs3 fc0 sc0 ls0 ws0">tests or calculations that ha<span class="_ _4"></span>ve not been v<span class="_ _4"></span>alidated.</div><div class="t m0 xd h11 y5e3 ff1 fs7 fc0 sc0 ls0 ws0">T2:<span class="_ _4"></span> <span class="ff5">Use a Cov<span class="_ _4"></span>e<span class="lsa ws78e">rage T<span class="_ _1"></span><span class="ls0 ws0">ool!</span></span></span></div><div class="t m0 xd h14 yd2e ff8 fs3 fc0 sc0 lsc ws747">Co<span class="_ _4"></span>verage tools reports gaps in your testing strate<span class="_ _4"></span>gy<span class="_ _1"></span>. <span class="_ _4"></span>They mak<span class="_ _4"></span>e it easy to ﬁnd modules,</div><div class="t m0 xd h14 y2f8 ff8 fs3 fc0 sc0 ls0 ws194">classes, and functions that are insuf<span class="_ _4"></span>ﬁciently tested. Most IDEs gi<span class="_ _4"></span>ve you a visual indication,</div><div class="t m0 xd h14 y2f9 ff8 fs3 fc0 sc0 ls0 ws64e">marking lines that are co<span class="_ _4"></span>vered in green and those that are unco<span class="_ _4"></span>vered in red. <span class="_ _1"></span>This makes it</div><div class="t m0 xd h14 y2fa ff8 fs3 fc0 sc0 ls0 ws0">quick and easy to ﬁnd </div><div class="t m5 x4 h2f y47b ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xa h14 y47b ff8 fs3 fc0 sc0 ls0 ws0"> or </div><div class="t m5 x57 h2f y47b ffb fs10 fc0 sc0 ls0 ws0">catch</div><div class="t m0 x8 h14 y47b ff8 fs3 fc0 sc0 ls0 ws0"> statements whose bodies ha<span class="_ _1"></span>ven’<span class="_ _4"></span>t been checked.</div><div class="t m0 xd h11 y144e ff1 fs7 fc0 sc0 ls0 ws0">T3:<span class="_ _4"></span> <span class="ff5">Don’<span class="_ _4"></span>t Skip T<span class="_ _1"></span>rivial <span class="_ _4"></span>T<span class="_ _0"></span>ests</span></div><div class="t m0 xd h14 yeda ff8 fs3 fc0 sc0 ls0 ws46e">They are easy to write and their documentary value is higher than the cost to produce</div><div class="t m0 xd h14 y5b6 ff8 fs3 fc0 sc0 ls0 ws0">them.</div><div class="t m0 xd h11 y13ef ff1 fs7 fc0 sc0 ls0 ws0">T4:<span class="_ _4"></span> <span class="_ _0"></span><span class="ff5">An Ignored <span class="_ _1"></span>T<span class="_ _0"></span>est Is a Question about an <span class="_ _0"></span>Ambiguity</span></div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws78f">Sometimes w<span class="_ _4"></span>e are uncer<span class="_ _8"></span>tain about a beha<span class="_ _4"></span>vioral detail because the requirements are</div><div class="t m0 xd h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws437">unclear<span class="_ _1"></span>. W<span class="_ _0"></span>e can e<span class="_ _4"></span>xpress our question about the requirements as a test that is commented</div><div class="t m0 xd h14 y557 ff8 fs3 fc0 sc0 ls0 ws6d">out, or as a test that annotated with </div><div class="t m5 x5b h2f y557 ffb fs10 fc0 sc0 ls0 ws0">@Ignore</div><div class="t m0 xad h14 y557 ff8 fs3 fc0 sc0 ls0 ws6d">. <span class="_ _4"></span>Which you choose depends upon w<span class="_ _4"></span>hether the</div><div class="t m0 xd h14 yba6 ff8 fs3 fc0 sc0 ls0 ws0">ambiguity is about something that w<span class="_ _4"></span>ould compile or not.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:534.728010px;width:202.426000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:366.945010px;width:29.822000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:340.728010px;width:104.512000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:258.728010px;width:125.649000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:176.728010px;width:136.230000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:118.728010px;width:267.667000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf159" class="pf w1 h2" data-page-no="159"><div class="pc pc159 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">314<span class="_ _3e"> </span><span class="ff1 ws46">Chapter 17:<span class="_ _4"></span> Smells and Heuristics</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc0 sc0 ls0 ws0">T5:<span class="_ _4"></span> <span class="_ _4"></span><span class="ff5">T<span class="_ _0"></span>est Boundary Conditions</span></div><div class="t m0 xd h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws22e">T<span class="_ _0"></span>ake special care to test boundar<span class="_ _8"></span>y conditions. <span class="_ _4"></span>W<span class="_ _0"></span>e often get the middle of an algorithm</div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 lsd wsef">right but misjudge the boundaries.</div><div class="t m0 xd h11 y24c ff1 fs7 fc0 sc0 ls0 ws0">T6:<span class="_ _4"></span> <span class="ff5">Exhaustively <span class="_ _1"></span>T<span class="_ _0"></span>est Near Bugs</span></div><div class="t m0 xd h14 y299 ff8 fs3 fc0 sc0 ls0 ws75">Bugs tend to congregate. <span class="_ _4"></span>When you ﬁnd a bug in a function, it is wise to do an exhausti<span class="_ _4"></span>ve</div><div class="t m0 xd h14 y29a ff8 fs3 fc0 sc0 lsd wsef">test of that function. <span class="_ _0"></span>Y<span class="_ _2"></span>ou’<span class="_ _4"></span>ll probabl<span class="_ _4"></span>y ﬁnd that the bug w<span class="_ _4"></span>as not alone.</div><div class="t m0 xd h11 y144f ff1 fs7 fc0 sc0 ls0 ws0">T7:<span class="_ _4"></span> <span class="ff5">P<span class="_ _1"></span>atterns of F<span class="_ _2"></span>ailure <span class="_ _0"></span>Are Rev<span class="_ _4"></span>ealing</span></div><div class="t m0 xd h14 y21a ff8 fs3 fc0 sc0 ls0 ws790">Sometimes you can diagnose a prob<span class="_ _4"></span>lem by ﬁnding patterns in the w<span class="_ _4"></span>ay the test cases fail.</div><div class="t m0 xd h14 y21b ff8 fs3 fc0 sc0 ls0 ws677">This is another argument for making the test cases as complete as possib<span class="_ _4"></span>le. Complete test</div><div class="t m0 xd h14 y21c ff8 fs3 fc0 sc0 ls0 ws0">cases, ordered in a reasonable w<span class="_ _4"></span>a<span class="_ _4"></span>y<span class="_ _0"></span>, expose patter<span class="_ _8"></span>ns. </div><div class="t m0 x74 h14 y20c ff8 fs3 fc0 sc0 ls0 ws12e">As a simple example, suppose y<span class="_ _4"></span>ou noticed that all tests with an input larger than ﬁve</div><div class="t m0 xd h14 y21d ff8 fs3 fc0 sc0 lsc ws152">characters failed? Or what if an<span class="_ _4"></span>y test that passed a negati<span class="_ _4"></span>ve number into the second argu-</div><div class="t m0 xd h14 y21e ff8 fs3 fc0 sc0 ls0 ws47a">ment of a function failed? Sometimes just seeing the patter<span class="_ _8"></span>n of red and green on the test</div><div class="t m0 xd h14 y21f ff8 fs3 fc0 sc0 ls0 ws508">report is enough to spark the “<span class="_ _1"></span>Aha!” that leads to the solution. Look back at page <span class="_ _4"></span>267 to</div><div class="t m0 xd h14 y220 ff8 fs3 fc0 sc0 ls0 ws0">see an interesting example of this in the </div><div class="t m5 x83 h2f y568 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x54 h14 y568 ff8 fs3 fc0 sc0 ls0 ws0"> example. </div><div class="t m0 xd h11 y1450 ff1 fs7 fc0 sc0 ls0 ws0">T8:<span class="_ _4"></span> <span class="_ _4"></span><span class="ff5">T<span class="_ _0"></span>est Co<span class="_ _4"></span>ve<span class="lsa ws791">rage P<span class="_ _4"></span><span class="ls0 ws0">atterns Can Be Revealing</span></span></span></div><div class="t m0 xd h14 y468 ff8 fs3 fc0 sc0 ls0 ws68f">Looking at the code that is or is not ex<span class="_ _4"></span>ecuted b<span class="_ _4"></span>y the passing tests gives clues to w<span class="_ _4"></span>h<span class="_ _4"></span>y the</div><div class="t m0 xd h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">failing tests fail.</div><div class="t m0 xd h11 y5d5 ff1 fs7 fc0 sc0 ls0 ws0">T9:<span class="_ _b"> </span><span class="ff5">T<span class="_ _0"></span>ests Should Be F<span class="_ _2"></span>ast</span></div><div class="t m0 xd h14 y37a ff8 fs3 fc0 sc0 ls0 ws5a3">A slo<span class="_ _4"></span>w test is a test that w<span class="_ _4"></span>on’<span class="_ _4"></span>t get run. When things get tight, it’<span class="_ _2"></span>s the slo<span class="_ _4"></span>w tests that will be</div><div class="t m0 xd h14 y37b ff8 fs3 fc0 sc0 ls0 ws0">dropped from the suite. So <span class="ffa">do what you must </span>to k<span class="_ _4"></span>eep your tests fast.</div><div class="t m0 xd h17 y1451 ff1 fs9 fc0 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y2e8 ff8 fs3 fc0 sc0 ls0 ws305">This list of heuristics and smells could hardly be said to be complete. Indeed<span class="_ _0"></span>, I’m not sure</div><div class="t m0 xd h14 y2e9 ff8 fs3 fc0 sc0 ls0 ws456">that such a list can <span class="ffa ws0">ever<span class="_ _18"> </span></span>be complete. But perhaps completeness should not be the goal,</div><div class="t m0 xd h14 y2ea ff8 fs3 fc0 sc0 ls0 ws0">because what this list <span class="ffa">does</span> do is impl<span class="_ _4"></span>y a v<span class="_ _4"></span>alue system. </div><div class="t m0 x74 h14 y8e1 ff8 fs3 fc0 sc0 ls16 ws792">Indeed<span class="_ _1"></span>, that value system has been the goal, and the topic, of this book. Clean code is</div><div class="t m0 xd h14 yc1d ff8 fs3 fc0 sc0 ls16 ws718">not written b<span class="_ _4"></span>y following a set of rules. <span class="_ _0"></span>Y<span class="_ _2"></span>ou don’<span class="_ _1"></span>t become a software craftsman b<span class="_ _4"></span>y lear<span class="_ _8"></span>n-</div><div class="t m0 xd h14 y2ed ff8 fs3 fc0 sc0 ls16 ws6b8">ing a list of heuristics. Professionalism and craftsmanship come from values that dri<span class="_ _1"></span>ve</div><div class="t m0 xd h14 y2ee ff8 fs3 fc0 sc0 ls16 ws0">disciplines.</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:149.077000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:524.728010px;width:162.542000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:466.728010px;width:185.106000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:333.728010px;width:224.258000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:275.728010px;width:122.634000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:209.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15a" class="pf w1 h2" data-page-no="15a"><div class="pc pc15a w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">315<span class="_ _10"></span><span class="ff1">Biblio<span class="_ _4"></span>graph<span class="_ _4"></span>y</span></div><div class="t m0 xd h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">Bib<span class="_ _4"></span>liograph<span class="_ _1"></span>y</div><div class="t m0 xd h14 yd16 ff1 fs3 fc0 sc0 ls0 wsa0">[Refactoring]:<span class="_ _4"></span>  <span class="ffa ls17 ws3f4">Refactoring: Impr<span class="_ _4"></span>oving the Design of Existing Code<span class="ff8">, Martin F<span class="_ _1"></span>owler et al.,</span></span></div><div class="t m0 xd h14 yd17 ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1999. </div><div class="t m0 xd h14 ya6a ff1 fs3 fc0 sc0 ls0 wsa0">[PRA<span class="_ _1"></span>G]:  <span class="ffa ws3e0">The Pr<span class="_ _1"></span>agmatic Pr<span class="_ _4"></span>o<span class="_ _4"></span>gr<span class="_ _4"></span>ammer<span class="_ _4"></span><span class="ff8">, <span class="_ _4"></span>Andrew Hunt, Da<span class="_ _1"></span>ve <span class="_ _4"></span>Thomas, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>,</span></span></div><div class="t m0 xd h14 ya6b ff8 fs3 fc0 sc0 ls0 ws0">2000.</div><div class="t m0 xd h14 y5db ff1 fs3 fc0 sc0 ls0 wsa0">[GOF]:<span class="_ _4"></span>  <span class="ffa wse4">Design P<span class="_ _1"></span>atterns: Elements of Reusab<span class="_ _4"></span>le Object Oriented Softwar<span class="_ _4"></span>e<span class="ff8">, Gamma et al.,</span></span></div><div class="t m0 xd h14 y5dc ff8 fs3 fc0 sc0 ls0 ws0">Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 1996.</div><div class="t m0 xd h14 y2ac ff1 fs3 fc0 sc0 ls0 wsa0">[Beck97]:<span class="_ _4"></span>  <span class="ffa ws0">Smalltalk Best Pr<span class="_ _4"></span>actice P<span class="_ _1"></span>atterns<span class="ff8">, Kent Beck, Prentice Hall, 1997.</span></span></div><div class="t m0 xd h14 y2ae ff1 fs3 fc0 sc0 ls0 wsa0">[Beck07]:<span class="_ _4"></span>  <span class="ffa ws0">Implementation P<span class="_ _1"></span>atterns<span class="ff8">, Kent Beck, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2008.</span></span></div><div class="t m0 xd h14 y8fb ff1 fs3 fc0 sc0 ls0 wsa0">[PPP]:<span class="_ _4"></span>  <span class="ffa ls10 ws2a5">Agile Softwar<span class="_ _4"></span>e Development: Principles, P<span class="_ _0"></span>atterns, and Pr<span class="_ _4"></span>actices<span class="ff8">, Rober<span class="_ _8"></span>t C. Martin,</span></span></div><div class="t m0 xd h14 y8fc ff8 fs3 fc0 sc0 ls0 ws0">Prentice Hall, 2002.</div><div class="t m0 xd h14 y9a2 ff1 fs3 fc0 sc0 ls0 wsa0">[DDD]:<span class="_ _4"></span>  <span class="ffa ws0">Domain Driven Design<span class="ff8">, Eric Evans, <span class="_ _1"></span>Addison-W<span class="_ _0"></span>esley<span class="_ _0"></span>, 2003.</span></span></div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:580.945010px;width:77.401000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15b" class="pf w1 h2" data-page-no="15b"><div class="pc pc15b w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15c" class="pf w1 h2" data-page-no="15c"><div class="pc pc15c w1 h2"><img class="bi xd y1452 w4 hb9" alt="" src="bg15c.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc2 sc0 ls0 ws0">317</div><div class="t m0 xcc h23 y24c ff1 fsd fc2 sc0 ls0 ws793">A<span class="_ _2"></span>ppendix A</div><div class="t m0 x3c h3 y1453 ff1 fs0 fc2 sc0 ls0 ws0">Concurr<span class="_ _1"></span>ency II</div><div class="t m0 x58 h14 y1454 ff8 fs3 fc2 sc0 ls0 ws0">b<span class="_ _4"></span>y Brett L. Schucher<span class="_ _8"></span>t</div><div class="t m0 xd h14 y1455 ff8 fs3 fc2 sc0 ls0 ws499">This appendix supports and ampliﬁes the <span class="ffa ws0">Concurrency</span> chapter on page <span class="_ _0"></span>177. It is written</div><div class="t m0 xd h14 y1456 ff8 fs3 fc2 sc0 ls0 ws794">as a series of independent topics and you can generall<span class="_ _4"></span>y read them in an<span class="_ _4"></span>y order<span class="_ _4"></span>. <span class="_ _4"></span>There is</div><div class="t m0 xd h14 y1457 ff8 fs3 fc2 sc0 ls0 ws0">some duplication betw<span class="_ _4"></span>een sections to allo<span class="_ _4"></span>w for such reading.</div><div class="t m0 xd h17 y1458 ff1 fs9 fc2 sc0 ls0 ws0">Client/Serv<span class="_ _1"></span>er Example</div><div class="t m0 xd h14 y1459 ff8 fs3 fc2 sc0 ls0 ws58b">Imagine a simple client/server application. <span class="_ _1"></span>A ser<span class="_ _8"></span>ver sits and waits listening on a sock<span class="_ _4"></span>et for</div><div class="t m0 xd h14 y145a ff8 fs3 fc2 sc0 ls0 ws0">a client to connect. <span class="_ _1"></span>A client connects and sends a request.</div><div class="t m0 xd h11 y145b ff1 fs7 fc2 sc0 ls0 ws0">The Serv<span class="_ _4"></span>er</div><div class="t m0 xd h14 y145c ff8 fs3 fc2 sc0 ls0 ws3a">Here is a simpliﬁed version of a server application. Full source for this e<span class="_ _4"></span>xample is av<span class="_ _4"></span>ail-</div><div class="t m0 xd h14 y145d ff8 fs3 fc2 sc0 ls0 ws0">able starting on page 343, <span class="ffa">Client/Server Nonthr<span class="_ _4"></span>eaded<span class="ff8">.</span></span></div><div class="t m5 x74 h2f y145e ffb fs10 fc2 sc0 ls0 ws0">ServerSocket serverSocket = new ServerSocket(8009);</div><div class="t m5 x74 h2f y145f ffb fs10 fc2 sc0 ls0 ws0">while (keepProcessing) {</div><div class="t m5 x74 h2f y1460 ffb fs10 fc2 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1461 ffb fs10 fc2 sc0 ls0 ws0">        Socket socket = serverSocket.accept();</div><div class="t m5 x74 h2f y1462 ffb fs10 fc2 sc0 ls0 ws0">        process(socket);</div><div class="t m5 x74 h2f y1463 ffb fs10 fc2 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h2f y1464 ffb fs10 fc2 sc0 ls0 ws0">        handle(e);</div><div class="t m5 x74 h2f y1465 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1466 ffb fs10 fc2 sc0 ls0 ws0">}</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:197.377000px;bottom:439.029010px;width:241.579000px;height:131.071000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:258.446010px;width:135.930000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:198.228010px;width:56.514000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15d" class="pf w1 h2" data-page-no="15d"><div class="pc pc15d w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">318<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc2 sc0 ls0 ws43d">This simple application w<span class="_ _4"></span>aits for a connection, processes an incoming message, and then</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 lsc ws270">again waits for the ne<span class="_ _4"></span>xt client request to come in. Here’<span class="_ _2"></span>s client code that connects to this</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws0">server:</div><div class="t m5 x74 h2f y403 ffb fs10 fc2 sc0 ls0 ws0">private void connectSendReceive(int i) {</div><div class="t m5 x74 h2f y404 ffb fs10 fc2 sc0 ls1b ws260">    try {</div><div class="t m5 x74 h2f y405 ffb fs10 fc2 sc0 ls19 ws236">        Socket socket = new Socket(&quot;localhost&quot;, PORT);</div><div class="t m5 x74 h2f y406 ffb fs10 fc2 sc0 ls19 ws2f6">        MessageUtils.sendMessage(socket, Integer.toString(i));</div><div class="t m5 x74 h2f y407 ffb fs10 fc2 sc0 ls1a ws2f1">        MessageUtils.getMessage(socket);</div><div class="t m5 x74 h2f y73f ffb fs10 fc2 sc0 ls3c ws237">        socket.close();</div><div class="t m5 x74 h2f y740 ffb fs10 fc2 sc0 ls19 ws235">    } catch (Exception e) {</div><div class="t m5 x74 h2f y741 ffb fs10 fc2 sc0 ls1e ws241">        e.printStackTrace();</div><div class="t m5 x74 h2f y1467 ffb fs10 fc2 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y1468 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y21b ff8 fs3 fc2 sc0 ls0 ws23">Ho<span class="_ _4"></span>w w<span class="_ _4"></span>ell does this client/ser<span class="_ _8"></span>ver pair perform? Ho<span class="_ _4"></span>w can we formally describe that perfor<span class="_ _4"></span>-</div><div class="t m0 xd h14 y21c ff8 fs3 fc2 sc0 ls0 ws0">mance? Here’<span class="_ _2"></span>s a test that asserts that the perfor<span class="_ _8"></span>mance is “acceptable”:</div><div class="t m5 x74 h2f y3ee ffb fs10 fc2 sc0 ls0 ws0">@Test(timeout = 10000)</div><div class="t m5 x74 h2f y3ef ffb fs10 fc2 sc0 ls0 ws0">public void shouldRunInUnder10Seconds() throws Exception {</div><div class="t m5 x74 h2f y3f0 ffb fs10 fc2 sc0 ls0 ws0">    Thread[] threads = createThreads();</div><div class="t m5 x74 h2f y3f1 ffb fs10 fc2 sc0 ls0 ws0">    startAllThreadsw(threads);</div><div class="t m5 x74 h2f y3f2 ffb fs10 fc2 sc0 ls0 ws0">    waitForAllThreadsToFinish(threads);</div><div class="t m5 x74 h2f y1469 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y578 ff8 fs3 fc2 sc0 ls0 wsd2">The setup is left out to keep the e<span class="_ _4"></span>xample simple (see “</div><div class="t m5 x2a h2f y578 ffb fs10 fc2 sc0 ls0 ws0">ClientTest.java</div><div class="t m0 x97 h14 y578 ff8 fs3 fc2 sc0 ls0 ws0">” on page 344). <span class="_ _1"></span>This</div><div class="t m0 xd h14 y579 ff8 fs3 fc2 sc0 ls0 ws0">test asserts that it should complete within 10,000 milliseconds.</div><div class="t m0 x74 h14 y94f ff8 fs3 fc2 sc0 ls0 ws3e7">This is a classic example of v<span class="_ _4"></span>alidating the throughput of a system. <span class="_ _4"></span>This system should</div><div class="t m0 xd h14 y950 ff8 fs3 fc2 sc0 ls0 wsf4">complete a series of client requests in ten seconds. So long as the server can process each</div><div class="t m0 xd h14 y951 ff8 fs3 fc2 sc0 ls0 ws0">individual client request in time, the test will pass.</div><div class="t m0 x74 h14 y952 ff8 fs3 fc2 sc0 ls0 ws5f2">What happens if the test fails? Shor<span class="_ _8"></span>t of dev<span class="_ _4"></span>eloping some kind of ev<span class="_ _4"></span>ent polling loop,</div><div class="t m0 xd h14 y953 ff8 fs3 fc2 sc0 ls0 ws5f0">there is not much to do within a single thread that will make this code an<span class="_ _4"></span>y faster<span class="_ _4"></span>. W<span class="_ _1"></span>ill</div><div class="t m0 xd h14 y954 ff8 fs3 fc2 sc0 ls0 ws75e">using multiple threads solve the prob<span class="_ _4"></span>lem? It might, but w<span class="_ _4"></span>e need to know w<span class="_ _4"></span>here the time is</div><div class="t m0 xd h14 y955 ff8 fs3 fc2 sc0 ls0 ws0">being spent. <span class="_ _1"></span>There are two possibilities:</div><div class="t m0 x2c h1b y3fb ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws75e">I/O—using a socket, connecting to a database, w<span class="_ _4"></span>aiting for vir<span class="_ _8"></span>tual memory swapping, </span></div><div class="t m0 x74 h14 y3fc ff8 fs3 fc2 sc0 ls0 ws0">and so on.</div><div class="t m0 x2c h1b y583 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ls95 ws63c">Processor—numerical calculations, regular e<span class="_ _4"></span>xpression processing, garbage collection, </span></div><div class="t m0 x74 h14 y6d9 ff8 fs3 fc2 sc0 ls0 ws0">and so on.</div><div class="t m0 xd h14 y8e0 ff8 fs3 fc2 sc0 lsd ws4c3">Systems typicall<span class="_ _4"></span>y hav<span class="_ _4"></span>e some of each, but for a giv<span class="_ _4"></span>en operation one tends to dominate. If</div><div class="t m0 xd h14 y8e1 ff8 fs3 fc2 sc0 ls0 ws69a">the code is processor bound<span class="_ _1"></span>, more processing hardware can impro<span class="_ _1"></span>ve throughput, making</div><div class="t m0 xd h14 yc1d ff8 fs3 fc2 sc0 ls12 ws472">our test pass. But there are onl<span class="_ _4"></span>y so many CPU cycles a<span class="_ _1"></span>vailab<span class="_ _4"></span>le, so adding threads to a</div><div class="t m0 xd h14 y2ed ff8 fs3 fc2 sc0 ls0 ws0">pro<span class="_ _8"></span>cessor-bound prob<span class="_ _4"></span>lem will not make it go faster<span class="_ _4"></span>. </div><div class="t m0 x74 h14 y73c ff8 fs3 fc2 sc0 ls0 ws634">On the other hand<span class="_ _1"></span>, if the process is I/O bound<span class="_ _4"></span>, then concur<span class="_ _8"></span>rency can increase ef<span class="_ _4"></span>ﬁ-</div><div class="t m0 xd h14 y3cb ff8 fs3 fc2 sc0 ls0 ws226">ciency<span class="_ _0"></span>. <span class="_ _4"></span>When one par<span class="_ _8"></span>t of the system is waiting for I/O<span class="_ _1"></span>, another par<span class="_ _8"></span>t can use that wait time</div><div class="t m0 xd h14 y73d ff8 fs3 fc2 sc0 ls0 ws0">to process something else, making more ef<span class="_ _4"></span>fective use of the a<span class="_ _1"></span>vailab<span class="_ _4"></span>le CPU<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15e" class="pf w1 h2" data-page-no="15e"><div class="pc pc15e w1 h2"><img class="bi x37 y146a w8 h27" alt="" src="bg15e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">319<span class="_ _10"></span><span class="ff1">Client/Serv<span class="_ _4"></span>er Example</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc2 sc0 ls0 ws18">Adding Thr<span class="_ _4"></span>eading</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc2 sc0 ls0 wsa3">Assume for the moment that the performance test f<span class="_ _8"></span>ails. Ho<span class="_ _4"></span>w can w<span class="_ _4"></span>e impro<span class="_ _4"></span>ve the through-</div><div class="t m0 xd h14 y272 ff8 fs3 fc2 sc0 ls0 ws795">put so that the performance test passes? If the </div><div class="t m5 x23 h2f y272 ffb fs10 fc2 sc0 ls0 ws0">process</div><div class="t m0 x27 h14 y272 ff8 fs3 fc2 sc0 ls0 ws795"> method of the server is I/O bound<span class="_ _1"></span>,</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc2 sc0 ls0 ws0">then here is one w<span class="_ _4"></span>ay to mak<span class="_ _4"></span>e the ser<span class="_ _8"></span>ver use threads (just change the </div><div class="t m5 x58 h2f y2a5 ffb fs10 fc2 sc0 ls0 ws0">processMessage</div><div class="t m0 xa8 h14 y2a5 ff8 fs3 fc2 sc0 ls0 ws0">):</div><div class="t m5 x74 h2f y5d8 ffb fs10 fc2 sc0 ls0 ws0">void process(final Socket socket) {</div><div class="t m5 x74 h2f y5d9 ffb fs10 fc2 sc0 ls0 ws0">    if (socket == null)</div><div class="t m5 x74 h2f y146b ffb fs10 fc2 sc0 ls0 ws0">        return;</div><div class="t m5 x74 h2f y146c ffb fs10 fc2 sc0 ls14 ws236">    Runnable clientHandler = new Runnable() {</div><div class="t m5 x74 h2f y146d ffb fs10 fc2 sc0 ls0 ws0">        public void run() {</div><div class="t m5 x74 h2f y146e ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y146f ffb fs10 fc2 sc0 ls0 ws0">                String message = MessageUtils.getMessage(socket);</div><div class="t m5 x74 h2f y1470 ffb fs10 fc2 sc0 ls0 ws0">                MessageUtils.sendMessage(socket, &quot;Processed: &quot; + message);</div><div class="t m5 x74 h2f y1471 ffb fs10 fc2 sc0 ls0 ws0">                closeIgnoringException(socket);</div><div class="t m5 x74 h2f y1472 ffb fs10 fc2 sc0 ls0 ws0">            } catch (Exception e) {</div><div class="t m5 x74 h2f y1473 ffb fs10 fc2 sc0 ls0 ws0">                e.printStackTrace();</div><div class="t m5 x74 h2f y1474 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y1475 ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y1476 ffb fs10 fc2 sc0 ls0 ws0">    };</div><div class="t m5 x74 h2f y1477 ffb fs10 fc2 sc0 ls14 ws237">    Thread clientConnection = new Thread(clientHandler);</div><div class="t m5 x74 h2f y1478 ffb fs10 fc2 sc0 ls0 ws0">    clientConnection.start();</div><div class="t m5 x74 h2f y1479 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y51d ff8 fs3 fc2 sc0 ls0 ws0">Assume that this change causes the test to pass;</div><div class="t m0 x68 h21 y74a ff8 fsc fc2 sc0 ls0 ws0">1</div><div class="t m0 xce h14 y51d ff8 fs3 fc2 sc0 ls0 ws0"> the code is complete, cor<span class="_ _8"></span>rect?</div><div class="t m0 xd h11 y1049 ff1 fs7 fc2 sc0 ls0 ws0">Serv<span class="_ _4"></span>er Observ<span class="_ _1"></span>ations</div><div class="t m0 xd h14 y147a ff8 fs3 fc2 sc0 ls0 ws796">The updated server completes the test successfully in just o<span class="_ _1"></span>ver one second. Unfortunately<span class="_ _0"></span>,</div><div class="t m0 xd h14 y147b ff8 fs3 fc2 sc0 ls0 ws0">this solution is a bit nai<span class="_ _4"></span>ve and introduces some new prob<span class="_ _4"></span>lems.</div><div class="t m0 x74 h14 yb44 ff8 fs3 fc2 sc0 ls0 ws33f">Ho<span class="_ _4"></span>w many threads might our server create? <span class="_ _1"></span>The code sets no limit, so the w<span class="_ _4"></span>e could</div><div class="t m0 xd h14 ycc5 ff8 fs3 fc2 sc0 ls0 ws450">feasibl<span class="_ _4"></span>y hit the limit imposed b<span class="_ _4"></span>y the Jav<span class="_ _4"></span>a <span class="_ _4"></span>V<span class="_ _4"></span>irtual Machine (JVM). F<span class="_ _4"></span>or many simple sys-</div><div class="t m0 xd h14 y874 ff8 fs3 fc2 sc0 ls0 ws3f">tems this ma<span class="_ _4"></span>y sufﬁce. But w<span class="_ _4"></span>hat if the system is meant to suppor<span class="_ _8"></span>t many users on the pub<span class="_ _4"></span>lic</div><div class="t m0 xd h14 y875 ff8 fs3 fc2 sc0 ls0 ws0">net? If too man<span class="_ _4"></span>y users connect at the same time, the system might g<span class="_ _8"></span>rind to a halt.</div><div class="t m0 x74 h14 y1356 ff8 fs3 fc2 sc0 ls0 ws5d4">But set the beha<span class="_ _4"></span>vioral problem aside for the moment. <span class="_ _1"></span>The solution sho<span class="_ _4"></span>wn has prob-</div><div class="t m0 xd h14 y877 ff8 fs3 fc2 sc0 ls0 ws0">lems of cleanliness and structure. How man<span class="_ _4"></span>y responsibilities does the server code ha<span class="_ _4"></span>ve? </div><div class="t m0 x2c h1b y458 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Socket connection management</span></div><div class="t m0 x2c h1b y73a ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Client processing</span></div><div class="t m0 x2c h1b y480 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Threading policy</span></div><div class="t m0 x2c h1b y45c ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Server shutdo<span class="_ _4"></span>wn policy</span></div><div class="t m0 x74 h14 y3e8 ff8 fs3 fc2 sc0 ls0 wsc9">Unfortunately<span class="_ _0"></span>, all these responsibilities liv<span class="_ _4"></span>e in the </div><div class="t m5 x85 h2f y3e8 ffb fs10 fc2 sc0 ls0 ws0">process</div><div class="t m0 x55 h14 y3e8 ff8 fs3 fc2 sc0 ls0 wsc9"> function. In addition, the</div><div class="t m0 xd h14 y41b ff8 fs3 fc2 sc0 ls0 ws670">code crosses many dif<span class="_ _1"></span>ferent levels of abstraction. So, small as the process function is, it</div><div class="t m0 xd h14 ya00 ff8 fs3 fc2 sc0 ls0 ws0">needs to be repartitioned.</div><div class="t m0 xd h25 y147c ff8 fse fc2 sc0 ls0 ws0">1.<span class="_ _17"> </span>Y<span class="_ _2"></span>ou can verify that for yourself b<span class="_ _4"></span>y tr<span class="_ _8"></span>ying out the before and after code. Revie<span class="_ _4"></span>w the nonthreaded code starting on page 343. </div><div class="t m0 x3b h25 y147d ff8 fse fc2 sc0 ls0 ws0">Revie<span class="_ _4"></span>w the threaded code starting on page 346. </div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:93.837000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:317.728010px;width:104.041000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf15f" class="pf w1 h2" data-page-no="15f"><div class="pc pc15f w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">320<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls10 ws2c6">The server has sev<span class="_ _4"></span>eral reasons to change; therefore it violates the Single Responsibility</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws193">Principle. <span class="_ _1"></span>T<span class="_ _1"></span>o keep concur<span class="_ _8"></span>rent systems clean, thread management should be kept to a few<span class="_ _0"></span>,</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws797">w<span class="_ _4"></span>ell-controlled places. What’<span class="_ _3"></span>s more, any code that manages threads should do nothing</div><div class="t m0 xd h14 y197 ff8 fs3 fc2 sc0 ls0 ws278">other than thread management. <span class="_ _4"></span>Why? If for no other reason than that tracking do<span class="_ _1"></span>wn con-</div><div class="t m0 xd h14 y198 ff8 fs3 fc2 sc0 ls0 ws46d">cur<span class="_ _8"></span>rency issues is hard enough without ha<span class="_ _4"></span>ving to unwind other nonconcur<span class="_ _8"></span>rency issues at</div><div class="t m0 xd h14 y199 ff8 fs3 fc2 sc0 ls0 ws0">the same time. </div><div class="t m0 x74 h14 y19a ff8 fs3 fc2 sc0 ls0 ws71b">If w<span class="_ _4"></span>e create a separate class for each of the responsibilities listed abo<span class="_ _4"></span>ve, including the</div><div class="t m0 xd h14 y19b ff8 fs3 fc2 sc0 ls0 ws81">thread management responsibility<span class="_ _0"></span>, then when w<span class="_ _4"></span>e change the thread management strategy<span class="_ _0"></span>,</div><div class="t m0 xd h14 y19c ff8 fs3 fc2 sc0 ls0 ws798">the change will impact less o<span class="_ _4"></span>verall code and will not pollute the other responsibilities. <span class="_ _1"></span>This</div><div class="t m0 xd h14 y19d ff8 fs3 fc2 sc0 ls0 ws799">also makes it much easier to test all the other responsibilities without ha<span class="_ _4"></span>ving to w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y</div><div class="t m0 xd h14 y19e ff8 fs3 fc2 sc0 ls0 ws0">about threading. Here is an updated version that does just that:</div><div class="t m5 x74 h2f y147e ffb fs10 fc2 sc0 ls0 ws0">public void run() {</div><div class="t m5 x74 h2f y147f ffb fs10 fc2 sc0 ls14 ws237">  while (keepProcessing) {</div><div class="t m5 x74 h2f y1480 ffb fs10 fc2 sc0 ls3c ws253">   try {</div><div class="t m5 x74 h2f y1481 ffb fs10 fc2 sc0 ls14 ws241">    ClientConnection clientConnection = connectionManager.awaitClient();</div><div class="t m5 x74 h2f y1482 ffb fs10 fc2 sc0 ls18 ws2f6">    ClientRequestProcessor requestProcessor </div><div class="t m5 x74 h2f y1483 ffb fs10 fc2 sc0 ls19 ws241">      = new ClientRequestProcessor(clientConnection);</div><div class="t m5 x74 h2f y1484 ffb fs10 fc2 sc0 ls18 ws3b9">    clientScheduler.schedule(requestProcessor);</div><div class="t m5 x74 h2f y1485 ffb fs10 fc2 sc0 ls19 ws235">    } catch (Exception e) {</div><div class="t m5 x74 h2f y1486 ffb fs10 fc2 sc0 ls20 ws2f1">      e.printStackTrace();</div><div class="t m5 x74 h2f y1487 ffb fs10 fc2 sc0 ls1c ws0">    }</div><div class="t m5 x74 h2f y1488 ffb fs10 fc2 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y1489 ffb fs10 fc2 sc0 ls18 ws3b9">  connectionManager.shutdown();</div><div class="t m5 x74 h2f y148a ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 ybfc ff8 fs3 fc2 sc0 ls0 wse9">This no<span class="_ _4"></span>w focuses all things thread-related into one place, </div><div class="t m5 x6a h2f ybfc ffb fs10 fc2 sc0 ls0 ws0">clientScheduler</div><div class="t m0 xa6 h14 ybfc ff8 fs3 fc2 sc0 ls0 wse9">. If there are</div><div class="t m0 xd h14 ybfd ff8 fs3 fc2 sc0 ls0 ws0">concur<span class="_ _8"></span>rency prob<span class="_ _4"></span>lems, there is just one place to look:</div><div class="t m5 x74 h2f y148b ffb fs10 fc2 sc0 ls0 ws0">public interface ClientScheduler {</div><div class="t m5 x74 h2f y148c ffb fs10 fc2 sc0 ls0 ws0">    void schedule(ClientRequestProcessor requestProcessor);</div><div class="t m5 x74 h2f y148d ffb fs10 fc2 sc0 ls0 ws0">} </div><div class="t m0 xd h14 yef5 ff8 fs3 fc2 sc0 ls0 ws0">The cur<span class="_ _8"></span>rent policy is easy to implement:</div><div class="t m5 x74 h2f yfdb ffb fs10 fc2 sc0 ls0 ws0">public class ThreadPerRequestScheduler implements ClientScheduler {</div><div class="t m5 x74 h2f yfdc ffb fs10 fc2 sc0 ls0 ws0">    public void schedule(final ClientRequestProcessor requestProcessor) {</div><div class="t m5 x74 h2f yfdd ffb fs10 fc2 sc0 ls0 ws0">        Runnable runnable = new Runnable() {</div><div class="t m5 x74 h2f yfde ffb fs10 fc2 sc0 ls0 ws0">            public void run() {</div><div class="t m5 x74 h2f yfdf ffb fs10 fc2 sc0 ls0 ws0">                requestProcessor.process();</div><div class="t m5 x74 h2f y148e ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y148f ffb fs10 fc2 sc0 ls0 ws0">        };</div><div class="t m5 x74 h2f y1490 ffb fs10 fc2 sc0 ls19 ws237">       Thread thread = new Thread(runnable);</div><div class="t m5 x74 h2f y1491 ffb fs10 fc2 sc0 ls3c ws237">       thread.start();</div><div class="t m5 x74 h2f y1492 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1493 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y3ca ff8 fs3 fc2 sc0 ls0 ws44a">Ha<span class="_ _4"></span>ving isolated all the thread management into a single place, it is much easier to change</div><div class="t m0 xd h14 y43f ff8 fs3 fc2 sc0 ls0 ws79a">the wa<span class="_ _1"></span>y we control threads. F<span class="_ _1"></span>or example, mo<span class="_ _1"></span>ving to the Jav<span class="_ _4"></span>a 5 Ex<span class="_ _4"></span>ecutor framew<span class="_ _1"></span>ork</div><div class="t m0 xd h14 y440 ff8 fs3 fc2 sc0 ls0 ws0">in<span class="_ _4"></span>volv<span class="_ _4"></span>es writing a new class and plugging it in (Listing <span class="_ _1"></span>A-1).</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf160" class="pf w1 h2" data-page-no="160"><div class="pc pc160 w1 h2"><img class="bi xd y1494 wc hba" alt="" src="bg160.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">321<span class="_ _10"></span><span class="ff1">P<span class="_ _1"></span>ossible P<span class="_ _4"></span>aths of Execution</span></div><div class="t m0 xd h11 y3bc ff1 fs7 fc2 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y6e7 ff8 fs3 fc2 sc0 ls0 ws79b">Introducing concur<span class="_ _8"></span>rency in this particular example demonstrates a w<span class="_ _4"></span>ay to impro<span class="_ _1"></span>ve the</div><div class="t m0 xd h14 y32f ff8 fs3 fc2 sc0 ls0 ws79c">throughput of a system and one w<span class="_ _4"></span>ay of v<span class="_ _4"></span>alidating that throughput through a testing frame-</div><div class="t m0 xd h14 y330 ff8 fs3 fc2 sc0 ls0 ws79d">w<span class="_ _4"></span>ork. F<span class="_ _4"></span>ocusing all concur<span class="_ _8"></span>rency code into a small number of classes is an e<span class="_ _4"></span>xample of</div><div class="t m0 xd h14 y331 ff8 fs3 fc2 sc0 ls0 ws589">applying the Single Responsibility Principle. In the case of concurrent programming, this</div><div class="t m0 xd h14 yba1 ff8 fs3 fc2 sc0 ls0 ws0">becomes especiall<span class="_ _4"></span>y impor<span class="_ _8"></span>tant because of its complexity<span class="_ _0"></span>.</div><div class="t m0 xd h17 y1495 ff1 fs9 fc2 sc0 ls0 ws0">P<span class="_ _1"></span>ossible P<span class="_ _1"></span>aths of Ex<span class="_ _4"></span>ecution</div><div class="t m0 xd h14 y955 ff8 fs3 fc2 sc0 ls0 ws0">Revie<span class="_ _1"></span>w the method </div><div class="t m5 xba h2f y955 ffb fs10 fc2 sc0 ls0 ws0">incrementValue</div><div class="t m0 x76 h14 y955 ff8 fs3 fc2 sc0 ls0 ws0">, a one-line Ja<span class="_ _4"></span>va method with no looping or branching:</div><div class="t m5 x74 h2f yf94 ffb fs10 fc2 sc0 ls0 ws0">public class IdGenerator {</div><div class="t m5 x74 h2f yf95 ffb fs10 fc2 sc0 ls19 ws237">  int lastIdUsed;</div><div class="t m5 x74 h2f yf97 ffb fs10 fc2 sc0 ls14 ws235">  public int incrementValue() {</div><div class="t m5 x74 h2f y1496 ffb fs10 fc2 sc0 ls1f ws241">    return ++lastIdUsed;</div><div class="t m5 x74 h2f y1497 ffb fs10 fc2 sc0 ls1c ws0">  }</div><div class="t m5 x74 h2f y1498 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y1d3 ff8 fs3 fc2 sc0 ls12 ws40b">Ignore integer o<span class="_ _1"></span>verﬂo<span class="_ _4"></span>w and assume that only one thread has access to a single instance</div><div class="t m0 xd h14 y1d4 ff8 fs3 fc2 sc0 ls12 ws0">of </div><div class="t m5 x3b h2f ya1e ffb fs10 fc2 sc0 ls5d ws0">IdGenerator</div><div class="t m0 xe h14 ya1e ff8 fs3 fc2 sc0 ls12 ws124">. In this case there is a single path of ex<span class="_ _4"></span>ecution and a single guaranteed</div><div class="t m0 xd h14 yb78 ff8 fs3 fc2 sc0 ls12 ws0">result:</div><div class="t m0 x2c h1b y5e7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">The value returned is equal to the v<span class="_ _4"></span>alue of </span></div><div class="t m5 x23 h2f y5e7 ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 xa1 h14 y5e7 ff8 fs3 fc2 sc0 ls0 ws0">, both of which are one greater </div><div class="t m0 x74 h14 y5e8 ff8 fs3 fc2 sc0 ls0 ws0">than just before calling the method.</div><div class="t m0 x74 h1c y93a ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-1 </div><div class="t m0 x74 h36 y1499 ffc fs3 fc2 sc0 ls0 ws0">ExecutorClientScheduler.java</div><div class="t m5 x74 h2f y4b9 ffb fs10 fc2 sc0 ls0 ws0">import java.util.concurrent.Executor;</div><div class="t m5 x74 h2f y4ba ffb fs10 fc2 sc0 ls0 ws0">import java.util.concurrent.Executors;</div><div class="t m5 x74 h2f y4bc ffb fs10 fc2 sc0 ls0 ws0">public class ExecutorClientScheduler implements ClientScheduler {</div><div class="t m5 x74 h2f y522 ffb fs10 fc2 sc0 ls0 ws0">    Executor executor;</div><div class="t m5 x74 h2f y149a ffb fs10 fc2 sc0 ls0 ws0">    public ExecutorClientScheduler(int availableThreads) {</div><div class="t m5 x74 h2f y149b ffb fs10 fc2 sc0 ls0 ws0">        executor = Executors.newFixedThreadPool(availableThreads);</div><div class="t m5 x74 h2f y149c ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y149d ffb fs10 fc2 sc0 ls0 ws0">    public void schedule(final ClientRequestProcessor requestProcessor) {</div><div class="t m5 x74 h2f y149e ffb fs10 fc2 sc0 ls0 ws0">        Runnable runnable = new Runnable() {</div><div class="t m5 x74 h2f y149f ffb fs10 fc2 sc0 ls0 ws0">            public void run() {</div><div class="t m5 x74 h2f y14a0 ffb fs10 fc2 sc0 ls0 ws0">                requestProcessor.process();</div><div class="t m5 x74 h2f y14a1 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y14a2 ffb fs10 fc2 sc0 ls0 ws0">        };</div><div class="t m5 x74 h2f y14a3 ffb fs10 fc2 sc0 ls0 ws0">        executor.execute(runnable);</div><div class="t m5 x74 h2f y14a4 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y14a5 ffb fs10 fc2 sc0 ls0 ws0">}</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:366.728010px;width:57.348000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:264.944010px;width:161.988000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf161" class="pf w1 h2" data-page-no="161"><div class="pc pc161 w1 h2"><img class="bi x37 y14a6 w19 hbb" alt="" src="bg161.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">322<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls0 ws79e">What happens if w<span class="_ _4"></span>e use tw<span class="_ _4"></span>o threads and leav<span class="_ _4"></span>e the method unchanged? What are the</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws6a8">possible outcomes if each thread calls </div><div class="t m5 x5c h2f y195 ffb fs10 fc2 sc0 ls0 ws0">incrementValue</div><div class="t m0 x40 h14 y195 ff8 fs3 fc2 sc0 ls0 ws6a8"> once? Ho<span class="_ _4"></span>w many possib<span class="_ _4"></span>le paths of</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws0">ex<span class="_ _4"></span>ecution are there? First, the outcomes (assume </div><div class="t m5 xd5 h2f y196 ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x21 h14 y196 ff8 fs3 fc2 sc0 ls0 ws0"> starts with a value of 93):</div><div class="t m0 x2c h1b ya7c ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws79f">Thread 1 gets the v<span class="_ _4"></span>alue of 94, thread 2 gets the value of 95, and </span></div><div class="t m5 x58 h2f ya7c ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x93 h14 ya7c ff8 fs3 fc2 sc0 ls0 ws79f"> is no<span class="_ _4"></span>w 95.</div><div class="t m0 x2c h1b y79d ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws79f">Thread 1 gets the v<span class="_ _4"></span>alue of 95, thread 2 gets the value of 94, and </span></div><div class="t m5 x58 h2f y79d ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x93 h14 y79d ff8 fs3 fc2 sc0 ls0 ws79f"> is no<span class="_ _4"></span>w 95.</div><div class="t m0 x2c h1b y461 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws79f">Thread 1 gets the v<span class="_ _4"></span>alue of 94, thread 2 gets the value of 94, and </span></div><div class="t m5 x58 h2f y461 ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x93 h14 y461 ff8 fs3 fc2 sc0 ls0 ws79f"> is no<span class="_ _4"></span>w 94.</div><div class="t m0 xd h14 y277 ff8 fs3 fc2 sc0 ls0 ws420">The ﬁnal result, while surprising, is possible. <span class="_ _1"></span>T<span class="_ _1"></span>o see ho<span class="_ _4"></span>w these different results are possi-</div><div class="t m0 xd h14 y278 ff8 fs3 fc2 sc0 ls0 ws528">ble, w<span class="_ _1"></span>e need to understand the number of possible paths of ex<span class="_ _4"></span>ecution and ho<span class="_ _4"></span>w the Ja<span class="_ _4"></span>va</div><div class="t m0 xd h14 y279 ff8 fs3 fc2 sc0 ls0 ws0">V<span class="_ _4"></span>irtual Machine executes them.</div><div class="t m0 xd h11 y75f ff1 fs7 fc2 sc0 ls0 ws0">Number of P<span class="_ _4"></span>aths</div><div class="t m0 xd h14 y636 ff8 fs3 fc2 sc0 ls0 ws334">T<span class="_ _0"></span>o calculate the number of possible ex<span class="_ _4"></span>ecution paths, w<span class="_ _4"></span>e’<span class="_ _4"></span>ll star<span class="_ _8"></span>t with the generated byte-</div><div class="t m0 xd h14 y637 ff8 fs3 fc2 sc0 ls22 ws540">code. <span class="_ _1"></span>The one line of jav<span class="_ _4"></span>a (</div><div class="t m5 x1f h2f y11c0 ffb fs10 fc2 sc0 ls0 ws7a0">return ++lastIdUsed;</div><div class="t m0 x42 h14 y11c0 ff8 fs3 fc2 sc0 ls0 ws583">) becomes eight b<span class="_ _4"></span>yte-code instr<span class="_ _8"></span>uctions. It</div><div class="t m0 xd h14 y1368 ff8 fs3 fc2 sc0 ls0 ws7a1">is possible for the tw<span class="_ _1"></span>o threads to interleav<span class="_ _4"></span>e the ex<span class="_ _4"></span>ecution of these eight instr<span class="_ _8"></span>uctions the</div><div class="t m0 xd h14 y1369 ff8 fs3 fc2 sc0 ls0 ws20c">wa<span class="_ _1"></span>y a card dealer interleav<span class="_ _4"></span>es cards as he shufﬂes a deck.</div><div class="t m0 xa1 h21 y388 ff8 fsc fc2 sc0 ls0 ws0">2</div><div class="t m0 xc2 h14 y1369 ff8 fs3 fc2 sc0 ls0 ws20c"> Even with onl<span class="_ _4"></span>y eight cards in</div><div class="t m0 xd h14 y423 ff8 fs3 fc2 sc0 ls0 ws0">each hand<span class="_ _1"></span>, there are a remarkable number of shuf<span class="_ _4"></span>ﬂed outcomes.</div><div class="t m0 x74 h14 y3f3 ff8 fs3 fc2 sc0 ls0 ws473">F<span class="_ _1"></span>or this simple case of <span class="ffa ws0">N</span> instr<span class="_ _8"></span>uctions in a sequence, no looping or conditionals, and <span class="_ _4"></span><span class="ffa ws0">T</span></div><div class="t m0 xd h14 y3f4 ff8 fs3 fc2 sc0 ls0 ws0">threads, the total number of possible e<span class="_ _4"></span>xecution paths is equal to </div><div class="t m0 xd h25 y14a7 ff8 fse fc2 sc0 ls0 ws0">2.<span class="_ _17"> </span> <span class="_ _1"></span>This is a bit of a simpliﬁcation. How<span class="_ _4"></span>ever<span class="_ _4"></span>, for the purpose of this discussion, we can use this simplifying model.</div><div class="t m0 x7 h1c y14a8 ff1 fs3 fc2 sc0 ls0 ws0">Calculating the P<span class="_ _1"></span>ossible Orderings </div><div class="t m0 x1a h14 y14a9 ff8 fs3 fc2 sc0 ls0 ws0">This comes from an email from Uncle Bob to Brett:</div><div class="t m0 x4c h14 y14aa ff8 fs3 fc2 sc0 ls0 ws0">W<span class="_ _4"></span>ith <span class="ffa">N</span><span class="ws6ef"> steps and <span class="_ _1"></span><span class="ffa ws0">T<span class="ff8 ws6ef"> threads there are <span class="_ _1"></span><span class="ffa ws0">T<span class="ff8 ls96"> *<span class="_ _b"> </span></span>N<span class="ff8 ws6ef"> total steps. Prior to each step</span></span></span></span></span></div><div class="t m0 x1a h14 y14ab ff8 fs3 fc2 sc0 ls0 ws7a2">there is a context s<span class="_ _4"></span>witch that chooses betw<span class="_ _4"></span>een the <span class="_ _4"></span><span class="ffa ws0">T<span class="ff8 ws7a2"> threads. Each path can</span></span></div><div class="t m0 x1a h14 y14ac ff8 fs3 fc2 sc0 ls0 ws54e">thus be represented as a string of digits denoting the context s<span class="_ _4"></span>witches.</div><div class="t m0 x1a h14 y14ad ff8 fs3 fc2 sc0 ls0 ws59e">Gi<span class="_ _4"></span>ven steps <span class="_ _1"></span>A and B and threads 1 and 2, the six possible paths are 1122,</div><div class="t m0 x1a h14 y14ae ff8 fs3 fc2 sc0 ls0 ws148">1212, 1221, 2112, 2121, and 2211. Or<span class="_ _4"></span>, in terms of steps it is <span class="_ _4"></span>A1B1A2B2,</div><div class="t m0 x1a h14 y14af ff8 fs3 fc2 sc0 ls0 ws2f7">A1A2B1B2, A1A2B2B1, A2A1B1B2, A2A1B2B1, <span class="_ _5"></span>and A2B2A1B1. <span class="_ _5"></span>F<span class="_ _4"></span>or</div><div class="t m0 x1a h14 y14b0 ff8 fs3 fc2 sc0 ls0 ws7a3">three threads the sequence is 112233, 112323, 113223, 113232, 112233,</div><div class="t m0 x1a h14 y14b1 ff8 fs3 fc2 sc0 ls0 ws0">121233, 121323, 121332, 123132, 123123, . . . .</div><div class="t m0 x4c h14 y14b2 ff8 fs3 fc2 sc0 ls0 ws7a4">One characteristic of these strings is that there must al<span class="_ _4"></span>wa<span class="_ _1"></span>ys be <span class="ffa ws0">N</span></div><div class="t m0 x1a h14 y14b3 ff8 fs3 fc2 sc0 ls0 ws7a5">instances of each <span class="_ _1"></span><span class="ffa ws0">T<span class="_ _0"></span><span class="ff8 ws7a5">. So the string 111111 is in<span class="_ _4"></span>valid because it has six</span></span></div><div class="t m0 x1a h14 y14b4 ff8 fs3 fc2 sc0 ls0 ws0">instances of 1 and zero instances of 2 and 3. </div><div class="t m0 xc4 hbc y14b5 ffa fsf fc2 sc0 ls97 ws0">NT<span class="_ _40"></span><span class="ff12 ls98">()<span class="_ _41"></span><span class="ff8 ls0">!</span></span></div><div class="t m0 xc4 hbc y14b6 ffa fsf fc2 sc0 ls0 ws0">N<span class="ff8">!</span></div><div class="t m0 x78 hbd y14b7 ffa fse fc2 sc0 ls0 ws0">T</div><div class="t m0 xdd hbc y14b8 ff8 fsf fc2 sc0 ls99 ws0">-------------<span class="_ _1"></span>-</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:436.728010px;width:86.904000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf162" class="pf w1 h2" data-page-no="162"><div class="pc pc162 w1 h2"><img class="bi x74 y14b9 w1a hbe" alt="" src="bg162.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">323<span class="_ _10"></span><span class="ff1">P<span class="_ _1"></span>ossible P<span class="_ _4"></span>aths of Execution</span></div><div class="t m0 x74 h14 y14ba ff8 fs3 fc2 sc0 ls0 wsfa">F<span class="_ _1"></span>or our simple case of one line of Jav<span class="_ _4"></span>a code, which equates to eight lines of b<span class="_ _4"></span>yte-code</div><div class="t m0 xd h14 y14bb ff8 fs3 fc2 sc0 ls0 ws200">and tw<span class="_ _4"></span>o threads, the total number of possible paths of e<span class="_ _4"></span>xecution is 12,870. If the type of</div><div class="t m5 xd h2f y14bc ffb fs10 fc2 sc0 ls0 ws0">lastIdUsed</div><div class="t m0 x5f h14 y14bc ff8 fs3 fc2 sc0 ls49 ws71b"> is a </div><div class="t m5 x39 h2f y14bc ffb fs10 fc2 sc0 ls0 ws0">long</div><div class="t m0 xba h14 y14bc ff8 fs3 fc2 sc0 ls0 ws55e">, then ev<span class="_ _4"></span>ery read/write becomes two operations instead of one, and the</div><div class="t m0 xd h14 y14bd ff8 fs3 fc2 sc0 ls0 ws0">number of possible orderings becomes 2,704,156.</div><div class="t m0 x74 h14 y14be ff8 fs3 fc2 sc0 ls0 ws0">What happens if w<span class="_ _4"></span>e make one change to this method?</div><div class="t m5 x74 h2f y14bf ffb fs10 fc2 sc0 ls0 ws0">public <span class="ffc">synchronized</span> void incrementValue() {</div><div class="t m5 x74 h2f y14c0 ffb fs10 fc2 sc0 ls0 ws0">    ++lastIdUsed;</div><div class="t m5 x74 h2f y14c1 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y14c2 ff8 fs3 fc2 sc0 ls0 ws7a6">The number of possible e<span class="_ _4"></span>xecution pathw<span class="_ _4"></span>a<span class="_ _4"></span>ys becomes tw<span class="_ _4"></span>o for tw<span class="_ _4"></span>o threads and N! in the</div><div class="t m0 xd h14 y14c3 ff8 fs3 fc2 sc0 ls0 ws0">general case. </div><div class="t m0 xd h11 y14c4 ff1 fs7 fc2 sc0 ls0 ws0">Digging Deeper</div><div class="t m0 xd h14 y14c5 ff8 fs3 fc2 sc0 ls0 ws3e1">What about the sur<span class="_ _8"></span>prising result that tw<span class="_ _4"></span>o threads could both call the method once (before</div><div class="t m0 xd h14 y14c6 ff8 fs3 fc2 sc0 ls0 ws7a7">w<span class="_ _4"></span>e added </div><div class="t m5 x5f h2f y14c6 ffb fs10 fc2 sc0 ls0 ws0">synchronized</div><div class="t m0 x9e h14 y14c6 ff8 fs3 fc2 sc0 ls0 ws7a7">) and get the same numeric result? Ho<span class="_ _4"></span>w is that possible? F<span class="_ _4"></span>irst</div><div class="t m0 xd h14 y14c7 ff8 fs3 fc2 sc0 ls0 ws0">things ﬁrst.</div><div class="t m0 x74 h14 y14c8 ff8 fs3 fc2 sc0 ls0 ws23d">What is an atomic operation? <span class="_ _4"></span>W<span class="_ _0"></span>e can deﬁne an atomic operation as any operation that</div><div class="t m0 xd h14 y14c9 ff8 fs3 fc2 sc0 ls0 ws7a8">is uninter<span class="_ _8"></span>ruptable. F<span class="_ _4"></span>or example, in the follo<span class="_ _1"></span>wing code, line 5, where 0 is assigned to</div><div class="t m5 xd h2f y14ca ffb fs10 fc2 sc0 ls0 ws0">lastid</div><div class="t m0 xfc h14 y14ca ff8 fs3 fc2 sc0 ls0 ws5e8">, is atomic because according to the Ja<span class="_ _4"></span>va Memory model, assignment to a 32-bit</div><div class="t m0 xd h14 y14cb ff8 fs3 fc2 sc0 ls0 ws0">value is uninterruptable.</div><div class="t m0 x4c h14 yd16 ff8 fs3 fc2 sc0 ls0 ws30d">So w<span class="_ _4"></span>e want the permutations of <span class="ffa ws0">N</span> 1’<span class="_ _2"></span>s, <span class="ffa ws0">N<span class="ff8"> <span class="_ _d"> </span>2’<span class="_ _2"></span>s, <span class="_ _c"> </span>. . . and <span class="_ _c"> </span><span class="ffa">N<span class="ffd"> <span class="_ _6"></span></span>T’<span class="_ _2"></span><span class="ff8 ws1b8">s. This <span class="_ _8"></span>is</span></span></span></span></div><div class="t m0 x1a h14 yd17 ff8 fs3 fc2 sc0 ls0 ws7a9">really just the permutations of <span class="ffa ws0">N</span> * <span class="_ _1"></span><span class="ffa ws0">T<span class="ff8 ws7a9"> things taken </span>N<span class="ff8 ws7a9"> * <span class="_ _1"></span><span class="ffa ws0">T<span class="ff8 ws7a9"> at a time, which is</span></span></span></span></div><div class="t m0 x1a h14 y14cc ff8 fs3 fc2 sc0 ls0 ws0">(<span class="ffa">N<span class="ffd"> </span></span>* <span class="_ _1"></span><span class="ffa">T<span class="_ _b"> </span><span class="ff8 lsd ws7aa">)!, but with all the duplicates remo<span class="_ _1"></span>ved. So the trick is to count the</span></span></div><div class="t m0 x1a h14 ya6a ff8 fs3 fc2 sc0 ls0 ws0">duplicates and subtract that from (<span class="ffa">N</span> * <span class="_ _1"></span><span class="ffa">T<span class="ffd"> <span class="ff8">)!.</span></span></span></div><div class="t m0 x4c h14 y14cd ff8 fs3 fc2 sc0 ls0 ws168">Gi<span class="_ _4"></span>ven tw<span class="_ _4"></span>o steps and tw<span class="_ _4"></span>o threads, ho<span class="_ _4"></span>w many duplicates are there? Each</div><div class="t m0 x1a h14 y14ce ff8 fs3 fc2 sc0 ls0 ws7ab">four-digit string has tw<span class="_ _1"></span>o 1s and tw<span class="_ _4"></span>o 2s. Each of those pairs could be</div><div class="t m0 x1a h14 y14cf ff8 fs3 fc2 sc0 ls0 ws448">sw<span class="_ _4"></span>apped without changing the sense of the string. <span class="_ _0"></span>Y<span class="_ _2"></span>ou could s<span class="_ _4"></span>wap the 1s or</div><div class="t m0 x1a h14 y14d0 ff8 fs3 fc2 sc0 ls0 ws3b2">the 2s both, or neither<span class="_ _1"></span>. So there are four isomor<span class="_ _8"></span>phs for each string, which</div><div class="t m0 x1a h14 y14d1 ff8 fs3 fc2 sc0 ls0 ws640">means that there are three duplicates. So three out of four of the options are</div><div class="t m0 x1a h14 y14d2 ff8 fs3 fc2 sc0 ls0 ws663">duplicates; alternativel<span class="_ _4"></span>y one of four of the permutations are NOT dupli-</div><div class="t m0 x1a h14 y14d3 ff8 fs3 fc2 sc0 ls0 ws0">cates. 4! * .25 = 6.  So this reasoning seems to w<span class="_ _4"></span>ork.</div><div class="t m0 x4c h14 y477 ff8 fs3 fc2 sc0 ls0 ws442">Ho<span class="_ _4"></span>w many duplicates are there? In the case w<span class="_ _4"></span>here <span class="ffa ws0">N<span class="ffd"> <span class="ff8">= 2 <span class="_ _5"></span>and <span class="_ _8"></span></span></span>T<span class="ffd"> <span class="ff8">= 2, <span class="_ _6"></span>I</span></span></span></div><div class="t m0 x1a h14 y499 ff8 fs3 fc2 sc0 ls0 ws7ac">could sw<span class="_ _4"></span>ap the 1s, the 2s, or both. In the case where <span class="ffa ws0">N<span class="ffd"> <span class="ff8">= 2 <span class="_ _6"></span>and <span class="_ _6"></span></span></span>T<span class="ffd"> <span class="ff8">= 3, <span class="_ _d"> </span>I</span></span></span></div><div class="t m0 x1a h14 yeb4 ff8 fs3 fc2 sc0 ls0 ws3cf">could sw<span class="_ _4"></span>ap the 1s, the 2s, the 3s, 1s and 2s, 1s and 3s, or 2s and 3s. Sw<span class="_ _4"></span>ap-</div><div class="t m0 x1a h14 y14d4 ff8 fs3 fc2 sc0 ls0 ws7ad">ping is just the permutations of <span class="ffa ws0">N</span>. Let’<span class="_ _2"></span>s sa<span class="_ _4"></span>y there are <span class="ffa ws0">P</span> permutations of <span class="ffa ws0">N<span class="ff8">.</span></span></div><div class="t m0 x1a h14 y14d5 ff8 fs3 fc2 sc0 ls0 ws0">The number of dif<span class="_ _4"></span>ferent wa<span class="_ _4"></span>ys to ar<span class="_ _8"></span>range those per<span class="_ _8"></span>mutations are <span class="ffa">P</span>**<span class="ffa">T<span class="_ _0"></span><span class="ff8">. </span></span></div><div class="t m0 x4c h14 y14d6 ff8 fs3 fc2 sc0 ls0 ws459">So the number of possible isomorphs is <span class="ffa ws0">N<span class="ff8">!**</span>T<span class="_ _0"></span><span class="ff8 ws459">. <span class="_ _4"></span>And so the number of</span></span></div><div class="t m0 x1a h14 y14d7 ff8 fs3 fc2 sc0 ls0 ws0">paths is (<span class="ffa">T</span>*<span class="ffa">N</span>)!/(<span class="ffa">N</span>!**<span class="ffa">T</span><span class="ls1d ws114">). <span class="_ _1"></span>Again, in our <span class="_ _4"></span><span class="ffa ls0 ws0">T<span class="ffd"> <span class="ff8">= 2, </span></span>N<span class="ffd"> <span class="ff8">= 2 case w<span class="_ _4"></span>e get 6 (24/4).</span></span></span></span></div><div class="t m0 x4c h14 y411 ff8 fs3 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or <span class="ffa">N<span class="ffd"> </span></span>= 2 and <span class="_ _4"></span><span class="ffa">T<span class="ffd"> <span class="ff8">= 3 w<span class="_ _4"></span>e get 720/8 = 90.</span></span></span></div><div class="t m0 x4c h14 y14d8 ff8 fs3 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or <span class="ffa">N<span class="ffd"> </span></span>= 3 and <span class="_ _4"></span><span class="ffa">T<span class="ffd"> <span class="ff8">= 3 w<span class="_ _4"></span>e get 9!/6^3 = 1680.</span></span></span></div><div class="t m0 xd6 h1c y14d9 ff1 fs3 fc2 sc0 ls0 ws0">Calculating the P<span class="_ _1"></span>ossible Orderings (contin<span class="_ _4"></span>ued)</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:158.228010px;width:79.655000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf163" class="pf w1 h2" data-page-no="163"><div class="pc pc163 w1 h2"><img class="bi xd y14da w1b hbf" alt="" src="bg163.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">324<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc2 sc0 ls0 ws0">01: public class Example {</div><div class="t m5 x74 h2f y627 ffb fs10 fc2 sc0 ls0 ws0">02:    int lastId;</div><div class="t m5 x74 h2f y628 ffb fs10 fc2 sc0 ls0 ws0">03:</div><div class="t m5 x74 h2f y629 ffb fs10 fc2 sc0 ls0 ws0">04:    public void resetId() {</div><div class="t m5 x74 h2f y62a ffb fs10 fc2 sc0 ls0 ws0">05:        value = 0;</div><div class="t m5 x74 h2f y62b ffb fs10 fc2 sc0 ls0 ws0">06:    }</div><div class="t m5 x74 h2f y62c ffb fs10 fc2 sc0 ls0 ws0">07: </div><div class="t m5 x74 h2f y62d ffb fs10 fc2 sc0 ls0 ws0">08:    public int getNextId() {</div><div class="t m5 x74 h2f y861 ffb fs10 fc2 sc0 ls0 ws0">09:        ++value;</div><div class="t m5 x74 h2f y62e ffb fs10 fc2 sc0 ls0 ws0">10:    }</div><div class="t m5 x74 h2f y62f ffb fs10 fc2 sc0 ls0 ws0">11:}</div><div class="t m0 x74 h14 y409 ff8 fs3 fc2 sc0 ls34 ws3e7">What happens if w<span class="_ _4"></span>e change type of </div><div class="t m5 xdd h2f y409 ffb fs10 fc2 sc0 ls66 ws0">lastId</div><div class="t m0 x42 h14 y409 ff8 fs3 fc2 sc0 ls34 ws3e7"> from </div><div class="t m5 x27 h2f y409 ffb fs10 fc2 sc0 ls66 ws0">int</div><div class="t m0 xa1 h14 y409 ff8 fs3 fc2 sc0 ls34 ws3e7"> to </div><div class="t m5 xe8 h2f y409 ffb fs10 fc2 sc0 ls66 ws0">long</div><div class="t m0 xb5 h14 y409 ff8 fs3 fc2 sc0 ls34 ws3e7">? Is line 5 still atomic?</div><div class="t m0 xd h14 y846 ff8 fs3 fc2 sc0 ls34 ws430">Not according to the JVM speciﬁcation. It could be atomic on a particular processor,</div><div class="t m0 xd h14 y92b ff8 fs3 fc2 sc0 ls34 ws27b">but according to the JVM speciﬁcation, assignment to any 64-bit v<span class="_ _1"></span>alue requires two</div><div class="t m0 xd h14 y209 ff8 fs3 fc2 sc0 ls29 ws103">32-bit assignments. <span class="_ _1"></span>This means that between the ﬁrst 32-bit assignment and the second</div><div class="t m0 xd h14 y20a ff8 fs3 fc2 sc0 ls34 ws0">32-bit assignment, some other thread could sneak in and change one of the v<span class="_ _4"></span>alues. </div><div class="t m0 x74 h14 y1e2 ff8 fs3 fc2 sc0 ls0 ws792">What about the pre-increment operator<span class="_ _4"></span>, ++, on line 9? <span class="_ _4"></span>The pre-increment operator can</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc2 sc0 ls0 ws194">be inter<span class="_ _8"></span>rupted<span class="_ _4"></span>, so it is not atomic. <span class="_ _4"></span>T<span class="_ _0"></span>o understand<span class="_ _4"></span>, let’<span class="_ _2"></span>s revie<span class="_ _4"></span>w the byte-code of both of these</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc2 sc0 ls0 ws0">methods in detail. </div><div class="t m0 x74 h14 y1c1 ff8 fs3 fc2 sc0 ls0 ws0">Before w<span class="_ _4"></span>e go any further<span class="_ _4"></span>, here are three deﬁnitions that will be impor<span class="_ _8"></span>tant:</div><div class="t m0 x2c h1b y588 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Frame—Ev<span class="_ _4"></span>er<span class="_ _8"></span>y method in<span class="_ _4"></span>vocation requires a frame. <span class="_ _1"></span>The frame includes the retur<span class="_ _8"></span>n </span></div><div class="t m0 x74 h14 y578 ff8 fs3 fc2 sc0 ls0 ws0">address, an<span class="_ _4"></span>y parameters passed into the method and the local variab<span class="_ _4"></span>les deﬁned in the </div><div class="t m0 x74 h14 y579 ff8 fs3 fc2 sc0 ls0 ws0">method. <span class="_ _1"></span>This is a standard technique used to deﬁne a call stack, which is used by </div><div class="t m0 x74 h14 y57a ff8 fs3 fc2 sc0 ls0 ws0">modern languages to allow for basic function/method in<span class="_ _1"></span>vocation and to allo<span class="_ _4"></span>w for </div><div class="t m0 x74 h14 y57b ff8 fs3 fc2 sc0 ls0 ws0">recursiv<span class="_ _4"></span>e in<span class="_ _4"></span>vocation.</div><div class="t m0 x2c h1b y3a8 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 wscb">Local variab<span class="_ _4"></span>le—An<span class="_ _4"></span>y variab<span class="_ _4"></span>les deﬁned in the scope of the method. <span class="_ _4"></span>All nonstatic meth-</span></div><div class="t m0 x74 h14 y38d ff8 fs3 fc2 sc0 ls0 ws0">ods ha<span class="_ _4"></span>ve at least one v<span class="_ _4"></span>ariable,<span class="ffa"> </span></div><div class="t m5 x76 h46 y38d ffc fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 x5c h14 y38d ff8 fs3 fc2 sc0 ls0 ws0">, which represents the current object, the object </div><div class="t m0 x74 h14 y38e ff8 fs3 fc2 sc0 ls0 ws0">that recei<span class="_ _4"></span>ved the most recent message (in the cur<span class="_ _8"></span>rent thread), which caused the </div><div class="t m0 x74 h14 y38f ff8 fs3 fc2 sc0 ls0 ws0">method in<span class="_ _4"></span>vocation.</div><div class="t m0 x2c h1b y550 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Operand stack—Man<span class="_ _4"></span>y of the instr<span class="_ _8"></span>uctions in the Jav<span class="_ _4"></span>a <span class="_ _1"></span>Virtual Machine take parame-</span></div><div class="t m0 x74 h14 y2cb ff8 fs3 fc2 sc0 ls0 ws0">ters. <span class="_ _1"></span>The operand stack is where those parameters are put. <span class="_ _4"></span>The stack is a standard </div><div class="t m0 x74 h14 y2cc ff8 fs3 fc2 sc0 ls0 ws0">last-in, ﬁrst-out (LIFO) data structure.</div><div class="t m0 x74 h14 y42d ff8 fs3 fc2 sc0 ls0 ws0">Here is the b<span class="_ _4"></span>yte-code generated for </div><div class="t m5 x83 h2f y42d ffb fs10 fc2 sc0 ls0 ws0">resetId()</div><div class="t m0 xde h14 y42d ff8 fs3 fc2 sc0 ls0 ws0">:</div><div class="t m0 x47 h1c y14db ff1 fs3 fc2 sc0 ls0 ws0">Mnemonic<span class="_ _42"> </span>Description<span class="_ _43"> </span>Operand </div><div class="t m0 x4a h1c y5ec ff1 fs3 fc2 sc0 ls0 ws1fc">Stack After</div><div class="t m5 x47 h2f yac0 ffb fs10 fc2 sc0 ls0 ws0">ALOAD 0</div><div class="t m0 xc6 h14 y3af ff8 fs3 fc2 sc0 ls0 ws7ae">Load the 0th v<span class="_ _4"></span>ariable onto the operand stack.</div><div class="t m0 xc6 h14 yc00 ff8 fs3 fc2 sc0 ls0 ws733">What is the 0th v<span class="_ _4"></span>ariable? It is </div><div class="t m7 xd2 h36 yc00 ffc fs3 fc2 sc0 ls0 ws0">this</div><div class="t m0 x89 h14 yc00 ff8 fs3 fc2 sc0 ls0 ws733">., the cur<span class="_ _8"></span>rent</div><div class="t m0 xc6 h14 yde2 ff8 fs3 fc2 sc0 ls0 ws7af">object. <span class="_ _4"></span>When the method was called<span class="_ _1"></span>, the</div><div class="t m0 xc6 h14 yb4c ff8 fs3 fc2 sc0 ls0 ws2ec">recei<span class="_ _4"></span>ver of the message, an instance of </div><div class="t m5 xe8 h2f yb4c ffb fs10 fc2 sc0 ls0 ws0">Example</div><div class="t m0 xeb h14 yb4c ff8 fs3 fc2 sc0 ls0 ws0">,</div><div class="t m0 xc6 h14 y1424 ff8 fs3 fc2 sc0 ls0 ws313">was pushed into the local v<span class="_ _1"></span>ariable ar<span class="_ _8"></span>ra<span class="_ _4"></span>y of the</div><div class="t m0 xc6 h14 y14dc ff8 fs3 fc2 sc0 ls0 ws7b0">frame created for method in<span class="_ _4"></span>vocation. <span class="_ _1"></span>This is</div><div class="t m0 xc6 h14 y14dd ff8 fs3 fc2 sc0 ls0 ws7b1">al<span class="_ _4"></span>wa<span class="_ _1"></span>ys the ﬁrst variable put in e<span class="_ _4"></span>very instance</div><div class="t m0 xc6 h14 y14de ff8 fs3 fc2 sc0 ls0 ws0">method.</div><div class="t m5 x4a h2f yac0 ffb fs10 fc2 sc0 ls0 ws0">this</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf164" class="pf w1 h2" data-page-no="164"><div class="pc pc164 w1 h2"><img class="bi xd y14df w1c hc0" alt="" src="bg164.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">325<span class="_ _10"></span><span class="ff1">P<span class="_ _1"></span>ossible P<span class="_ _4"></span>aths of Execution</span></div><div class="t m0 x74 h14 y409 ff8 fs3 fc2 sc0 ls2d ws3d2">These three instructions are guaranteed to be atomic because, although the thread</div><div class="t m0 xd h14 y846 ff8 fs3 fc2 sc0 ls2d ws7b2">ex<span class="_ _4"></span>ecuting them could be inter<span class="_ _8"></span>rupted after any one of them, the information for the</div><div class="t m0 xd h14 y92b ff8 fs3 fc2 sc0 ls2d ws89">PUTFIELD instruction (the constant value 0 on the top of the stack and the reference to</div><div class="t m5 xd h2f y209 ffb fs10 fc2 sc0 ls2e ws0">this</div><div class="t m0 x74 h14 y209 ff8 fs3 fc2 sc0 ls2d ws22b"> one belo<span class="_ _4"></span>w the top, along with the ﬁeld value) cannot be touched b<span class="_ _4"></span>y another thread.</div><div class="t m0 xd h14 y20a ff8 fs3 fc2 sc0 ls2d ws2bd">So when the assignment occurs, w<span class="_ _1"></span>e are guaranteed that the value 0 will be stored in the</div><div class="t m0 xd h14 y20b ff8 fs3 fc2 sc0 ls2d ws3ac">ﬁeld v<span class="_ _4"></span>alue. <span class="_ _4"></span>The operation is atomic. <span class="_ _4"></span>The operands all deal with infor<span class="_ _8"></span>mation local to the</div><div class="t m0 xd h14 y20c ff8 fs3 fc2 sc0 ls2d ws0">method<span class="_ _1"></span>, so there is no interference between multiple threads. </div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc2 sc0 ls10 ws372">So if these three instructions are ex<span class="_ _4"></span>ecuted by ten threads, there are 4.38679733629e+24</div><div class="t m0 xd h14 y54a ff8 fs3 fc2 sc0 ls0 ws3d4">possible orderings. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, there is only one possib<span class="_ _4"></span>le outcome, so the different orderings</div><div class="t m0 xd h14 y54b ff8 fs3 fc2 sc0 ls0 ws3df">are ir<span class="_ _8"></span>relev<span class="_ _4"></span>ant. It just so happens that the same outcome is guaranteed for longs in this case</div><div class="t m0 xd h14 y54c ff8 fs3 fc2 sc0 ls0 ws404">as w<span class="_ _4"></span>ell. Wh<span class="_ _1"></span>y? <span class="_ _4"></span>All ten threads are assigning a constant value. Ev<span class="_ _4"></span>en if they interlea<span class="_ _4"></span>ve with</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc2 sc0 ls0 ws0">each other<span class="_ _4"></span>, the end result is the same.</div><div class="t m0 x74 h14 y1e5 ff8 fs3 fc2 sc0 ls0 ws7b3">W<span class="_ _4"></span>ith the </div><div class="t m5 x86 h2f y3f5 ffb fs10 fc2 sc0 ls0 ws0">++</div><div class="t m0 x3a h14 y3f5 ff8 fs3 fc2 sc0 ls0 ws7b3"> operation in the </div><div class="t m5 x77 h2f y3f5 ffb fs10 fc2 sc0 ls0 ws0">getNextId</div><div class="t m0 x1b h14 y3f5 ff8 fs3 fc2 sc0 ls0 ws7b3"> method<span class="_ _1"></span>, there are going to be problems.</div><div class="t m0 xd h14 y3f6 ff8 fs3 fc2 sc0 ls0 wsca">Assume that </div><div class="t m5 x41 h2f y3f6 ffb fs10 fc2 sc0 ls0 ws0">lastId</div><div class="t m0 x4d h14 y3f6 ff8 fs3 fc2 sc0 ls0 wsca"> holds 42 at the beginning of this method. Here is the b<span class="_ _4"></span>yte-code for this</div><div class="t m0 xd h14 y3f7 ff8 fs3 fc2 sc0 ls0 ws0">ne<span class="_ _4"></span>w method:</div><div class="t m5 x47 h2f y14e0 ffb fs10 fc2 sc0 ls0 ws0">ICONST_0</div><div class="t m0 xc6 h14 y534 ff8 fs3 fc2 sc0 ls0 ws0">Put the constant v<span class="_ _4"></span>alue 0 onto the operand stack.</div><div class="t m5 x4a h2f y14e0 ffb fs10 fc2 sc0 ls0 ws0">this, 0</div><div class="t m5 x47 h2f y14e1 ffb fs10 fc2 sc0 ls0 ws0">PUTFIELD lastId</div><div class="t m0 xc6 h14 y198 ff8 fs3 fc2 sc0 ls0 ws3f8">Store the top v<span class="_ _4"></span>alue on the stack (which is 0) into</div><div class="t m0 xc6 h14 y199 ff8 fs3 fc2 sc0 ls0 ws377">the ﬁeld v<span class="_ _4"></span>alue of the object refer<span class="_ _8"></span>red to by the</div><div class="t m0 xc6 h14 y1da ff8 fs3 fc2 sc0 ls0 ws7b4">object reference one a<span class="_ _4"></span>wa<span class="_ _1"></span>y from the top of the</div><div class="t m0 xc6 h14 y1db ff8 fs3 fc2 sc0 ls0 ws0">stack,<span class="_ _4"></span><span class="ff5"> </span></div><div class="t m7 x57 h36 y1db ffc fs3 fc2 sc0 ls0 ws0">this</div><div class="t m0 xdf h14 y1db ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m0 x4a h14 y198 ff8 fs3 fc2 sc0 ls0 ws0">&lt;empty&gt;</div><div class="t m0 x47 h1c y14e2 ff1 fs3 fc2 sc0 ls0 ws0">Mnemonic<span class="_ _44"> </span>Description<span class="_ _43"> </span>Operand </div><div class="t m0 xaf h1c y14e3 ff1 fs3 fc2 sc0 ls0 ws1fc">Stack After</div><div class="t m5 x47 h2f y14e4 ffb fs10 fc2 sc0 ls0 ws0">ALOAD 0</div><div class="t m0 xc6 h14 y14e5 ff8 fs3 fc2 sc0 ls0 ws0">Load </div><div class="t m5 xc7 h2f y14e5 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xa2 h14 y14e5 ff8 fs3 fc2 sc0 ls0 ws0"> onto the operand stack</div><div class="t m5 xaf h2f y14e4 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m5 x47 h2f y14e6 ffb fs10 fc2 sc0 ls0 ws0">DUP</div><div class="t m0 xc6 h14 y14e7 ff8 fs3 fc2 sc0 ls0 ws7b5">Cop<span class="_ _4"></span>y the top of the stack. W<span class="_ _0"></span>e no<span class="_ _1"></span>w hav<span class="_ _4"></span>e tw<span class="_ _4"></span>o</div><div class="t m0 xc6 h14 y14e8 ff8 fs3 fc2 sc0 ls0 ws0">copies of </div><div class="t m5 xf6 h2f y14e8 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 x77 h14 y14e8 ff8 fs3 fc2 sc0 ls0 ws0"> on the operand stack.</div><div class="t m5 xaf h2f y14e7 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xa6 h14 y14e7 ff8 fs3 fc2 sc0 ls0 ws0">, </div><div class="t m5 x63 h2f y14e7 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m5 x47 h2f y14e9 ffb fs10 fc2 sc0 ls0 ws0">GETFIELD lastId</div><div class="t m0 xc6 h14 y14ea ff8 fs3 fc2 sc0 ls3d ws2b6">Retriev<span class="_ _4"></span>e the value of the ﬁeld </div><div class="t m5 x40 h2f y14ea ffb fs10 fc2 sc0 ls41 ws0">lastId</div><div class="t m0 x21 h14 y14ea ff8 fs3 fc2 sc0 ls3d ws2b6"> from the</div><div class="t m0 xc6 h14 y14eb ff8 fs3 fc2 sc0 ls3d wsaf">object pointed to on the top of the stack (</div><div class="t m5 x6a h2f y14eb ffb fs10 fc2 sc0 ls41 ws0">this</div><div class="t m0 xa0 h14 y14eb ff8 fs3 fc2 sc0 ls3d wsaf">) and</div><div class="t m0 xc6 h14 y14ec ff8 fs3 fc2 sc0 ls3d ws0">store that v<span class="_ _4"></span>alue back on to the stack.</div><div class="t m5 xaf h2f y14ea ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xa6 h14 y14ea ff8 fs3 fc2 sc0 ls0 ws0">, 42</div><div class="t m5 x47 h2f y14ed ffb fs10 fc2 sc0 ls0 ws0">ICONST_1</div><div class="t m0 xc6 h14 y14ee ff8 fs3 fc2 sc0 ls0 ws0">Push the integer constant 1 on the stack.</div><div class="t m5 xaf h2f y14ee ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xa6 h14 y14ee ff8 fs3 fc2 sc0 ls0 ws0">, 42, 1</div><div class="t m5 x47 h2f y14ef ffb fs10 fc2 sc0 ls0 ws0">IADD</div><div class="t m0 xc6 h14 y14f0 ff8 fs3 fc2 sc0 ls0 ws48c">Integer add the top tw<span class="_ _1"></span>o values on the operand</div><div class="t m0 xc6 h14 y14c5 ff8 fs3 fc2 sc0 ls0 ws151">stack and store the result back on to the operand</div><div class="t m0 xc6 h14 y14c6 ff8 fs3 fc2 sc0 ls0 ws0">stack.</div><div class="t m5 xaf h2f y14f0 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xa6 h14 y14f0 ff8 fs3 fc2 sc0 ls0 ws0">, 43</div><div class="t m5 x47 h2f y14f1 ffb fs10 fc2 sc0 ls0 ws0">DUP_X1</div><div class="t m0 xc6 h14 y14f2 ff8 fs3 fc2 sc0 ls0 ws0">Duplicate the v<span class="_ _4"></span>alue 43 and put it before </div><div class="t m5 x62 h2f y14f2 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 xb9 h14 y14f2 ff8 fs3 fc2 sc0 ls0 ws0">.<span class="_ _45"> </span>43, </div><div class="t m5 xe1 h2f y14f2 ffb fs10 fc2 sc0 ls0 ws0">this</div><div class="t m0 x94 h14 y14f2 ff8 fs3 fc2 sc0 ls0 ws0">, 43</div><div class="t m5 x47 h2f y14f3 ffb fs10 fc2 sc0 ls0 ws0">PUTFIELD value</div><div class="t m0 xc6 h14 y14f4 ff8 fs3 fc2 sc0 ls3d ws6bf">Store the top v<span class="_ _4"></span>alue on the operand stack, 43, into</div><div class="t m0 xc6 h14 y14f5 ff8 fs3 fc2 sc0 ls8f ws540">the ﬁeld value of the current object, represented by</div><div class="t m0 xc6 h14 y14f6 ff8 fs3 fc2 sc0 ls3d ws0">the next-to-top v<span class="_ _4"></span>alue on the operand stack, </div><div class="t m5 xab h2f y14f7 ffb fs10 fc2 sc0 ls41 ws0">this</div><div class="t m0 x82 h14 y14f7 ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m0 xaf h14 y14f8 ff8 fs3 fc2 sc0 ls0 ws0">43</div><div class="t m5 x47 h2f y14f9 ffb fs10 fc2 sc0 ls0 ws0">IRETURN</div><div class="t m0 xc6 h14 y14fa ff8 fs3 fc2 sc0 ls10 ws0">return the top (and only) v<span class="_ _4"></span>alue on <span class="ws167">the stack.<span class="_ _46"> </span><span class="ls0">&lt;empty&gt;</span></span></div><div class="t m0 x47 h1c y14fb ff1 fs3 fc2 sc0 ls0 ws0">Mnemonic<span class="_ _42"> </span>Description<span class="_ _43"> </span>Operand </div><div class="t m0 x4a h1c ya2e ff1 fs3 fc2 sc0 ls0 ws1fc">Stack After</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf165" class="pf w1 h2" data-page-no="165"><div class="pc pc165 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">326<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls59 ws755">Imagine the case where the ﬁrst thread completes the ﬁrst three instructions, up to and</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls59 ws4b5">including GETFIELD<span class="_ _1"></span>, and then it is inter<span class="_ _8"></span>r<span class="_ _8"></span>upted. <span class="_ _4"></span>A second thread takes o<span class="_ _1"></span>ver and performs</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls59 ws6ef">the entire method<span class="_ _1"></span>, incrementing </div><div class="t m5 xf6 h2f y196 ffb fs10 fc2 sc0 ls9a ws0">lastId</div><div class="t m0 x32 h14 y196 ff8 fs3 fc2 sc0 ls59 ws6ef"> b<span class="_ _4"></span>y one; it gets 43 back. <span class="_ _4"></span>Then the ﬁrst thread picks up</div><div class="t m0 xd h14 y197 ff8 fs3 fc2 sc0 ls59 ws134">where it left of<span class="_ _4"></span>f; 42 is still on the operand stack because that w<span class="_ _4"></span>as the value of </div><div class="t m5 xbd h2f y197 ffb fs10 fc2 sc0 ls9a ws0">lastId</div><div class="t m0 xfa h14 y197 ff8 fs3 fc2 sc0 ls59 ws134"> when it</div><div class="t m0 xd h14 y198 ff8 fs3 fc2 sc0 ls9b ws7b4">ex<span class="_ _4"></span>ecuted GETFIELD<span class="_ _1"></span>. It adds one to get 43 again and stores the result. <span class="_ _4"></span>The value 43 is</div><div class="t m0 xd h14 y199 ff8 fs3 fc2 sc0 ls59 ws666">returned to the ﬁrst thread as well. <span class="_ _1"></span>The result is that one of the increments is lost because the</div><div class="t m0 xd h14 y1da ff8 fs3 fc2 sc0 ls59 ws0">ﬁrst thread stepped on the second thread after the second thread inter<span class="_ _8"></span>rupted the ﬁrst thread.</div><div class="t m0 x74 h14 y19b ff8 fs3 fc2 sc0 ls0 ws0">Making the </div><div class="t m5 xfb h2f y19b ffb fs10 fc2 sc0 ls0 ws0">getNexId()</div><div class="t m0 xc7 h14 y19b ff8 fs3 fc2 sc0 ls0 ws0"> method synchronized ﬁx<span class="_ _4"></span>es this problem.</div><div class="t m0 xd h11 ybd1 ff1 fs7 fc2 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y570 ff8 fs3 fc2 sc0 ls0 ws629">An intimate understanding of b<span class="_ _4"></span>yte-code is not necessar<span class="_ _8"></span>y to understand ho<span class="_ _4"></span>w threads can</div><div class="t m0 xd h14 y5d0 ff8 fs3 fc2 sc0 ls0 ws286">step on each other<span class="_ _1"></span>. If you can understand this one example, it should demonstrate the pos-</div><div class="t m0 xd h14 y6ce ff8 fs3 fc2 sc0 ls0 ws0">sibility of multiple threads stepping on each other<span class="_ _4"></span>, which is enough kno<span class="_ _1"></span>wledge.</div><div class="t m0 x74 h14 y2af ff8 fs3 fc2 sc0 ls0 ws7b6">That being said<span class="_ _1"></span>, what this tri<span class="_ _4"></span>vial example demonstrates is a need to understand the</div><div class="t m0 xd h14 y8fb ff8 fs3 fc2 sc0 ls0 ws2dd">memory model enough to know w<span class="_ _4"></span>hat is and is not safe. It is a common misconception that</div><div class="t m0 xd h14 y8fc ff8 fs3 fc2 sc0 ls0 ws504">the ++ (pre- or post-increment) operator is atomic, and it clearly is not. <span class="_ _1"></span>This means you</div><div class="t m0 xd h14 y9a1 ff8 fs3 fc2 sc0 ls0 ws0">need to kno<span class="_ _4"></span>w:</div><div class="t m0 x2c h1b y3a3 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Where there are shared objects/v<span class="_ _4"></span>alues</span></div><div class="t m0 x2c h1b yb1e ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">The code that can cause concur<span class="_ _8"></span>rent read/update issues</span></div><div class="t m0 x2c h1b yc58 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Ho<span class="_ _4"></span>w to guard such concur<span class="_ _8"></span>rent issues from happening</span></div><div class="t m0 xd h17 y14fc ff1 fs9 fc2 sc0 ls0 ws4ee">Kno<span class="_ _1"></span>wing Y<span class="_ _3"></span>our <span class="_ _d"></span>Library</div><div class="t m0 xd h11 y14fd ff1 fs7 fc2 sc0 ls0 ws0">Executor F<span class="_ _1"></span>rame<span class="_ _4"></span>w<span class="_ _4"></span>ork</div><div class="t m0 xd h14 y37b ff8 fs3 fc2 sc0 ls0 ws560">As demonstrated in the </div><div class="t m5 xa h2f y37b ffb fs10 fc2 sc0 ls0 ws0">ExecutorClientScheduler.java</div><div class="t m0 x27 h14 y37b ff8 fs3 fc2 sc0 ls0 ws560"> on page 321, the </div><div class="t m5 xa7 h2f y37b ffb fs10 fc2 sc0 ls0 ws0">Executor</div><div class="t m0 x64 h14 y37b ff8 fs3 fc2 sc0 ls0 ws560"> frame-</div><div class="t m0 xd h14 y37c ff8 fs3 fc2 sc0 ls0 ws43d">w<span class="_ _4"></span>ork introduced in Ja<span class="_ _4"></span>va 5 allo<span class="_ _1"></span>ws for sophisticated execution using thread pools. <span class="_ _1"></span>This is a</div><div class="t m0 xd h14 y37d ff8 fs3 fc2 sc0 ls0 ws0">class in the </div><div class="t m5 x4c h2f y37d ffb fs10 fc2 sc0 ls0 ws0">java.util.concurrent</div><div class="t m0 xec h14 y37d ff8 fs3 fc2 sc0 ls0 ws0"> package.</div><div class="t m0 x74 h14 y2cd ff8 fs3 fc2 sc0 ls0 ws53">If you are creating threads and are not using a thread pool or <span class="_ _4"></span><span class="ffa ws0">are<span class="ff8 ls11 ws3f1"> using a hand-written</span></span></div><div class="t m0 xd h14 y2ce ff8 fs3 fc2 sc0 ls0 ws29c">one, you should consider using the </div><div class="t m5 x5b h2f y2ce ffb fs10 fc2 sc0 ls0 ws0">Executor</div><div class="t m0 x9d h14 y2ce ff8 fs3 fc2 sc0 ls0 ws29c">. It will make y<span class="_ _4"></span>our code cleaner<span class="_ _4"></span>, easier to fol-</div><div class="t m0 xd h14 y3e2 ff8 fs3 fc2 sc0 ls0 ws0">lo<span class="_ _4"></span>w<span class="_ _0"></span>, and smaller<span class="_ _4"></span>.</div><div class="t m0 x74 h14 y2d0 ff8 fs3 fc2 sc0 ls0 ws0">The </div><div class="t m5 x3f h2f y585 ffb fs10 fc2 sc0 ls0 ws0">Executor</div><div class="t m0 x6 h14 y585 ff8 fs3 fc2 sc0 ls0 ws96"> framew<span class="_ _1"></span>ork will pool threads, resize automatically<span class="_ _0"></span>, and recreate threads</div><div class="t m0 xd h14 y3e5 ff8 fs3 fc2 sc0 ls0 ws41f">if necessary<span class="_ _1"></span>. It also suppor<span class="_ _8"></span>ts <span class="ffa ws0">futur<span class="_ _4"></span>es,<span class="ff8 ws41f"> a common concur<span class="_ _8"></span>rent programming constr<span class="_ _8"></span>uct. <span class="_ _1"></span>The</span></span></div><div class="t m5 xd h2f y3e6 ffb fs10 fc2 sc0 ls0 ws0">Executor</div><div class="t m0 x9a h14 y3e6 ff8 fs3 fc2 sc0 ls0 ws4ae"> framew<span class="_ _1"></span>ork w<span class="_ _4"></span>orks with classes that implement </div><div class="t m5 xc2 h2f y3e6 ffb fs10 fc2 sc0 ls0 ws0">Runnable</div><div class="t m0 x82 h14 y3e6 ff8 fs3 fc2 sc0 ls0 ws4ae"> and also w<span class="_ _4"></span>orks with</div><div class="t m0 xd h14 y3c9 ff8 fs3 fc2 sc0 ls0 wsa2">classes that implement the </div><div class="t m5 x1f h2f y3c9 ffb fs10 fc2 sc0 ls0 ws0">Callable</div><div class="t m0 x5b h14 y3c9 ff8 fs3 fc2 sc0 ls0 wsa2"> interface. <span class="_ _4"></span>A </div><div class="t m5 xd5 h2f y3c9 ffb fs10 fc2 sc0 ls0 ws0">Callable</div><div class="t m0 xdb h14 y3c9 ff8 fs3 fc2 sc0 ls0 wsa2"> looks like a </div><div class="t m5 x6b h2f y3c9 ffb fs10 fc2 sc0 ls0 ws0">Runnable</div><div class="t m0 x93 h14 y3c9 ff8 fs3 fc2 sc0 ls48 ws7b7">, but it can</div><div class="t m0 xd h14 y3e8 ff8 fs3 fc2 sc0 ls0 ws0">return a result, which is a common need in multithreaded solutions.</div><div class="t m0 x74 h14 yb27 ff8 fs3 fc2 sc0 ls0 ws0">A <span class="_ _5"></span><span class="ffa">future</span><span class="ws33f"> is handy w<span class="_ _4"></span>hen code needs to ex<span class="_ _4"></span>ecute multiple, independent operations and</span></div><div class="t m0 xd h14 y556 ff8 fs3 fc2 sc0 ls0 ws0">wait for both to ﬁnish:</div><div class="t m5 x74 h2f y14fe ffb fs10 fc2 sc0 ls0 ws0">public String processRequest(String message) throws Exception {</div><div class="t m5 x74 h2f y14ff ffb fs10 fc2 sc0 ls0 ws0">    Callable&lt;String&gt; makeExternalCall = new Callable&lt;String&gt;() {</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:471.728010px;width:57.348000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:289.945010px;width:135.823000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:263.728010px;width:108.638000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf166" class="pf w1 h2" data-page-no="166"><div class="pc pc166 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">327<span class="_ _10"></span><span class="ff1 ws4ec">Kno<span class="_ _1"></span>wing Y<span class="_ _0"></span>our <span class="_ _6"></span>Library</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc2 sc0 ls0 ws0">        public String call() throws Exception {</div><div class="t m5 x74 h2f y627 ffb fs10 fc2 sc0 ls0 ws0">            String result = &quot;&quot;;</div><div class="t m5 x74 h2f y628 ffb fs10 fc2 sc0 ls0 ws0">            // make external request</div><div class="t m5 x74 h2f y629 ffb fs10 fc2 sc0 ls0 ws0">            return result;</div><div class="t m5 x74 h2f y62a ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y62b ffb fs10 fc2 sc0 ls0 ws0">    };</div><div class="t m5 x74 h2f y62d ffb fs10 fc2 sc0 ls0 ws0">    Future&lt;String&gt; result = executorService.submit(makeExternalCall);</div><div class="t m5 x74 h2f y861 ffb fs10 fc2 sc0 ls0 ws0">    String partialResult = doSomeLocalProcessing();</div><div class="t m5 x74 h2f y62e ffb fs10 fc2 sc0 ls0 ws0">    return result.get() + partialResult;</div><div class="t m5 x74 h2f y62f ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y409 ff8 fs3 fc2 sc0 ls0 ws8a">In this example, the method starts ex<span class="_ _4"></span>ecuting the </div><div class="t m5 xcf h2f y409 ffb fs10 fc2 sc0 ls0 ws0">makeExternalCall</div><div class="t m0 xa0 h14 y409 ff8 fs3 fc2 sc0 ls0 ws8a"> object. <span class="_ _1"></span>The method con-</div><div class="t m0 xd h14 y846 ff8 fs3 fc2 sc0 ls0 ws569">tinues other processing. <span class="_ _1"></span>The ﬁnal line calls </div><div class="t m5 x1b h2f y846 ffb fs10 fc2 sc0 ls0 ws0">result.get()</div><div class="t m0 xae h14 y846 ff8 fs3 fc2 sc0 ls0 ws569">, which b<span class="_ _4"></span>locks until the future</div><div class="t m0 xd h14 y92b ff8 fs3 fc2 sc0 ls0 ws0">completes.</div><div class="t m0 xd h11 y1500 ff1 fs7 fc2 sc0 ls0 ws0">Nonblocking Solutions</div><div class="t m0 xd h14 y32a ff8 fs3 fc2 sc0 ls12 ws549">The Ja<span class="_ _4"></span>va 5 <span class="_ _1"></span>VM takes adv<span class="_ _4"></span>antage of moder<span class="_ _8"></span>n processor design, which supports reliable,</div><div class="t m0 xd h14 y32b ff8 fs3 fc2 sc0 ls12 ws0">nonb<span class="_ _4"></span><span class="ls0 ws38f">locking updates. Consider<span class="_ _4"></span>, for example, a class that uses synchronization (and there-</span></div><div class="t m0 xd h14 y848 ff8 fs3 fc2 sc0 ls0 ws0">fore blocking) to pro<span class="_ _1"></span>vide a thread-safe update of a value:</div><div class="t m5 x74 h2f y29 ffb fs10 fc2 sc0 ls0 ws0">public class ObjectWithValue {</div><div class="t m5 x74 h2f y1501 ffb fs10 fc2 sc0 ls0 ws0">    private int value;</div><div class="t m5 x74 h2f y1502 ffb fs10 fc2 sc0 ls0 ws0">    public void synchronized incrementValue() { ++value; }</div><div class="t m5 x74 h2f y1503 ffb fs10 fc2 sc0 ls0 ws0">    public int getValue() { return value; }</div><div class="t m5 x74 h2f y1504 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y1420 ff8 fs3 fc2 sc0 ls0 ws7b8">Ja<span class="_ _4"></span>va 5 has a series of ne<span class="_ _4"></span>w classes for situations like this: </div><div class="t m5 x5e h2f y1420 ffb fs10 fc2 sc0 ls0 ws0">AtomicBoolean</div><div class="t m0 x56 h14 y1420 ff8 fs3 fc2 sc0 ls0 ws0">,</div><div class="t m5 xd h2f y9be ffb fs10 fc2 sc0 ls0 ws0">AtomicInteger</div><div class="t m0 x28 h14 y9be ff8 fs3 fc2 sc0 ls0 ws6d7">, and </div><div class="t m5 xd6 h2f y9be ffb fs10 fc2 sc0 ls0 ws0">AtomicReference</div><div class="t m0 x77 h14 y9be ff8 fs3 fc2 sc0 ls0 ws6d7"> are three examples; there are se<span class="_ _4"></span>veral more. <span class="_ _4"></span>W<span class="_ _0"></span>e can</div><div class="t m0 xd h14 y9bf ff8 fs3 fc2 sc0 ls0 ws0">re<span class="_ _4"></span>write the abo<span class="_ _4"></span>ve code to use a nonblocking approach as follo<span class="_ _1"></span>ws:</div><div class="t m5 x74 h2f y1505 ffb fs10 fc2 sc0 ls0 ws0">public class ObjectWithValue {</div><div class="t m5 x74 h2f y1506 ffb fs10 fc2 sc0 ls0 ws0">    private AtomicInteger value = new AtomicInteger(0);</div><div class="t m5 x74 h2f y1507 ffb fs10 fc2 sc0 ls0 ws0">    public void incrementValue() {</div><div class="t m5 x74 h2f y1508 ffb fs10 fc2 sc0 ls0 ws0">        value.incrementAndGet();</div><div class="t m5 x74 h2f y1509 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y150a ffb fs10 fc2 sc0 ls0 ws0">    public int getValue() {</div><div class="t m5 x74 h2f y150b ffb fs10 fc2 sc0 ls0 ws0">        return value.get();</div><div class="t m5 x74 h2f y150c ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y150d ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 ya14 ff8 fs3 fc2 sc0 ls0 ws7b9">Even though this uses an object instead of a primiti<span class="_ _4"></span>ve and sends messages like</div><div class="t m5 xd h2f y70e ffb fs10 fc2 sc0 ls0 ws0">incrementAndGet()</div><div class="t m0 xe4 h14 y70e ff8 fs3 fc2 sc0 ls0 ws714"> instead of ++, the performance of this class will nearly al<span class="_ _4"></span>wa<span class="_ _1"></span>ys beat the</div><div class="t m0 xd h14 y70f ff8 fs3 fc2 sc0 lsd ws5b1">pre<span class="_ _4"></span>vious version. In some cases it will only be slightl<span class="_ _4"></span>y faster<span class="_ _4"></span>, but the cases where it will be</div><div class="t m0 xd h14 y710 ff8 fs3 fc2 sc0 ls0 ws0">slo<span class="_ _4"></span>w<span class="_ _4"></span>er are vir<span class="_ _8"></span>tually none<span class="_ _4"></span>xistent.</div><div class="t m0 x74 h14 ye3e ff8 fs3 fc2 sc0 ls0 ws38f">Ho<span class="_ _4"></span>w is this possible? Modern processors ha<span class="_ _4"></span>ve an operation typicall<span class="_ _4"></span>y called <span class="ffa ws0">Compar<span class="_ _4"></span>e</span></div><div class="t m0 xd h14 ye3f ffa fs3 fc2 sc0 ls0 ws397">and Swap (CAS)<span class="ff8">. <span class="_ _1"></span>This operation is analogous to optimistic locking in databases, w<span class="_ _4"></span>hereas</span></div><div class="t m0 xd h14 yf08 ff8 fs3 fc2 sc0 ls0 ws0">the synchronized version is analo<span class="_ _4"></span>gous to pessimistic locking. </div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:429.728010px;width:115.467000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf167" class="pf w1 h2" data-page-no="167"><div class="pc pc167 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">328<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls0 ws0">The </div><div class="t m5 x3f h2f y194 ffb fs10 fc2 sc0 ls0 ws0">synchronized</div><div class="t m0 xed h14 y194 ff8 fs3 fc2 sc0 ls0 ws40c"> keyw<span class="_ _1"></span>ord al<span class="_ _4"></span>wa<span class="_ _4"></span>ys acquires a lock, ev<span class="_ _4"></span>en when a second thread is not</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws7ba">trying to update the same value. Even though the performance of intrinsic locks has</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws0">impro<span class="_ _4"></span>ved from v<span class="_ _4"></span>ersion to version, they are still costl<span class="_ _4"></span>y<span class="_ _0"></span>. </div><div class="t m0 x74 h14 y1fb ff8 fs3 fc2 sc0 ls0 wsce">The nonblocking v<span class="_ _4"></span>ersion star<span class="_ _8"></span>ts with the assumption that multiple threads generally do</div><div class="t m0 xd h14 y1bd ff8 fs3 fc2 sc0 ls0 ws560">not modify the same v<span class="_ _4"></span>alue often enough that a problem will arise. Instead<span class="_ _1"></span>, it efﬁcientl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1be ff8 fs3 fc2 sc0 ls0 ws74f">detects whether such a situation has occurred and retries until the update happens success-</div><div class="t m0 xd h14 y19a ff8 fs3 fc2 sc0 ls0 ws3e8">full<span class="_ _4"></span>y<span class="_ _1"></span>. <span class="_ _4"></span>This detection is almost al<span class="_ _4"></span>wa<span class="_ _1"></span>ys less costly than acquiring a lock, e<span class="_ _4"></span>ven in moderate to</div><div class="t m0 xd h14 y19b ff8 fs3 fc2 sc0 ls0 ws0">high contention situations. </div><div class="t m0 x74 h14 y207 ff8 fs3 fc2 sc0 ls0 ws3c8">Ho<span class="_ _4"></span>w does the <span class="_ _4"></span>V<span class="_ _4"></span>irtual Machine accomplish this? <span class="_ _4"></span>The CAS operation is atomic. Logi-</div><div class="t m0 xd h14 y1fc ff8 fs3 fc2 sc0 ls0 ws0">call<span class="_ _4"></span>y<span class="_ _1"></span>, the CAS operation looks something like the follo<span class="_ _4"></span>wing:</div><div class="t m5 x74 h2f y140a ffb fs10 fc2 sc0 ls0 ws0">int variableBeingSet;</div><div class="t m5 x74 h2f y140c ffb fs10 fc2 sc0 ls0 ws0">void simulateNonBlockingSet(int newValue) {</div><div class="t m5 x74 h2f y140d ffb fs10 fc2 sc0 ls0 ws0">    int currentValue;</div><div class="t m5 x74 h2f y140e ffb fs10 fc2 sc0 ls0 ws0">    do {</div><div class="t m5 x74 h2f y140f ffb fs10 fc2 sc0 ls0 ws0">        currentValue = variableBeingSet</div><div class="t m5 x74 h2f y1410 ffb fs10 fc2 sc0 ls0 ws0">    } while(currentValue != compareAndSwap(currentValue, newValue));</div><div class="t m5 x74 h2f y150e ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m5 x74 h2f y1412 ffb fs10 fc2 sc0 ls0 ws0">int synchronized compareAndSwap(int currentValue, int newValue) {</div><div class="t m5 x74 h2f y1413 ffb fs10 fc2 sc0 ls0 ws0">    if(variableBeingSet == currentValue) {</div><div class="t m5 x74 h2f y1414 ffb fs10 fc2 sc0 ls0 ws0">        variableBeingSet = newValue;</div><div class="t m5 x74 h2f y1415 ffb fs10 fc2 sc0 ls0 ws0">        return currentValue;</div><div class="t m5 x74 h2f y150f ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1510 ffb fs10 fc2 sc0 ls0 ws0">    return variableBeingSet;    </div><div class="t m5 x74 h2f y1511 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y414 ff8 fs3 fc2 sc0 ls0 ws206">When a method attempts to update a shared variab<span class="_ _4"></span>le, the CAS operation veriﬁes that</div><div class="t m0 xd h14 y42a ff8 fs3 fc2 sc0 ls0 ws7bb">the variab<span class="_ _4"></span>le getting set still has the last kno<span class="_ _4"></span>wn value. If so, then the v<span class="_ _4"></span>ariable is changed. If</div><div class="t m0 xd h14 y42b ff8 fs3 fc2 sc0 ls0 ws7bc">not, then the v<span class="_ _4"></span>ariable is not set because another thread managed to get in the w<span class="_ _4"></span>ay<span class="_ _0"></span>. <span class="_ _1"></span>The</div><div class="t m0 xd h14 yddd ff8 fs3 fc2 sc0 ls0 ws176">method making the attempt (using the CAS operation) sees that the change was not made</div><div class="t m0 xd h14 y58b ff8 fs3 fc2 sc0 ls0 ws0">and retries.</div><div class="t m0 xd h11 y1512 ff1 fs7 fc2 sc0 ls0 ws0">Nonthr<span class="_ _4"></span>ead-Safe Classes</div><div class="t m0 xd h14 y673 ff8 fs3 fc2 sc0 ls0 ws0">There are some classes that are inherently not thread safe. Here are a fe<span class="_ _1"></span>w examples:</div><div class="t m0 x2c h1b y2e8 ff1 fs2 fc2 sc0 ls0 ws0">•</div><div class="t m5 x74 h2f y2e8 ffb fs10 fc2 sc0 ls0 ws0">SimpleDateFormat</div><div class="t m0 x2c h1b y544 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Database Connections</span></div><div class="t m0 x2c h1b y95b ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Containers in </span></div><div class="t m5 xe2 h2f y95b ffb fs10 fc2 sc0 ls0 ws0">java.util</div><div class="t m0 x2c h1b y2ec ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Servlets</span></div><div class="t m0 xd h14 y6de ff8 fs3 fc2 sc0 ls0 ws7bd">Note that some collection classes ha<span class="_ _4"></span>ve indi<span class="_ _4"></span>vidual methods that are thread-safe. Ho<span class="_ _4"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>,</div><div class="t m0 xd h14 y555 ff8 fs3 fc2 sc0 ls0 ws574">an<span class="_ _4"></span>y operation that inv<span class="_ _4"></span>olves calling more than one method is not. F<span class="_ _1"></span>or example, if you do</div><div class="t m0 xd h14 y13c6 ff8 fs3 fc2 sc0 ls0 wsbb">not w<span class="_ _4"></span>ant to replace something in a </div><div class="t m5 x5b h2f y13c6 ffb fs10 fc2 sc0 ls0 ws0">HashTable</div><div class="t m0 x1b h14 y13c6 ff8 fs3 fc2 sc0 ls0 wsbb"> because it is already there, you might write</div><div class="t m0 xd h14 y13c7 ff8 fs3 fc2 sc0 ls0 ws0">the follo<span class="_ _4"></span>wing code:</div><div class="t m5 x74 h2f y1513 ffb fs10 fc2 sc0 ls0 ws0">if(!hashTable.containsKey(someKey)) {</div><div class="t m5 x74 h2f y1514 ffb fs10 fc2 sc0 ls0 ws0">    hashTable.put(someKey, new SomeValue());</div><div class="t m5 x74 h2f y1515 ffb fs10 fc2 sc0 ls0 ws0">}</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:228.728010px;width:121.298000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf168" class="pf w1 h2" data-page-no="168"><div class="pc pc168 w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">329<span class="_ _10"></span><span class="ff1">Dependencies Between Methods Can Br<span class="_ _1"></span>eak Concurrent Code</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls0 ws795">Each individual method is thread-safe. Ho<span class="_ _1"></span>w<span class="_ _4"></span>ever<span class="_ _1"></span>, another thread might add a value in</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">betw<span class="_ _4"></span>een the </div><div class="t m5 xc3 h2f y195 ffb fs10 fc2 sc0 ls0 ws0">containsKey</div><div class="t m0 x6e h14 y195 ff8 fs3 fc2 sc0 ls0 ws0"> and </div><div class="t m5 x5a h2f y195 ffb fs10 fc2 sc0 ls0 ws0">put</div><div class="t m0 x92 h14 y195 ff8 fs3 fc2 sc0 ls0 ws0"> calls. <span class="_ _1"></span>There are several options to ﬁx this prob<span class="_ _4"></span>lem.</div><div class="t m0 x2c h1b ya7b ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws79f">Lock the </span></div><div class="t m5 x28 h2f ya7b ffb fs10 fc2 sc0 ls0 ws0">HashTable</div><div class="t m0 x2e h14 ya7b ff8 fs3 fc2 sc0 ls0 ws79f"> ﬁrst, and make sure all other users of the </div><div class="t m5 x49 h2f ya7b ffb fs10 fc2 sc0 ls0 ws0">HashTable</div><div class="t m0 x5e h14 ya7b ff8 fs3 fc2 sc0 ls0 ws79f"> do the same—</div><div class="t m0 x74 h14 ya7c ff8 fs3 fc2 sc0 ls0 ws0">client-based locking:</div><div class="t m5 x74 h2f y1516 ffb fs10 fc2 sc0 ls0 ws0">synchronized(map) {</div><div class="t m5 x74 h2f y1517 ffb fs10 fc2 sc0 ls0 ws0">if(!map.conainsKey(key))</div><div class="t m5 x74 h2f y1518 ffb fs10 fc2 sc0 ls0 ws0">    map.put(key,value);</div><div class="t m5 x74 h2f y1519 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x2c h1b y409 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Wrap the </span></div><div class="t m5 x14 h2f y409 ffb fs10 fc2 sc0 ls0 ws0">HashTable</div><div class="t m0 x6e h14 y409 ff8 fs3 fc2 sc0 ls0 ws0"> in its o<span class="_ _4"></span>wn object and use a different <span class="_ _1"></span>API—server-based locking </div><div class="t m0 x74 h14 y846 ff8 fs3 fc2 sc0 ls0 ws0">using an A<span class="fsb">DAPTER</span>:</div><div class="t m5 x74 h2f y59 ffb fs10 fc2 sc0 ls0 ws0">public class WrappedHashtable&lt;K, V&gt; {</div><div class="t m5 x74 h2f yb4f ffb fs10 fc2 sc0 ls0 ws0">    private Map&lt;K, V&gt; map = new Hashtable&lt;K, V&gt;();</div><div class="t m5 x74 h2f yb51 ffb fs10 fc2 sc0 ls0 ws0">    public synchronized void putIfAbsent(K key, V value) {</div><div class="t m5 x74 h2f yb52 ffb fs10 fc2 sc0 ls0 ws0">        if (map.containsKey(key))</div><div class="t m5 x74 h2f yb53 ffb fs10 fc2 sc0 ls0 ws0">            map.put(key, value);</div><div class="t m5 x74 h2f yb54 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f yb55 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x2c h1b y3d7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Use the thread-safe collections:</span></div><div class="t m5 x74 h2f y424 ffb fs10 fc2 sc0 ls0 ws0">ConcurrentHashMap&lt;Integer, String&gt; map = new ConcurrentHashMap&lt;Integer, </div><div class="t m5 x74 h2f y425 ffb fs10 fc2 sc0 ls0 ws0">String&gt;();</div><div class="t m5 x74 h2f y426 ffb fs10 fc2 sc0 ls0 ws0">map.putIfAbsent(key, value);</div><div class="t m0 xd h14 y94f ff8 fs3 fc2 sc0 ls0 ws63d">The collections in </div><div class="t m5 x18 h2f y94f ffb fs10 fc2 sc0 ls0 ws0">java.util.concurrent</div><div class="t m0 xe0 h14 y94f ff8 fs3 fc2 sc0 ls0 ws63d"> ha<span class="_ _4"></span>ve operations like </div><div class="t m5 x62 h2f y94f ffb fs10 fc2 sc0 ls0 ws0">putIfAbsent()</div><div class="t m0 xbb h14 y94f ff8 fs3 fc2 sc0 ls0 ws63d"> to accommo-</div><div class="t m0 xd h14 y950 ff8 fs3 fc2 sc0 ls0 ws0">date such operations.</div><div class="t m0 xd h17 y151a ff1 fs9 fc2 sc0 ls0 ws0">Dependencies Betw<span class="_ _4"></span>een Methods </div><div class="t m0 xd h17 y151b ff1 fs9 fc2 sc0 ls0 ws0">Can Br<span class="_ _4"></span>eak Concurr<span class="_ _4"></span>ent Code</div><div class="t m0 xd h14 y3fa ff8 fs3 fc2 sc0 ls0 ws0">Here is a tri<span class="_ _4"></span>vial example of a wa<span class="_ _1"></span>y to introduce dependencies between methods:</div><div class="t m5 x74 h2f y108c ffb fs10 fc2 sc0 ls0 ws0">public class IntegerIterator implements Iterator&lt;Integer&gt;</div><div class="t m5 x74 h2f y108d ffb fs10 fc2 sc0 ls0 ws0">    private Integer nextValue = 0;</div><div class="t m5 x74 h2f y108f ffb fs10 fc2 sc0 ls0 ws0">    public synchronized boolean hasNext() {</div><div class="t m5 x74 h2f y1090 ffb fs10 fc2 sc0 ls0 ws0">        return nextValue &lt; 100000;</div><div class="t m5 x74 h2f y1091 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1092 ffb fs10 fc2 sc0 ls0 ws0">    public synchronized Integer next() {</div><div class="t m5 x74 h2f y151c ffb fs10 fc2 sc0 ls0 ws0">        if (nextValue == 100000) </div><div class="t m5 x74 h2f y151d ffb fs10 fc2 sc0 ls20 ws237">            throw new IteratorPastEndException();</div><div class="t m5 x74 h2f y151e ffb fs10 fc2 sc0 ls20 ws237">        return nextValue++;</div><div class="t m5 x74 h2f y151f ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1520 ffb fs10 fc2 sc0 ls0 ws0">    public synchronized Integer getNextValue() {</div><div class="t m5 x74 h2f y1521 ffb fs10 fc2 sc0 ls0 ws0">        return nextValue;</div><div class="t m5 x74 h2f y1522 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1523 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y557 ff8 fs3 fc2 sc0 ls0 ws0">Here is some code to use this </div><div class="t m5 xcc h2f y557 ffb fs10 fc2 sc0 ls0 ws0">IntegerIterator</div><div class="t m0 x1b h14 y557 ff8 fs3 fc2 sc0 ls0 ws0">:</div><div class="t m5 x74 h2f y1524 ffb fs10 fc2 sc0 ls0 ws0">IntegerIterator iterator = new IntegerIterator();</div><div class="t m5 x74 h2f y1525 ffb fs10 fc2 sc0 ls0 ws0">while(iterator.hasNext()) {</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:255.945010px;width:190.958000px;height:31.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf169" class="pf w1 h2" data-page-no="169"><div class="pc pc169 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">330<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc2 sc0 ls0 ws0">    int nextValue = iterator.next();</div><div class="t m5 x74 h2f y627 ffb fs10 fc2 sc0 ls0 ws0">    // do something with nextValue</div><div class="t m5 x74 h2f y628 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 ya7b ff8 fs3 fc2 sc0 ls0 ws494">If one thread ex<span class="_ _4"></span>ecutes this code, there will be no problem. But w<span class="_ _4"></span>hat happens if tw<span class="_ _4"></span>o threads</div><div class="t m0 xd h14 ya7c ff8 fs3 fc2 sc0 ls0 ws68b">attempt to share a single instance of </div><div class="t m5 xfe h2f ya7c ffb fs10 fc2 sc0 ls0 ws0">IngeterIterator</div><div class="t m0 x96 h14 ya7c ff8 fs3 fc2 sc0 ls0 ws68b"> with the intent that each thread will</div><div class="t m0 xd h14 ya7d ff8 fs3 fc2 sc0 lsd ws3eb">process the values it gets, but that each element of the list is processed onl<span class="_ _1"></span>y once? Most of</div><div class="t m0 xd h14 yb6b ff8 fs3 fc2 sc0 ls0 ws4b3">the time, nothing bad happens; the threads happily share the list, processing the elements</div><div class="t m0 xd h14 y681 ff8 fs3 fc2 sc0 ls0 ws74f">they are gi<span class="_ _4"></span>ven b<span class="_ _4"></span>y the iterator and stopping when the iterator is complete. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>, there is</div><div class="t m0 xd h14 y408 ff8 fs3 fc2 sc0 ls0 ws603">a small chance that, at the end of the iteration, the tw<span class="_ _4"></span>o threads will interfere with each</div><div class="t m0 xd h14 y409 ff8 fs3 fc2 sc0 ls0 ws0">other and cause one thread to go bey<span class="_ _4"></span>ond the end of the iterator and thro<span class="_ _4"></span>w an exception.</div><div class="t m0 x74 h14 y1de ff8 fs3 fc2 sc0 ls0 ws372">Here’<span class="_ _2"></span>s the problem: <span class="_ _1"></span>Thread 1 asks the question </div><div class="t m5 xea h2f y1de ffb fs10 fc2 sc0 ls0 ws0">hasNext()</div><div class="t m0 xe8 h14 y1de ff8 fs3 fc2 sc0 ls0 ws372">, which returns </div><div class="t m5 xf4 h2f y1de ffb fs10 fc2 sc0 ls0 ws0">true</div><div class="t m0 x90 h14 y1de ff8 fs3 fc2 sc0 ls0 ws7be">. Thread</div><div class="t m0 xd h14 y1df ff8 fs3 fc2 sc0 ls0 ws7bf">1 gets preempted and then <span class="_ _1"></span>Thread 2 asks the same question, which is still </div><div class="t m5 x5e h2f y1df ffb fs10 fc2 sc0 ls0 ws0">true</div><div class="t m0 xd3 h14 y1df ff8 fs3 fc2 sc0 ls0 ws3ef">. Thread <span class="_ _8"></span>2</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc2 sc0 ls0 ws7c0">then calls </div><div class="t m5 x46 h2f y1e0 ffb fs10 fc2 sc0 ls0 ws0">next()</div><div class="t m0 x6 h14 y1e0 ff8 fs3 fc2 sc0 lsd ws7c1">, which returns a v<span class="_ _4"></span>alue as expected but has a side effect of making</div><div class="t m5 xd h2f y1526 ffb fs10 fc2 sc0 ls0 ws0">hasNext()</div><div class="t m0 x8a h14 y1526 ff8 fs3 fc2 sc0 ls0 ws42f"> return </div><div class="t m5 xbc h2f y1526 ffb fs10 fc2 sc0 ls0 ws0">false</div><div class="t m0 x4 h14 y1526 ff8 fs3 fc2 sc0 lsc ws107">. <span class="_ _1"></span>Thread 1 star<span class="_ _8"></span>ts up again, thinking </div><div class="t m5 xae h2f y1526 ffb fs10 fc2 sc0 ls0 ws0">hasNext()</div><div class="t m0 x58 h14 y1526 ff8 fs3 fc2 sc0 ls0 ws42f"> is still </div><div class="t m5 xbd h2f y1526 ffb fs10 fc2 sc0 ls0 ws0">true</div><div class="t m0 xd3 h14 y1526 ff8 fs3 fc2 sc0 ls0 ws42f">, and then</div><div class="t m0 xd h14 y11bf ff8 fs3 fc2 sc0 ls0 ws0">calls </div><div class="t m5 x7c h2f y11bf ffb fs10 fc2 sc0 ls0 ws0">next()</div><div class="t m0 x4c h14 y11bf ff8 fs3 fc2 sc0 ls0 ws34c">. Even though the indi<span class="_ _4"></span>vidual methods are synchronized<span class="_ _1"></span>, the client uses<span class="ff5"> two</span></div><div class="t m0 xd h14 y11c0 ff8 fs3 fc2 sc0 ls0 ws0">methods.</div><div class="t m0 x74 h14 y40d ff8 fs3 fc2 sc0 ls16 ws31a">This is a real problem and an e<span class="_ _4"></span>xample of the kinds of problems that crop up in con-</div><div class="t m0 xd h14 y40e ff8 fs3 fc2 sc0 ls16 ws14b">cur<span class="_ _8"></span>rent code. In this particular situation this problem is especially subtle because the onl<span class="_ _4"></span>y</div><div class="t m0 xd h14 y1527 ff8 fs3 fc2 sc0 ls16 ws62f">time where this causes a fault is w<span class="_ _4"></span>hen it happens during the ﬁnal iteration of the iterator<span class="_ _4"></span>.</div><div class="t m0 xd h14 y3f3 ff8 fs3 fc2 sc0 ls16 wsb2">If the threads happen to break just right, then one of the threads could go bey<span class="_ _4"></span>ond the end</div><div class="t m0 xd h14 y3f4 ff8 fs3 fc2 sc0 ls32 ws451">of the iterator<span class="_ _1"></span>. <span class="_ _4"></span>This is the kind of bug that happens long after a system has been in pro-</div><div class="t m0 xd h14 y3f5 ff8 fs3 fc2 sc0 ls16 ws0">duction, and it is hard to track do<span class="_ _4"></span>wn.</div><div class="t m0 x74 h14 y413 ff8 fs3 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>ou hav<span class="_ _4"></span>e three options:</div><div class="t m0 x2c h1b yddc ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">T<span class="_ _0"></span>olerate the f<span class="_ _8"></span>ailure.</span></div><div class="t m0 x2c h1b y3a9 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Solve the prob<span class="_ _4"></span>lem by changing the client: client-based locking</span></div><div class="t m0 x2c h1b y311 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Solve the prob<span class="_ _4"></span>lem by changing the server<span class="_ _1"></span>, which additionally changes the client: </span></div><div class="t m0 x74 h14 y2ba ff8 fs3 fc2 sc0 ls0 ws0">server-based locking</div><div class="t m0 xd h11 y1528 ff1 fs7 fc2 sc0 ls0 ws0">T<span class="_ _0"></span>olerate the F<span class="_ _0"></span>ailur<span class="_ _4"></span>e</div><div class="t m0 xd h14 y2e7 ff8 fs3 fc2 sc0 ls0 ws625">Sometimes you can set things up such that the failure causes no harm. F<span class="_ _4"></span>or example, the</div><div class="t m0 xd h14 y43c ff8 fs3 fc2 sc0 ls11 ws518">abo<span class="_ _4"></span>ve client could catch the e<span class="_ _4"></span>xception and clean up. Frankl<span class="_ _4"></span>y<span class="_ _1"></span>, this is a bit slopp<span class="_ _4"></span>y<span class="_ _1"></span>. It’<span class="_ _2"></span>s rather</div><div class="t m0 xd h14 y959 ff8 fs3 fc2 sc0 ls0 ws0">like cleaning up memory leaks by rebooting at midnight. </div><div class="t m0 xd h11 y1436 ff1 fs7 fc2 sc0 ls0 ws0">Client-Based Locking</div><div class="t m0 xd h14 y3e7 ff8 fs3 fc2 sc0 ls0 ws7c2">T<span class="_ _0"></span>o make </div><div class="t m5 xcb h2f y3e7 ffb fs10 fc2 sc0 ls0 ws0">IntegerIterator</div><div class="t m0 x7d h14 y3e7 ff8 fs3 fc2 sc0 ls0 ws3c0"> w<span class="_ _4"></span>ork cor<span class="_ _8"></span>rectly with multiple threads, change this client (and</div><div class="t m0 xd h14 ybf8 ff8 fs3 fc2 sc0 ls0 ws0">e<span class="_ _4"></span>very other client) as follows:</div><div class="t m5 x74 h2f y1529 ffb fs10 fc2 sc0 ls0 ws0">IntegerIterator iterator = new IntegerIterator();</div><div class="t m5 x74 h2f y152a ffb fs10 fc2 sc0 ls1f ws236">    while (true) {</div><div class="t m5 x74 h2f y152b ffb fs10 fc2 sc0 ls0 ws0">      int nextValue;</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:223.728010px;width:100.355000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:153.728010px;width:111.011000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16a" class="pf w1 h2" data-page-no="16a"><div class="pc pc16a w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">331<span class="_ _10"></span><span class="ff1">Dependencies Between Methods Can Br<span class="_ _1"></span>eak Concurrent Code</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc2 sc0 ls0 ws0">      synchronized (iterator) {</div><div class="t m5 x74 h2f y627 ffb fs10 fc2 sc0 ls0 ws0">        if (!iterator.hasNext())</div><div class="t m5 x74 h2f y628 ffb fs10 fc2 sc0 ls0 ws0">          break;</div><div class="t m5 x74 h2f y629 ffb fs10 fc2 sc0 ls0 ws0">        nextValue = iterator.next();</div><div class="t m5 x74 h2f y62a ffb fs10 fc2 sc0 ls0 ws0">      }</div><div class="t m5 x74 h2f y62b ffb fs10 fc2 sc0 ls0 ws0">      doSometingWith(nextValue);</div><div class="t m5 x74 h2f y62c ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m0 xd h14 yb6b ff8 fs3 fc2 sc0 ls0 ws459">Each client introduces a lock via the </div><div class="t m5 x9c h2f yb6b ffb fs10 fc2 sc0 ls0 ws0">synchronized</div><div class="t m0 x4f h14 yb6b ff8 fs3 fc2 sc0 ls0 ws459"> keyw<span class="_ _1"></span>ord. <span class="_ _4"></span>This duplication violates the</div><div class="t m0 xd h14 y681 ff8 fs3 fc2 sc0 lsd ws62d">DR<span class="_ _2"></span>Y principle, but it might be necessar<span class="_ _8"></span>y if the code uses non-thread-safe third-par<span class="_ _8"></span>ty tools.</div><div class="t m0 x74 h14 y1dc ff8 fs3 fc2 sc0 ls0 ws294">This strategy is risk<span class="_ _4"></span>y because all programmers who use the server must remember to</div><div class="t m0 xd h14 y1dd ff8 fs3 fc2 sc0 ls0 ws7c3">lock it before using it and unlock it when done. Man<span class="_ _4"></span>y (man<span class="_ _4"></span>y!) years ago I w<span class="_ _4"></span>orked on a</div><div class="t m0 xd h14 y1de ff8 fs3 fc2 sc0 ls0 ws35c">system that emplo<span class="_ _4"></span>yed client-based locking on a shared resource. <span class="_ _1"></span>The resource was used in</div><div class="t m0 xd h14 y1df ff8 fs3 fc2 sc0 ls0 ws403">hundreds of dif<span class="_ _4"></span>ferent places throughout the code. One poor programmer forgot to lock the</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc2 sc0 ls0 ws0">resource in one of those places.</div><div class="t m0 x74 h14 y1a1 ff8 fs3 fc2 sc0 ls0 ws7c4">The system w<span class="_ _4"></span>as a multi-ter<span class="_ _8"></span>minal time-sharing system r<span class="_ _8"></span>unning accounting software</div><div class="t m0 xd h14 y1a2 ff8 fs3 fc2 sc0 ls12 ws56f">for Local 705 of the trucker’<span class="_ _2"></span>s union. <span class="_ _4"></span>The computer was in a raised-ﬂoor<span class="_ _1"></span>, en<span class="_ _4"></span>vironment-</div><div class="t m0 xd h14 y1bf ff8 fs3 fc2 sc0 ls0 ws7c3">con<span class="_ _8"></span>trolled room 50 miles north of the Local 705 headquar<span class="_ _8"></span>ters. <span class="_ _4"></span>At the headquar<span class="_ _8"></span>ters they</div><div class="t m0 xd h14 y1c0 ff8 fs3 fc2 sc0 ls0 ws7c5">had dozens of data entry clerks typing union dues postings into the ter<span class="_ _8"></span>minals. <span class="_ _4"></span>The ter<span class="_ _8"></span>mi-</div><div class="t m0 xd h14 y1c1 ff8 fs3 fc2 sc0 ls0 ws7ad">nals w<span class="_ _4"></span>ere connected to the computer using dedicated phone lines and 600bps half-duplex</div><div class="t m0 xd h14 y1c2 ff8 fs3 fc2 sc0 ls0 ws0">modems. (This w<span class="_ _4"></span>as a very<span class="_ _1"></span>, <span class="ffa">very</span> long time ago.)</div><div class="t m0 x74 h14 y152c ff8 fs3 fc2 sc0 ls0 ws22">About once per da<span class="_ _4"></span>y<span class="_ _1"></span>, one of the terminals would “lock up.<span class="_ _0"></span>” <span class="_ _4"></span>There was no rh<span class="_ _1"></span>yme or rea-</div><div class="t m0 xd h14 ybc8 ff8 fs3 fc2 sc0 ls0 ws4f5">son to it. <span class="_ _1"></span>The lock up show<span class="_ _1"></span>ed no preference for par<span class="_ _8"></span>ticular ter<span class="_ _8"></span>minals or par<span class="_ _8"></span>ticular times. It</div><div class="t m0 xd h14 y1c5 ff8 fs3 fc2 sc0 ls0 ws732">was as though there w<span class="_ _1"></span>ere someone rolling dice choosing the time and ter<span class="_ _8"></span>minal to lock up.</div><div class="t m0 xd h14 y1c6 ff8 fs3 fc2 sc0 ls0 ws318">Sometimes more than one terminal would lock up. Sometimes da<span class="_ _1"></span>ys would go b<span class="_ _4"></span>y without</div><div class="t m0 xd h14 y1c7 ff8 fs3 fc2 sc0 ls0 ws0">any lock-ups. </div><div class="t m0 x74 h14 y152d ff8 fs3 fc2 sc0 ls0 ws7c6">At ﬁrst the onl<span class="_ _4"></span>y solution was a reboot. But reboots w<span class="_ _4"></span>ere tough to coordinate. <span class="_ _4"></span>W<span class="_ _0"></span>e had</div><div class="t m0 xd h14 y1c9 ff8 fs3 fc2 sc0 ls0 ws13c">to call the headquarters and get everyone to ﬁnish w<span class="_ _4"></span>hat they w<span class="_ _4"></span>ere doing on all the termi-</div><div class="t m0 xd h14 y1ca ff8 fs3 fc2 sc0 ls0 ws56c">nals. <span class="_ _1"></span>Then we could shut do<span class="_ _1"></span>wn and restar<span class="_ _8"></span>t. If someone was doing something important</div><div class="t m0 xd h14 y1cb ff8 fs3 fc2 sc0 ls0 ws0">that took an hour or tw<span class="_ _4"></span>o, the locked up terminal simply had to sta<span class="_ _4"></span>y locked up. </div><div class="t m0 x74 h14 y152e ff8 fs3 fc2 sc0 lsd ws3e">After a fe<span class="_ _4"></span>w weeks of debugging w<span class="_ _1"></span>e found that the cause was a ring-buf<span class="_ _4"></span>fer counter that</div><div class="t m0 xd h14 y152f ff8 fs3 fc2 sc0 lsd ws444">had gotten out of sync with its pointer<span class="_ _1"></span>. <span class="_ _4"></span>This buffer controlled output to the terminal. <span class="_ _4"></span>The</div><div class="t m0 xd h14 y1530 ff8 fs3 fc2 sc0 lsd ws44f">pointer value indicated that the buf<span class="_ _1"></span>fer was empty<span class="_ _0"></span>, but the counter said it was full. Because</div><div class="t m0 xd h14 y111f ff8 fs3 fc2 sc0 lsd ws109">it was empty<span class="_ _0"></span>, there w<span class="_ _4"></span>as nothing to display; but because it w<span class="_ _1"></span>as also full, nothing could be</div><div class="t m0 xd h14 y210 ff8 fs3 fc2 sc0 lsd wsef">added to the buf<span class="_ _4"></span>fer to be display<span class="_ _4"></span>ed on the screen.</div><div class="t m0 x74 h14 y1249 ff8 fs3 fc2 sc0 lsd ws3cd">So w<span class="_ _4"></span>e knew w<span class="_ _4"></span>hy the terminals w<span class="_ _4"></span>ere locking, but w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t kno<span class="_ _4"></span>w wh<span class="_ _4"></span>y the ring buffer</div><div class="t m0 xd h14 y1442 ff8 fs3 fc2 sc0 ls0 wsd2">was getting out of sync. So w<span class="_ _1"></span>e added a hack to w<span class="_ _4"></span>ork around the problem. It w<span class="_ _4"></span>as possible to</div><div class="t m0 xd h14 y4b2 ff8 fs3 fc2 sc0 ls0 ws1e2">read the front panel switches on the computer<span class="_ _1"></span>. (This w<span class="_ _4"></span>as a very<span class="_ _1"></span>, very<span class="_ _1"></span>, <span class="ffa ws0">very</span><span class="ls48 ws6af"> long time ago.)</span></div><div class="t m0 xd h14 y4b3 ff8 fs3 fc2 sc0 ls0 ws33f">W<span class="_ _0"></span>e wrote a little trap function that detected when one of these s<span class="_ _4"></span>witches was thro<span class="_ _1"></span>wn and</div><div class="t m0 xd h14 y4b4 ff8 fs3 fc2 sc0 lsd ws2b8">then looked for a ring buf<span class="_ _4"></span>fer that was both empty and full. If one w<span class="_ _4"></span>as found<span class="_ _1"></span>, it reset that</div><div class="t m0 xd h14 y4b5 ff8 fs3 fc2 sc0 ls2b ws167">buffer to empty<span class="_ _0"></span>. <span class="_ _0"></span><span class="ffa ls0 ws0">V<span class="_ _2"></span>oila!<span class="ff8 lsc ws3f"> <span class="_ _4"></span>The locked-up terminal(s) star<span class="_ _8"></span>ted displaying again. </span></span></div><div class="t m0 x74 h14 y1f8 ff8 fs3 fc2 sc0 ls0 ws7c7">So no<span class="_ _4"></span>w w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve to reboot the system when a terminal locked up. <span class="_ _1"></span>The Local</div><div class="t m0 xd h14 y1f9 ff8 fs3 fc2 sc0 ls0 ws4f">w<span class="_ _4"></span>ould simply call us and tell us w<span class="_ _1"></span>e had a lock-up, and then we just w<span class="_ _4"></span>alked into the com-</div><div class="t m0 xd h14 y39a ff8 fs3 fc2 sc0 ls0 ws0">puter room and ﬂicked a s<span class="_ _4"></span>witch. </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16b" class="pf w1 h2" data-page-no="16b"><div class="pc pc16b w1 h2"><img class="bi x37 yf0b w8 h27" alt="" src="bg16b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">332<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls0 ws7a">Of course sometimes they w<span class="_ _1"></span>orked on the w<span class="_ _4"></span>eekends, and w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t. So we added a</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 lsd ws781">function to the scheduler that checked all the ring buf<span class="_ _4"></span>fers once per minute and reset any</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws5ff">that w<span class="_ _4"></span>ere both empty and full. <span class="_ _4"></span>This caused the displa<span class="_ _4"></span>ys to unclog before the Local could</div><div class="t m0 xd h14 y197 ff8 fs3 fc2 sc0 ls0 ws0">e<span class="_ _4"></span>ven get on the phone.</div><div class="t m0 x74 h14 y1bd ff8 fs3 fc2 sc0 ls11 ws225">It was se<span class="_ _1"></span>veral more w<span class="_ _4"></span>eeks of poring o<span class="_ _4"></span>ver page after page of monolithic assembl<span class="_ _4"></span>y lan-</div><div class="t m0 xd h14 y1be ff8 fs3 fc2 sc0 ls11 ws225">guage code before w<span class="_ _4"></span>e found the culprit. W<span class="_ _2"></span>e had done the math and calculated that the fre-</div><div class="t m0 xd h14 y19a ff8 fs3 fc2 sc0 lsd wsc5">quency of the lock-ups w<span class="_ _4"></span>as consistent with a single unprotected use of the ring buffer<span class="_ _1"></span>. So</div><div class="t m0 xd h14 y19b ff8 fs3 fc2 sc0 ls0 wsbe">all w<span class="_ _4"></span>e had to do was ﬁnd that one faulty usage. Unfortunately<span class="_ _0"></span>, this was so v<span class="_ _4"></span>er<span class="_ _8"></span>y long ago</div><div class="t m0 xd h14 y19c ff8 fs3 fc2 sc0 ls0 ws182">that w<span class="_ _4"></span>e didn’<span class="_ _4"></span>t ha<span class="_ _4"></span>ve search tools or cross references or an<span class="_ _4"></span>y other kind of automated help.</div><div class="t m0 xd h14 y19d ff8 fs3 fc2 sc0 ls0 ws0">W<span class="_ _0"></span>e simply had to pore o<span class="_ _1"></span>ver listings. </div><div class="t m0 x74 h14 y208 ff8 fs3 fc2 sc0 ls0 ws5ed">I learned an impor<span class="_ _8"></span>tant lesson that cold Chicago winter of 1971. Client-based locking</div><div class="t m0 xd h14 y21a ff8 fs3 fc2 sc0 ls0 ws0">really b<span class="_ _4"></span>lo<span class="_ _4"></span>ws.</div><div class="t m0 xd h11 y1531 ff1 fs7 fc2 sc0 ls0 ws0">Serv<span class="_ _4"></span>er<span class="_ _0"></span>-Based Locking</div><div class="t m0 xd h14 y1532 ff8 fs3 fc2 sc0 ls0 ws0">The duplication can be remo<span class="_ _4"></span>ved b<span class="_ _4"></span>y making the follo<span class="_ _4"></span>wing changes to </div><div class="t m5 x73 h2f y1532 ffb fs10 fc2 sc0 ls0 ws0">IntegerIterator</div><div class="t m0 x30 h14 y1532 ff8 fs3 fc2 sc0 ls0 ws0">:</div><div class="t m5 x74 h2f y1533 ffb fs10 fc2 sc0 ls0 ws0">public class IntegerIteratorServerLocked {</div><div class="t m5 x74 h2f y1534 ffb fs10 fc2 sc0 ls0 ws0">    private Integer nextValue = 0;</div><div class="t m5 x74 h2f y1535 ffb fs10 fc2 sc0 ls0 ws0">    public synchronized Integer getNextOrNull() {</div><div class="t m5 x74 h2f y1536 ffb fs10 fc2 sc0 ls0 ws0">        if (nextValue &lt; 100000)</div><div class="t m5 x74 h2f y1537 ffb fs10 fc2 sc0 ls0 ws0">            return nextValue++;</div><div class="t m5 x74 h2f y1538 ffb fs10 fc2 sc0 ls0 ws0">        else</div><div class="t m5 x74 h2f y1539 ffb fs10 fc2 sc0 ls0 ws0">            return null;</div><div class="t m5 x74 h2f y153a ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y153b ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y46a ff8 fs3 fc2 sc0 ls0 ws0">And the client code changes as w<span class="_ _4"></span>ell:</div><div class="t m5 x74 h2f yb7a ffb fs10 fc2 sc0 ls0 ws0">while (true) {</div><div class="t m5 x74 h2f yb7b ffb fs10 fc2 sc0 ls0 ws0">    Integer nextValue = iterator.getNextOrNull();</div><div class="t m5 x74 h2f yb7c ffb fs10 fc2 sc0 ls0 ws0">    if (next == null)</div><div class="t m5 x74 h2f yb7d ffb fs10 fc2 sc0 ls0 ws0">        break;</div><div class="t m5 x74 h2f yb7e ffb fs10 fc2 sc0 ls0 ws0">    // do something with nextValue</div><div class="t m5 x74 h2f y153c ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc2 sc0 ls0 ws277">In this case w<span class="_ _4"></span>e actually change the <span class="_ _1"></span>API of our class to be multithread a<span class="_ _4"></span>ware.</div><div class="t m0 x63 h21 y43b ff8 fsc fc2 sc0 ls0 ws0">3</div><div class="t m0 x93 h14 y2e5 ff8 fs3 fc2 sc0 ls0 ws31d"> The <span class="_ _8"></span>client</div><div class="t m0 xd h14 y2e6 ff8 fs3 fc2 sc0 ls0 ws0">needs to perform a </div><div class="t m5 x4d h2f yc1c ffb fs10 fc2 sc0 ls0 ws0">null</div><div class="t m0 x9e h14 yc1c ff8 fs3 fc2 sc0 ls0 ws0"> check instead of checking </div><div class="t m5 x4f h2f yc1c ffb fs10 fc2 sc0 ls0 ws0">hasNext()</div><div class="t m0 xc9 h14 yc1c ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m0 x74 h14 y8df ff8 fs3 fc2 sc0 ls0 ws0">In general you should prefer server<span class="_ _4"></span>-based locking for these reasons:</div><div class="t m0 x2c h1b y2ea ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">It reduces repeated code—Client-based locking forces each client to lock the server </span></div><div class="t m0 x74 h14 y2eb ff8 fs3 fc2 sc0 ls22 ws3df">properly<span class="_ _0"></span>. By putting the locking code into the server<span class="_ _4"></span>, clients are free to use the object </div><div class="t m0 x74 h14 y2ec ff8 fs3 fc2 sc0 ls0 ws0">and not w<span class="_ _4"></span>or<span class="_ _8"></span>r<span class="_ _8"></span>y about writing additional locking code.</div><div class="t m0 xd h25 y153d ff8 fse fc2 sc0 ls0 ws0">3.<span class="_ _17"> </span>In fact, the </div><div class="t m6 x5f h32 y153d ffb fs12 fc2 sc0 ls0 ws0">Iterator</div><div class="t m0 x6 h25 y153d ff8 fse fc2 sc0 ls0 ws0"> interface is inherently not thread-safe. It w<span class="_ _4"></span>as never designed to be used b<span class="_ _4"></span>y multiple threads, so this </div><div class="t m0 x3b h25 y153e ff8 fse fc2 sc0 ls0 ws0">should come as no surprise.</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:414.728010px;width:112.352000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16c" class="pf w1 h2" data-page-no="16c"><div class="pc pc16c w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">333<span class="_ _10"></span><span class="ff1 wse1">Incr<span class="_ _4"></span>easing Throughput</span></div><div class="t m0 x2c h1b y194 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">It allo<span class="_ _4"></span>ws for better performance—Y<span class="_ _2"></span>ou can sw<span class="_ _4"></span>ap out a thread-safe server for a non-</span></div><div class="t m0 x74 h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">thread safe one in the case of single-threaded deplo<span class="_ _4"></span>yment, thereb<span class="_ _4"></span>y av<span class="_ _4"></span>oiding all </div><div class="t m0 x74 h14 y196 ff8 fs3 fc2 sc0 ls0 ws0">o<span class="_ _4"></span>verhead.</div><div class="t m0 x2c h1b yd17 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws529">It reduces the possibility of er<span class="_ _8"></span>ror—All it takes is for one pro<span class="_ _4"></span>g<span class="_ _8"></span>rammer to forget to lock </span></div><div class="t m0 x74 h14 y14cc ff8 fs3 fc2 sc0 ls0 ws0">properly<span class="_ _0"></span>.</div><div class="t m0 x2c h1b y298 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">It enforces a single policy—The polic<span class="_ _4"></span>y is in one place, the ser<span class="_ _8"></span>ver<span class="_ _4"></span>, rather than man<span class="_ _4"></span>y </span></div><div class="t m0 x74 h14 y299 ff8 fs3 fc2 sc0 ls0 ws0">places, each client.</div><div class="t m0 x2c h1b y1dc ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">It reduces the scope of the shared v<span class="_ _4"></span>ariables—The client is not a<span class="_ _4"></span>ware of them or ho<span class="_ _1"></span>w </span></div><div class="t m0 x74 h14 y1dd ff8 fs3 fc2 sc0 ls0 ws0">they are locked. <span class="_ _0"></span>All of that is hidden in the ser<span class="_ _8"></span>ver<span class="_ _1"></span>. When things break, the number of </div><div class="t m0 x74 h14 y1de ff8 fs3 fc2 sc0 ls0 ws0">places to look is smaller<span class="_ _1"></span>.</div><div class="t m0 x74 h14 y209 ff8 fs3 fc2 sc0 ls0 ws0">What if you do not o<span class="_ _1"></span>wn the ser<span class="_ _8"></span>ver code?</div><div class="t m0 x2c h1b y3ed ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Use an A<span class="fsb">DAPTER</span> to change the <span class="_ _1"></span>API and add locking</span></div><div class="t m5 x74 h2f y3ee ffb fs10 fc2 sc0 ls0 ws0">public class ThreadSafeIntegerIterator {</div><div class="t m5 x74 h2f y3ef ffb fs10 fc2 sc0 ls0 ws0">    private IntegerIterator iterator = new IntegerIterator();</div><div class="t m5 x74 h2f y3f1 ffb fs10 fc2 sc0 ls0 ws0">    public synchronized Integer getNextOrNull() {</div><div class="t m5 x74 h2f y3f2 ffb fs10 fc2 sc0 ls0 ws0">        if(iterator.hasNext())</div><div class="t m5 x74 h2f y1469 ffb fs10 fc2 sc0 ls0 ws0">            return iterator.next();</div><div class="t m5 x74 h2f y153f ffb fs10 fc2 sc0 ls0 ws0">        return null;</div><div class="t m5 x74 h2f y1540 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y1541 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x2c h1b y3f6 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">OR better yet, use the thread-safe collections with e<span class="_ _4"></span>xtended interfaces</span></div><div class="t m0 xd h17 yf1 ff1 fs9 fc2 sc0 ls0 ws4db">Incr<span class="_ _4"></span>easing Thr<span class="_ _4"></span>oughput</div><div class="t m0 xd h14 y2b9 ff8 fs3 fc2 sc0 ls0 ws1f6">Let’<span class="_ _2"></span>s assume that w<span class="_ _4"></span>e want to go out on the net and read the contents of a set of pages from</div><div class="t m0 xd h14 y54f ff8 fs3 fc2 sc0 ls0 ws786">a list of URLs. <span class="_ _1"></span>As each page is read<span class="_ _4"></span>, w<span class="_ _4"></span>e will parse it to accumulate some statistics. Once</div><div class="t m0 xd h14 y550 ff8 fs3 fc2 sc0 ls0 ws0">all the pages are read<span class="_ _1"></span>, we will print a summary report.</div><div class="t m0 x74 h14 y227 ff8 fs3 fc2 sc0 ls0 ws0">The follo<span class="_ _4"></span>wing class returns the contents of one page, given a URL.</div><div class="t m5 x74 h2f y1542 ffb fs10 fc2 sc0 ls0 ws0">public class PageReader {</div><div class="t m5 x74 h2f y1543 ffb fs10 fc2 sc0 ls0 ws0">  //...</div><div class="t m5 x74 h2f y1544 ffb fs10 fc2 sc0 ls0 ws0">  public String getPageFor(String url) {</div><div class="t m5 x74 h2f y1545 ffb fs10 fc2 sc0 ls0 ws0">    HttpMethod method = new GetMethod(url);</div><div class="t m5 x74 h2f y1546 ffb fs10 fc2 sc0 ls0 ws0">    try {</div><div class="t m5 x74 h2f y1547 ffb fs10 fc2 sc0 ls0 ws0">      httpClient.executeMethod(method);</div><div class="t m5 x74 h2f y1548 ffb fs10 fc2 sc0 ls0 ws0">      String response = method.getResponseBodyAsString();</div><div class="t m5 x74 h2f y1549 ffb fs10 fc2 sc0 ls0 ws0">      return response;</div><div class="t m5 x74 h2f y154a ffb fs10 fc2 sc0 ls0 ws0">    } catch (Exception e) {</div><div class="t m5 x74 h2f y154b ffb fs10 fc2 sc0 ls0 ws0">      handle(e);</div><div class="t m5 x74 h2f y154c ffb fs10 fc2 sc0 ls0 ws0">    } finally {</div><div class="t m5 x74 h2f y154d ffb fs10 fc2 sc0 ls0 ws0">      method.releaseConnection();</div><div class="t m5 x74 h2f y154e ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y154f ffb fs10 fc2 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1550 ffb fs10 fc2 sc0 ls0 ws0">}</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:286.945010px;width:137.963000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16d" class="pf w1 h2" data-page-no="16d"><div class="pc pc16d w1 h2"><img class="bi x3b y384 w1d hc1" alt="" src="bg16d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">334<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc2 sc0 ls0 ws201">The next class is the iterator that pro<span class="_ _1"></span>vides the contents of the pages based on an iterator of</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">URLs:</div><div class="t m5 x74 h2f y431 ffb fs10 fc2 sc0 ls0 ws0">public class PageIterator {</div><div class="t m5 x74 h2f y432 ffb fs10 fc2 sc0 ls0 ws0">  private PageReader reader;</div><div class="t m5 x74 h2f y433 ffb fs10 fc2 sc0 ls0 ws0">  private URLIterator urls;</div><div class="t m5 x74 h2f yae2 ffb fs10 fc2 sc0 ls0 ws0">  public PageIterator(PageReader reader, URLIterator urls) {</div><div class="t m5 x74 h2f yae3 ffb fs10 fc2 sc0 ls0 ws0">    this.urls = urls;</div><div class="t m5 x74 h2f yae4 ffb fs10 fc2 sc0 ls0 ws0">    this.reader = reader;</div><div class="t m5 x74 h2f yae5 ffb fs10 fc2 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y112d ffb fs10 fc2 sc0 ls0 ws0">  public synchronized String getNextPageOrNull() {</div><div class="t m5 x74 h2f y112e ffb fs10 fc2 sc0 ls0 ws0">    if (urls.hasNext())</div><div class="t m5 x74 h2f y112f ffb fs10 fc2 sc0 ls0 ws0">      getPageFor(urls.next());</div><div class="t m5 x74 h2f y1130 ffb fs10 fc2 sc0 ls0 ws0">    else</div><div class="t m5 x74 h2f y1131 ffb fs10 fc2 sc0 ls0 ws0">      return null;</div><div class="t m5 x74 h2f y1132 ffb fs10 fc2 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1134 ffb fs10 fc2 sc0 ls0 ws0">  public String getPageFor(String url) {</div><div class="t m5 x74 h2f y1551 ffb fs10 fc2 sc0 ls0 ws0">    return reader.getPageFor(url);</div><div class="t m5 x74 h2f y1135 ffb fs10 fc2 sc0 ls0 ws0">  }</div><div class="t m5 x74 h2f y1136 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h14 y587 ff8 fs3 fc2 sc0 ls0 ws79e">An instance of the </div><div class="t m5 x9e h2f y587 ffb fs10 fc2 sc0 ls0 ws0">PageIterator</div><div class="t m0 x43 h14 y587 ff8 fs3 fc2 sc0 ls0 ws79e"> can be shared betw<span class="_ _4"></span>een many dif<span class="_ _4"></span>ferent threads, each</div><div class="t m0 xd h14 y588 ff8 fs3 fc2 sc0 ls0 ws7c8">one using it’<span class="_ _2"></span>s o<span class="_ _4"></span>wn instance of the </div><div class="t m5 xc h2f y588 ffb fs10 fc2 sc0 ls0 ws0">PageReader</div><div class="t m0 x78 h14 y588 ff8 fs3 fc2 sc0 ls0 ws7c8"> to read and parse the pages it gets from the</div><div class="t m0 xd h14 y578 ff8 fs3 fc2 sc0 ls0 ws0">iterator<span class="_ _1"></span>. </div><div class="t m0 x74 h14 yb05 ff8 fs3 fc2 sc0 ls0 ws63d">Notice that w<span class="_ _4"></span>e’<span class="_ _4"></span>ve kept the </div><div class="t m5 xf6 h2f yb05 ffb fs10 fc2 sc0 ls0 ws0">synchronized</div><div class="t m0 x67 h14 yb05 ff8 fs3 fc2 sc0 ls0 ws63d"> block v<span class="_ _4"></span>er<span class="_ _8"></span>y small. It contains just the critical</div><div class="t m0 xd h14 y94f ff8 fs3 fc2 sc0 ls0 ws15e">section deep inside the </div><div class="t m5 x2e h2f y94f ffb fs10 fc2 sc0 ls0 ws0">PageIterator</div><div class="t m0 xd1 h14 y94f ff8 fs3 fc2 sc0 ls0 ws15e">. It is al<span class="_ _4"></span>wa<span class="_ _1"></span>ys better to synchronize as little as possible</div><div class="t m0 xd h14 y950 ff8 fs3 fc2 sc0 ls0 ws0">as opposed to synchronizing as much as possible. </div><div class="t m0 xd h11 y7b8 ff1 fs7 fc2 sc0 ls0 ws0">Single-Thr<span class="_ _4"></span>ead Calculation of <span class="_ _1"></span>Thr<span class="_ _4"></span>oughput</div><div class="t m0 xd h14 y59f ff8 fs3 fc2 sc0 ls0 ws47c">No<span class="_ _4"></span>w lets do some simple calculations. F<span class="_ _4"></span>or the pur<span class="_ _8"></span>pose of argument, assume the follo<span class="_ _1"></span>wing:</div><div class="t m0 x2c h1b y1552 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">I/O time to retrie<span class="_ _4"></span>ve a page (a<span class="_ _4"></span>verage): 1 second</span></div><div class="t m0 x2c h1b y313 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Processing time to parse page (a<span class="_ _4"></span>verage): .5 seconds</span></div><div class="t m0 x2c h1b ydfb ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">I/O requires 0 percent of the CPU while processing requires 100 percent. </span></div><div class="t m0 x74 h14 y3fe ff8 fs3 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or <span class="_ _6"></span><span class="ffa">N</span><span class="ws6d8"> <span class="_ _1"></span> <span class="_ _1"></span>pages being processed by a single thread<span class="_ _0"></span>, the total ex<span class="_ _4"></span>ecution time is 1.5 sec-</span></div><div class="t m0 xd h14 y3ff ff8 fs3 fc2 sc0 ls0 ws0">onds * <span class="ffa">N<span class="_ _4"></span><span class="ff8">. Figure <span class="_ _1"></span>A-1 shows a snapshot of 13 pages or about 19.5 seconds.</span></span></div><div class="t m0 xe9 h1c y1553 ff1 fs3 fc2 sc0 ls0 ws1fc">Figur<span class="_ _4"></span>e A-1</div><div class="t m0 x31 h14 y1554 ff8 fs3 fc2 sc0 ls0 ws0">Single thread</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:279.728010px;width:212.936000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16e" class="pf w1 h2" data-page-no="16e"><div class="pc pc16e w1 h2"><img class="bi x3b y1555 w1d hc2" alt="" src="bg16e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">335<span class="_ _10"></span><span class="ff1">Deadlock</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc2 sc0 ls0 ws0">Multithr<span class="_ _4"></span>ead Calculation of <span class="_ _1"></span>Thr<span class="_ _4"></span>oughput</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc2 sc0 ls0 ws4f6">If it is possible to retrie<span class="_ _4"></span>ve pages in an<span class="_ _4"></span>y order and process the pages independently<span class="_ _0"></span>, then it</div><div class="t m0 xd h14 y272 ff8 fs3 fc2 sc0 ls0 ws23b">is possible to use multiple threads to increase throughput. <span class="_ _1"></span>What happens if we use three</div><div class="t m0 xd h14 y2a5 ff8 fs3 fc2 sc0 ls0 ws0">threads? Ho<span class="_ _4"></span>w many pages can w<span class="_ _1"></span>e acquire in the same time?</div><div class="t m0 x74 h14 y79d ff8 fs3 fc2 sc0 ls0 ws4a6">As you can see in F<span class="_ _4"></span>igure <span class="_ _1"></span>A-2, the multithreaded solution allows the process-bound</div><div class="t m0 xd h14 y79e ff8 fs3 fc2 sc0 ls0 ws709">parsing of the pages to o<span class="_ _4"></span>verlap with the I/O-bound reading of the pages. In an idealized</div><div class="t m0 xd h14 y2a8 ff8 fs3 fc2 sc0 ls0 ws670">w<span class="_ _4"></span>orld this means that the processor is fully utilized. Each one-second page read is o<span class="_ _1"></span>ver<span class="_ _4"></span>-</div><div class="t m0 xd h14 y2a9 ff8 fs3 fc2 sc0 ls0 ws729">lapped with tw<span class="_ _4"></span>o parses. <span class="_ _4"></span>Thus, w<span class="_ _4"></span>e can process tw<span class="_ _4"></span>o pages per second<span class="_ _1"></span>, which is three times</div><div class="t m0 xd h14 y2aa ff8 fs3 fc2 sc0 ls0 ws0">the throughput of the single-threaded solution. </div><div class="t m0 xd h17 y1556 ff1 fs9 fc2 sc0 ls0 ws0">Deadlock</div><div class="t m0 xd h14 y1557 ff8 fs3 fc2 sc0 ls0 ws0">Imagine a <span class="_ _4"></span>W<span class="_ _0"></span>eb application with two shared resource pools of some ﬁnite size:</div><div class="t m0 x2c h1b y1558 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">A pool of database connections for local w<span class="_ _4"></span>ork in process storage</span></div><div class="t m0 x2c h1b y1559 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">A pool of MQ connections to a master repository</span></div><div class="t m0 x74 h14 y155a ff8 fs3 fc2 sc0 ls0 ws0">Assume there are tw<span class="_ _4"></span>o operations in this application, create and update:</div><div class="t m0 x2c h1b y155b ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws7c9">Create—Acquire connection to master repository and database. <span class="_ _4"></span>T<span class="_ _1"></span>alk to ser<span class="_ _8"></span>vice master </span></div><div class="t m0 x74 h14 y155c ff8 fs3 fc2 sc0 ls0 ws0">repository and then store work in local w<span class="_ _1"></span>ork in process database.</div><div class="t m0 xe9 h1c y155d ff1 fs3 fc2 sc0 ls0 ws1fc">Figur<span class="_ _4"></span>e A-2</div><div class="t m0 x92 h14 y155e ff8 fs3 fc2 sc0 ls0 ws0">Three concur<span class="_ _8"></span>rent threads</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:202.256000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:206.488010px;width:55.999000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf16f" class="pf w1 h2" data-page-no="16f"><div class="pc pc16f w1 h2"><img class="bi x37 y155f w8 h27" alt="" src="bg16f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">336<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x2c h1b y194 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws7ca">Update—Acquire connection to database and then master repository<span class="_ _1"></span>. Read from w<span class="_ _4"></span>ork </span></div><div class="t m0 x74 h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">in process database and then send to the master repository</div><div class="t m0 x74 h14 ya7b ff8 fs3 fc2 sc0 ls0 ws46">What happens when there are more users than the pool sizes? Consider each pool has</div><div class="t m0 xd h14 ya7c ff8 fs3 fc2 sc0 ls0 ws0">a size of ten.</div><div class="t m0 x2c h1b y79d ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 wscd">T<span class="_ _0"></span>en users attempt to use create, so all ten database connections are acquired<span class="_ _1"></span>, and each </span></div><div class="t m0 x74 h14 y79e ff8 fs3 fc2 sc0 lsd ws7cb">thread is inter<span class="_ _8"></span>rupted after acquiring a database connection but before acquiring a con-</div><div class="t m0 x74 h14 y2a8 ff8 fs3 fc2 sc0 ls0 ws0">nection to the master repository<span class="_ _1"></span>.</div><div class="t m0 x2c h1b y39c ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws211">T<span class="_ _0"></span>en users attempt to use update, so all ten master repository connections are acquired<span class="_ _4"></span>, </span></div><div class="t m0 x74 h14 y39d ff8 fs3 fc2 sc0 lsd wsef">and each thread is inter<span class="_ _8"></span>rupted after acquiring the master repositor<span class="_ _8"></span>y but before acquir-</div><div class="t m0 x74 h14 y39e ff8 fs3 fc2 sc0 ls0 ws0">ing a database connection.</div><div class="t m0 x2c h1b y11be ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 lsd ws3ee">No<span class="_ _4"></span>w the ten “create” threads must wait to acquire a master repository connection, but </span></div><div class="t m0 x74 h14 yf40 ff8 fs3 fc2 sc0 ls0 ws0">the ten “update” threads must w<span class="_ _4"></span>ait to acquire a database connection.</div><div class="t m0 x2c h1b ye7d ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Deadlock. <span class="_ _1"></span>The system never reco<span class="_ _1"></span>vers.</span></div><div class="t m0 x74 h14 y1532 ff8 fs3 fc2 sc0 ls37 ws48f">This might sound like an unlikel<span class="_ _4"></span>y situation, but who w<span class="_ _4"></span>ants a system that freezes solid</div><div class="t m0 xd h14 y13d3 ff8 fs3 fc2 sc0 ls37 ws6aa">ev<span class="_ _4"></span>ery other week? <span class="_ _4"></span>Who wants to debug a system with symptoms that are so dif<span class="_ _4"></span>ﬁcult to</div><div class="t m0 xd h14 y5c0 ff8 fs3 fc2 sc0 ls37 ws0">reproduce? <span class="_ _1"></span>This is the kind of problem that happens in the ﬁeld<span class="_ _1"></span>, then takes w<span class="_ _4"></span>eeks to solve.</div><div class="t m0 x74 h14 y3a3 ff8 fs3 fc2 sc0 lsd wsc5">A typical “solution” is to introduce debugging statements to ﬁnd out what is happen-</div><div class="t m0 xd h14 y3a4 ff8 fs3 fc2 sc0 lsd ws6ef">ing. Of course, the debug statements change the code enough so that the deadlock happens</div><div class="t m0 xd h14 y6d4 ff8 fs3 fc2 sc0 lsc ws3f">in a different situation and tak<span class="_ _4"></span>es months to again occur<span class="_ _4"></span>.</div><div class="t m0 xb7 h21 ye6e ff8 fsc fc2 sc0 ls0 ws0">4</div><div class="t m0 x74 h14 y3a6 ff8 fs3 fc2 sc0 ls0 ws39d">T<span class="_ _0"></span>o really solve the prob<span class="_ _4"></span>lem of deadlock, w<span class="_ _4"></span>e need to understand what causes it. <span class="_ _1"></span>There</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc2 sc0 ls0 ws0">are four conditions required for deadlock to occur:</div><div class="t m0 x2c h1b y5c7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Mutual exclusion</span></div><div class="t m0 x2c h1b y48e ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Lock &amp; w<span class="_ _4"></span>ait</span></div><div class="t m0 x2c h1b y6d8 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">No preemption</span></div><div class="t m0 x2c h1b y5cc ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Circular w<span class="_ _4"></span>ait</span></div><div class="t m0 xd h11 y1560 ff1 fs7 fc2 sc0 ls0 ws0">Mutual Exclusion</div><div class="t m0 xd h14 y582 ff8 fs3 fc2 sc0 ls0 ws4d7">Mutual exclusion occurs w<span class="_ _4"></span>hen multiple threads need to use the same resources and those</div><div class="t m0 xd h14 y584 ff8 fs3 fc2 sc0 ls0 ws0">resources </div><div class="t m0 x2c h1b yeda ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Cannot be used b<span class="_ _4"></span>y multiple threads at the same time.</span></div><div class="t m0 x2c h1b y43e ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Are limited in number<span class="_ _1"></span>.</span></div><div class="t m0 xd h14 yb79 ff8 fs3 fc2 sc0 ls0 ws463">A common example of such a resource is a database connection, a ﬁle open for write, a</div><div class="t m0 xd h14 y60d ff8 fs3 fc2 sc0 ls0 ws0">record lock, or a semaphore. </div><div class="t m0 xd h25 y1561 ff8 fse fc2 sc0 ls13 ws162">4.<span class="_ _17"> </span>F<span class="_ _1"></span>or example, someone adds some debugging output and the problem “disappears.<span class="_ _1"></span>” The debugging code “ﬁx<span class="_ _4"></span>es” the problem </div><div class="t m0 x3b h25 y1562 ff8 fse fc2 sc0 ls0 ws0">so it remains in the system. </div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:209.728010px;width:91.019000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf170" class="pf w1 h2" data-page-no="170"><div class="pc pc170 w1 h2"><img class="bi xa4 y1563 w8 h66" alt="" src="bg170.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">337<span class="_ _10"></span><span class="ff1">Deadlock</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc2 sc0 ls0 ws0">Lock &amp; <span class="_ _0"></span>W<span class="_ _0"></span>ait</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc2 sc0 ls0 ws4b3">Once a thread acquires a resource, it will not release the resource until it has acquired all</div><div class="t m0 xd h14 y272 ff8 fs3 fc2 sc0 ls0 ws0">of the other resources it requires and has completed its w<span class="_ _4"></span>ork.</div><div class="t m0 xd h11 y24c ff1 fs7 fc2 sc0 ls0 ws0">No Pr<span class="_ _4"></span>eemption</div><div class="t m0 xd h14 y299 ff8 fs3 fc2 sc0 ls0 ws7cc">One thread cannot take resources a<span class="_ _1"></span>wa<span class="_ _4"></span>y from another thread. Once a thread holds a</div><div class="t m0 xd h14 y29a ff8 fs3 fc2 sc0 ls0 ws0">resource, the onl<span class="_ _4"></span>y wa<span class="_ _4"></span>y for another thread to get it is for the holding thread to release it.</div><div class="t m0 xd h11 y144f ff1 fs7 fc2 sc0 ls0 ws13">Cir<span class="_ _4"></span>cular W<span class="_ _0"></span>ait</div><div class="t m0 xd h14 y21a ff8 fs3 fc2 sc0 ls0 ws56b">This is also refer<span class="_ _8"></span>red to as the deadly embrace. Imagine tw<span class="_ _1"></span>o threads, <span class="_ _4"></span>T1 and <span class="_ _4"></span>T2, and tw<span class="_ _4"></span>o</div><div class="t m0 xd h14 y21b ff8 fs3 fc2 sc0 ls0 ws126">resources, R1 and R2. <span class="_ _1"></span>T1 has R1, <span class="_ _4"></span>T2 has R2. <span class="_ _4"></span>T1 also requires R2, and <span class="_ _4"></span>T2 also requires R1.</div><div class="t m0 xd h14 y21c ff8 fs3 fc2 sc0 ls0 ws0">This giv<span class="_ _4"></span>es something like F<span class="_ _4"></span>igure <span class="_ _4"></span>A-3:</div><div class="t m0 xd h14 y1564 ff8 fs3 fc2 sc0 ls0 ws39c">All four of these conditions must hold for deadlock to be possible. Break an<span class="_ _4"></span>y one of these</div><div class="t m0 xd h14 y1565 ff8 fs3 fc2 sc0 ls0 ws0">conditions and deadlock is not possible.</div><div class="t m0 xd h11 y1566 ff1 fs7 fc2 sc0 ls0 ws0">Br<span class="_ _4"></span>eaking Mutual Exclusion</div><div class="t m0 xd h14 y1567 ff8 fs3 fc2 sc0 ls0 ws7cd">One strategy for a<span class="_ _1"></span>voiding deadlock is to sidestep the mutual exclusion condition. <span class="_ _0"></span>Y<span class="_ _3"></span>ou</div><div class="t m0 xd h14 y1568 ff8 fs3 fc2 sc0 ls0 ws0">might be able to do this b<span class="_ _4"></span>y</div><div class="t m0 x2c h1b y1569 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Using resources that allo<span class="_ _4"></span>w simultaneous use, for example, </span></div><div class="t m5 xab h2f y1569 ffb fs10 fc2 sc0 ls0 ws0">AtomicInteger</div><div class="t m0 xf4 h14 y1569 ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m0 x2c h1b y156a ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Increasing the number of resources such that it equals or exceeds the number of com-</span></div><div class="t m0 x74 h14 y156b ff8 fs3 fc2 sc0 ls0 ws0">peting threads.</div><div class="t m0 x2c h1b y156c ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Checking that all your resources are free before seizing an<span class="_ _4"></span>y<span class="_ _0"></span>.</span></div><div class="t m0 x74 h14 y156d ff8 fs3 fc2 sc0 ls0 wsa9">Unfortunately<span class="_ _0"></span>, most resources are limited in number and don’<span class="_ _4"></span>t allo<span class="_ _4"></span>w simultaneous</div><div class="t m0 xd h14 y156e ff8 fs3 fc2 sc0 ls0 ws758">use. <span class="_ _1"></span>And it’<span class="_ _2"></span>s not uncommon for the identity of the second resource to be predicated on the</div><div class="t m0 xd h14 y156f ff8 fs3 fc2 sc0 ls0 ws0">results of operating on the ﬁrst. But don’<span class="_ _1"></span>t be discouraged; there are three conditions left.</div><div class="t m0 xe9 h1c y1570 ff1 fs3 fc2 sc0 ls0 ws1fc">Figur<span class="_ _4"></span>e A-3</div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:65.296000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:524.728010px;width:77.295000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:466.728010px;width:69.932000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:218.319010px;width:141.002000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf171" class="pf w1 h2" data-page-no="171"><div class="pc pc171 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">338<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 xd h11 y7a ff1 fs7 fc2 sc0 ls0 ws0">Br<span class="_ _4"></span>eaking Lock &amp; <span class="_ _1"></span>W<span class="_ _2"></span>ait</div><div class="t m0 xd h14 y2a4 ff8 fs3 fc2 sc0 ls0 ws2b">Y<span class="_ _3"></span>ou can also eliminate deadlock if you refuse to w<span class="_ _4"></span>ait. Check each resource before you</div><div class="t m0 xd h14 y272 ff8 fs3 fc2 sc0 lsd wsef">seize it, and release all resources and start o<span class="_ _4"></span>ver if you run into one that’<span class="_ _2"></span>s busy<span class="_ _0"></span>. </div><div class="t m0 x74 h14 yebe ff8 fs3 fc2 sc0 ls0 ws0">This approach introduces se<span class="_ _4"></span>veral potential problems:</div><div class="t m0 x2c h1b y2a7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3 ws7ce">Starvation—One thread keeps being unab<span class="_ _4"></span>le to acquire the resources it needs (ma<span class="_ _4"></span>ybe it </span></div><div class="t m0 x74 h14 y56e ff8 fs3 fc2 sc0 ls0 ws0">has a unique combination of resources that seldom all become a<span class="_ _4"></span>vailab<span class="_ _4"></span>le).</div><div class="t m0 x2c h1b y277 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Li<span class="_ _4"></span>velock—Sev<span class="_ _4"></span>eral threads might get into lockstep and all acquire one resource and </span></div><div class="t m0 x74 h14 y278 ff8 fs3 fc2 sc0 lsc ws7cf">then release one resource, o<span class="_ _4"></span>ver and o<span class="_ _1"></span>ver again. <span class="_ _1"></span>This is especially likel<span class="_ _4"></span>y with simplistic </div><div class="t m0 x74 h14 y279 ff8 fs3 fc2 sc0 ls0 ws0">CPU scheduling algorithms (think embedded devices or simplistic hand-written </div><div class="t m0 x74 h14 y386 ff8 fs3 fc2 sc0 ls0 ws0">thread balancing algorithms).</div><div class="t m0 x74 h14 y4dd ff8 fs3 fc2 sc0 ls0 ws7d0">Both of these can cause poor throughput. <span class="_ _1"></span>The ﬁrst results in low CPU utilization,</div><div class="t m0 xd h14 y3b1 ff8 fs3 fc2 sc0 ls0 ws0">whereas the second results in high and useless CPU utilization. </div><div class="t m0 x74 h14 y4df ff8 fs3 fc2 sc0 ls0 ws1e0">As inefﬁcient as this strate<span class="_ _4"></span>gy sounds, it’<span class="_ _2"></span>s better than nothing. It has the beneﬁt that it</div><div class="t m0 xd h14 y4e0 ff8 fs3 fc2 sc0 ls0 ws0">can almost al<span class="_ _4"></span>wa<span class="_ _1"></span>ys be implemented if all else f<span class="_ _8"></span>ails. </div><div class="t m0 xd h11 y13cd ff1 fs7 fc2 sc0 ls0 ws0">Br<span class="_ _4"></span>eaking Pr<span class="_ _4"></span>eemption</div><div class="t m0 xd h14 yd29 ff8 fs3 fc2 sc0 ls0 ws7bc">Another strategy for a<span class="_ _1"></span>voiding deadlock is to allo<span class="_ _4"></span>w threads to take resources a<span class="_ _4"></span>wa<span class="_ _1"></span>y from</div><div class="t m0 xd h14 yd2a ff8 fs3 fc2 sc0 ls0 ws789">other threads. <span class="_ _1"></span>This is usually done through a simple request mechanism. <span class="_ _4"></span>When a thread</div><div class="t m0 xd h14 ybfb ff8 fs3 fc2 sc0 lsd ws412">disco<span class="_ _4"></span>vers that a resource is busy<span class="_ _0"></span>, it asks the o<span class="_ _4"></span>wner to release it. If the o<span class="_ _4"></span>wner is also waiting</div><div class="t m0 xd h14 ybfc ff8 fs3 fc2 sc0 ls0 ws0">for some other resource, it releases them all and starts o<span class="_ _4"></span>ver<span class="_ _1"></span>. </div><div class="t m0 x74 h14 yddc ff8 fs3 fc2 sc0 lsd ws340">This is similar to the pre<span class="_ _4"></span>vious approach but has the beneﬁt that a thread is allow<span class="_ _1"></span>ed to</div><div class="t m0 xd h14 ybfe ff8 fs3 fc2 sc0 ls0 ws2f">w<span class="_ _4"></span>ait for a resource. <span class="_ _4"></span>This decreases the number of star<span class="_ _8"></span>to<span class="_ _4"></span>vers. Be w<span class="_ _4"></span>ar<span class="_ _8"></span>ned<span class="_ _1"></span>, how<span class="_ _1"></span>ever<span class="_ _1"></span>, that</div><div class="t m0 xd h14 y57e ff8 fs3 fc2 sc0 ls0 ws0">managing all those requests can be tricky<span class="_ _0"></span>. </div><div class="t m0 xd h11 y525 ff1 fs7 fc2 sc0 ls0 ws0">Br<span class="_ _4"></span>eaking Cir<span class="_ _4"></span>cular <span class="_ _1"></span>W<span class="_ _0"></span>ait</div><div class="t m0 xd h14 y5cd ff8 fs3 fc2 sc0 ls0 ws450">This is the most common approach to prev<span class="_ _4"></span>enting deadlock. F<span class="_ _4"></span>or most systems it requires</div><div class="t m0 xd h14 y2e5 ff8 fs3 fc2 sc0 ls0 ws0">no more than a simple con<span class="_ _4"></span>vention agreed to by all parties.</div><div class="t m0 x74 h14 y674 ff8 fs3 fc2 sc0 ls0 ws7d1">In the example abo<span class="_ _1"></span>ve with <span class="_ _1"></span>Thread 1 wanting both Resource 1 and Resource 2 and</div><div class="t m0 xd h14 y675 ff8 fs3 fc2 sc0 ls0 ws30c">Thread 2 w<span class="_ _4"></span>anting both Resource 2 and then Resource 1, simply forcing both <span class="_ _1"></span>Thread 1 and</div><div class="t m0 xd h14 y491 ff8 fs3 fc2 sc0 ls0 ws0">Thread 2 to allocate resources in the same order makes circular w<span class="_ _4"></span>ait impossible.</div><div class="t m0 x74 h14 y677 ff8 fs3 fc2 sc0 ls0 ws74c">More generall<span class="_ _4"></span>y<span class="_ _1"></span>, if all threads can ag<span class="_ _8"></span>ree on a global ordering of resources and if they</div><div class="t m0 xd h14 y678 ff8 fs3 fc2 sc0 ls0 ws28c">all allocate resources in that order<span class="_ _4"></span>, then deadlock is impossible. Lik<span class="_ _4"></span>e all the other strate-</div><div class="t m0 xd h14 y679 ff8 fs3 fc2 sc0 ls0 ws0">gies, this can cause problems:</div><div class="t m0 x2c h1b y2ee ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">The order of acquisition might not cor<span class="_ _8"></span>respond to the order of use; thus a resource </span></div><div class="t m0 x74 h14 y2ef ff8 fs3 fc2 sc0 ls0 ws0">acquired at the start might not be used until the end. <span class="_ _4"></span>This can cause resources to be </div><div class="t m0 x74 h14 ya5d ff8 fs3 fc2 sc0 ls0 ws0">locked longer than strictl<span class="_ _4"></span>y necessar<span class="_ _8"></span>y<span class="_ _0"></span>.</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:364.728010px;width:109.614000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:582.728010px;width:115.279000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:243.728010px;width:119.915000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf172" class="pf w1 h2" data-page-no="172"><div class="pc pc172 w1 h2"><img class="bi xd y3cd wc hc3" alt="" src="bg172.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">339<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>esting Multithreaded Code</span></div><div class="t m0 x2c h1b y194 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Sometimes you cannot impose an order on the acquisition of resources. If the ID of </span></div><div class="t m0 x74 h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">the second resource comes from an operation performed on the ﬁrst, then ordering is </div><div class="t m0 x74 h14 y196 ff8 fs3 fc2 sc0 ls0 ws0">not feasible.</div><div class="t m0 x74 h14 ya7c ff8 fs3 fc2 sc0 ls0 ws49e">So there are man<span class="_ _4"></span>y wa<span class="_ _4"></span>ys to a<span class="_ _4"></span>void deadlock. Some lead to starvation, w<span class="_ _4"></span>hereas others</div><div class="t m0 xd h14 ya7d ff8 fs3 fc2 sc0 ls0 ws0">make hea<span class="_ _4"></span>vy use of the CPU and reduce responsi<span class="_ _4"></span>veness. T<span class="_ _0"></span>ANST<span class="_ _0"></span>AAFL!</div><div class="t m0 xac h21 yebd ff8 fsc fc2 sc0 ls0 ws0">5</div><div class="t m0 x74 h14 y1da ff8 fs3 fc2 sc0 ls0 ws1ad">Isolating the thread-related part of your solution to allo<span class="_ _4"></span>w for tuning and experimenta-</div><div class="t m0 xd h14 y1db ff8 fs3 fc2 sc0 lsc ws3f">tion is a po<span class="_ _4"></span>w<span class="_ _4"></span>erful wa<span class="_ _4"></span>y to gain the insights needed to determine the best strategies.</div><div class="t m0 xd h17 y1571 ff1 fs9 fc2 sc0 ls0 ws0">T<span class="_ _2"></span>esting Multithr<span class="_ _4"></span>eaded Code</div><div class="t m0 xd h14 y253 ff8 fs3 fc2 sc0 ls0 ws0">Ho<span class="_ _4"></span>w can w<span class="_ _4"></span>e write a test to demonstrate the follo<span class="_ _4"></span>wing code is broken?</div><div class="t m5 x74 h2f y6f9 ffb fs10 fc2 sc0 ls0 ws0">01: public class ClassWithThreadingProblem {</div><div class="t m5 x74 h2f y1572 ffb fs10 fc2 sc0 ls0 ws0">02:    int nextId;</div><div class="t m5 x74 h2f y1573 ffb fs10 fc2 sc0 ls0 ws0">03:</div><div class="t m5 x74 h2f y1574 ffb fs10 fc2 sc0 ls0 ws0">04:    public int takeNextId() {</div><div class="t m5 x74 h2f y1575 ffb fs10 fc2 sc0 ls0 ws0">05:        return nextId++;</div><div class="t m5 x74 h2f y1576 ffb fs10 fc2 sc0 ls0 ws0">06:    }</div><div class="t m5 x74 h2f y1577 ffb fs10 fc2 sc0 ls0 ws0">07:}</div><div class="t m0 xd h14 y29d ff8 fs3 fc2 sc0 ls0 ws0">Here’<span class="_ _2"></span>s a description of a test that will pro<span class="_ _4"></span>ve the code is broken:</div><div class="t m0 x2c h1b y11c3 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Remember the cur<span class="_ _8"></span>rent value of </span></div><div class="t m5 x77 h2f y11c3 ffb fs10 fc2 sc0 ls0 ws0">nextId</div><div class="t m0 x4b h14 y11c3 ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m0 x2c h1b ybfb ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Create tw<span class="_ _4"></span>o threads, both of which call </span></div><div class="t m5 xc4 h2f ybfb ffb fs10 fc2 sc0 ls0 ws0">takeNextId()</div><div class="t m0 xe3 h14 ybfb ff8 fs3 fc2 sc0 ls0 ws0"> once.</div><div class="t m0 x2c h1b y3a7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">V<span class="_ _0"></span>erify that </span></div><div class="t m5 x39 h2f y3a7 ffb fs10 fc2 sc0 ls0 ws0">nextId</div><div class="t m0 xed h14 y3a7 ff8 fs3 fc2 sc0 ls0 ws0"> is tw<span class="_ _4"></span>o more than what w<span class="_ _1"></span>e star<span class="_ _8"></span>ted with.</div><div class="t m0 x2c h1b y2b7 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Run this until w<span class="_ _4"></span>e demonstrate that </span></div><div class="t m5 xe9 h2f y2b7 ffb fs10 fc2 sc0 ls0 ws0">nextId</div><div class="t m0 x1b h14 y2b7 ff8 fs3 fc2 sc0 ls0 ws0"> w<span class="_ _4"></span>as only incremented b<span class="_ _4"></span>y one instead </div><div class="t m0 x74 h14 y2b8 ff8 fs3 fc2 sc0 ls0 ws0">of tw<span class="_ _4"></span>o.</div><div class="t m0 x74 h14 y37a ff8 fs3 fc2 sc0 ls0 ws0">Listing <span class="_ _1"></span>A-2 shows such a test:</div><div class="t m0 xd h25 y302 ff8 fse fc2 sc0 ls0 ws0">5.<span class="_ _17"> </span>There ain’<span class="_ _1"></span>t no such thing as a free lunch.</div><div class="t m0 x74 h1c y671 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-2 </div><div class="t m0 x74 h36 y37d ffc fs3 fc2 sc0 ls0 ws0">ClassWithThreadingProblemTest.java</div><div class="t m5 x74 h2f y9ea ffb fs10 fc2 sc0 ls0 ws0">01: package example;</div><div class="t m5 x74 h2f y9eb ffb fs10 fc2 sc0 ls0 ws0">02: </div><div class="t m5 x74 h2f y1578 ffb fs10 fc2 sc0 ls0 ws0">03: import static org.junit.Assert.fail;</div><div class="t m5 x74 h2f y9ec ffb fs10 fc2 sc0 ls0 ws0">04: </div><div class="t m5 x74 h2f y9ed ffb fs10 fc2 sc0 ls0 ws0">05: import org.junit.Test;</div><div class="t m5 x74 h2f y9ee ffb fs10 fc2 sc0 ls0 ws0">06: </div><div class="t m5 x74 h2f y1579 ffb fs10 fc2 sc0 ls0 ws0">07: public class ClassWithThreadingProblemTest {</div><div class="t m5 x74 h2f y9ef ffb fs10 fc2 sc0 ls0 ws0">08:     @Test</div><div class="t m5 x74 h2f y9f0 ffb fs10 fc2 sc0 ls0 ws0">09:     public void twoThreadsShouldFailEventually() throws Exception {</div><div class="t m5 x74 h2f y9f1 ffb fs10 fc2 sc0 ls0 ws0">10:         final ClassWithThreadingProblem classWithThreadingProblem </div><div class="t m5 x74 h2f y9f2 ffb fs10 fc2 sc0 ls0 ws0">                = new ClassWithThreadingProblem();</div><div class="t m5 x74 h2f y157a ffb fs10 fc2 sc0 ls0 ws0">11: </div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:466.945010px;width:167.850000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf173" class="pf w1 h2" data-page-no="173"><div class="pc pc173 w1 h2"><img class="bi xd y26f wc hc4" alt="" src="bg173.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">340<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc2 sc0 ls0 ws0">12:         Runnable runnable = new Runnable() {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc2 sc0 ls0 ws0">13:             public void run() {</div><div class="t m5 x74 h2f y4bb ffb fs10 fc2 sc0 ls0 ws0">14:                 classWithThreadingProblem.takeNextId();</div><div class="t m5 x74 h2f y4bc ffb fs10 fc2 sc0 ls0 ws0">15:             }</div><div class="t m5 x74 h2f y522 ffb fs10 fc2 sc0 ls0 ws0">16:         };</div><div class="t m5 x74 h2f y4bd ffb fs10 fc2 sc0 ls0 ws0">17: </div><div class="t m5 x74 h2f y4be ffb fs10 fc2 sc0 ls0 ws0">18:         for (int i = 0; i &lt; 50000; ++i) {</div><div class="t m5 x74 h2f y4bf ffb fs10 fc2 sc0 ls0 ws0">19:             int startingId = classWithThreadingProblem.lastId;</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc2 sc0 ls0 ws0">20:             int expectedResult = 2 + startingId;</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc2 sc0 ls0 ws0">21: </div><div class="t m5 x74 h2f y4c2 ffb fs10 fc2 sc0 ls0 ws0">22:             Thread t1 = new Thread(runnable);</div><div class="t m5 x74 h2f y523 ffb fs10 fc2 sc0 ls0 ws0">23:             Thread t2 = new Thread(runnable);</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc2 sc0 ls0 ws0">24:             t1.start();</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc2 sc0 ls0 ws0">25:             t2.start();</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc2 sc0 ls0 ws0">26:             t1.join();</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc2 sc0 ls0 ws0">27:             t2.join();</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc2 sc0 ls0 ws0">28: </div><div class="t m5 x74 h2f y4c8 ffb fs10 fc2 sc0 ls0 ws0">29:             int endingId = classWithThreadingProblem.lastId;</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc2 sc0 ls0 ws0">30: </div><div class="t m5 x74 h2f y4ca ffb fs10 fc2 sc0 ls0 ws0">31:             if (endingId != expectedResult)</div><div class="t m5 x74 h2f y4cb ffb fs10 fc2 sc0 ls0 ws0">32:                 return;</div><div class="t m5 x74 h2f y5af ffb fs10 fc2 sc0 ls0 ws0">33:         }</div><div class="t m5 x74 h2f y4cc ffb fs10 fc2 sc0 ls0 ws0">34: </div><div class="t m5 x74 h2f y4cd ffb fs10 fc2 sc0 ls0 ws0">35:         fail(&quot;Should have exposed a threading issue but it did not.&quot;);</div><div class="t m5 x74 h2f y4ce ffb fs10 fc2 sc0 ls0 ws0">36:     }</div><div class="t m5 x74 h2f y4cf ffb fs10 fc2 sc0 ls0 ws0">37: }</div><div class="t m0 x47 h1c y157b ff1 fs3 fc2 sc0 ls0 ws0">Line<span class="_ _47"> </span>Description</div><div class="t m5 x47 h2f y157c ffb fs10 fc2 sc0 ls0 ws0">10</div><div class="t m0 x6d h14 y157d ff8 fs3 fc2 sc0 ls0 ws7d2">Create a single instance of </div><div class="t m5 x22 h2f y157d ffb fs10 fc2 sc0 ls0 ws0">ClassWithThreadingProblem</div><div class="t m0 x58 h14 y157d ff8 fs3 fc2 sc0 ls0 ws7d2">. Note, w<span class="_ _4"></span>e must use</div><div class="t m0 x6d h14 y157e ff8 fs3 fc2 sc0 ls0 ws0">the ﬁnal ke<span class="_ _4"></span>yword because w<span class="_ _1"></span>e use it below in an anon<span class="_ _4"></span>ymous inner class.</div><div class="t m5 x47 h2f y157f ffb fs10 fc2 sc0 ls0 ws0">12–16</div><div class="t m0 x6d h14 y1580 ff8 fs3 fc2 sc0 ls0 ws7d3">Create an anon<span class="_ _4"></span>ymous inner class that uses the single instance of</div><div class="t m5 x6d h2f y1581 ffb fs10 fc2 sc0 ls0 ws0">ClassWithThreadingProblem</div><div class="t m0 xe0 h14 y1581 ff8 fs3 fc2 sc0 ls0 ws0">.</div><div class="t m5 x47 h2f y1582 ffb fs10 fc2 sc0 ls0 ws0">18</div><div class="t m0 x6d h14 y1583 ff8 fs3 fc2 sc0 lsd ws633">Run this code “enough” times to demonstrate that the code failed<span class="_ _1"></span>, but not</div><div class="t m0 x6d h14 y1584 ff8 fs3 fc2 sc0 ls0 ws26e">so much that the test “takes too long.<span class="_ _0"></span>” <span class="_ _4"></span>This is a balancing act; we don’<span class="_ _1"></span>t</div><div class="t m0 x6d h14 y1585 ff8 fs3 fc2 sc0 ls0 ws6af">w<span class="_ _4"></span>ant to wait too long to demonstrate failure. Picking this number is hard—</div><div class="t m0 x6d h14 y1586 ff8 fs3 fc2 sc0 ls0 ws0">although later w<span class="_ _4"></span>e’<span class="_ _4"></span>ll see that we can greatl<span class="_ _4"></span>y reduce this number<span class="_ _4"></span>.</div><div class="t m5 x47 h2f y1587 ffb fs10 fc2 sc0 ls0 ws0">19</div><div class="t m0 x6d h14 y1588 ff8 fs3 fc2 sc0 ls0 ws460">Remember the starting value. <span class="_ _1"></span>This test is tr<span class="_ _8"></span>ying to pro<span class="_ _4"></span>ve that the code in</div><div class="t m5 x6d h2f y1589 ffb fs10 fc2 sc0 ls0 ws0">ClassWithThreadingProblem</div><div class="t m0 xe0 h14 y1589 ff8 fs3 fc2 sc0 ls0 ws27b"> is broken. If this test passes, it pro<span class="_ _1"></span>ved that the</div><div class="t m0 x6d h14 y158a ff8 fs3 fc2 sc0 ls0 ws133">code w<span class="_ _4"></span>as broken. If this test fails, the test was unab<span class="_ _4"></span>le to pro<span class="_ _4"></span>ve that the code</div><div class="t m0 x6d h14 y158b ff8 fs3 fc2 sc0 ls0 ws0">is broken.</div><div class="t m5 x47 h2f y158c ffb fs10 fc2 sc0 ls0 ws0">20</div><div class="t m0 x6d h14 y158d ff8 fs3 fc2 sc0 ls0 ws0">W<span class="_ _0"></span>e expect the ﬁnal v<span class="_ _4"></span>alue to be tw<span class="_ _4"></span>o more than the cur<span class="_ _8"></span>rent value.</div><div class="t m5 x47 h2f y158e ffb fs10 fc2 sc0 ls0 ws0">22–23</div><div class="t m0 x6d h14 y158f ff8 fs3 fc2 sc0 ls0 ws199">Create tw<span class="_ _4"></span>o threads, both of which use the object w<span class="_ _1"></span>e created in lines 12–16.</div><div class="t m0 x6d h14 y1590 ff8 fs3 fc2 sc0 ls0 ws2ec">This giv<span class="_ _4"></span>es us the potential of tw<span class="_ _4"></span>o threads tr<span class="_ _8"></span>ying to use our single instance</div><div class="t m0 x6d h14 y1591 ff8 fs3 fc2 sc0 ls0 ws0">of </div><div class="t m5 x24 h2f y1591 ffb fs10 fc2 sc0 ls0 ws0">ClassWithThreadingProblem</div><div class="t m0 xc4 h14 y1591 ff8 fs3 fc2 sc0 ls0 ws0"> and interfering with each other<span class="_ _1"></span>.</div><div class="t m0 x74 h1c y93a ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-2 <span class="_ _6"></span>(contin<span class="_ _4"></span>ued)</div><div class="t m0 x74 h36 y1499 ffc fs3 fc2 sc0 ls0 ws0">ClassWithThreadingProblemTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf174" class="pf w1 h2" data-page-no="174"><div class="pc pc174 w1 h2"><img class="bi xd y1592 w5 hc5" alt="" src="bg174.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">341<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>esting Multithreaded Code</span></div><div class="t m0 x74 h14 y21b ff8 fs3 fc2 sc0 ls0 ws7d4">This test certainly sets up the conditions for a concur<span class="_ _8"></span>rent update problem. Ho<span class="_ _1"></span>we<span class="_ _4"></span>ver<span class="_ _1"></span>,</div><div class="t m0 xd h14 y21c ff8 fs3 fc2 sc0 ls0 ws0">the problem occurs so infrequentl<span class="_ _4"></span>y that the v<span class="_ _4"></span>ast majority of times this test won’<span class="_ _1"></span>t detect it.</div><div class="t m0 x74 h14 y20c ff8 fs3 fc2 sc0 ls0 ws518">Indeed<span class="_ _1"></span>, to tr<span class="_ _8"></span>uly detect the prob<span class="_ _4"></span>lem w<span class="_ _4"></span>e need to set the number of iterations to o<span class="_ _4"></span>ver one</div><div class="t m0 xd h14 y21d ff8 fs3 fc2 sc0 ls0 ws14b">million. Even then, in ten e<span class="_ _4"></span>xecutions with a loop count of 1,000,000, the prob<span class="_ _4"></span>lem occur<span class="_ _8"></span>red</div><div class="t m0 xd h14 y21e ff8 fs3 fc2 sc0 ls0 ws432">only once. <span class="_ _1"></span>That means w<span class="_ _4"></span>e probabl<span class="_ _4"></span>y ought to set the iteration count to w<span class="_ _4"></span>ell o<span class="_ _4"></span>ver one hun-</div><div class="t m0 xd h14 y21f ff8 fs3 fc2 sc0 ls0 ws0">dred million to get reliable failures. Ho<span class="_ _1"></span>w long are we prepared to w<span class="_ _4"></span>ait?</div><div class="t m0 x74 h14 y54c ff8 fs3 fc2 sc0 ls0 ws443">Even if w<span class="_ _1"></span>e tuned the test to get reliable failures on one machine, we’<span class="_ _1"></span>ll probabl<span class="_ _4"></span>y hav<span class="_ _4"></span>e</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc2 sc0 ls0 ws53d">to retune the test with different v<span class="_ _1"></span>alues to demonstrate the f<span class="_ _8"></span>ailure on another machine,</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc2 sc0 ls0 ws0">operating system, or version of the JVM. </div><div class="t m0 x74 h14 y1e6 ff8 fs3 fc2 sc0 ls0 ws7d5">And this is a <span class="ffa ws0">simple</span> problem. If w<span class="_ _1"></span>e cannot demonstrate broken code easily with this</div><div class="t m0 xd h14 y1e7 ff8 fs3 fc2 sc0 ls0 ws0">problem, ho<span class="_ _1"></span>w will we e<span class="_ _4"></span>ver detect truly comple<span class="_ _4"></span>x problems?</div><div class="t m0 x74 h14 y1c8 ff8 fs3 fc2 sc0 ls0 ws350">So what approaches can w<span class="_ _1"></span>e take to demonstrate this simple failure? <span class="_ _4"></span>And<span class="_ _1"></span>, more impor-</div><div class="t m0 xd h14 y20d ff8 fs3 fc2 sc0 ls0 wsda">tantly<span class="_ _0"></span>, ho<span class="_ _1"></span>w can we write tests that will demonstrate failures in more complex code? Ho<span class="_ _1"></span>w</div><div class="t m0 xd h14 y20e ff8 fs3 fc2 sc0 ls0 ws0">will w<span class="_ _4"></span>e be able to disco<span class="_ _1"></span>ver if our code has failures when w<span class="_ _4"></span>e do not kno<span class="_ _4"></span>w where to look?</div><div class="t m0 x74 h14 y1cb ff8 fs3 fc2 sc0 ls0 ws0">Here are a few ideas:</div><div class="t m0 x2c h1b ydf9 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="fs3 ws7d6">Monte Carlo <span class="_ _1"></span>T<span class="_ _0"></span>esting.<span class="ff8"> Make tests ﬂe<span class="_ _4"></span>xible, so they can be tuned. <span class="_ _1"></span>Then run the test o<span class="_ _4"></span>ver </span></span></div><div class="t m0 x74 h14 ydfa ff8 fs3 fc2 sc0 ls0 ws19c">and o<span class="_ _4"></span>ver—sa<span class="_ _1"></span>y on a test ser<span class="_ _8"></span>ver—randomly changing the tuning v<span class="_ _4"></span>alues. If the tests e<span class="_ _4"></span>ver </div><div class="t m0 x74 h14 ydfb ff8 fs3 fc2 sc0 ls0 ws0">fail, the code is broken. Make sure to start writing those tests early so a continuous </div><div class="t m0 x74 h14 yb77 ff8 fs3 fc2 sc0 ls0 ws0">integration server star<span class="_ _8"></span>ts running them soon. By the wa<span class="_ _4"></span>y<span class="_ _0"></span>, make sure you carefull<span class="_ _4"></span>y log </div><div class="t m0 x74 h14 y739 ff8 fs3 fc2 sc0 ls0 ws0">the conditions under which the test failed.</div><div class="t m0 x2c h1b y400 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Run the test on e<span class="_ _4"></span>very one of the target deplo<span class="_ _4"></span>yment platforms. Repeatedly<span class="_ _0"></span>. Continu-</span></div><div class="t m0 x74 h14 y397 ff8 fs3 fc2 sc0 ls0 ws0">ously<span class="_ _0"></span>. <span class="_ _1"></span>The longer the tests r<span class="_ _8"></span>un without failure, the more likely that</div><div class="t m0 x74 h14 y3e7 ff8 fs3 fc2 sc0 ls0 ws0">–<span class="_ _48"> </span>The production code is cor<span class="_ _8"></span>rect or</div><div class="t m0 x74 h14 y3e8 ff8 fs3 fc2 sc0 ls0 ws0">–<span class="_ _48"> </span>The tests aren’<span class="_ _1"></span>t adequate to expose problems.</div><div class="t m0 x2c h1b y43f ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Run the tests on a machine with v<span class="_ _4"></span>ar<span class="_ _8"></span>ying loads. If you can simulate loads close to a </span></div><div class="t m0 x74 h14 y440 ff8 fs3 fc2 sc0 ls0 ws0">production en<span class="_ _4"></span>vironment, do so.</div><div class="t m5 x47 h2f y1593 ffb fs10 fc2 sc0 ls0 ws0">24–25</div><div class="t m0 x6d h14 y1594 ff8 fs3 fc2 sc0 ls0 ws0">Make our tw<span class="_ _1"></span>o threads eligible to run.</div><div class="t m5 x47 h2f y1595 ffb fs10 fc2 sc0 ls0 ws0">26–27</div><div class="t m0 x6d h14 y1596 ff8 fs3 fc2 sc0 ls0 ws0">W<span class="_ _0"></span>ait for both threads to ﬁnish before we check the results.</div><div class="t m5 x47 h2f y1597 ffb fs10 fc2 sc0 ls0 ws0">29</div><div class="t m0 x6d h14 y1598 ff8 fs3 fc2 sc0 ls0 ws0">Record the actual ﬁnal v<span class="_ _4"></span>alue.</div><div class="t m5 x47 h2f y1599 ffb fs10 fc2 sc0 ls0 ws0">31–32</div><div class="t m0 x6d h14 y159a ff8 fs3 fc2 sc0 ls0 ws1e2">Did our </div><div class="t m5 xc6 h2f y159a ffb fs10 fc2 sc0 ls0 ws0">endingId</div><div class="t m0 x8f h14 y159a ff8 fs3 fc2 sc0 ls11 ws24c"> differ from w<span class="_ _4"></span>hat w<span class="_ _4"></span>e expected? If so, return end the test—</div><div class="t m0 x6d h14 y159b ff8 fs3 fc2 sc0 lsc ws3f">w<span class="_ _4"></span>e’<span class="_ _4"></span>ve pro<span class="_ _1"></span>ven that the code is broken. If not, try again.</div><div class="t m5 x47 h2f y159c ffb fs10 fc2 sc0 ls0 ws0">35</div><div class="t m0 x6d h14 y159d ff8 fs3 fc2 sc0 ls0 ws6ad">If w<span class="_ _4"></span>e got to here, our test was unab<span class="_ _4"></span>le to pro<span class="_ _4"></span>ve the production code w<span class="_ _4"></span>as bro-</div><div class="t m0 x6d h14 y159e ff8 fs3 fc2 sc0 ls0 ws12c">ken in a “reasonab<span class="_ _4"></span>le” amount of time; our code has failed. Either the code</div><div class="t m0 x6d h14 y159f ff8 fs3 fc2 sc0 ls0 ws15e">is not broken or w<span class="_ _4"></span>e didn’<span class="_ _1"></span>t r<span class="_ _8"></span>un enough iterations to get the f<span class="_ _8"></span>ailure condition</div><div class="t m0 x6d h14 y15a0 ff8 fs3 fc2 sc0 ls0 ws0">to occur<span class="_ _1"></span>.</div><div class="t m0 x47 h1c y15a1 ff1 fs3 fc2 sc0 ls0 ws0">Line<span class="_ _47"> </span>Description</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf175" class="pf w1 h2" data-page-no="175"><div class="pc pc175 w1 h2"><img class="bi x37 y15a2 w8 h27" alt="" src="bg175.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">342<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 x74 h14 y194 ff8 fs3 fc2 sc0 ls0 ws83">Y<span class="_ _3"></span>et, even if y<span class="_ _4"></span>ou do all of these things, you still don’<span class="_ _1"></span>t stand a very good chance of ﬁnd-</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws7d7">ing threading problems with y<span class="_ _4"></span>our code. <span class="_ _4"></span>The most insidious problems are the ones that</div><div class="t m0 xd h14 y196 ff8 fs3 fc2 sc0 ls0 ws1f4">ha<span class="_ _4"></span>ve such a small cross section that they onl<span class="_ _4"></span>y occur once in a billion opportunities. Such</div><div class="t m0 xd h14 y197 ff8 fs3 fc2 sc0 ls0 ws0">problems are the terror of complex systems. </div><div class="t m0 xd h17 yc56 ff1 fs9 fc2 sc0 ls0 ws0">T<span class="_ _2"></span>ool Suppor<span class="_ _8"></span>t f<span class="_ _4"></span>or <span class="_ _1"></span>T<span class="_ _2"></span>esting <span class="_ _1"></span>Thr<span class="_ _4"></span>ead-Based Code</div><div class="t m0 xd h14 y29a ff8 fs3 fc2 sc0 ls0 ws4b3">IBM has created a tool called ConT<span class="_ _0"></span>est.</div><div class="t m0 xe9 h21 y5da ff8 fsc fc2 sc0 ls0 ws0">6</div><div class="t m0 x83 h14 y29a ff8 fs3 fc2 sc0 ls0 ws4b3"> It instruments classes to make it more likely that</div><div class="t m0 xd h14 y29b ff8 fs3 fc2 sc0 ls0 ws0">non-thread-safe code fails.</div><div class="t m0 x74 h14 y385 ff8 fs3 fc2 sc0 ls0 ws415">W<span class="_ _0"></span>e do not ha<span class="_ _4"></span>ve an<span class="_ _4"></span>y direct relationship with IBM or the team that dev<span class="_ _4"></span>eloped ConT<span class="_ _0"></span>est.</div><div class="t m0 xd h14 y3b6 ff8 fs3 fc2 sc0 ls0 ws2a6">A colleague of ours pointed us to it. <span class="_ _4"></span>W<span class="_ _0"></span>e noticed vast impro<span class="_ _1"></span>vement in our ability to ﬁnd</div><div class="t m0 xd h14 y3b7 ff8 fs3 fc2 sc0 ls0 ws0">threading issues after a fe<span class="_ _4"></span>w minutes of using it.</div><div class="t m0 x74 h14 ydf3 ff8 fs3 fc2 sc0 ls0 ws0">Here’<span class="_ _2"></span>s an outline of ho<span class="_ _4"></span>w to use ConT<span class="_ _0"></span>est:</div><div class="t m0 x2c h1b y538 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Write tests and production code, making sure there are tests speciﬁcally designed to </span></div><div class="t m0 x74 h14 y464 ff8 fs3 fc2 sc0 ls0 ws0">simulate multiple users under v<span class="_ _4"></span>ar<span class="_ _8"></span>ying loads, as mentioned abo<span class="_ _4"></span>ve.</div><div class="t m0 x2c h1b y40e ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Instrument test and production code with ConT<span class="_ _0"></span>est.</span></div><div class="t m0 x2c h1b y2c2 ff1 fs2 fc2 sc0 ls0 ws0">•<span class="_ _17"> </span><span class="ff8 fs3">Run the tests.</span></div><div class="t m0 x74 h14 y2db ff8 fs3 fc2 sc0 ls3d ws230">When w<span class="_ _4"></span>e instr<span class="_ _8"></span>umented code with ConT<span class="_ _0"></span>est, our success rate w<span class="_ _4"></span>ent from roughly one fail-</div><div class="t m0 xd h14 y3a5 ff8 fs3 fc2 sc0 ls3d ws24c">ure in ten million iterations to roughl<span class="_ _4"></span>y one f<span class="_ _8"></span>ailure in <span class="ffa ws0">thirty</span><span class="ws46b"> iterations. Here are the loop v<span class="_ _4"></span>alues</span></div><div class="t m0 xd h14 y3a6 ff8 fs3 fc2 sc0 ls3d ws6f6">for se<span class="_ _4"></span>veral runs of the test after instr<span class="_ _8"></span>umentation: 13, 23, 0, 54, 16, 14, 6, 69, 107, 49, 2. So</div><div class="t m0 xd h14 y3a7 ff8 fs3 fc2 sc0 ls3d ws0">clearl<span class="_ _4"></span>y the instr<span class="_ _8"></span>umented classes failed much earlier and with much g<span class="_ _8"></span>reater reliability<span class="_ _1"></span>. </div><div class="t m0 xd h17 y15a3 ff1 fs9 fc2 sc0 ls0 ws0">Conclusion</div><div class="t m0 xd h14 y15a4 ff8 fs3 fc2 sc0 ls0 ws7d8">This chapter has been a very brief sojourn through the large and treacherous ter<span class="_ _8"></span>ritor<span class="_ _8"></span>y of</div><div class="t m0 xd h14 y81b ff8 fs3 fc2 sc0 ls0 ws384">concur<span class="_ _8"></span>rent programming. <span class="_ _4"></span>W<span class="_ _0"></span>e barely scratched the surface. Our emphasis here w<span class="_ _4"></span>as on dis-</div><div class="t m0 xd h14 y419 ff8 fs3 fc2 sc0 lsd ws6e0">ciplines to help keep concurrent code clean, but there is much more you should learn if</div><div class="t m0 xd h14 y81c ff8 fs3 fc2 sc0 ls0 ws6b">you are going to be writing concurrent systems. W<span class="_ _2"></span>e recommend you start with Doug Lea’<span class="_ _2"></span>s</div><div class="t m0 xd h14 y393 ff8 fs3 fc2 sc0 ls0 ws0">w<span class="_ _4"></span>onderful book <span class="ffa">Concurr<span class="_ _4"></span>ent Pr<span class="_ _4"></span>ogr<span class="_ _1"></span>amming in Java: Design Principles and P<span class="_ _0"></span>atterns.</span></div><div class="t m0 xa8 h21 y2cd ff8 fsc fc2 sc0 ls0 ws0">7</div><div class="t m0 x74 h14 y3fe ff8 fs3 fc2 sc0 ls0 ws58c">In this chapter w<span class="_ _4"></span>e talked about concur<span class="_ _8"></span>rent update, and the disciplines of clean syn-</div><div class="t m0 xd h14 y3ff ff8 fs3 fc2 sc0 ls0 ws391">chronization and locking that can pre<span class="_ _4"></span>vent it. <span class="_ _4"></span>W<span class="_ _0"></span>e talked about ho<span class="_ _4"></span>w threads can enhance the</div><div class="t m0 xd h14 y400 ff8 fs3 fc2 sc0 ls0 ws754">throughput of an I/O-bound system and sho<span class="_ _4"></span>w<span class="_ _4"></span>ed the clean techniques for achieving such</div><div class="t m0 xd h14 y397 ff8 fs3 fc2 sc0 ls0 ws69">impro<span class="_ _4"></span>vements. <span class="_ _4"></span>W<span class="_ _0"></span>e talked about deadlock and the disciplines for pre<span class="_ _4"></span>venting it in a clean</div><div class="t m0 xd h25 y15a5 ff8 fse fc2 sc0 ls0 ws0">6.<span class="_ _17"> </span>http://www<span class="_ _0"></span>.haif<span class="_ _8"></span>a.ibm.com/projects/veriﬁcation/contest/index.html</div><div class="t m0 xd h25 y15a6 ff8 fse fc2 sc0 ls0 ws0">7.<span class="_ _17"> </span>See [Lea99] p. 191.</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:514.945010px;width:266.976000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:270.945010px;width:66.905000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.haifa.ibm.com/projects/verification/contest/index.html"><div class="d m1" style="border-style:none;position:absolute;left:90.830700px;bottom:93.000110px;width:185.114300px;height:7.657900px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf176" class="pf w1 h2" data-page-no="176"><div class="pc pc176 w1 h2"><img class="bi xd ybda wc h2c" alt="" src="bg176.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">343<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>utorial: Full Code Examples</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc2 sc0 ls10 ws3a">wa<span class="_ _1"></span>y<span class="_ _1"></span>. Finall<span class="_ _4"></span>y<span class="_ _0"></span>, we talk<span class="_ _4"></span>ed about strategies for exposing concurrent problems b<span class="_ _4"></span>y instr<span class="_ _8"></span>umenting</div><div class="t m0 xd h14 y195 ff8 fs3 fc2 sc0 ls0 ws0">your code.</div><div class="t m0 xd h17 y297 ff1 fs9 fc2 sc0 ls0 ws0">T<span class="_ _2"></span>utorial:<span class="_ _4"></span> Full Code Examples</div><div class="t m0 xd h11 ydfd ff1 fs7 fc2 sc0 ls0 ws0">Client/Serv<span class="_ _4"></span>er Nonthr<span class="_ _4"></span>eaded    </div><div class="t m0 x74 h1c y12d7 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-3 </div><div class="t m0 x74 h36 y15a7 ffc fs3 fc2 sc0 ls0 ws0">Server.java</div><div class="t m5 x74 h2f y604 ffb fs10 fc2 sc0 ls0 ws0">package com.objectmentor.clientserver.nonthreaded;</div><div class="t m5 x74 h2f y15a8 ffb fs10 fc2 sc0 ls0 ws0">import java.io.IOException;</div><div class="t m5 x74 h2f y15a9 ffb fs10 fc2 sc0 ls0 ws0">import java.net.ServerSocket;</div><div class="t m5 x74 h2f y15aa ffb fs10 fc2 sc0 ls0 ws0">import java.net.Socket;</div><div class="t m5 x74 h2f y15ab ffb fs10 fc2 sc0 ls0 ws0">import java.net.SocketException;</div><div class="t m5 x74 h2f y15ac ffb fs10 fc2 sc0 ls0 ws0">import common.MessageUtils;</div><div class="t m5 x74 h2f y15ad ffb fs10 fc2 sc0 ls0 ws0">public class Server implements Runnable {</div><div class="t m5 x74 h2f y15ae ffb fs10 fc2 sc0 ls0 ws0">    ServerSocket serverSocket;</div><div class="t m5 x74 h2f y15af ffb fs10 fc2 sc0 ls0 ws0">    volatile boolean keepProcessing = true;</div><div class="t m5 x74 h2f y15b0 ffb fs10 fc2 sc0 ls0 ws0">    public Server(int port, int millisecondsTimeout) throws IOException {</div><div class="t m5 x74 h2f y15b1 ffb fs10 fc2 sc0 ls0 ws0">        serverSocket = new ServerSocket(port);</div><div class="t m5 x74 h2f y15b2 ffb fs10 fc2 sc0 ls0 ws0">        serverSocket.setSoTimeout(millisecondsTimeout);</div><div class="t m5 x74 h2f y15b3 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15b4 ffb fs10 fc2 sc0 ls0 ws0">    public void run() {</div><div class="t m5 x74 h2f y15b5 ffb fs10 fc2 sc0 ls0 ws0">        System.out.printf(&quot;Server Starting\n&quot;);</div><div class="t m5 x74 h2f y15b6 ffb fs10 fc2 sc0 ls0 ws0">        while (keepProcessing) {</div><div class="t m5 x74 h2f y15b7 ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y15b8 ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;accepting client\n&quot;);</div><div class="t m5 x74 h2f y15b9 ffb fs10 fc2 sc0 ls0 ws0">                Socket socket = serverSocket.accept();</div><div class="t m5 x74 h2f y15ba ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;got client\n&quot;);</div><div class="t m5 x74 h2f y15bb ffb fs10 fc2 sc0 ls0 ws0">                process(socket);</div><div class="t m5 x74 h2f y15bc ffb fs10 fc2 sc0 ls0 ws0">            } catch (Exception e) {</div><div class="t m5 x74 h2f y15bd ffb fs10 fc2 sc0 ls0 ws0">                handle(e);</div><div class="t m5 x74 h2f y15be ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y15bf ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y15c0 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15c1 ffb fs10 fc2 sc0 ls0 ws0">    private void handle(Exception e) {</div><div class="t m5 x74 h2f y15c2 ffb fs10 fc2 sc0 ls0 ws0">        if (!(e instanceof SocketException)) {</div><div class="t m5 x74 h2f y15c3 ffb fs10 fc2 sc0 ls0 ws0">            e.printStackTrace();</div><div class="t m5 x74 h2f y15c4 ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y15c5 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15c6 ffb fs10 fc2 sc0 ls0 ws0">    public void stopProcessing() {</div><div class="t m5 x74 h2f y15c7 ffb fs10 fc2 sc0 ls0 ws0">        keepProcessing = false;</div><div class="t m5 x74 h2f y15c8 ffb fs10 fc2 sc0 ls0 ws0">        closeIgnoringException(serverSocket);</div><div class="t m5 x74 h2f y15c9 ffb fs10 fc2 sc0 ls0 ws0">    }</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:538.945010px;width:176.810000px;height:15.596000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:512.728010px;width:138.153000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf177" class="pf w1 h2" data-page-no="177"><div class="pc pc177 w1 h2"><img class="bi xd yd48 wc hc6" alt="" src="bg177.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">344<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc2 sc0 ls0 ws0">    void process(Socket socket) {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc2 sc0 ls0 ws0">        if (socket == null)</div><div class="t m5 x74 h2f y4bb ffb fs10 fc2 sc0 ls0 ws0">            return;</div><div class="t m5 x74 h2f y522 ffb fs10 fc2 sc0 ls0 ws0">        try {</div><div class="t m5 x74 h2f y15ca ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: getting message\n&quot;);</div><div class="t m5 x74 h2f y149a ffb fs10 fc2 sc0 ls0 ws0">            String message = MessageUtils.getMessage(socket);</div><div class="t m5 x74 h2f y149b ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: got message: %s\n&quot;, message);</div><div class="t m5 x74 h2f y149c ffb fs10 fc2 sc0 ls0 ws0">            Thread.sleep(1000);</div><div class="t m5 x74 h2f y15cb ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: sending reply: %s\n&quot;, message);</div><div class="t m5 x74 h2f y149d ffb fs10 fc2 sc0 ls0 ws0">            MessageUtils.sendMessage(socket, &quot;Processed: &quot; + message);</div><div class="t m5 x74 h2f y149e ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: sent\n&quot;);</div><div class="t m5 x74 h2f y149f ffb fs10 fc2 sc0 ls0 ws0">            closeIgnoringException(socket);</div><div class="t m5 x74 h2f y14a0 ffb fs10 fc2 sc0 ls0 ws0">        } catch (Exception e) {</div><div class="t m5 x74 h2f y14a1 ffb fs10 fc2 sc0 ls0 ws0">            e.printStackTrace();</div><div class="t m5 x74 h2f y14a2 ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y14a4 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15cc ffb fs10 fc2 sc0 ls0 ws0">    private void closeIgnoringException(Socket socket) {</div><div class="t m5 x74 h2f y8a7 ffb fs10 fc2 sc0 ls0 ws0">        if (socket != null)</div><div class="t m5 x74 h2f y8a8 ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y8a9 ffb fs10 fc2 sc0 ls0 ws0">                socket.close();</div><div class="t m5 x74 h2f y8aa ffb fs10 fc2 sc0 ls0 ws0">            } catch (IOException ignore) {</div><div class="t m5 x74 h2f y8ab ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y8c0 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y8c1 ffb fs10 fc2 sc0 ls0 ws0">    private void closeIgnoringException(ServerSocket serverSocket) {</div><div class="t m5 x74 h2f y8ad ffb fs10 fc2 sc0 ls0 ws0">        if (serverSocket != null)</div><div class="t m5 x74 h2f y8ae ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y8af ffb fs10 fc2 sc0 ls0 ws0">                serverSocket.close();</div><div class="t m5 x74 h2f y8b0 ffb fs10 fc2 sc0 ls0 ws0">            } catch (IOException ignore) {</div><div class="t m5 x74 h2f y8b1 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y8b2 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y8c2 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c ybf6 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-4 </div><div class="t m0 x74 h36 y15cd ffc fs3 fc2 sc0 ls0 ws0">ClientTest.java</div><div class="t m5 x74 h2f y878 ffb fs10 fc2 sc0 ls0 ws0">package com.objectmentor.clientserver.nonthreaded;</div><div class="t m5 x74 h2f y87a ffb fs10 fc2 sc0 ls0 ws0">import java.io.IOException;</div><div class="t m5 x74 h2f y87b ffb fs10 fc2 sc0 ls0 ws0">import java.net.ServerSocket;</div><div class="t m5 x74 h2f y87c ffb fs10 fc2 sc0 ls0 ws0">import java.net.Socket;</div><div class="t m5 x74 h2f y15ce ffb fs10 fc2 sc0 ls0 ws0">import java.net.SocketException;</div><div class="t m5 x74 h2f y15cf ffb fs10 fc2 sc0 ls0 ws0">import common.MessageUtils;</div><div class="t m5 x74 h2f y15d0 ffb fs10 fc2 sc0 ls0 ws0">public class Server implements Runnable {</div><div class="t m5 x74 h2f y15d1 ffb fs10 fc2 sc0 ls0 ws0">    ServerSocket serverSocket;</div><div class="t m5 x74 h2f y15d2 ffb fs10 fc2 sc0 ls0 ws0">    volatile boolean keepProcessing = true;</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-3 <span class="_ _6"></span>(contin<span class="_ _4"></span>ued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc2 sc0 ls0 ws0">Server.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf178" class="pf w1 h2" data-page-no="178"><div class="pc pc178 w1 h2"><img class="bi xd yf07 wc h95" alt="" src="bg178.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">345<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>utorial: Full Code Examples</span></div><div class="t m5 x74 h2f y4b9 ffb fs10 fc2 sc0 ls0 ws0">    public Server(int port, int millisecondsTimeout) throws IOException {</div><div class="t m5 x74 h2f y4ba ffb fs10 fc2 sc0 ls0 ws0">        serverSocket = new ServerSocket(port);</div><div class="t m5 x74 h2f y4bb ffb fs10 fc2 sc0 ls0 ws0">        serverSocket.setSoTimeout(millisecondsTimeout);</div><div class="t m5 x74 h2f y4bc ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4bd ffb fs10 fc2 sc0 ls0 ws0">    public void run() {</div><div class="t m5 x74 h2f y4be ffb fs10 fc2 sc0 ls0 ws0">        System.out.printf(&quot;Server Starting\n&quot;);</div><div class="t m5 x74 h2f y4c0 ffb fs10 fc2 sc0 ls0 ws0">        while (keepProcessing) {</div><div class="t m5 x74 h2f y4c1 ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y4c2 ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;accepting client\n&quot;);</div><div class="t m5 x74 h2f y523 ffb fs10 fc2 sc0 ls0 ws0">                Socket socket = serverSocket.accept();</div><div class="t m5 x74 h2f y4c3 ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;got client\n&quot;);</div><div class="t m5 x74 h2f y4c4 ffb fs10 fc2 sc0 ls0 ws0">                process(socket);</div><div class="t m5 x74 h2f y4c5 ffb fs10 fc2 sc0 ls0 ws0">            } catch (Exception e) {</div><div class="t m5 x74 h2f y4c6 ffb fs10 fc2 sc0 ls0 ws0">                handle(e);</div><div class="t m5 x74 h2f y4c7 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y4c8 ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4c9 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4cb ffb fs10 fc2 sc0 ls0 ws0">    private void handle(Exception e) {</div><div class="t m5 x74 h2f y5af ffb fs10 fc2 sc0 ls0 ws0">        if (!(e instanceof SocketException)) {</div><div class="t m5 x74 h2f y4cc ffb fs10 fc2 sc0 ls0 ws0">            e.printStackTrace();</div><div class="t m5 x74 h2f y4cd ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y4ce ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d0 ffb fs10 fc2 sc0 ls0 ws0">    public void stopProcessing() {</div><div class="t m5 x74 h2f y97d ffb fs10 fc2 sc0 ls0 ws0">        keepProcessing = false;</div><div class="t m5 x74 h2f y4d1 ffb fs10 fc2 sc0 ls0 ws0">        closeIgnoringException(serverSocket);</div><div class="t m5 x74 h2f y4d2 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y4d4 ffb fs10 fc2 sc0 ls0 ws0">    void process(Socket socket) {</div><div class="t m5 x74 h2f y4d5 ffb fs10 fc2 sc0 ls0 ws0">        if (socket == null)</div><div class="t m5 x74 h2f y6a8 ffb fs10 fc2 sc0 ls0 ws0">            return;</div><div class="t m5 x74 h2f y4d7 ffb fs10 fc2 sc0 ls0 ws0">        try {</div><div class="t m5 x74 h2f y4d8 ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: getting message\n&quot;);</div><div class="t m5 x74 h2f y4d9 ffb fs10 fc2 sc0 ls0 ws0">            String message = MessageUtils.getMessage(socket);</div><div class="t m5 x74 h2f y4da ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: got message: %s\n&quot;, message);</div><div class="t m5 x74 h2f y4db ffb fs10 fc2 sc0 ls0 ws0">            Thread.sleep(1000);</div><div class="t m5 x74 h2f y6a9 ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: sending reply: %s\n&quot;, message);</div><div class="t m5 x74 h2f y6aa ffb fs10 fc2 sc0 ls0 ws0">            MessageUtils.sendMessage(socket, &quot;Processed: &quot; + message);</div><div class="t m5 x74 h2f y6ab ffb fs10 fc2 sc0 ls0 ws0">            System.out.printf(&quot;Server: sent\n&quot;);</div><div class="t m5 x74 h2f ya01 ffb fs10 fc2 sc0 ls0 ws0">            closeIgnoringException(socket);</div><div class="t m5 x74 h2f y6ac ffb fs10 fc2 sc0 ls0 ws0">        } catch (Exception e) {</div><div class="t m5 x74 h2f y6ad ffb fs10 fc2 sc0 ls0 ws0">            e.printStackTrace();</div><div class="t m5 x74 h2f y6ae ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y6af ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y6b1 ffb fs10 fc2 sc0 ls0 ws0">    private void closeIgnoringException(Socket socket) {</div><div class="t m5 x74 h2f y6b2 ffb fs10 fc2 sc0 ls0 ws0">        if (socket != null)</div><div class="t m5 x74 h2f ya02 ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y6b3 ffb fs10 fc2 sc0 ls0 ws0">                socket.close();</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-4 <span class="_ _6"></span>(contin<span class="_ _4"></span>ued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc2 sc0 ls0 ws0">ClientTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf179" class="pf w1 h2" data-page-no="179"><div class="pc pc179 w1 h2"><img class="bi xd y15d3 wc hc7" alt="" src="bg179.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">346<span class="_ _3f"> </span><span class="ff1 wsf5">Appendix <span class="_ _0"></span>A:<span class="_ _4"></span> Concurrency II</span></div><div class="t m0 xd h11 y1284 ff1 fs7 fc2 sc0 ls0 ws0">Client/Serv<span class="_ _4"></span>er Using <span class="_ _1"></span>Thr<span class="_ _4"></span>eads</div><div class="t m0 xd h14 y70f ff8 fs3 fc2 sc0 ls0 ws586">Changing the server to use threads simply requires a change to the process message (ne<span class="_ _4"></span>w</div><div class="t m0 xd h14 y710 ff8 fs3 fc2 sc0 ls0 ws0">lines are emphasized to stand out):</div><div class="t m5 x74 h2f y15d4 ffb fs10 fc2 sc0 ls0 ws0">void process(final Socket socket) {</div><div class="t m5 x74 h2f y15d5 ffb fs10 fc2 sc0 ls0 ws0">    if (socket == null)</div><div class="t m5 x74 h2f y15d6 ffb fs10 fc2 sc0 ls0 ws0">        return;</div><div class="t m5 x74 h46 y15d7 ffc fs10 fc2 sc0 ls0 ws0">    Runnable clientHandler = new Runnable() {</div><div class="t m5 x74 h2f y15d8 ffb fs10 fc2 sc0 ls0 ws0">        public void run() {</div><div class="t m5 x74 h2f y15d9 ffb fs10 fc2 sc0 ls0 ws0">            } catch (IOException ignore) {</div><div class="t m5 x74 h2f y15da ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y15db ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15dc ffb fs10 fc2 sc0 ls0 ws0">    private void closeIgnoringException(ServerSocket serverSocket) {</div><div class="t m5 x74 h2f y15dd ffb fs10 fc2 sc0 ls0 ws0">        if (serverSocket != null)</div><div class="t m5 x74 h2f y15de ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y15df ffb fs10 fc2 sc0 ls0 ws0">                serverSocket.close();</div><div class="t m5 x74 h2f y15e0 ffb fs10 fc2 sc0 ls0 ws0">            } catch (IOException ignore) {</div><div class="t m5 x74 h2f y15e1 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y15e2 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15e3 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y254 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-5 </div><div class="t m0 x74 h36 y747 ffc fs3 fc2 sc0 ls0 ws0">MessageUtils.java</div><div class="t m5 x74 h2f y15e4 ffb fs10 fc2 sc0 ls0 ws0">package common;</div><div class="t m5 x74 h2f y15e5 ffb fs10 fc2 sc0 ls0 ws0">import java.io.IOException;</div><div class="t m5 x74 h2f y15e6 ffb fs10 fc2 sc0 ls0 ws0">import java.io.InputStream;</div><div class="t m5 x74 h2f y15e7 ffb fs10 fc2 sc0 ls0 ws0">import java.io.ObjectInputStream;</div><div class="t m5 x74 h2f y15e8 ffb fs10 fc2 sc0 ls0 ws0">import java.io.ObjectOutputStream;</div><div class="t m5 x74 h2f y15e9 ffb fs10 fc2 sc0 ls0 ws0">import java.io.OutputStream;</div><div class="t m5 x74 h2f y15ea ffb fs10 fc2 sc0 ls0 ws0">import java.net.Socket;</div><div class="t m5 x74 h2f y15eb ffb fs10 fc2 sc0 ls0 ws0">public class MessageUtils {</div><div class="t m5 x74 h2f y15ec ffb fs10 fc2 sc0 ls0 ws0">    public static void sendMessage(Socket socket, String message)</div><div class="t m5 x74 h2f y15ed ffb fs10 fc2 sc0 ls0 ws0">            throws IOException {</div><div class="t m5 x74 h2f y15ee ffb fs10 fc2 sc0 ls0 ws0">        OutputStream stream = socket.getOutputStream();</div><div class="t m5 x74 h2f y15ef ffb fs10 fc2 sc0 ls0 ws0">        ObjectOutputStream oos = new ObjectOutputStream(stream);</div><div class="t m5 x74 h2f y15f0 ffb fs10 fc2 sc0 ls0 ws0">        oos.writeUTF(message);</div><div class="t m5 x74 h2f y15f1 ffb fs10 fc2 sc0 ls0 ws0">        oos.flush();</div><div class="t m5 x74 h2f y15f2 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15f3 ffb fs10 fc2 sc0 ls0 ws0">    public static String getMessage(Socket socket) throws IOException {</div><div class="t m5 x74 h2f y15f4 ffb fs10 fc2 sc0 ls0 ws0">        InputStream stream = socket.getInputStream();</div><div class="t m5 x74 h2f y15f5 ffb fs10 fc2 sc0 ls0 ws0">        ObjectInputStream ois = new ObjectInputStream(stream);</div><div class="t m5 x74 h2f y15f6 ffb fs10 fc2 sc0 ls0 ws0">        return ois.readUTF();</div><div class="t m5 x74 h2f y15f7 ffb fs10 fc2 sc0 ls0 ws0">    }</div><div class="t m5 x74 h2f y15f8 ffb fs10 fc2 sc0 ls0 ws0">}</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc2 sc0 ls0 ws1fc">Listing A-4 <span class="_ _6"></span>(contin<span class="_ _4"></span>ued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc2 sc0 ls0 ws0">ClientTest.java</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:78.825000px;bottom:174.728010px;width:145.115000px;height:13.368000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17a" class="pf w1 h2" data-page-no="17a"><div class="pc pc17a w1 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc2 sc0 ls0 ws0">347<span class="_ _10"></span><span class="ff1">T<span class="_ _0"></span>utorial: Full Code Examples</span></div><div class="t m5 x74 h2f y345 ffb fs10 fc2 sc0 ls0 ws0">            try {</div><div class="t m5 x74 h2f y627 ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;Server: getting message\n&quot;);</div><div class="t m5 x74 h2f y628 ffb fs10 fc2 sc0 ls0 ws0">                String message = MessageUtils.getMessage(socket);</div><div class="t m5 x74 h2f y629 ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;Server: got message: %s\n&quot;, message);</div><div class="t m5 x74 h2f y62a ffb fs10 fc2 sc0 ls0 ws0">                Thread.sleep(1000);</div><div class="t m5 x74 h2f y62b ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;Server: sending reply: %s\n&quot;, message);</div><div class="t m5 x74 h2f y62c ffb fs10 fc2 sc0 ls0 ws0">                MessageUtils.sendMessage(socket, &quot;Processed: &quot; + message);</div><div class="t m5 x74 h2f y62d ffb fs10 fc2 sc0 ls0 ws0">                System.out.printf(&quot;Server: sent\n&quot;);</div><div class="t m5 x74 h2f y861 ffb fs10 fc2 sc0 ls0 ws0">                closeIgnoringException(socket);</div><div class="t m5 x74 h2f y62e ffb fs10 fc2 sc0 ls0 ws0">            } catch (Exception e) {</div><div class="t m5 x74 h2f y62f ffb fs10 fc2 sc0 ls0 ws0">                e.printStackTrace();</div><div class="t m5 x74 h2f y630 ffb fs10 fc2 sc0 ls0 ws0">            }</div><div class="t m5 x74 h2f y631 ffb fs10 fc2 sc0 ls0 ws0">        }</div><div class="t m5 x74 h2f y632 ffb fs10 fc2 sc0 ls0 ws0">    };</div><div class="t m5 x74 h46 y633 ffc fs10 fc2 sc0 ls0 ws0">    Thread clientConnection = new Thread(clientHandler);</div><div class="t m5 x74 h46 y634 ffc fs10 fc2 sc0 ls0 ws0">    clientConnection.start();</div><div class="t m5 x74 h2f y635 ffb fs10 fc2 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17b" class="pf w1 h2" data-page-no="17b"><div class="pc pc17b w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17c" class="pf w1 h2" data-page-no="17c"><div class="pc pc17c w1 h2"><img class="bi xd y22e wc h20" alt="" src="bg17c.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">349</div><div class="t m0 x5a h23 y24c ff1 fsd fc0 sc0 ls0 ws0">A<span class="_ _2"></span>ppend<span class="ff15">i</span>x B</div><div class="t m8 x87 hac y129f ffc fs17 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y15f9 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 </div><div class="t m0 x74 h36 y15fa ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div><div class="t m9 xd hb2 y15fb ffb fs18 fc0 sc0 ls9c ws7d9">   1 /* ========================================================================</div><div class="t m9 xd hb2 y15fc ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y15fd ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y15fe ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y15ff ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y1600 ffb fs18 fc0 sc0 ls0 ws0">   6  * </div><div class="t m9 xd hb2 y1601 ffb fs18 fc0 sc0 ls0 ws0">   7  * Project Info:  http://www.jfree.org/jcommon/index.html</div><div class="t m9 xd hb2 y1602 ffb fs18 fc0 sc0 ls0 ws0">   8  *</div><div class="t m9 xd hb2 y1603 ffb fs18 fc0 sc0 ls0 ws0">   9  * This library is free software; you can redistribute it and/or modify it </div><div class="t m9 xd hb2 y1604 ffb fs18 fc0 sc0 ls0 ws0">  10  * under the terms of the GNU Lesser General Public License as published by </div><div class="t m9 xd hb2 y1605 ffb fs18 fc0 sc0 ls0 ws0">  11  * the Free Software Foundation; either version 2.1 of the License, or </div><div class="t m9 xd hb2 y1606 ffb fs18 fc0 sc0 ls0 ws0">  12  * (at your option) any later version.</div><div class="t m9 xd hb2 y1607 ffb fs18 fc0 sc0 ls0 ws0">  13  *</div><div class="t m9 xd hb2 y1608 ffb fs18 fc0 sc0 ls0 ws0">  14  * This library is distributed in the hope that it will be useful, but </div><div class="t m9 xd hb2 y1609 ffb fs18 fc0 sc0 ls0 ws0">  15  * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY </div><div class="t m9 xd hb2 y160a ffb fs18 fc0 sc0 ls0 ws0">  16  * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public </div><div class="t m9 xd hb2 y160b ffb fs18 fc0 sc0 ls0 ws0">  17  * License for more details.</div><div class="t m9 xd hb2 y160c ffb fs18 fc0 sc0 ls0 ws0">  18  *</div><div class="t m9 xd hb2 y160d ffb fs18 fc0 sc0 ls0 ws0">  19  * You should have received a copy of the GNU Lesser General Public</div><div class="t m9 xd hb2 y160e ffb fs18 fc0 sc0 ls0 ws0">  20  * License along with this library; if not, write to the Free Software</div><div class="t m9 xd hb2 y160f ffb fs18 fc0 sc0 ls0 ws0">  21  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, </div><div class="t m9 xd hb2 y1610 ffb fs18 fc0 sc0 ls0 ws0">  22  * USA.</div><div class="t m9 xd hb2 y1611 ffb fs18 fc0 sc0 ls0 ws0">  23  *</div><div class="t m9 xd hb2 y1612 ffb fs18 fc0 sc0 ls0 ws0">  24  * [Java is a trademark or registered trademark of Sun Microsystems, Inc. </div><div class="t m9 xd hb2 y1613 ffb fs18 fc0 sc0 ls0 ws0">  25  * in the United States and other countries.]</div><div class="t m9 xd hb2 y1614 ffb fs18 fc0 sc0 ls0 ws0">  26  *</div><div class="t m9 xd hb2 y1615 ffb fs18 fc0 sc0 ls0 ws0">  27  * ---------------</div><div class="t m9 xd hb2 y1616 ffb fs18 fc0 sc0 ls0 ws0">  28  * SerialDate.java</div><div class="t m9 xd hb2 y1617 ffb fs18 fc0 sc0 ls0 ws0">  29  * ---------------</div><div class="t m9 xd hb2 y1618 ffb fs18 fc0 sc0 ls0 ws0">  30  * (C) Copyright 2001-2005, by Object Refinery Limited.</div><div class="t m9 xd hb2 y1619 ffb fs18 fc0 sc0 ls0 ws0">  31  *</div><div class="t m9 xd hb2 y161a ffb fs18 fc0 sc0 ls0 ws0">  32  * Original Author:  David Gilbert (for Object Refinery Limited);</div><div class="t m9 xd hb2 y161b ffb fs18 fc0 sc0 ls0 ws0">  33  * Contributor(s):   -;</div><div class="t m9 xd hb2 y161c ffb fs18 fc0 sc0 ls0 ws0">  34  *</div><div class="t m9 xd hb2 y161d ffb fs18 fc0 sc0 ls0 ws0">  35  * $Id: SerialDate.java,v 1.7 2005/11/03 09:25:17 mungady Exp $</div><div class="t m9 xd hb2 y161e ffb fs18 fc0 sc0 ls0 ws0">  36  *</div><div class="t m9 xd hb2 y161f ffb fs18 fc0 sc0 ls0 ws0">  37  * Changes (from 11-Oct-2001)</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:150.614000px;bottom:439.429010px;width:288.207000px;height:130.671000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17d" class="pf w1 h2" data-page-no="17d"><div class="pc pc17d w1 h2"><img class="bi xd y1620 wc hc8" alt="" src="bg17d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">350<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0">  38  * --------------------------</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0">  39  * 11-Oct-2001 : Re-organised the class and moved it to new package </div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0">  40  *               com.jrefinery.date (DG);</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0">  41  * 05-Nov-2001 : Added a getDescription() method, and eliminated NotableDate </div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0">  42  *               class (DG);</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0">  43  * 12-Nov-2001 : IBD requires setDescription() method, now that NotableDate </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0">  44  *               class is gone (DG);  Changed getPreviousDayOfWeek(), </div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0">  45  *               getFollowingDayOfWeek() and getNearestDayOfWeek() to correct </div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0">  46  *               bugs (DG);</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0">  47  * 05-Dec-2001 : Fixed bug in SpreadsheetDate class (DG);</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0">  48  * 29-May-2002 : Moved the month constants into a separate interface </div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0">  49  *               (MonthConstants) (DG);</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0">  50  * 27-Aug-2002 : Fixed bug in addMonths() method, thanks to N???levka Petr (DG);</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0">  51  * 03-Oct-2002 : Fixed errors reported by Checkstyle (DG);</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0">  52  * 13-Mar-2003 : Implemented Serializable (DG);</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0">  53  * 29-May-2003 : Fixed bug in addMonths method (DG);</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0">  54  * 04-Sep-2003 : Implemented Comparable.  Updated the isInRange javadocs (DG);</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0">  55  * 05-Jan-2005 : Fixed bug in addYears() method (1096282) (DG);</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0">  56  * </div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0">  57  */</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0">  58 </div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0">  59 package org.jfree.date;</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0">  60 </div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0">  61 import java.io.Serializable;</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0">  62 import java.text.DateFormatSymbols;</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0">  63 import java.text.SimpleDateFormat;</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0">  64 import java.util.Calendar;</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0">  65 import java.util.GregorianCalendar;</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0">  66 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0">  67 /**</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0">  68  *  An abstract class that defines our requirements for manipulating dates,</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0">  69  *  without tying down a particular implementation.</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0">  70  *  &lt;P&gt;</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0">  71  *  Requirement 1 : match at least what Excel does for dates;</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0">  72  *  Requirement 2 : class is immutable;</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0">  73  *  &lt;P&gt;</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0">  74  *  Why not just use java.util.Date?  We will, when it makes sense.  At times,</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0">  75  *  java.util.Date can be *too* precise - it represents an instant in time,</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0">  76  *  accurate to 1/1000th of a second (with the date itself depending on the</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0">  77  *  time-zone).  Sometimes we just want to represent a particular day (e.g. 21</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0">  78  *  January 2015) without concerning ourselves about the time of day, or the</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0">  79  *  time-zone, or anything else.  That&apos;s what we&apos;ve defined SerialDate for.</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0">  80  *  &lt;P&gt;</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0">  81  *  You can call getInstance() to get a concrete subclass of SerialDate,</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0">  82  *  without worrying about the exact implementation.</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0">  83  *</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0">  84  * @author David Gilbert</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0">  85  */</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0">  86 public abstract class SerialDate implements Comparable, </div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0">  87                                             Serializable, </div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0">  88                                             MonthConstants {</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0">  89 </div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0">  90     /** For serialization. */</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0">  91     private static final long serialVersionUID = -293716040467423637L;</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0">  92</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0">  93     /** Date format symbols. */</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0">  94     public static final DateFormatSymbols</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0">  95         DATE_FORMAT_SYMBOLS = new SimpleDateFormat().getDateFormatSymbols();</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0">  96 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0">  97     /** The serial number for 1 January 1900. */</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0">  98     public static final int SERIAL_LOWER_BOUND = 2;</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0">  99 </div><div class="t m9 xd hb2 y165f ffb fs18 fc0 sc0 ls0 ws0"> 100     /** The serial number for 31 December 9999. */</div><div class="t m9 xd hb2 y1660 ffb fs18 fc0 sc0 ls0 ws0"> 101     public static final int SERIAL_UPPER_BOUND = 2958465;</div><div class="t m9 xd hb2 y1661 ffb fs18 fc0 sc0 ls0 ws0"> 102 </div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17e" class="pf w1 h2" data-page-no="17e"><div class="pc pc17e w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg17e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">351<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 103     /** The lowest year value supported by this date format. */</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 104     public static final int MINIMUM_YEAR_SUPPORTED = 1900;</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 105 </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 106     /** The highest year value supported by this date format. */</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 107     public static final int MAXIMUM_YEAR_SUPPORTED = 9999;</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 108 </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 109     /** Useful constant for Monday. Equivalent to java.util.Calendar.MONDAY. */</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 110     public static final int MONDAY = Calendar.MONDAY;</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 111 </div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 112     /** </div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 113      * Useful constant for Tuesday. Equivalent to java.util.Calendar.TUESDAY. </div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 114      */</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 115     public static final int TUESDAY = Calendar.TUESDAY;</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 116 </div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 117     /** </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 118      * Useful constant for Wednesday. Equivalent to </div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 119      * java.util.Calendar.WEDNESDAY. </div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 120      */</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 121     public static final int WEDNESDAY = Calendar.WEDNESDAY;</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 122 </div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 123     /** </div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 124      * Useful constant for Thrusday. Equivalent to java.util.Calendar.THURSDAY. </div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 125      */</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 126     public static final int THURSDAY = Calendar.THURSDAY;</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 127 </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 128     /** Useful constant for Friday. Equivalent to java.util.Calendar.FRIDAY. */</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 129     public static final int FRIDAY = Calendar.FRIDAY;</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 130 </div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 131     /** </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 132      * Useful constant for Saturday. Equivalent to java.util.Calendar.SATURDAY.</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 133      */</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 134     public static final int SATURDAY = Calendar.SATURDAY;</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 135 </div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 136     /** Useful constant for Sunday. Equivalent to java.util.Calendar.SUNDAY. */</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 137     public static final int SUNDAY = Calendar.SUNDAY;</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 138 </div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 139     /** The number of days in each month in non leap years. */</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 140     static final int[] LAST_DAY_OF_MONTH =</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 141         {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 142 </div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 143     /** The number of days in a (non-leap) year up to the end of each month. */</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 144     static final int[] AGGREGATE_DAYS_TO_END_OF_MONTH =</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 145         {0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365};</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 146 </div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 147     /** The number of days in a year up to the end of the preceding month. */</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 148     static final int[] AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH =</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 149         {0, 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365};</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 150 </div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 151     /** The number of days in a leap year up to the end of each month. */</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 152     static final int[] LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_MONTH =</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 153         {0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366};</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 154 </div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 155     /** </div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 156      * The number of days in a leap year up to the end of the preceding month. </div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 157      */</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 158     static final int[] </div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 159         LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH =</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 160             {0, 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366};</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 161 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 162     /** A useful constant for referring to the first week in a month. */</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 163     public static final int FIRST_WEEK_IN_MONTH = 1;</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 164 </div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf17f" class="pf w1 h2" data-page-no="17f"><div class="pc pc17f w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg17f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">352<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 165     /** A useful constant for referring to the second week in a month. */</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 166     public static final int SECOND_WEEK_IN_MONTH = 2;</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 167 </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 168     /** A useful constant for referring to the third week in a month. */</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 169     public static final int THIRD_WEEK_IN_MONTH = 3;</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 170 </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 171     /** A useful constant for referring to the fourth week in a month. */</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 172     public static final int FOURTH_WEEK_IN_MONTH = 4;</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 173 </div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 174     /** A useful constant for referring to the last week in a month. */</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 175     public static final int LAST_WEEK_IN_MONTH = 0;</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 176 </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 177     /** Useful range constant. */</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 178     public static final int INCLUDE_NONE = 0;</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 179 </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 180     /** Useful range constant. */</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 181     public static final int INCLUDE_FIRST = 1;</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 182 </div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 183     /** Useful range constant. */</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 184     public static final int INCLUDE_SECOND = 2;</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 185 </div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 186     /** Useful range constant. */</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 187     public static final int INCLUDE_BOTH = 3;</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 188 </div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 189     /** </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 190      * Useful constant for specifying a day of the week relative to a fixed </div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 191      * date. </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 192      */</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 193     public static final int PRECEDING = -1;</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 194 </div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 195     /** </div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 196      * Useful constant for specifying a day of the week relative to a fixed </div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 197      * date. </div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 198      */</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 199     public static final int NEAREST = 0;</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 200 </div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 201     /** </div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 202      * Useful constant for specifying a day of the week relative to a fixed </div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 203      * date. </div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 204      */</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 205     public static final int FOLLOWING = 1;</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 206 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 207     /** A description for the date. */</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 208     private String description;</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 209 </div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 210     /**</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 211      * Default constructor.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 212      */</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 213     protected SerialDate() {</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 214     }</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 215 </div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 216     /**</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 217      * Returns &lt;code&gt;true&lt;/code&gt; if the supplied integer code represents a </div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 218      * valid day-of-the-week, and &lt;code&gt;false&lt;/code&gt; otherwise.</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 219      *</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 220      * @param code  the code being checked for validity.</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 221      *</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 222      * @return &lt;code&gt;true&lt;/code&gt; if the supplied integer code represents a </div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 223      *         valid day-of-the-week, and &lt;code&gt;false&lt;/code&gt; otherwise.</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 224      */</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 225     public static boolean isValidWeekdayCode(final int code) {</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 226 </div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf180" class="pf w1 h2" data-page-no="180"><div class="pc pc180 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg180.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">353<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 227         switch(code) {</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 228             case SUNDAY: </div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 229             case MONDAY: </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 230             case TUESDAY: </div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 231             case WEDNESDAY: </div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 232             case THURSDAY: </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 233             case FRIDAY: </div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 234             case SATURDAY: </div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 235                 return true;</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 236             default: </div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 237                 return false;</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 238         }</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 239 </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 240     }</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 241 </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 242     /**</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 243      * Converts the supplied string to a day of the week.</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 244      *</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 245      * @param s  a string representing the day of the week.</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 246      *</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 247      * @return &lt;code&gt;-1&lt;/code&gt; if the string is not convertable, the day of </div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 248      *         the week otherwise.</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 249      */</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 250     public static int stringToWeekdayCode(String s) {</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 251 </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 252         final String[] shortWeekdayNames </div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 253             = DATE_FORMAT_SYMBOLS.getShortWeekdays();</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 254         final String[] weekDayNames = DATE_FORMAT_SYMBOLS.getWeekdays();</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 255 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 256         int result = -1;</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 257         s = s.trim();</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 258         for (int i = 0; i &lt; weekDayNames.length; i++) {</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 259             if (s.equals(shortWeekdayNames[i])) {</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 260                 result = i;</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 261                 break;</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 262             }</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 263             if (s.equals(weekDayNames[i])) {</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 264                 result = i;</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 265                 break;</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 266             }</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 267         }</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 268         return result;</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 269 </div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 270     }</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 271 </div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 272     /**</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 273      * Returns a string representing the supplied day-of-the-week.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 274      * &lt;P&gt;</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 275      * Need to find a better approach.</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 276      *</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 277      * @param weekday  the day of the week.</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 278      *</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 279      * @return a string representing the supplied day-of-the-week.</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 280      */</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 281     public static String weekdayCodeToString(final int weekday) {</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 282 </div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 283         final String[] weekdays = DATE_FORMAT_SYMBOLS.getWeekdays();</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 284         return weekdays[weekday];</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 285 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 286     }</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 287 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 288     /**</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf181" class="pf w1 h2" data-page-no="181"><div class="pc pc181 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg181.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">354<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 289      * Returns an array of month names.</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 290      *</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 291      * @return an array of month names.</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 292      */</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 293     public static String[] getMonths() {</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 294 </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 295         return getMonths(false);</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 296 </div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 297     }</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 298 </div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 299     /**</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 300      * Returns an array of month names.</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 301      *</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 302      * @param shortened  a flag indicating that shortened month names should </div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 303      *                   be returned.</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 304      *</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 305      * @return an array of month names.</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 306      */</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 307     public static String[] getMonths(final boolean shortened) {</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 308 </div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 309         if (shortened) {</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 310             return DATE_FORMAT_SYMBOLS.getShortMonths();</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 311         }</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 312         else {</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 313             return DATE_FORMAT_SYMBOLS.getMonths();</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 314         }</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 315 </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 316     }</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 317 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 318     /**</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 319      * Returns true if the supplied integer code represents a valid month.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 320      *</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 321      * @param code  the code being checked for validity.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 322      *</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 323      * @return &lt;code&gt;true&lt;/code&gt; if the supplied integer code represents a </div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 324      *         valid month.</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 325      */</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 326     public static boolean isValidMonthCode(final int code) {</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 327 </div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 328         switch(code) {</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 329             case JANUARY: </div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 330             case FEBRUARY: </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 331             case MARCH: </div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 332             case APRIL: </div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 333             case MAY: </div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 334             case JUNE: </div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 335             case JULY: </div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 336             case AUGUST: </div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 337             case SEPTEMBER: </div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 338             case OCTOBER: </div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 339             case NOVEMBER: </div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 340             case DECEMBER: </div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 341                 return true;</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 342             default: </div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 343                 return false;</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 344         }</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 345 </div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 346     }</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 347 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 348     /**</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 349      * Returns the quarter for the specified month.</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 350      *</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf182" class="pf w1 h2" data-page-no="182"><div class="pc pc182 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg182.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">355<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 351      * @param code  the month code (1-12).</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 352      *</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 353      * @return the quarter that the month belongs to.</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 354      * @throws java.lang.IllegalArgumentException</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 355      */</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 356     public static int monthCodeToQuarter(final int code) {</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 357 </div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 358         switch(code) {</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 359             case JANUARY: </div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 360             case FEBRUARY: </div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 361             case MARCH: return 1;</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 362             case APRIL: </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 363             case MAY: </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 364             case JUNE: return 2;</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 365             case JULY: </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 366             case AUGUST: </div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 367             case SEPTEMBER: return 3;</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 368             case OCTOBER: </div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 369             case NOVEMBER: </div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 370             case DECEMBER: return 4;</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 371             default: throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 372                 &quot;SerialDate.monthCodeToQuarter: invalid month code.&quot;);</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 373         }</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 374 </div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 375     }</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 376 </div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 377     /**</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 378      * Returns a string representing the supplied month.</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 379      * &lt;P&gt;</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 380      * The string returned is the long form of the month name taken from the </div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 381      * default locale.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 382      *</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 383      * @param month  the month.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 384      *</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 385      * @return a string representing the supplied month.</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 386      */</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 387     public static String monthCodeToString(final int month) {</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 388 </div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 389         return monthCodeToString(month, false);</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 390 </div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 391     }</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 392 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 393     /**</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 394      * Returns a string representing the supplied month.</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 395      * &lt;P&gt;</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 396      * The string returned is the long or short form of the month name taken </div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 397      * from the default locale.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 398      *</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 399      * @param month  the month.</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 400      * @param shortened  if &lt;code&gt;true&lt;/code&gt; return the abbreviation of the </div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 401      *                   month.</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 402      *</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 403      * @return a string representing the supplied month.</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 404      * @throws java.lang.IllegalArgumentException</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 405      */</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 406     public static String monthCodeToString(final int month, </div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 407                                            final boolean shortened) {</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 408 </div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 409         // check arguments...</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 410         if (!isValidMonthCode(month)) {</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 411             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 412                 &quot;SerialDate.monthCodeToString: month outside valid range.&quot;);</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf183" class="pf w1 h2" data-page-no="183"><div class="pc pc183 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg183.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">356<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 413         }</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 414 </div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 415         final String[] months;</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 416 </div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 417         if (shortened) {</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 418             months = DATE_FORMAT_SYMBOLS.getShortMonths();</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 419         }</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 420         else {</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 421             months = DATE_FORMAT_SYMBOLS.getMonths();</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 422         }</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 423 </div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 424         return months[month - 1];</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 425 </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 426     }</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 427 </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 428     /**</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 429      * Converts a string to a month code.</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 430      * &lt;P&gt;</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 431      * This method will return one of the constants JANUARY, FEBRUARY, ..., </div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 432      * DECEMBER that corresponds to the string.  If the string is not </div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 433      * recognised, this method returns -1.</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 434      *</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 435      * @param s  the string to parse.</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 436      *</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 437      * @return &lt;code&gt;-1&lt;/code&gt; if the string is not parseable, the month of the</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 438      *         year otherwise.</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 439      */</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 440     public static int stringToMonthCode(String s) {</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 441 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 442         final String[] shortMonthNames = DATE_FORMAT_SYMBOLS.getShortMonths();</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 443         final String[] monthNames = DATE_FORMAT_SYMBOLS.getMonths();</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 444 </div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 445         int result = -1;</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 446         s = s.trim();</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 447 </div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 448         // first try parsing the string as an integer (1-12)...</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 449         try {</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 450             result = Integer.parseInt(s);</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 451         }</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 452         catch (NumberFormatException e) {</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 453             // suppress</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 454         }</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 455 </div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 456         // now search through the month names...</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 457         if ((result &lt; 1) || (result &gt; 12)) {</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 458             for (int i = 0; i &lt; monthNames.length; i++) {</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 459                 if (s.equals(shortMonthNames[i])) {</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 460                     result = i + 1;</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 461                     break;</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 462                 }</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 463                 if (s.equals(monthNames[i])) {</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 464                     result = i + 1;</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 465                     break;</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 466                 }</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 467             }</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 468         }</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 469 </div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 470         return result;</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 471 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 472     }</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 473 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 474     /**</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf184" class="pf w1 h2" data-page-no="184"><div class="pc pc184 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg184.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">357<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 475      * Returns true if the supplied integer code represents a valid </div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 476      * week-in-the-month, and false otherwise.</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 477      *</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 478      * @param code  the code being checked for validity.</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 479      * @return &lt;code&gt;true&lt;/code&gt; if the supplied integer code represents a </div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 480      *         valid week-in-the-month.</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 481      */</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 482     public static boolean isValidWeekInMonthCode(final int code) {</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 483 </div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 484         switch(code) {</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 485             case FIRST_WEEK_IN_MONTH: </div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 486             case SECOND_WEEK_IN_MONTH: </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 487             case THIRD_WEEK_IN_MONTH: </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 488             case FOURTH_WEEK_IN_MONTH: </div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 489             case LAST_WEEK_IN_MONTH: return true;</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 490             default: return false;</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 491         }</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 492 </div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 493     }</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 494 </div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 495     /**</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 496      * Determines whether or not the specified year is a leap year.</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 497      *</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 498      * @param yyyy  the year (in the range 1900 to 9999).</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 499      *</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 500      * @return &lt;code&gt;true&lt;/code&gt; if the specified year is a leap year.</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 501      */</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 502     public static boolean isLeapYear(final int yyyy) {</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 503 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 504         if ((yyyy % 4) != 0) {</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 505             return false;</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 506         }</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 507         else if ((yyyy % 400) == 0) {</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 508             return true;</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 509         }</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 510         else if ((yyyy % 100) == 0) {</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 511             return false;</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 512         }</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 513         else {</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 514             return true;</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 515         }</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 516 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 517     }</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 518 </div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 519     /**</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 520      * Returns the number of leap years from 1900 to the specified year </div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 521      * INCLUSIVE.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 522      * &lt;P&gt;</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 523      * Note that 1900 is not a leap year.</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 524      *</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 525      * @param yyyy  the year (in the range 1900 to 9999).</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 526      *</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 527      * @return the number of leap years from 1900 to the specified year.</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 528      */</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 529     public static int leapYearCount(final int yyyy) {</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 530 </div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 531         final int leap4 = (yyyy - 1896) / 4;</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 532         final int leap100 = (yyyy - 1800) / 100;</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 533         final int leap400 = (yyyy - 1600) / 400;</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 534         return leap4 - leap100 + leap400;</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 535 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 536     }</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf185" class="pf w1 h2" data-page-no="185"><div class="pc pc185 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg185.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">358<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 537 </div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 538     /**</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 539      * Returns the number of the last day of the month, taking into account </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 540      * leap years.</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 541      *</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 542      * @param month  the month.</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 543      * @param yyyy  the year (in the range 1900 to 9999).</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 544      *</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 545      * @return the number of the last day of the month.</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 546      */</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 547     public static int lastDayOfMonth(final int month, final int yyyy) {</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 548 </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 549         final int result = LAST_DAY_OF_MONTH[month];</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 550         if (month != FEBRUARY) {</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 551             return result;</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 552         }</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 553         else if (isLeapYear(yyyy)) {</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 554             return result + 1;</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 555         }</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 556         else {</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 557             return result;</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 558         }</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 559 </div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 560     }</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 561 </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 562     /**</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 563      * Creates a new date by adding the specified number of days to the base </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 564      * date.</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 565      *</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 566      * @param days  the number of days to add (can be negative).</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 567      * @param base  the base date.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 568      *</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 569      * @return a new date.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 570      */</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 571     public static SerialDate addDays(final int days, final SerialDate base) {</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 572 </div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 573         final int serialDayNumber = base.toSerial() + days;</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 574         return SerialDate.createInstance(serialDayNumber);</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 575 </div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 576     }</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 577 </div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 578     /**</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 579      * Creates a new date by adding the specified number of months to the base </div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 580      * date.</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 581      * &lt;P&gt;</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 582      * If the base date is close to the end of the month, the day on the result</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 583      * may be adjusted slightly:  31 May + 1 month = 30 June.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 584      *</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 585      * @param months  the number of months to add (can be negative).</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 586      * @param base  the base date.</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 587      *</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 588      * @return a new date.</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 589      */</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 590     public static SerialDate addMonths(final int months, </div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 591                                        final SerialDate base) {</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 592 </div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 593         final int yy = (12 * base.getYYYY() + base.getMonth() + months - 1) </div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 594                        / 12;</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 595         final int mm = (12 * base.getYYYY() + base.getMonth() + months - 1) </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 596                        % 12 + 1;</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 597         final int dd = Math.min(</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 598             base.getDayOfMonth(), SerialDate.lastDayOfMonth(mm, yy)</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf186" class="pf w1 h2" data-page-no="186"><div class="pc pc186 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg186.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">359<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 599         );</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 600         return SerialDate.createInstance(dd, mm, yy);</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 601 </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 602     }</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 603 </div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 604     /**</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 605      * Creates a new date by adding the specified number of years to the base </div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 606      * date.</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 607      *</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 608      * @param years  the number of years to add (can be negative).</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 609      * @param base  the base date.</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 610      *</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 611      * @return A new date.</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 612      */</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 613     public static SerialDate addYears(final int years, final SerialDate base) {</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 614 </div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 615         final int baseY = base.getYYYY();</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 616         final int baseM = base.getMonth();</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 617         final int baseD = base.getDayOfMonth();</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 618 </div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 619         final int targetY = baseY + years;</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 620         final int targetD = Math.min(</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 621             baseD, SerialDate.lastDayOfMonth(baseM, targetY)</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 622         );</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 623 </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 624         return SerialDate.createInstance(targetD, baseM, targetY);</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 625 </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 626     }</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 627 </div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 628     /**</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 629      * Returns the latest date that falls on the specified day-of-the-week and </div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 630      * is BEFORE the base date.</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 631      *</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 632      * @param targetWeekday  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 633      * @param base  the base date.</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 634      *</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 635      * @return the latest date that falls on the specified day-of-the-week and </div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 636      *         is BEFORE the base date.</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 637      */</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 638     public static SerialDate getPreviousDayOfWeek(final int targetWeekday, </div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 639                                                   final SerialDate base) {</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 640 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 641         // check arguments...</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 642         if (!SerialDate.isValidWeekdayCode(targetWeekday)) {</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 643             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 644                 &quot;Invalid day-of-the-week code.&quot;</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 645             );</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 646         }</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 647 </div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 648         // find the date...</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 649         final int adjust;</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 650         final int baseDOW = base.getDayOfWeek();</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 651         if (baseDOW &gt; targetWeekday) {</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 652             adjust = Math.min(0, targetWeekday - baseDOW);</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 653         }</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 654         else {</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 655             adjust = -7 + Math.max(0, targetWeekday - baseDOW);</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 656         }</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 657 </div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 658         return SerialDate.addDays(adjust, base);</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 659 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 660     }</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf187" class="pf w1 h2" data-page-no="187"><div class="pc pc187 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg187.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">360<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 661 </div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 662     /**</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 663      * Returns the earliest date that falls on the specified day-of-the-week</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 664      * and is AFTER the base date.</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 665      *</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 666      * @param targetWeekday  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 667      * @param base  the base date.</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 668      *</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 669      * @return the earliest date that falls on the specified day-of-the-week </div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 670      *         and is AFTER the base date.</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 671      */</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 672     public static SerialDate getFollowingDayOfWeek(final int targetWeekday, </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 673                                                    final SerialDate base) {</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 674 </div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 675         // check arguments...</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 676         if (!SerialDate.isValidWeekdayCode(targetWeekday)) {</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 677             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 678                 &quot;Invalid day-of-the-week code.&quot;</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 679             );</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 680         }</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 681 </div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 682         // find the date...</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 683         final int adjust;</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 684         final int baseDOW = base.getDayOfWeek();</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 685         if (baseDOW &gt; targetWeekday) {</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 686             adjust = 7 + Math.min(0, targetWeekday - baseDOW);</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 687         }</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 688         else {</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 689             adjust = Math.max(0, targetWeekday - baseDOW);</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 690         }</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 691 </div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 692         return SerialDate.addDays(adjust, base);</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 693     }</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 694 </div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 695     /**</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 696      * Returns the date that falls on the specified day-of-the-week and is</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 697      * CLOSEST to the base date.</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 698      *</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 699      * @param targetDOW  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 700      * @param base  the base date.</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 701      *</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 702      * @return the date that falls on the specified day-of-the-week and is </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 703      *         CLOSEST to the base date.</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 704      */</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 705     public static SerialDate getNearestDayOfWeek(final int targetDOW,</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 706                                                  final SerialDate base) {</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 707 </div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 708         // check arguments...</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 709         if (!SerialDate.isValidWeekdayCode(targetDOW)) {</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 710             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 711                 &quot;Invalid day-of-the-week code.&quot;</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 712             );</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 713         }</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 714 </div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 715         // find the date...</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 716         final int baseDOW = base.getDayOfWeek();</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 717         int adjust = -Math.abs(targetDOW - baseDOW);</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 718         if (adjust &gt;= 4) {</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 719             adjust = 7 - adjust;</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 720         }</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 721         if (adjust &lt;= -4) {</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 722             adjust = 7 + adjust;</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf188" class="pf w1 h2" data-page-no="188"><div class="pc pc188 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg188.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">361<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 723         }</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 724         return SerialDate.addDays(adjust, base);</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 725 </div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 726     }</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 727 </div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 728     /**</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 729      * Rolls the date forward to the last day of the month.</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 730      *</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 731      * @param base  the base date.</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 732      *</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 733      * @return a new serial date.</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 734      */</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 735     public SerialDate getEndOfCurrentMonth(final SerialDate base) {</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 736         final int last = SerialDate.lastDayOfMonth(</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 737             base.getMonth(), base.getYYYY()</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 738         );</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 739         return SerialDate.createInstance(last, base.getMonth(), base.getYYYY());</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 740     }</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 741 </div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 742     /**</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 743      * Returns a string corresponding to the week-in-the-month code.</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 744      * &lt;P&gt;</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 745      * Need to find a better approach.</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 746      *</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 747      * @param count  an integer code representing the week-in-the-month.</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 748      *</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 749      * @return a string corresponding to the week-in-the-month code.</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 750      */</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 751     public static String weekInMonthToString(final int count) {</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 752 </div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 753         switch (count) {</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 754             case SerialDate.FIRST_WEEK_IN_MONTH : return &quot;First&quot;;</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 755             case SerialDate.SECOND_WEEK_IN_MONTH : return &quot;Second&quot;;</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 756             case SerialDate.THIRD_WEEK_IN_MONTH : return &quot;Third&quot;;</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 757             case SerialDate.FOURTH_WEEK_IN_MONTH : return &quot;Fourth&quot;;</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 758             case SerialDate.LAST_WEEK_IN_MONTH : return &quot;Last&quot;;</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 759             default :</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 760                 return &quot;SerialDate.weekInMonthToString(): invalid code.&quot;;</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 761         }</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 762 </div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 763     }</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 764 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 765     /**</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 766      * Returns a string representing the supplied &apos;relative&apos;.</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 767      * &lt;P&gt;</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 768      * Need to find a better approach.</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 769      *</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 770      * @param relative  a constant representing the &apos;relative&apos;.</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 771      *</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 772      * @return a string representing the supplied &apos;relative&apos;.</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 773      */</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 774     public static String relativeToString(final int relative) {</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 775 </div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 776         switch (relative) {</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 777             case SerialDate.PRECEDING : return &quot;Preceding&quot;;</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 778             case SerialDate.NEAREST : return &quot;Nearest&quot;;</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 779             case SerialDate.FOLLOWING : return &quot;Following&quot;;</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 780             default : return &quot;ERROR : Relative To String&quot;;</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 781         }</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 782 </div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 783     }</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 784 </div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf189" class="pf w1 h2" data-page-no="189"><div class="pc pc189 w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg189.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">362<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 785     /**</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 786      * Factory method that returns an instance of some concrete subclass of </div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 787      * {@link SerialDate}.</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 788      *</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 789      * @param day  the day (1-31).</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 790      * @param month  the month (1-12).</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 791      * @param yyyy  the year (in the range 1900 to 9999).</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 792      *</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 793      * @return An instance of {@link SerialDate}.</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 794      */</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 795     public static SerialDate createInstance(final int day, final int month, </div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 796                                             final int yyyy) {</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 797         return new SpreadsheetDate(day, month, yyyy);</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 798     }</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 799 </div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 800     /**</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 801      * Factory method that returns an instance of some concrete subclass of </div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 802      * {@link SerialDate}.</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 803      *</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 804      * @param serial  the serial number for the day (1 January 1900 = 2).</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 805      *</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 806      * @return a instance of SerialDate.</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 807      */</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 808     public static SerialDate createInstance(final int serial) {</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 809         return new SpreadsheetDate(serial);</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 810     }</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 811 </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 812     /**</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 813      * Factory method that returns an instance of a subclass of SerialDate.</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 814      *</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 815      * @param date  A Java date object.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 816      *</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 817      * @return a instance of SerialDate.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 818      */</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 819     public static SerialDate createInstance(final java.util.Date date) {</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 820 </div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 821         final GregorianCalendar calendar = new GregorianCalendar();</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 822         calendar.setTime(date);</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 823         return new SpreadsheetDate(calendar.get(Calendar.DATE),</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 824                                    calendar.get(Calendar.MONTH) + 1,</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 825                                    calendar.get(Calendar.YEAR));</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 826 </div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 827     }</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 828 </div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 829     /**</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 830      * Returns the serial number for the date, where 1 January 1900 = 2 (this</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 831      * corresponds, almost, to the numbering system used in Microsoft Excel for</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 832      * Windows and Lotus 1-2-3).</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 833      *</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 834      * @return the serial number for the date.</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 835      */</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 836     public abstract int toSerial();</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 837 </div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 838     /**</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 839      * Returns a java.util.Date.  Since java.util.Date has more precision than</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 840      * SerialDate, we need to define a convention for the &apos;time of day&apos;.</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 841      *</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 842      * @return this as &lt;code&gt;java.util.Date&lt;/code&gt;.</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 843      */</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 844     public abstract java.util.Date toDate();</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 845 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 846     /**</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18a" class="pf w1 h2" data-page-no="18a"><div class="pc pc18a w1 h2"><img class="bi xd y24 wc h7b" alt="" src="bg18a.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">363<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 847      * Returns a description of the date.</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 848      *</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 849      * @return a description of the date.</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 850      */</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 851     public String getDescription() {</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 852         return this.description;</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 853     }</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 854 </div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 855     /**</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 856      * Sets the description for the date.</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 857      *</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 858      * @param description  the new description for the date.</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 859      */</div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 860     public void setDescription(final String description) {</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 861         this.description = description;</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 862     }</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 863 </div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 864     /**</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 865      * Converts the date to a string.</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 866      *</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 867      * @return  a string representation of the date.</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 868      */</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 869     public String toString() {</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 870         return getDayOfMonth() + &quot;-&quot; + SerialDate.monthCodeToString(getMonth())</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 871                                + &quot;-&quot; + getYYYY();</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 872     }</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 873 </div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 874     /**</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 875      * Returns the year (assume a valid range of 1900 to 9999).</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 876      *</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 877      * @return the year.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 878      */</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 879     public abstract int getYYYY();</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 880 </div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 881     /**</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 882      * Returns the month (January = 1, February = 2, March = 3).</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 883      *</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 884      * @return the month of the year.</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 885      */</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 886     public abstract int getMonth();</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 887 </div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 888     /**</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 889      * Returns the day of the month.</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 890      *</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 891      * @return the day of the month.</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 892      */</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 893     public abstract int getDayOfMonth();</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 894 </div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 895     /**</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 896      * Returns the day of the week.</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 897      *</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 898      * @return the day of the week.</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 899      */</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 900     public abstract int getDayOfWeek();</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 901 </div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 902     /**</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 903      * Returns the difference (in days) between this date and the specified </div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 904      * &apos;other&apos; date.</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 905      * &lt;P&gt;</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 906      * The result is positive if this date is after the &apos;other&apos; date and</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 907      * negative if it is before the &apos;other&apos; date.</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 908      *</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18b" class="pf w1 h2" data-page-no="18b"><div class="pc pc18b w1 h2"><img class="bi xd y1664 wc hc9" alt="" src="bg18b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">364<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 909      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 910      *</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 911      * @return the difference between this and the other date.</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 912      */</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 913     public abstract int compare(SerialDate other);</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 914 </div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 915     /**</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 916      * Returns true if this SerialDate represents the same date as the </div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 917      * specified SerialDate.</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 918      *</div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 919      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 920      *</div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 921      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date as </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 922      *         the specified SerialDate.</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 923      */</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 924     public abstract boolean isOn(SerialDate other);</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 925 </div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 926     /**</div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 927      * Returns true if this SerialDate represents an earlier date compared to</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 928      * the specified SerialDate.</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 929      *</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 930      * @param other  The date being compared to.</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 931      *</div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 932      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents an earlier date </div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 933      *         compared to the specified SerialDate.</div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 934      */</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 935     public abstract boolean isBefore(SerialDate other);</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 936 </div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0"> 937     /**</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0"> 938      * Returns true if this SerialDate represents the same date as the </div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0"> 939      * specified SerialDate.</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0"> 940      *</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0"> 941      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0"> 942      *</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0"> 943      * @return &lt;code&gt;true&lt;code&gt; if this SerialDate represents the same date</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0"> 944      *         as the specified SerialDate.</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0"> 945      */</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0"> 946     public abstract boolean isOnOrBefore(SerialDate other);</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0"> 947 </div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0"> 948     /**</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0"> 949      * Returns true if this SerialDate represents the same date as the </div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0"> 950      * specified SerialDate.</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0"> 951      *</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0"> 952      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0"> 953      *</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0"> 954      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0"> 955      *         as the specified SerialDate.</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0"> 956      */</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0"> 957     public abstract boolean isAfter(SerialDate other);</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0"> 958 </div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0"> 959     /**</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0"> 960      * Returns true if this SerialDate represents the same date as the </div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0"> 961      * specified SerialDate.</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0"> 962      *</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0"> 963      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0"> 964      *</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0"> 965      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0"> 966      *         as the specified SerialDate.</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0"> 967      */</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0"> 968     public abstract boolean isOnOrAfter(SerialDate other);</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0"> 969 </div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0"> 970     /**</div><div class="t m9 xd hb2 y165f ffb fs18 fc0 sc0 ls0 ws0"> 971      * Returns &lt;code&gt;true&lt;/code&gt; if this {@link SerialDate} is within the </div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18c" class="pf w1 h2" data-page-no="18c"><div class="pc pc18c w1 h2"><img class="bi xd y1665 wc hca" alt="" src="bg18c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">365<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1621 ffb fs18 fc0 sc0 ls0 ws0"> 972      * specified range (INCLUSIVE).  The date order of d1 and d2 is not </div><div class="t m9 xd hb2 y1622 ffb fs18 fc0 sc0 ls0 ws0"> 973      * important.</div><div class="t m9 xd hb2 y1623 ffb fs18 fc0 sc0 ls0 ws0"> 974      *</div><div class="t m9 xd hb2 y1624 ffb fs18 fc0 sc0 ls0 ws0"> 975      * @param d1  a boundary date for the range.</div><div class="t m9 xd hb2 y1625 ffb fs18 fc0 sc0 ls0 ws0"> 976      * @param d2  the other boundary date for the range.</div><div class="t m9 xd hb2 y1626 ffb fs18 fc0 sc0 ls0 ws0"> 977      *</div><div class="t m9 xd hb2 y1627 ffb fs18 fc0 sc0 ls0 ws0"> 978      * @return A boolean.</div><div class="t m9 xd hb2 y1628 ffb fs18 fc0 sc0 ls0 ws0"> 979      */</div><div class="t m9 xd hb2 y1629 ffb fs18 fc0 sc0 ls0 ws0"> 980     public abstract boolean isInRange(SerialDate d1, SerialDate d2);</div><div class="t m9 xd hb2 y162a ffb fs18 fc0 sc0 ls0 ws0"> 981 </div><div class="t m9 xd hb2 y162b ffb fs18 fc0 sc0 ls0 ws0"> 982     /**</div><div class="t m9 xd hb2 y162c ffb fs18 fc0 sc0 ls0 ws0"> 983      * Returns &lt;code&gt;true&lt;/code&gt; if this {@link SerialDate} is within the </div><div class="t m9 xd hb2 y162d ffb fs18 fc0 sc0 ls0 ws0"> 984      * specified range (caller specifies whether or not the end-points are </div><div class="t m9 xd hb2 y162e ffb fs18 fc0 sc0 ls0 ws0"> 985      * included).  The date order of d1 and d2 is not important.</div><div class="t m9 xd hb2 y162f ffb fs18 fc0 sc0 ls0 ws0"> 986      *</div><div class="t m9 xd hb2 y1630 ffb fs18 fc0 sc0 ls0 ws0"> 987      * @param d1  a boundary date for the range.</div><div class="t m9 xd hb2 y1631 ffb fs18 fc0 sc0 ls0 ws0"> 988      * @param d2  the other boundary date for the range.</div><div class="t m9 xd hb2 y1632 ffb fs18 fc0 sc0 ls0 ws0"> 989      * @param include  a code that controls whether or not the start and end </div><div class="t m9 xd hb2 y1633 ffb fs18 fc0 sc0 ls0 ws0"> 990      *                 dates are included in the range.</div><div class="t m9 xd hb2 y1634 ffb fs18 fc0 sc0 ls0 ws0"> 991      *</div><div class="t m9 xd hb2 y1635 ffb fs18 fc0 sc0 ls0 ws0"> 992      * @return A boolean.</div><div class="t m9 xd hb2 y1636 ffb fs18 fc0 sc0 ls0 ws0"> 993      */</div><div class="t m9 xd hb2 y1637 ffb fs18 fc0 sc0 ls0 ws0"> 994     public abstract boolean isInRange(SerialDate d1, SerialDate d2, </div><div class="t m9 xd hb2 y1638 ffb fs18 fc0 sc0 ls0 ws0"> 995                                       int include);</div><div class="t m9 xd hb2 y1639 ffb fs18 fc0 sc0 ls0 ws0"> 996 </div><div class="t m9 xd hb2 y163a ffb fs18 fc0 sc0 ls0 ws0"> 997     /**</div><div class="t m9 xd hb2 y163b ffb fs18 fc0 sc0 ls0 ws0"> 998      * Returns the latest date that falls on the specified day-of-the-week and</div><div class="t m9 xd hb2 y163c ffb fs18 fc0 sc0 ls0 ws0"> 999      * is BEFORE this date.</div><div class="t m9 xd hb2 y163d ffb fs18 fc0 sc0 ls0 ws0">1000      *</div><div class="t m9 xd hb2 y163e ffb fs18 fc0 sc0 ls0 ws0">1001      * @param targetDOW  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y163f ffb fs18 fc0 sc0 ls0 ws0">1002      *</div><div class="t m9 xd hb2 y1640 ffb fs18 fc0 sc0 ls0 ws0">1003      * @return the latest date that falls on the specified day-of-the-week and</div><div class="t m9 xd hb2 y1641 ffb fs18 fc0 sc0 ls0 ws0">1004      *         is BEFORE this date.</div><div class="t m9 xd hb2 y1642 ffb fs18 fc0 sc0 ls0 ws0">1005      */</div><div class="t m9 xd hb2 y1643 ffb fs18 fc0 sc0 ls0 ws0">1006     public SerialDate getPreviousDayOfWeek(final int targetDOW) {</div><div class="t m9 xd hb2 y1644 ffb fs18 fc0 sc0 ls0 ws0">1007         return getPreviousDayOfWeek(targetDOW, this);</div><div class="t m9 xd hb2 y1645 ffb fs18 fc0 sc0 ls0 ws0">1008     }</div><div class="t m9 xd hb2 y1646 ffb fs18 fc0 sc0 ls0 ws0">1009</div><div class="t m9 xd hb2 y1647 ffb fs18 fc0 sc0 ls0 ws0">1010     /**</div><div class="t m9 xd hb2 y1648 ffb fs18 fc0 sc0 ls0 ws0">1011      * Returns the earliest date that falls on the specified day-of-the-week</div><div class="t m9 xd hb2 y1649 ffb fs18 fc0 sc0 ls0 ws0">1012      * and is AFTER this date.</div><div class="t m9 xd hb2 y164a ffb fs18 fc0 sc0 ls0 ws0">1013      *</div><div class="t m9 xd hb2 y164b ffb fs18 fc0 sc0 ls0 ws0">1014      * @param targetDOW  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y164c ffb fs18 fc0 sc0 ls0 ws0">1015      *</div><div class="t m9 xd hb2 y164d ffb fs18 fc0 sc0 ls0 ws0">1016      * @return the earliest date that falls on the specified day-of-the-week</div><div class="t m9 xd hb2 y164e ffb fs18 fc0 sc0 ls0 ws0">1017      *         and is AFTER this date.</div><div class="t m9 xd hb2 y164f ffb fs18 fc0 sc0 ls0 ws0">1018      */</div><div class="t m9 xd hb2 y1650 ffb fs18 fc0 sc0 ls0 ws0">1019     public SerialDate getFollowingDayOfWeek(final int targetDOW) {</div><div class="t m9 xd hb2 y1651 ffb fs18 fc0 sc0 ls0 ws0">1020         return getFollowingDayOfWeek(targetDOW, this);</div><div class="t m9 xd hb2 y1652 ffb fs18 fc0 sc0 ls0 ws0">1021     }</div><div class="t m9 xd hb2 y1653 ffb fs18 fc0 sc0 ls0 ws0">1022</div><div class="t m9 xd hb2 y1654 ffb fs18 fc0 sc0 ls0 ws0">1023     /**</div><div class="t m9 xd hb2 y1655 ffb fs18 fc0 sc0 ls0 ws0">1024      * Returns the nearest date that falls on the specified day-of-the-week.</div><div class="t m9 xd hb2 y1656 ffb fs18 fc0 sc0 ls0 ws0">1025      *</div><div class="t m9 xd hb2 y1657 ffb fs18 fc0 sc0 ls0 ws0">1026      * @param targetDOW  a code for the target day-of-the-week.</div><div class="t m9 xd hb2 y1658 ffb fs18 fc0 sc0 ls0 ws0">1027      *</div><div class="t m9 xd hb2 y1659 ffb fs18 fc0 sc0 ls0 ws0">1028      * @return the nearest date that falls on the specified day-of-the-week.</div><div class="t m9 xd hb2 y165a ffb fs18 fc0 sc0 ls0 ws0">1029      */</div><div class="t m9 xd hb2 y165b ffb fs18 fc0 sc0 ls0 ws0">1030     public SerialDate getNearestDayOfWeek(final int targetDOW) {</div><div class="t m9 xd hb2 y165c ffb fs18 fc0 sc0 ls0 ws0">1031         return getNearestDayOfWeek(targetDOW, this);</div><div class="t m9 xd hb2 y165d ffb fs18 fc0 sc0 ls0 ws0">1032     }</div><div class="t m9 xd hb2 y165e ffb fs18 fc0 sc0 ls0 ws0">1033</div><div class="t m9 xd hb2 y165f ffb fs18 fc0 sc0 ls0 ws0">1034 }</div><div class="t m0 x74 h1c y1662 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-1 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y1663 ffc fs3 fc0 sc0 ls0 ws0">SerialDate.Java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18d" class="pf w1 h2" data-page-no="18d"><div class="pc pc18d w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg18d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">366<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6  * </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7  * Project Info:  http://www.jfree.org/jcommon/index.html</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8  *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9  * This library is free software; you can redistribute it and/or modify it </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10  * under the terms of the GNU Lesser General Public License as published by </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11  * the Free Software Foundation; either version 2.1 of the License, or </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12  * (at your option) any later version.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13  *</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14  * This library is distributed in the hope that it will be useful, but </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15  * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16  * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17  * License for more details.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18  *</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19  * You should have received a copy of the GNU Lesser General Public</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20  * License along with this library; if not, write to the Free Software</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22  * USA.</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23  *</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24  * [Java is a trademark or registered trademark of Sun Microsystems, Inc. </div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25  * in the United States and other countries.]</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26  *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27  * --------------------</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28  * SerialDateTests.java</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29  * --------------------</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30  * (C) Copyright 2001-2005, by Object Refinery Limited.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31  *</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32  * Original Author:  David Gilbert (for Object Refinery Limited);</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33  * Contributor(s):   -;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34  *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35  * $Id: SerialDateTests.java,v 1.6 2005/11/16 15:58:40 taqua Exp $</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36  *</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37  * Changes</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38  * -------</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39  * 15-Nov-2001 : Version 1 (DG);</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40  * 25-Jun-2002 : Removed unnecessary import (DG);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41  * 24-Oct-2002 : Fixed errors reported by Checkstyle (DG);</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42  * 13-Mar-2003 : Added serialization test (DG);</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43  * 05-Jan-2005 : Added test for bug report 1096282 (DG);</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44  *</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45  */</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47 package org.jfree.date.junit;</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48 </div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49 import java.io.ByteArrayInputStream;</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50 import java.io.ByteArrayOutputStream;</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51 import java.io.ObjectInput;</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52 import java.io.ObjectInputStream;</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53 import java.io.ObjectOutput;</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54 import java.io.ObjectOutputStream;</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  55 </div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  56 import junit.framework.Test;</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  57 import junit.framework.TestCase;</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  58 import junit.framework.TestSuite;</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  59 </div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  60 import org.jfree.date.MonthConstants;</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  61 import org.jfree.date.SerialDate;</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  62 </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18e" class="pf w1 h2" data-page-no="18e"><div class="pc pc18e w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg18e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">367<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  63 /**</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  64  * Some JUnit tests for the {@link SerialDate} class.</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  65  */</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  66 public class SerialDateTests extends TestCase {</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  67 </div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  68     /** Date representing November 9. */</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  69     private SerialDate nov9Y2001;</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  70 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  71     /**</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  72      * Creates a new test case.</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  73      *</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  74      * @param name  the name.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  75      */</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  76     public SerialDateTests(final String name) {</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  77         super(name);</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  78     }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  79 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  80     /**</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  81      * Returns a test suite for the JUnit test runner.</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  82      *</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  83      * @return The test suite.</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  84      */</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  85     public static Test suite() {</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  86         return new TestSuite(SerialDateTests.class);</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  87     }</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  88 </div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  89     /**</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  90      * Problem set up.</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  91      */</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  92     protected void setUp() {</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  93         this.nov9Y2001 = SerialDate.createInstance(9, MonthConstants.NOVEMBER, 2001);</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  94     }</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  95 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  96     /**</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  97      * 9 Nov 2001 plus two months should be 9 Jan 2002.</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  98      */</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  99     public void testAddMonthsTo9Nov2001() {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 100         final SerialDate jan9Y2002 = SerialDate.addMonths(2, this.nov9Y2001);</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 101         final SerialDate answer = SerialDate.createInstance(9, 1, 2002);</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 102         assertEquals(answer, jan9Y2002);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 103     }</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 104 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 105     /**</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 106      * A test case for a reported bug, now fixed.</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 107      */</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 108     public void testAddMonthsTo5Oct2003() {</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 109         final SerialDate d1 = SerialDate.createInstance(5, MonthConstants.OCTOBER, 2003);</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 110         final SerialDate d2 = SerialDate.addMonths(2, d1);</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 111         assertEquals(d2, SerialDate.createInstance(5, MonthConstants.DECEMBER, 2003));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 112     }</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 113 </div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 114     /**</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 115      * A test case for a reported bug, now fixed.</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 116      */</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 117     public void testAddMonthsTo1Jan2003() {</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 118         final SerialDate d1 = SerialDate.createInstance(1, MonthConstants.JANUARY, 2003);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 119         final SerialDate d2 = SerialDate.addMonths(0, d1);</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 120         assertEquals(d2, d1);</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 121     }</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 122 </div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 123     /**</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 124      * Monday preceding Friday 9 November 2001 should be 5 November.</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf18f" class="pf w1 h2" data-page-no="18f"><div class="pc pc18f w1 h2"><img class="bi xd ye27 wc hcb" alt="" src="bg18f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">368<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 125      */</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 126     public void testMondayPrecedingFriday9Nov2001() {</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 127         SerialDate mondayBefore = SerialDate.getPreviousDayOfWeek(</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 128             SerialDate.MONDAY, this.nov9Y2001</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 129         );</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 130         assertEquals(5, mondayBefore.getDayOfMonth());</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 131     }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 132 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 133     /**</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 134      * Monday following Friday 9 November 2001 should be 12 November.</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 135      */</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 136     public void testMondayFollowingFriday9Nov2001() {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 137         SerialDate mondayAfter = SerialDate.getFollowingDayOfWeek(</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 138             SerialDate.MONDAY, this.nov9Y2001</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 139         );</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 140         assertEquals(12, mondayAfter.getDayOfMonth());</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 141     }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 142 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 143     /**</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 144      * Monday nearest Friday 9 November 2001 should be 12 November.</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 145      */</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 146     public void testMondayNearestFriday9Nov2001() {</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 147         SerialDate mondayNearest = SerialDate.getNearestDayOfWeek(</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 148             SerialDate.MONDAY, this.nov9Y2001</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 149         );</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 150         assertEquals(12, mondayNearest.getDayOfMonth());</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 151     }</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 152 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 153     /**</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 154      * The Monday nearest to 22nd January 1970 falls on the 19th.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 155      */</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 156     public void testMondayNearest22Jan1970() {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 157         SerialDate jan22Y1970 = SerialDate.createInstance(22, MonthConstants.JANUARY, 1970);</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 158         SerialDate mondayNearest=SerialDate.getNearestDayOfWeek(SerialDate.MONDAY, jan22Y1970);</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 159         assertEquals(19, mondayNearest.getDayOfMonth());</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 160     }</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 161 </div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 162     /**</div><div class="t m9 x11 hb2 y168c ffb fs18 fc0 sc0 ls0 ws7da">163      * Problem that the conversion of days to strings returns the right result.  Actually, this </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 164      * result depends on the Locale so this test needs to be modified.</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 165      */</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 166     public void testWeekdayCodeToString() {</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 167 </div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 168         final String test = SerialDate.weekdayCodeToString(SerialDate.SATURDAY);</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 169         assertEquals(&quot;Saturday&quot;, test);</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 170 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 171     }</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 172 </div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 173     /**</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 174      * Test the conversion of a string to a weekday.  Note that this test will fail if the </div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 175      * default locale doesn&apos;t use English weekday names...devise a better test!</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 176      */</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 177     public void testStringToWeekday() {</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 178 </div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 179         int weekday = SerialDate.stringToWeekdayCode(&quot;Wednesday&quot;);</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 180         assertEquals(SerialDate.WEDNESDAY, weekday);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 181 </div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 182         weekday = SerialDate.stringToWeekdayCode(&quot; Wednesday &quot;);</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 183         assertEquals(SerialDate.WEDNESDAY, weekday);</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 184 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf190" class="pf w1 h2" data-page-no="190"><div class="pc pc190 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg190.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">369<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 185         weekday = SerialDate.stringToWeekdayCode(&quot;Wed&quot;);</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 186         assertEquals(SerialDate.WEDNESDAY, weekday);</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 187 </div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 188     }</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 189 </div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 190     /**</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 191      * Test the conversion of a string to a month.  Note that this test will fail if the</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 192      * default locale doesn&apos;t use English month names...devise a better test!</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 193      */</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 194     public void testStringToMonthCode() {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 195 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 196         int m = SerialDate.stringToMonthCode(&quot;January&quot;);</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 197         assertEquals(MonthConstants.JANUARY, m);</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 198 </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 199         m = SerialDate.stringToMonthCode(&quot; January &quot;);</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 200         assertEquals(MonthConstants.JANUARY, m);</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 201 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 202         m = SerialDate.stringToMonthCode(&quot;Jan&quot;);</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 203         assertEquals(MonthConstants.JANUARY, m);</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 204 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 205     }</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 206 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 207     /**</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 208      * Tests the conversion of a month code to a string.</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 209      */</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 210     public void testMonthCodeToStringCode() {</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 211 </div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 212         final String test = SerialDate.monthCodeToString(MonthConstants.DECEMBER);</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 213         assertEquals(&quot;December&quot;, test);</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 214 </div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 215     }</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 216 </div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 217     /**</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 218      * 1900 is not a leap year.</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 219      */</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 220     public void testIsNotLeapYear1900() {</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 221         assertTrue(!SerialDate.isLeapYear(1900));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 222     }</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 223 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 224     /**</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 225      * 2000 is a leap year.</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 226      */</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 227     public void testIsLeapYear2000() {</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 228         assertTrue(SerialDate.isLeapYear(2000));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 229     }</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 230 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 231     /**</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 232      * The number of leap years from 1900 up-to-and-including 1899 is 0.</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 233      */</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 234     public void testLeapYearCount1899() {</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 235         assertEquals(SerialDate.leapYearCount(1899), 0);</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 236     }</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 237 </div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 238     /**</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 239      * The number of leap years from 1900 up-to-and-including 1903 is 0.</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 240      */</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 241     public void testLeapYearCount1903() {</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 242         assertEquals(SerialDate.leapYearCount(1903), 0);</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 243     }</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 244 </div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 245     /**</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 246      * The number of leap years from 1900 up-to-and-including 1904 is 1.</div><div class="t m9 xd hb2 y16a4 ffb fs18 fc0 sc0 ls0 ws0"> 247      */</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf191" class="pf w1 h2" data-page-no="191"><div class="pc pc191 w1 h2"><img class="bi xd ye27 wc hcb" alt="" src="bg191.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">370<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 248     public void testLeapYearCount1904() {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 249         assertEquals(SerialDate.leapYearCount(1904), 1);</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 250     }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 251 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 252     /**</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 253      * The number of leap years from 1900 up-to-and-including 1999 is 24.</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 254      */</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 255     public void testLeapYearCount1999() {</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 256         assertEquals(SerialDate.leapYearCount(1999), 24);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 257     }</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 258 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 259     /**</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 260      * The number of leap years from 1900 up-to-and-including 2000 is 25.</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 261      */</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 262     public void testLeapYearCount2000() {</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 263         assertEquals(SerialDate.leapYearCount(2000), 25);</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 264     }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 265 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 266     /**</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 267      * Serialize an instance, restore it, and check for equality.</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 268      */</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 269     public void testSerialization() {</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 270 </div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 271         SerialDate d1 = SerialDate.createInstance(15, 4, 2000);</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 272         SerialDate d2 = null;</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 273 </div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 274         try {</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 275             ByteArrayOutputStream buffer = new ByteArrayOutputStream();</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 276             ObjectOutput out = new ObjectOutputStream(buffer);</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 277             out.writeObject(d1);</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 278             out.close();</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 279 </div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 280             ObjectInput in = new ObjectInputStream(</div><div class="t m9 x18 hb2 y1687 ffb fs18 fc0 sc0 ls9d ws7db">                   new ByteArrayInputStream(buffer.toByteArray()));</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 281             d2 = (SerialDate) in.readObject();</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 282             in.close();</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 283         }</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 284         catch (Exception e) {</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 285             System.out.println(e.toString());</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 286         }</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 287         assertEquals(d1, d2);</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 288 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 289     }</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 290</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 291     /**</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 292      * A test for bug report 1096282 (now fixed).</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 293      */</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 294     public void test1096282() {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 295         SerialDate d = SerialDate.createInstance(29, 2, 2004);</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 296         d = SerialDate.addYears(1, d);</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 297         SerialDate expected = SerialDate.createInstance(28, 2, 2005);</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 298         assertTrue(d.isOn(expected));</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 299     }</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 300 </div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 301     /**</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 302      * Miscellaneous tests for the addMonths() method.</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 303      */</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 304     public void testAddMonths() {</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 305         SerialDate d1 = SerialDate.createInstance(31, 5, 2004);</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 306</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf192" class="pf w1 h2" data-page-no="192"><div class="pc pc192 w1 h2"><img class="bi xd y16a5 wc hcc" alt="" src="bg192.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">371<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 307         SerialDate d2 = SerialDate.addMonths(1, d1);</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 308         assertEquals(30, d2.getDayOfMonth());</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 309         assertEquals(6, d2.getMonth());</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 310         assertEquals(2004, d2.getYYYY());</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 311</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 312         SerialDate d3 = SerialDate.addMonths(2, d1);</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 313         assertEquals(31, d3.getDayOfMonth());</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 314         assertEquals(7, d3.getMonth());</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 315         assertEquals(2004, d3.getYYYY());</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 316</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 317         SerialDate d4 = SerialDate.addMonths(1, SerialDate.addMonths(1, d1));</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 318         assertEquals(30, d4.getDayOfMonth());</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 319         assertEquals(7, d4.getMonth());</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 320         assertEquals(2004, d4.getYYYY());</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 321     }</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 322 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-2 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf193" class="pf w1 h2" data-page-no="193"><div class="pc pc193 w1 h2"><img class="bi xd ye86 wc hcd" alt="" src="bg193.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">372<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-3 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">MonthConstants.java</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6  * </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7  * Project Info:  http://www.jfree.org/jcommon/index.html</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8  *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9  * This library is free software; you can redistribute it and/or modify it </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10  * under the terms of the GNU Lesser General Public License as published by </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11  * the Free Software Foundation; either version 2.1 of the License, or </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12  * (at your option) any later version.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13  *</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14  * This library is distributed in the hope that it will be useful, but </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15  * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16  * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17  * License for more details.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18  *</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19  * You should have received a copy of the GNU Lesser General Public</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20  * License along with this library; if not, write to the Free Software</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22  * USA.</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23  *</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24  * [Java is a trademark or registered trademark of Sun Microsystems, Inc. </div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25  * in the United States and other countries.]</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26  *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27  * -------------------</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28  * MonthConstants.java</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29  * -------------------</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30  * (C) Copyright 2002, 2003, by Object Refinery Limited.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31  *</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32  * Original Author:  David Gilbert (for Object Refinery Limited);</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33  * Contributor(s):   -;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34  *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35  * $Id: MonthConstants.java,v 1.4 2005/11/16 15:58:40 taqua Exp $</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36  *</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37  * Changes</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38  * -------</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39  * 29-May-2002 : Version 1 (code moved from SerialDate class) (DG);</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40  *</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41  */</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43 package org.jfree.date;</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44 </div><div class="t m9 xd hb2 y16a6 ffb fs18 fc0 sc0 ls0 ws0">  45 /**</div><div class="t m9 xd hb2 y16a7 ffb fs18 fc0 sc0 ls0 ws0">  46  * Useful constants for months.  Note that these are NOT equivalent to the</div><div class="t m9 xd hb2 y16a8 ffb fs18 fc0 sc0 ls0 ws0">  47  * constants defined by java.util.Calendar (where JANUARY=0 and DECEMBER=11).</div><div class="t m9 xd hb2 y16a9 ffb fs18 fc0 sc0 ls0 ws0">  48  * &lt;P&gt;</div><div class="t m9 xd hb2 y16aa ffb fs18 fc0 sc0 ls0 ws0">  49  * Used by the SerialDate and RegularTimePeriod classes.</div><div class="t m9 xd hb2 y16ab ffb fs18 fc0 sc0 ls0 ws0">  50  *</div><div class="t m9 xd hb2 y16ac ffb fs18 fc0 sc0 ls0 ws0">  51  * @author David Gilbert</div><div class="t m9 xd hb2 y16ad ffb fs18 fc0 sc0 ls0 ws0">  52  */</div><div class="t m9 xd hb2 y16ae ffb fs18 fc0 sc0 ls0 ws0">  53 public interface MonthConstants {</div><div class="t m9 xd hb2 y16af ffb fs18 fc0 sc0 ls0 ws0">  54 </div><div class="t m9 xd hb2 y16b0 ffb fs18 fc0 sc0 ls0 ws0">  55     /** Constant for January. */</div><div class="t m9 xd hb2 y16b1 ffb fs18 fc0 sc0 ls0 ws0">  56     public static final int JANUARY = 1;</div><div class="t m9 xd hb2 y16b2 ffb fs18 fc0 sc0 ls0 ws0">  57 </div><div class="t m9 xd hb2 y16b3 ffb fs18 fc0 sc0 ls0 ws0">  58     /** Constant for February. */</div><div class="t m9 xd hb2 y16b4 ffb fs18 fc0 sc0 ls0 ws0">  59     public static final int FEBRUARY = 2;</div><div class="t m9 xd hb2 y16b5 ffb fs18 fc0 sc0 ls0 ws0">  60 </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf194" class="pf w1 h2" data-page-no="194"><div class="pc pc194 w1 h2"><img class="bi xd y16b6 wc hce" alt="" src="bg194.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">373<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  61     /** Constant for March. */</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  62     public static final int MARCH = 3;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  63 </div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  64     /** Constant for April. */</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  65     public static final int APRIL = 4;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  66 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  67     /** Constant for May. */</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  68     public static final int MAY = 5;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  69 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  70     /** Constant for June. */</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  71     public static final int JUNE = 6;</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  72 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  73     /** Constant for July. */</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  74     public static final int JULY = 7;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  75 </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  76     /** Constant for August. */</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  77     public static final int AUGUST = 8;</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  78 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  79     /** Constant for September. */</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  80     public static final int SEPTEMBER = 9;</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  81 </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  82     /** Constant for October. */</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  83     public static final int OCTOBER = 10;</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  84 </div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  85     /** Constant for November. */</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  86     public static final int NOVEMBER = 11;</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  87 </div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  88     /** Constant for December. */</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  89     public static final int DECEMBER = 12;</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  90 </div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  91 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-3 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">MonthConstants.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf195" class="pf w1 h2" data-page-no="195"><div class="pc pc195 w1 h2"><img class="bi xd y16b7 wc hcf" alt="" src="bg195.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">374<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date.junit;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 import junit.framework.TestCase;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4 import org.jfree.date.*;</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 import static org.jfree.date.SerialDate.*;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7 import java.util.*;</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9 public class BobsSerialDateTest extends TestCase {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10 </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11   public void testIsValidWeekdayCode() throws Exception {</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12     for (int day = 1; day &lt;= 7; day++)</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13       assertTrue(isValidWeekdayCode(day));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14     assertFalse(isValidWeekdayCode(0));</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15     assertFalse(isValidWeekdayCode(8));</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16   }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   public void testStringToWeekdayCode() throws Exception {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19 </div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20     assertEquals(-1, stringToWeekdayCode(&quot;Hello&quot;));</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21     assertEquals(MONDAY, stringToWeekdayCode(&quot;Monday&quot;));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22     assertEquals(MONDAY, stringToWeekdayCode(&quot;Mon&quot;));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23 //todo    assertEquals(MONDAY,stringToWeekdayCode(&quot;monday&quot;));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24 //    assertEquals(MONDAY,stringToWeekdayCode(&quot;MONDAY&quot;));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25 //    assertEquals(MONDAY, stringToWeekdayCode(&quot;mon&quot;));</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26 </div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27     assertEquals(TUESDAY, stringToWeekdayCode(&quot;Tuesday&quot;));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28     assertEquals(TUESDAY, stringToWeekdayCode(&quot;Tue&quot;));</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29 //    assertEquals(TUESDAY,stringToWeekdayCode(&quot;tuesday&quot;));</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30 //    assertEquals(TUESDAY,stringToWeekdayCode(&quot;TUESDAY&quot;));</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31 //    assertEquals(TUESDAY, stringToWeekdayCode(&quot;tue&quot;));</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32 //    assertEquals(TUESDAY, stringToWeekdayCode(&quot;tues&quot;));</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34     assertEquals(WEDNESDAY, stringToWeekdayCode(&quot;Wednesday&quot;));</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35     assertEquals(WEDNESDAY, stringToWeekdayCode(&quot;Wed&quot;));</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36 //    assertEquals(WEDNESDAY,stringToWeekdayCode(&quot;wednesday&quot;));</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37 //    assertEquals(WEDNESDAY,stringToWeekdayCode(&quot;WEDNESDAY&quot;));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38 //    assertEquals(WEDNESDAY, stringToWeekdayCode(&quot;wed&quot;));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40     assertEquals(THURSDAY, stringToWeekdayCode(&quot;Thursday&quot;));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41     assertEquals(THURSDAY, stringToWeekdayCode(&quot;Thu&quot;));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42 //    assertEquals(THURSDAY,stringToWeekdayCode(&quot;thursday&quot;));</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43 //    assertEquals(THURSDAY,stringToWeekdayCode(&quot;THURSDAY&quot;));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44 //    assertEquals(THURSDAY, stringToWeekdayCode(&quot;thu&quot;));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45 //    assertEquals(THURSDAY, stringToWeekdayCode(&quot;thurs&quot;));</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47     assertEquals(FRIDAY, stringToWeekdayCode(&quot;Friday&quot;));</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48     assertEquals(FRIDAY, stringToWeekdayCode(&quot;Fri&quot;));</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49 //    assertEquals(FRIDAY,stringToWeekdayCode(&quot;friday&quot;));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50 //    assertEquals(FRIDAY,stringToWeekdayCode(&quot;FRIDAY&quot;));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51 //    assertEquals(FRIDAY, stringToWeekdayCode(&quot;fri&quot;));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52 </div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53     assertEquals(SATURDAY, stringToWeekdayCode(&quot;Saturday&quot;));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54     assertEquals(SATURDAY, stringToWeekdayCode(&quot;Sat&quot;));</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  55 //    assertEquals(SATURDAY,stringToWeekdayCode(&quot;saturday&quot;));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  56 //    assertEquals(SATURDAY,stringToWeekdayCode(&quot;SATURDAY&quot;));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  57 //    assertEquals(SATURDAY, stringToWeekdayCode(&quot;sat&quot;));</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  58 </div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  59     assertEquals(SUNDAY, stringToWeekdayCode(&quot;Sunday&quot;));</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  60     assertEquals(SUNDAY, stringToWeekdayCode(&quot;Sun&quot;));</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  61 //    assertEquals(SUNDAY,stringToWeekdayCode(&quot;sunday&quot;));</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  62 //    assertEquals(SUNDAY,stringToWeekdayCode(&quot;SUNDAY&quot;));</div><div class="t m9 xd hb2 y16a4 ffb fs18 fc0 sc0 ls0 ws0">  63 //    assertEquals(SUNDAY, stringToWeekdayCode(&quot;sun&quot;));</div><div class="t m9 xd hb2 y16b8 ffb fs18 fc0 sc0 ls0 ws0">  64   }</div><div class="t m9 xd hb2 y16b9 ffb fs18 fc0 sc0 ls0 ws0">  65 </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf196" class="pf w1 h2" data-page-no="196"><div class="pc pc196 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg196.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">375<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  66   public void testWeekdayCodeToString() throws Exception {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  67     assertEquals(&quot;Sunday&quot;, weekdayCodeToString(SUNDAY));</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  68     assertEquals(&quot;Monday&quot;, weekdayCodeToString(MONDAY));</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  69     assertEquals(&quot;Tuesday&quot;, weekdayCodeToString(TUESDAY));</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  70     assertEquals(&quot;Wednesday&quot;, weekdayCodeToString(WEDNESDAY));</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  71     assertEquals(&quot;Thursday&quot;, weekdayCodeToString(THURSDAY));</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  72     assertEquals(&quot;Friday&quot;, weekdayCodeToString(FRIDAY));</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  73     assertEquals(&quot;Saturday&quot;, weekdayCodeToString(SATURDAY));</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  74   }</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  75 </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  76   public void testIsValidMonthCode() throws Exception {</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  77     for (int i = 1; i &lt;= 12; i++)</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  78       assertTrue(isValidMonthCode(i));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  79     assertFalse(isValidMonthCode(0));</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  80     assertFalse(isValidMonthCode(13));</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  81   }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  82 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  83   public void testMonthToQuarter() throws Exception {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  84     assertEquals(1, monthCodeToQuarter(JANUARY));</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  85     assertEquals(1, monthCodeToQuarter(FEBRUARY));</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  86     assertEquals(1, monthCodeToQuarter(MARCH));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  87     assertEquals(2, monthCodeToQuarter(APRIL));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  88     assertEquals(2, monthCodeToQuarter(MAY));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  89     assertEquals(2, monthCodeToQuarter(JUNE));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  90     assertEquals(3, monthCodeToQuarter(JULY));</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  91     assertEquals(3, monthCodeToQuarter(AUGUST));</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  92     assertEquals(3, monthCodeToQuarter(SEPTEMBER));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  93     assertEquals(4, monthCodeToQuarter(OCTOBER));</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  94     assertEquals(4, monthCodeToQuarter(NOVEMBER));</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  95     assertEquals(4, monthCodeToQuarter(DECEMBER));</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  96 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  97     try {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  98       monthCodeToQuarter(-1);</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  99       fail(&quot;Invalid Month Code should throw exception&quot;);</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 100     } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 101     }</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 102   }</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 103 </div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 104   public void testMonthCodeToString() throws Exception {</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 105     assertEquals(&quot;January&quot;, monthCodeToString(JANUARY));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 106     assertEquals(&quot;February&quot;, monthCodeToString(FEBRUARY));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 107     assertEquals(&quot;March&quot;, monthCodeToString(MARCH));</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 108     assertEquals(&quot;April&quot;, monthCodeToString(APRIL));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 109     assertEquals(&quot;May&quot;, monthCodeToString(MAY));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 110     assertEquals(&quot;June&quot;, monthCodeToString(JUNE));</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 111     assertEquals(&quot;July&quot;, monthCodeToString(JULY));</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 112     assertEquals(&quot;August&quot;, monthCodeToString(AUGUST));</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 113     assertEquals(&quot;September&quot;, monthCodeToString(SEPTEMBER));</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 114     assertEquals(&quot;October&quot;, monthCodeToString(OCTOBER));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 115     assertEquals(&quot;November&quot;, monthCodeToString(NOVEMBER));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 116     assertEquals(&quot;December&quot;, monthCodeToString(DECEMBER));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 117 </div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 118     assertEquals(&quot;Jan&quot;, monthCodeToString(JANUARY, true));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 119     assertEquals(&quot;Feb&quot;, monthCodeToString(FEBRUARY, true));</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 120     assertEquals(&quot;Mar&quot;, monthCodeToString(MARCH, true));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 121     assertEquals(&quot;Apr&quot;, monthCodeToString(APRIL, true));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 122     assertEquals(&quot;May&quot;, monthCodeToString(MAY, true));</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 123     assertEquals(&quot;Jun&quot;, monthCodeToString(JUNE, true));</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 124     assertEquals(&quot;Jul&quot;, monthCodeToString(JULY, true));</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 125     assertEquals(&quot;Aug&quot;, monthCodeToString(AUGUST, true));</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 126     assertEquals(&quot;Sep&quot;, monthCodeToString(SEPTEMBER, true));</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 127     assertEquals(&quot;Oct&quot;, monthCodeToString(OCTOBER, true));</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf197" class="pf w1 h2" data-page-no="197"><div class="pc pc197 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg197.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">376<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 128     assertEquals(&quot;Nov&quot;, monthCodeToString(NOVEMBER, true));</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 129     assertEquals(&quot;Dec&quot;, monthCodeToString(DECEMBER, true));</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 130 </div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 131     try {</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 132       monthCodeToString(-1);</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 133       fail(&quot;Invalid month code should throw exception&quot;);</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 134     } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 135     }</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 136 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 137   }</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 138 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 139   public void testStringToMonthCode() throws Exception {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 140     assertEquals(JANUARY,stringToMonthCode(&quot;1&quot;));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 141     assertEquals(FEBRUARY,stringToMonthCode(&quot;2&quot;));</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 142     assertEquals(MARCH,stringToMonthCode(&quot;3&quot;));</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 143     assertEquals(APRIL,stringToMonthCode(&quot;4&quot;));</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 144     assertEquals(MAY,stringToMonthCode(&quot;5&quot;));</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 145     assertEquals(JUNE,stringToMonthCode(&quot;6&quot;));</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 146     assertEquals(JULY,stringToMonthCode(&quot;7&quot;));</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 147     assertEquals(AUGUST,stringToMonthCode(&quot;8&quot;));</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 148     assertEquals(SEPTEMBER,stringToMonthCode(&quot;9&quot;));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 149     assertEquals(OCTOBER,stringToMonthCode(&quot;10&quot;));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 150     assertEquals(NOVEMBER, stringToMonthCode(&quot;11&quot;));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 151     assertEquals(DECEMBER,stringToMonthCode(&quot;12&quot;));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 152 </div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 153 //todo    assertEquals(-1, stringToMonthCode(&quot;0&quot;));</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 154 //    assertEquals(-1, stringToMonthCode(&quot;13&quot;));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 155 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 156     assertEquals(-1,stringToMonthCode(&quot;Hello&quot;));</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 157 </div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 158     for (int m = 1; m &lt;= 12; m++) {</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 159       assertEquals(m, stringToMonthCode(monthCodeToString(m, false)));</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 160       assertEquals(m, stringToMonthCode(monthCodeToString(m, true)));</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 161     }</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 162 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 163 //    assertEquals(1,stringToMonthCode(&quot;jan&quot;));</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 164 //    assertEquals(2,stringToMonthCode(&quot;feb&quot;));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 165 //    assertEquals(3,stringToMonthCode(&quot;mar&quot;));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 166 //    assertEquals(4,stringToMonthCode(&quot;apr&quot;));</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 167 //    assertEquals(5,stringToMonthCode(&quot;may&quot;));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 168 //    assertEquals(6,stringToMonthCode(&quot;jun&quot;));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 169 //    assertEquals(7,stringToMonthCode(&quot;jul&quot;));</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 170 //    assertEquals(8,stringToMonthCode(&quot;aug&quot;));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 171 //    assertEquals(9,stringToMonthCode(&quot;sep&quot;));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 172 //    assertEquals(10,stringToMonthCode(&quot;oct&quot;));</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 173 //    assertEquals(11,stringToMonthCode(&quot;nov&quot;));</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 174 //    assertEquals(12,stringToMonthCode(&quot;dec&quot;));</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 175 </div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 176 //    assertEquals(1,stringToMonthCode(&quot;JAN&quot;));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 177 //    assertEquals(2,stringToMonthCode(&quot;FEB&quot;));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 178 //    assertEquals(3,stringToMonthCode(&quot;MAR&quot;));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 179 //    assertEquals(4,stringToMonthCode(&quot;APR&quot;));</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 180 //    assertEquals(5,stringToMonthCode(&quot;MAY&quot;));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 181 //    assertEquals(6,stringToMonthCode(&quot;JUN&quot;));</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 182 //    assertEquals(7,stringToMonthCode(&quot;JUL&quot;));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 183 //    assertEquals(8,stringToMonthCode(&quot;AUG&quot;));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 184 //    assertEquals(9,stringToMonthCode(&quot;SEP&quot;));</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 185 //    assertEquals(10,stringToMonthCode(&quot;OCT&quot;));</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 186 //    assertEquals(11,stringToMonthCode(&quot;NOV&quot;));</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 187 //    assertEquals(12,stringToMonthCode(&quot;DEC&quot;));</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 188 </div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 189 //    assertEquals(1,stringToMonthCode(&quot;january&quot;));</div><div class="t m9 xd hb2 y16a4 ffb fs18 fc0 sc0 ls0 ws0"> 190 //    assertEquals(2,stringToMonthCode(&quot;february&quot;));</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf198" class="pf w1 h2" data-page-no="198"><div class="pc pc198 w1 h2"><img class="bi xd ybda wc h73" alt="" src="bg198.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">377<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 191 //    assertEquals(3,stringToMonthCode(&quot;march&quot;));</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 192 //    assertEquals(4,stringToMonthCode(&quot;april&quot;));</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 193 //    assertEquals(5,stringToMonthCode(&quot;may&quot;));</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 194 //    assertEquals(6,stringToMonthCode(&quot;june&quot;));</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 195 //    assertEquals(7,stringToMonthCode(&quot;july&quot;));</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 196 //    assertEquals(8,stringToMonthCode(&quot;august&quot;));</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 197 //    assertEquals(9,stringToMonthCode(&quot;september&quot;));</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 198 //    assertEquals(10,stringToMonthCode(&quot;october&quot;));</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 199 //    assertEquals(11,stringToMonthCode(&quot;november&quot;));</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 200 //    assertEquals(12,stringToMonthCode(&quot;december&quot;));</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 201 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 202 //    assertEquals(1,stringToMonthCode(&quot;JANUARY&quot;));</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 203 //    assertEquals(2,stringToMonthCode(&quot;FEBRUARY&quot;));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 204 //    assertEquals(3,stringToMonthCode(&quot;MAR&quot;));</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 205 //    assertEquals(4,stringToMonthCode(&quot;APRIL&quot;));</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 206 //    assertEquals(5,stringToMonthCode(&quot;MAY&quot;));</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 207 //    assertEquals(6,stringToMonthCode(&quot;JUNE&quot;));</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 208 //    assertEquals(7,stringToMonthCode(&quot;JULY&quot;));</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 209 //    assertEquals(8,stringToMonthCode(&quot;AUGUST&quot;));</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 210 //    assertEquals(9,stringToMonthCode(&quot;SEPTEMBER&quot;));</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 211 //    assertEquals(10,stringToMonthCode(&quot;OCTOBER&quot;));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 212 //    assertEquals(11,stringToMonthCode(&quot;NOVEMBER&quot;));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 213 //    assertEquals(12,stringToMonthCode(&quot;DECEMBER&quot;));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 214   }</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 215 </div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 216   public void testIsValidWeekInMonthCode() throws Exception {</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 217     for (int w = 0; w &lt;= 4; w++) {</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 218       assertTrue(isValidWeekInMonthCode(w));</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 219     }</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 220     assertFalse(isValidWeekInMonthCode(5));</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 221   }</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 222 </div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 223   public void testIsLeapYear() throws Exception {</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 224     assertFalse(isLeapYear(1900));</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 225     assertFalse(isLeapYear(1901));</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 226     assertFalse(isLeapYear(1902));</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 227     assertFalse(isLeapYear(1903));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 228     assertTrue(isLeapYear(1904));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 229     assertTrue(isLeapYear(1908));</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 230     assertFalse(isLeapYear(1955));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 231     assertTrue(isLeapYear(1964));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 232     assertTrue(isLeapYear(1980));</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 233     assertTrue(isLeapYear(2000));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 234     assertFalse(isLeapYear(2001));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 235     assertFalse(isLeapYear(2100));</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 236   }</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 237 </div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 238   public void testLeapYearCount() throws Exception {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 239     assertEquals(0, leapYearCount(1900));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 240     assertEquals(0, leapYearCount(1901));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 241     assertEquals(0, leapYearCount(1902));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 242     assertEquals(0, leapYearCount(1903));</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 243     assertEquals(1, leapYearCount(1904));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 244     assertEquals(1, leapYearCount(1905));</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 245     assertEquals(1, leapYearCount(1906));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 246     assertEquals(1, leapYearCount(1907));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 247     assertEquals(2, leapYearCount(1908));</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 248     assertEquals(24, leapYearCount(1999));</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 249     assertEquals(25, leapYearCount(2001));</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 250     assertEquals(49, leapYearCount(2101));</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 251     assertEquals(73, leapYearCount(2201));</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf199" class="pf w1 h2" data-page-no="199"><div class="pc pc199 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg199.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">378<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 252     assertEquals(97, leapYearCount(2301));</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 253     assertEquals(122, leapYearCount(2401));</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 254   }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 255 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 256   public void testLastDayOfMonth() throws Exception {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 257     assertEquals(31, lastDayOfMonth(JANUARY, 1901));</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 258     assertEquals(28, lastDayOfMonth(FEBRUARY, 1901));</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 259     assertEquals(31, lastDayOfMonth(MARCH, 1901));</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 260     assertEquals(30, lastDayOfMonth(APRIL, 1901));</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 261     assertEquals(31, lastDayOfMonth(MAY, 1901));</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 262     assertEquals(30, lastDayOfMonth(JUNE, 1901));</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 263     assertEquals(31, lastDayOfMonth(JULY, 1901));</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 264     assertEquals(31, lastDayOfMonth(AUGUST, 1901));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 265     assertEquals(30, lastDayOfMonth(SEPTEMBER, 1901));</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 266     assertEquals(31, lastDayOfMonth(OCTOBER, 1901));</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 267     assertEquals(30, lastDayOfMonth(NOVEMBER, 1901));</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 268     assertEquals(31, lastDayOfMonth(DECEMBER, 1901));</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 269     assertEquals(29, lastDayOfMonth(FEBRUARY, 1904));</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 270   }</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 271 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 272   public void testAddDays() throws Exception {</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 273     SerialDate newYears = d(1, JANUARY, 1900);</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 274     assertEquals(d(2, JANUARY, 1900), addDays(1, newYears));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 275     assertEquals(d(1, FEBRUARY, 1900), addDays(31, newYears));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 276     assertEquals(d(1, JANUARY, 1901), addDays(365, newYears));</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 277     assertEquals(d(31, DECEMBER, 1904), addDays(5 * 365, newYears));</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 278   }</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 279 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 280   private static SpreadsheetDate d(int day, int month, int year) {return new </div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">SpreadsheetDate(day, month, year);}</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 281 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 282   public void testAddMonths() throws Exception {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 283     assertEquals(d(1, FEBRUARY, 1900), addMonths(1, d(1, JANUARY, 1900)));</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 284     assertEquals(d(28, FEBRUARY, 1900), addMonths(1, d(31, JANUARY, 1900)));</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 285     assertEquals(d(28, FEBRUARY, 1900), addMonths(1, d(30, JANUARY, 1900)));</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 286     assertEquals(d(28, FEBRUARY, 1900), addMonths(1, d(29, JANUARY, 1900)));</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 287     assertEquals(d(28, FEBRUARY, 1900), addMonths(1, d(28, JANUARY, 1900)));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 288     assertEquals(d(27, FEBRUARY, 1900), addMonths(1, d(27, JANUARY, 1900)));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 289 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 290     assertEquals(d(30, JUNE, 1900), addMonths(5, d(31, JANUARY, 1900)));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 291     assertEquals(d(30, JUNE, 1901), addMonths(17, d(31, JANUARY, 1900)));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 292 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 293     assertEquals(d(29, FEBRUARY, 1904), addMonths(49, d(31, JANUARY, 1900)));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 294 </div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 295   }</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 296 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 297   public void testAddYears() throws Exception {</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 298     assertEquals(d(1, JANUARY, 1901), addYears(1, d(1, JANUARY, 1900)));</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 299     assertEquals(d(28, FEBRUARY, 1905), addYears(1, d(29, FEBRUARY, 1904)));</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 300     assertEquals(d(28, FEBRUARY, 1905), addYears(1, d(28, FEBRUARY, 1904)));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 301     assertEquals(d(28, FEBRUARY, 1904), addYears(1, d(28, FEBRUARY, 1903)));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 302   }</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 303 </div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 304   public void testGetPreviousDayOfWeek() throws Exception {</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 305     assertEquals(d(24, FEBRUARY, 2006), getPreviousDayOfWeek(FRIDAY, d(1, MARCH, 2006)));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 306     assertEquals(d(22, FEBRUARY, 2006), getPreviousDayOfWeek(WEDNESDAY, d(1, MARCH, 2006)));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 307     assertEquals(d(29, FEBRUARY, 2004), getPreviousDayOfWeek(SUNDAY, d(3, MARCH, 2004)));</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 308     assertEquals(d(29, DECEMBER, 2004), getPreviousDayOfWeek(WEDNESDAY, d(5, JANUARY, 2005)));</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 309 </div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 310     try {</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 311       getPreviousDayOfWeek(-1, d(1, JANUARY, 2006));</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 312       fail(&quot;Invalid day of week code should throw exception&quot;);</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19a" class="pf w1 h2" data-page-no="19a"><div class="pc pc19a w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg19a.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">379<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 313     } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 314     }</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 315   }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 316 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 317   public void testGetFollowingDayOfWeek() throws Exception {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws7dc"> 318 //    assertEquals(d(1, JANUARY, 2005),getFollowingDayOfWeek(SATURDAY, d(25, DECEMBER, 2004)));</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 319     assertEquals(d(1, JANUARY, 2005), getFollowingDayOfWeek(SATURDAY, d(26, DECEMBER, 2004)));</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 320     assertEquals(d(3, MARCH, 2004), getFollowingDayOfWeek(WEDNESDAY, d(28, FEBRUARY, 2004)));</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 321 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 322     try {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 323       getFollowingDayOfWeek(-1, d(1, JANUARY, 2006));</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 324       fail(&quot;Invalid day of week code should throw exception&quot;);</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 325     } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 326     }</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 327   }</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 328 </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 329   public void testGetNearestDayOfWeek() throws Exception {</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 330     assertEquals(d(16, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 331     assertEquals(d(16, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 332     assertEquals(d(16, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 333     assertEquals(d(16, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 334     assertEquals(d(23, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 335     assertEquals(d(23, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 336     assertEquals(d(23, APRIL, 2006), getNearestDayOfWeek(SUNDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 337 </div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 338 //todo    assertEquals(d(17, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 339     assertEquals(d(17, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 340     assertEquals(d(17, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 341     assertEquals(d(17, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 342     assertEquals(d(17, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 343     assertEquals(d(24, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 344     assertEquals(d(24, APRIL, 2006), getNearestDayOfWeek(MONDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 345 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 346 //    assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 347 //    assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 348     assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 349     assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 350     assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 351     assertEquals(d(18, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 352     assertEquals(d(25, APRIL, 2006), getNearestDayOfWeek(TUESDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 353 </div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 354 //    assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 355 //    assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 356 //    assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 357     assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 358     assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 359     assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 360     assertEquals(d(19, APRIL, 2006), getNearestDayOfWeek(WEDNESDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 361 </div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 362 //    assertEquals(d(13, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 363 //    assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 364 //    assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 365 //    assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 366     assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 367     assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 368     assertEquals(d(20, APRIL, 2006), getNearestDayOfWeek(THURSDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 369 </div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 370 //    assertEquals(d(14, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 371 //    assertEquals(d(14, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 372 //    assertEquals(d(21, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 373 //    assertEquals(d(21, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 374 //    assertEquals(d(21, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(20, APRIL, 2006)));</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19b" class="pf w1 h2" data-page-no="19b"><div class="pc pc19b w1 h2"><img class="bi xd ybda wc h73" alt="" src="bg19b.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">380<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 375     assertEquals(d(21, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 376     assertEquals(d(21, APRIL, 2006), getNearestDayOfWeek(FRIDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 377 </div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 378 //    assertEquals(d(15, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(16, APRIL, 2006)));</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 379 //    assertEquals(d(15, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(17, APRIL, 2006)));</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 380 //    assertEquals(d(15, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(18, APRIL, 2006)));</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 381 //    assertEquals(d(22, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(19, APRIL, 2006)));</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 382 //    assertEquals(d(22, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(20, APRIL, 2006)));</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 383 //    assertEquals(d(22, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(21, APRIL, 2006)));</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 384     assertEquals(d(22, APRIL, 2006), getNearestDayOfWeek(SATURDAY, d(22, APRIL, 2006)));</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 385 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 386     try {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 387       getNearestDayOfWeek(-1, d(1, JANUARY, 2006));</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 388       fail(&quot;Invalid day of week code should throw exception&quot;);</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 389     } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 390     }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 391   }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 392 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 393   public void testEndOfCurrentMonth() throws Exception {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 394     SerialDate d = SerialDate.createInstance(2);</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 395     assertEquals(d(31, JANUARY, 2006), d.getEndOfCurrentMonth(d(1, JANUARY, 2006)));</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 396     assertEquals(d(28, FEBRUARY, 2006), d.getEndOfCurrentMonth(d(1, FEBRUARY, 2006)));</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 397     assertEquals(d(31, MARCH, 2006), d.getEndOfCurrentMonth(d(1, MARCH, 2006)));</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 398     assertEquals(d(30, APRIL, 2006), d.getEndOfCurrentMonth(d(1, APRIL, 2006)));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 399     assertEquals(d(31, MAY, 2006), d.getEndOfCurrentMonth(d(1, MAY, 2006)));</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 400     assertEquals(d(30, JUNE, 2006), d.getEndOfCurrentMonth(d(1, JUNE, 2006)));</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 401     assertEquals(d(31, JULY, 2006), d.getEndOfCurrentMonth(d(1, JULY, 2006)));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 402     assertEquals(d(31, AUGUST, 2006), d.getEndOfCurrentMonth(d(1, AUGUST, 2006)));</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 403     assertEquals(d(30, SEPTEMBER, 2006), d.getEndOfCurrentMonth(d(1, SEPTEMBER, 2006)));</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 404     assertEquals(d(31, OCTOBER, 2006), d.getEndOfCurrentMonth(d(1, OCTOBER, 2006)));</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 405     assertEquals(d(30, NOVEMBER, 2006), d.getEndOfCurrentMonth(d(1, NOVEMBER, 2006)));</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 406     assertEquals(d(31, DECEMBER, 2006), d.getEndOfCurrentMonth(d(1, DECEMBER, 2006)));</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 407     assertEquals(d(29, FEBRUARY, 2008), d.getEndOfCurrentMonth(d(1, FEBRUARY, 2008)));</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 408   }</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 409 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 410   public void testWeekInMonthToString() throws Exception {</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 411     assertEquals(&quot;First&quot;,weekInMonthToString(FIRST_WEEK_IN_MONTH));</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 412     assertEquals(&quot;Second&quot;,weekInMonthToString(SECOND_WEEK_IN_MONTH));</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 413     assertEquals(&quot;Third&quot;,weekInMonthToString(THIRD_WEEK_IN_MONTH));</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 414     assertEquals(&quot;Fourth&quot;,weekInMonthToString(FOURTH_WEEK_IN_MONTH));</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 415     assertEquals(&quot;Last&quot;,weekInMonthToString(LAST_WEEK_IN_MONTH));</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 416 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 417 //todo    try {</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 418 //      weekInMonthToString(-1);</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 419 //      fail(&quot;Invalid week code should throw exception&quot;);</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 420 //    } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 421 //    }</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 422   }</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 423 </div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 424   public void testRelativeToString() throws Exception {</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 425     assertEquals(&quot;Preceding&quot;,relativeToString(PRECEDING));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 426     assertEquals(&quot;Nearest&quot;,relativeToString(NEAREST));</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 427     assertEquals(&quot;Following&quot;,relativeToString(FOLLOWING));</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 428 </div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 429 //todo    try {</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 430 //      relativeToString(-1000);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 431 //      fail(&quot;Invalid relative code should throw exception&quot;);</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 432 //    } catch (IllegalArgumentException e) {</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 433 //    }</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 434   }</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 435 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19c" class="pf w1 h2" data-page-no="19c"><div class="pc pc19c w1 h2"><img class="bi xd y16ba wc hd0" alt="" src="bg19c.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">381<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 436   public void testCreateInstanceFromDDMMYYY() throws Exception {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 437     SerialDate date = createInstance(1, JANUARY, 1900);</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 438     assertEquals(1,date.getDayOfMonth());</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 439     assertEquals(JANUARY,date.getMonth());</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 440     assertEquals(1900,date.getYYYY());</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 441     assertEquals(2,date.toSerial());</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 442   }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 443 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 444   public void testCreateInstanceFromSerial() throws Exception {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 445     assertEquals(d(1, JANUARY, 1900),createInstance(2));</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 446     assertEquals(d(1, JANUARY, 1901), createInstance(367));</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 447   }</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 448 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 449   public void testCreateInstanceFromJavaDate() throws Exception {</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 450     assertEquals(d(1, JANUARY, 1900), </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls9f ws7d9">                      createInstance(new GregorianCalendar(1900,0,1).getTime()));</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 451     assertEquals(d(1, JANUARY, 2006), </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls9f ws7d9">                      createInstance(new GregorianCalendar(2006,0,1).getTime()));</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 452   }</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 453 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 454   public static void main(String[] args) {</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 455     junit.textui.TestRunner.run(BobsSerialDateTest.class);</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 456   }</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 457 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-4 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">BobsSerialDateTest.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19d" class="pf w1 h2" data-page-no="19d"><div class="pc pc19d w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg19d.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">382<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9c ws7d9">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6  *</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7  * Project Info:  http://www.jfree.org/jcommon/index.html</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8  *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9  * This library is free software; you can redistribute it and/or modify it</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10  * under the terms of the GNU Lesser General Public License as published by</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11  * the Free Software Foundation; either version 2.1 of the License, or</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12  * (at your option) any later version.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13  *</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14  * This library is distributed in the hope that it will be useful, but</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15  * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16  * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17  * License for more details.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18  *</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19  * You should have received a copy of the GNU Lesser General Public</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20  * License along with this library; if not, write to the Free Software</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22  * USA.</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23  *</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24  * [Java is a trademark or registered trademark of Sun Microsystems, Inc.</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25  * in the United States and other countries.]</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26  *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27  * --------------------</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28  * SpreadsheetDate.java</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29  * --------------------</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31  *</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32  * Original Author:  David Gilbert (for Object Refinery Limited);</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33  * Contributor(s):   -;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34  *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35  * $Id: SpreadsheetDate.java,v 1.8 2005/11/03 09:25:39 mungady Exp $</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36  *</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37  * Changes</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38  * -------</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39  * 11-Oct-2001 : Version 1 (DG);</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40  * 05-Nov-2001 : Added getDescription() and setDescription() methods (DG);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41  * 12-Nov-2001 : Changed name from ExcelDate.java to SpreadsheetDate.java (DG);</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42  *               Fixed a bug in calculating day, month and year from serial</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43  *               number (DG);</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44  * 24-Jan-2002 : Fixed a bug in calculating the serial number from the day,</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45  *               month and year.  Thanks to Trevor Hills for the report (DG);</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46  * 29-May-2002 : Added equals(Object) method (SourceForge ID 558850) (DG);</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47  * 03-Oct-2002 : Fixed errors reported by Checkstyle (DG);</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48  * 13-Mar-2003 : Implemented Serializable (DG);</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49  * 04-Sep-2003 : Completed isInRange() methods (DG);</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50  * 05-Sep-2003 : Implemented Comparable (DG);</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51  * 21-Oct-2003 : Added hashCode() method (DG);</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52  *</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53  */</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54 </div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  55 package org.jfree.date;</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  56 </div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  57 import java.util.Calendar;</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  58 import java.util.Date;</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  59 </div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  60 /**</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  61  * Represents a date using an integer, in a similar fashion to the</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  62  * implementation in Microsoft Excel.  The range of dates supported is</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19e" class="pf w1 h2" data-page-no="19e"><div class="pc pc19e w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg19e.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">383<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  63  * 1-Jan-1900 to 31-Dec-9999.</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  64  * &lt;P&gt;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  65  * Be aware that there is a deliberate bug in Excel that recognises the year</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  66  * 1900 as a leap year when in fact it is not a leap year. You can find more</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  67  * information on the Microsoft website in article Q181370:</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  68  * &lt;P&gt;</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  69  * http://support.microsoft.com/support/kb/articles/Q181/3/70.asp</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  70  * &lt;P&gt;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  71  * Excel uses the convention that 1-Jan-1900 = 1.  This class uses the</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  72  * convention 1-Jan-1900 = 2.</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  73  * The result is that the day number in this class will be different to the</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  74  * Excel figure for January and February 1900...but then Excel adds in an extra</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  75  * day (29-Feb-1900 which does not actually exist!) and from that point forward</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  76  * the day numbers will match.</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  77  *</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  78  * @author David Gilbert</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  79  */</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  80 public class SpreadsheetDate extends SerialDate {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  81 </div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  82     /** For serialization. */</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  83     private static final long serialVersionUID = -2039586705374454461L;</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  84 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  85     /**</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  86      * The day number (1-Jan-1900 = 2, 2-Jan-1900 = 3, ..., 31-Dec-9999 =</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  87      * 2958465).</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  88      */</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  89     private int serial;</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  90 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  91     /** The day of the month (1 to 28, 29, 30 or 31 depending on the month). */</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  92     private int day;</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  93 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  94     /** The month of the year (1 to 12). */</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  95     private int month;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  96 </div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  97     /** The year (1900 to 9999). */</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  98     private int year;</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  99 </div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 100     /** An optional description for the date. */</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 101     private String description;</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 102 </div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 103     /**</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 104      * Creates a new date instance.</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 105      *</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 106      * @param day  the day (in the range 1 to 28/29/30/31).</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 107      * @param month  the month (in the range 1 to 12).</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 108      * @param year  the year (in the range 1900 to 9999).</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 109      */</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 110     public SpreadsheetDate(final int day, final int month, final int year) {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 111 </div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 112         if ((year &gt;= 1900) &amp;&amp; (year &lt;= 9999)) {</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 113             this.year = year;</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 114         }</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 115         else {</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 116             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 117                 &quot;The &apos;year&apos; argument must be in range 1900 to 9999.&quot;</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 118             );</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 119         }</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 120 </div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 121         if ((month &gt;= MonthConstants.JANUARY)</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 122                 &amp;&amp; (month &lt;= MonthConstants.DECEMBER)) {</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 123             this.month = month;</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 124         }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf19f" class="pf w1 h2" data-page-no="19f"><div class="pc pc19f w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg19f.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">384<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 125         else {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 126             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 127                 &quot;The &apos;month&apos; argument must be in the range 1 to 12.&quot;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 128             );</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 129         }</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 130 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 131         if ((day &gt;= 1) &amp;&amp; (day &lt;= SerialDate.lastDayOfMonth(month, year))) {</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 132             this.day = day;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 133         }</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 134         else {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 135             throw new IllegalArgumentException(&quot;Invalid &apos;day&apos; argument.&quot;);</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 136         }</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 137 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 138         // the serial number needs to be synchronised with the day-month-year...</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 139         this.serial = calcSerial(day, month, year);</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 140 </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 141         this.description = null;</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 142 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 143     }</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 144 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 145     /**</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 146      * Standard constructor - creates a new date object representing the</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 147      * specified day number (which should be in the range 2 to 2958465.</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 148      *</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 149      * @param serial  the serial number for the day (range: 2 to 2958465).</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 150      */</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 151     public SpreadsheetDate(final int serial) {</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 152 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 153         if ((serial &gt;= SERIAL_LOWER_BOUND) &amp;&amp; (serial &lt;= SERIAL_UPPER_BOUND)) {</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 154             this.serial = serial;</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 155         }</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 156         else {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 157             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 158                 &quot;SpreadsheetDate: Serial must be in range 2 to 2958465.&quot;);</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 159         }</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 160 </div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 161         // the day-month-year needs to be synchronised with the serial number...</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 162         calcDayMonthYear();</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 163 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 164     }</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 165 </div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 166     /**</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 167      * Returns the description that is attached to the date.  It is not</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 168      * required that a date have a description, but for some applications it</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 169      * is useful.</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 170      *</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 171      * @return The description that is attached to the date.</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 172      */</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 173     public String getDescription() {</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 174         return this.description;</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 175     }</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 176 </div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 177     /**</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 178      * Sets the description for the date.</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 179      *</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 180      * @param description  the description for this date (&lt;code&gt;null&lt;/code&gt;</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 181      *                     permitted).</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 182      */</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 183     public void setDescription(final String description) {</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 184         this.description = description;</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 185     }</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 186 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a0" class="pf w1 h2" data-page-no="1a0"><div class="pc pc1a0 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">385<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 187     /**</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 188      * Returns the serial number for the date, where 1 January 1900 = 2</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 189      * (this corresponds, almost, to the numbering system used in Microsoft</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 190      * Excel for Windows and Lotus 1-2-3).</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 191      *</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 192      * @return The serial number of this date.</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 193      */</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 194     public int toSerial() {</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 195         return this.serial;</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 196     }</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 197 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 198     /**</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 199      * Returns a &lt;code&gt;java.util.Date&lt;/code&gt; equivalent to this date.</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 200      *</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 201      * @return The date.</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 202      */</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 203     public Date toDate() {</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 204         final Calendar calendar = Calendar.getInstance();</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 205         calendar.set(getYYYY(), getMonth() - 1, getDayOfMonth(), 0, 0, 0);</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 206         return calendar.getTime();</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 207     }</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 208 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 209     /**</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 210      * Returns the year (assume a valid range of 1900 to 9999).</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 211      *</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 212      * @return The year.</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 213      */</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 214     public int getYYYY() {</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 215         return this.year;</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 216     }</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 217 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 218     /**</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 219      * Returns the month (January = 1, February = 2, March = 3).</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 220      *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 221      * @return The month of the year.</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 222      */</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 223     public int getMonth() {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 224         return this.month;</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 225     }</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 226 </div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 227     /**</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 228      * Returns the day of the month.</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 229      *</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 230      * @return The day of the month.</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 231      */</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 232     public int getDayOfMonth() {</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 233         return this.day;</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 234     }</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 235 </div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 236     /**</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 237      * Returns a code representing the day of the week.</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 238      * &lt;P&gt;</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 239      * The codes are defined in the {@link SerialDate} class as:</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 240      * &lt;code&gt;SUNDAY&lt;/code&gt;, &lt;code&gt;MONDAY&lt;/code&gt;, &lt;code&gt;TUESDAY&lt;/code&gt;,</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 241      * &lt;code&gt;WEDNESDAY&lt;/code&gt;, &lt;code&gt;THURSDAY&lt;/code&gt;, &lt;code&gt;FRIDAY&lt;/code&gt;, and</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 242      * &lt;code&gt;SATURDAY&lt;/code&gt;.</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 243      *</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 244      * @return A code representing the day of the week.</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 245      */</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 246     public int getDayOfWeek() {</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 247         return (this.serial + 6) % 7 + 1;</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 248     }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a1" class="pf w1 h2" data-page-no="1a1"><div class="pc pc1a1 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">386<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 249 </div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 250     /**</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 251      * Tests the equality of this date with an arbitrary object.</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 252      * &lt;P&gt;</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 253      * This method will return true ONLY if the object is an instance of the</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 254      * {@link SerialDate} base class, and it represents the same day as this</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 255      * {@link SpreadsheetDate}.</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 256      *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 257      * @param object  the object to compare (&lt;code&gt;null&lt;/code&gt; permitted).</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 258      *</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 259      * @return A boolean.</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 260      */</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 261     public boolean equals(final Object object) {</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 262 </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 263         if (object instanceof SerialDate) {</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 264             final SerialDate s = (SerialDate) object;</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 265             return (s.toSerial() == this.toSerial());</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 266         }</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 267         else {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 268             return false;</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 269         }</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 270 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 271     }</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 272 </div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 273     /**</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 274      * Returns a hash code for this object instance.</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 275      *</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 276      * @return A hash code.</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 277      */</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 278     public int hashCode() {</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 279         return toSerial();</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 280     }</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 281 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 282     /**</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 283      * Returns the difference (in days) between this date and the specified</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 284      * &apos;other&apos; date.</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 285      *</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 286      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 287      *</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 288      * @return The difference (in days) between this date and the specified</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 289      *         &apos;other&apos; date.</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 290      */</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 291     public int compare(final SerialDate other) {</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 292         return this.serial - other.toSerial();</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 293     }</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 294 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 295     /**</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 296      * Implements the method required by the Comparable interface.</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 297      *</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 298      * @param other  the other object (usually another SerialDate).</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 299      *</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 300      * @return A negative integer, zero, or a positive integer as this object</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 301      *         is less than, equal to, or greater than the specified object.</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 302      */</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 303     public int compareTo(final Object other) {</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 304         return compare((SerialDate) other);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 305     }</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 306 </div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 307     /**</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 308      * Returns true if this SerialDate represents the same date as the</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 309      * specified SerialDate.</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 310      *</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a2" class="pf w1 h2" data-page-no="1a2"><div class="pc pc1a2 w1 h2"><img class="bi xd y6a7 wc h43" alt="" src="bg1a2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">387<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 311      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 312      *</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 313      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date as</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 314      *         the specified SerialDate.</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 315      */</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 316     public boolean isOn(final SerialDate other) {</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 317         return (this.serial == other.toSerial());</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 318     }</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 319 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 320     /**</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 321      * Returns true if this SerialDate represents an earlier date compared to</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 322      * the specified SerialDate.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 323      *</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 324      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 325      *</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 326      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents an earlier date</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 327      *         compared to the specified SerialDate.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 328      */</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 329     public boolean isBefore(final SerialDate other) {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 330         return (this.serial &lt; other.toSerial());</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 331     }</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 332 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 333     /**</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 334      * Returns true if this SerialDate represents the same date as the</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 335      * specified SerialDate.</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 336      *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 337      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 338      *</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 339      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 340      *         as the specified SerialDate.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 341      */</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 342     public boolean isOnOrBefore(final SerialDate other) {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 343         return (this.serial &lt;= other.toSerial());</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 344     }</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 345 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 346     /**</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 347      * Returns true if this SerialDate represents the same date as the</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 348      * specified SerialDate.</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 349      *</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 350      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 351      *</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 352      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 353      *         as the specified SerialDate.</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 354      */</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 355     public boolean isAfter(final SerialDate other) {</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 356         return (this.serial &gt; other.toSerial());</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 357     }</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 358 </div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 359     /**</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 360      * Returns true if this SerialDate represents the same date as the</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 361      * specified SerialDate.</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 362      *</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 363      * @param other  the date being compared to.</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 364      *</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 365      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate represents the same date as</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 366      *         the specified SerialDate.</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 367      */</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 368     public boolean isOnOrAfter(final SerialDate other) {</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 369         return (this.serial &gt;= other.toSerial());</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 370     }</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 371 </div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 372     /**</div><div class="t m9 xd hb2 y16a4 ffb fs18 fc0 sc0 ls0 ws0"> 373      * Returns &lt;code&gt;true&lt;/code&gt; if this {@link SerialDate} is within the</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a3" class="pf w1 h2" data-page-no="1a3"><div class="pc pc1a3 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">388<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 374      * specified range (INCLUSIVE).  The date order of d1 and d2 is not</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 375      * important.</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 376      *</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 377      * @param d1  a boundary date for the range.</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 378      * @param d2  the other boundary date for the range.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 379      *</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 380      * @return A boolean.</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 381      */</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 382     public boolean isInRange(final SerialDate d1, final SerialDate d2) {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 383         return isInRange(d1, d2, SerialDate.INCLUDE_BOTH);</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 384     }</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 385 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 386     /**</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 387      * Returns true if this SerialDate is within the specified range (caller</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 388      * specifies whether or not the end-points are included).  The order of d1</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 389      * and d2 is not important.</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 390      *</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 391      * @param d1  one boundary date for the range.</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 392      * @param d2  a second boundary date for the range.</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 393      * @param include  a code that controls whether or not the start and end</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 394      *                 dates are included in the range.</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 395      *</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 396      * @return &lt;code&gt;true&lt;/code&gt; if this SerialDate is within the specified</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 397      *         range.</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 398      */</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 399     public boolean isInRange(final SerialDate d1, final SerialDate d2,</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 400                              final int include) {</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 401         final int s1 = d1.toSerial();</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 402         final int s2 = d2.toSerial();</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 403         final int start = Math.min(s1, s2);</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 404         final int end = Math.max(s1, s2);</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 405 </div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 406         final int s = toSerial();</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 407         if (include == SerialDate.INCLUDE_BOTH) {</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 408             return (s &gt;= start &amp;&amp; s &lt;= end);</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 409         }</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 410         else if (include == SerialDate.INCLUDE_FIRST) {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 411             return (s &gt;= start &amp;&amp; s &lt; end);</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 412         }</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 413         else if (include == SerialDate.INCLUDE_SECOND) {</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 414             return (s &gt; start &amp;&amp; s &lt;= end);</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 415         }</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 416         else {</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 417             return (s &gt; start &amp;&amp; s &lt; end);</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 418         }</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 419     }</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 420 </div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 421     /**</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 422      * Calculate the serial number from the day, month and year.</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 423      * &lt;P&gt;</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 424      * 1-Jan-1900 = 2.</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 425      *</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 426      * @param d  the day.</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 427      * @param m  the month.</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 428      * @param y  the year.</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 429      *</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 430      * @return the serial number from the day, month and year.</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 431      */</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 432     private int calcSerial(final int d, final int m, final int y) {</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 433         final int yy = ((y - 1900) * 365) + SerialDate.leapYearCount(y - 1);</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 434         int mm = SerialDate.AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH[m];</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 435         if (m &gt; MonthConstants.FEBRUARY) {</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a4" class="pf w1 h2" data-page-no="1a4"><div class="pc pc1a4 w1 h2"><img class="bi xd y6b8 wc h45" alt="" src="bg1a4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">389<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 436             if (SerialDate.isLeapYear(y)) {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 437                 mm = mm + 1;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 438             }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 439         }</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 440         final int dd = d;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 441         return yy + mm + dd + 1;</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 442     }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 443 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 444     /**</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 445      * Calculate the day, month and year from the serial number.</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 446      */</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 447     private void calcDayMonthYear() {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 448 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 449         // get the year from the serial date</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 450         final int days = this.serial - SERIAL_LOWER_BOUND;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 451         // overestimated because we ignored leap days</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 452         final int overestimatedYYYY = 1900 + (days / 365);</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 453         final int leaps = SerialDate.leapYearCount(overestimatedYYYY);</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 454         final int nonleapdays = days - leaps;</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 455         // underestimated because we overestimated years</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 456         int underestimatedYYYY = 1900 + (nonleapdays / 365);</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 457 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 458         if (underestimatedYYYY == overestimatedYYYY) {</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 459             this.year = underestimatedYYYY;</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 460         }</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 461         else {</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 462             int ss1 = calcSerial(1, 1, underestimatedYYYY);</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 463             while (ss1 &lt;= this.serial) {</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 464                 underestimatedYYYY = underestimatedYYYY + 1;</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 465                 ss1 = calcSerial(1, 1, underestimatedYYYY);</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 466             }</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 467             this.year = underestimatedYYYY - 1;</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 468         }</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 469 </div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 470         final int ss2 = calcSerial(1, 1, this.year);</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 471 </div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 472         int[] daysToEndOfPrecedingMonth</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 473             = AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH;</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 474 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 475         if (isLeapYear(this.year)) {</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 476             daysToEndOfPrecedingMonth</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 477                 = LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH;</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 478         }</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 479 </div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 480         // get the month from the serial date</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 481         int mm = 1;</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 482         int sss = ss2 + daysToEndOfPrecedingMonth[mm] - 1;</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 483         while (sss &lt; this.serial) {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 484             mm = mm + 1;</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 485             sss = ss2 + daysToEndOfPrecedingMonth[mm] - 1;</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 486         }</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 487         this.month = mm - 1;</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 488 </div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 489         // what&apos;s left is d(+1);</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 490         this.day = this.serial - ss2</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 491                    - daysToEndOfPrecedingMonth[this.month] + 1;</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 492 </div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 493     }</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 494 </div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 495 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-5 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a5" class="pf w1 h2" data-page-no="1a5"><div class="pc pc1a5 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">390<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-6 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">RelativeDayOfWeekRule.java</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9c ws7d9">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6  *</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7  * Project Info:  http://www.jfree.org/jcommon/index.html</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8  *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9  * This library is free software; you can redistribute it and/or modify it</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10  * under the terms of the GNU Lesser General Public License as published by</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11  * the Free Software Foundation; either version 2.1 of the License, or</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12  * (at your option) any later version.</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13  *</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14  * This library is distributed in the hope that it will be useful, but</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15  * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16  * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17  * License for more details.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18  *</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19  * You should have received a copy of the GNU Lesser General Public</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20  * License along with this library; if not, write to the Free Software</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22  * USA.</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23  *</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24  * [Java is a trademark or registered trademark of Sun Microsystems, Inc.</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25  * in the United States and other countries.]</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26  *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27  * --------------------------</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28  * RelativeDayOfWeekRule.java</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29  * --------------------------</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30  * (C) Copyright 2000-2003, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31  *</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32  * Original Author:  David Gilbert (for Object Refinery Limited);</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33  * Contributor(s):   -;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34  *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35  * $Id: RelativeDayOfWeekRule.java,v 1.6 2005/11/16 15:58:40 taqua Exp $</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36  *</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37  * Changes (from 26-Oct-2001)</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38  * --------------------------</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39  * 26-Oct-2001 : Changed package to com.jrefinery.date.*;</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40  * 03-Oct-2002 : Fixed errors reported by Checkstyle (DG);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41  *</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42  */</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43 </div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44 package org.jfree.date;</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45 </div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46 /**</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47  * An annual date rule that returns a date for each year based on (a) a</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48  * reference rule; (b) a day of the week; and (c) a selection parameter</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49  * (SerialDate.PRECEDING, SerialDate.NEAREST, SerialDate.FOLLOWING).</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50  * &lt;P&gt;</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51  * For example, Good Friday can be specified as &apos;the Friday PRECEDING Easter</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52  * Sunday&apos;.</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53  *</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54  * @author David Gilbert</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  55  */</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  56 public class RelativeDayOfWeekRule extends AnnualDateRule {</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  57 </div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  58     /** A reference to the annual date rule on which this rule is based. */</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  59     private AnnualDateRule subrule;</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  60 </div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  61     /**</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  62      * The day of the week (SerialDate.MONDAY, SerialDate.TUESDAY, and so on).</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a6" class="pf w1 h2" data-page-no="1a6"><div class="pc pc1a6 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a6.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">391<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  63      */</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  64     private int dayOfWeek;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  65 </div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  66     /** Specifies which day of the week (PRECEDING, NEAREST or FOLLOWING). */</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  67     private int relative;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  68 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  69     /**</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  70      * Default constructor - builds a rule for the Monday following 1 January.</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  71      */</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  72     public RelativeDayOfWeekRule() {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  73         this(new DayAndMonthRule(), SerialDate.MONDAY, SerialDate.FOLLOWING);</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  74     }</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  75 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  76     /**</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  77      * Standard constructor - builds rule based on the supplied sub-rule.</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  78      *</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  79      * @param subrule  the rule that determines the reference date.</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  80      * @param dayOfWeek  the day-of-the-week relative to the reference date.</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  81      * @param relative  indicates *which* day-of-the-week (preceding, nearest</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  82      *                  or following).</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  83      */</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  84     public RelativeDayOfWeekRule(final AnnualDateRule subrule,</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  85             final int dayOfWeek, final int relative) {</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  86         this.subrule = subrule;</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  87         this.dayOfWeek = dayOfWeek;</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  88         this.relative = relative;</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  89     }</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  90 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  91     /**</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  92      * Returns the sub-rule (also called the reference rule).</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  93      *</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  94      * @return The annual date rule that determines the reference date for this</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  95      *         rule.</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  96      */</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  97     public AnnualDateRule getSubrule() {</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  98         return this.subrule;</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  99     }</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 100 </div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 101     /**</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 102      * Sets the sub-rule.</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 103      *</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 104      * @param subrule  the annual date rule that determines the reference date</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 105      *                 for this rule.</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 106      */</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 107     public void setSubrule(final AnnualDateRule subrule) {</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 108         this.subrule = subrule;</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 109     }</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 110 </div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 111     /**</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 112      * Returns the day-of-the-week for this rule.</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 113      *</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 114      * @return the day-of-the-week for this rule.</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 115      */</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 116     public int getDayOfWeek() {</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 117         return this.dayOfWeek;</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 118     }</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 119 </div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 120     /**</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 121      * Sets the day-of-the-week for this rule.</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 122      *</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 123      * @param dayOfWeek  the day-of-the-week (SerialDate.MONDAY,</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 124      *                   SerialDate.TUESDAY, and so on).</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-6 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">RelativeDayOfWeekRule.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a7" class="pf w1 h2" data-page-no="1a7"><div class="pc pc1a7 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a7.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">392<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 125      */</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 126     public void setDayOfWeek(final int dayOfWeek) {</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 127         this.dayOfWeek = dayOfWeek;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 128     }</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 129 </div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 130     /**</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 131      * Returns the &apos;relative&apos; attribute, that determines *which*</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 132      * day-of-the-week we are interested in (SerialDate.PRECEDING,</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 133      * SerialDate.NEAREST or SerialDate.FOLLOWING).</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 134      *</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 135      * @return The &apos;relative&apos; attribute.</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 136      */</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 137     public int getRelative() {</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 138         return this.relative;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 139     }</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 140 </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 141     /**</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 142      * Sets the &apos;relative&apos; attribute (SerialDate.PRECEDING, SerialDate.NEAREST,</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 143      * SerialDate.FOLLOWING).</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 144      *</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 145      * @param relative  determines *which* day-of-the-week is selected by this</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 146      *                  rule.</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 147      */</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 148     public void setRelative(final int relative) {</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 149         this.relative = relative;</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 150     }</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 151 </div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 152     /**</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 153      * Creates a clone of this rule.</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 154      *</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 155      * @return a clone of this rule.</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 156      *</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 157      * @throws CloneNotSupportedException this should never happen.</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 158      */</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 159     public Object clone() throws CloneNotSupportedException {</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 160         final RelativeDayOfWeekRule duplicate</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 161             = (RelativeDayOfWeekRule) super.clone();</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 162         duplicate.subrule = (AnnualDateRule) duplicate.getSubrule().clone();</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 163         return duplicate;</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 164     }</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 165 </div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 166     /**</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 167      * Returns the date generated by this rule, for the specified year.</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 168      *</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 169      * @param year  the year (1900 &amp;lt;= year &amp;lt;= 9999).</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 170      *</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 171      * @return The date generated by the rule for the given year (possibly</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 172      *         &lt;code&gt;null&lt;/code&gt;).</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 173      */</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 174     public SerialDate getDate(final int year) {</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 175 </div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 176         // check argument...</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 177         if ((year &lt; SerialDate.MINIMUM_YEAR_SUPPORTED)</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 178             || (year &gt; SerialDate.MAXIMUM_YEAR_SUPPORTED)) {</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 179             throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 180                 &quot;RelativeDayOfWeekRule.getDate(): year outside valid range.&quot;);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 181         }</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 182 </div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 183         // calculate the date...</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 184         SerialDate result = null;</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 185         final SerialDate base = this.subrule.getDate(year);</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 186 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-6 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">RelativeDayOfWeekRule.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a8" class="pf w1 h2" data-page-no="1a8"><div class="pc pc1a8 w1 h2"><img class="bi xd y16bb wc hd1" alt="" src="bg1a8.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">393<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 187         if (base != null) {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 188             switch (this.relative) {</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 189                 case(SerialDate.PRECEDING):</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 190                     result = SerialDate.getPreviousDayOfWeek(this.dayOfWeek,</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 191                             base);</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 192                     break;</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 193                 case(SerialDate.NEAREST):</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 194                     result = SerialDate.getNearestDayOfWeek(this.dayOfWeek,</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 195                             base);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 196                     break;</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 197                 case(SerialDate.FOLLOWING):</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 198                     result = SerialDate.getFollowingDayOfWeek(this.dayOfWeek,</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 199                             base);</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 200                     break;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 201                 default:</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 202                     break;</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 203             }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 204         }</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 205         return result;</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 206 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 207     }</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 208 </div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 209 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-6 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">RelativeDayOfWeekRule.java</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1a9" class="pf w1 h2" data-page-no="1a9"><div class="pc pc1a9 w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1a9.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">394<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-7 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DayDate.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9c ws7d9">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   ...</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  36  */</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  37 package org.jfree.date;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  38 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  39 import java.io.Serializable;</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  40 import java.util.*;</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  41 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  42 /**</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  43  * An abstract class that represents immutable dates with a precision of</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  44  * one day.  The implementation will map each date to an integer that</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  45  * represents an ordinal number of days from some fixed origin.</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  46  *</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  47  * Why not just use java.util.Date?  We will, when it makes sense.  At times,</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  48  * java.util.Date can be *too* precise - it represents an instant in time,</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  49  * accurate to 1/1000th of a second (with the date itself depending on the</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  50  * time-zone).  Sometimes we just want to represent a particular day (e.g. 21</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  51  * January 2015) without concerning ourselves about the time of day, or the</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  52  * time-zone, or anything else.  That&apos;s what we&apos;ve defined DayDate for.</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  53  *</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  54  * Use DayDateFactory.makeDate to create an instance.</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  55  *</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  56  * @author David Gilbert</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  57  * @author Robert C. Martin did a lot of refactoring.</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  58  */</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  59 </div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  60 public abstract class DayDate implements Comparable, Serializable {</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  61   public abstract int getOrdinalDay();</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  62   public abstract int getYear();</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  63   public abstract Month getMonth();</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  64   public abstract int getDayOfMonth();</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  65 </div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  66   protected abstract Day getDayOfWeekForOrdinalZero();</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  67 </div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  68   public DayDate plusDays(int days) {</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  69     return DayDateFactory.makeDate(getOrdinalDay() + days);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  70   }</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  71 </div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  72   public DayDate plusMonths(int months) {</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  73     int thisMonthAsOrdinal = getMonth().toInt() - Month.JANUARY.toInt();</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  74     int thisMonthAndYearAsOrdinal = 12 * getYear() + thisMonthAsOrdinal;</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  75     int resultMonthAndYearAsOrdinal = thisMonthAndYearAsOrdinal + months;</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  76     int resultYear = resultMonthAndYearAsOrdinal / 12;</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  77     int resultMonthAsOrdinal = resultMonthAndYearAsOrdinal % 12 + Month.JANUARY.toInt();</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  78     Month resultMonth = Month.fromInt(resultMonthAsOrdinal);</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  79     int resultDay = correctLastDayOfMonth(getDayOfMonth(), resultMonth, resultYear);</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  80     return DayDateFactory.makeDate(resultDay, resultMonth, resultYear);</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  81   }</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  82 </div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  83   public DayDate plusYears(int years) {</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  84     int resultYear = getYear() + years;</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  85     int resultDay = correctLastDayOfMonth(getDayOfMonth(), getMonth(), resultYear);</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  86     return DayDateFactory.makeDate(resultDay, getMonth(), resultYear);</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  87   }</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  88 </div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  89   private int correctLastDayOfMonth(int day, Month month, int year) {</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  90     int lastDayOfMonth = DateUtil.lastDayOfMonth(month, year);</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  91     if (day &gt; lastDayOfMonth)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1aa" class="pf w1 h2" data-page-no="1aa"><div class="pc pc1aa w1 h2"><img class="bi xd yf1e wc h97" alt="" src="bg1aa.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">395<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0">  92         day = lastDayOfMonth;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">  93     return day;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">  94   }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">  95 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">  96   public DayDate getPreviousDayOfWeek(Day targetDayOfWeek) {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">  97     int offsetToTarget = targetDayOfWeek.toInt() - getDayOfWeek().toInt();</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">  98     if (offsetToTarget &gt;= 0)</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  99       offsetToTarget -= 7;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 100     return plusDays(offsetToTarget);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 101   }</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 102 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 103   public DayDate getFollowingDayOfWeek(Day targetDayOfWeek) {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 104     int offsetToTarget = targetDayOfWeek.toInt() - getDayOfWeek().toInt();</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 105     if (offsetToTarget &lt;= 0)</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 106       offsetToTarget += 7;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 107     return plusDays(offsetToTarget);</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 108   }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 109 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 110   public DayDate getNearestDayOfWeek(Day targetDayOfWeek) {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 111     int offsetToThisWeeksTarget = targetDayOfWeek.toInt() - getDayOfWeek().toInt();</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 112     int offsetToFutureTarget = (offsetToThisWeeksTarget + 7) % 7;</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 113     int offsetToPreviousTarget = offsetToFutureTarget - 7;</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 114 </div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 115     if (offsetToFutureTarget &gt; 3)</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 116       return plusDays(offsetToPreviousTarget);</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 117     else</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 118       return plusDays(offsetToFutureTarget);</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 119   }</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 120 </div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 121   public DayDate getEndOfMonth() {</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 122     Month month = getMonth();</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 123     int year = getYear();</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 124     int lastDay = DateUtil.lastDayOfMonth(month, year);</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 125     return DayDateFactory.makeDate(lastDay, month, year);</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 126   }</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 127 </div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 128   public Date toDate() {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 129     final Calendar calendar = Calendar.getInstance();</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 130     int ordinalMonth = getMonth().toInt() - Month.JANUARY.toInt();</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 131     calendar.set(getYear(), ordinalMonth, getDayOfMonth(), 0, 0, 0);</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 132     return calendar.getTime();</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 133   }</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 134 </div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 135   public String toString() {</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 136     return String.format(&quot;%02d-%s-%d&quot;, getDayOfMonth(), getMonth(), getYear());</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 137   }</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 138 </div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 139   public Day getDayOfWeek() {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 140     Day startingDay = getDayOfWeekForOrdinalZero();</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 141     int startingOffset = startingDay.toInt() - Day.SUNDAY.toInt();</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 142     int ordinalOfDayOfWeek = (getOrdinalDay() + startingOffset) % 7;</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 143     return Day.fromInt(ordinalOfDayOfWeek + Day.SUNDAY.toInt());</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 144   }</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 145 </div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 146   public int daysSince(DayDate date) {</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 147     return getOrdinalDay() - date.getOrdinalDay();</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 148   }</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 149 </div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 150   public boolean isOn(DayDate other) {</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 151     return getOrdinalDay() == other.getOrdinalDay();</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 152   }</div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0"> 153 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-7 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DayDate.java (Final)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1ab" class="pf w1 h2" data-page-no="1ab"><div class="pc pc1ab w1 h2"><img class="bi xd y16bc wc hd2" alt="" src="bg1ab.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">396<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 154   public boolean isBefore(DayDate other) {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 155     return getOrdinalDay() &lt; other.getOrdinalDay();</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 156   }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 157 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 158   public boolean isOnOrBefore(DayDate other) {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 159     return getOrdinalDay() &lt;= other.getOrdinalDay();</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 160   }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 161 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 162   public boolean isAfter(DayDate other) {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 163     return getOrdinalDay() &gt; other.getOrdinalDay();</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 164   }</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 165 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 166   public boolean isOnOrAfter(DayDate other) {</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 167     return getOrdinalDay() &gt;= other.getOrdinalDay();</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 168   }</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 169 </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 170   public boolean isInRange(DayDate d1, DayDate d2) {</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 171     return isInRange(d1, d2, DateInterval.CLOSED);</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 172   }</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 173 </div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 174   public boolean isInRange(DayDate d1, DayDate d2, DateInterval interval) {</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 175     int left = Math.min(d1.getOrdinalDay(), d2.getOrdinalDay());</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 176     int right = Math.max(d1.getOrdinalDay(), d2.getOrdinalDay());</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 177     return interval.isIn(getOrdinalDay(), left, right);</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 178   }</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 179 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-7 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DayDate.java (Final)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1ac" class="pf w1 h2" data-page-no="1ac"><div class="pc pc1ac w1 h2"><img class="bi xd y16bd wc hd3" alt="" src="bg1ac.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">397<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-<span class="ff15">8</span> </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Month.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 import java.text.DateFormatSymbols;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 public enum Month {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6   JANUARY(1), FEBRUARY(2), MARCH(3),</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7   APRIL(4),   MAY(5),      JUNE(6),</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8   JULY(7),    AUGUST(8),   SEPTEMBER(9),</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9   OCTOBER(10),NOVEMBER(11),DECEMBER(12);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10   private static DateFormatSymbols dateFormatSymbols = new DateFormatSymbols();</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11   private static final int[] LAST_DAY_OF_MONTH =</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12     {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14   private int index;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15 </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16   Month(int index) {</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17     this.index = index;</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   }</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19 </div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20   public static Month fromInt(int monthIndex) {</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21     for (Month m : Month.values()) {</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22       if (m.index == monthIndex)</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23         return m;</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24     }</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25     throw new IllegalArgumentException(&quot;Invalid month index &quot; + monthIndex);</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26   }</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27 </div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28   public int lastDay() {</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29     return LAST_DAY_OF_MONTH[index];</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30   }</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32   public int quarter() {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33     return 1 + (index - 1) / 3;</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34   }</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36   public String toString() {</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37     return dateFormatSymbols.getMonths()[index - 1];</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38   }</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40   public String toShortString() {</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41     return dateFormatSymbols.getShortMonths()[index - 1];</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42   }</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43 </div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44   public static Month parse(String s) {</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45     s = s.trim();</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46     for (Month m : Month.values())</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47       if (m.matches(s))</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48         return m;</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49 </div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50     try {</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51       return fromInt(Integer.parseInt(s));</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52     }</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53     catch (NumberFormatException e) {}</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54     throw new IllegalArgumentException(&quot;Invalid month &quot; + s);</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0">  55   }</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0">  56 </div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0">  57   private boolean matches(String s) {</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0">  58     return s.equalsIgnoreCase(toString()) ||</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0">  59            s.equalsIgnoreCase(toShortString());</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0">  60   }</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0">  61 </div><div class="t m9 xd hb2 y16a3 ffb fs18 fc0 sc0 ls0 ws0">  62   public int toInt() {</div><div class="t m9 xd hb2 y16a4 ffb fs18 fc0 sc0 ls0 ws0">  63     return index;</div><div class="t m9 xd hb2 y16b8 ffb fs18 fc0 sc0 ls0 ws0">  64   }</div><div class="t m9 xd hb2 y16b9 ffb fs18 fc0 sc0 ls0 ws0">  65 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1ad" class="pf w1 h2" data-page-no="1ad"><div class="pc pc1ad w1 h2"><img class="bi xd ycbb wc h80" alt="" src="bg1ad.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">398<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-9 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">Day.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 import java.util.Calendar;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4 import java.text.DateFormatSymbols;</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 </div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6 public enum Day {</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7   MONDAY(Calendar.MONDAY),</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8   TUESDAY(Calendar.TUESDAY),</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9   WEDNESDAY(Calendar.WEDNESDAY),</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10   THURSDAY(Calendar.THURSDAY),</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11   FRIDAY(Calendar.FRIDAY),</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12   SATURDAY(Calendar.SATURDAY),</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13   SUNDAY(Calendar.SUNDAY);</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14 </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15   private final int index;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16   private static DateFormatSymbols dateSymbols = new DateFormatSymbols();</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   Day(int day) {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19     index = day;</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20   }</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21 </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22   public static Day fromInt(int index) throws IllegalArgumentException {</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23     for (Day d : Day.values())</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24       if (d.index == index)</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25         return d;</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26     throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27       String.format(&quot;Illegal day index: %d.&quot;, index));</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28   }</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29 </div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30   public static Day parse(String s) throws IllegalArgumentException {</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31     String[] shortWeekdayNames =</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32       dateSymbols.getShortWeekdays();</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33     String[] weekDayNames =</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34       dateSymbols.getWeekdays();</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36     s = s.trim();</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37     for (Day day : Day.values()) {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38       if (s.equalsIgnoreCase(shortWeekdayNames[day.index]) ||</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39           s.equalsIgnoreCase(weekDayNames[day.index])) {</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  40         return day;</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  41       }</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  42     }</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  43     throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  44       String.format(&quot;%s is not a valid weekday string&quot;, s));</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0">  45   }</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0">  46 </div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0">  47   public String toString() {</div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0">  48     return dateSymbols.getWeekdays()[index];</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0">  49   }</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0">  50 </div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0">  51   public int toInt() {</div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0">  52     return index;</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0">  53   }</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0">  54 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1ae" class="pf w1 h2" data-page-no="1ae"><div class="pc pc1ae w1 h2"><img class="bi xd y16be wc hd4" alt="" src="bg1ae.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">399<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-10 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DateInterval.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 public enum DateInterval {</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4   OPEN {</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5     public boolean isIn(int d, int left, int right) {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6       return d &gt; left &amp;&amp; d &lt; right;</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7     }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8   },</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9   CLOSED_LEFT {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10     public boolean isIn(int d, int left, int right) {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11       return d &gt;= left &amp;&amp; d &lt; right;</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12     }</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13   },</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14   CLOSED_RIGHT {</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15     public boolean isIn(int d, int left, int right) {</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16       return d &gt; left &amp;&amp; d &lt;= right;</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17     }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   },</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19   CLOSED {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20     public boolean isIn(int d, int left, int right) {</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21       return d &gt;= left &amp;&amp; d &lt;= right;</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22     }</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23   };</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24 </div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25   public abstract boolean isIn(int d, int left, int right);</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1af" class="pf w1 h2" data-page-no="1af"><div class="pc pc1af w1 h2"><img class="bi xd y16bf wc hd5" alt="" src="bg1af.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">400<span class="_ _49"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 xf1 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-11 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">WeekInMonth.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 public enum WeekInMonth {</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4   FIRST(1), SECOND(2), THIRD(3), FOURTH(4), LAST(0);</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5   private final int index;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7   WeekInMonth(int index) {</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8     this.index = index;</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9   }</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10 </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11   public int toInt() {</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12     return index;</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13   }</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b0" class="pf w1 h2" data-page-no="1b0"><div class="pc pc1b0 w1 h2"><img class="bi xd y16c0 wc hd6" alt="" src="bg1b0.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">401<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-12 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">WeekdayRange.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 public enum WeekdayRange {</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4   LAST, NEAREST, NEXT</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b1" class="pf w1 h2" data-page-no="1b1"><div class="pc pc1b1 w1 h2"><img class="bi xd y16c1 wc hd7" alt="" src="bg1b1.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">402<span class="_ _4a"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x21 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-13 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DateUtil.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 import java.text.DateFormatSymbols;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 public class DateUtil {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6   private static DateFormatSymbols dateFormatSymbols = new DateFormatSymbols();</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7 </div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8   public static String[] getMonthNames() {</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9     return dateFormatSymbols.getMonths();</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10   }</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11 </div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12   public static boolean isLeapYear(int year) {</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13     boolean fourth = year % 4 == 0;</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14     boolean hundredth = year % 100 == 0;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15     boolean fourHundredth = year % 400 == 0;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16     return fourth &amp;&amp; (!hundredth || fourHundredth);</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17   }</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19   public static int lastDayOfMonth(Month month, int year) {</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20     if (month == Month.FEBRUARY &amp;&amp; isLeapYear(year))</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21       return month.lastDay() + 1;</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22     else</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23       return month.lastDay();</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24   }</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25 </div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26   public static int leapYearCount(int year) {</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27     int leap4 = (year - 1896) / 4;</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28     int leap100 = (year - 1800) / 100;</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29     int leap400 = (year - 1600) / 400;</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30     return leap4 - leap100 + leap400;</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31   }</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b2" class="pf w1 h2" data-page-no="1b2"><div class="pc pc1b2 w1 h2"><img class="bi xd y16c2 wc hd8" alt="" src="bg1b2.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">403<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-14 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">DayDateFactory.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 public abstract class DayDateFactory {</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4   private static DayDateFactory factory = new SpreadsheetDateFactory();</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5   public static void setInstance(DayDateFactory factory) {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6     DayDateFactory.factory = factory;</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7   }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9   protected abstract DayDate _makeDate(int ordinal);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10   protected abstract DayDate _makeDate(int day, Month month, int year);</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11   protected abstract DayDate _makeDate(int day, int month, int year);</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12   protected abstract DayDate _makeDate(java.util.Date date);</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13   protected abstract int _getMinimumYear();</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14   protected abstract int _getMaximumYear();</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15 </div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16   public static DayDate makeDate(int ordinal) {</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17     return factory._makeDate(ordinal);</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   }</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19 </div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20   public static DayDate makeDate(int day, Month month, int year) {</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21     return factory._makeDate(day, month, year);</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22   }</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23 </div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24   public static DayDate makeDate(int day, int month, int year) {</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25     return factory._makeDate(day, month, year);</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26   }</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27 </div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28   public static DayDate makeDate(java.util.Date date) {</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29     return factory._makeDate(date);</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30   }</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31 </div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32   public static int getMinimumYear() {</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33     return factory._getMinimumYear();</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34   }</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  35 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  36   public static int getMaximumYear() {</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  37     return factory._getMaximumYear();</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  38   }</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  39 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b3" class="pf w1 h2" data-page-no="1b3"><div class="pc pc1b3 w1 h2"><img class="bi xd y16c3 wc hd9" alt="" src="bg1b3.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">404<span class="_ _4a"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x21 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-15 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDateFactory.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9e ws7db">   1 package org.jfree.date;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2 </div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3 import java.util.*;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5 public class SpreadsheetDateFactory extends DayDateFactory {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6   public DayDate _makeDate(int ordinal) {</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">   7     return new SpreadsheetDate(ordinal);</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">   8   }</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">   9 </div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  10   public DayDate _makeDate(int day, Month month, int year) {</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  11     return new SpreadsheetDate(day, month, year);</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  12   }</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  13 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  14   public DayDate _makeDate(int day, int month, int year) {</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  15     return new SpreadsheetDate(day, month, year);</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  16   }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  17 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  18   public DayDate _makeDate(Date date) {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  19     final GregorianCalendar calendar = new GregorianCalendar();</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  20     calendar.setTime(date);</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  21     return new SpreadsheetDate(</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  22       calendar.get(Calendar.DATE),</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  23       Month.fromInt(calendar.get(Calendar.MONTH) + 1),</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  24       calendar.get(Calendar.YEAR));</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  25   }</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  26 </div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  27   protected int _getMinimumYear() {</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  28     return SpreadsheetDate.MINIMUM_YEAR_SUPPORTED;</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  29   }</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  30 </div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  31   protected int _getMaximumYear() {</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  32     return SpreadsheetDate.MAXIMUM_YEAR_SUPPORTED;</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  33   }</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  34 }</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b4" class="pf w1 h2" data-page-no="1b4"><div class="pc pc1b4 w1 h2"><img class="bi xd y141e wc hda" alt="" src="bg1b4.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">405<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-16 </div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java (Final)</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls9c ws7d9">   1 /* ========================================================================</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0">   2  * JCommon : a free general purpose class library for the Java(tm) platform</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0">   3  * ========================================================================</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0">   4  *</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0">   5  * (C) Copyright 2000-2005, by Object Refinery Limited and Contributors.</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0">   6  * </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0">...</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0">  52  *</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0">  53  */</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0">  54 </div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0">  55 package org.jfree.date;</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0">  56 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0">  57 import static org.jfree.date.Month.FEBRUARY;</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0">  58 </div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0">  59 import java.util.*;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0">  60 </div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0">  61 /**</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0">  62  * Represents a date using an integer, in a similar fashion to the</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0">  63  * implementation in Microsoft Excel.  The range of dates supported is</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0">  64  * 1-Jan-1900 to 31-Dec-9999.</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0">  65  * &lt;p/&gt;</div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0">  66  * Be aware that there is a deliberate bug in Excel that recognises the year</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0">  67  * 1900 as a leap year when in fact it is not a leap year. You can find more</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0">  68  * information on the Microsoft website in article Q181370:</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0">  69  * &lt;p/&gt;</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0">  70  * http://support.microsoft.com/support/kb/articles/Q181/3/70.asp</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0">  71  * &lt;p/&gt;</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0">  72  * Excel uses the convention that 1-Jan-1900 = 1.  This class uses the</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0">  73  * convention 1-Jan-1900 = 2.</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0">  74  * The result is that the day number in this class will be different to the</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0">  75  * Excel figure for January and February 1900...but then Excel adds in an extra</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0">  76  * day (29-Feb-1900 which does not actually exist!) and from that point forward</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0">  77  * the day numbers will match.</div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0">  78  *</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0">  79  * @author David Gilbert</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0">  80  */</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0">  81 public class SpreadsheetDate extends DayDate {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0">  82   public static final int EARLIEST_DATE_ORDINAL = 2;     // 1/1/1900</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0">  83   public static final int LATEST_DATE_ORDINAL = 2958465; // 12/31/9999</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0">  84   public static final int MINIMUM_YEAR_SUPPORTED = 1900;</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0">  85   public static final int MAXIMUM_YEAR_SUPPORTED = 9999;</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0">  86   static final int[] AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH =</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0">  87     {0, 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365};</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0">  88   static final int[] LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH =</div><div class="t m9 xd hb2 y16a6 ffb fs18 fc0 sc0 ls0 ws0">  89     {0, 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366};</div><div class="t m9 xd hb2 y16a7 ffb fs18 fc0 sc0 ls0 ws0">  90 </div><div class="t m9 xd hb2 y16a8 ffb fs18 fc0 sc0 ls0 ws0">  91   private int ordinalDay;</div><div class="t m9 xd hb2 y16a9 ffb fs18 fc0 sc0 ls0 ws0">  92   private int day;</div><div class="t m9 xd hb2 y16aa ffb fs18 fc0 sc0 ls0 ws0">  93   private Month month;</div><div class="t m9 xd hb2 y16ab ffb fs18 fc0 sc0 ls0 ws0">  94   private int year;</div><div class="t m9 xd hb2 y16ac ffb fs18 fc0 sc0 ls0 ws0">  95 </div><div class="t m9 xd hb2 y16ad ffb fs18 fc0 sc0 ls0 ws0">  96   public SpreadsheetDate(int day, Month month, int year) {</div><div class="t m9 xd hb2 y16ae ffb fs18 fc0 sc0 ls0 ws0">  97     if (year &lt; MINIMUM_YEAR_SUPPORTED || year &gt; MAXIMUM_YEAR_SUPPORTED)</div><div class="t m9 xd hb2 y16af ffb fs18 fc0 sc0 ls0 ws0">  98       throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y16b0 ffb fs18 fc0 sc0 ls0 ws0">  99         &quot;The &apos;year&apos; argument must be in range &quot; +</div><div class="t m9 xd hb2 y16b1 ffb fs18 fc0 sc0 ls0 ws0"> 100         MINIMUM_YEAR_SUPPORTED + &quot; to &quot; + MAXIMUM_YEAR_SUPPORTED + &quot;.&quot;);</div><div class="t m9 xd hb2 y16b2 ffb fs18 fc0 sc0 ls0 ws0"> 101     if (day &lt; 1 || day &gt; DateUtil.lastDayOfMonth(month, year))</div><div class="t m9 xd hb2 y16b3 ffb fs18 fc0 sc0 ls0 ws0"> 102       throw new IllegalArgumentException(&quot;Invalid &apos;day&apos; argument.&quot;);</div><div class="t m9 xd hb2 y16b4 ffb fs18 fc0 sc0 ls0 ws0"> 103 </div><div class="t m9 xd hb2 y16b5 ffb fs18 fc0 sc0 ls0 ws0"> 104     this.year = year;</div><div class="t m9 xd hb2 y16c4 ffb fs18 fc0 sc0 ls0 ws0"> 105     this.month = month;</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b5" class="pf w1 h2" data-page-no="1b5"><div class="pc pc1b5 w1 h2"><img class="bi xd ybda wc h73" alt="" src="bg1b5.png"/><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">406<span class="_ _4a"> </span><span class="ff1">Append<span class="ff15">i</span><span class="wsa0">x B</span><span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x21 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 106     this.day = day;</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 107     ordinalDay = calcOrdinal(day, month, year);</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 108   }</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 109 </div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 110   public SpreadsheetDate(int day, int month, int year) {</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 111     this(day, Month.fromInt(month), year);</div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 112   }</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 113 </div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 114   public SpreadsheetDate(int serial) {</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 115     if (serial &lt; EARLIEST_DATE_ORDINAL || serial &gt; LATEST_DATE_ORDINAL)</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 116       throw new IllegalArgumentException(</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 117         &quot;SpreadsheetDate: Serial must be in range 2 to 2958465.&quot;);</div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 118 </div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 119     ordinalDay = serial;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 120     calcDayMonthYear();</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 121   }</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 122 </div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 123   public int getOrdinalDay() {</div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 124     return ordinalDay;</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 125   }</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 126 </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 127   public int getYear() {</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 128     return year;</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 129   }</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 130 </div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 131   public Month getMonth() {</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 132     return month;</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 133   }</div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 134 </div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 135   public int getDayOfMonth() {</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 136     return day;</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 137   }</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 138 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 139   protected Day getDayOfWeekForOrdinalZero() {return Day.SATURDAY;}</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 140 </div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 141   public boolean equals(Object object) {</div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 142     if (!(object instanceof DayDate))</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 143       return false;</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 144 </div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 145     DayDate date = (DayDate) object;</div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 146     return date.getOrdinalDay() == getOrdinalDay();</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 147   }</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 148 </div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 149   public int hashCode() {</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 150     return getOrdinalDay();</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 151   }</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 152 </div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 153   public int compareTo(Object other) {</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 154     return daysSince((DayDate) other);</div><div class="t m9 xd hb2 y1697 ffb fs18 fc0 sc0 ls0 ws0"> 155   }</div><div class="t m9 xd hb2 y1698 ffb fs18 fc0 sc0 ls0 ws0"> 156 </div><div class="t m9 xd hb2 y1699 ffb fs18 fc0 sc0 ls0 ws0"> 157   private int calcOrdinal(int day, Month month, int year) {</div><div class="t m9 xd hb2 y169a ffb fs18 fc0 sc0 ls0 ws0"> 158     int leapDaysForYear = DateUtil.leapYearCount(year - 1);</div><div class="t m9 xd hb2 y169b ffb fs18 fc0 sc0 ls0 ws0"> 159     int daysUpToYear = (year - MINIMUM_YEAR_SUPPORTED) * 365 + leapDaysForYear;</div><div class="t m9 xd hb2 y169c ffb fs18 fc0 sc0 ls0 ws0"> 160     int daysUpToMonth = AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH[month.toInt()];</div><div class="t m9 xd hb2 y169d ffb fs18 fc0 sc0 ls0 ws0"> 161     if (DateUtil.isLeapYear(year) &amp;&amp; month.toInt() &gt; FEBRUARY.toInt())</div><div class="t m9 xd hb2 y169e ffb fs18 fc0 sc0 ls0 ws0"> 162       daysUpToMonth++;</div><div class="t m9 xd hb2 y169f ffb fs18 fc0 sc0 ls0 ws0"> 163     int daysInMonth = day - 1;</div><div class="t m9 xd hb2 y16a0 ffb fs18 fc0 sc0 ls0 ws0"> 164     return daysUpToYear + daysUpToMonth + daysInMonth + EARLIEST_DATE_ORDINAL;</div><div class="t m9 xd hb2 y16a1 ffb fs18 fc0 sc0 ls0 ws0"> 165   }</div><div class="t m9 xd hb2 y16a2 ffb fs18 fc0 sc0 ls0 ws0"> 166 </div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-16 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java (Final)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b6" class="pf w1 h2" data-page-no="1b6"><div class="pc pc1b6 w1 h2"><img class="bi xd y16c5 wc hdb" alt="" src="bg1b6.png"/><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">407<span class="_ _10"></span><span class="ff1">Append<span class="ff15">i</span>x B<span class="ff15">:<span class="_ _1"></span><span class="ff1"> </span></span></span></div><div class="t m7 x28 h36 y79 ffc fs3 fc0 sc0 ls0 ws0">org.jfree.date.SerialDate</div><div class="t m9 xd hb2 y1666 ffb fs18 fc0 sc0 ls0 ws0"> 167   private void calcDayMonthYear() {</div><div class="t m9 xd hb2 y1667 ffb fs18 fc0 sc0 ls0 ws0"> 168     int days = ordinalDay - EARLIEST_DATE_ORDINAL;</div><div class="t m9 xd hb2 y1668 ffb fs18 fc0 sc0 ls0 ws0"> 169     int overestimatedYear = MINIMUM_YEAR_SUPPORTED + days / 365;</div><div class="t m9 xd hb2 y1669 ffb fs18 fc0 sc0 ls0 ws0"> 170     int nonleapdays = days - DateUtil.leapYearCount(overestimatedYear);</div><div class="t m9 xd hb2 y166a ffb fs18 fc0 sc0 ls0 ws0"> 171     int underestimatedYear = MINIMUM_YEAR_SUPPORTED + nonleapdays / 365;</div><div class="t m9 xd hb2 y166b ffb fs18 fc0 sc0 ls0 ws0"> 172 </div><div class="t m9 xd hb2 y166c ffb fs18 fc0 sc0 ls0 ws0"> 173     year = huntForYearContaining(ordinalDay, underestimatedYear);</div><div class="t m9 xd hb2 y166d ffb fs18 fc0 sc0 ls0 ws0"> 174     int firstOrdinalOfYear = firstOrdinalOfYear(year);</div><div class="t m9 xd hb2 y166e ffb fs18 fc0 sc0 ls0 ws0"> 175     month = huntForMonthContaining(ordinalDay, firstOrdinalOfYear);</div><div class="t m9 xd hb2 y166f ffb fs18 fc0 sc0 ls0 ws0"> 176     day = ordinalDay - firstOrdinalOfYear - daysBeforeThisMonth(month.toInt());</div><div class="t m9 xd hb2 y1670 ffb fs18 fc0 sc0 ls0 ws0"> 177   }</div><div class="t m9 xd hb2 y1671 ffb fs18 fc0 sc0 ls0 ws0"> 178 </div><div class="t m9 xd hb2 y1672 ffb fs18 fc0 sc0 ls0 ws0"> 179   private Month huntForMonthContaining(int anOrdinal, int firstOrdinalOfYear) {</div><div class="t m9 xd hb2 y1673 ffb fs18 fc0 sc0 ls0 ws0"> 180     int daysIntoThisYear = anOrdinal - firstOrdinalOfYear;</div><div class="t m9 xd hb2 y1674 ffb fs18 fc0 sc0 ls0 ws0"> 181     int aMonth = 1;</div><div class="t m9 xd hb2 y1675 ffb fs18 fc0 sc0 ls0 ws0"> 182     while (daysBeforeThisMonth(aMonth) &lt; daysIntoThisYear)</div><div class="t m9 xd hb2 y1676 ffb fs18 fc0 sc0 ls0 ws0"> 183       aMonth++;</div><div class="t m9 xd hb2 y1677 ffb fs18 fc0 sc0 ls0 ws0"> 184 </div><div class="t m9 xd hb2 y1678 ffb fs18 fc0 sc0 ls0 ws0"> 185     return Month.fromInt(aMonth - 1);</div><div class="t m9 xd hb2 y1679 ffb fs18 fc0 sc0 ls0 ws0"> 186   }</div><div class="t m9 xd hb2 y167a ffb fs18 fc0 sc0 ls0 ws0"> 187 </div><div class="t m9 xd hb2 y167b ffb fs18 fc0 sc0 ls0 ws0"> 188   private int daysBeforeThisMonth(int aMonth) {</div><div class="t m9 xd hb2 y167c ffb fs18 fc0 sc0 ls0 ws0"> 189     if (DateUtil.isLeapYear(year))</div><div class="t m9 xd hb2 y167d ffb fs18 fc0 sc0 ls0 ws0"> 190       return LEAP_YEAR_AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH[aMonth] - 1;</div><div class="t m9 xd hb2 y167e ffb fs18 fc0 sc0 ls0 ws0"> 191     else</div><div class="t m9 xd hb2 y167f ffb fs18 fc0 sc0 ls0 ws0"> 192       return AGGREGATE_DAYS_TO_END_OF_PRECEDING_MONTH[aMonth] - 1;</div><div class="t m9 xd hb2 y1680 ffb fs18 fc0 sc0 ls0 ws0"> 193   }</div><div class="t m9 xd hb2 y1681 ffb fs18 fc0 sc0 ls0 ws0"> 194 </div><div class="t m9 xd hb2 y1682 ffb fs18 fc0 sc0 ls0 ws0"> 195   private int huntForYearContaining(int anOrdinalDay, int startingYear) {</div><div class="t m9 xd hb2 y1683 ffb fs18 fc0 sc0 ls0 ws0"> 196     int aYear = startingYear;</div><div class="t m9 xd hb2 y1684 ffb fs18 fc0 sc0 ls0 ws0"> 197     while (firstOrdinalOfYear(aYear) &lt;= anOrdinalDay)</div><div class="t m9 xd hb2 y1685 ffb fs18 fc0 sc0 ls0 ws0"> 198       aYear++;</div><div class="t m9 xd hb2 y1686 ffb fs18 fc0 sc0 ls0 ws0"> 199 </div><div class="t m9 xd hb2 y1687 ffb fs18 fc0 sc0 ls0 ws0"> 200     return aYear - 1;</div><div class="t m9 xd hb2 y1688 ffb fs18 fc0 sc0 ls0 ws0"> 201   }</div><div class="t m9 xd hb2 y1689 ffb fs18 fc0 sc0 ls0 ws0"> 202 </div><div class="t m9 xd hb2 y168a ffb fs18 fc0 sc0 ls0 ws0"> 203   private int firstOrdinalOfYear(int year) {</div><div class="t m9 xd hb2 y168b ffb fs18 fc0 sc0 ls0 ws0"> 204     return calcOrdinal(1, Month.JANUARY, year);</div><div class="t m9 xd hb2 y168c ffb fs18 fc0 sc0 ls0 ws0"> 205   }</div><div class="t m9 xd hb2 y168d ffb fs18 fc0 sc0 ls0 ws0"> 206 </div><div class="t m9 xd hb2 y168e ffb fs18 fc0 sc0 ls0 ws0"> 207   public static DayDate createInstance(Date date) {</div><div class="t m9 xd hb2 y168f ffb fs18 fc0 sc0 ls0 ws0"> 208     GregorianCalendar calendar = new GregorianCalendar();</div><div class="t m9 xd hb2 y1690 ffb fs18 fc0 sc0 ls0 ws0"> 209     calendar.setTime(date);</div><div class="t m9 xd hb2 y1691 ffb fs18 fc0 sc0 ls0 ws0"> 210     return new SpreadsheetDate(calendar.get(Calendar.DATE),</div><div class="t m9 xd hb2 y1692 ffb fs18 fc0 sc0 ls0 ws0"> 211                                Month.fromInt(calendar.get(Calendar.MONTH) + 1),</div><div class="t m9 xd hb2 y1693 ffb fs18 fc0 sc0 ls0 ws0"> 212                                calendar.get(Calendar.YEAR));</div><div class="t m9 xd hb2 y1694 ffb fs18 fc0 sc0 ls0 ws0"> 213 </div><div class="t m9 xd hb2 y1695 ffb fs18 fc0 sc0 ls0 ws0"> 214   }</div><div class="t m9 xd hb2 y1696 ffb fs18 fc0 sc0 ls0 ws0"> 215 }</div><div class="t m0 x74 h1c y4b7 ff1 fs3 fc0 sc0 ls0 ws0">L<span class="ff15">i</span>st<span class="ff15">i</span>ng B-16 (cont<span class="ff15">i</span>nued)</div><div class="t m0 x74 h36 y4b8 ffc fs3 fc0 sc0 ls0 ws0">SpreadsheetDate.java (Final)</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b7" class="pf w1 h2" data-page-no="1b7"><div class="pc pc1b7 w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b8" class="pf w1 h2" data-page-no="1b8"><div class="pc pc1b8 w1 h2"><img class="bi xd y1452 w4 hb9" alt="" src="bg1b8.png"/><div class="t m0 x29 h14 y24b ff8 fs3 fc0 sc0 ls0 ws0">409</div><div class="t m0 x9b h23 y24c ff1 fsd fc0 sc0 ls0 ws0">A<span class="_ _2"></span>ppendix C</div><div class="t m0 x6c h3 y24d ff1 fs0 fc0 sc0 ls0 ws0">Cr<span class="_ _1"></span>oss Refer<span class="_ _1"></span>ences of Heuristics</div><div class="t m0 xd h14 y257 ff8 fs3 fc0 sc0 ls0 ws0">Cross references of Smells and Heuristics. <span class="_ _1"></span>All other cross references can be deleted.</div><div class="t m0 x74 h14 y281 ff8 fs3 fc0 sc0 ls0 ws0">C1</div><div class="t m0 x75 h16 y16c6 ff8 fs7 fc0 sc0 ls0 ws0">.......................................................................<span class="_ _8"></span>16-276, 16-279, 17-292</div><div class="t m0 x74 h14 y2a ff8 fs3 fc0 sc0 ls0 ws0">C2</div><div class="t m0 x75 h16 y16c7 ff8 fs7 fc0 sc0 ls0 ws0">.........................................................<span class="_ _e"> </span>16-279, 16-285, 16-295, 17-292</div><div class="t m0 x74 h14 y2b ff8 fs3 fc0 sc0 ls0 ws0">C3</div><div class="t m0 x75 h16 y16c8 ff8 fs7 fc0 sc0 ls0 ws0">.........................................................<span class="_ _e"> </span>16-283, 16-285, 16-288, 17-293</div><div class="t m0 x74 h14 y2c ff8 fs3 fc0 sc0 ls0 ws0">C4</div><div class="t m0 x75 h16 y16c9 ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-293</div><div class="t m0 x74 h14 y2d ff8 fs3 fc0 sc0 ls0 ws0">C5</div><div class="t m0 x75 h16 y16ca ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-293</div><div class="t m0 x74 h14 y4e3 ff8 fs3 fc0 sc0 ls0 ws0">E1</div><div class="t m0 x75 h16 y16cb ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-294</div><div class="t m0 x74 h14 y806 ff8 fs3 fc0 sc0 ls0 ws0">E2</div><div class="t m0 x75 h16 y16cc ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-294</div><div class="t m0 x74 h14 y807 ff8 fs3 fc0 sc0 ls0 ws0">F1</div><div class="t m0 x75 h16 y16cd ff8 fs7 fc0 sc0 ls0 ws0">....................................................................................<span class="_ _d"></span>14-239, 17-295</div><div class="t m0 x74 h14 y808 ff8 fs3 fc0 sc0 ls0 ws0">F2</div><div class="t m0 x75 h16 y16ce ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-295</div><div class="t m0 x74 h14 yf5f ff8 fs3 fc0 sc0 ls0 ws0">F3</div><div class="t m0 x75 h16 y16cf ff8 fs7 fc0 sc0 ls0 ws0">.................................................................................................<span class="_ _e"> </span>17-295</div><div class="t m0 x74 h16 y37b ff8 fs3 fc0 sc0 ls0 ws0">F4<span class="_ _9"> </span><span class="fs7">...............................<span class="_ _8"></span>14-289, 16-273, 16-285, 16-287, 16-288, 17-295</span></div><div class="t m0 x74 h16 y37c ff8 fs3 fc0 sc0 ls0 ws0">G1 <span class="fs7">....................................................................................<span class="_ _c"> </span>16-276, 17-295</span></div><div class="t m0 x74 h16 y37d ff8 fs3 fc0 sc0 ls0 ws0">G2 <span class="fs7">.......................................................................<span class="_ _5"></span>16-273, 16-274, 17-296</span></div><div class="t m0 x74 h16 y5b4 ff8 fs3 fc0 sc0 ls0 ws0">G3 <span class="fs7">....................................................................................<span class="_ _c"> </span>16-274, 17-296</span></div><div class="t m0 x74 h16 y42d ff8 fs3 fc0 sc0 ls0 ws0">G4 <span class="fs7">................................................<span class="_ _c"> </span>9-31, 16-279, 16-286, 16-291, 17-297</span></div><div class="t m0 x74 h16 y3ad ff8 fs3 fc0 sc0 ls0 ws0">G5 <span class="fs7">...................................<span class="_ _5"></span>9-31, 16-279, 16-286, 16-291, 16-296, 17-297</span></div><div class="t m0 x74 h16 y544 ff8 fs3 fc0 sc0 ls0 ws0">G6 <span class="fs7">................................<span class="_ _5"></span>6-106, 16-280, 16-283, 16-284, 16-289, 16-293,</span></div><div class="t m0 x7f h16 y16d0 ff8 fs7 fc0 sc0 ls0 ws0">16-294, 16-296, 17-299</div><div class="t m0 x74 h16 ybf7 ff8 fs3 fc0 sc0 ls0 ws0">G7 <span class="fs7">.......................................................................<span class="_ _5"></span>16-281, 16-283, 17-300</span></div><div class="t m0 x74 h16 y3e7 ff8 fs3 fc0 sc0 ls0 ws0">G8 <span class="fs7">....................................................................................<span class="_ _c"> </span>16-283, 17-301</span></div><div class="t m0 x74 h16 ybf8 ff8 fs3 fc0 sc0 ls0 ws0">G9 <span class="fs7">............................................<span class="_ _c"> </span>16-283, 16-285, 16-286, 16-287, 17-302</span></div><div class="t m0 x74 h16 y73c ff8 fs3 fc0 sc0 ls0 ws0">G10<span class="_ _15"> </span><span class="fs7">..............................................<span class="_ _d"></span>5-86, 15-264, 16-276, 16-284, 17-302</span></div><div class="t m0 x74 h16 y3cb ff8 fs3 fc0 sc0 ls0 ws0">G11<span class="_ _15"> </span><span class="fs7">..........................................<span class="_ _d"></span>15-264, 16-284, 16-288, 16-292, 17-302</span></div><div class="t m0 x74 h16 y73d ff8 fs3 fc0 sc0 ls0 ws0">G12<span class="_ _15"> </span><span class="fs7">...............<span class="_ _e"> </span>16-284, 16-285, 16-286, 16-287, 16-288, 16-295, 17-303</span></div><div class="t m0 x74 h16 yc84 ff8 fs3 fc0 sc0 ls0 ws0">G13<span class="_ _15"> </span><span class="fs7">.....................................................................<span class="_ _8"></span>16-286, 16-288, 17-303</span></div><div class="t m0 x74 h16 y16d1 ff8 fs3 fc0 sc0 ls0 ws0">G14<span class="_ _15"> </span><span class="fs7">.....................................................................<span class="_ _8"></span>16-288, 16-292, 17-304</span></div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:127.967000px;bottom:440.027010px;width:311.140000px;height:130.073000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1b9" class="pf w1 h2" data-page-no="1b9"><div class="pc pc1b9 w1 h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">410<span class="_ _4b"> </span><span class="ff1 ws305">Appendix C:<span class="_ _1"></span> Cross Refer<span class="_ _4"></span>ences of Heuristics</span></div><div class="t m0 x74 h16 y194 ff8 fs3 fc0 sc0 ls0 ws0">G15<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-288, 17-305</span></div><div class="t m0 x74 h16 y195 ff8 fs3 fc0 sc0 ls0 ws0">G16<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-289, 17-306</span></div><div class="t m0 x74 h16 y196 ff8 fs3 fc0 sc0 ls0 ws0">G17<span class="_ _15"> </span><span class="fs7">.....................................................................<span class="_ _8"></span>16-289, 17-307, 17-312</span></div><div class="t m0 x74 h16 y197 ff8 fs3 fc0 sc0 ls0 ws0">G18<span class="_ _15"> </span><span class="fs7">.......................................................<span class="_ _e"> </span>16-289, 16-290, 16-291, 17-308</span></div><div class="t m0 x74 h16 y198 ff8 fs3 fc0 sc0 ls0 ws0">G19<span class="_ _15"> </span><span class="fs7">.......................................................<span class="_ _e"> </span>16-290, 16-291, 16-292, 17-309</span></div><div class="t m0 x74 h16 y199 ff8 fs3 fc0 sc0 ls0 ws0">G20<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-290, 17-309</span></div><div class="t m0 x74 h16 y1da ff8 fs3 fc0 sc0 ls0 ws0">G21<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-291, 17-310</span></div><div class="t m0 x74 h16 y1db ff8 fs3 fc0 sc0 ls0 ws0">G22<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-294, 17-322</span></div><div class="t m0 x74 h16 y1dc ff8 fs3 fc0 sc0 ls0 ws0">G23<span class="_ _15"> </span><span class="fs7">..........................................................<span class="_ _5"></span>??-44, 14-239, 16-295, 17-313</span></div><div class="t m0 x74 h16 y1dd ff8 fs3 fc0 sc0 ls0 ws0">G24<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-296, 17-313</span></div><div class="t m0 x74 h16 y1de ff8 fs3 fc0 sc0 ls0 ws0">G25<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>16-296, 17-314</span></div><div class="t m0 x74 h16 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">G26<span class="_ _15"> </span><span class="fs7">...............................................................................................<span class="_ _e"> </span>17-316</span></div><div class="t m0 x74 h16 y16d3 ff8 fs3 fc0 sc0 ls0 ws0">G27<span class="_ _15"> </span><span class="fs7">...............................................................................................<span class="_ _e"> </span>17-316</span></div><div class="t m0 x74 h16 y1526 ff8 fs3 fc0 sc0 ls0 ws0">G28<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>15-262, 17-317</span></div><div class="t m0 x74 h16 y11bf ff8 fs3 fc0 sc0 ls0 ws0">G29<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>15-262, 17-317</span></div><div class="t m0 x74 h16 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">G30<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>15-263, 17-317</span></div><div class="t m0 x74 h16 y1368 ff8 fs3 fc0 sc0 ls0 ws0">G31<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>15-264, 17-318</span></div><div class="t m0 x74 h16 y1369 ff8 fs3 fc0 sc0 ls0 ws0">G32<span class="_ _15"> </span><span class="fs7">..................................................................................<span class="_ _d"></span>15-265, 17-319</span></div><div class="t m0 x74 h16 y423 ff8 fs3 fc0 sc0 ls0 ws0">G33<span class="_ _15"> </span><span class="fs7">.....................................................................<span class="_ _8"></span>15-265, 15-266, 17-320</span></div><div class="t m0 x74 h16 yd28 ff8 fs3 fc0 sc0 ls0 ws0">G34<span class="_ _15"> </span><span class="fs7">...........................................................................<span class="_ _8"></span>1-40, 6-106, 17-321</span></div><div class="t m0 x74 h16 yd29 ff8 fs3 fc0 sc0 ls0 ws0">G35<span class="_ _15"> </span><span class="fs7">......................................................................................<span class="_ _d"></span>5-90, 17-323</span></div><div class="t m0 x74 h16 yd2a ff8 fs3 fc0 sc0 ls0 ws0">G36<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>6-103, 17-324</span></div><div class="t m0 x74 h16 ybfb ff8 fs3 fc0 sc0 ls0 ws0">J1<span class="_ _18"> </span><span class="fs7">.....................................................................................<span class="_ _d"></span>16-276, 17-325</span></div><div class="t m0 x74 h16 ybfc ff8 fs3 fc0 sc0 ls0 ws0">J2<span class="_ _18"> </span><span class="fs7">........................................................................<span class="_ _8"></span>16-278, 16-285, 17-326</span></div><div class="t m0 x74 h16 ybfd ff8 fs3 fc0 sc0 ls0 ws0">J3<span class="_ _18"> </span><span class="fs7">........................................................................<span class="_ _8"></span>16-283, 16-285, 17-327</span></div><div class="t m0 x74 h16 y3df ff8 fs3 fc0 sc0 ls0 ws0">N1 <span class="fs7">..............................<span class="_ _5"></span>15-264, 16-277, 16-279, 16-282, 16-287, 16-288,</span></div><div class="t m0 x44 h16 y16d4 ff8 fs7 fc0 sc0 ls0 ws0">16-289, 16-290, 16-294, 16-296, 17-328</div><div class="t m0 x74 h16 y376 ff8 fs3 fc0 sc0 ls0 ws0">N2 <span class="fs7">....................................................................................<span class="_ _c"> </span>16-277, 17-330</span></div><div class="t m0 x74 h16 y377 ff8 fs3 fc0 sc0 ls0 ws0">N3 <span class="fs7">.......................................................................<span class="_ _5"></span>16-284, 16-288, 17-331</span></div><div class="t m0 x74 h16 y312 ff8 fs3 fc0 sc0 ls0 ws0">N4 <span class="fs7">.......................................................................<span class="_ _5"></span>15-263, 16-291, 17-332</span></div><div class="t m0 x74 h16 y313 ff8 fs3 fc0 sc0 ls0 ws0">N5 <span class="fs7">.............................................................<span class="_ _e"> </span>2-26, 14-221, 15-262, 17-332</span></div><div class="t m0 x74 h16 y314 ff8 fs3 fc0 sc0 ls0 ws0">N6 <span class="fs7">....................................................................................<span class="_ _c"> </span>15-261, 17-333</span></div><div class="t m0 x74 h16 y315 ff8 fs3 fc0 sc0 ls0 ws0">N7 <span class="fs7">....................................................................................<span class="_ _c"> </span>15-263, 17-333</span></div><div class="t m0 x74 h16 y458 ff8 fs3 fc0 sc0 ls0 ws0">T1<span class="_ _15"> </span><span class="fs7">.......................................................................<span class="_ _8"></span>16-273, 16-274, 17-334</span></div><div class="t m0 x74 h16 y459 ff8 fs3 fc0 sc0 ls0 ws0">T2<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>16-273, 17-334</span></div><div class="t m0 x74 h16 y45a ff8 fs3 fc0 sc0 ls0 ws0">T3<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>16-274, 17-334</span></div><div class="t m0 x74 h16 y45b ff8 fs3 fc0 sc0 ls0 ws0">T4<span class="_ _15"> </span><span class="fs7">.................................................................................................<span class="_ _e"> </span>17-334</span></div><div class="t m0 x74 h16 y45c ff8 fs3 fc0 sc0 ls0 ws0">T5<span class="_ _15"> </span><span class="fs7">.......................................................................<span class="_ _8"></span>16-274, 16-275, 17-335</span></div><div class="t m0 x74 h16 y45d ff8 fs3 fc0 sc0 ls0 ws0">T6<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>16-275, 17-335</span></div><div class="t m0 x74 h16 y45e ff8 fs3 fc0 sc0 ls0 ws0">T7<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>16-275, 17-335</span></div><div class="t m0 x74 h16 yb27 ff8 fs3 fc0 sc0 ls0 ws0">T8<span class="_ _15"> </span><span class="fs7">....................................................................................<span class="_ _d"></span>16-275, 17-335</span></div><div class="t m0 x74 h16 y556 ff8 fs3 fc0 sc0 ls0 ws0">T9<span class="_ _15"> </span><span class="fs7">.................................................................................................<span class="_ _e"> </span>17-336 </span></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1ba" class="pf w1 h2" data-page-no="1ba"><div class="pc pc1ba w1 h2"><img class="bi xd ycf4 w4 h84" alt="" src="bg1ba.png"/><div class="t m0 x29 h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">411</div><div class="t m0 x85 h9 y5d ff1 fs4 fc0 sc0 ls0 ws0">Epilo<span class="_ _4"></span>gue</div><div class="t m0 xd h14 y173 ff8 fs3 fc0 sc0 ls0 ws284">In 2005, while attending the <span class="_ _1"></span>Agile conference in Den<span class="_ _4"></span>ver<span class="_ _1"></span>, Elisabeth Hedrickson</div><div class="t m0 x63 h21 y16d5 ff8 fsc fc0 sc0 ls0 ws0">1</div><div class="t m0 x93 h14 y173 ff8 fs3 fc0 sc0 ls0 ws284">handed me</div><div class="t m0 xd h14 y174 ff8 fs3 fc0 sc0 ls0 ws460">a green wrist band similar to the kind that Lance <span class="_ _4"></span>Ar<span class="_ _8"></span>mstrong made so popular<span class="_ _1"></span>. <span class="_ _4"></span>This one</div><div class="t m0 xd h14 y175 ff8 fs3 fc0 sc0 ls0 ws5fe">said “T<span class="_ _0"></span>est Obsessed” on it. I gladly put it on and w<span class="_ _1"></span>ore it proudly<span class="_ _0"></span>. Since learning <span class="_ _4"></span>TDD from</div><div class="t m0 xd h14 y176 ff8 fs3 fc0 sc0 ls0 ws0">Kent Beck in 1999, I ha<span class="_ _1"></span>ve indeed become obsessed with test-dri<span class="_ _4"></span>ven dev<span class="_ _4"></span>elopment.</div><div class="t m0 x74 h14 y177 ff8 fs3 fc0 sc0 ls0 ws5f7">But then something strange happened. I found I could not take the band of<span class="_ _4"></span>f. Not</div><div class="t m0 xd h14 y230 ff8 fs3 fc0 sc0 lsd ws13d">because it was ph<span class="_ _1"></span>ysically stuck, but because it w<span class="_ _4"></span>as <span class="ffa ls0 ws0">mor<span class="_ _4"></span>ally <span class="ff8 ws4e">stuck. <span class="_ _4"></span>The band made an o<span class="_ _4"></span>vert</span></span></div><div class="t m0 xd h14 y231 ff8 fs3 fc0 sc0 ls0 ws5d5">statement about m<span class="_ _4"></span>y professional ethics. It was a visib<span class="_ _4"></span>le indication of m<span class="_ _4"></span>y committment to</div><div class="t m0 xd h14 y232 ff8 fs3 fc0 sc0 ls0 ws417">writing the best code I could write. <span class="_ _1"></span>T<span class="_ _1"></span>aking it off seemed like a betra<span class="_ _1"></span>yal of those ethics and</div><div class="t m0 xd h14 y16d6 ff8 fs3 fc0 sc0 ls0 ws0">of that committment.</div><div class="t m0 x74 h14 y234 ff8 fs3 fc0 sc0 ls0 wsf6">So it is on m<span class="_ _4"></span>y wrist still. <span class="_ _4"></span>When I write code, I see it there in my peripheral vision. It is</div><div class="t m0 xd h14 y235 ff8 fs3 fc0 sc0 ls0 ws0">a constant reminder of the promise I made to m<span class="_ _4"></span>yself to write clean code.</div><div class="t m0 xd h1f y16d7 ff8 fse fc0 sc0 ls0 ws0">1.<span class="_ _17"> </span><span class="fsb">http://www<span class="_ _0"></span>.qualitytree.com/</span></div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:303.099000px;bottom:527.330010px;width:135.690000px;height:40.104000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://www.qualitytree.com/"><div class="d m1" style="border-style:none;position:absolute;left:90.825000px;bottom:76.367110px;width:89.944000px;height:8.751800px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1bb" class="pf w1 h2" data-page-no="1bb"><div class="pc pc1bb w1 h2"><div class="t m0 x15 h12 y5a ff9 fs7 fc1 sc0 ls7 ws10">This page intentionally left blank </div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.095000,0.650010]}'></div></div>
<div id="pf1bc" class="pf w1e h2" data-page-no="1bc"><div class="pc pc1bc w1e h2"><img class="bi xd y5b w4 h13" alt="" src="bg1bc.png"/><div class="t m0 x29 h14 y5c ff8 fs3 fc0 sc0 ls0 ws0">413</div><div class="t m0 x79 h9 y5d ff1 fs4 fc0 sc0 ls0 ws0">Inde<span class="_ _1"></span>x</div><div class="t m0 xd h14 y5dd ff8 fs3 fc0 sc0 ls0 ws0">## detection, 237–238</div><div class="t m5 xd h2f y2ac ffb fs10 fc0 sc0 ls0 ws0">++</div><div class="t m0 x37 h14 y2ac ff8 fs3 fc0 sc0 ls0 ws0"> (pre- or post-increment) operator, </div><div class="t m0 x9a h14 y2ad ff8 fs3 fc0 sc0 ls0 ws0">325, 326</div><div class="t m0 xd6 h17 y16d8 ff1 fs9 fc0 sc0 ls0 ws0">A</div><div class="t m0 xd h14 y848 ff8 fs3 fc0 sc0 ls0 ws0">aborted computation, 109</div><div class="t m0 xd h14 y849 ff8 fs3 fc0 sc0 ls0 ws0">abstract classes, 149, 271, 290</div><div class="t m0 xd h14 yba0 ff8 fs3 fc0 sc0 ls0 ws79">ABSTRACT FACTORY pattern, 38, 156, </div><div class="t m0 x9a h14 y803 ff8 fs3 fc0 sc0 ls0 ws0">273, 274</div><div class="t m0 xd h14 y804 ff8 fs3 fc0 sc0 ls0 ws0">abstract interfaces, 94</div><div class="t m0 xd h14 y13ac ff8 fs3 fc0 sc0 ls0 ws0">abstract methods</div><div class="t m0 x74 h14 y1447 ff8 fs3 fc0 sc0 ls0 ws493">adding to </div><div class="t m5 x14 h2f y468 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x92 h14 y468 ff8 fs3 fc0 sc0 ls0 ws493">, 234–235</div><div class="t m0 x74 h14 y469 ff8 fs3 fc0 sc0 ls0 ws0">modifying, 282</div><div class="t m0 xd h14 y46a ff8 fs3 fc0 sc0 ls0 ws0">abstract terms, 95</div><div class="t m0 xd h14 y3a9 ff8 fs3 fc0 sc0 ls0 ws0">abstraction</div><div class="t m0 x74 h14 y3aa ff8 fs3 fc0 sc0 ls0 ws0">classes depending on, 150</div><div class="t m0 x74 h14 y3ab ff8 fs3 fc0 sc0 ls0 ws0">code at wrong level of, 290–291</div><div class="t m0 x74 h14 y390 ff8 fs3 fc0 sc0 ls0 ws0">descending one level at a time, 37</div><div class="t m0 x74 h14 y479 ff8 fs3 fc0 sc0 ls0 ws0">functions descending only one level </div><div class="t m0 x9a h14 y47a ff8 fs3 fc0 sc0 ls0 ws0">of, 304–306</div><div class="t m0 x74 h14 y1399 ff8 fs3 fc0 sc0 ls0 ws0">mixing levels of, 36–37</div><div class="t m0 x74 h14 y139a ff8 fs3 fc0 sc0 ls0 ws0">names at the appropriate level of, 311</div><div class="t m0 x74 h14 yd7c ff8 fs3 fc0 sc0 ls0 ws0">separating levels of, 305</div><div class="t m0 x74 h14 y676 ff8 fs3 fc0 sc0 ls0 ws0">wrapping an implementation, 11</div><div class="t m0 xd h14 y677 ff8 fs3 fc0 sc0 ls0 ws0">abstraction levels</div><div class="t m0 x74 h14 y678 ff8 fs3 fc0 sc0 ls0 ws0">raising, 290</div><div class="t m0 x74 h14 y679 ff8 fs3 fc0 sc0 ls0 ws0">separating, 305</div><div class="t m0 xd h14 y67a ff8 fs3 fc0 sc0 ls0 ws0">accessor functions, Law of Demeter </div><div class="t m0 x9a h14 y67b ff8 fs3 fc0 sc0 ls0 ws0">and, 98</div><div class="t m0 xd h14 y67c ff8 fs3 fc0 sc0 ls0 ws0">accessors, naming, 25</div><div class="t m0 xd h14 yc83 ff8 fs3 fc0 sc0 ls0 ws0">Active Records, 101</div><div class="t m0 xd h14 yc84 ff8 fs3 fc0 sc0 ls0 ws0">adapted server, 185</div><div class="t m0 x23 h14 y16d9 ff8 fs3 fc0 sc0 ls0 ws0">affinity, 84</div><div class="t m0 x23 h1d y16da ffa fs3 fc0 sc0 ls0 ws0">Agile Software Development: Principles, </div><div class="t m0 x85 h14 y16db ffa fs3 fc0 sc0 ls0 ws0">Patterns, Practices (PPP)<span class="ff8">, 15</span></div><div class="t m0 x23 h14 y5d1 ff8 fs3 fc0 sc0 ls0 ws0">algorithms</div><div class="t m0 x7e h14 y5d2 ff8 fs3 fc0 sc0 ls0 ws0">correcting, 269–270</div><div class="t m0 x7e h14 y2d7 ff8 fs3 fc0 sc0 ls0 ws0">repeating, 48</div><div class="t m0 x7e h14 y2d8 ff8 fs3 fc0 sc0 ls0 ws0">understanding, 297–298</div><div class="t m0 x23 h14 y13b5 ff8 fs3 fc0 sc0 ls0 ws0">ambiguities</div><div class="t m0 x7e h14 y2d9 ff8 fs3 fc0 sc0 ls0 ws0">in code, 301</div><div class="t m0 x7e h14 y2da ff8 fs3 fc0 sc0 ls0 ws0">ignored tests as, 313</div><div class="t m0 x23 h14 y2db ff8 fs3 fc0 sc0 ls0 ws0">amplification comments, 59</div><div class="t m0 x23 h14 y3a5 ff8 fs3 fc0 sc0 ls0 ws0">analysis functions, 265</div><div class="t m0 x23 h14 y3a6 ff8 fs3 fc0 sc0 ls0 ws0">“annotation form”, of AspectJ, 166</div><div class="t m0 x23 h14 y3a7 ff8 fs3 fc0 sc0 ls0 ws0">Ant project, 76, 77</div><div class="t m0 x23 h14 y3a8 ff8 fs3 fc0 sc0 ls0 ws0">AOP (aspect-oriented programming), </div><div class="t m0 x85 h14 y38d ff8 fs3 fc0 sc0 ls0 ws0">160, 163</div><div class="t m0 x23 h14 y38e ff8 fs3 fc0 sc0 ls0 ws0">APIs. <span class="ffa">See also</span> public APIs</div><div class="t m0 x7e h14 y38f ff8 fs3 fc0 sc0 ls0 ws0">calling a </div><div class="t m5 x6a h2f y38f ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xa0 h14 y38f ff8 fs3 fc0 sc0 ls0 ws0">-returning method </div><div class="t m0 x85 h14 y670 ff8 fs3 fc0 sc0 ls0 ws0">from, 110</div><div class="t m0 x7e h14 y671 ff8 fs3 fc0 sc0 ls0 ws0">specialized for tests, 127</div><div class="t m0 x7e h14 y672 ff8 fs3 fc0 sc0 ls0 ws0">wrapping third-party, 108</div><div class="t m0 x23 h14 y673 ff8 fs3 fc0 sc0 ls0 ws0">applications</div><div class="t m0 x7e h14 y674 ff8 fs3 fc0 sc0 ls0 ws0">decoupled from Spring, 164</div><div class="t m0 x7e h14 y675 ff8 fs3 fc0 sc0 ls0 ws0">decoupling from construction </div><div class="t m0 x85 h14 y491 ff8 fs3 fc0 sc0 ls0 ws0">details, 156</div><div class="t m0 x7e h14 y492 ff8 fs3 fc0 sc0 ls0 ws0">infrastructure of, 163</div><div class="t m0 x7e h14 y493 ff8 fs3 fc0 sc0 ls0 ws0">keeping concurrency-related code </div><div class="t m0 x85 h14 y16dc ff8 fs3 fc0 sc0 ls0 ws0">separate, 181</div><div class="t m0 x23 h14 y16dd ff8 fs3 fc0 sc0 ls0 ws0">arbitrary structure, 303–304</div><div class="t m5 x23 h2f y2ee ffb fs10 fc0 sc0 ls0 ws0">args</div><div class="t m0 xea h14 y2ee ff8 fs3 fc0 sc0 ls0 ws7dd">array, converting into a </div><div class="t m5 xbd h2f y2ee ffb fs10 fc0 sc0 ls0 ws0">list</div><div class="t m0 xd3 h14 y2ee ff8 fs3 fc0 sc0 ls0 ws7dd">, 231–232</div><div class="t m5 x23 h2f y2ef ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x7e h14 y2ef ff8 fs3 fc0 sc0 ls0 ws0"> class</div><div class="t m0 x7e h14 ya5d ff8 fs3 fc0 sc0 ls0 ws0">constructing, 194</div><div class="t m0 x7e h14 ye40 ff8 fs3 fc0 sc0 ls0 ws0">implementation of, 194–200</div><div class="t m0 x7e h14 ye41 ff8 fs3 fc0 sc0 ls0 ws0">rough drafts of, 201–212, 226–231</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",-48,671,1]'><div class="d m1" style="border-style:none;position:absolute;left:351.133970px;bottom:527.330010px;width:87.306000px;height:40.104000px;background-color:rgba(255,255,255,0.000001);"></div></a><div class="d m1" style="border-style:none;position:absolute;left:132.553970px;bottom:461.528010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.553970px;bottom:461.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.393970px;bottom:437.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.393970px;bottom:437.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.883970px;bottom:386.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.763970px;bottom:374.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.763970px;bottom:374.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.763970px;bottom:374.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.673970px;bottom:362.528010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:229.543970px;bottom:362.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.393970px;bottom:350.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.393970px;bottom:350.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.863970px;bottom:338.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.393970px;bottom:314.529010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:234.393970px;bottom:314.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.063970px;bottom:302.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.213970px;bottom:290.529010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.823970px;bottom:266.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:190.813970px;bottom:254.529010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:210.813970px;bottom:254.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.203970px;bottom:242.529010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.723970px;bottom:218.529010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.723970px;bottom:218.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.393970px;bottom:206.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.393970px;bottom:206.529010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:232.193970px;bottom:194.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.153970px;bottom:182.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:216.383970px;bottom:170.529010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.613970px;bottom:146.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.493970px;bottom:134.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:133.833970px;bottom:110.529010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.153970px;bottom:98.529210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.323970px;bottom:86.529210px;width:15.000000px;height:9.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.423970px;bottom:74.529210px;width:15.000000px;height:9.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:301.708970px;bottom:461.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:412.389970px;bottom:437.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.808970px;bottom:413.528010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.808970px;bottom:413.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.478970px;bottom:401.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.928970px;bottom:389.528010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.928970px;bottom:389.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.428970px;bottom:365.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.928970px;bottom:353.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.208970px;bottom:341.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.208970px;bottom:329.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.798970px;bottom:317.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:317.538970px;bottom:305.528010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.538970px;bottom:305.528010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.268970px;bottom:281.528010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.268970px;bottom:281.528010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.708970px;bottom:245.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.138970px;bottom:233.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.308970px;bottom:221.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:382.478970px;bottom:197.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.378970px;bottom:173.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.968970px;bottom:161.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.028970px;bottom:137.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.188970px;bottom:125.529010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.188970px;bottom:125.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.267970px;bottom:113.529010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:423.267970px;bottom:113.529010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.708970px;bottom:89.529110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.878970px;bottom:77.529110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.878970px;bottom:77.529110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.698970px;bottom:65.529110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.698970px;bottom:65.529110px;width:17.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.698970px;bottom:65.529110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:409.698970px;bottom:65.529110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1bd" class="pf w1f h2" data-page-no="1bd"><div class="pc pc1bd w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">414<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m5 xd h2f y194 ffb fs10 fc0 sc0 ls0 ws0">ArgsException</div><div class="t m0 x28 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0"> class</div><div class="t m0 x74 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">listing, 198–200</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">merging exceptions into, 239–242</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">argument(s)</div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">flag, 41</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">for a function, 40</div><div class="t m0 x74 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">in functions, 288</div><div class="t m0 x74 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">monadic forms of, 41</div><div class="t m0 x74 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">reducing, 43</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">argument lists, 43</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">argument objects, 43</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">argument types</div><div class="t m0 x74 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">adding, 200, 237</div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">negative impact of, 208</div><div class="t m5 xd h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xe4 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0"> class</div><div class="t m0 x74 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">adding the skeleton of, 213–214</div><div class="t m0 x74 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">birth of, 212</div><div class="t m5 xd h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xe4 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0"> interface, 197–198</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">arrays, moving, 279</div><div class="t m0 xd h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">art, of clean code, 6–7</div><div class="t m0 xd h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">artificial coupling, 293</div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">AspectJ language, 166</div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">aspect-oriented programming (AOP), </div><div class="t m0 x3f h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">160, 163</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">aspects</div><div class="t m0 x74 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">in AOP, 160–161</div><div class="t m0 x74 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">“first-class” support for, 166</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">assert statements, 130–131</div><div class="t m5 xd h2f y15a4 ffb fs10 fc0 sc0 ls0 ws0">assertEquals</div><div class="t m0 x41 h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0">, 42</div><div class="t m0 xd h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">assertions, using a set of, 111</div><div class="t m0 xd h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">assignments, unaligned, 87–88</div><div class="t m0 xd h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">atomic operation, 323–324</div><div class="t m0 xd h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">attributes, 68</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">authors</div><div class="t m0 x74 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">of JUnit, 252</div><div class="t m0 x74 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">programmers as, 13–14</div><div class="t m0 xd h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">authorship statements, 55</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">automated code instrumentation, 189–190</div><div class="t m0 xd h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">automated suite, of unit tests, 124</div><div class="t m0 xd6 h17 y16de ff1 fs9 fc0 sc0 ls0 ws0">B</div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">bad code, 3–4. <span class="ffa">See also</span> dirty code; </div><div class="t m0 x3f h14 y144c ff8 fs3 fc0 sc0 ls0 ws0">messy code</div><div class="t m0 x74 h14 y16df ff8 fs3 fc0 sc0 ls0 ws0">degrading effect of, 250</div><div class="t m0 xb2 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">example, 71–72</div><div class="t m0 xb2 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">experience of cleaning, 250</div><div class="t m0 xb2 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">not making up for, 55</div><div class="t m0 x23 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">bad comments, 59–74</div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">banner, gathering functions beneath, 67</div><div class="t m0 x23 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">base classes, 290, 291</div><div class="t m0 x23 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">BDUF (Big Design Up Front), 167</div><div class="t m0 x23 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">beans, private variables manipulated, </div><div class="t m0 x85 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">100–101</div><div class="t m0 x23 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">Beck, Kent, 3, 34, 71, 171, 252, </div><div class="t m0 x85 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">289, 296</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">behaviors, 288–289</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">Big Design Up Front (BDUF), 167</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">blank lines, in code, 78–79</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">blocks, calling functions within, 35</div><div class="t m0 x23 h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">Booch,Grady, 8–9</div><div class="t m0 x23 h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">boolean, passing into a function, 41</div><div class="t m0 x23 h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">boolean arguments, 194, 288</div><div class="t m5 x23 h2f y423 ffb fs10 fc0 sc0 ls0 ws0">boolean</div><div class="t m0 x27 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0"> map, deleting, 224</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">boolean output, of tests, 132</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">bound resources, 183, 184</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">boundaries</div><div class="t m0 xb2 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">clean, 120</div><div class="t m0 xb2 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">exploring and learning, 116</div><div class="t m0 xb2 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">incorrect behavior at, 289</div><div class="t m0 xb2 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">separating known from unknown, </div><div class="t m0 x85 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">118–119</div><div class="t m0 x23 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">boundary condition errors, 269</div><div class="t m0 x23 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">boundary conditions</div><div class="t m0 xb2 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">encapsulating, 304</div><div class="t m0 xb2 h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">testing, 314</div><div class="t m0 x23 h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">boundary tests, easing a migration, 118</div><div class="t m0 x23 h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">“Bowling Game”, 312</div><div class="t m0 x23 h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">Boy Scout Rule, 14–15, 257</div><div class="t m0 xb2 h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">following, 284</div><div class="t m0 xb2 h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">satisfying, 265</div><div class="t m0 x23 h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">broken windows metaphor, 8</div><div class="t m0 x23 h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">bucket brigade, 303</div><div class="t m0 x23 h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">BUILD-OPERATE-CHECK pattern, 127</div><div class="t m0 x23 h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">builds, 287</div><div class="t m0 x23 h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">business logic, separating from error </div><div class="t m0 x85 h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">handling, 109</div><div class="t m0 x23 h14 y16f6 ff8 fs3 fc0 sc0 ls0 ws0">bylines, 68</div><div class="t m0 x23 h14 y16f7 ff8 fs3 fc0 sc0 ls0 ws0">byte-manipulation libraries, 161, </div><div class="t m0 x85 h14 y16f8 ff8 fs3 fc0 sc0 ls0 ws0">162–163</div><div class="d m1" style="border-style:none;position:absolute;left:126.729990px;bottom:573.153010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.729990px;bottom:573.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.379990px;bottom:561.153010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:218.379990px;bottom:561.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:117.269990px;bottom:537.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.149990px;bottom:525.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.219990px;bottom:513.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.819990px;bottom:501.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.709990px;bottom:489.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.109990px;bottom:477.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.319990px;bottom:465.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.939990px;bottom:441.153010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.939990px;bottom:441.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.149990px;bottom:429.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:190.319990px;bottom:405.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:210.319990px;bottom:405.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.439990px;bottom:393.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.494990px;bottom:381.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.494990px;bottom:381.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.709990px;bottom:369.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.579990px;bottom:357.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.579990px;bottom:357.154010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.099990px;bottom:345.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.979990px;bottom:333.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.719990px;bottom:309.154010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.719990px;bottom:309.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.999990px;bottom:285.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.999990px;bottom:285.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.139990px;bottom:273.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.209990px;bottom:261.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.209990px;bottom:261.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.456990px;bottom:249.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.209990px;bottom:237.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.049990px;bottom:225.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.049990px;bottom:225.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.209990px;bottom:213.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.209990px;bottom:213.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:120.939990px;bottom:201.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.219990px;bottom:177.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.869990px;bottom:165.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.869990px;bottom:165.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.659990px;bottom:153.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:212.039990px;bottom:141.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:232.039990px;bottom:141.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.439990px;bottom:129.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:119.539990px;bottom:78.154110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.539990px;bottom:78.154110px;width:7.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.799990px;bottom:54.154110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.724990px;bottom:585.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.724990px;bottom:585.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.364990px;bottom:573.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.784990px;bottom:561.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.894990px;bottom:549.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.894990px;bottom:549.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:416.144990px;bottom:537.153010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.884990px;bottom:525.153010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.884990px;bottom:525.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.844990px;bottom:513.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:489.153010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.844990px;bottom:489.153010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:317.834990px;bottom:477.153010px;width:7.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.834990px;bottom:477.153010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.834990px;bottom:477.153010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.834990px;bottom:477.153010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:377.834990px;bottom:477.153010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:465.154010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.844990px;bottom:465.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.724990px;bottom:453.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.724990px;bottom:453.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.844990px;bottom:441.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.614990px;bottom:429.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.614990px;bottom:429.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:398.954990px;bottom:417.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.444990px;bottom:405.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.444990px;bottom:405.154010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.334990px;bottom:393.154010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.664990px;bottom:381.154010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:368.664990px;bottom:381.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:359.964990px;bottom:369.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.174990px;bottom:357.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.104990px;bottom:345.154010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.104990px;bottom:345.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.944990px;bottom:321.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.384990px;bottom:309.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.594990px;bottom:297.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:273.154010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.844990px;bottom:273.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.714990px;bottom:261.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.834990px;bottom:237.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:317.514990px;bottom:225.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:409.774990px;bottom:213.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.554990px;bottom:201.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.184990px;bottom:189.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.184990px;bottom:189.154010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.184990px;bottom:189.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.734990px;bottom:177.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.734990px;bottom:165.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:379.494990px;bottom:153.154010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.994990px;bottom:141.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:419.214990px;bottom:129.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:297.294990px;bottom:117.154010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.844990px;bottom:93.154210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:301.734990px;bottom:81.154210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.444990px;bottom:69.154210px;width:17.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:57.154210px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.844990px;bottom:57.154210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1be" class="pf w1e h2" data-page-no="1be"><div class="pc pc1be w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">415<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd6 h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">C</div><div class="t m0 xd h14 y2a4 ffa fs3 fc0 sc0 ls0 ws0">The C++ Programming Language<span class="ff8">, 7</span></div><div class="t m0 xd h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">calculations, breaking into intermediate </div><div class="t m0 x3f h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws0">values, 296</div><div class="t m0 xd h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws0">call stack, 324</div><div class="t m5 xd h2f y2a7 ffb fs10 fc0 sc0 ls0 ws0">Callable</div><div class="t m0 x9a h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0"> interface, 326</div><div class="t m0 xd h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">caller, cluttering, 104</div><div class="t m0 xd h14 y56f ff8 fs3 fc0 sc0 ls0 ws0">calling hierarchy, 106</div><div class="t m0 xd h14 ya72 ff8 fs3 fc0 sc0 ls0 ws0">calls, avoiding chains of, 98</div><div class="t m0 xd h14 ye7c ff8 fs3 fc0 sc0 ls0 ws0">caring, for code, 10</div><div class="t m0 xd h14 y444 ff8 fs3 fc0 sc0 ls0 ws0">Cartesian points, 42</div><div class="t m0 xd h14 y445 ff8 fs3 fc0 sc0 ls0 ws0">CAS operation, as atomic, 328</div><div class="t m0 xd h14 y446 ff8 fs3 fc0 sc0 ls0 ws0">change(s)</div><div class="t m0 x74 h14 ybaa ff8 fs3 fc0 sc0 ls0 ws0">isolating from, 149–150</div><div class="t m0 x74 h14 ybab ff8 fs3 fc0 sc0 ls0 ws0">large number of very tiny, 213</div><div class="t m0 x74 h14 y13d2 ff8 fs3 fc0 sc0 ls0 ws0">organizing for, 147–150</div><div class="t m0 x74 h14 y16f9 ff8 fs3 fc0 sc0 ls0 ws0">tests enabling, 124</div><div class="t m0 xd h14 y883 ff8 fs3 fc0 sc0 ls0 ws0">change history, deleting, 270</div><div class="t m0 xd h14 y2b3 ff8 fs3 fc0 sc0 ls0 ws0">check exceptions, in Java, 106</div><div class="t m0 xd h14 y2b4 ff8 fs3 fc0 sc0 ls0 ws0">circular wait, 337, 338–339</div><div class="t m0 xd h14 y2b5 ff8 fs3 fc0 sc0 ls0 ws0">clarification, comments as, 57</div><div class="t m0 xd h14 yc99 ff8 fs3 fc0 sc0 ls0 ws0">clarity, 25, 26</div><div class="t m0 xd h14 y63b ff8 fs3 fc0 sc0 ls0 ws0">class names, 25</div><div class="t m0 xd h14 y63c ff8 fs3 fc0 sc0 ls0 ws0">classes</div><div class="t m0 x74 h14 yacb ff8 fs3 fc0 sc0 ls0 ws0">cohesion of, 140–141</div><div class="t m0 x74 h14 yacc ff8 fs3 fc0 sc0 ls0 ws0">creating for bigger concepts, 28–29</div><div class="t m0 x74 h14 ybd7 ff8 fs3 fc0 sc0 ls0 ws0">declaring instance variables, 81</div><div class="t m0 x74 h14 ybd8 ff8 fs3 fc0 sc0 ls0 ws0">enforcing design and business </div><div class="t m0 x3f h14 y1552 ff8 fs3 fc0 sc0 ls0 ws0">rules, 115</div><div class="t m0 x74 h14 y5eb ff8 fs3 fc0 sc0 ls0 ws0">exposing internals of, 294</div><div class="t m0 x74 h14 y16fa ff8 fs3 fc0 sc0 ls0 ws0">instrumenting into ConTest, 342</div><div class="t m0 x74 h14 y15cd ff8 fs3 fc0 sc0 ls0 ws0">keeping small, 136, 175</div><div class="t m0 x74 h14 y118d ff8 fs3 fc0 sc0 ls0 ws0">minimizing the number of, 176</div><div class="t m0 x74 h14 y16fb ff8 fs3 fc0 sc0 ls0 ws0">naming, 25, 138</div><div class="t m0 x74 h14 y16fc ff8 fs3 fc0 sc0 ls0 ws0">nonthread-safe, 328–329</div><div class="t m0 x74 h14 y16fd ff8 fs3 fc0 sc0 ls0 ws0">as nouns of a language, 49</div><div class="t m0 x74 h14 y16fe ff8 fs3 fc0 sc0 ls0 ws0">organization of, 136</div><div class="t m0 x74 h14 y16ff ff8 fs3 fc0 sc0 ls0 ws0">organizing to reduce risk of </div><div class="t m0 x3f h14 y8fd ff8 fs3 fc0 sc0 ls0 ws0">change, 147</div><div class="t m0 x74 h14 y8fe ff8 fs3 fc0 sc0 ls0 ws0">supporting advanced concurrency </div><div class="t m0 x3f h14 y1700 ff8 fs3 fc0 sc0 ls0 ws0">design, 183</div><div class="t m0 xd h14 yc1e ff8 fs3 fc0 sc0 ls0 ws0">classification, of errors, 107</div><div class="t m0 x23 h14 y1701 ff8 fs3 fc0 sc0 ls0 ws0">clean boundaries, 120</div><div class="t m0 x23 h14 y1702 ff8 fs3 fc0 sc0 ls0 ws0">clean code</div><div class="t m0 x7e h14 y1703 ff8 fs3 fc0 sc0 ls0 ws0">art of, 6–7</div><div class="t m0 x7e h14 y1704 ff8 fs3 fc0 sc0 ls0 ws0">described, 7–12</div><div class="t m0 x7e h14 y1705 ff8 fs3 fc0 sc0 ls0 ws0">writing, 6–7</div><div class="t m0 x23 h14 y1706 ff8 fs3 fc0 sc0 ls0 ws0">clean tests, 124–127</div><div class="t m0 x23 h14 y4ec ff8 fs3 fc0 sc0 ls0 ws0">cleanliness</div><div class="t m0 x7e h14 y1707 ff8 fs3 fc0 sc0 ls0 ws0">acquired sense of, 6–7</div><div class="t m0 x7e h14 y1708 ff8 fs3 fc0 sc0 ls0 ws0">tied to tests, 9</div><div class="t m0 x23 h14 y15a7 ff8 fs3 fc0 sc0 ls0 ws0">cleanup, of code, 14–15</div><div class="t m0 x23 h14 y1709 ff8 fs3 fc0 sc0 ls0 ws0">clever names, 26</div><div class="t m0 x23 h14 y170a ff8 fs3 fc0 sc0 ls0 ws0">client, using two methods, 330</div><div class="t m0 x23 h14 y170b ff8 fs3 fc0 sc0 ls0 ws0">client code, connecting to a server, 318</div><div class="t m0 x23 h14 y170c ff8 fs3 fc0 sc0 ls0 ws0">client-based locking, 185, 329, 330–332</div><div class="t m5 x23 h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">clientScheduler</div><div class="t m0 xab h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0">, 320</div><div class="t m0 x23 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">client/server application, concurrency in, </div><div class="t m0 x85 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">317–321</div><div class="t m0 x23 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">Client/Server nonthreaded, code for, </div><div class="t m0 x85 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">343–346</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">client-server using threads, code changes, </div><div class="t m0 x85 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">346–347</div><div class="t m5 x23 h2f yd2a ffb fs10 fc0 sc0 ls0 ws0">ClientTest.java</div><div class="t m0 xab h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">, 318, 344–346</div><div class="t m0 x23 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">closing braces, comments on, 67–68</div><div class="t m0 x23 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">Clover, 268, 269</div><div class="t m0 x23 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">clutter</div><div class="t m0 x7e h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">Javadocs as, 276</div><div class="t m0 x7e h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">keeping free of, 293</div><div class="t m0 x23 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">code, 2</div><div class="t m0 x7e h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">bad, 3–4</div><div class="t m0 x7e h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">Beck&apos;s rules of, 10</div><div class="t m0 x7e h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">commented-out, 68–69, 287</div><div class="t m0 x7e h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">dead, 292</div><div class="t m0 x7e h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">explaining yourself in, 55</div><div class="t m0 x7e h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">expressing yourself in, 54</div><div class="t m0 x7e h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">formatting of, 76</div><div class="t m0 x7e h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">implicity of, 18–19</div><div class="t m0 x7e h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">instrumenting, 188, 342</div><div class="t m0 x7e h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">jiggling, 190</div><div class="t m0 x7e h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">making readable, 311</div><div class="t m0 x7e h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">necessity of, 2</div><div class="t m0 x7e h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">reading from top to bottom, 37</div><div class="t m0 x7e h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">simplicity of, 18, 19</div><div class="t m0 x7e h14 y16f6 ff8 fs3 fc0 sc0 ls0 ws0">technique for shrouding, 20</div><div class="d m1" style="border-style:none;position:absolute;left:222.833970px;bottom:562.851010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.619970px;bottom:538.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:121.559970px;bottom:526.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.040970px;bottom:514.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.609970px;bottom:502.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.549970px;bottom:490.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.279970px;bottom:478.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.099970px;bottom:466.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.789970px;bottom:454.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.839970px;bottom:442.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.459970px;bottom:418.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.459970px;bottom:418.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.269970px;bottom:406.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.999970px;bottom:394.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.999970px;bottom:394.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.789970px;bottom:382.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.889970px;bottom:370.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.709970px;bottom:358.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.329970px;bottom:346.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.329970px;bottom:346.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.329970px;bottom:346.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.329970px;bottom:334.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:109.619970px;bottom:322.851010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:124.619970px;bottom:322.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.559970px;bottom:310.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.449970px;bottom:286.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.449970px;bottom:286.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:213.979970px;bottom:274.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:228.979970px;bottom:274.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:213.149970px;bottom:262.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.509970px;bottom:238.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.949970px;bottom:226.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:212.079970px;bottom:214.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.899970px;bottom:202.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.899970px;bottom:202.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.789970px;bottom:190.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:132.069970px;bottom:178.851010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.069970px;bottom:178.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.489970px;bottom:166.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.489970px;bottom:166.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.159970px;bottom:154.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.889970px;bottom:142.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.389970px;bottom:118.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.179970px;bottom:94.851210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.989970px;bottom:82.851210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.174970px;bottom:584.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:312.074970px;bottom:560.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.074970px;bottom:560.850010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.014970px;bottom:548.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.014970px;bottom:548.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.584970px;bottom:536.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.584970px;bottom:536.850010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:314.074970px;bottom:524.850010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.074970px;bottom:524.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:360.114970px;bottom:500.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.114970px;bottom:500.850010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.254970px;bottom:488.850010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.504970px;bottom:476.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.504970px;bottom:476.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.174970px;bottom:464.850010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.474970px;bottom:452.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:409.324970px;bottom:440.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.514970px;bottom:428.850010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.514970px;bottom:428.850010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:393.514970px;bottom:428.850010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:413.514970px;bottom:428.850010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.365970px;bottom:416.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:392.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:392.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:368.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:368.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:344.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:344.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.365970px;bottom:332.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.365970px;bottom:332.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:377.365970px;bottom:332.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.234970px;bottom:320.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.234970px;bottom:320.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:299.914970px;bottom:308.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.914970px;bottom:308.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.624970px;bottom:284.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.224970px;bottom:272.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:291.574970px;bottom:260.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:305.134970px;bottom:248.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:315.134970px;bottom:248.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.704970px;bottom:236.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.464970px;bottom:224.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:368.464970px;bottom:224.852010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.464970px;bottom:224.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:309.574970px;bottom:212.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.464970px;bottom:200.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:379.014970px;bottom:188.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.744970px;bottom:176.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.644970px;bottom:164.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.644970px;bottom:164.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.254970px;bottom:152.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.254970px;bottom:152.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.814970px;bottom:140.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.064970px;bottom:128.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.184970px;bottom:116.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:399.024970px;bottom:104.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.534970px;bottom:92.852210px;width:12.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.534970px;bottom:92.852210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.234970px;bottom:80.852210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1bf" class="pf w1f h2" data-page-no="1bf"><div class="pc pc1bf w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">416<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">code, <span class="ffa">continued</span></div><div class="t m0 x74 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">third-party, 114–115</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">width of lines in, 85–90</div><div class="t m0 x74 h14 y197 ff8 fs3 fc0 sc0 ls0 ws7de">at wrong level of abstraction, 290–291</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">code bases, dominated by error </div><div class="t m0 x3f h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">handling, 103</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">code changes, comments not always </div><div class="t m0 x3f h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">following, 54</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">code completion, automatic, 20</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">code coverage analysis, 254–256</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">code instrumentation, 188–190</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">“code sense”, 6, 7</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">code smells, listing of, 285–314</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">coding standard, 299</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">cohesion</div><div class="t m0 x74 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">of classes, 140–141</div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">maintaining, 141–146</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">command line arguments, 193–194</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws7df">commands, separating from queries, 45–46</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">comment header standard, 55–56</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">comment headers, replacing, 70</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">commented-out code, 68–69, 287</div><div class="t m0 xd h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">commenting style, example of bad, 71–72</div><div class="t m0 xd h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">comments</div><div class="t m0 x74 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">amplifying importance of </div><div class="t m0 x3f h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">something, 59</div><div class="t m0 x74 h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">bad, 59–74</div><div class="t m0 x74 h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">deleting, 282</div><div class="t m0 x74 h14 y1710 ff8 fs3 fc0 sc0 ls0 ws0">as failures, 54</div><div class="t m0 x74 h14 y152e ff8 fs3 fc0 sc0 ls0 ws0">good, 55–59</div><div class="t m0 x74 h14 y152f ff8 fs3 fc0 sc0 ls0 ws0">heuristics on, 286–287</div><div class="t m0 x74 h14 y1530 ff8 fs3 fc0 sc0 ls0 ws0">HTML, 69</div><div class="t m0 x74 h14 y111f ff8 fs3 fc0 sc0 ls0 ws0">inaccurate, 54</div><div class="t m0 x74 h14 y210 ff8 fs3 fc0 sc0 ls0 ws0">informative, 56</div><div class="t m0 x74 h14 y211 ff8 fs3 fc0 sc0 ls0 ws0">journal, 63–64</div><div class="t m0 x74 h14 y212 ff8 fs3 fc0 sc0 ls0 ws0">legal, 55–56</div><div class="t m0 x74 h14 y213 ff8 fs3 fc0 sc0 ls0 ws0">mandated, 63</div><div class="t m0 x74 h14 y214 ff8 fs3 fc0 sc0 ls0 ws0">misleading, 63</div><div class="t m0 x74 h14 y215 ff8 fs3 fc0 sc0 ls0 ws0">mumbling, 59–60</div><div class="t m0 x74 h14 y216 ff8 fs3 fc0 sc0 ls0 ws0">as a necessary evil, 53–59</div><div class="t m0 x74 h14 y1d7 ff8 fs3 fc0 sc0 ls0 ws0">noise, 64–66</div><div class="t m0 x74 h14 y1d8 ff8 fs3 fc0 sc0 ls0 ws0">not making up for bad code, 55</div><div class="t m0 x74 h14 y1d9 ff8 fs3 fc0 sc0 ls0 ws0">obsolete, 286</div><div class="t m0 x74 h14 y1316 ff8 fs3 fc0 sc0 ls0 ws0">poorly written, 287</div><div class="t m0 x74 h14 y1711 ff8 fs3 fc0 sc0 ls0 ws0">proper use of, 54</div><div class="t m0 xb2 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">redundant, 60–62, 272, 275, 286–287</div><div class="t m0 xb2 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">restating the obvious, 64</div><div class="t m0 xb2 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">separated from code, 54</div><div class="t m5 xb2 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 x85 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">, 58–59</div><div class="t m0 xb2 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">too much information in, 70</div><div class="t m0 xb2 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">venting in, 65</div><div class="t m0 xb2 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">writing, 287</div><div class="t m0 x23 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">“communication gap”, minimizing, 168</div><div class="t m0 x23 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">Compare and Swap (CAS) operation, </div><div class="t m0 x85 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">327–328</div><div class="t m5 x23 h2f y16e8 ffb fs10 fc0 sc0 ls0 ws0">ComparisonCompactor</div><div class="t m0 x82 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0"> module, 252–265</div><div class="t m0 xb2 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">defactored, 256–261</div><div class="t m0 xb2 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">final, 263–265</div><div class="t m0 xb2 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">interim, 261–263</div><div class="t m0 xb2 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">original code, 254–256</div><div class="t m0 x23 h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">compiler warnings, turning off, 289</div><div class="t m0 x23 h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">complex code, demonstrating failures </div><div class="t m0 x85 h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">in, 341</div><div class="t m0 x23 h14 y1712 ff8 fs3 fc0 sc0 ls0 ws0">complexity, managing, 139–140</div><div class="t m0 x23 h14 y1713 ff8 fs3 fc0 sc0 ls0 ws0">computer science (CS) terms, using for </div><div class="t m0 x85 h14 y1714 ff8 fs3 fc0 sc0 ls0 ws0">names, 27</div><div class="t m0 x23 h14 y1715 ff8 fs3 fc0 sc0 ls0 ws0">concepts</div><div class="t m0 xb2 h14 y1716 ff8 fs3 fc0 sc0 ls0 ws0">keeping close to each other, 80</div><div class="t m0 xb2 h14 y1717 ff8 fs3 fc0 sc0 ls0 ws0">naming, 19</div><div class="t m0 xb2 h14 y1718 ff8 fs3 fc0 sc0 ls0 ws0">one word per, 26</div><div class="t m0 xb2 h14 y1719 ff8 fs3 fc0 sc0 ls0 ws0">separating at different levels, 290</div><div class="t m0 xb2 h14 y171a ff8 fs3 fc0 sc0 ls0 ws0">spelling similar similarly, 20</div><div class="t m0 xb2 h14 y171b ff8 fs3 fc0 sc0 ls0 ws0">vertical openness between, 78–79</div><div class="t m0 x23 h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0">conceptual affinity, of code, 84</div><div class="t m0 x23 h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">concerns</div><div class="t m0 xb2 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">cross-cutting, 160–161</div><div class="t m0 xb2 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">separating, 154, 166, 178, 250</div><div class="t m0 x23 h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">concrete classes, 149</div><div class="t m0 x23 h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">concrete details, 149</div><div class="t m0 x23 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">concrete terms, 94</div><div class="t m0 x23 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">concurrency</div><div class="t m0 xb2 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">defense principles, 180–182</div><div class="t m0 xb2 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">issues, 190</div><div class="t m0 xb2 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">motives for adopting, 178–179</div><div class="t m0 xb2 h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">myths and misconceptions about, </div><div class="t m0 x85 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">179–180</div><div class="t m0 x23 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">concurrency code</div><div class="t m0 xb2 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">compared to nonconcurrency-related </div><div class="t m0 x85 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">code, 181</div><div class="t m0 xb2 h14 y497 ff8 fs3 fc0 sc0 ls0 ws0">focusing, 321</div><div class="d m1" style="border-style:none;position:absolute;left:145.089990px;bottom:573.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.089990px;bottom:573.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:167.599990px;bottom:561.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:182.599990px;bottom:561.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:215.349990px;bottom:549.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:235.349990px;bottom:549.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.319990px;bottom:525.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.209990px;bottom:501.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.139990px;bottom:489.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.509990px;bottom:477.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.509990px;bottom:477.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.479990px;bottom:465.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.479990px;bottom:465.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.239990px;bottom:453.851010px;width:7.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.239990px;bottom:453.851010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.099990px;bottom:441.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.099990px;bottom:441.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.919990px;bottom:429.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.919990px;bottom:405.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.919990px;bottom:405.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.099990px;bottom:393.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.099990px;bottom:393.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.419990px;bottom:381.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:205.419990px;bottom:381.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:225.353990px;bottom:369.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:240.353990px;bottom:369.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.069990px;bottom:357.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.069990px;bottom:357.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.789990px;bottom:345.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.469990px;bottom:333.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.469990px;bottom:333.851010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.469990px;bottom:333.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.359990px;bottom:321.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:237.359990px;bottom:321.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.989990px;bottom:285.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:116.759990px;bottom:273.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.759990px;bottom:273.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.539990px;bottom:261.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.139990px;bottom:249.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:122.319990px;bottom:237.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.319990px;bottom:237.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.149990px;bottom:225.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.149990px;bottom:225.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.649990px;bottom:213.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.409990px;bottom:201.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.979990px;bottom:189.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.649990px;bottom:177.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.649990px;bottom:177.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:121.759990px;bottom:165.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.759990px;bottom:165.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.199990px;bottom:153.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.209990px;bottom:141.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.439990px;bottom:129.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.439990px;bottom:129.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.459990px;bottom:117.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.459990px;bottom:117.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:123.429990px;bottom:105.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.429990px;bottom:105.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:212.579990px;bottom:93.851110px;width:10.000000px;height:8.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.649990px;bottom:81.851110px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.259990px;bottom:69.851110px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.079990px;bottom:57.851110px;width:10.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.434990px;bottom:585.850010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.434990px;bottom:585.850010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.434990px;bottom:585.850010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.434990px;bottom:585.850010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.434990px;bottom:585.850010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:421.434990px;bottom:585.850010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:374.774990px;bottom:573.850010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.524990px;bottom:561.850010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:308.690990px;bottom:549.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.690990px;bottom:549.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.944990px;bottom:537.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.724990px;bottom:525.851010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.334990px;bottom:513.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:412.604990px;bottom:501.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:304.444990px;bottom:477.851010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.444990px;bottom:477.851010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.862990px;bottom:465.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.862990px;bottom:465.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:333.644990px;bottom:453.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.644990px;bottom:453.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:309.774990px;bottom:441.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.774990px;bottom:441.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.334990px;bottom:429.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.334990px;bottom:429.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.934990px;bottom:417.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.934990px;bottom:417.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.181990px;bottom:405.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:317.224990px;bottom:381.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.884990px;bottom:369.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:382.884990px;bottom:369.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.994990px;bottom:345.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.304990px;bottom:321.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.444990px;bottom:309.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.204990px;bottom:297.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:405.024990px;bottom:285.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.454990px;bottom:273.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.414990px;bottom:261.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:411.414990px;bottom:261.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.414990px;bottom:249.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.104990px;bottom:225.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.104990px;bottom:225.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.544990px;bottom:213.852010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.544990px;bottom:213.852010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.544990px;bottom:213.852010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.544990px;bottom:213.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.584990px;bottom:201.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.924990px;bottom:189.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.034990px;bottom:177.852010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.924990px;bottom:153.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.924990px;bottom:153.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:315.334990px;bottom:141.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:374.774990px;bottom:129.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:394.774990px;bottom:129.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:304.444990px;bottom:105.852010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.444990px;bottom:105.852010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.324990px;bottom:69.852110px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.884990px;bottom:57.852110px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1c0" class="pf w1e h2" data-page-no="1c0"><div class="pc pc1c0 w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">417<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">concurrent algorithms, 179</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">concurrent applications, partition </div><div class="t m0 x3f h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">behavior, 183</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">concurrent code</div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">breaking, 329–333</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">defending from problems of, 180</div><div class="t m0 x74 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">flaws hiding in, 188</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">concurrent programming, 180</div><div class="t m0 xd h1d y1dc ffa fs3 fc0 sc0 ls0 ws7e0">Concurrent Programming in Java: Design </div><div class="t m0 x3f h14 y1dd ffa fs3 fc0 sc0 ls0 ws0">Principles and Patterns<span class="ff8">, 182, 342</span></div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">concurrent programs, 178</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">concurrent update problems, 341</div><div class="t m5 xd h2f y16d3 ffb fs10 fc0 sc0 ls0 ws0">ConcurrentHashMap</div><div class="t m0 xe4 h14 y16d3 ff8 fs3 fc0 sc0 ls0 ws0"> implementation, 183</div><div class="t m0 xd h14 y1526 ff8 fs3 fc0 sc0 ls0 ws0">conditionals</div><div class="t m0 x74 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0">avoiding negative, 302</div><div class="t m0 x74 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">encapsulating, 257–258, 301</div><div class="t m0 xd h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">configurable data, 306</div><div class="t m0 xd h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">configuration constants, 306</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">consequences, warning of, 58</div><div class="t m0 xd h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">consistency</div><div class="t m0 x74 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">in code, 292</div><div class="t m0 x74 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">of enums, 278</div><div class="t m0 x74 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">in names, 40</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">consistent conventions, 259</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">constants</div><div class="t m0 x74 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">versus</div><div class="t m5 xb3 h2f y3df ffb fs10 fc0 sc0 ls0 ws0">enums</div><div class="t m0 x3a h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">, 308–309</div><div class="t m0 x74 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">hiding, 308</div><div class="t m0 x74 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">inheriting, 271, 307–308</div><div class="t m0 x74 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">keeping at the appropriate level, 83</div><div class="t m0 x74 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">leaving as raw numbers, 300</div><div class="t m0 x74 h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">not inheriting, 307–308</div><div class="t m0 x74 h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">passing as symbols, 276</div><div class="t m0 x74 h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">turning into enums, 275–276</div><div class="t m0 xd h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">construction</div><div class="t m0 x74 h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">moving all to </div><div class="t m5 xe4 h2f y395 ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 x4 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">, 155, 156</div><div class="t m0 x74 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">separating with factory, 156</div><div class="t m0 x74 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">of a system, 154</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">constructor arguments, 157</div><div class="t m0 xd h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">constructors, overloading, 25</div><div class="t m0 xd h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">consumer threads, 184</div><div class="t m0 xd h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">ConTest tool, 190, 342</div><div class="t m0 xd h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">context</div><div class="t m0 x74 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">adding meaningful, 27–29</div><div class="t m0 x74 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">not adding gratuitous, 29–30</div><div class="t m0 x74 h14 y497 ff8 fs3 fc0 sc0 ls0 ws0">providing with exceptions, 107</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">continuous readers, 184</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">control variables, within loop statements, </div><div class="t m0 x85 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">80–81</div><div class="t m0 x23 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">convenient idioms, 155</div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">convention(s)</div><div class="t m0 x7e h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">following standard, 299–300</div><div class="t m0 x7e h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">over configuration, 164</div><div class="t m0 x7e h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">structure over, 301</div><div class="t m0 x7e h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">using consistent, 259</div><div class="t m0 x23 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">convoluted code, 175</div><div class="t m0 x23 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">copyright statements, 55</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">cosmic-rays. <span class="ffa">See</span> one-offs</div><div class="t m5 x23 h2f y16d3 ffb fs10 fc0 sc0 ls0 ws0">CountDownLatch</div><div class="t m0 xca h14 y16d3 ff8 fs3 fc0 sc0 ls0 ws0"> class, 183</div><div class="t m0 x23 h14 y1526 ff8 fs3 fc0 sc0 ls0 ws0">coupling. <span class="ffa">See also</span> decoupling; temporal </div><div class="t m0 x85 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0">coupling; tight coupling</div><div class="t m0 x7e h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">artificial, 293</div><div class="t m0 x7e h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">hidden temporal, 302–303</div><div class="t m0 x7e h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">lack of, 150</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">coverage patterns, testing, 314</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">coverage tools, 313</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">“crisp abstraction”, 8–9</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">cross-cutting concerns, 160</div><div class="t m0 x23 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">Cunningham, Ward, 11–12</div><div class="t m0 x23 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">cuteness, in code, 26</div><div class="t m0 x72 h17 y171d ff1 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 x23 h14 y57f ff8 fs3 fc0 sc0 ls0 ws0">dangling</div><div class="t m5 xb6 h2f y57f ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 xe8 h14 y57f ff8 fs3 fc0 sc0 ls0 ws0"> argument, 294</div><div class="t m0 x23 h14 y580 ff8 fs3 fc0 sc0 ls0 ws0">data</div><div class="t m0 x7e h14 yecc ff8 fs3 fc0 sc0 ls0 ws0">abstraction, 93–95</div><div class="t m0 x7e h14 ye5a ff8 fs3 fc0 sc0 ls0 ws0">copies of, 181–182</div><div class="t m0 x7e h14 ycfc ff8 fs3 fc0 sc0 ls0 ws0">encapsulation, 181</div><div class="t m0 x7e h14 ycfd ff8 fs3 fc0 sc0 ls0 ws0">limiting the scope of, 181</div><div class="t m0 x7e h14 ye5b ff8 fs3 fc0 sc0 ls0 ws0">sets processed in parallel, 179</div><div class="t m0 x7e h14 y171e ff8 fs3 fc0 sc0 ls0 ws0">types, 97, 101</div><div class="t m0 x23 h14 y171f ff8 fs3 fc0 sc0 ls0 ws0">data structures. <span class="ffa">See also</span> structure(s)</div><div class="t m0 x7e h14 y1720 ff8 fs3 fc0 sc0 ls0 ws0">compared to objects, 95, 97</div><div class="t m0 x7e h14 y1721 ff8 fs3 fc0 sc0 ls0 ws0">defined, 95</div><div class="t m0 x7e h14 y1722 ff8 fs3 fc0 sc0 ls0 ws0">interfaces representing, 94</div><div class="t m0 x7e h14 y1723 ff8 fs3 fc0 sc0 ls0 ws0">treating Active Records as, 101</div><div class="t m0 x23 h14 y1724 ff8 fs3 fc0 sc0 ls0 ws0">data transfer-objects (DTOs), </div><div class="t m0 x85 h14 y1725 ff8 fs3 fc0 sc0 ls0 ws0">100–101, 160</div><div class="t m0 x23 h14 y1726 ff8 fs3 fc0 sc0 ls0 ws0">database normal forms, 48</div><div class="t m5 x23 h2f y144c ffb fs10 fc0 sc0 ls0 ws0">DateInterval</div><div class="t m0 x21 h14 y144c ff8 fs3 fc0 sc0 ls0 ws0"> enum, 282–283</div><div class="t m5 x23 h2f y16df ffb fs10 fc0 sc0 ls0 ws0">DAY</div><div class="t m0 x3c h14 y16df ff8 fs3 fc0 sc0 ls0 ws0"> enumeration, 277</div><div class="d m1" style="border-style:none;position:absolute;left:172.109970px;bottom:584.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.059970px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.059970px;bottom:536.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.059970px;bottom:536.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.549970px;bottom:524.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.069970px;bottom:512.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.769970px;bottom:500.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:215.049970px;bottom:476.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:235.049970px;bottom:476.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:167.099970px;bottom:464.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.709970px;bottom:452.853010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.643970px;bottom:440.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.449970px;bottom:416.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.059970px;bottom:404.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.059970px;bottom:404.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.059970px;bottom:404.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.769970px;bottom:392.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.669970px;bottom:380.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.649970px;bottom:368.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.229970px;bottom:344.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.009970px;bottom:332.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.899970px;bottom:320.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.899970px;bottom:308.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.670970px;bottom:284.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.670970px;bottom:284.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.629970px;bottom:272.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.959970px;bottom:260.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.959970px;bottom:260.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.959970px;bottom:260.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:228.149970px;bottom:248.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.769970px;bottom:236.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.239970px;bottom:224.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.239970px;bottom:224.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.739970px;bottom:212.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.623970px;bottom:200.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.623970px;bottom:200.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.145970px;bottom:176.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.145970px;bottom:176.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.269970px;bottom:164.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.619970px;bottom:152.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.219970px;bottom:140.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.719970px;bottom:128.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.329970px;bottom:116.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.019970px;bottom:104.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.019970px;bottom:104.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.339970px;bottom:80.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.339970px;bottom:80.852110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.069970px;bottom:68.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.069970px;bottom:68.852110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.509970px;bottom:56.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.954970px;bottom:584.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.694970px;bottom:560.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.304970px;bottom:548.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.964970px;bottom:524.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:385.964970px;bottom:524.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.844970px;bottom:512.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.954970px;bottom:500.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.864970px;bottom:488.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.514970px;bottom:476.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.744970px;bottom:464.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.994970px;bottom:440.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.574970px;bottom:404.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.964970px;bottom:392.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.964970px;bottom:392.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.184970px;bottom:380.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:374.614970px;bottom:368.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.734970px;bottom:356.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.394970px;bottom:344.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.394970px;bottom:344.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.394970px;bottom:332.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.574970px;bottom:320.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.574970px;bottom:320.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.734970px;bottom:308.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.016970px;bottom:257.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.574970px;bottom:233.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.574970px;bottom:233.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.074970px;bottom:221.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.074970px;bottom:221.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.684970px;bottom:209.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.194970px;bottom:197.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.394970px;bottom:185.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.804970px;bottom:173.852010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.804970px;bottom:173.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.234970px;bottom:149.852010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.234970px;bottom:149.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.684970px;bottom:137.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.494970px;bottom:125.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.504970px;bottom:113.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:89.852210px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:89.852210px;width:17.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.694970px;bottom:89.852210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.784970px;bottom:77.852210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.151970px;bottom:65.852110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.151970px;bottom:65.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.118970px;bottom:53.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1c1" class="pf w1f h2" data-page-no="1c1"><div class="pc pc1c1 w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">418<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m5 xd h2f y194 ffb fs10 fc0 sc0 ls0 ws0">DayDate</div><div class="t m0 x95 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0"> class, running </div><div class="t m5 x4 h2f y194 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x3f h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">as, 271</div><div class="t m5 xd h2f y196 ffb fs10 fc0 sc0 ls0 ws0">DayDateFactory</div><div class="t m0 xe h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">, 273–274</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">dead code, 288, 292</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">dead functions, 288</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">deadlock, 183, 335–339</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">deadly embrace. <span class="ffa">See</span> circular wait</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">debugging, finding deadlocks, 336</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">decision making, optimizing, 167–168</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">decisions, postponing, 168</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">declarations, unaligned, 87–88</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">DECORATOR objects, 164</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">DECORATOR pattern, 274</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">decoupled architecture, 167</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">decoupling, from construction </div><div class="t m0 x3f h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">details, 156</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">decoupling strategy, concurrency </div><div class="t m0 x3f h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">as, 178</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">default constructor, deleting, 276</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">degradation, preventing, 14</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">deletions, as the majority of </div><div class="t m0 x3f h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">changes, 250</div><div class="t m0 xd h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">density, vertical in code, 79–80</div><div class="t m0 xd h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">dependencies</div><div class="t m0 x74 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">finding and breaking, 250</div><div class="t m0 x74 h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">injecting, 157</div><div class="t m0 x74 h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">logical, 282</div><div class="t m0 x74 h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">making logical physical, 298–299</div><div class="t m0 x74 h14 y1710 ff8 fs3 fc0 sc0 ls0 ws0">between methods, 329–333</div><div class="t m0 x74 h14 y152e ff8 fs3 fc0 sc0 ls0 ws0">between synchronized </div><div class="t m0 x3f h14 y152f ff8 fs3 fc0 sc0 ls0 ws0">methods, 185</div><div class="t m0 xd h14 y1530 ff8 fs3 fc0 sc0 ls0 ws0">Dependency Injection (DI), 157</div><div class="t m0 xd h14 y111f ff8 fs3 fc0 sc0 ls0 ws0">Dependency Inversion Principle (DIP), </div><div class="t m0 x3f h14 y210 ff8 fs3 fc0 sc0 ls0 ws0">15, 150</div><div class="t m0 xd h14 y211 ff8 fs3 fc0 sc0 ls0 ws0">dependency magnet, 47</div><div class="t m0 xd h14 y212 ff8 fs3 fc0 sc0 ls0 ws0">dependent functions, formatting, 82–83</div><div class="t m0 xd h14 y213 ff8 fs3 fc0 sc0 ls0 ws0">derivatives</div><div class="t m0 x74 h14 y214 ff8 fs3 fc0 sc0 ls0 ws0">base classes depending on, 291</div><div class="t m0 x74 h14 y215 ff8 fs3 fc0 sc0 ls0 ws0">base classes knowing about, 273</div><div class="t m0 x74 h14 y216 ff8 fs3 fc0 sc0 ls0 ws0">of the exception class, 48</div><div class="t m0 x74 h14 y1d7 ff8 fs3 fc0 sc0 ls0 ws0">moving</div><div class="t m5 x1e h2f ya5c ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 xe5 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0"> functions into, 232, </div><div class="t m0 x3f h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">233–235</div><div class="t m0 x74 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">pushing functionality into, 217</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">description</div><div class="t m0 xb2 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">of a class, 138</div><div class="t m0 xb2 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">overloading the structure of code </div><div class="t m0 x85 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">into, 310</div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">descriptive names</div><div class="t m0 xb2 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">choosing, 309–310</div><div class="t m0 xb2 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">using, 39–40</div><div class="t m0 x23 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">design(s)</div><div class="t m0 xb2 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">of concurrent algorithms, 179</div><div class="t m0 xb2 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">minimally coupled, 167</div><div class="t m0 xb2 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">principles of, 15</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">design patterns, 290</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">details, paying attention to, 8</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">DI (Dependency Injection), 157</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">Dijkstra, Edsger, 48</div><div class="t m0 x23 h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">dining philosophers execution model, </div><div class="t m0 x85 h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">184–185</div><div class="t m0 x23 h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">DIP (Dependency Inversion Principle), </div><div class="t m0 x85 h14 y1712 ff8 fs3 fc0 sc0 ls0 ws0">15, 150</div><div class="t m0 x23 h14 y1713 ff8 fs3 fc0 sc0 ls0 ws0">dirty code. <span class="ffa">See also</span> bad code; </div><div class="t m0 x85 h14 y1714 ff8 fs3 fc0 sc0 ls0 ws0">messy code</div><div class="t m0 x23 h14 y1715 ff8 fs3 fc0 sc0 ls0 ws0">dirty code, cleaning, 200</div><div class="t m0 x23 h14 y1716 ff8 fs3 fc0 sc0 ls0 ws0">dirty tests, 123</div><div class="t m0 x23 h14 y1717 ff8 fs3 fc0 sc0 ls0 ws0">disinformation, avoiding, 19–20</div><div class="t m0 x23 h14 y1718 ff8 fs3 fc0 sc0 ls0 ws0">distance, vertical in code, 80–84</div><div class="t m0 x23 h14 y1719 ff8 fs3 fc0 sc0 ls0 ws0">distinctions, making meaningful, 20–21</div><div class="t m0 x23 h14 y171a ff8 fs3 fc0 sc0 ls0 ws0">domain-specific languages (DSLs), </div><div class="t m0 x85 h14 y171b ff8 fs3 fc0 sc0 ls0 ws0">168–169</div><div class="t m0 x23 h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0">domain-specific testing language, 127</div><div class="t m5 x23 h2f y81b ffb fs10 fc0 sc0 ls0 ws0">DoubleArgumentMarshaler</div><div class="t m0 x60 h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">class, 238</div><div class="t m0 x23 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">DRY principle (Don&apos;t Repeat Yourself<span class="_ _6"></span>), </div><div class="t m0 x85 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">181, 289</div><div class="t m0 x23 h14 y393 ff8 fs3 fc0 sc0 ls0 ws7e1">DTOs (data transfer objects), 100–101, 160</div><div class="t m0 x23 h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">dummy scopes, 90</div><div class="t m0 x23 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">duplicate</div><div class="t m5 x89 h2f y395 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x69 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0"> statements, 276</div><div class="t m0 x23 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">duplication</div><div class="t m0 xb2 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">of code, 48</div><div class="t m0 xb2 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">in code, 289–290</div><div class="t m0 xb2 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">eliminating, 173–175</div><div class="t m0 xb2 h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">focusing on, 10</div><div class="t m0 xb2 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">forms of, 173, 290</div><div class="t m0 xb2 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">reduction of, 48</div><div class="t m0 xb2 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">strategies for eliminating, 48</div><div class="d m1" style="border-style:none;position:absolute;left:127.899990px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.929990px;bottom:561.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.929990px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:123.829990px;bottom:549.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.829990px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.169990px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:119.669990px;bottom:525.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.669990px;bottom:525.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.669990px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.169990px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.739990px;bottom:489.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.739990px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.239990px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.329990px;bottom:465.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.329990px;bottom:465.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.509990px;bottom:453.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.949990px;bottom:441.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.369990px;bottom:429.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.679990px;bottom:405.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.899990px;bottom:381.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.049990px;bottom:369.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.549990px;bottom:357.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.779990px;bottom:333.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.109990px;bottom:321.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.109990px;bottom:321.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.889990px;bottom:297.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.569990px;bottom:285.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.789990px;bottom:273.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.119990px;bottom:261.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.119990px;bottom:261.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.279990px;bottom:249.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.279990px;bottom:249.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.459990px;bottom:225.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.309990px;bottom:213.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.569990px;bottom:189.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.569990px;bottom:189.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.269990px;bottom:177.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.609990px;bottom:165.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:226.609990px;bottom:165.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.269990px;bottom:141.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.829990px;bottom:129.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.939990px;bottom:117.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:205.340990px;bottom:105.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.569990px;bottom:93.352110px;width:20.000000px;height:8.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.569990px;bottom:93.352110px;width:15.000000px;height:8.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.909990px;bottom:81.352110px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.904990px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.254990px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.804990px;bottom:525.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.804990px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:312.364990px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.364990px;bottom:513.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.564990px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.974990px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.964990px;bottom:465.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.964990px;bottom:453.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.804990px;bottom:441.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:380.434990px;bottom:429.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.684990px;bottom:417.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694990px;bottom:393.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694990px;bottom:393.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694990px;bottom:369.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.694990px;bottom:369.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.844990px;bottom:333.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.864990px;bottom:321.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.584990px;bottom:309.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.584990px;bottom:309.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.114990px;bottom:297.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.114990px;bottom:297.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.864990px;bottom:285.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:416.864990px;bottom:285.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694990px;bottom:261.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694990px;bottom:261.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:404.894990px;bottom:249.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.609990px;bottom:237.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694990px;bottom:213.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694990px;bottom:213.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.348990px;bottom:201.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:404.348990px;bottom:201.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:423.729990px;bottom:201.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.414990px;bottom:189.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.187990px;bottom:177.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.404990px;bottom:153.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.854990px;bottom:141.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.854990px;bottom:141.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.254990px;bottom:129.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.254990px;bottom:129.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.634990px;bottom:117.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.854990px;bottom:105.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.854990px;bottom:105.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.294990px;bottom:93.352110px;width:10.000000px;height:8.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.684990px;bottom:81.352110px;width:10.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1c2" class="pf w1e h2" data-page-no="1c2"><div class="pc pc1c2 w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">419<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">dyadic argument, 40</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">dyadic functions, 42</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">dynamic proxies, 161</div><div class="t m0 xd6 h17 y1727 ff1 fs9 fc0 sc0 ls0 ws0">E</div><div class="t m5 xd h2f y19a ffb fs10 fc0 sc0 ls0 ws0">e</div><div class="t m0 x47 h14 y19a ff8 fs3 fc0 sc0 ls0 ws0">, as a variable name, 22</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">Eclipse, 26</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">edit sessions, playing back, 13–14</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">efficiency, of code, 7</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws7e2">EJB architecture, early as over-engineered, </div><div class="t m0 x3f h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">167</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws0">EJB standard, complete overhaul of, 164</div><div class="t m0 xd h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws0">EJB2 beans, 160</div><div class="t m0 xd h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws0">EJB3, Bank object rewritten in, 165–166</div><div class="t m0 xd h14 y1bf ff8 fs3 fc0 sc0 ls0 ws0">“elegant” code, 7</div><div class="t m0 xd h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws0">emergent design, 171–176</div><div class="t m0 xd h14 y1c1 ff8 fs3 fc0 sc0 ls0 ws0">encapsulation, 136</div><div class="t m0 x74 h14 y1c2 ff8 fs3 fc0 sc0 ls0 ws0">of boundary conditions, 304</div><div class="t m0 x74 h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws0">breaking, 106–107</div><div class="t m0 x74 h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws0">of conditionals, 301</div><div class="t m0 xd h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws0">encodings, avoiding, 23–24, 312–313</div><div class="t m0 xd h14 y1e6 ff8 fs3 fc0 sc0 ls0 ws0">entity bean, 158–160</div><div class="t m5 xd h2f y3f7 ffb fs10 fc0 sc0 ls0 ws0">enum</div><div class="t m0 x74 h14 y3f7 ff8 fs3 fc0 sc0 ls0 ws0">(s)</div><div class="t m0 x74 h14 yddc ff8 fs3 fc0 sc0 ls0 ws0">changing</div><div class="t m5 x14 h2f yddc ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 x5a h14 yddc ff8 fs3 fc0 sc0 ls0 ws0"> to, 272</div><div class="t m0 x74 h14 ybfe ff8 fs3 fc0 sc0 ls0 ws0">using, 308–309</div><div class="t m0 xd h14 y57e ff8 fs3 fc0 sc0 ls0 ws0">enumeration, moving, 277</div><div class="t m0 xd h14 y57f ff8 fs3 fc0 sc0 ls0 ws0">environment, heuristics on, 287</div><div class="t m0 xd h14 y580 ff8 fs3 fc0 sc0 ls0 ws0">environment control system, 128–129</div><div class="t m0 xd h14 yecc ff8 fs3 fc0 sc0 ls0 ws0">envying, the scope of a class, 293</div><div class="t m0 xd h14 ye5a ff8 fs3 fc0 sc0 ls0 ws0">error check, hiding a side effect, 258</div><div class="t m5 xd h2f y3fc ffb fs10 fc0 sc0 ls0 ws0">Error</div><div class="t m0 xfc h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">class, 47–48</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">error code constants, 198–200</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">error codes</div><div class="t m0 x74 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">implying a class or enum, 47–48</div><div class="t m0 x74 h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">preferring exceptions to, 46</div><div class="t m0 x74 h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">returning, 103–104</div><div class="t m0 x74 h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">reusing old, 48</div><div class="t m0 x74 h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">separating from the </div><div class="t m5 xa h2f y399 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x5d h14 y399 ff8 fs3 fc0 sc0 ls0 ws0"> module, </div><div class="t m0 x3f h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">242–250</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">error detection, pushing to the edges, 109</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">error flags, 103–104</div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">error handling, 8, 47–48</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">error messages, 107, 250</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">error processing, testing, 238–239</div><div class="t m5 x23 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">errorMessage</div><div class="t m0 x21 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> method, 250</div><div class="t m0 x23 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">errors.<span class="_ _b"> </span><span class="ffa ws7e3">See also <span class="ff8">boundary condition errors; </span></span></div><div class="t m0 x85 h14 y198 ff8 fs3 fc0 sc0 ls0 ws7e4">spelling errors; string comparison </div><div class="t m0 x85 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">errors</div><div class="t m0 x85 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">classifying, 107</div><div class="t m0 x23 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">Evans, Eric, 311</div><div class="t m0 x23 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">events, 41</div><div class="t m0 x23 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">exception classification, 107</div><div class="t m0 x23 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">exception clauses, 107–108</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">exception management code, 223</div><div class="t m0 x23 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">exceptions</div><div class="t m0 x7e h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">instead of return codes, 103–105</div><div class="t m0 x7e h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">narrowing the type of, 105–106</div><div class="t m0 x7e h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">preferring to error codes, 46</div><div class="t m0 x7e h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">providing context with, 107</div><div class="t m0 x7e h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">separating from </div><div class="t m5 x79 h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x8d h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">, 242–250</div><div class="t m0 x7e h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">throwing, 104–105, 194</div><div class="t m0 x7e h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">unchecked, 106–107</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">execution, possible paths of, 321–326</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">execution models, 183–185</div><div class="t m5 x23 h2f ybfb ffb fs10 fc0 sc0 ls0 ws0">Executor</div><div class="t m0 x9f h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">framework, 326–327</div><div class="t m5 x23 h2f ybfc ffb fs10 fc0 sc0 ls0 ws0">ExecutorClientScheduler.java</div><div class="t m0 xf4 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">, 321</div><div class="t m0 x23 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">explanation, of intent, 56–57</div><div class="t m0 x23 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">explanatory variables, 296–297</div><div class="t m0 x23 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">explicitness, of code, 19</div><div class="t m0 x23 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">expressive code, 295</div><div class="t m0 x23 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">expressiveness</div><div class="t m0 x7e h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">in code, 10–11</div><div class="t m0 x7e h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">ensuring, 175–176</div><div class="t m0 x23 h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">Extract Method refactoring, 11</div><div class="t m0 x23 h1d y16ef ffa fs3 fc0 sc0 ls0 ws0">Extreme Programming Adventures </div><div class="t m0 x85 h14 yf75 ffa fs3 fc0 sc0 ls0 ws0">in C#<span class="ff8">, 10</span></div><div class="t m0 x23 h14 yf76 ffa fs3 fc0 sc0 ls0 ws0">Extreme Programming Installed<span class="ff8">, 10</span></div><div class="t m0 x23 h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">“eye-full”, code fitting into, 79–80</div><div class="t m0 x82 h17 y1728 ff1 fs9 fc0 sc0 ls0 ws0">F</div><div class="t m0 x23 h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">factories, 155–156</div><div class="t m0 x23 h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">factory classes, 273–275</div><div class="t m0 x23 h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">failure</div><div class="t m0 x7e h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">to express ourselves in code, 54</div><div class="d m1" style="border-style:none;position:absolute;left:150.499970px;bottom:585.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.949970px;bottom:573.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.949970px;bottom:561.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:167.020970px;bottom:510.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:113.009970px;bottom:498.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:190.229970px;bottom:486.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:205.229970px;bottom:486.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.259970px;bottom:474.351010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.569970px;bottom:450.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:226.599970px;bottom:438.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.509970px;bottom:426.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:207.169970px;bottom:414.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:227.169970px;bottom:414.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.709970px;bottom:402.352010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.389970px;bottom:390.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.389970px;bottom:390.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.559970px;bottom:378.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.339970px;bottom:366.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.559970px;bottom:354.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.559970px;bottom:354.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.289970px;bottom:342.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.119970px;bottom:330.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.119970px;bottom:330.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.119970px;bottom:330.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.119970px;bottom:330.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.729970px;bottom:318.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.729970px;bottom:318.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.364970px;bottom:294.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:123.239970px;bottom:282.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.239970px;bottom:282.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.119970px;bottom:270.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.949970px;bottom:258.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.229970px;bottom:246.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:215.229970px;bottom:246.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.989970px;bottom:234.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:210.189970px;bottom:222.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.878970px;bottom:210.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.878970px;bottom:210.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.099970px;bottom:198.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.099970px;bottom:198.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.119970px;bottom:174.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.119970px;bottom:174.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.099970px;bottom:162.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.229970px;bottom:150.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.229970px;bottom:150.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.289970px;bottom:138.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.569970px;bottom:114.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.569970px;bottom:114.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:229.099970px;bottom:102.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:124.939970px;bottom:90.352110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.939970px;bottom:90.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.499970px;bottom:78.352110px;width:7.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.499970px;bottom:78.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.499970px;bottom:78.352110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.894970px;bottom:585.351010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.894970px;bottom:585.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:368.564970px;bottom:573.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.564970px;bottom:573.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.431970px;bottom:561.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.524970px;bottom:513.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.294970px;bottom:501.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:297.744970px;bottom:489.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.344970px;bottom:477.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.454970px;bottom:465.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.454970px;bottom:465.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.054970px;bottom:453.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.004970px;bottom:429.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.004970px;bottom:429.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.564970px;bottom:417.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.564970px;bottom:417.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.654970px;bottom:405.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.304970px;bottom:393.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.962970px;bottom:381.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.962970px;bottom:381.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.304970px;bottom:369.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.304970px;bottom:369.352010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.304970px;bottom:369.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.954970px;bottom:357.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.954970px;bottom:357.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.294970px;bottom:345.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.294970px;bottom:345.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.464970px;bottom:333.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.464970px;bottom:333.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.867970px;bottom:321.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:374.867970px;bottom:321.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.914970px;bottom:309.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.464970px;bottom:297.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.464970px;bottom:297.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.004970px;bottom:285.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.004970px;bottom:285.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.124970px;bottom:273.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.784970px;bottom:261.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.354970px;bottom:237.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.354970px;bottom:237.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.634970px;bottom:225.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.634970px;bottom:225.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.054970px;bottom:213.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.142970px;bottom:189.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.598970px;bottom:177.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.064970px;bottom:165.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.064970px;bottom:165.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:306.624970px;bottom:114.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.624970px;bottom:114.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.784970px;bottom:102.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.784970px;bottom:102.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:402.394970px;bottom:78.352110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1c3" class="pf w1f h2" data-page-no="1c3"><div class="pc pc1c3 w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">420<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">failure, <span class="ffa">continued</span></div><div class="t m0 x74 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">patterns of, 314</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">tolerating with no harm, 330</div><div class="t m5 xd h2f y197 ffb fs10 fc0 sc0 ls0 ws0">false</div><div class="t m0 x8e h14 y197 ff8 fs3 fc0 sc0 ls0 ws0"> argument, 294</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">fast tests, 132</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">fast-running threads, starving longer </div><div class="t m0 x3f h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">running, 183</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">fear, of renaming, 30</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">Feathers, Michael, 10</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">feature envy</div><div class="t m0 x74 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">eliminating, 293–294</div><div class="t m0 x74 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">smelling of, 278</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">file size, in Java, 76</div><div class="t m5 xd h2f y1526 ffb fs10 fc0 sc0 ls0 ws0">final</div><div class="t m0 xfc h14 y1526 ff8 fs3 fc0 sc0 ls0 ws0">keywords, 276</div><div class="t m0 xd h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0">F.I.R.S.T. acronym, 132–133</div><div class="t m0 xd h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">First Law, of TDD, 122</div><div class="t m0 xd h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">FitNesse project</div><div class="t m0 x74 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">coding style for, 90</div><div class="t m0 x74 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">file sizes, 76, 77</div><div class="t m0 x74 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">function in, 32–33</div><div class="t m0 x74 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">invoking all tests, 224</div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">flag arguments, 41, 288</div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">focussed code, 8</div><div class="t m0 xd h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">foreign code. <span class="ffa">See</span> third-party code</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">formatting</div><div class="t m0 x74 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">horizontal, 85–90</div><div class="t m0 x74 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">purpose of, 76</div><div class="t m0 x74 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">Uncle Bob’s rules, 90–92</div><div class="t m0 x74 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">vertical, 76–85</div><div class="t m0 xd h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">formatting style, for a team of </div><div class="t m0 x3f h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">developers, 90</div><div class="t m0 xd h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">Fortran, forcing encodings, 23</div><div class="t m0 xd h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">Fowler, Martin, 285, 293</div><div class="t m0 xd h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">frame, 324</div><div class="t m0 xd h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">function arguments, 40–45</div><div class="t m0 xd h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">function call dependencies, 84–85</div><div class="t m0 xd h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">function headers, 70</div><div class="t m0 xd h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">function signature, 45</div><div class="t m0 xd h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">functionality, placement of, 295–296</div><div class="t m0 xd h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">functions</div><div class="t m0 x74 h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">breaking into smaller, 141–146</div><div class="t m0 x74 h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">calling within a block, 35</div><div class="t m0 x74 h14 y16f6 ff8 fs3 fc0 sc0 ls0 ws0">dead, 288</div><div class="t m0 x74 h14 y16f7 ff8 fs3 fc0 sc0 ls0 ws0">defining private, 292</div><div class="t m0 xb2 h14 y1729 ff8 fs3 fc0 sc0 ls0 ws0">descending one level of abstraction, </div><div class="t m0 x85 h14 y172a ff8 fs3 fc0 sc0 ls0 ws0">304–306</div><div class="t m0 xb2 h14 y172b ff8 fs3 fc0 sc0 ls0 ws0">doing one thing, 35–36, 302</div><div class="t m0 xb2 h14 y172c ff8 fs3 fc0 sc0 ls0 ws0">dyadic, 42</div><div class="t m0 xb2 h14 y172d ff8 fs3 fc0 sc0 ls0 ws0">eliminating extraneous </div><div class="t m5 x5e h2f y198 ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 xf4 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0"> statements, </div><div class="t m0 x85 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">262</div><div class="t m0 xb2 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">establishing the temporal nature </div><div class="t m0 x85 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">of, 260</div><div class="t m0 xb2 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">formatting dependent, 82–83</div><div class="t m0 xb2 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">gathering beneath a banner, 67</div><div class="t m0 xb2 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">heuristics on, 288</div><div class="t m0 xb2 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">intention-revealing, 19</div><div class="t m0 xb2 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">keeping small, 175</div><div class="t m0 xb2 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">length of, 34–35</div><div class="t m0 xb2 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">moving, 279</div><div class="t m0 xb2 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">naming, 39, 297</div><div class="t m0 xb2 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">number of arguments in, 288</div><div class="t m0 xb2 h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">one level of abstraction per, 36–37</div><div class="t m0 xb2 h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">in place of comments, 67</div><div class="t m0 xb2 h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">renaming for clarity, 258</div><div class="t m0 xb2 h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">rewriting for clarity, 258–259</div><div class="t m0 xb2 h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">sections within, 36</div><div class="t m0 xb2 h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">small as better, 34</div><div class="t m0 xb2 h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">structured programming with, 49</div><div class="t m0 xb2 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">understanding, 297–298</div><div class="t m0 xb2 h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">as verbs of a language, 49</div><div class="t m0 xb2 h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">writing, 49</div><div class="t m0 x23 h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">futures, 326</div><div class="t m0 x72 h17 y172e ff1 fs9 fc0 sc0 ls0 ws0">G</div><div class="t m0 x23 h14 y1399 ff8 fs3 fc0 sc0 ls0 ws0">Gamma, Eric, 252</div><div class="t m0 x23 h14 y139a ff8 fs3 fc0 sc0 ls0 ws0">general heuristics, 288–307</div><div class="t m0 x23 h14 yd7c ff8 fs3 fc0 sc0 ls0 ws0">generated byte-code, 180</div><div class="t m0 x23 h14 y676 ff8 fs3 fc0 sc0 ls0 ws0">generics, improving code readability, 115</div><div class="t m5 x23 h2f y6db ffb fs10 fc0 sc0 ls0 ws0">get</div><div class="t m0 x7e h14 y6db ff8 fs3 fc0 sc0 ls0 ws0">functions, 218</div><div class="t m5 x23 h2f ybf7 ffb fs10 fc0 sc0 ls0 ws0">getBoolean</div><div class="t m0 xa1 h14 ybf7 ff8 fs3 fc0 sc0 ls0 ws0"> function, 224</div><div class="t m5 x23 h2f y3e7 ffb fs10 fc0 sc0 ls0 ws0">GETFIELD</div><div class="t m0 xe3 h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws0"> instruction, 325, 326</div><div class="t m5 x23 h2f ybf8 ffb fs10 fc0 sc0 ls0 ws0">getNextId</div><div class="t m0 xa1 h14 ybf8 ff8 fs3 fc0 sc0 ls0 ws0">method, 326</div><div class="t m5 x23 h2f y73c ffb fs10 fc0 sc0 ls0 ws0">getState</div><div class="t m0 x89 h14 y73c ff8 fs3 fc0 sc0 ls0 ws0">function, 129</div><div class="t m0 x23 h14 y3cb ff8 fs3 fc0 sc0 ls0 ws0">Gilbert, David, 267, 268</div><div class="t m0 x23 h14 y73d ff8 fs3 fc0 sc0 ls0 ws0">given-when-then convention, 130</div><div class="t m0 x23 h14 y13d0 ff8 fs3 fc0 sc0 ls0 ws0">glitches. <span class="ffa">See</span> one-offs</div><div class="d m1" style="border-style:none;position:absolute;left:143.809990px;bottom:572.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.479990px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.146990px;bottom:548.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:118.039990px;bottom:536.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.429990px;bottom:512.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.459990px;bottom:500.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.969990px;bottom:488.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.879990px;bottom:464.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.879990px;bottom:464.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.599990px;bottom:452.853010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.749990px;bottom:440.853010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.068990px;bottom:428.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.539990px;bottom:416.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.539990px;bottom:416.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.309990px;bottom:404.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.089990px;bottom:380.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.589990px;bottom:368.852010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.589990px;bottom:368.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.929990px;bottom:356.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.929990px;bottom:356.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.659990px;bottom:344.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.029990px;bottom:332.852010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.029990px;bottom:332.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.689990px;bottom:320.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.869990px;bottom:284.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.869990px;bottom:284.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.809990px;bottom:272.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.529990px;bottom:260.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.529990px;bottom:260.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.309990px;bottom:248.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.309990px;bottom:248.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.639990px;bottom:224.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.689990px;bottom:212.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.869990px;bottom:200.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.869990px;bottom:200.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:106.639990px;bottom:188.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.809990px;bottom:176.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.809990px;bottom:176.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.959990px;bottom:164.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.959990px;bottom:164.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.689990px;bottom:152.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.809990px;bottom:140.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.359990px;bottom:128.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.359990px;bottom:128.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.309990px;bottom:104.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.309990px;bottom:104.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.259990px;bottom:92.852210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:120.199990px;bottom:80.852210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.919990px;bottom:68.852210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.444990px;bottom:572.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.444990px;bottom:572.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.224990px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:368.224990px;bottom:560.851010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.224990px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:317.104990px;bottom:548.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.444990px;bottom:524.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.774990px;bottom:500.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.264990px;bottom:488.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.264990px;bottom:488.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:398.464990px;bottom:476.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.274990px;bottom:464.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.544990px;bottom:452.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.274990px;bottom:440.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.274990px;bottom:428.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.274990px;bottom:428.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.004990px;bottom:416.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.444990px;bottom:404.851010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.444990px;bottom:404.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.264990px;bottom:392.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:399.304990px;bottom:380.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:414.304990px;bottom:380.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.264990px;bottom:368.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.424990px;bottom:356.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.314990px;bottom:344.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.314990px;bottom:344.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.724990px;bottom:332.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.214990px;bottom:320.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.654990px;bottom:308.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.104990px;bottom:296.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:367.104990px;bottom:296.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:379.304990px;bottom:284.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:319.334990px;bottom:272.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:300.214990px;bottom:260.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.764990px;bottom:205.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.704990px;bottom:193.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.704990px;bottom:193.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.244990px;bottom:181.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:419.084990px;bottom:169.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.910990px;bottom:157.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.389990px;bottom:145.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.216990px;bottom:133.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.216990px;bottom:133.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.559990px;bottom:121.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.577990px;bottom:109.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.214990px;bottom:97.852110px;width:17.500000px;height:9.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.214990px;bottom:97.852110px;width:15.000000px;height:9.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.144990px;bottom:85.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1c4" class="pf w1e h2" data-page-no="1c4"><div class="pc pc1c4 w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">421<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">global setup strategy, 155</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">“God class”, 136–137</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">good comments, 55–59</div><div class="t m5 xd h2f y197 ffb fs10 fc0 sc0 ls0 ws0">goto</div><div class="t m0 x8e h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">statements, avoiding, 48, 49</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">grand redesign, 5</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">gratuitous context, 29–30</div><div class="t m0 xba h17 y172f ff1 fs9 fc0 sc0 ls0 ws0">H</div><div class="t m0 xd h14 y39d ff8 fs3 fc0 sc0 ls0 ws0">hand-coded instrumentation, 189</div><div class="t m5 xd h2f y39e ffb fs10 fc0 sc0 ls0 ws0">HashTable</div><div class="t m0 x8a h14 y39e ff8 fs3 fc0 sc0 ls0 ws0">, 328–329</div><div class="t m0 xd h14 y27a ff8 fs3 fc0 sc0 ls0 ws0">headers. <span class="ffa">See</span> comment headers; function </div><div class="t m0 x3f h14 y27b ff8 fs3 fc0 sc0 ls0 ws0">headers</div><div class="t m0 xd h14 y27c ff8 fs3 fc0 sc0 ls0 ws0">heuristics</div><div class="t m0 x74 h14 y27d ff8 fs3 fc0 sc0 ls0 ws0">cross references of, 286, 409</div><div class="t m0 x74 h14 y27e ff8 fs3 fc0 sc0 ls0 ws0">general, 288–307</div><div class="t m0 x74 h14 y27f ff8 fs3 fc0 sc0 ls0 ws0">listing of, 285–314</div><div class="t m0 xd h14 y280 ff8 fs3 fc0 sc0 ls0 ws0">hidden temporal coupling, 259, 302–303</div><div class="t m0 xd h14 y281 ff8 fs3 fc0 sc0 ls0 ws0">hidden things, in a function, 44</div><div class="t m0 xd h14 y2a ff8 fs3 fc0 sc0 ls0 ws0">hiding</div><div class="t m0 x74 h14 y2b ff8 fs3 fc0 sc0 ls0 ws0">implementation, 94</div><div class="t m0 x74 h14 y2c ff8 fs3 fc0 sc0 ls0 ws0">structures, 99</div><div class="t m0 xd h14 y2d ff8 fs3 fc0 sc0 ls0 ws0">hierarchy of scopes, 88</div><div class="t m0 xd h14 y4e3 ff8 fs3 fc0 sc0 ls0 ws0">HN. <span class="ffa">See</span> Hungarian Notation</div><div class="t m0 xd h14 y4e4 ff8 fs3 fc0 sc0 ls0 ws0">horizontal alignment, of code, 87–88</div><div class="t m0 xd h14 y260 ff8 fs3 fc0 sc0 ls0 ws0">horizontal formatting, 85–90</div><div class="t m0 xd h14 y261 ff8 fs3 fc0 sc0 ls0 ws0">horizontal white space, 86</div><div class="t m0 xd h14 y262 ff8 fs3 fc0 sc0 ls0 ws0">HTML, in source code, 69</div><div class="t m0 xd h14 y263 ff8 fs3 fc0 sc0 ls0 ws0">Hungarian Notation (HN), 23–24, 295</div><div class="t m0 xd h14 y264 ff8 fs3 fc0 sc0 ls0 ws0">Hunt, Andy, 8, 289</div><div class="t m0 xd h14 y265 ff8 fs3 fc0 sc0 ls0 ws0">hybrid structures, 99</div><div class="t m0 xb h17 y1730 ff1 fs9 fc0 sc0 ls0 ws0">I</div><div class="t m5 xd h2f y47f ffb fs10 fc0 sc0 ls0 ws0">if</div><div class="t m0 x3b h14 y47f ff8 fs3 fc0 sc0 ls0 ws0">statements</div><div class="t m0 x74 h14 y480 ff8 fs3 fc0 sc0 ls0 ws0">duplicate, 276</div><div class="t m0 x74 h14 y6dc ff8 fs3 fc0 sc0 ls0 ws0">eliminating, 262</div><div class="t m5 xd h2f y6dd ffb fs10 fc0 sc0 ls0 ws0">if-else</div><div class="t m0 x95 h14 y6dd ff8 fs3 fc0 sc0 ls0 ws0"> chain</div><div class="t m0 x74 h14 y6de ff8 fs3 fc0 sc0 ls0 ws0">appearing again and again, 290</div><div class="t m0 x74 h14 y555 ff8 fs3 fc0 sc0 ls0 ws0">eliminating, 233</div><div class="t m0 xd h14 y13c6 ff8 fs3 fc0 sc0 ls0 ws0">ignored tests, 313</div><div class="t m0 xd h14 y13c7 ff8 fs3 fc0 sc0 ls0 ws0">implementation</div><div class="t m0 x74 h14 y13c8 ff8 fs3 fc0 sc0 ls0 ws0">duplication of, 173</div><div class="t m0 x74 h14 y1731 ff8 fs3 fc0 sc0 ls0 ws0">encoding, 24</div><div class="t m0 x7e h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">exposing, 94</div><div class="t m0 x7e h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">hiding, 94</div><div class="t m0 x7e h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">wrapping an abstraction, 11</div><div class="t m0 x23 h14 y16e3 ffa fs3 fc0 sc0 ls0 ws0">Implementation Patterns<span class="ff8">, 3, 296</span></div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">implicity, of code, 18</div><div class="t m0 x23 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">import lists</div><div class="t m0 x7e h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">avoiding long, 307</div><div class="t m0 x7e h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">shortening in </div><div class="t m5 x49 h2f y1db ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xbb h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">, 270</div><div class="t m0 x23 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">imports, as hard dependencies, 307</div><div class="t m0 x23 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">imprecision, in code, 301</div><div class="t m0 x23 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">inaccurate comments, 54</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">inappropriate information, in </div><div class="t m0 x85 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">comments, 286</div><div class="t m0 x23 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">inappropriate static methods, 296</div><div class="t m5 x23 h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">include</div><div class="t m0 x27 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0"> method, 48</div><div class="t m0 x23 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">inconsistency, in code, 292</div><div class="t m0 x23 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">inconsistent spellings, 20</div><div class="t m0 x23 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">incrementalism, 212–214</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">indent level, of a function, 35</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">indentation, of code, 88–89</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">indentation rules, 89</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">independent tests, 132</div><div class="t m0 x23 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">information</div><div class="t m0 x7e h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">inappropriate, 286</div><div class="t m0 x7e h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">too much, 70, 291–292</div><div class="t m0 x23 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">informative comments, 56</div><div class="t m0 x23 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">inheritance hierarchy, 308</div><div class="t m0 x23 h14 y608 ff8 fs3 fc0 sc0 ls0 ws4e0">inobvious connection, between a comment </div><div class="t m0 x85 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">and code, 70</div><div class="t m0 x23 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">input arguments, 41</div><div class="t m0 x23 h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">instance variables</div><div class="t m0 x7e h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">in classes, 140</div><div class="t m0 x7e h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">declaring, 81</div><div class="t m0 x7e h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">hiding the declaration of, 81–82</div><div class="t m0 x7e h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">passing as function </div><div class="t m0 x85 h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">arguments, 231</div><div class="t m0 x7e h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">proliferation of, 140</div><div class="t m0 x23 h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">instrumented classes, 342</div><div class="t m0 x23 h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">insufficient tests, 313</div><div class="t m0 x23 h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">integer argument(s)</div><div class="t m0 x7e h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">defining, 194</div><div class="t m0 x7e h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">integrating, 224–225</div><div class="t m5 x23 h2f y473 ffb fs10 fc0 sc0 ls0 ws0">integer</div><div class="t m0 x27 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0"> argument functionality, </div><div class="t m0 x85 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">moving into </div><div class="t m5 x73 h2f y496 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 xf0 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 x85 h14 y497 ff8 fs3 fc0 sc0 ls0 ws0">215–216</div><div class="d m1" style="border-style:none;position:absolute;left:166.839970px;bottom:585.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:132.109970px;bottom:573.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.109970px;bottom:573.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.679970px;bottom:561.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.679970px;bottom:561.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.846970px;bottom:549.351010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.846970px;bottom:549.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.219970px;bottom:537.351010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.009970px;bottom:525.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.009970px;bottom:525.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.999970px;bottom:472.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:122.872970px;bottom:460.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.872970px;bottom:460.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.029970px;bottom:412.352010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.029970px;bottom:412.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.499970px;bottom:400.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.499970px;bottom:400.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.909970px;bottom:388.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.909970px;bottom:388.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.839970px;bottom:376.352010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.839970px;bottom:376.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:226.839970px;bottom:376.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.789970px;bottom:364.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:164.849970px;bottom:340.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.949970px;bottom:328.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.819970px;bottom:316.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:201.829970px;bottom:292.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:216.829970px;bottom:292.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.339970px;bottom:280.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.339970px;bottom:280.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.049970px;bottom:268.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.159970px;bottom:256.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.379970px;bottom:244.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.379970px;bottom:244.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.379970px;bottom:244.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.289970px;bottom:232.352010px;width:7.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.289970px;bottom:232.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.559970px;bottom:220.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.729970px;bottom:155.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.629970px;bottom:143.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.759970px;bottom:119.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.629970px;bottom:107.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.899970px;bottom:95.352110px;width:15.000000px;height:9.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.899970px;bottom:71.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.729970px;bottom:59.352110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.804970px;bottom:585.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.254970px;bottom:573.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.784970px;bottom:561.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.832970px;bottom:549.351010px;width:7.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.832970px;bottom:549.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.524970px;bottom:537.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.974970px;bottom:513.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.798970px;bottom:501.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:393.224970px;bottom:489.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.074970px;bottom:477.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.394970px;bottom:465.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.804970px;bottom:441.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.014970px;bottom:429.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.374970px;bottom:417.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.294970px;bottom:405.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.534970px;bottom:393.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.354970px;bottom:381.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.354970px;bottom:381.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.734970px;bottom:369.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.404970px;bottom:357.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:367.404970px;bottom:357.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.634970px;bottom:345.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.854970px;bottom:333.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.014970px;bottom:309.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.194970px;bottom:297.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.194970px;bottom:297.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.194970px;bottom:297.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.964970px;bottom:285.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.384970px;bottom:273.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.514970px;bottom:249.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.414970px;bottom:237.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.744970px;bottom:213.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.904970px;bottom:201.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.734970px;bottom:189.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.734970px;bottom:189.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.354970px;bottom:165.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.514970px;bottom:153.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.184970px;bottom:141.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.524970px;bottom:129.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.024970px;bottom:105.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.024970px;bottom:93.352210px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.024970px;bottom:93.352210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:57.352110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:57.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1c5" class="pf w1f h2" data-page-no="1c5"><div class="pc pc1c5 w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">422<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">integer argument type, adding </div><div class="t m0 x3f h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">to</div><div class="t m5 xb3 h2f y195 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 xe5 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">, 212</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">integers, pattern of changes for, 220</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">IntelliJ, 26</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">intent</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">explaining in code, 55</div><div class="t m0 x74 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">explanation of, 56–57</div><div class="t m0 x74 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">obscured, 295</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">intention-revealing function, 19</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">intention-revealing names, 18–19</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">interface(s)</div><div class="t m0 x74 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">defining local or remote, 158–160</div><div class="t m0 x74 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">encoding, 24</div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">implementing, 149–150</div><div class="t m0 x74 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">representing abstract concerns, 150</div><div class="t m0 x74 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">turning</div><div class="t m5 x4c h2f y11c0 ffb fs10 fc0 sc0 ls0 ws0"> ArgumentMarshaler</div><div class="t m0 x84 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0"> into, 237</div><div class="t m0 x74 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">well-defined, 291–292</div><div class="t m0 x74 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">writing, 119</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">internal structures, objects hiding, 97</div><div class="t m0 xd h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">intersection, of domains, 160</div><div class="t m0 xd h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">intuition, not relying on, 289</div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">inventor of C++, 7</div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">Inversion of Control (IoC), 157</div><div class="t m5 xd h2f ybfc ffb fs10 fc0 sc0 ls0 ws0">InvocationHandler</div><div class="t m0 xe4 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0"> object, 162</div><div class="t m0 xd h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">I/O bound, 318</div><div class="t m0 xd h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">isolating, from change, 149–150</div><div class="t m5 xd h2f y3e0 ffb fs10 fc0 sc0 ls0 ws0">isxxxArg</div><div class="t m0 x8a h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">methods, 221–222</div><div class="t m0 xd h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">iterative process, refactoring as, 265</div><div class="t m0 x7b h17 y1732 ff1 fs9 fc0 sc0 ls0 ws0">J</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">jar files, deploying derivatives and bases </div><div class="t m0 x3f h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">in, 291</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">Java</div><div class="t m0 x74 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">aspects or aspect-like mechanisms, </div><div class="t m0 x3f h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">161–166</div><div class="t m0 x74 h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">heuristics on, 307–309</div><div class="t m0 x74 h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">as a wordy language, 200</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">Java 5, improvements for concurrent </div><div class="t m0 x3f h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">development, 182–183</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">Java 5 Executor framework, 320–321</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">Java 5 VM, nonblocking solutions in, </div><div class="t m0 x3f h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">327–328</div><div class="t m0 xd h14 y144c ff8 fs3 fc0 sc0 ls0 ws0">Java AOP frameworks, 163–166</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">Java programmers, encoding not </div><div class="t m0 x85 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">needed, 24</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">Java proxies, 161–163</div><div class="t m0 x23 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">Java source files, 76–77</div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">javadocs</div><div class="t m0 xb2 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">as clutter, 276</div><div class="t m0 xb2 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">in nonpublic code, 71</div><div class="t m0 xb2 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">preserving formatting in, 270</div><div class="t m0 xb2 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">in public APIs, 59</div><div class="t m0 xb2 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">requiring for every function, 63</div><div class="t m5 x23 h2f y16e8 ffb fs10 fc0 sc0 ls0 ws0">java.util.concurrent</div><div class="t m0 x97 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws7e5">package, collections </div><div class="t m0 x85 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">in, 182–183</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">JBoss AOP, proxies in, 163</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">JCommon library, 267</div><div class="t m5 x23 h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">JCommon</div><div class="t m0 x27 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0"> unit tests, 270</div><div class="t m0 x23 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">JDepend project, 76, 77</div><div class="t m0 x23 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws7e6">JDK proxy, providing persistence support, </div><div class="t m0 x85 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">161–163</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">Jeffries, Ron, 10–11, 289</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">jiggling strategies, 190</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">JNDI lookups, 157</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">journal comments, 63–64</div><div class="t m5 x23 h2f ybfb ffb fs10 fc0 sc0 ls0 ws0">JUnit</div><div class="t m0 xb4 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">, 34</div><div class="t m0 x23 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">JUnit framework, 252–265</div><div class="t m0 x23 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">Junit project, 76, 77</div><div class="t m0 x23 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">Just-In-Time Compiler, 180</div><div class="t m0 x72 h17 y1733 ff1 fs9 fc0 sc0 ls0 ws0">K</div><div class="t m0 x23 h14 y37c ff8 fs3 fc0 sc0 ls0 ws0">keyword form, of a function name, 43</div><div class="t m0 x82 h17 y1734 ff1 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m5 x23 h2f y47e ffb fs10 fc0 sc0 ls0 ws0">L</div><div class="t m0 xce h14 y47e ff8 fs3 fc0 sc0 ls0 ws0">, lower-case in variable names, 20</div><div class="t m0 x23 h14 y47f ff8 fs3 fc0 sc0 ls0 ws7e7">language design, art of programming as, 49</div><div class="t m0 x23 h14 y480 ff8 fs3 fc0 sc0 ls0 ws0">languages</div><div class="t m0 xb2 h14 y6dc ff8 fs3 fc0 sc0 ls0 ws0">appearing to be simple, 12</div><div class="t m0 xb2 h14 y6dd ff8 fs3 fc0 sc0 ls0 ws0">level of abstraction, 2</div><div class="t m0 xb2 h14 y6de ff8 fs3 fc0 sc0 ls0 ws0">multiple in one source file, 288</div><div class="t m0 xb2 h14 y555 ff8 fs3 fc0 sc0 ls0 ws0">multiples in a comment, 270</div><div class="t m0 x23 h14 y13c6 ff8 fs3 fc0 sc0 ls0 ws0">last-in, first-out (LIFO) data structure, </div><div class="t m0 x85 h14 y13c7 ff8 fs3 fc0 sc0 ls0 ws0">operand stack as, 324</div><div class="t m0 x23 h14 y13c8 ff8 fs3 fc0 sc0 ls0 ws0">Law of Demeter, 97–98, 306</div><div class="d m1" style="border-style:none;position:absolute;left:147.343990px;bottom:573.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:207.949990px;bottom:561.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:111.599990px;bottom:549.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.699990px;bottom:525.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.309990px;bottom:513.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.309990px;bottom:513.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.919990px;bottom:501.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.749990px;bottom:489.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.969990px;bottom:477.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.969990px;bottom:477.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.189990px;bottom:453.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:218.189990px;bottom:453.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.479990px;bottom:441.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.379990px;bottom:429.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.379990px;bottom:429.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.889990px;bottom:417.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:226.369990px;bottom:405.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.359990px;bottom:393.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.359990px;bottom:393.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.709990px;bottom:381.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.139990px;bottom:369.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.199990px;bottom:357.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.829990px;bottom:345.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.419990px;bottom:333.352010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.639990px;bottom:321.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.054990px;bottom:309.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:124.649990px;bottom:297.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.529990px;bottom:285.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.529990px;bottom:285.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.512990px;bottom:273.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.512990px;bottom:273.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.779990px;bottom:261.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.599990px;bottom:198.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.819990px;bottom:162.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.819990px;bottom:162.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.649990px;bottom:150.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.649990px;bottom:150.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.739990px;bottom:138.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.479990px;bottom:114.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.479990px;bottom:114.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.059990px;bottom:102.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.059990px;bottom:102.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.819990px;bottom:78.352110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.819990px;bottom:78.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.349990px;bottom:66.352110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.349990px;bottom:66.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.264990px;bottom:573.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.654990px;bottom:561.351010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.654990px;bottom:561.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.034990px;bottom:549.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.034990px;bottom:549.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.324990px;bottom:525.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.604990px;bottom:513.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.154990px;bottom:501.351010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.724990px;bottom:489.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:402.304990px;bottom:477.351010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.724990px;bottom:453.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.724990px;bottom:453.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.504990px;bottom:441.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.224990px;bottom:429.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.464990px;bottom:417.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.204990px;bottom:405.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.204990px;bottom:405.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.944990px;bottom:381.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.944990px;bottom:381.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:324.044990px;bottom:369.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.044990px;bottom:369.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.044990px;bottom:369.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.334990px;bottom:357.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.774990px;bottom:345.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.884990px;bottom:333.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:359.884990px;bottom:333.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:294.501990px;bottom:321.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.984990px;bottom:309.352010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:360.984990px;bottom:309.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.664990px;bottom:297.352010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.664990px;bottom:297.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.884990px;bottom:285.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:410.134990px;bottom:232.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:398.606990px;bottom:179.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:428.978990px;bottom:167.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.764990px;bottom:143.352010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:367.594990px;bottom:131.352010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.934990px;bottom:119.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:385.114990px;bottom:107.352010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.034990px;bottom:83.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.474990px;bottom:71.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.474990px;bottom:71.352110px;width:12.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:368.474990px;bottom:71.352110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1c6" class="pf w1e h2" data-page-no="1c6"><div class="pc pc1c6 w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">423<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">LAZY INITIALIZATION/</div><div class="t m0 x3f h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">EVALUATION idiom, 154</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">LAZY-INITIALIZATION, 157</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">Lea, Doug, 182, 342</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">learning tests, 116, 118</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">LeBlanc’s law, 4</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">legacy code, 307</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">legal comments, 55–56</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">level of abstraction, 36–37</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">levels of detail, 99</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">lexicon, having a consistent, 26</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">lines of code</div><div class="t m0 x74 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">duplicating, 173</div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">width of, 85</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">list(s)</div><div class="t m0 x74 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">of arguments, 43</div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">meaning specific to programmers, 19</div><div class="t m0 x74 h14 y54a ff8 fs3 fc0 sc0 ls0 ws7e8">returning a predefined immutable, 110</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">literate code, 9</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">literate programming, 9</div><div class="t m0 xd h14 y6c2 ffa fs3 fc0 sc0 ls0 ws0">Literate Programming<span class="ff8">, 141</span></div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">livelock, 183, 338</div><div class="t m0 xd h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">local comments, 69–70</div><div class="t m0 xd h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">local variables, 324</div><div class="t m0 x74 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">declaring, 292</div><div class="t m0 x74 h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">at the top of each function, 80</div><div class="t m0 xd h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">lock &amp; wait, 337, 338</div><div class="t m0 xd h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">locks, introducing, 185</div><div class="t m5 xd h2f y15a4 ffb fs10 fc0 sc0 ls0 ws0">log4j</div><div class="t m0 x8e h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0"> package, 116–118</div><div class="t m0 xd h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">logical dependencies, 282, 298–299</div><div class="t m0 xd h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">LOGO language, 36</div><div class="t m0 xd h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">long descriptive names, 39</div><div class="t m0 xd h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">long names, for long scopes, 312</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">loop counters, single-letter names for, 25</div><div class="t m0 xba h17 y1735 ff1 fs9 fc0 sc0 ls0 ws0">M</div><div class="t m0 xd h14 y3e7 ff8 fs3 fc0 sc0 ls0 ws0">magic numbers</div><div class="t m0 x74 h14 ybf8 ff8 fs3 fc0 sc0 ls0 ws0">obscuring intent, 295</div><div class="t m0 x74 h14 y73c ff8 fs3 fc0 sc0 ls0 ws0">replacing with named constants, </div><div class="t m0 x3f h14 y3cb ff8 fs3 fc0 sc0 ls0 ws0">300–301</div><div class="t m5 xd h2f y73d ffb fs10 fc0 sc0 ls0 ws0">main</div><div class="t m0 x74 h14 y73d ff8 fs3 fc0 sc0 ls0 ws0"> function, moving construction to, </div><div class="t m0 x3f h14 y13d0 ff8 fs3 fc0 sc0 ls0 ws0">155, 156</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">managers, role of, 6</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">mandated comments, 63</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">manual control, over a serial ID, 272</div><div class="t m5 x23 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">Map</div><div class="t m0 x7e h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">adding for </div><div class="t m5 xca h2f y198 ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x94 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">, 221</div><div class="t m0 x7e h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">methods of, 114</div><div class="t m0 x23 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">maps, breaking the use of, 222–223</div><div class="t m0 x23 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">marshalling implementation, </div><div class="t m0 x85 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">214–215</div><div class="t m0 x23 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">meaningful context, 27–29</div><div class="t m0 x23 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">member variables</div><div class="t m5 x7e h2f y16d2 ffb fs10 fc0 sc0 ls0 ws0">f</div><div class="t m0 xb4 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0"> prefix for, 257</div><div class="t m0 x7e h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">prefixing, 24</div><div class="t m0 x7e h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">renaming for clarity, 259</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">mental mapping, avoiding, 25</div><div class="t m0 x23 h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">messy code. <span class="ffa">See also</span> bad code; dirty code</div><div class="t m0 x7e h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">total cost of owning, 4–12</div><div class="t m0 x23 h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">method invocations, 324</div><div class="t m0 x23 h14 y1712 ff8 fs3 fc0 sc0 ls0 ws0">method names, 25</div><div class="t m0 x23 h14 y1713 ff8 fs3 fc0 sc0 ls0 ws0">methods</div><div class="t m0 x7e h14 y1714 ff8 fs3 fc0 sc0 ls0 ws0">affecting the order of execution, 188</div><div class="t m0 x7e h14 y1715 ff8 fs3 fc0 sc0 ls0 ws0">calling a twin with a flag, 278</div><div class="t m0 x7e h14 y1716 ff8 fs3 fc0 sc0 ls0 ws0">changing from static to instance, 280</div><div class="t m0 x7e h14 y1717 ff8 fs3 fc0 sc0 ls0 ws0">of classes, 140</div><div class="t m0 x7e h14 y1718 ff8 fs3 fc0 sc0 ls0 ws0">dependencies between, 329–333</div><div class="t m0 x7e h14 y1719 ff8 fs3 fc0 sc0 ls0 ws0">eliminating duplication between, </div><div class="t m0 x85 h14 y171a ff8 fs3 fc0 sc0 ls0 ws0">173–174</div><div class="t m0 x7e h14 y171b ff8 fs3 fc0 sc0 ls0 ws0">minimizing assert statements in, 176</div><div class="t m0 x7e h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0">naming, 25</div><div class="t m0 x7e h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">tests exposing bugs in, 269</div><div class="t m0 x23 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">minimal code, 9</div><div class="t m0 x23 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">misleading comments, 63</div><div class="t m0 x23 h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">misplaced responsibility, 295–296, 299</div><div class="t m0 x23 h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">MOCK OBJECT, assigning, 155</div><div class="t m0 x23 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">monadic argument, 40</div><div class="t m0 x23 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">monadic forms, of arguments, 41</div><div class="t m0 x23 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">monads, converting dyads into, 42</div><div class="t m0 x23 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">Monte Carlo testing, 341</div><div class="t m5 x23 h2f y1314 ffb fs10 fc0 sc0 ls0 ws0">Month</div><div class="t m0 x2a h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">enum, 278</div><div class="t m5 x23 h2f y171c ffb fs10 fc0 sc0 ls0 ws0">MonthConstants</div><div class="t m0 xca h14 y171c ff8 fs3 fc0 sc0 ls0 ws0"> class, 271</div><div class="t m0 x23 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">multithread aware, 332</div><div class="t m0 x23 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">multithread-calculation, of throughput, </div><div class="t m0 x85 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">335</div><div class="d m1" style="border-style:none;position:absolute;left:210.889970px;bottom:572.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.248970px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:126.279970px;bottom:548.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.279970px;bottom:548.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.119970px;bottom:536.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.119970px;bottom:536.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.109970px;bottom:524.851010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.549970px;bottom:512.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.119970px;bottom:500.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.119970px;bottom:500.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.719970px;bottom:488.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:175.719970px;bottom:488.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.949970px;bottom:476.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.169970px;bottom:464.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.069970px;bottom:440.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.679970px;bottom:428.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.559970px;bottom:404.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:236.209970px;bottom:392.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:235.101970px;bottom:380.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:133.219970px;bottom:368.851010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.779970px;bottom:356.851010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.332970px;bottom:344.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:116.289970px;bottom:332.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.289970px;bottom:332.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.119970px;bottom:320.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.119970px;bottom:320.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.109970px;bottom:308.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.279970px;bottom:296.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.769970px;bottom:284.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.289970px;bottom:272.851010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.289970px;bottom:272.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.289970px;bottom:260.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.886970px;bottom:248.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.886970px;bottom:248.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:167.659970px;bottom:236.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.659970px;bottom:236.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:207.659970px;bottom:236.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.439970px;bottom:224.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.279970px;bottom:212.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.999970px;bottom:200.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:233.209970px;bottom:188.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.789970px;bottom:121.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:115.069970px;bottom:97.852110px;width:20.000000px;height:9.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.069970px;bottom:97.852110px;width:15.000000px;height:9.939900px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:115.069970px;bottom:73.852110px;width:17.500000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.069970px;bottom:73.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.394970px;bottom:584.851010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.184970px;bottom:572.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:399.884970px;bottom:560.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.860970px;bottom:536.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.414970px;bottom:524.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.174970px;bottom:512.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.174970px;bottom:512.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:488.851010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:488.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.184970px;bottom:476.851010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.184970px;bottom:476.851010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.545970px;bottom:452.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.354970px;bottom:440.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.674970px;bottom:428.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:377.414970px;bottom:416.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.414970px;bottom:392.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:380.414970px;bottom:392.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.304970px;bottom:380.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.744970px;bottom:368.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:416.764970px;bottom:344.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.404970px;bottom:332.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:418.454970px;bottom:320.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.294970px;bottom:308.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:380.384970px;bottom:296.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.384970px;bottom:296.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:272.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.694970px;bottom:272.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:417.084970px;bottom:260.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.694970px;bottom:248.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.754970px;bottom:236.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.414970px;bottom:224.852010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:360.194970px;bottom:212.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.194970px;bottom:200.852010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.194970px;bottom:200.852010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:410.194970px;bottom:200.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.644970px;bottom:188.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.404970px;bottom:176.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.454970px;bottom:164.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.464970px;bottom:152.852010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.694970px;bottom:140.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.782970px;bottom:128.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.994970px;bottom:116.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.174970px;bottom:104.852010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.694970px;bottom:80.852110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1c7" class="pf w1f h2" data-page-no="1c7"><div class="pc pc1c7 w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">424<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">multithreaded code, 188, 339–342</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">mumbling, 59–60</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">mutators, naming, 25</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">mutual exclusion, 183, 336, 337</div><div class="t m0 xd6 h17 y1736 ff1 fs9 fc0 sc0 ls0 ws0">N</div><div class="t m0 xd h14 y19b ff8 fs3 fc0 sc0 ls0 ws0">named constants, replacing magic </div><div class="t m0 x3f h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">numbers, 300–301</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws0">name-length-challenged languages, 23</div><div class="t m0 xd h14 y19e ff8 fs3 fc0 sc0 ls0 ws0">names</div><div class="t m0 x74 h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">abstractions, appropriate level of, 311</div><div class="t m0 x74 h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws0">changing, 40</div><div class="t m0 x74 h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws0">choosing, 175, 309–310</div><div class="t m0 x74 h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws0">of classes, 270–271</div><div class="t m0 x74 h14 y1bf ff8 fs3 fc0 sc0 ls0 ws0">clever, 26</div><div class="t m0 x74 h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws0">descriptive, 39–40</div><div class="t m0 x74 h14 y1c1 ff8 fs3 fc0 sc0 ls0 ws0">of functions, 297</div><div class="t m0 x74 h14 y1c2 ff8 fs3 fc0 sc0 ls0 ws0">heuristics on, 309–313</div><div class="t m0 x74 h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws0">importance of, 309–310</div><div class="t m0 x74 h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws0">intention-revealing, 18–19</div><div class="t m0 x74 h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws0">length of corresponding to scope, </div><div class="t m0 x3f h14 y1e6 ff8 fs3 fc0 sc0 ls0 ws0">22–23</div><div class="t m0 x74 h14 y1e7 ff8 fs3 fc0 sc0 ls0 ws0">long names for long scopes, 312</div><div class="t m0 x74 h14 y1e8 ff8 fs3 fc0 sc0 ls0 ws0">making unambiguous, 258</div><div class="t m0 x74 h14 y1e9 ff8 fs3 fc0 sc0 ls0 ws0">problem domain, 27</div><div class="t m0 x74 h14 y1ea ff8 fs3 fc0 sc0 ls0 ws0">pronounceable, 21–22</div><div class="t m0 x74 h14 y1eb ff8 fs3 fc0 sc0 ls0 ws0">rules for creating, 18–30</div><div class="t m0 x74 h14 y1ec ff8 fs3 fc0 sc0 ls0 ws0">searchable, 22–23</div><div class="t m0 x74 h14 y1ed ff8 fs3 fc0 sc0 ls0 ws7e9">shorter generally better than longer, 30</div><div class="t m0 x74 h14 y1ee ff8 fs3 fc0 sc0 ls0 ws0">solution domain, 27</div><div class="t m0 x74 h14 y1ef ff8 fs3 fc0 sc0 ls0 ws0">with subtle differences, 20</div><div class="t m0 x74 h14 y1162 ff8 fs3 fc0 sc0 ls0 ws0">unambiguous, 312</div><div class="t m0 x74 h14 y1163 ff8 fs3 fc0 sc0 ls0 ws0">at the wrong level of abstraction, 271</div><div class="t m0 xd h14 y1249 ff8 fs3 fc0 sc0 ls0 ws0">naming, classes, 138</div><div class="t m0 xd h14 y1442 ff8 fs3 fc0 sc0 ls0 ws0">naming conventions, as inferior to </div><div class="t m0 x3f h14 y4b2 ff8 fs3 fc0 sc0 ls0 ws0">structures, 301</div><div class="t m0 xd h14 y4b3 ff8 fs3 fc0 sc0 ls0 ws0">navigational methods, in Active </div><div class="t m0 x3f h14 y4b4 ff8 fs3 fc0 sc0 ls0 ws0">Records, 101</div><div class="t m0 xd h14 y4b5 ff8 fs3 fc0 sc0 ls0 ws0">near bugs, testing, 314</div><div class="t m0 xd h14 y217 ff8 fs3 fc0 sc0 ls0 ws0">negative conditionals, avoiding, 302</div><div class="t m0 xd h14 y218 ff8 fs3 fc0 sc0 ls0 ws0">negatives, 258</div><div class="t m0 xd h14 y219 ff8 fs3 fc0 sc0 ls0 ws0">nested structures, 46</div><div class="t m0 x23 h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Newkirk, Jim, 116</div><div class="t m0 x23 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">newspaper metaphor, 77–78</div><div class="t m0 x23 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">niladic argument, 40</div><div class="t m0 x23 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">no preemption, 337</div><div class="t m0 x23 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">noise</div><div class="t m0 xb2 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">comments, 64–66</div><div class="t m0 xb2 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">scary, 66</div><div class="t m0 xb2 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">words, 21</div><div class="t m0 x23 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">nomenclature, using standard, 311–312</div><div class="t m0 x23 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">nonblocking solutions, 327–328</div><div class="t m0 x23 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">nonconcurrency-related code, 181</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">noninformative names, 21</div><div class="t m0 x23 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">nonlocal information, 69–70</div><div class="t m0 x23 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">nonpublic code, javadocs in, 71</div><div class="t m0 x23 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">nonstatic methods, preferred to static, 296</div><div class="t m0 x23 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">nonthreaded code, getting working </div><div class="t m0 x85 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">first, 187</div><div class="t m0 x23 h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">nonthread-safe classes, 328–329</div><div class="t m0 x23 h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">normal flow, 109</div><div class="t m5 x23 h2f yd28 ffb fs10 fc0 sc0 ls0 ws0">null</div><div class="t m0 xb2 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">not passing into methods, 111–112</div><div class="t m0 xb2 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">not returning, 109–110</div><div class="t m0 xb2 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">passed by a caller accidentally, 111</div><div class="t m0 x23 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws7ea">null detection logic, for </div><div class="t m5 x6b h2f ybfc ffb fs10 fc0 sc0 ls0 ws0">ArgumentMarshaler</div><div class="t m0 x35 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 x85 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">214</div><div class="t m5 x23 h2f y3df ffb fs10 fc0 sc0 ls0 ws0">NullPointerException</div><div class="t m0 x73 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">, 110, 111</div><div class="t m0 x23 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">number-series naming, 21</div><div class="t m0 x72 h17 y1737 ff1 fs9 fc0 sc0 ls0 ws0">O</div><div class="t m0 x23 h1d y3fb ffa fs3 fc0 sc0 ls0 ws321">Object Oriented Analysis and Design with </div><div class="t m0 x85 h14 y3fc ffa fs3 fc0 sc0 ls0 ws0">Applications<span class="ff8">, 8</span></div><div class="t m0 x23 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">object-oriented design, 15</div><div class="t m0 x23 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">objects</div><div class="t m0 xb2 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">compared to data structures, 95, 97</div><div class="t m0 xb2 h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">compared to data types and proce-</div><div class="t m0 x85 h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">dures, 101</div><div class="t m0 xb2 h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">copying read-only, 181</div><div class="t m0 xb2 h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">defined, 95</div><div class="t m0 x23 h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">obscured intent, 295</div><div class="t m0 x23 h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">obsolete comments, 286</div><div class="t m0 x23 h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">obvious behavior, 288–289</div><div class="t m0 x23 h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">obvious code, 12</div><div class="d m1" style="border-style:none;position:absolute;left:161.124990px;bottom:585.101010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.124990px;bottom:585.101010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:201.124990px;bottom:585.101010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:125.314990px;bottom:573.101010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.314990px;bottom:573.101010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.194990px;bottom:561.101010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.804990px;bottom:549.101010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.804990px;bottom:549.101010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.804990px;bottom:549.101010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.634990px;bottom:486.101010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.634990px;bottom:486.101010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:223.324990px;bottom:474.101010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:233.274990px;bottom:450.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.854990px;bottom:438.103010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.304990px;bottom:426.104010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.304990px;bottom:426.104010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.304990px;bottom:426.104010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:140.794990px;bottom:414.105010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.794990px;bottom:414.105010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:126.624990px;bottom:402.106010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.074990px;bottom:390.107010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.074990px;bottom:390.107010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.244990px;bottom:378.108010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.024990px;bottom:366.109010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.024990px;bottom:366.109010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.014990px;bottom:354.110010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.014990px;bottom:354.110010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.294990px;bottom:342.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.294990px;bottom:342.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:115.194990px;bottom:318.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.194990px;bottom:318.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.624990px;bottom:306.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.584990px;bottom:294.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.024990px;bottom:282.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.064990px;bottom:270.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.064990px;bottom:270.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.504990px;bottom:258.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.504990px;bottom:258.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.394990px;bottom:246.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.394990px;bottom:246.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:240.229990px;bottom:234.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.924990px;bottom:222.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.284990px;bottom:210.112010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.084990px;bottom:198.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:231.334990px;bottom:186.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.964990px;bottom:174.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.074990px;bottom:150.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.964990px;bottom:126.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.464990px;bottom:114.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:209.464990px;bottom:102.112010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:121.964990px;bottom:90.112210px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.124990px;bottom:78.112210px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.759990px;bottom:585.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.349990px;bottom:573.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.349990px;bottom:573.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.809990px;bottom:561.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.369990px;bottom:549.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.429990px;bottom:525.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.429990px;bottom:525.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:312.419990px;bottom:513.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:315.759990px;bottom:501.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.799990px;bottom:489.111010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:410.799990px;bottom:489.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.939990px;bottom:477.111010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.939990px;bottom:477.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.659990px;bottom:465.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.029990px;bottom:453.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.479990px;bottom:441.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.479990px;bottom:441.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.969990px;bottom:429.111010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:421.349990px;bottom:417.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.429990px;bottom:393.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.009990px;bottom:381.111010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.009990px;bottom:381.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.479990px;bottom:369.111010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.049990px;bottom:345.102010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:411.049990px;bottom:345.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.259990px;bottom:333.102010px;width:20.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.259990px;bottom:333.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:412.949990px;bottom:321.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:304.319990px;bottom:297.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:359.548990px;bottom:285.102010px;width:17.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:379.548990px;bottom:285.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.469990px;bottom:273.102010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:359.868990px;bottom:210.102010px;width:5.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.469990px;bottom:198.102010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.569990px;bottom:174.102010px;width:12.500000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:416.569990px;bottom:174.102010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.979990px;bottom:150.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.359990px;bottom:138.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.309990px;bottom:126.102010px;width:10.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.699990px;bottom:114.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.259990px;bottom:102.102010px;width:15.000000px;height:9.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.479990px;bottom:90.102110px;width:20.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.479990px;bottom:90.102110px;width:15.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.369990px;bottom:78.102110px;width:10.000000px;height:9.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1c8" class="pf w1e h2" data-page-no="1c8"><div class="pc pc1c8 w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">425<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">“Once and only once” principle, 289</div><div class="t m5 xd h2f y195 ffb fs10 fc0 sc0 ls0 ws0">“ONE SWITCH”</div><div class="t m0 x41 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0"> rule, 299</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">one thing, functions doing, 35–36, 302</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">one-offs, 180, 187, 191</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">OO code, 97</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">OO design, 139</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">Open Closed Principle (OCP), 15, 38</div><div class="t m0 x74 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">by checked exceptions, 106</div><div class="t m0 x74 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">supporting, 149</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">operand stack, 324</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">operating systems, threading policies, 188</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">operators, precedence of, 86</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">optimistic locking, 327</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">optimizations, LAZY-EVALUATION </div><div class="t m0 x3f h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">as, 157</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">optimizing, decision making, 167–168</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls59 ws7eb">orderings, calculating the possible, 322–323</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">organization</div><div class="t m0 x74 h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">for change, 147–150</div><div class="t m0 x74 h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">of classes, 136</div><div class="t m0 x74 h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">managing complexity, 139–140</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws7ec">outbound tests, exercising an interface, 118</div><div class="t m0 xd h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">output arguments, 41, 288</div><div class="t m0 x74 h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">avoiding, 45</div><div class="t m0 x74 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">need for disappearing, 45</div><div class="t m0 xd h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">outputs, arguments as, 45</div><div class="t m0 xd h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">overhead, incurred by concurrency, 179</div><div class="t m0 xd h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">overloading, of code with description, 310</div><div class="t m0 xd6 h17 y1732 ff1 fs9 fc0 sc0 ls0 ws0">P</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">paperback model, as an academic </div><div class="t m0 x3f h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">model, 27</div><div class="t m0 xd h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">parameters, taken by instructions, 324</div><div class="t m5 xd h2f y3ff ffb fs10 fc0 sc0 ls0 ws0">parse</div><div class="t m0 xfc h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">operation, throwing an </div><div class="t m0 x3f h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">exception, 220</div><div class="t m0 xd h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">partitioning, 250</div><div class="t m0 xd h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">paths of execution, 321–326</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">pathways, through critical sections, 188</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">pattern names, using standard, 175</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">patterns</div><div class="t m0 x74 h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">of failure, 314</div><div class="t m0 x74 h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">as one kind of standard, 311</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">performance</div><div class="t m0 x7e h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">of a client/server pair, 318</div><div class="t m0 x7e h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">concurrency improving, 179</div><div class="t m0 x7e h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">of server-based locking, 333</div><div class="t m0 x23 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">permutations, calculating, 323</div><div class="t m0 x23 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">persistence, 160, 161</div><div class="t m0 x23 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">pessimistic locking, 327</div><div class="t m0 x23 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">phraseology, in similar names, 40</div><div class="t m0 x23 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">physicalizing, a dependency, 299</div><div class="t m0 x23 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">Plain-Old Java Objects. <span class="ffa">See</span> POJOs</div><div class="t m0 x23 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">platforms, running threaded code, 188</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">pleasing code, 7</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">pluggable thread-based code, 187</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">POJO system, agility provided by, 168</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">POJOs (Plain-Old Java Objects)</div><div class="t m0 x7e h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">creating, 187</div><div class="t m0 x7e h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">implementing business logic, 162</div><div class="t m0 x7e h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">separating threaded-aware code, 190</div><div class="t m0 x7e h14 y1712 ff8 fs3 fc0 sc0 ls0 ws0">in Spring, 163</div><div class="t m0 x7e h14 y1713 ff8 fs3 fc0 sc0 ls0 ws0">writing application domain logic, 166</div><div class="t m0 x23 h14 y1714 ff8 fs3 fc0 sc0 ls0 ws0">polyadic argument, 40</div><div class="t m0 x23 h14 y1715 ff8 fs3 fc0 sc0 ls0 ws0">polymorphic behavior, of functions, 296</div><div class="t m0 x23 h14 y1716 ff8 fs3 fc0 sc0 ls0 ws0">polymorphic changes, 96–97</div><div class="t m0 x23 h14 y1717 ff8 fs3 fc0 sc0 ls0 ws0">polymorphism, 37, 299</div><div class="t m0 x23 h14 y1718 ff8 fs3 fc0 sc0 ls0 ws0">position markers, 67</div><div class="t m0 x23 h14 y1719 ff8 fs3 fc0 sc0 ls0 ws0">positives</div><div class="t m0 x7e h14 y171a ff8 fs3 fc0 sc0 ls0 ws0">as easier to understand, 258</div><div class="t m0 x7e h14 y171b ff8 fs3 fc0 sc0 ls0 ws0">expressing conditionals as, 302</div><div class="t m0 x7e h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0">of decisions, 301precision</div><div class="t m0 x7e h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">as the point of all naming, 30</div><div class="t m0 x23 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">predicates, naming, 25</div><div class="t m0 x23 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">preemption, breaking, 338</div><div class="t m0 x23 h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">prefixes</div><div class="t m0 x7e h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">for member variables, 24</div><div class="t m0 x7e h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">as useless in today’s environments, </div><div class="t m0 x85 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">312–313</div><div class="t m0 x23 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">pre-increment operator, </div><div class="t m5 x8b h2f y43d ffb fs10 fc0 sc0 ls0 ws0">++</div><div class="t m0 x60 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">, 324, 325, 326</div><div class="t m0 x23 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">“prequel”, this book as, 15</div><div class="t m0 x23 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">principle of least surprise, 288–289, 295</div><div class="t m0 x23 h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">principles, of design, 15</div><div class="t m5 x23 h2f ya5c ffb fs10 fc0 sc0 ls0 ws0">PrintPrimes</div><div class="t m0 xc2 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0"> program, translation into </div><div class="t m0 x85 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">Java, 141</div><div class="t m0 x23 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">private behavior, isolating, 148–149</div><div class="d m1" style="border-style:none;position:absolute;left:209.999970px;bottom:585.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.156970px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.369970px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:203.369970px;bottom:561.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:218.369970px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:116.689970px;bottom:549.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.689970px;bottom:549.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.689970px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:119.189970px;bottom:537.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:126.419970px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.529970px;bottom:513.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.529970px;bottom:513.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.899970px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.149970px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.629970px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:231.689970px;bottom:465.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.379970px;bottom:453.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.879970px;bottom:441.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:127.699970px;bottom:417.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:197.539970px;bottom:405.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.539970px;bottom:405.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.917970px;bottom:393.351010px;width:19.775000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:234.617970px;bottom:393.351010px;width:14.850000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.849970px;bottom:369.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.849970px;bottom:369.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.969970px;bottom:357.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.309970px;bottom:345.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.309970px;bottom:345.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:234.404970px;bottom:333.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.089970px;bottom:321.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.089970px;bottom:321.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.369970px;bottom:309.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.009970px;bottom:297.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.309970px;bottom:285.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.759970px;bottom:273.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:233.069970px;bottom:261.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.369970px;bottom:198.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:215.569970px;bottom:186.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.249970px;bottom:162.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:130.039970px;bottom:150.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.689970px;bottom:138.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.689970px;bottom:138.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.239970px;bottom:126.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.239970px;bottom:114.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.299970px;bottom:90.351910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.129970px;bottom:78.351910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.244970px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.584970px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.854970px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.094970px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.424970px;bottom:525.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.424970px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.944970px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.984970px;bottom:501.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:385.024970px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:404.744970px;bottom:465.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.704970px;bottom:453.353010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.404970px;bottom:441.354010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.274970px;bottom:429.355010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.204970px;bottom:405.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:404.444970px;bottom:393.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:416.604970px;bottom:381.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:326.944970px;bottom:369.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:420.824970px;bottom:357.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.704970px;bottom:345.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:413.644970px;bottom:333.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.814970px;bottom:321.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.814970px;bottom:321.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.334970px;bottom:309.356010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.334970px;bottom:309.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.934970px;bottom:297.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:380.804970px;bottom:273.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:394.984970px;bottom:261.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.934970px;bottom:237.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.534970px;bottom:225.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.534970px;bottom:213.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.524970px;bottom:189.356010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:302.994970px;bottom:165.356010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.994970px;bottom:165.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:377.499970px;bottom:153.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:397.499970px;bottom:153.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:417.499970px;bottom:153.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.644970px;bottom:141.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.364970px;bottom:129.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:393.364970px;bottom:129.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:413.364970px;bottom:129.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.374970px;bottom:117.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.764970px;bottom:93.351910px;width:15.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.704970px;bottom:81.351910px;width:20.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:396.704970px;bottom:81.351910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1c9" class="pf w1f h2" data-page-no="1c9"><div class="pc pc1c9 w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">426<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">private functions, 292</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">private method behavior, 147</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">problem domain names, 27</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">procedural code, 97</div><div class="t m0 xd h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">procedural shape example, 95–96</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">procedures, compared to objects, 101</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">process function, repartitioning, 319–320</div><div class="t m5 xd h2f y1db ffb fs10 fc0 sc0 ls0 ws0">process</div><div class="t m0 x95 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0"> method, I/O bound, 319</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">processes, competing for resources, 184</div><div class="t m0 xd h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">processor bound, code as, 318</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">producer consumer execution model, 184</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">producer threads, 184</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">production environment, 127–130</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">productivity, decreased by messy code, 4</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">professional programmer, 25</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">professional review, of code, 268</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">programmers</div><div class="t m0 x74 h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">as authors, 13–14</div><div class="t m0 x74 h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">conundrum faced by, 6</div><div class="t m0 x74 h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">responsibility  for messes, 5–6</div><div class="t m0 x74 h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">unprofessional, 5–6</div><div class="t m0 xd h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">programming</div><div class="t m0 x74 h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">defined, 2</div><div class="t m0 x74 h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">structured, 48–49</div><div class="t m0 xd h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">programs, getting them to work, 201</div><div class="t m0 xd h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">pronounceable names, 21–22</div><div class="t m0 xd h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">protected variables, avoiding, 80</div><div class="t m0 xd h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">proxies, drawbacks of, 163</div><div class="t m0 xd h14 y1710 ff8 fs3 fc0 sc0 ls0 ws0">public APIs, javadocs in, 59</div><div class="t m0 xd h14 y152e ff8 fs3 fc0 sc0 ls0 ws0">puns, avoiding, 26–27</div><div class="t m5 xd h2f y419 ffb fs10 fc0 sc0 ls0 ws0">PUTFIELD</div><div class="t m0 x9a h14 y419 ff8 fs3 fc0 sc0 ls0 ws0"> instruction, as atomic, 325</div><div class="t m0 xba h17 y120 ff1 fs9 fc0 sc0 ls0 ws0">Q</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws7df">queries, separating from commands, 45–46</div><div class="t m0 xd6 h17 y1738 ff1 fs9 fc0 sc0 ls0 ws0">R</div><div class="t m0 xd h14 y402 ff8 fs3 fc0 sc0 ls0 ws0">random jiggling, tests running, 190</div><div class="t m0 xd h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws0">range, including end-point dates in, 276</div><div class="t m0 xd h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws0">readability</div><div class="t m0 x74 h14 y5e9 ff8 fs3 fc0 sc0 ls0 ws0">of clean tests, 124</div><div class="t m0 x74 h14 y557 ff8 fs3 fc0 sc0 ls0 ws0">of code, 76</div><div class="t m0 xb2 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">Dave Thomas on, 9</div><div class="t m0 xb2 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">improving using generics, 115</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">readability perspective, 8</div><div class="t m0 x23 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">readers</div><div class="t m0 xb2 h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">of code, 13–14</div><div class="t m0 xb2 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">continuous, 184</div><div class="t m0 x23 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">readers-writers execution model, 184</div><div class="t m0 x23 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">reading</div><div class="t m0 xb2 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">clean code, 8</div><div class="t m0 xb2 h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">code from top to bottom, 37</div><div class="t m0 xb2 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">versus writing, 14</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">reboots, as a lock up solution, 331</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">recommendations, in this book, 13</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">redesign, demanded by the team, 5</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">redundancy, of noise words, 21</div><div class="t m0 x23 h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">redundant comments, 60–62, 272, 275, </div><div class="t m0 x85 h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">286–287</div><div class="t m5 x23 h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">ReentrantLock</div><div class="t m0 xf7 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0"> class, 183</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">refactored programs, as longer, 146</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">refactoring</div><div class="t m5 xb2 h2f yd29 ffb fs10 fc0 sc0 ls0 ws0">Args</div><div class="t m0 x85 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">, 212</div><div class="t m0 xb2 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">code incrementally, 172</div><div class="t m0 xb2 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">as an iterative process, 265</div><div class="t m0 xb2 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">putting things in to take out, 233</div><div class="t m0 xb2 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">test code, 127</div><div class="t m0 x23 h14 y3df ffa fs3 fc0 sc0 ls0 ws0">Refactoring<span class="ff8"> (Fowler), 285</span></div><div class="t m0 x23 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">renaming, fear of, 30</div><div class="t m0 x23 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">repeatability, of concurrency bugs, 180</div><div class="t m0 x23 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">repeatable tests, 132</div><div class="t m0 x23 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">requirements, specifying, 2</div><div class="t m5 x23 h2f y419 ffb fs10 fc0 sc0 ls0 ws0">resetId</div><div class="t m0 x27 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">, byte-code generated for, 324–325</div><div class="t m0 x23 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">resources</div><div class="t m0 xb2 h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">bound, 183</div><div class="t m0 xb2 h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">processes competing for, 184</div><div class="t m0 xb2 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">threads agreeing on a global ordering </div><div class="t m0 x85 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">of, 338</div><div class="t m0 x23 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">responsibilities</div><div class="t m0 xb2 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">counting in classes, 136</div><div class="t m0 xb2 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">definition of, 138</div><div class="t m0 xb2 h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">identifying, 139</div><div class="t m0 xb2 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">misplaced, 295–296, 299</div><div class="t m0 xb2 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">splitting a program into main, 146</div><div class="t m0 x23 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">return codes, using exceptions instead, </div><div class="t m0 x85 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">103–105</div><div class="d m1" style="border-style:none;position:absolute;left:150.809990px;bottom:585.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.079990px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.199990px;bottom:561.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.459990px;bottom:549.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.729990px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:202.729990px;bottom:537.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:212.729990px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.579990px;bottom:513.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:228.579990px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.829990px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:223.279990px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.849990px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:229.119990px;bottom:465.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.239990px;bottom:453.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.699990px;bottom:441.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:199.699990px;bottom:441.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:238.009990px;bottom:429.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.129990px;bottom:417.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.619990px;bottom:405.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.589990px;bottom:381.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.589990px;bottom:381.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.519990px;bottom:369.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:203.259990px;bottom:357.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:213.259990px;bottom:357.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.199990px;bottom:345.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.199990px;bottom:345.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.309990px;bottom:321.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.309990px;bottom:309.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.309990px;bottom:309.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:209.699990px;bottom:297.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.239990px;bottom:285.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.239990px;bottom:285.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:199.129990px;bottom:273.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.349990px;bottom:261.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.089990px;bottom:249.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.209990px;bottom:237.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.209990px;bottom:237.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.141990px;bottom:225.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:224.353990px;bottom:174.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:239.353990px;bottom:174.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:203.879990px;bottom:123.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:222.469990px;bottom:111.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:153.529990px;bottom:87.351910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.029990px;bottom:75.351910px;width:10.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.764990px;bottom:585.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.104990px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.254990px;bottom:561.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.154990px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.154990px;bottom:537.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.334990px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.294990px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.924990px;bottom:489.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.664990px;bottom:477.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.384990px;bottom:465.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.104990px;bottom:453.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.774990px;bottom:441.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:401.584990px;bottom:429.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:382.974990px;bottom:417.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.044990px;bottom:405.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.044990px;bottom:405.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.044990px;bottom:405.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:406.044990px;bottom:405.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.444990px;bottom:393.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.444990px;bottom:393.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.433990px;bottom:381.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:394.624990px;bottom:369.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:307.690990px;bottom:345.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.814990px;bottom:333.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.474990px;bottom:321.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.734990px;bottom:309.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.714990px;bottom:297.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.144990px;bottom:285.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.584990px;bottom:273.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:409.074990px;bottom:261.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:333.814990px;bottom:249.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:371.314990px;bottom:237.352010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:402.584990px;bottom:225.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:422.584990px;bottom:225.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:315.444990px;bottom:201.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.644990px;bottom:189.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.774990px;bottom:165.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.994990px;bottom:141.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.164990px;bottom:129.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.334990px;bottom:117.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:330.994990px;bottom:105.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.994990px;bottom:105.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.994990px;bottom:105.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.114990px;bottom:93.351910px;width:15.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.444990px;bottom:69.351910px;width:20.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.444990px;bottom:69.351910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1ca" class="pf w1e h2" data-page-no="1ca"><div class="pc pc1ca w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">427<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">reuse, 174</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">risk of change, reducing, 147</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">robust clear code, writing, 112</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">rough drafts, writing, 200</div><div class="t m5 xd h2f y198 ffb fs10 fc0 sc0 ls0 ws0">runnable</div><div class="t m0 x9a h14 y198 ff8 fs3 fc0 sc0 ls0 ws0"> interface, 326</div><div class="t m0 xd h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">run-on expressions, 295</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">run-on journal entries, 63–64</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws134">runtime logic, separating startup from, 154</div><div class="t m0 x7b h17 y1739 ff1 fs9 fc0 sc0 ls0 ws0">S</div><div class="t m0 xd h14 yaf4 ff8 fs3 fc0 sc0 ls0 ws0">safety mechanisms, overridden, 289</div><div class="t m0 xd h14 yaf5 ff8 fs3 fc0 sc0 ls0 ws0">scaling up, 157–161</div><div class="t m0 xd h14 yaf6 ff8 fs3 fc0 sc0 ls0 ws0">scary noise, 66</div><div class="t m0 xd h14 yaf7 ff8 fs3 fc0 sc0 ls0 ws0">schema, of a class, 194</div><div class="t m0 xd h14 yaf8 ff8 fs3 fc0 sc0 ls0 ws0">schools of thought, about clean code, </div><div class="t m0 x3f h14 yaf9 ff8 fs3 fc0 sc0 ls0 ws0">12–13</div><div class="t m0 xd h14 y173a ff8 fs3 fc0 sc0 ls0 ws0">scissors rule, in C++, 81</div><div class="t m0 xd h14 y173b ff8 fs3 fc0 sc0 ls0 ws0">scope(s)</div><div class="t m0 x74 h14 y173c ff8 fs3 fc0 sc0 ls0 ws0">defined by exceptions, 105</div><div class="t m0 x74 h14 y173d ff8 fs3 fc0 sc0 ls0 ws0">dummy, 90</div><div class="t m0 x74 h14 y173e ff8 fs3 fc0 sc0 ls0 ws0">envying, 293</div><div class="t m0 x74 h14 y173f ff8 fs3 fc0 sc0 ls0 ws0">expanding and indenting, 89</div><div class="t m0 x74 h14 y1740 ff8 fs3 fc0 sc0 ls0 ws0">hierarchy in a source file, 88</div><div class="t m0 x74 h14 y1741 ff8 fs3 fc0 sc0 ls0 ws0">limiting for data, 181</div><div class="t m0 x74 h14 y1742 ff8 fs3 fc0 sc0 ls0 ws0">names related to the length of, </div><div class="t m0 x3f h14 y1743 ff8 fs3 fc0 sc0 ls0 ws0">22–23, 312</div><div class="t m0 x74 h14 y1744 ff8 fs3 fc0 sc0 ls0 ws0">of shared variables, 333</div><div class="t m0 xd h14 yef5 ff8 fs3 fc0 sc0 ls0 ws0">searchable names, 22–23</div><div class="t m0 xd h14 y3fa ff8 fs3 fc0 sc0 ls0 ws0">Second Law, of TDD, 122</div><div class="t m0 xd h14 y3fb ff8 fs3 fc0 sc0 ls0 ws0">sections, within functions, 36</div><div class="t m0 xd h14 y3fc ff8 fs3 fc0 sc0 ls0 ws0">selector arguments, avoiding, 294–295</div><div class="t m0 xd h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">self validating tests, 132</div><div class="t m5 xd h2f y3fe ffb fs10 fc0 sc0 ls0 ws0">Semaphore</div><div class="t m0 x5f h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">class, 183</div><div class="t m0 xd h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">semicolon, making visible, 90</div><div class="t m0 xd h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">“serial number”, </div><div class="t m5 xbc h2f y400 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x2f h14 y400 ff8 fs3 fc0 sc0 ls0 ws0"> using, 271</div><div class="t m5 xd h2f y397 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 x4c h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">class</div><div class="t m0 x74 h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">making it right, 270–284</div><div class="t m0 x74 h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">naming of, 270–271</div><div class="t m0 x74 h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">refactoring, 267–284</div><div class="t m5 xd h2f y43f ffb fs10 fc0 sc0 ls0 ws0">SerialDateTests</div><div class="t m0 x24 h14 y43f ff8 fs3 fc0 sc0 ls0 ws0"> class, 268</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">serialization, 272</div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">server, threads created by, 319–321</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">server application, 317–318, 343–344</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">server code, responsibilities of, 319</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">server-based locking, 329</div><div class="t m0 x7e h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">as preferred, 332–333</div><div class="t m0 x7e h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">with synchronized methods, 185</div><div class="t m0 x23 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">“Servlet” model, of Web applications, 178</div><div class="t m5 x23 h2f y1da ffb fs10 fc0 sc0 ls0 ws0">Servlets</div><div class="t m0 xe3 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">, synchronization problems, 182</div><div class="t m5 x23 h2f y1db ffb fs10 fc0 sc0 ls0 ws0">set</div><div class="t m0 x7e h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">functions, moving into appropriate </div><div class="t m0 x85 h14 y1dc ff8 fs3 fc0 sc0 ls3d ws0">derivatives, 232, 233–235</div><div class="t m5 x23 h2f y1dd ffb fs10 fc0 sc0 ls0 ws0">setArgument</div><div class="t m0 xc2 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">, changing, 232–233</div><div class="t m5 x23 h2f y16e8 ffb fs10 fc0 sc0 ls0 ws0">setBoolean</div><div class="t m0 x61 h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0"> function, 217</div><div class="t m0 x23 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">setter methods, injecting dependencies, </div><div class="t m0 x85 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">157</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">setup strategy, 155</div><div class="t m5 x23 h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">SetupTeardownIncluder.java</div><div class="t m0 x5e h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0"> listing, </div><div class="t m0 x85 h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">50–52</div><div class="t m0 x23 h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">shape classes, 95–96</div><div class="t m0 x23 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">shared data, limiting access, 181</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">shared variables</div><div class="t m0 x7e h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">method updating, 328</div><div class="t m0 x7e h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">reducing the scope of, 333</div><div class="t m0 x23 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">shotgun approach, hand-coded instrumen-</div><div class="t m0 x85 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">tation as, 189</div><div class="t m0 x23 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">shut-down code, 186</div><div class="t m0 x23 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">shutdowns, graceful, 186</div><div class="t m0 x23 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">side effects</div><div class="t m0 x7e h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">having none, 44</div><div class="t m0 x7e h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">names describing, 313</div><div class="t m0 x23 h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">Simmons, Robert, 276</div><div class="t m0 x23 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">simple code, 10, 12</div><div class="t m0 x23 h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">Simple Design, rules of, 171–176</div><div class="t m0 x23 h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">simplicity, of code, 18, 19</div><div class="t m0 x23 h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">single assert rule, 130–131</div><div class="t m0 x23 h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">single concepts, in each test function, </div><div class="t m0 x85 h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">131–132</div><div class="t m0 x23 h14 ye5c ff8 fs3 fc0 sc0 ls0 ws74f">Single Responsibility Principle (SRP), 15, </div><div class="t m0 x85 h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">138–140</div><div class="t m0 x7e h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">applying, 321</div><div class="t m0 x7e h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">breaking, 155</div><div class="t m0 x7e h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">as a concurrency defense principle, </div><div class="t m0 x85 h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">181</div><div class="t m0 x7e h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">recognizing violations of, 174</div><div class="t m0 x7e h14 y16f6 ff8 fs3 fc0 sc0 ls0 ws0">server violating, 320</div><div class="d m1" style="border-style:none;position:absolute;left:105.044970px;bottom:586.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.584970px;bottom:574.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.144970px;bottom:562.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.434970px;bottom:550.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:155.915970px;bottom:538.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.764970px;bottom:526.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.594970px;bottom:514.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.594970px;bottom:514.101010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:234.983970px;bottom:502.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.084970px;bottom:451.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:124.774970px;bottom:439.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.774970px;bottom:439.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.654970px;bottom:427.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:156.144970px;bottom:415.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.944970px;bottom:391.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.944970px;bottom:391.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.334970px;bottom:379.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.704970px;bottom:355.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:132.504970px;bottom:343.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.164970px;bottom:331.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:200.824970px;bottom:319.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:201.354970px;bottom:307.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.944970px;bottom:295.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.944970px;bottom:271.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.944970px;bottom:271.102010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.944970px;bottom:271.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.474970px;bottom:259.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.194970px;bottom:247.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.194970px;bottom:247.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.034970px;bottom:235.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.444970px;bottom:223.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:199.204970px;bottom:211.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:219.204970px;bottom:211.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.164970px;bottom:199.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:146.498970px;bottom:187.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.224970px;bottom:175.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:219.800970px;bottom:163.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:161.394970px;bottom:139.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.394970px;bottom:139.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.774970px;bottom:127.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.774970px;bottom:127.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.814970px;bottom:115.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.814970px;bottom:115.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.556970px;bottom:103.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:132.824970px;bottom:91.101910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.124970px;bottom:79.101910px;width:20.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:206.124970px;bottom:79.101910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.939970px;bottom:586.101010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.939970px;bottom:586.101010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:383.939970px;bottom:586.101010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.939970px;bottom:586.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:394.769970px;bottom:574.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.599970px;bottom:562.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.039970px;bottom:550.101010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.039970px;bottom:550.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.559970px;bottom:538.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:422.819970px;bottom:526.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:415.660970px;bottom:514.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.499970px;bottom:490.101010px;width:17.050000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.749970px;bottom:490.101010px;width:19.550000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.149970px;bottom:490.101010px;width:14.700000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.655970px;bottom:478.101010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.655970px;bottom:478.101010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:351.513970px;bottom:466.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.569970px;bottom:442.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.839970px;bottom:430.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.569970px;bottom:406.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.569970px;bottom:406.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.609970px;bottom:394.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.609970px;bottom:394.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:382.549970px;bottom:382.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:358.069970px;bottom:358.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.379970px;bottom:346.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.179970px;bottom:322.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.169970px;bottom:310.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.109970px;bottom:298.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.729970px;bottom:274.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:360.279970px;bottom:262.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.579970px;bottom:250.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:320.619970px;bottom:238.102010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.619970px;bottom:238.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:367.009970px;bottom:226.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.009970px;bottom:226.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.289970px;bottom:214.102010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.289970px;bottom:214.102010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.779970px;bottom:202.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:359.779970px;bottom:202.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.569970px;bottom:178.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.569970px;bottom:178.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:423.679970px;bottom:166.102010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.569970px;bottom:154.102010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.569970px;bottom:154.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.569970px;bottom:142.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.559970px;bottom:130.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.569970px;bottom:106.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:390.559970px;bottom:94.102010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.059970px;bottom:82.102010px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1cb" class="pf w1f h2" data-page-no="1cb"><div class="pc pc1cb w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">428<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Single Responsibility Principle (SRP), </div><div class="t m0 x3f h1d y195 ffa fs3 fc0 sc0 ls0 ws0">continued</div><div class="t m5 x74 h2f y196 ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x95 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0"> class violating, 147</div><div class="t m0 x74 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">supporting, 157</div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">in test classes conforming to, 172</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">violating, 38</div><div class="t m0 xd h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">single value, ordered components of, 42</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">single-letter names, 22, 25</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">single-thread calculation, of throughput, </div><div class="t m0 x3f h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">334</div><div class="t m0 xd h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">SINGLETON pattern, 274</div><div class="t m0 xd h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">small classes, 136</div><div class="t m0 xd h14 y1e0 ffa fs3 fc0 sc0 ls0 ws0">Smalltalk Best Practice Patterns<span class="ff8">, 296</span></div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">smart programmer, 25</div><div class="t m0 xd h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">software project, maintenance of, 175</div><div class="t m0 xd h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">software systems. <span class="ffa">See also</span> system(s)</div><div class="t m0 x74 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">compared to physical systems, 158</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">SOLID class design principle, 150</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">solution domain names, 27</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">source code control systems, 64, 68, 69</div><div class="t m0 xd h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">source files</div><div class="t m0 x74 h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">compared to newspaper articles, </div><div class="t m0 x3f h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">77–78</div><div class="t m0 x74 h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">multiple languages in, 288</div><div class="t m0 xd h14 yde7 ffa fs3 fc0 sc0 ls0 ws0">Sparkle<span class="ff8"> program, 34</span></div><div class="t m0 xd h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">spawned threads, deadlocked, 186</div><div class="t m0 xd h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">special case objects, 110</div><div class="t m0 xd h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">SPECIAL CASE PATTERN, 109</div><div class="t m0 xd h14 y1710 ff8 fs3 fc0 sc0 ls0 ws0">specifications, purpose of, 2</div><div class="t m0 xd h14 y152e ff8 fs3 fc0 sc0 ls0 ws0">spelling errors, correcting, 20</div><div class="t m5 xd h2f y419 ffb fs10 fc0 sc0 ls0 ws0">SpreadsheetDateFactory</div><div class="t m0 x9e h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">, 274–275</div><div class="t m0 xd h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">Spring AOP, proxies in, 163</div><div class="t m0 xd h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">Spring Framework, 157</div><div class="t m0 xd h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">Spring model, following EJB3, 165</div><div class="t m0 xd h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">Spring V2.5 configuration file, 163–164</div><div class="t m0 xd h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">spurious failures, 187</div><div class="t m5 xd h2f y43d ffb fs10 fc0 sc0 ls0 ws0">Sql</div><div class="t m0 x3b h14 y43d ff8 fs3 fc0 sc0 ls0 ws0"> class, changing, 147–149</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">square root, as the iteration limit, 74</div><div class="t m0 xd h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">SRP. <span class="ffa">See</span> Single Responsibility Principle</div><div class="t m0 xd h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">standard conventions, 299–300</div><div class="t m0 xd h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">standard nomenclature, 175, 311–312</div><div class="t m0 xd h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">standards, using wisely, 168</div><div class="t m0 xd h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">startup process, separating from runtime </div><div class="t m0 x3f h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">logic, 154</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">starvation, 183, 184, 338</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">static function, 279</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">static import, 308</div><div class="t m0 x23 h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">static methods, inappropriate, 296</div><div class="t m0 x23 h14 y559 ffa fs3 fc0 sc0 ls0 ws0">The Step-down Rule<span class="ff8">, 37</span></div><div class="t m0 x23 h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">stories, implementing only today’s, 158</div><div class="t m0 x23 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">STRATEGY pattern, 290</div><div class="t m5 x23 h2f y1db ffb fs10 fc0 sc0 ls0 ws0">string</div><div class="t m0 x27 h14 y1db ff8 fs3 fc0 sc0 ls0 ws14b">arguments, 194, 208–212, 214–225</div><div class="t m0 x23 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">string comparison errors, 252</div><div class="t m5 x23 h2f y1dd ffb fs10 fc0 sc0 ls0 ws0">StringBuffers</div><div class="t m0 xf7 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">, 129</div><div class="t m0 x23 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">Stroustrup, Bjarne, 7–8</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">structure(s). <span class="ffa">See also</span> data structures</div><div class="t m0 xb2 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">hiding, 99</div><div class="t m0 xb2 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">hybrid, 99</div><div class="t m0 xb2 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">making massive changes to, 212</div><div class="t m0 xb2 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">over convention, 301</div><div class="t m0 x23 h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">structured programming, 48–49</div><div class="t m5 x23 h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">SuperDashboard</div><div class="t m0 xca h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0"> class, 136–137</div><div class="t m0 x23 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">swapping, as permutations, 323</div><div class="t m5 x23 h2f yd28 ffb fs10 fc0 sc0 ls0 ws0">switch</div><div class="t m0 x40 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0"> statements</div><div class="t m0 xb2 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">burying, 37, 38</div><div class="t m0 xb2 h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">considering polymorphism </div><div class="t m0 x85 h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">before, 299</div><div class="t m0 xb2 h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">reasons to tolerate, 38–39</div><div class="t m5 x23 h2f ybfd ffb fs10 fc0 sc0 ls0 ws0">switch/case</div><div class="t m0 x21 h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">chain, 290</div><div class="t m0 x23 h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">synchronization problems, avoiding with </div><div class="t m5 x85 h2f y3e0 ffb fs10 fc0 sc0 ls0 ws0">Servlets</div><div class="t m0 xa0 h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">, 182</div><div class="t m5 x23 h2f y608 ffb fs10 fc0 sc0 ls0 ws0">synchronized</div><div class="t m0 x21 h14 y608 ff8 fs3 fc0 sc0 ls0 ws0"> block, 334</div><div class="t m5 x23 h2f y15a4 ffb fs10 fc0 sc0 ls0 ws0">synchronized</div><div class="t m0 x21 h14 y15a4 ff8 fs3 fc0 sc0 ls0 ws0"> keyword, 185</div><div class="t m0 xb2 h14 y81b ff8 fs3 fc0 sc0 ls0 ws0">adding, 323</div><div class="t m0 xb2 h14 y419 ff8 fs3 fc0 sc0 ls0 ws0">always acquiring a lock, 328</div><div class="t m0 xb2 h14 y81c ff8 fs3 fc0 sc0 ls0 ws0">introducing a lock via, 331</div><div class="t m0 xb2 h14 y393 ff8 fs3 fc0 sc0 ls0 ws0">protecting a critical section </div><div class="t m0 x85 h14 y394 ff8 fs3 fc0 sc0 ls0 ws0">in code, 181</div><div class="t m0 x23 h14 y395 ff8 fs3 fc0 sc0 ls0 ws0">synchronized methods, 185</div><div class="t m0 x23 h14 y396 ff8 fs3 fc0 sc0 ls0 ws0">synchronizing, avoiding, 182</div><div class="t m0 x23 h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">synthesis functions, 265</div><div class="t m0 x23 h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">system(s). <span class="ffa">See also</span> software systems</div><div class="t m0 xb2 h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">file sizes of significant, 77</div><div class="t m0 xb2 h14 y171c ff8 fs3 fc0 sc0 ls0 ws4e9">keeping running during development, </div><div class="t m0 x85 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">213</div><div class="t m0 xb2 h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">needing domain-specific, 168</div><div class="t m0 x23 h14 y473 ff8 fs3 fc0 sc0 ls0 ws0">system architecture, test driving, </div><div class="t m0 x85 h14 y496 ff8 fs3 fc0 sc0 ls0 ws0">166–167</div><div class="d m1" style="border-style:none;position:absolute;left:174.653990px;bottom:561.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:144.499990px;bottom:549.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:215.599990px;bottom:537.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.279990px;bottom:525.951010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:228.969990px;bottom:513.951010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:159.539990px;bottom:501.951010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.539990px;bottom:501.951010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.719990px;bottom:477.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.088990px;bottom:465.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.659990px;bottom:453.953010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:213.956990px;bottom:441.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.869990px;bottom:429.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.789990px;bottom:417.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:221.429990px;bottom:393.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:201.759990px;bottom:381.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.499990px;bottom:369.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.199990px;bottom:357.954010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:211.199990px;bottom:357.954010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:226.199990px;bottom:357.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.719990px;bottom:321.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.719990px;bottom:321.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.829990px;bottom:309.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.643990px;bottom:297.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:200.629990px;bottom:285.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.029990px;bottom:273.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:199.839990px;bottom:261.954010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.199990px;bottom:249.954010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:186.749990px;bottom:237.954010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.571990px;bottom:225.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.571990px;bottom:225.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:177.609990px;bottom:213.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.989990px;bottom:201.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:205.949990px;bottom:189.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.819990px;bottom:177.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:224.819990px;bottom:177.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.099990px;bottom:165.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:160.253990px;bottom:153.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:180.253990px;bottom:153.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:213.709990px;bottom:141.952010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.429990px;bottom:117.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.429990px;bottom:117.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.529990px;bottom:105.952010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.529990px;bottom:105.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.529990px;bottom:105.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:176.769990px;bottom:93.951910px;width:15.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.719990px;bottom:69.951910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:312.284990px;bottom:585.951010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.284990px;bottom:585.951010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:352.284990px;bottom:585.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.784990px;bottom:573.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.124990px;bottom:561.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.664990px;bottom:549.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.381990px;bottom:537.951010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:411.734990px;bottom:525.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.334990px;bottom:513.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:344.205990px;bottom:501.951010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.029990px;bottom:501.951010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.029990px;bottom:501.951010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.853990px;bottom:501.951010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:423.853990px;bottom:501.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.604990px;bottom:489.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.893990px;bottom:477.951010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.174990px;bottom:465.952010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:356.174990px;bottom:465.952010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.404990px;bottom:441.953010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.954990px;bottom:429.953010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:400.554990px;bottom:417.953010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.554990px;bottom:405.953010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.774990px;bottom:393.953010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.774990px;bottom:393.953010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.144990px;bottom:381.952010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:375.144990px;bottom:381.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:379.224990px;bottom:369.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.954990px;bottom:345.952010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.954990px;bottom:345.952010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.384990px;bottom:321.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:363.604990px;bottom:309.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.604990px;bottom:309.952010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.241990px;bottom:297.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:343.336990px;bottom:273.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.301990px;bottom:261.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.071990px;bottom:249.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.064990px;bottom:237.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:385.544990px;bottom:225.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:378.334990px;bottom:213.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.004990px;bottom:189.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.554990px;bottom:177.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.504990px;bottom:165.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:349.234990px;bottom:153.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.664990px;bottom:129.952010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:105.952010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:389.434990px;bottom:93.951910px;width:15.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.844990px;bottom:69.951910px;width:20.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.844990px;bottom:69.951910px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1cc" class="pf w1e h2" data-page-no="1cc"><div class="pc pc1cc w1e h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">429<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">system failures, not ignoring </div><div class="t m0 x3f h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">one-offs, 187</div><div class="t m0 xd h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">system level, staying clean at, 154</div><div class="t m0 xd h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">system-wide information, in a local </div><div class="t m0 x3f h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">comment, 69–70</div><div class="t m0 xd6 h17 y1745 ff1 fs9 fc0 sc0 ls0 ws0">T</div><div class="t m0 xd h14 y19c ff8 fs3 fc0 sc0 ls0 ws0">tables, moving, 275</div><div class="t m0 xd h14 y19d ff8 fs3 fc0 sc0 ls0 ws10e">target deployment platforms, running tests </div><div class="t m0 x3f h14 y19e ff8 fs3 fc0 sc0 ls0 ws0">on, 341</div><div class="t m0 xd h14 y19f ff8 fs3 fc0 sc0 ls0 ws0">task swapping, encouraging, 188</div><div class="t m0 xd h14 y1a0 ff8 fs3 fc0 sc0 ls0 ws0">TDD (Test Driven Development), 213</div><div class="t m0 x74 h14 y1a1 ff8 fs3 fc0 sc0 ls0 ws0">building logic, 106</div><div class="t m0 x74 h14 y1a2 ff8 fs3 fc0 sc0 ls0 ws0">as fundamental discipline, 9</div><div class="t m0 x74 h14 y1bf ff8 fs3 fc0 sc0 ls0 ws0">laws of, 122–123</div><div class="t m0 xd h14 y1c0 ff8 fs3 fc0 sc0 ls0 ws0">team rules, 90</div><div class="t m0 xd h14 y1c1 ff8 fs3 fc0 sc0 ls0 ws0">teams</div><div class="t m0 x74 h14 y1c2 ff8 fs3 fc0 sc0 ls0 ws0">coding standard for every, 299–300</div><div class="t m0 x74 h14 y1c3 ff8 fs3 fc0 sc0 ls0 ws0">slowed by messy code, 4</div><div class="t m0 xd h14 y1c4 ff8 fs3 fc0 sc0 ls0 ws0">technical names, choosing, 27</div><div class="t m0 xd h14 y1e5 ff8 fs3 fc0 sc0 ls0 ws0">technical notes, reserving comments </div><div class="t m0 x3f h14 y1e6 ff8 fs3 fc0 sc0 ls0 ws0">for, 286</div><div class="t m0 xd h14 y1e7 ff8 fs3 fc0 sc0 ls0 ws0">TEMPLATE METHOD pattern</div><div class="t m0 x74 h14 y1e8 ff8 fs3 fc0 sc0 ls0 ws0">addressing duplication, 290</div><div class="t m0 x74 h14 y1e9 ff8 fs3 fc0 sc0 ls0 ws0">removing higher-level duplication, </div><div class="t m0 x3f h14 y1ea ff8 fs3 fc0 sc0 ls0 ws0">174–175</div><div class="t m0 x74 h14 y1eb ff8 fs3 fc0 sc0 ls0 ws0">using, 130</div><div class="t m0 xd h14 y1ec ff8 fs3 fc0 sc0 ls0 ws0">temporal coupling. <span class="ffa">See also</span> coupling</div><div class="t m0 x74 h14 y1ed ff8 fs3 fc0 sc0 ls0 ws0">exposing, 259–260</div><div class="t m0 x74 h14 y1ee ff8 fs3 fc0 sc0 ls0 ws0">hidden, 302–303</div><div class="t m0 x74 h14 y1ef ff8 fs3 fc0 sc0 ls0 ws0">side effect creating, 44</div><div class="t m0 xd h14 y1162 ff8 fs3 fc0 sc0 ls0 ws0">temporary variables, explaining, 279–281</div><div class="t m0 xd h14 y1163 ff8 fs3 fc0 sc0 ls0 ws0">test cases</div><div class="t m0 x74 h14 y1249 ff8 fs3 fc0 sc0 ls0 ws0">adding to check arguments, 237</div><div class="t m0 x74 h14 y1442 ff8 fs3 fc0 sc0 ls0 ws0">in</div><div class="t m5 x52 h2f y400 ffb fs10 fc0 sc0 ls0 ws0">ComparisonCompactor</div><div class="t m0 xc7 h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">, 252–254</div><div class="t m0 x74 h14 y397 ff8 fs3 fc0 sc0 ls0 ws0">patterns of failure, 269, 314</div><div class="t m0 x74 h14 y398 ff8 fs3 fc0 sc0 ls0 ws0">turning off, 58</div><div class="t m0 xd h14 y399 ff8 fs3 fc0 sc0 ls0 ws0">test code, 124, 127</div><div class="t m0 xd h14 y3ca ff8 fs3 fc0 sc0 ls0 ws0">TEST DOUBLE, assigning, 155</div><div class="t m0 xd h14 y43f ff8 fs3 fc0 sc0 ls0 ws0">Test Driven Development. <span class="ffa">See</span> TDD</div><div class="t m0 xd h14 y440 ff8 fs3 fc0 sc0 ls0 ws0">test driving, architecture, 166–167</div><div class="t m0 xd h14 y13e2 ff8 fs3 fc0 sc0 ls0 ws0">test environment, 127–130</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">test functions, single concepts in, 131–132</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">test implementation, of an interface, 150</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">test suite</div><div class="t m0 x7e h14 y16e3 ff8 fs3 fc0 sc0 ls0 ws0">automated, 213</div><div class="t m0 x7e h14 y559 ff8 fs3 fc0 sc0 ls0 ws0">of unit tests, 124, 268</div><div class="t m0 x7e h14 y16e4 ff8 fs3 fc0 sc0 ls0 ws0">verifying precise behavior, 146</div><div class="t m0 x23 h14 yc02 ff8 fs3 fc0 sc0 ls0 ws0">testable systems, 172</div><div class="t m0 x23 h14 y16e5 ff8 fs3 fc0 sc0 ls0 ws0">test-driven development. <span class="ffa">See</span> TDD</div><div class="t m0 x23 h14 y16e6 ff8 fs3 fc0 sc0 ls0 ws0">testing</div><div class="t m0 x7e h14 y16e7 ff8 fs3 fc0 sc0 ls0 ws0">arguments making harder, 40</div><div class="t m0 x7e h14 y16e8 ff8 fs3 fc0 sc0 ls0 ws0">construction logic mixed with </div><div class="t m0 x85 h14 y16d2 ff8 fs3 fc0 sc0 ls0 ws0">runtime, 155</div><div class="t m0 x23 h14 y16e9 ff8 fs3 fc0 sc0 ls0 ws0">testing language, domain-specific, 127</div><div class="t m0 x23 h14 y16ea ff8 fs3 fc0 sc0 ls0 ws0">testNG project, 76, 77</div><div class="t m0 x23 h14 y16eb ff8 fs3 fc0 sc0 ls0 ws0">tests</div><div class="t m0 x7e h14 y16ec ff8 fs3 fc0 sc0 ls0 ws0">clean, 124–127</div><div class="t m0 x7e h14 y16ed ff8 fs3 fc0 sc0 ls0 ws0">cleanliness tied to, 9</div><div class="t m0 x7e h14 y16ee ff8 fs3 fc0 sc0 ls0 ws0">commented out for </div><div class="t m5 x8b h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">SerialDate</div><div class="t m0 xfa h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">,</div><div class="t m0 x85 h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">268–270</div><div class="t m0 x7e h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">dirty, 123</div><div class="t m0 x7e h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">enabling the -ilities, 124</div><div class="t m0 x7e h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">fast, 132</div><div class="t m0 x7e h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">fast versus slow, 314</div><div class="t m0 x7e h14 ybfc ff8 fs3 fc0 sc0 ls0 ws0">heuristics on, 313–314</div><div class="t m0 x7e h14 ybfd ff8 fs3 fc0 sc0 ls0 ws0">ignored, 313</div><div class="t m0 x7e h14 y3df ff8 fs3 fc0 sc0 ls0 ws0">independent, 132</div><div class="t m0 x7e h14 y3e0 ff8 fs3 fc0 sc0 ls0 ws0">insufficient, 313</div><div class="t m0 x7e h14 y608 ff8 fs3 fc0 sc0 ls0 ws0">keeping clean, 123–124</div><div class="t m0 x7e h14 y609 ff8 fs3 fc0 sc0 ls0 ws0">minimizing assert statements in, </div><div class="t m0 x85 h14 y60a ff8 fs3 fc0 sc0 ls0 ws0">130–131</div><div class="t m0 x7e h14 ycfb ff8 fs3 fc0 sc0 ls0 ws0">not stopping trivial, 313</div><div class="t m0 x7e h14 y12ab ff8 fs3 fc0 sc0 ls0 ws0">refactoring, 126–127</div><div class="t m0 x7e h14 y16ef ff8 fs3 fc0 sc0 ls0 ws0">repeatable, 132</div><div class="t m0 x7e h14 yf75 ff8 fs3 fc0 sc0 ls0 ws0">requiring more than one step, 287</div><div class="t m0 x7e h14 yf76 ff8 fs3 fc0 sc0 ls0 ws0">running, 341</div><div class="t m0 x7e h14 ye5c ff8 fs3 fc0 sc0 ls0 ws0">self validating, 132</div><div class="t m0 x7e h14 y16f0 ff8 fs3 fc0 sc0 ls0 ws0">simple design running all, 172</div><div class="t m0 x7e h14 y16f1 ff8 fs3 fc0 sc0 ls0 ws0">suite of automated, 213</div><div class="t m0 x7e h14 y16f2 ff8 fs3 fc0 sc0 ls0 ws0">timely, 133</div><div class="t m0 x7e h14 y16f3 ff8 fs3 fc0 sc0 ls0 ws0">writing for multithreaded code, </div><div class="t m0 x85 h14 y16f4 ff8 fs3 fc0 sc0 ls0 ws0">339–342</div><div class="t m0 x7e h14 y16f5 ff8 fs3 fc0 sc0 ls0 ws0">writing for threaded code, 186–190</div><div class="t m0 x7e h14 y16f6 ff8 fs3 fc0 sc0 ls0 ws0">writing good, 122–123</div><div class="d m1" style="border-style:none;position:absolute;left:153.289970px;bottom:573.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:200.899970px;bottom:561.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.189970px;bottom:537.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:172.189970px;bottom:537.751010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.859970px;bottom:486.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.969970px;bottom:462.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:195.339970px;bottom:450.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:217.549970px;bottom:438.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.809970px;bottom:426.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.179970px;bottom:414.753010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.129970px;bottom:402.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:151.129970px;bottom:402.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:125.349970px;bottom:390.753010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:204.439970px;bottom:366.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:224.439970px;bottom:366.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:191.679970px;bottom:354.753010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:189.229970px;bottom:342.753010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:131.629970px;bottom:318.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.239970px;bottom:294.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.969970px;bottom:270.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.969970px;bottom:270.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:123.639970px;bottom:258.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:138.079970px;bottom:234.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.079970px;bottom:234.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.189970px;bottom:222.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.189970px;bottom:222.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.049970px;bottom:210.753010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:210.889970px;bottom:198.753010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:230.889970px;bottom:198.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:209.449970px;bottom:174.753010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.165970px;bottom:162.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.165970px;bottom:162.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.059970px;bottom:150.752010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.059970px;bottom:150.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.019970px;bottom:138.752010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:119.239970px;bottom:126.752010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.239970px;bottom:126.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:193.689970px;bottom:114.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:181.449970px;bottom:90.752010px;width:20.000000px;height:8.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:201.449970px;bottom:90.752010px;width:15.000000px;height:8.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:150.909970px;bottom:78.752010px;width:20.000000px;height:8.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.909970px;bottom:78.752010px;width:15.000000px;height:8.939700px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:402.864970px;bottom:585.751010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:422.864970px;bottom:585.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:414.514970px;bottom:573.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.254970px;bottom:549.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.264970px;bottom:537.751010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:357.264970px;bottom:537.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.564970px;bottom:525.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.314970px;bottom:513.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.794970px;bottom:477.751010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.704970px;bottom:453.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.294970px;bottom:441.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.194970px;bottom:429.751010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:346.194970px;bottom:429.751010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.694970px;bottom:405.751010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.694970px;bottom:405.751010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.254970px;bottom:393.751010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.594970px;bottom:369.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.594970px;bottom:369.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:309.484970px;bottom:357.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:367.814970px;bottom:345.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:305.034970px;bottom:333.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.474970px;bottom:321.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.424970px;bottom:309.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.424970px;bottom:309.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.144970px;bottom:297.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:339.474970px;bottom:285.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.144970px;bottom:273.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:345.854970px;bottom:261.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:365.854970px;bottom:261.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.594970px;bottom:237.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.594970px;bottom:237.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:366.714970px;bottom:225.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:334.464970px;bottom:213.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.464970px;bottom:213.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:331.684970px;bottom:201.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:405.574970px;bottom:189.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:321.704970px;bottom:177.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:347.534970px;bottom:165.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.984970px;bottom:153.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:364.474970px;bottom:141.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.154970px;bottom:129.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:303.594970px;bottom:105.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:323.594970px;bottom:105.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.954970px;bottom:93.752010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:411.954970px;bottom:93.752010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:341.984970px;bottom:81.752010px;width:20.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.984970px;bottom:81.752010px;width:15.000000px;height:8.939800px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.455030,0.650010]}'></div></div>
<div id="pf1cd" class="pf w1f h2" data-page-no="1cd"><div class="pc pc1cd w1f h2"><div class="t m0 xd h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">430<span class="_ _4c"> </span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">Third Law, of TDD, 122</div><div class="t m0 xd h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">third-party code</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">integrating, 116</div><div class="t m0 x74 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">learning, 116</div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">using, 114–115</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">writing tests for, 116</div><div class="t m5 xd h2f y1da ffb fs10 fc0 sc0 ls0 ws0">this</div><div class="t m0 x74 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0"> variable, 324</div><div class="t m0 xd h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">Thomas, Dave, 8, 9, 289</div><div class="t m0 xd h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">thread(s)</div><div class="t m0 x74 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">adding to a method, 322</div><div class="t m0 x74 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">interfering with each other, 330</div><div class="t m0 x74 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">making as independent as </div><div class="t m0 x3f h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">possible, 182</div><div class="t m0 x74 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">stepping on each other, 180, 326</div><div class="t m0 x74 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">taking resources from other </div><div class="t m0 x3f h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">threads, 338</div><div class="t m0 xd h14 y1e4 ff8 fs3 fc0 sc0 ls0 ws0">thread management strategy, 320</div><div class="t m0 xd h14 y54a ff8 fs3 fc0 sc0 ls0 ws0">thread pools, 326</div><div class="t m0 xd h14 y54b ff8 fs3 fc0 sc0 ls0 ws0">thread-based code, testing, 342</div><div class="t m0 xd h14 y54c ff8 fs3 fc0 sc0 ls0 ws0">threaded code</div><div class="t m0 x74 h14 y6c2 ff8 fs3 fc0 sc0 ls0 ws0">making pluggable, 187</div><div class="t m0 x74 h14 y6c3 ff8 fs3 fc0 sc0 ls0 ws0">making tunable, 187–188</div><div class="t m0 x74 h14 yde5 ff8 fs3 fc0 sc0 ls0 ws0">symptoms of bugs in, 187</div><div class="t m0 x74 h14 yde6 ff8 fs3 fc0 sc0 ls0 ws0">testing, 186–190</div><div class="t m0 x74 h14 yde7 ff8 fs3 fc0 sc0 ls0 ws0">writing in Java 5, 182–183</div><div class="t m0 xd h14 y170d ff8 fs3 fc0 sc0 ls0 ws0">threading</div><div class="t m0 x74 h14 y170e ff8 fs3 fc0 sc0 ls0 ws0">adding to a client/server application, </div><div class="t m0 x3f h14 y170f ff8 fs3 fc0 sc0 ls0 ws0">319, 346–347</div><div class="t m0 x74 h14 y1710 ff8 fs3 fc0 sc0 ls0 ws0">problems in complex systems, 342</div><div class="t m0 xd h14 y152e ff8 fs3 fc0 sc0 ls0 ws0">thread-safe collections, 182–183, 329</div><div class="t m0 xd h14 y152f ff8 fs3 fc0 sc0 ls0 ws0">throughput</div><div class="t m0 x74 h14 y1530 ff8 fs3 fc0 sc0 ls0 ws0">causing starvation, 184</div><div class="t m0 x74 h14 y111f ff8 fs3 fc0 sc0 ls0 ws0">improving, 319</div><div class="t m0 x74 h14 y210 ff8 fs3 fc0 sc0 ls0 ws0">increasing, 333–335</div><div class="t m0 x74 h14 y211 ff8 fs3 fc0 sc0 ls0 ws0">validating, 318</div><div class="t m5 xd h2f y396 ffb fs10 fc0 sc0 ls0 ws0">throws</div><div class="t m0 xfc h14 y396 ff8 fs3 fc0 sc0 ls0 ws0"> clause, 106</div><div class="t m0 xd h14 y43d ff8 fs3 fc0 sc0 ls0 ws0">tiger team, 5</div><div class="t m0 xd h14 y43e ff8 fs3 fc0 sc0 ls0 ws0">tight coupling, 172</div><div class="t m0 xd h14 y1314 ff8 fs3 fc0 sc0 ls0 ws0">time, taking to go fast, 6</div><div class="t m0 xd h14 y171c ff8 fs3 fc0 sc0 ls0 ws0">Time and Money project, 76</div><div class="t m0 x74 h14 ya5c ff8 fs3 fc0 sc0 ls0 ws0">file sizes, 77</div><div class="t m0 xd h14 y495 ff8 fs3 fc0 sc0 ls0 ws0">timely tests, 133</div><div class="t m0 x23 h14 y16e0 ff8 fs3 fc0 sc0 ls0 ws0">timer program, testing, 121–122</div><div class="t m0 x23 h14 y16e1 ff8 fs3 fc0 sc0 ls0 ws0">“TO” keyword, 36</div><div class="t m0 x23 h14 y16e2 ff8 fs3 fc0 sc0 ls0 ws0">TO paragraphs, 37</div><div class="t m5 x23 h2f y197 ffb fs10 fc0 sc0 ls0 ws0">TODO</div><div class="t m0 xb4 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">comments, 58–59</div><div class="t m0 x23 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">tokens, used as magic numbers, 300</div><div class="t m0 x23 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">Tomcat project, 76, 77</div><div class="t m0 x23 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">tools</div><div class="t m0 xb2 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">ConTest tool, 190, 342</div><div class="t m0 xb2 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">coverage, 313</div><div class="t m0 xb2 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">handling proxy boilerplate, 163</div><div class="t m0 xb2 h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">testing thread-based code, 342</div><div class="t m0 x23 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">train wrecks, 98–99</div><div class="t m0 x23 h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">transformations, as return values, 41</div><div class="t m0 x23 h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">transitive navigation, avoiding, 306–307</div><div class="t m0 x23 h14 y1e2 ff8 fs3 fc0 sc0 ls0 ws0">triadic argument, 40</div><div class="t m0 x23 h14 y1e3 ff8 fs3 fc0 sc0 ls0 ws0">triads, 42</div><div class="t m5 x23 h2f y1368 ffb fs10 fc0 sc0 ls0 ws0">try</div><div class="t m0 x7e h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">blocks, 105</div><div class="t m5 x23 h2f y1369 ffb fs10 fc0 sc0 ls0 ws0">try/catch</div><div class="t m0 x89 h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0"> blocks, 46–47, 65–66</div><div class="t m5 x23 h2f y423 ffb fs10 fc0 sc0 ls0 ws0">try-catch-finally</div><div class="t m0 xef h14 y423 ff8 fs3 fc0 sc0 ls0 ws0"> statement, 105–106</div><div class="t m0 x23 h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">tunable threaded-based code, 187–188</div><div class="t m0 x23 h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">type encoding, 24</div><div class="t m0 x72 h17 y1746 ff1 fs9 fc0 sc0 ls0 ws0">U</div><div class="t m0 x23 h14 yddc ff8 fs3 fc0 sc0 ls0 ws0">ubiquitous language, 311–312</div><div class="t m0 x23 h14 ybfe ff8 fs3 fc0 sc0 ls0 ws0">unambiguous names, 312</div><div class="t m0 x23 h14 y57e ff8 fs3 fc0 sc0 ls0 ws0">unchecked exceptions, 106–107</div><div class="t m0 x23 h14 y57f ff8 fs3 fc0 sc0 ls0 ws7ed">unencapsulated conditional, encapsulating, </div><div class="t m0 x85 h14 y580 ff8 fs3 fc0 sc0 ls0 ws0">257</div><div class="t m0 x23 h14 yecc ff8 fs3 fc0 sc0 ls0 ws0">unit testing, isolated as difficult, 160</div><div class="t m0 x23 h14 ye5a ff8 fs3 fc0 sc0 ls0 ws0">unit tests, 124, 175, 268</div><div class="t m0 x23 h14 ycfc ff8 fs3 fc0 sc0 ls0 ws0">unprofessional programming, 5–6</div><div class="t m0 x23 h14 ycfd ff8 fs3 fc0 sc0 ls0 ws0">uppercase</div><div class="t m5 x61 h2f y3fd ffb fs10 fc0 sc0 ls0 ws0">C</div><div class="t m0 xc2 h14 y3fd ff8 fs3 fc0 sc0 ls0 ws0">, in variable names, 20</div><div class="t m0 x23 h14 y3fe ff8 fs3 fc0 sc0 ls0 ws0">usability, of newspapers, 78</div><div class="t m0 x23 h14 y3ff ff8 fs3 fc0 sc0 ls0 ws0">use, of a system, 154</div><div class="t m0 x23 h14 y400 ff8 fs3 fc0 sc0 ls0 ws0">users, handling concurrently, 179</div><div class="t m0 x72 h17 y1747 ff1 fs9 fc0 sc0 ls0 ws0">V</div><div class="t m0 x23 h14 y5e7 ff8 fs3 fc0 sc0 ls0 ws0">validation, of throughput, 318</div><div class="t m0 x23 h14 y5e8 ff8 fs3 fc0 sc0 ls0 ws0">variable names, single-letter, 25</div><div class="d m1" style="border-style:none;position:absolute;left:162.788990px;bottom:585.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:145.249990px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.689990px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:123.589990px;bottom:537.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.589990px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:165.249990px;bottom:525.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:135.875990px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:142.239990px;bottom:501.351010px;width:7.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.239990px;bottom:501.351010px;width:7.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:162.239990px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:178.859990px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.279990px;bottom:465.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:152.699990px;bottom:441.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:192.179990px;bottom:429.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:212.179990px;bottom:429.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.799990px;bottom:405.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:196.669990px;bottom:393.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:133.079990px;bottom:381.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.059990px;bottom:369.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.859990px;bottom:345.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.859990px;bottom:333.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.859990px;bottom:333.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:185.539990px;bottom:321.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:128.589990px;bottom:309.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:148.589990px;bottom:309.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:168.859990px;bottom:297.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:188.859990px;bottom:297.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.919990px;bottom:261.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:134.919990px;bottom:261.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.919990px;bottom:261.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:220.529990px;bottom:249.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.169990px;bottom:237.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.169990px;bottom:237.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:214.169990px;bottom:237.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:174.409990px;bottom:213.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.589990px;bottom:201.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:143.019990px;bottom:189.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.019990px;bottom:189.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.919990px;bottom:177.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.278990px;bottom:165.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:124.189990px;bottom:153.352010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.759990px;bottom:141.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:171.419990px;bottom:129.352010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.069990px;bottom:117.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:137.189990px;bottom:105.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.759990px;bottom:93.351910px;width:15.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.204990px;bottom:585.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:382.204990px;bottom:585.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.744990px;bottom:573.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:332.744990px;bottom:561.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:335.711990px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:350.711990px;bottom:549.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:397.194990px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:333.864990px;bottom:525.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.864990px;bottom:525.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:342.994990px;bottom:501.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:362.994990px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.134990px;bottom:489.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:397.144990px;bottom:477.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:392.684990px;bottom:465.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:322.194990px;bottom:453.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:337.194990px;bottom:453.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:403.574990px;bottom:441.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:394.984990px;bottom:429.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:414.984990px;bottom:429.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:338.864990px;bottom:417.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:295.264990px;bottom:405.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:316.400990px;bottom:393.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:340.457990px;bottom:381.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.457990px;bottom:381.352010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:370.457990px;bottom:381.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:385.457990px;bottom:381.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.169990px;bottom:369.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:407.169990px;bottom:369.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.894990px;bottom:357.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:406.894990px;bottom:357.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.424990px;bottom:345.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:353.874990px;bottom:294.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:373.874990px;bottom:294.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.984990px;bottom:282.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:361.074990px;bottom:270.352010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:381.074990px;bottom:270.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:304.044990px;bottom:246.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:399.434990px;bottom:234.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:308.884990px;bottom:222.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:328.884990px;bottom:222.352010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:348.884990px;bottom:222.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:388.864990px;bottom:210.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:398.864990px;bottom:210.352010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:395.366990px;bottom:198.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:369.974990px;bottom:186.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:336.924990px;bottom:174.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.634990px;bottom:162.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:372.764990px;bottom:111.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:386.074990px;bottom:99.351910px;width:10.000000px;height:8.940100px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.167010,0.650010]}'></div></div>
<div id="pf1ce" class="pf w20 h2" data-page-no="1ce"><div class="pc pc1ce w20 h2"><div class="t m0 x29 h14 y79 ff8 fs3 fc0 sc0 ls0 ws0">431<span class="_ _10"></span><span class="ff1">Index</span></div><div class="t m0 xd h14 y194 ff8 fs3 fc0 sc0 ls0 ws0">variables</div><div class="t m0 x74 h14 y195 ff8 fs3 fc0 sc0 ls0 ws0">1 based versus zero based, 261</div><div class="t m0 x74 h14 y196 ff8 fs3 fc0 sc0 ls0 ws0">declaring, 80, 81, 292</div><div class="t m0 x74 h14 y197 ff8 fs3 fc0 sc0 ls0 ws0">explaining temporary, 279–281</div><div class="t m0 x74 h14 y198 ff8 fs3 fc0 sc0 ls0 ws0">explanatory, 296–297</div><div class="t m0 x74 h14 y199 ff8 fs3 fc0 sc0 ls0 ws0">keeping private, 93</div><div class="t m0 x74 h14 y1da ff8 fs3 fc0 sc0 ls0 ws0">local, 292, 324</div><div class="t m0 x74 h14 y1db ff8 fs3 fc0 sc0 ls0 ws0">moving to a different class, 273</div><div class="t m0 x74 h14 y1dc ff8 fs3 fc0 sc0 ls0 ws0">in place of comments, 67</div><div class="t m0 x74 h14 y1dd ff8 fs3 fc0 sc0 ls0 ws0">promoting to instance variables of </div><div class="t m0 x9a h14 y1de ff8 fs3 fc0 sc0 ls0 ws0">classes, 141</div><div class="t m0 x74 h14 y1df ff8 fs3 fc0 sc0 ls0 ws0">with unclear context, 28</div><div class="t m0 xd h14 y1e0 ff8 fs3 fc0 sc0 ls0 ws0">venting, in comments, 65</div><div class="t m0 xd h14 y1e1 ff8 fs3 fc0 sc0 ls0 ws0">verbs, keywords and, 43</div><div class="t m5 xd h2f y11bf ffb fs10 fc0 sc0 ls0 ws0">Version</div><div class="t m0 x95 h14 y11bf ff8 fs3 fc0 sc0 ls0 ws0"> class, 139</div><div class="t m0 xd h14 y11c0 ff8 fs3 fc0 sc0 ls0 ws0">versions, not deserializing across, 272</div><div class="t m0 xd h14 y1368 ff8 fs3 fc0 sc0 ls0 ws0">vertical density, in code, 79–80</div><div class="t m0 xd h14 y1369 ff8 fs3 fc0 sc0 ls0 ws0">vertical distance, in code, 80–84</div><div class="t m0 xd h14 y423 ff8 fs3 fc0 sc0 ls0 ws0">vertical formatting, 76–85</div><div class="t m0 xd h14 yd28 ff8 fs3 fc0 sc0 ls0 ws0">vertical openness, between concepts, </div><div class="t m0 x9a h14 yd29 ff8 fs3 fc0 sc0 ls0 ws0">78–79</div><div class="t m0 xd h14 yd2a ff8 fs3 fc0 sc0 ls0 ws0">vertical ordering, in code, 84–85</div><div class="t m0 xd h14 ybfb ff8 fs3 fc0 sc0 ls0 ws0">vertical separation, 292</div><div class="t m0 xb9 h17 ydb ff1 fs9 fc0 sc0 ls0 ws0">W</div><div class="t m0 x23 h14 y2a4 ff8 fs3 fc0 sc0 ls0 ws0">wading, through bad code, 3</div><div class="t m0 x23 h14 y272 ff8 fs3 fc0 sc0 ls0 ws0">Web containers, decoupling provided </div><div class="t m0 x85 h14 y2a5 ff8 fs3 fc0 sc0 ls0 ws0">by, 178</div><div class="t m0 x23 h14 y2a6 ff8 fs3 fc0 sc0 ls0 ws0">what, decoupling from when, 178</div><div class="t m0 x23 h14 y2a7 ff8 fs3 fc0 sc0 ls0 ws0">white space, use of horizontal, 86</div><div class="t m0 x23 h14 y56e ff8 fs3 fc0 sc0 ls0 ws0">wildcards, 307</div><div class="t m0 x23 h1d y56f ffa fs3 fc0 sc0 ls0 ws0">Working Effectively with Legacy </div><div class="t m0 x85 h14 ya72 ffa fs3 fc0 sc0 ls0 ws0">Code<span class="ff8">, 10</span></div><div class="t m0 x23 h14 ye7c ff8 fs3 fc0 sc0 ls0 ws0">“working” programs, 201</div><div class="t m0 x23 h14 y444 ff8 fs3 fc0 sc0 ls0 ws0">workmanship, 176</div><div class="t m0 x23 h14 y445 ff8 fs3 fc0 sc0 ls0 ws0">wrappers, 108</div><div class="t m0 x23 h14 y446 ff8 fs3 fc0 sc0 ls0 ws0">wrapping, 108</div><div class="t m0 x23 h14 ybaa ff8 fs3 fc0 sc0 ls0 ws0">writers, starvation of, 184</div><div class="t m0 x23 h14 ybab ff8 fs3 fc0 sc0 ls0 ws0">“Writing Shy Code”, 306</div><div class="t m0 x72 h17 y16f ff1 fs9 fc0 sc0 ls0 ws0">X</div><div class="t m0 x23 h14 y3a3 ff8 fs3 fc0 sc0 lsc ws0">XML</div><div class="t m0 x7e h14 y3a4 ff8 fs3 fc0 sc0 ls0 ws0">deployment descriptors, 160</div><div class="t m0 x7e h14 y6d4 ff8 fs3 fc0 sc0 ls0 ws0">“policy” specified configuration </div><div class="t m0 x85 h14 y6d5 ff8 fs3 fc0 sc0 ls0 ws0">files, 164</div><div class="d m1" style="border-style:none;position:absolute;left:205.269960px;bottom:573.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:139.179960px;bottom:561.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:154.179960px;bottom:561.351010px;width:12.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.179960px;bottom:561.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.789960px;bottom:549.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:207.789960px;bottom:549.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:149.179960px;bottom:537.351010px;width:20.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:169.179960px;bottom:537.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:163.899960px;bottom:525.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:121.409960px;bottom:513.351010px;width:17.500000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:141.409960px;bottom:513.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:208.619960px;bottom:501.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:187.789960px;bottom:489.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:147.739960px;bottom:465.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.619960px;bottom:453.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:170.359960px;bottom:441.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:166.449960px;bottom:429.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:136.089960px;bottom:417.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:216.169960px;bottom:405.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:179.509960px;bottom:393.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:194.509960px;bottom:393.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:183.389960px;bottom:381.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:198.389960px;bottom:381.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:158.679960px;bottom:369.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:173.679960px;bottom:369.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:114.969960px;bottom:345.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:129.969960px;bottom:345.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:184.499960px;bottom:333.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:199.499960px;bottom:333.352010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:157.559960px;bottom:321.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:376.464960px;bottom:563.351010px;width:5.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:318.594960px;bottom:539.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:387.574960px;bottom:527.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:391.734960px;bottom:515.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:311.474960px;bottom:503.351010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:329.702960px;bottom:479.351010px;width:10.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.074960px;bottom:467.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:327.034960px;bottom:455.353010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:309.244960px;bottom:443.354010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:310.364960px;bottom:431.355010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:355.634960px;bottom:419.356010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:354.254960px;bottom:407.357010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:384.194960px;bottom:344.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div><div class="d m1" style="border-style:none;position:absolute;left:325.814960px;bottom:320.352010px;width:15.000000px;height:8.940000px;background-color:rgba(255,255,255,0.000001);"></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,-1.527040,0.650010]}'></div></div>
</div>
<div class="loading-indicator">

</div>
</body>
</html>
